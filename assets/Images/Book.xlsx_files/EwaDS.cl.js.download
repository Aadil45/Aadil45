(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1013:function(x,C,b){function a(ha,Ia,gb,Sb,wc,tc,Tb,pb,cb,ob,rc,Db){this.HRc=!1;this.G1=null;this.KG=new ma.a;this.whb=1;this.sP=null;this.It=!1;this.qMc=(new Date(0)).getTime();this.Wge=0;this._clientId=ha;this.CXb=Ia;this.TL=0;this.Dh=Sb;this.XGc=pb;this.cvg=Tb;this.Jjg=cb;this.omg=wc;this.lpa=tc;this.Vl=gb;this.Qp=ob;this.ze=rc;this.Mg=Db;this.bwg=1>100*Math.random()}function c(ha){return ha?ha.charAt(0).toLocaleUpperCase()+
ha.substring(1,ha.length):ha}function e(ha,Ia,gb){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",ha,c(La[gb]),c("browser"),Ia)}function f(ha,Ia,gb,Sb,wc,tc,Tb,pb,cb,ob,rc,Db){cb=void 0===cb?null:cb;ob=void 0===ob?null:ob;rc=void 0===rc?null:rc;Db=void 0===Db?null:Db;var Ja=M.createInstance(pa.AFrameworkApplication.ga),Qb=pa.AFrameworkApplication.buildVersion?pa.AFrameworkApplication.buildVersion:"1.0",yc=e(ha,Ia,Tb,Qb),Cd=Ja.wYg?b(1369).RealtimeChannelMetrics.createInstance(yc):
new ca,bc=fa.a.create(wc);Ja.rtcJsClientFrequentlyLogsMetrics&&bc.XDj(Ja.gij);var Kb="";Kb=cb&&""!==cb?cb:"/rtc2/";bc.mTe=xa.a.UM(Kb);var ic=Kb+"signalr";cb=Kb+"findsession";var wb=P.a7h;Kb=new m;rc=rc||Sa.a.getInstance();R.ULS.shipAssertTag(556867617,500,Ja.iUf<=b(1013).RealtimeChannel.Tof,"Client attempting to override max payload size beyond absolute limit");var Wa=Math.min(Ja.iUf,b(1013).RealtimeChannel.Tof);bc.Sof=Wa;bc=new n(Ja,new l(Kb),ha,yc,function(Xb){return new Q(Xb.createHubProxy(wb))},
pb,rc,Cd,bc,Wa);ob||(ob=b(1301).FindSessionStrategy.createInstance(Ia,wc,cb,pb,Qb,Tb,ha,yc,rc,tc,Sb,Db));ob.U9b=Ja.U9b;Ia=new U(yc);gb=gb?gb.split(","):null;ha=new (b(1013).RealtimeChannel)(ha,gb,yc,pb,function(){return $.hubConnection(ic)},ob,bc,Ia,rc,Cd,Ja,wc);ha.init();return ha}function l(ha){var Ia=this;this.ze=null;this.tx=!1;this.Za=new Ra.a;this.tNc=new ma.a;this.sNc=new ma.a;this.nSc=ha;this.$Va=this.nSc.SDe(function(gb){return gb.send()},"GlobalMaxOustandingThrottler");this.$Va.SZb(function(){Ia.Za.raiseEvent("TMUDM")})}
function m(){}function r(ha,Ia){ha=w.call(this,ha,void 0===Ia?"":Ia)||this;ha.P8a=0;ha.Ejb=(new Date(0)).getTime();ha.currentTime=function(){return(new Date).getTime()};return ha}function h(ha,Ia){ha=w.call(this,ha,void 0===Ia?"":Ia)||this;ha.oBa=0;ha.J8a=0;ha.Za=new Ra.a;ha.uWa=!1;ha.mSc=0;ha.tRb=0;ha.FRb=0;ha.MUb=0;ha.wXb=[];ha.clearTimeout=h.L5c;return ha}function w(ha,Ia){this.dib=this.imb=0;this.sLc=!1;this.RXa=this.tXb=null;this.vWa=!1;this.ege=ha;this.Q8f=void 0===Ia?"":Ia;this.setTimeout=
w.Y5c;this.bFa=this.imb=this.dib=0}function n(ha,Ia,gb,Sb,wc,tc,Tb,pb,cb,ob){Tb=z.call(this,Tb)||this;Tb.Pr=null;Tb.Aae=!1;Tb.zP=0;Tb.ROc=new kb.a;Tb.ze=ha;Tb.ace=0;Tb.bce=0;Tb.jmb=Ia;Tb.jmb.SZb(Object(Z.a)(Tb,Tb.PSi,"onTooManyUndeliveredMessages"));Tb._clientId=gb;Tb.Rtg=wc;Tb.mh.nGg(Object(Z.a)(Tb,Tb.OPi,"onRefreshProxyRequired"));Tb.mh.lGg(Object(Z.a)(Tb,Tb.LPi,"onRefreshAllPersistentStateRequest"));Tb.mh.EGg(Object(Z.a)(Tb,Tb.Jda,"sendUpdateNotification"));Tb.mh.XEg(Object(Z.a)(Tb,Tb.OMi,"onInternalPresenceUpdated"));
Tb.mh.YEg(Object(Z.a)(Tb,Tb.PMi,"onInternalUpdateNotificationReceived"));Tb.mh.WEg(Object(Z.a)(Tb,Tb.NMi,"onInternalPersistentStateUpdated"));Tb.mh.VEg(Object(Z.a)(Tb,Tb.MMi,"onInternalPersistentStateCleared"));Tb.mh.DGg(Object(Z.a)(Tb,Tb.LNd,"sendPersistentState"));Tb.mh.ZGg(Object(Z.a)(Tb,Tb.$eb,"updateClientInfo"));Tb.Dh=tc;Tb.Vl=Sb;Tb.Qp=pb;Tb.ZB=cb;Tb.bkb=ob;Tb.OUa=Object(Gb.a)(String,pa.AFrameworkApplication.dc.Application)||"";return Tb}function v(){this.IRc=this.Rp=null}function u(ha,Ia,gb,
Sb){var wc=Aa.call(this)||this;wc.hKd=ha;wc.reconnectDelay=Ia;wc.reason=gb;wc.zNd=Sb;return wc}function t(){this.ibe=new y;this.gbe=new y}function y(){this.Q2d=this.WGc=!1;this.callback=null}function E(ha,Ia){this.lvg=ha;this.zP=void 0===Ia?"":Ia}function B(){this.Presence=null;this.TimeStamp=0}function z(ha){this.jmb=null;this.Cda=0;this.lJa=!1;this.mh=ha;this.mh.HFa(Object(Z.a)(this,this.uW,"onConnectionStateChanged"))}function M(){this.zFc=this.e2d=!1;this.xFc=0;this.DGc=this.gRc=this.fRc=this.VEc=
!1;this.EIc=0;this.xfe=!1;this.wfe=this.vfe=0;this.mQc=!1;this.rQc=this.pQc=this.sQc=this.nQc=0;this.qQc=!1}function Q(ha){this.Pr=ha}function P(){}function L(){}function ca(){this.pMf=this.kHd;this.sMf=this.nHd;this.rMf=this.mHd;this.wMf=this.pHd;this.vMf=this.oHd;this.vHd=this.wHd;this.sHd=this.tHd;this.bQa=this.qHd;this.oHb=this.rHd;this.qMf=this.lHd;this.hDb=this.Jxd;this.Wlc=this.Lxd}function U(ha){this.y9=!1;this.SXa=0;this.YGc=!1;this.setTimeout=U.Y5c;this.clearTimeout=U.L5c;this.cwi=Object(Z.a)(this,
this.tvi,"logRtcConnectingUsageStatement");this.Vl=ha}function aa(ha,Ia){this.data=ha;this.timeStamp=Ia}function F(ha,Ia,gb){this.f9=null;this.fNc=this.MQc=0;this.ze=Ia;this.jbe=gb;this.Glb=!1;this.mh=ha;this.mh.NYa(Object(Z.a)(this,this.y5i,"receiveMessage"))}function D(ha){this.messageId=ha;this.Imj=(new Date).getTime();this.Qsd=new ta.a}function J(ha,Ia){this.status=ha;this.X7a=Ia}b.r(C);x=b(0);var R=b(14),Z=b(82),W=b(161),ka=b(1188),ma=b(98),pa=b(4);Object(x.a)(J,"UserStatusInfo",null,[]);var xa=
b(80),va=b(636),ta=b(202);Object(x.a)(D,"MessageLatencyDetails",null,[]);F.prototype.start=function(){if(this.jbe&&!this.Glb){var ha=this.ze.jUf;this.fNc=this.ze.gUf;ha<=this.fNc?(R.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.ze.jUf,this.ze.gUf),this.jbe=!1):(this.Glb=!0,this.MQc=window.setInterval(Object(Z.a)(this,this.Hj,
"sendMessage"),ha))}};F.prototype.Hj=function(){var ha=this;if(this.Glb){var Ia=va.a.create().toString();this.f9=new D(Ia);this.mh.tGd(16,Ia,!1,new W.a);window.setTimeout(function(){ha.Gui(Ia)},this.fNc)}};F.prototype.Gui=function(ha){this.f9&&this.f9.messageId===ha&&(0<this.f9.Qsd.count?(ha=this.f9.Qsd.toArray().join(","),R.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",ha)):R.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.f9=null)};F.prototype.stop=
function(){this.MQc&&(window.clearInterval(this.MQc),this.Glb=!1)};F.prototype.y5i=function(ha,Ia){16===Ia.type?this.mh.tGd(17,Ia.g8,!1,new W.a):17===Ia.type&&this.Glb&&Ia.g8&&this.K0i(Ia.g8)};F.prototype.K0i=function(ha){ha&&this.f9&&ha.toString()===this.f9.messageId&&(ha=(new Date).getTime()-this.f9.Imj,this.f9.Qsd.add(ha))};F.Lfd=function(ha,Ia,gb){return F.instance||(F.Ma=new F(ha,Ia,gb))};Ek.Object.defineProperties(F,{instance:{configurable:!0,enumerable:!0,get:function(){return F.Ma}}});F.Ma=
null;Object(x.a)(F,"ClientToClientMessageTelemetry",null,[]);var fa=b(1144),Ca=b(1085);Object(x.a)(aa,"PresenceData",null,[]);U.prototype.BHi=function(){var ha=this;this.y9||(this.SXa=this.setTimeout(function(){ha.y9=!1;ha.hmf()},8E3),this.y9=!0,this.YGc=!1)};U.prototype.BIi=function(){this.yM()};U.prototype.ZRi=function(){this.hmf()};U.prototype.hmf=function(){this.yM();this.YGc||(this.YGc=!0,this.cwi())};U.prototype.tvi=function(){R.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",
this.Vl)};U.prototype.yM=function(){this.y9&&this.clearTimeout(this.SXa);this.SXa=0;this.y9=!1};U.Y5c=function(ha,Ia){return window.setTimeout(ha,Ia)};U.L5c=function(ha){window.clearTimeout(ha)};Object(x.a)(U,"ConnectedUsageKpiLogger",null,[377]);ca.prototype.kHd=function(){};ca.prototype.nHd=function(){};ca.prototype.mHd=function(){};ca.prototype.pHd=function(){};ca.prototype.oHd=function(){};ca.prototype.tHd=function(){};ca.prototype.rHd=function(){};ca.prototype.qHd=function(){};ca.prototype.wHd=
function(){};ca.prototype.lHd=function(){};ca.prototype.Jxd=function(){};ca.prototype.Lxd=function(){};Object(x.a)(ca,"NoopRealtimeChannelMetrics",null,[358,88]);L.kOb="presenceUpdated";L.updateNotification="updateNotification";L.dGf="persistentStateCleared";L.updatePersistentState="persistentStateUpdated";Object(x.a)(L,"RtcClientMethodNames",null,[]);P.a7h="realtimeChannelHub";P.kOb="UpdatePresence";P.Jda="SendUpdateNotification";P.Add="GetCompletePersistentStateWithMetadata";P.updatePersistentState=
"UpdatePersistentState";P.$eb="UpdateClientInfo";Object(x.a)(P,"RtcHubMethodNames",null,[]);Q.prototype.k8i=function(ha){this.Pr.on(L.kOb,ha)};Q.prototype.L8i=function(ha){this.Pr.on(L.updateNotification,ha)};Q.prototype.i8i=function(ha){this.Pr.on(L.updatePersistentState,ha)};Q.prototype.h8i=function(ha){this.Pr.on(L.dGf,ha)};Q.prototype.EOj=function(ha){this.Pr.off(L.kOb,ha)};Q.prototype.MOj=function(ha){this.Pr.off(L.updateNotification,ha)};Q.prototype.DOj=function(ha){this.Pr.off(L.updatePersistentState,
ha)};Q.prototype.COj=function(ha){this.Pr.off(L.dGf,ha)};Q.prototype.kOb=function(ha){return this.Pr.invoke(P.kOb,ha)};Q.prototype.$eb=function(ha){return this.Pr.invoke(P.$eb,ha)};Q.prototype.Jda=function(ha,Ia){return this.Pr.invoke(P.Jda,ha,Ia)};Q.prototype.Add=function(ha){return this.Pr.invoke(P.Add,ha)};Q.prototype.updatePersistentState=function(ha,Ia){return this.Pr.invoke(P.updatePersistentState,ha,Ia)};Object(x.a)(Q,"RealtimeChannelProxy",null,[363,364,365]);M.createInstance=function(ha){var Ia=
b(1013).RealtimeChannel;return ha?Object.assign(new M,{e2d:ha.ra("AwayStatusManagerIsEnabled"),zFc:ha.ra("AwayStatusOneMinuteTimeoutIsEnabled"),xFc:ha.Dd("AwayCoauthorThresholdMs",9E5),VEc:ha.ra("RtcAllowCrossDomainAccessEnabled"),fRc:ha.ra("ShouldLogOnContentNotification"),gRc:ha.ra("ShouldLogOnHostSubscriptionNotification"),DGc:ha.ra("RtcClientMetricsEnabled"),EIc:ha.Dd("RtcFindSessionRequestTimeoutInMS",6E4),xfe:ha.ra("RtcJsClientFrequentlyLogsMetrics"),vfe:ha.Dd("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),wfe:ha.Dd("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),mQc:ha.ra("RtcClientMessageTelemetryEnabled"),nQc:ha.Dd("RtcClientMessageTelemetrySampleSize",5),sQc:ha.Dd("RtcSendTelemetryMessageIntervalInMS",3E5),pQc:ha.Dd("RtcLogClientMessageMetricsTimeOutInMs",2E4),rQc:ha.Dd("RtcMaxPayloadSizeInCharactersOverride",Ia.$vd),qQc:ha.ra("RTCLogSignalrHeartBeatMessages")}):Object.assign(new M,{e2d:!1,zFc:!1,xFc:9E5,VEc:!1,fRc:!1,gRc:!0,DGc:!1,EIc:9E4,mQc:!1,nQc:5,sQc:3E5,pQc:2E4,rQc:Ia.$vd,qQc:!1})};
Ek.Object.defineProperties(M.prototype,{$Mg:{configurable:!0,enumerable:!0,get:function(){return this.zFc}},ZMg:{configurable:!0,enumerable:!0,get:function(){return this.xFc}},BIg:{configurable:!0,enumerable:!0,get:function(){return this.VEc}},lwj:{configurable:!0,enumerable:!0,get:function(){return this.fRc}},mwj:{configurable:!0,enumerable:!0,get:function(){return this.gRc}},wYg:{configurable:!0,enumerable:!0,get:function(){return this.DGc}},U9b:{configurable:!0,enumerable:!0,get:function(){return this.EIc}},
rtcJsClientFrequentlyLogsMetrics:{configurable:!0,enumerable:!0,get:function(){return this.xfe}},eUf:{configurable:!0,enumerable:!0,get:function(){return this.vfe}},gij:{configurable:!0,enumerable:!0,get:function(){return this.wfe}},rtcClientMessageTelemetryEnabled:{configurable:!0,enumerable:!0,get:function(){return this.mQc}},bij:{configurable:!0,enumerable:!0,get:function(){return this.nQc}},jUf:{configurable:!0,enumerable:!0,get:function(){return this.sQc}},gUf:{configurable:!0,enumerable:!0,
get:function(){return this.pQc}},iUf:{configurable:!0,enumerable:!0,get:function(){return this.rQc}},hUf:{configurable:!0,enumerable:!0,get:function(){return this.qQc}}});Object(x.a)(M,"RealtimeChannelSettings",null,[362]);var Sa=b(1297),Gb=b(83),kb=b(394);z.prototype.uW=function(ha,Ia){this.Cda=Ia.newState};z.prototype.PSi=function(){R.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.mh.krc()};z.prototype.L9h=function(ha){this.jmb.init(ha)};Object(x.a)(z,
"ARtcMessageHandler",null,[]);var lb=b(100);Object(x.a)(B,"PresenceDataEntryForClients",null,[]);var Nb=b(112);E.prototype.send=function(){return this.lvg()};Ek.Object.defineProperties(E.prototype,{messageId:{configurable:!0,enumerable:!0,get:function(){return this.zP}}});Object(x.a)(E,"MessageHandler",null,[390]);y.prototype.NN=function(ha){this.callback=ha;this.h$f()};y.prototype.zof=function(ha){this.WGc||(this.WGc=!0,this.lmg=ha,this.h$f())};y.prototype.h$f=function(){this.WGc&&this.callback&&
!this.Q2d&&(this.Q2d=!0,this.callback(this.lmg))};Object(x.a)(y,"CompletionTask",null,[]);t.prototype.Mnc=function(ha){this.ibe.NN(ha)};t.prototype.Lnc=function(ha){this.gbe.NN(ha)};t.prototype.wCb=function(ha){this.ibe.zof(ha)};t.prototype.Sxa=function(ha){this.gbe.zof(ha)};t.prototype.Tvd=function(){this.wCb(2);this.Sxa(2)};Object(x.a)(t,"MessageStatus",null,[389]);var Aa=Sys.EventArgs;Am(u,Aa);Object(x.a)(u,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var qa=b(1189);v.prototype.start=function(){this.Rp=
new Date};v.prototype.stop=function(){this.IRc=new Date};Ek.Object.defineProperties(v.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return this.Rp?this.IRc?this.IRc.getTime()-this.Rp.getTime():(new Date).getTime()-this.Rp.getTime():0}}});Object(x.a)(v,"SimpleStopwatch",null,[]);var Xa=b(1190),Ha;(function(ha){ha[ha.contentUpdate=0]="contentUpdate";ha[ha.editorsTableUpdate=1]="editorsTableUpdate";ha[ha.fileNameUpdate=2]="fileNameUpdate";ha[ha.wetContentUpdate=3]="wetContentUpdate";ha[ha.persistedContentUpdate=
4]="persistedContentUpdate";ha[ha.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";ha[ha.replicationTelemetry=6]="replicationTelemetry";ha[ha.lockUpdate=7]="lockUpdate";ha[ha.collabServiceContentUpdate=8]="collabServiceContentUpdate";ha[ha.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";ha[ha.saveTargetUpdate=10]="saveTargetUpdate";ha[ha.uploadToOcsUpdate=11]="uploadToOcsUpdate";ha[ha.labelUpdate=12]="labelUpdate";ha[ha.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";
ha[ha.subscribeOrExtend=14]="subscribeOrExtend";ha[ha.elapsedBootTelemetry=15]="elapsedBootTelemetry";ha[ha.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";ha[ha.clientToClientResponseMessage=17]="clientToClientResponseMessage";ha[ha.verifyNotificationPipeline=18]="verifyNotificationPipeline";ha[ha.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";ha[ha.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";ha[ha.last=21]="last"})(Ha||(Ha={}));Object(x.b)("UpdateNotificationType",
Ha);Am(n,z);n.prototype.OPi=function(ha,Ia){this.Pr=this.Rtg(Ia.hubConnection);this.jmb.reset();this.Pr.k8i(Object(Z.a)(this,this.cma,"onPresenceUpdated"));this.Pr.i8i(Object(Z.a)(this,this.coc,"onPersistentStateUpdated"));this.Pr.h8i(Object(Z.a)(this,this.pBd,"onPersistentStateCleared"));this.Pr.L8i(Object(Z.a)(this,this.Cca,"onUpdateNotificationReceived"))};n.prototype.uW=function(ha,Ia){this.Cda=Ia.newState;2===Ia.newState&&this.vmj()};n.prototype.vmj=function(){for(var ha=El(this.ROc),Ia=ha.next();!Ia.done;Ia=
ha.next())Ia=Ia.value,this.Jda(null,new qa.a(Ia.key,Ia.value,!1,new W.a));this.ROc=new kb.a};n.prototype.LPi=function(ha,Ia){Ia.u0c();for(ha=0;3>ha;++ha)this.fmj(ha,Ia)};n.prototype.fmj=function(ha,Ia){var gb=this;try{this.Pr.Add(ha).done(function(Sb){Ia.Ffb(Ia.l2c,"GetCompletePresenceSuccess")&&(Ia.c1g.ZRi(),R.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",gb.Vl),gb.mh.t3i(),gb.aPi(ha,Sb),gb.mh.V2i(Sb),Ia.uRe.xb(ha)&&gb.mh.EKf(ha,Ia.uRe.oa(ha),new W.a))}).fail(function(Sb){var wc=
b(926).RtcUtils;Ia.Ffb(Ia.l2c,"GetCompletePresenceFail")&&(R.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}]",wc.yOa(Sb),gb.Vl),gb.mh.krc())}).always(function(){Ia.stopwatch&&Ia.stopwatch.stop()})}catch(Sb){R.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",Ia.l2c,Sb.message)}};n.prototype.LNd=function(ha,Ia){var gb=
this,Sb=b(926).RtcUtils;ha=Ia.presence;var wc=Ia.koa;this.ZB.ly(1,0);try{var tc=Sb.Z_c(ha,this.bkb)}catch(pb){this.ZB.ly(1,3);R.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",pb.message);wc.setException(pb);return}Sb=new ma.a;Sb.ia(this._clientId,Object.assign(new B,{Presence:ha,TimeStamp:(new Date).getTime()}));this.mh.MKf(Ia.type,Sb);if(2!==this.Cda)this.Qp.bQa(),this.ZB.ly(1,2),wc.setResult(null);else{var Tb=this.zP.toString();++this.zP;
ha=new E(function(){return gb.xmj(Ia.type,tc,Tb)},Tb);ha=this.P8f(0,Ia.type).add(ha);ha.Mnc(function(pb){2===pb&&gb.ZB.ly(1,6);wc.setResult(null)});ha.Lnc(function(){})}};n.prototype.xmj=function(ha,Ia,gb){var Sb=this,wc=null,tc=new v,Tb=new t;R.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.Vl);if(2!==this.Cda)return this.Qp.bQa(),this.ZB.ly(1,2),R.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",this.Vl),Tb.Tvd(),Tb;this.Dh&&20>
this.ace&&(wc=this.Dh.Gc("WebServiceCall","Send Presence Message"),this.ace++);tc.start();Tb.wCb(1);try{this.Pr.updatePersistentState(ha,Ia).done(function(){Sb.Qp.sHd();Sb.ZB.ly(1,1);R.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",gb,Sb.Vl);Tb.Sxa(1);tc&&(tc.stop(),tc.Bc>Sb.ze.eUf?Sb.ZB.ly(1,4):Sb.ZB.ly(1,5))}).fail(function(pb){var cb=b(926).RtcUtils;Sb.lJa||(Sb.Qp.bQa(),Sb.ZB.ly(1,3),R.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",
gb,cb.yOa(pb),Sb.Vl));Tb.Sxa(2)}).always(function(){wc&&wc.stop()})}catch(pb){R.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",pb.message),this.ZB.ly(1,3),Tb.Sxa(2)}return Tb};n.prototype.$eb=function(ha,Ia){var gb=this;ha=b(926).RtcUtils;var Sb=Ia.vYg,wc=Ia.koa;try{var tc=ha.Z_c(Sb,this.bkb)}catch(Tb){R.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",Tb.message);wc.setException(Tb);
return}try{this.Pr.$eb(tc).done(function(){R.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(function(Tb){var pb=b(926).RtcUtils;gb.lJa||R.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",pb.yOa(Tb));wc.setResult(null)})}catch(Tb){R.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",Tb.message),wc.setResult(null)}};n.prototype.Jda=function(ha,Ia){var gb=this;ha=b(926).RtcUtils;var Sb=
Ia.type,wc=Ia.g8,tc=Ia.ddh,Tb=Ia.koa;this.ZB.ly(0,0);try{var pb=ha.Z_c(wc,this.bkb)}catch(ob){this.ZB.ly(0,3);R.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",ob.message);Tb.setException(ob);return}if(2!==this.Cda)tc?this.ROc.ia(Sb,wc):(this.Qp.bQa(),this.ZB.ly(0,2)),Tb.setResult(null);else{var cb=this.zP.toString();++this.zP;Ia=new E(function(){return gb.Rmj(Sb,pb,cb)},cb);Ia=this.P8f(1,Sb).add(Ia);Ia.Mnc(function(ob){2===ob&&gb.ZB.ly(0,
6);Tb.setResult(null)});Ia.Lnc(function(){})}};n.prototype.Rmj=function(ha,Ia,gb){var Sb=this,wc=null,tc=new v,Tb=new t;R.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.Vl);if(2!==this.Cda)return this.Qp.bQa(),this.ZB.ly(0,2),R.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.Vl),Tb.Tvd(),Tb;this.Dh&&3===ha&&20>this.bce&&(wc=this.Dh.Gc("WebServiceCall","Send WetContent Update"),this.bce++);tc.start();Tb.wCb(1);this.Pr.Jda(ha,
Ia).done(function(){Sb.Qp.sHd();Sb.ZB.ly(0,1);R.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",gb,Sb.Vl);Tb.Sxa(1);tc&&(tc.stop(),tc.Bc>Sb.ze.eUf?Sb.ZB.ly(0,4):Sb.ZB.ly(0,5))}).fail(function(pb){var cb=b(926).RtcUtils;Sb.lJa||(Sb.Qp.bQa(),Sb.ZB.ly(0,3),R.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",gb,cb.yOa(pb),Sb.Vl));Tb.Sxa(2)}).always(function(){wc&&wc.stop()});return Tb};
n.prototype.Tv=function(){this.Pr.EOj(Object(Z.a)(this,this.cma,"onPresenceUpdated"));this.Pr.DOj(Object(Z.a)(this,this.coc,"onPersistentStateUpdated"));this.Pr.COj(Object(Z.a)(this,this.pBd,"onPersistentStateCleared"));this.Pr.MOj(Object(Z.a)(this,this.Cca,"onUpdateNotificationReceived"))};n.prototype.OMi=function(ha,Ia){this.cma(Ia.bP,Ia.N3)};n.prototype.cma=function(ha){this.Qp.oHb();this.coc(0,ha)};n.prototype.NMi=function(ha,Ia){this.coc(Ia.type,Ia.bP)};n.prototype.aPi=function(ha,Ia){var gb=
{},Sb;for(Sb in Ia)gb[Sb]=Ia[Sb].Presence;this.gAf(ha,gb,Ia)};n.prototype.coc=function(ha,Ia){this.Qp.oHb();this.gAf(ha,Ia)};n.prototype.gAf=function(ha,Ia,gb){gb=void 0===gb?null:gb;var Sb=b(926).RtcUtils;if(R.ULS.Pda(500,100))for(var wc in Ia);delete Ia[this._clientId];if(!Nb.a.isEmpty(Ia)){for(var tc in Ia)wc=tc,Ia[wc]=Sb.deserialize(Ia[tc],"Presence",wc,!1,this.bkb);Sb=new ma.a;tc=(new Date).getTime();for(var Tb in Ia){wc=Ia[Tb];var pb=Tb;if(gb){var cb=gb[pb];cb.Presence=wc}else cb=Object.assign(new B,
{Presence:wc,TimeStamp:tc});Sb.ia(pb,cb)}this.mh.MKf(ha,Sb);switch(ha){case 0:this.Aae||(R.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Vl),this.Aae=!0,pa.AFrameworkApplication.ag&&pa.AFrameworkApplication.ag.Uxi());this.mh.wKf(Ia,[]);break;default:this.mh.n3i(ha,Ia)}}};n.prototype.MMi=function(ha,Ia){this.pBd(Ia.Q0c)};n.prototype.pBd=function(ha){this.Qp.oHb();if(R.ULS.Pda(500,100))for(var Ia=0;Ia<ha.length;++Ia);ha.length&&(this.mh.I3i(ha),this.mh.m3i(ha),
this.mh.wKf({},ha))};n.prototype.PMi=function(ha,Ia){this.Cca(Ia.type,Ia.g8)};n.prototype.Cca=function(ha,Ia){Ia=void 0===Ia?null:Ia;this.ze.lwj&&0===ha&&R.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===ha){var gb=pa.AFrameworkApplication.ga.Ua("OwningFeatureCrewForRtcNotificationKpis");if(gb&&0<gb.length){var Sb=new Map;Sb.set("AreaName","RealTimeCoauth");Sb.set("FeatureName","RtcNotification");Sb.set("SkipAria","True");lb.Health.instance.recordKpiUsage("ContentUpdateNotificationReceived",
0,gb,Sb)}}this.ze.mwj&&13===ha&&R.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",Ia||"<none>"));this.Qp.oHb();5===ha?(Ia=(ha=this.qWi(Ia))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",ha.reason,ha.reconnectDelay):"Received client reconnection request from the server without params.",R.ULS.sendTraceTag(18637071,500,50,Ia),this.mh.krc(ha)):(Ia=b(926).RtcUtils.deserialize(Ia,String.format("UpdateNotification-{0}",
Ha[ha]),null,!1,this.bkb),this.mh.H3i(ha,Ia))};n.prototype.qWi=function(ha){try{if(!ha||""===ha)return null;var Ia=JSON.parse(ha);return new u(Ia[Xa.a.hMd],Ia[Xa.a.aij],Ia[Xa.a.cij],Ia[Xa.a.zNd])}catch(gb){return R.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",gb.message),null}};n.prototype.P8f=function(ha,Ia){return this.jmb.aZh(this.bZh(ha,Ia))};n.prototype.bZh=function(ha,Ia){return ha+","+Ia};Object(x.a)(n,"RtcMessageHandler",z,[]);var Ra=b(97);w.prototype.uHd=function(){0<
this.bFa&&0<this.dib&&R.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.Q8f,this.dib,this.bFa);0<this.bFa&&0<this.imb&&R.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.Q8f,this.imb,this.bFa)};w.prototype.Iwc=function(ha,Ia){this.imb++;this.lqb(!0);this.sLc=!0;this.tXb=ha;this.RXa=Ia};w.prototype.lqb=function(ha){this.sLc=!1;this.RXa&&ha&&(this.dib++,this.RXa.Tvd());this.RXa=this.tXb=null};w.Y5c=function(ha,
Ia){return window.setTimeout(ha,Ia)};Ek.Object.defineProperties(w.prototype,{E6a:{configurable:!0,enumerable:!0,get:function(){return this.sLc}}});Object(x.a)(w,"ThrottlerBase",null,[]);Am(h,w);h.prototype.add=function(ha){this.vWa||this.init(h.GGe,h.zGe);this.bFa++;var Ia=new t;this.E6a?this.Iwc(ha,Ia):this.MUb<this.J8a?this.VJb(ha,Ia):(this.Iwc(ha,Ia),this.uWa=!1);return Ia};h.prototype.VJb=function(ha,Ia){var gb=this;ha=this.ege(ha);var Sb=this.setTimeout(Object(Z.a)(this,this.YNi,"onMessageWaitTimeExpired"),
this.oBa);++this.MUb;Array.add(this.wXb,Sb);var wc=this.tRb;ha.Mnc(function(tc){Ia.wCb(tc)});ha.Lnc(function(tc){gb.tRb===wc&&(gb.XNi(wc,Sb),Ia.Sxa(tc))})};h.prototype.XNi=function(ha,Ia){this.tRb===ha&&(--this.MUb,this.clearTimeout(Ia),Array.remove(this.wXb,Ia),this.E6a&&this.Gmj())};h.prototype.Gmj=function(){this.E6a&&!this.uWa&&(this.mSc=this.setTimeout(Object(Z.a)(this,this.Hmj,"sendThrottledMessageFromTimer"),0),this.uWa=!0)};h.prototype.Hmj=function(){this.uWa=!1;if(this.E6a){var ha=this.tXb,
Ia=this.RXa;this.lqb(!1);this.VJb(ha,Ia)}};h.prototype.YNi=function(){++this.FRb;this.FRb>Math.floor(this.J8a/2)&&(this.FRb=-1E9,this.Za.raiseEvent("TMUDM"))};h.prototype.SZb=function(ha){this.Za.addHandler("TMUDM",ha)};h.prototype.reset=function(){this.bFa=this.imb=this.dib=this.FRb=0;++this.tRb;for(var ha=El(this.wXb),Ia=ha.next();!Ia.done;Ia=ha.next())this.clearTimeout(Ia.value);this.MUb=0;this.wXb=[];this.lqb(!0);this.uWa&&(this.clearTimeout(this.mSc),this.mSc=0,this.uWa=!1)};h.prototype.init=
function(ha,Ia){this.vWa||(this.oBa=ha,this.J8a=Ia,this.vWa=!0)};h.createInstance=function(ha,Ia){return new h(ha,void 0===Ia?"":Ia)};h.L5c=function(ha){window.clearTimeout(ha)};h.GGe=15E3;h.zGe=5;Object(x.a)(h,"MaxOutstandingThrottler",w,[393,388]);Am(r,w);r.prototype.init=function(ha){this.vWa||(this.P8a=ha,this.vWa=!0)};r.prototype.add=function(ha){this.vWa||this.init(r.pGe);this.bFa++;var Ia=this.currentTime(),gb=new t;this.Ejb>Ia&&(this.Ejb=Ia);this.E6a?(this.lqb(!0),this.Iwc(ha,gb)):this.Ejb+
this.P8a<=Ia?this.VJb(ha,gb):(this.Iwc(ha,gb),this.setTimeout(Object(Z.a)(this,this.Fmj,"sendThrottledMessage"),this.Ejb+this.P8a-Ia));return gb};r.prototype.Fmj=function(){if(this.E6a){var ha=this.tXb,Ia=this.RXa;this.lqb(!1);this.VJb(ha,Ia)}};r.prototype.VJb=function(ha,Ia){this.Ejb=this.currentTime();ha=this.ege(ha);ha.Mnc(function(gb){Ia.wCb(gb)});ha.Lnc(function(gb){Ia.Sxa(gb)})};r.createInstance=function(ha,Ia){return new r(ha,void 0===Ia?"":Ia)};r.pGe=200;Object(x.a)(r,"MaxRateThrottler",w,
[387,388]);m.prototype.SDe=function(ha,Ia){return h.createInstance(ha,void 0===Ia?"":Ia)};m.prototype.m7g=function(ha,Ia){return r.createInstance(ha,void 0===Ia?"":Ia)};Object(x.a)(m,"ThrottlerFactory",null,[360]);var mb=b(1191);l.prototype.init=function(ha){this.tx||(this.ze=ha,this.$Va.init(this.ze.oBa,this.ze.C0h),this.tx=!0)};l.prototype.aZh=function(ha){var Ia=this;this.tx||this.init(new mb.a(r.pGe,h.GGe,h.zGe,l.Myi));if(!function(){var tc=Ia.tNc.Nc(ha);wc=tc.value;return tc}().returnValue){if(!function(){var tc=
Ia.sNc.Nc(ha);Sb=tc.value;return tc}().returnValue){var gb="MaxOutstandingThrottler-"+ha;var Sb=this.nSc.SDe(Object(Z.a)(this.$Va,this.$Va.add,"add"),gb);Sb.init(this.ze.oBa,this.ze.Lyi);Sb.SZb(function(){Ia.Za.raiseEvent("TMUDM")});this.sNc.add(ha,Sb)}gb="MaxRateThrottler-"+ha;var wc=this.nSc.m7g(Object(Z.a)(Sb,Sb.add,"add"),gb);wc.init(this.ze.Gzi);this.tNc.add(ha,wc)}return wc};l.prototype.reset=function(){for(var ha=El(this.tNc),Ia=ha.next();!Ia.done;Ia=ha.next())Ia.value.value.uHd();ha=El(this.sNc);
for(Ia=ha.next();!Ia.done;Ia=ha.next())Ia=Ia.value,Ia.value.uHd(),Ia.value.reset();this.$Va.uHd();this.$Va.reset()};l.prototype.SZb=function(ha){this.Za.addHandler("TMUDM",ha)};l.Myi=1E3;Object(x.a)(l,"ThrottlerManager",null,[359]);var La;(function(ha){ha[ha.unspecified=0]="unspecified";ha[ha.word=1]="word";ha[ha.excel=2]="excel";ha[ha.powerPoint=3]="powerPoint";ha[ha.test=4]="test";ha[ha.wacFrontEnd=5]="wacFrontEnd";ha[ha.oneNote=6]="oneNote";ha[ha.visio=7]="visio";ha[ha.officeMobile=8]="officeMobile";
ha[ha.cosmosDBChangefeed=9]="cosmosDBChangefeed";ha[ha.last=10]="last"})(La||(La={}));Object(x.b)("RtcClientAppName",La);b.d(C,"RealtimeChannel",function(){return a});a.prototype.init=function(){var ha=this;this.mh.mGg(Object(Z.a)(this,this.I6b,"disconnectAndCreateNewConnection"));this.mh.aHg(Object(Z.a)(this,this.bTi,"onUpdatePersistentStateRequestReceivedInternal"));this.mh.$Gg(Object(Z.a)(this,this.aTi,"onUpdatePersistentStateClearedRequestReceived"));this.Mg.FUc(this.Qp);pa.AFrameworkApplication.CMb(function(){ha.Qp.vHd();
fa.a.instance&&fa.a.instance.oud()});this.$De();this.ffh();this.mh.GGg(Object(Z.a)(this,this.$Pj,"updateConnectionQueryString"))};a.prototype.ffh=function(){try{var ha=$.signalR;if(!ha)throw Error.invalidOperation("Failed to retrieve Signalr object");var Ia=ha.version;if(!Ia)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===Ia){var gb=ha.transports;if(!gb)throw Error.invalidOperation("Failed to retrieve transports object");var Sb=gb.longPolling;if(!Sb)throw Error.invalidOperation("Failed to retrieve longPolling object");
if(!Sb.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");Sb.supportsKeepAlive=this.M9g()}}catch(wc){R.ULS.sendTraceTag(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",wc.message)}};a.prototype.M9g=function(){return function(){return!1}};a.prototype.$De=function(){var ha=this,Ia=++this.whb;this.qMc=(new Date(0)).getTime();this.sP=this.omg();this.mh.r3i(this.sP);this.sP.stateChanged(function(gb){ha.DHi(gb,Ia)});this.sP.connectionSlow(Object(Z.a)(this,
this.NRi,"onSlowConnection"));this.sP.error(Object(Z.a)(this,this.CRi,"onSignalRError"));this.sP.log=Object(Z.a)(this,this.DRi,"onSignalRLog")};a.prototype.Ffb=function(ha,Ia){return ha!==this.whb?(R.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",Ia),!1):!0};a.prototype.connect=function(){2!==this.TL&&1!==this.TL&&(R.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Vl),this.XGc.BHi(),Ca.a.instance.ZDj(),this.uW(1,this.TL),this.l5f())};
a.prototype.l5f=function(){var ha=this.whb;this.HRc=!1;this.Qp.pMf();this.lpa.rWh(Object(Z.a)(this,this.Y0g,"connectSignalrConnection"),Object(Z.a)(this,this.zwf,"onFailureToConnect"),Object(Z.a)(this.aAa,this.aAa.L9h,"initThrottlerManager"),Object(Z.a)(this,this.Ffb,"verifyConnectionToken"),ha)};a.prototype.zwf=function(ha){ha=void 0===ha?null:ha;this.Qp.rMf();var Ia=null;!ha||"documentsessiondeleted"!==(Ia=ha.toLowerCase())&&"documentsessionexpired"!==Ia?this.I6b():(R.ULS.sendTraceTag(41788292,
500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Vl,ha),this.disconnect())};a.prototype.I6b=function(ha,Ia){Ia=void 0===Ia?null:Ia;R.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.G1);ha=(ha=2===this.TL||1===this.TL)&&!this.aAa.lJa;var gb=!0,Sb=0;Ia&&Object.getType(Ia)!==Object.getType(Sys.EventArgs.Empty)&&Ia.hKd&&""!==Ia.hKd&&(ha=!0,this.lpa.Orj(Ia.hKd),gb=Ia.zNd,Sb=Ia.reconnectDelay);ha&&
this.uW(1,this.TL);++this.whb;this.aAa.Tv();this.ZEj(gb);this.lpa.fgh();this.$De();ha&&window.setTimeout(Object(Z.a)(this,this.l5f,"startConnecting"),Math.min(Sb,3E4))};a.prototype.$Pj=function(){var ha=this.lpa.VYe();var Ia=ha.correlationId;this.sP.qs=ha.returnValue;R.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Vl,Ia)};a.prototype.Y0g=function(ha){var Ia=this;this.qMc=(new Date).getTime();var gb=null;this.sP.qs=function(){var wc=
Ia.lpa.VYe();gb=wc.correlationId;return wc}().returnValue;this.ze.BIg&&(this.sP.url=ha,fa.a.instance&&(fa.a.instance.iBe=xa.a.UM(ha)));var Sb=null;this.Dh&&(Sb=this.Dh.Gc("WebServiceCall","ConnectToServer"));R.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Vl);ha={};this.CXb&&(ha.transport=1===this.CXb.length?this.CXb[0]:this.CXb);ha.pingInterval=null;Ca.a.instance.nHb(1,0);ha.waitForPageLoad=!1;this.sP.start(ha,null).done(function(wc){Ia.Qp.sMf();Ca.a.instance.nHb(1,
1,!0);R.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",wc.id,gb)}).fail(function(wc){var tc=b(926).RtcUtils;R.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1}, callback parameter:{2} for [{3}]",Ia.lpa.wC,gb,tc.yOa(wc),Ia.Vl);Ia.zwf();Ia.Qp.qMf(wc);Ca.a.instance.nHb(1,1,!1);tc={};Ia.mh.BKf(0,(tc.CorrelationId=gb,tc.ErrorDetails=wc,tc.ConnectionState=ka.a[Ia.TL],tc))}).always(function(){Sb&&
Sb.stop();fa.a.instance&&(fa.a.instance.oIc=!1)})};a.prototype.disconnect=function(){0===this.TL?R.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Vl):(this.Qp.vMf(),fa.a.instance&&(fa.a.instance.oIc=!0),R.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Vl),this.aAa.lJa=!0,this.XGc.BIi(),this.uW(0,this.TL),this.I6b(),this.aAa.lJa=!1)};a.prototype.ZEj=function(ha){function Ia(){if(gb.HRc)R.ULS.sendTraceTag(591692192,
500,15,"Stop connection was called twice, possibly on the same connection.");else try{gb.HRc=!0,wc.stop(!0,ha)}catch(Tb){R.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",Tb.message)}}var gb=this,Sb=this.sTg(),wc=this.sP,tc=this.G1;0<Sb?(R.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",tc,Sb),window.setTimeout(Ia,Sb)):(R.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",tc),Ia())};a.prototype.sTg=function(){var ha=0;0===this.sP.state&&
(ha=this.qMc+a.WVj-(new Date).getTime(),0>ha&&(ha=0));return ha};a.prototype.HFa=function(ha){this.mh.HFa(ha)};a.prototype.ZHb=function(ha){this.mh.ZHb(ha)};a.prototype.eXf=function(ha){this.LNd(0,ha)};a.prototype.LNd=function(ha,Ia){var gb=new W.a;this.mh.EKf(ha,Ia,gb);return gb.task};a.prototype.OFa=function(ha){this.mh.OFa(ha)};a.prototype.Oza=function(ha){this.mh.Oza(ha)};a.prototype.twb=function(ha){return this.e_h(ha)};a.prototype.Vcd=function(){return this.dIh()};a.prototype.dIh=function(){for(var ha=
{},Ia=El(this.KG),gb=Ia.next();!gb.done;gb=Ia.next())gb=gb.value,gb.value.xb(0)&&(ha[gb.key]=gb.value.oa(0).data);return ha};a.prototype.e_h=function(ha){return this.KG.xb(ha)&&this.KG.oa(ha).xb(0)?this.KG.oa(ha).oa(0).data:null};a.prototype.bTi=function(ha,Ia){ha=El(Ia.nTj);for(var gb=ha.next();!gb.done;gb=ha.next()){gb=gb.value;this.KG.xb(gb.key)||this.KG.ia(gb.key,new kb.a);var Sb=gb.value;this.KG.oa(gb.key).ia(Ia.type,new aa(Sb.Presence,new Date(Sb.TimeStamp)));gb.key===this._clientId&&0===Ia.type&&
this.mh.f3i(Sb.Presence)}};a.prototype.aTi=function(ha,Ia){ha=El(Ia.Q0c);for(Ia=ha.next();!Ia.done;Ia=ha.next())this.KG.remove(Ia.value)};a.prototype.cIh=function(){var ha=new kb.a;if(!this.KG.xb(this._clientId))return ha;for(var Ia=El(this.KG.oa(this._clientId)),gb=Ia.next();!gb.done;gb=Ia.next())gb=gb.value,ha.ia(gb.key,gb.value.data);return ha};a.prototype.Jda=function(ha,Ia,gb){Ia=void 0===Ia?null:Ia;gb=void 0===gb?!1:gb;var Sb=new W.a;this.mh.tGd(ha,Ia,gb,Sb);return Sb.task};a.prototype.NYa=
function(ha){this.mh.NYa(ha)};a.prototype.rIb=function(ha){this.mh.rIb(ha)};a.prototype.Cva=function(ha){var Ia=this,gb,Sb;return function(){var wc=Ia.KG.Nc(ha);gb=wc.value;return wc}().returnValue&&function(){var wc=gb.Nc(0);Sb=wc.value;return wc}().returnValue?new J(this.i_h(Sb),Sb.timeStamp):null};a.prototype.iIh=function(){for(var ha={},Ia={},gb=El(this.KG),Sb=gb.next();!Sb.done;Ia={ggb:Ia.ggb,WDc:Ia.WDc},Sb=gb.next())Ia.ggb=Sb.value,Ia.WDc=void 0,function(wc){return function(){var tc=wc.ggb.value.Nc(0);
wc.WDc=tc.value;return tc}}(Ia)().returnValue&&(ha[Ia.ggb.key]=this.Cva(Ia.ggb.key));return ha};a.prototype.$eb=function(ha){var Ia=new W.a;this.mh.G3i(ha,Ia);return Ia.task};a.prototype.dispose=function(){this.It||(this.aAa.Tv(),this.Mg.$9i(this.Qp),this.Qp.vHd(),fa.a.instance&&fa.a.instance.oud(),this.It=!0)};a.prototype.DHi=function(ha,Ia){this.Ffb(Ia,"StateChangedSignalR")&&this.uW(this.XBe(ha.newState),this.XBe(ha.oldState))};a.prototype.uW=function(ha,Ia){if((1!==this.TL||0!==Ia||1!==ha)&&this.TL!==
Ia){var gb=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.TL,Ia,ha]));R.ULS.sendTraceTag(3290053,500,10,gb)}if(this.TL!==ha){switch(ha){case 2:fa.a.instance&&fa.a.instance.Xxi();this.G1=this.sP.id;R.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.G1,this.Vl);this.Wvi(this.sP);R.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");gb=null;this.Dh&&
(gb=this.Dh.Gc("WebServiceCall","Receive First Presence"));var Sb=this.whb;this.mh.q3i(Object(Z.a)(this,this.Ffb,"verifyConnectionToken"),Sb,this.XGc,Object(Z.a)(this,this.u0c,"clearExistingPersistentState"),this.cIh(),gb);this.ze.rtcClientMessageTelemetryEnabled&&F.Lfd(this.mh,this.ze,100*Math.random()<=this.ze.bij).start();break;case 1:2===Ia&&R.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.G1);break;case 0:if(F.instance&&F.instance.stop(),
this.aAa.lJa)R.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.G1);else{1===Ia&&(R.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.G1),this.Qp.wMf());2===Ia&&R.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.G1);
this.I6b();return}}this.TL=ha;this.mh.F2i(ha,Ia)}};a.prototype.Wvi=function(ha){if(ha&&ha.transport&&ha.transport.name){ha=ha.transport.name;var Ia=ha.toLowerCase();"websockets"===Ia?R.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",ha,this.Vl):"serversentevents"===Ia?R.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",ha,this.Vl):"foreverframe"===Ia?R.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",ha,this.Vl):"longpolling"===Ia?R.ULS.sendTraceTag(4290754,
500,50,"Transport name - {0} for [{1}]",ha,this.Vl):"mocktransport"!==Ia&&R.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",ha)}else R.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")};a.prototype.NRi=function(){if(this.ze.hUf){var ha=xa.a.oB(this.B8a,"mid");R.ULS.sendTraceTag(3249544,500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.G1,ha)}else R.ULS.sendTraceTag(522716053,500,50,"Detected that the connection [{0}] is slow",
this.G1)};a.prototype.CRi=function(){R.ULS.sendTraceTag(3249545,600,15,"SignalR ERROR for connection [{0}];",this.G1)};a.prototype.DRi=function(ha){ha=b(926).RtcUtils.yOa(ha);if(this.ze.hUf&&ha.startsWith("Keep alive timed out.")){var Ia=xa.a.oB(this.B8a,"mid");R.ULS.sendTraceTag(522716054,500,15,"SignalR lib: {0}. Target Machine: {1}",ha,Ia)}else this.gBj&&2E3>this.Wge&&!ha.startsWith("Invok")&&!ha.startsWith("Trigger")&&(R.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",ha),this.Wge++)};a.prototype.u0c=
function(){var ha=[],Ia=this.KG.Nc(this._clientId);var gb=Ia.value;Ia.returnValue&&this.KG.remove(this._clientId);var Sb=El(this.KG.keys);for(Ia=Sb.next();!Ia.done;Ia=Sb.next())Array.add(ha,Ia.value);Sb=El(ha);for(Ia=Sb.next();!Ia.done;Ia=Sb.next())this.KG.remove(Ia.value);gb&&this.KG.ia(this._clientId,gb);this.mh.a3i(ha)};a.prototype.XBe=function(ha){switch(ha){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",ha,"Unknown SignalR state");
}};a.prototype.i_h=function(ha){return ha&&ha.timeStamp?(new Date).getTime()-ha.timeStamp.getTime()>(this.ze.$Mg?6E4:this.ze.ZMg)?2:1:1};a.createInstance=function(ha,Ia,gb,Sb,wc,tc,Tb,pb,cb,ob,rc,Db,Ja){return f(ha,Ia,gb,void 0===Ja?null:Ja,Sb,wc,tc,Tb,void 0===pb?null:pb,void 0===cb?null:cb,void 0===ob?null:ob,void 0===Db?null:Db,void 0===rc?null:rc)};Ek.Object.defineProperties(a.prototype,{B8a:{configurable:!0,enumerable:!0,get:function(){return this.lpa.B8a},set:function(ha){this.lpa.B8a=ha}},
aAa:{configurable:!0,enumerable:!0,get:function(){return this.cvg}},mh:{configurable:!0,enumerable:!0,get:function(){return this.Jjg}},connectionState:{configurable:!0,enumerable:!0,get:function(){return this.TL}},clientId:{configurable:!0,enumerable:!0,get:function(){return this._clientId}},gBj:{configurable:!0,enumerable:!0,get:function(){return this.bwg}}});a.Tof=31E3;a.$vd=8E3;a.WVj=15E3;Object(x.a)(a,"RealtimeChannel",null,[309,310])},1085:function(x,C,b){function a(){this.Ahe=!1;this.jPc=null;
this.l4d=0;this.DIc=this.cFe();this.sRb=this.cFe();this.RCa=this.XVa=0;this.Gw=function(){return new Date}}b.d(C,"a",function(){return a});x=b(0);a.prototype.cFe=function(){for(var c=Array(6),e=0;e<c.length;e++)c[e]=0;return c};a.prototype.zOh=function(){return this.DIc.toString()};a.prototype.mLh=function(){return this.sRb.toString()};a.prototype.ZDj=function(){this.jPc=this.Gw()};a.prototype.nHb=function(c,e,f){if(!this.QFj){if(void 0===f?0:f)this.Ahe=!0;f=this.Gw();0===c&&5<this.XVa||1===c&&5<
this.RCa||(this.l4d<c?(1===this.XVa%2&&(this.DIc[this.XVa]=-1,this.XVa++),this.l4d=c,1===e&&(this.sRb[this.RCa]=-1,this.RCa++),this.sRb[this.RCa]=this.gUd(f),this.RCa++):0===c?(this.DIc[this.XVa]=this.gUd(f),this.XVa++):(this.sRb[this.RCa]=this.gUd(f),this.RCa++))}};a.prototype.gUd=function(c){var e=c.getTime()-this.jPc.getTime();this.jPc=c;return e};Ek.Object.defineProperties(a.prototype,{QFj:{configurable:!0,enumerable:!0,get:function(){return this.Ahe}}});Ek.Object.defineProperties(a,{instance:{configurable:!0,
enumerable:!0,get:function(){a.Ma||(a.Ma=new a);return a.Ma},set:function(c){a.Ma=c}}});a.Ma=null;Object(x.a)(a,"LatencyMetrics",null,[])},1144:function(x,C,b){function a(h){this.iBe=this.mTe=null;this.Sof=this.cVe=0;this.Qp=null;this.Gae=this.eNc=0;this.Mg=h;this.jai();this.oIc=this.H6d=this.BNc=!1;this.ZMc=0}x=b(0);var c=b(14),e=b(82),f=b(112),l;(function(h){h[h.SendNotification=0]="SendNotification";h[h.SendPersistentState=1]="SendPersistentState";h[h.FindSession=2]="FindSession";h[h.Last=3]="Last"})(l||
(l={}));Object(x.b)("ApiType",l);var m;(function(h){h[h.AttemptCount=0]="AttemptCount";h[h.SuccessCount=1]="SuccessCount";h[h.DropCount=2]="DropCount";h[h.FailedCount=3]="FailedCount";h[h.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";h[h.LatencyUnderThresholdCount=5]="LatencyUnderThresholdCount";h[h.ThrottledCount=6]="ThrottledCount";h[h.Last=7]="Last"})(m||(m={}));Object(x.b)("EventCountType",m);var r=b(1085);b.d(C,"a",function(){return a});a.prototype.XDj=function(h){this.Gae=h;window.setInterval(Object(e.a)(this,
this.oud,"logMetricsBatchAndReset"),h);this.eNc=(new Date).getTime()};a.prototype.ly=function(h,w){this.ivj(h)&&!this.H6d||this.Jxh||!window.navigator.onLine||this.Mg.I6a||(this.Qp[h][w]++,this.BNc=!0)};a.prototype.jai=function(){this.Qp=Array(3);for(var h=0;3>h;h++){this.Qp[h]=Array(7);for(var w=0;7>w;w++)this.Qp[h][w]=0}};a.prototype.vQg=function(){for(var h={},w=0;3>w;w++)for(var n=0;7>n;n++)this.Sni(w,n)&&(h[l[w]+m[n]]=this.Qp[w][n]);h.FSDomain=this.mTe;h.ConnectionDomain=this.iBe;h.FSRetryInterval=
this.cVe;h.MaxPayloadSize=this.Sof;h.LogNumber=this.ZMc;1===this.ZMc&&(h.FSLatencies=r.a.instance.zOh(),h.ConLatencies=r.a.instance.mLh());return h};a.prototype.Sni=function(h,w){return 2===h&&3!==w&&0!==w?!1:!0};a.prototype.ivj=function(h){return 2===h?!1:!0};a.prototype.oud=function(){if(this.BNc){this.ZMc++;if((new Date).getTime()-this.eNc<5E3+this.Gae){var h=f.a.toJSON(this.vQg());c.ULS.sendTraceTag(50644352,500,15,h)}this.eNc=(new Date).getTime();for(h=0;3>h;h++)for(var w=0;7>w;w++)this.Qp[h][w]=
0;this.BNc=!1}};a.prototype.Xxi=function(){this.H6d=!0};a.create=function(h){a.instance||(a.Ma=new a(h));return a.instance};Ek.Object.defineProperties(a.prototype,{Jxh:{configurable:!0,enumerable:!0,get:function(){return this.oIc}}});Ek.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Ma}}});a.Ma=null;Object(x.a)(a,"FrequentLoggingMetrics",null,[345])},1189:function(x,C,b){function a(e,f,l,m){var r=c.call(this)||this;r.type=e;r.g8=f;r.ddh=l;r.koa=m;return r}
b.d(C,"a",function(){return a});x=b(0);var c=Sys.EventArgs;Am(a,c);Object(x.a)(a,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1190:function(x,C,b){function a(){}b.d(C,"a",function(){return a});x=b(0);a.hMd="rr";a.cij="rd";a.aij="rbp";a.zNd="sa";Object(x.a)(a,"RtcReconnectParams",null,[])},1191:function(x,C,b){function a(c,e,f,l){this.Gzi=c;this.oBa=e;this.Lyi=f;this.C0h=l}b.d(C,"a",function(){return a});x=b(0);Object(x.a)(a,"ThrottlerManagerSettings",null,[])},1297:function(x,C,b){function a(){this.Za=
new ma.a}function c(pa,xa){var va=ka.call(this)||this;va.type=pa;va.nTj=xa;return va}function e(pa){var xa=W.call(this)||this;xa.Q0c=pa;return xa}function f(pa,xa){var va=Z.call(this)||this;va.bZj=pa;va.SZj=xa;return va}function l(pa,xa,va){var ta=J.call(this)||this;ta.type=pa;ta.presence=xa;ta.koa=va;return ta}function m(pa,xa){var va=D.call(this)||this;va.oZj=pa;va.errorMessage=xa;return va}function r(pa){var xa=F.call(this)||this;xa.hubConnection=pa;return xa}function h(pa,xa,va,ta,fa,Ca){var Sa=
aa.call(this)||this;Sa.Ffb=pa;Sa.l2c=xa;Sa.c1g=va;Sa.uRe=fa;Sa.u0c=ta;Sa.stopwatch=Ca;return Sa}function w(pa){var xa=U.call(this)||this;xa.s_j=pa;return xa}function n(pa,xa){xa=void 0===xa?null:xa;var va=ca.call(this)||this;va.jC=pa;va.Oxg=xa;return va}function v(pa,xa){var va=P.call(this)||this;va.type=pa;va.bP=xa;return va}function u(pa){var xa=Q.call(this)||this;xa.Q0c=pa;return xa}function t(pa){var xa=M.call(this)||this;xa.presence=pa;return xa}function y(pa,xa){var va=z.call(this)||this;va.vYg=
pa;va.koa=xa;return va}function E(pa,xa){var va=B.call(this)||this;va.newState=pa;va.oldState=xa;return va}x=b(0);var B=Sys.EventArgs;Am(E,B);Object(x.a)(E,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);var z=Sys.EventArgs;Am(y,z);Object(x.a)(y,"ClientInfoEventArgs",Sys.EventArgs,[]);var M=Sys.EventArgs;Am(t,M);Object(x.a)(t,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);var Q=Sys.EventArgs;Am(u,Q);Object(x.a)(u,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);var P=Sys.EventArgs;Am(v,P);
Object(x.a)(v,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var L=b(1370),ca=Sys.EventArgs;Am(n,ca);Ek.Object.defineProperties(n.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.jC}},g8:{configurable:!0,enumerable:!0,get:function(){return this.Oxg}}});Object(x.a)(n,"UpdateNotificationEventArgs",Sys.EventArgs,[]);var U=Sys.EventArgs;Am(w,U);Object(x.a)(w,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);var aa=Sys.EventArgs;Am(h,aa);Object(x.a)(h,"RefreshAllPersistentStateEventArgs",
Sys.EventArgs,[]);var F=Sys.EventArgs;Am(r,F);Object(x.a)(r,"RefreshProxyEventArgs",Sys.EventArgs,[]);var D=Sys.EventArgs;Am(m,D);Object(x.a)(m,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);var J=Sys.EventArgs;Am(l,J);Object(x.a)(l,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var R=b(1189),Z=Sys.EventArgs;Am(f,Z);Object(x.a)(f,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);var W=Sys.EventArgs;Am(e,W);Object(x.a)(e,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);var ka=
Sys.EventArgs;Am(c,ka);Object(x.a)(c,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var ma=b(97);b.d(C,"a",function(){return a});a.prototype.F2i=function(pa,xa){this.Za.raiseEvent("CSC",new E(pa,xa))};a.prototype.r3i=function(pa){this.Za.raiseEvent("RP",new r(pa))};a.prototype.krc=function(pa){this.Za.raiseEvent("RC",pa)};a.prototype.t3i=function(){this.Za.raiseEvent("RMID")};a.prototype.q3i=function(pa,xa,va,ta,fa,Ca){this.Za.raiseEvent("RPS",new h(pa,xa,va,ta,fa,Ca))};a.prototype.MKf=
function(pa,xa){this.Za.raiseEvent("UPSR",new c(pa,xa))};a.prototype.wKf=function(pa,xa){this.Za.raiseEvent("PU",new L.a(pa,xa))};a.prototype.f3i=function(pa){this.Za.raiseEvent("MPU",new t(pa))};a.prototype.tGd=function(pa,xa,va,ta){this.Za.raiseEvent("SUN",new R.a(pa,xa,va,ta))};a.prototype.H3i=function(pa,xa){this.Za.raiseEvent("UNR",new n(pa,xa))};a.prototype.EKf=function(pa,xa,va){this.Za.raiseEvent("SP",new l(pa,xa,va))};a.prototype.n3i=function(pa,xa){this.Za.raiseEvent("PSU",new v(pa,xa))};
a.prototype.m3i=function(pa){this.Za.raiseEvent("PSC",new u(pa))};a.prototype.a3i=function(pa){this.Za.raiseEvent("IPSC",new u(pa))};a.prototype.I3i=function(pa){this.Za.raiseEvent("UPSC",new e(pa))};a.prototype.x3i=function(pa,xa){this.Za.raiseEvent("SPC",new f(pa,xa))};a.prototype.BKf=function(pa,xa){this.Za.raiseEvent("RCF",new m(pa,xa))};a.prototype.V2i=function(pa){this.Za.raiseEvent("CPSWM",new w(pa))};a.prototype.G3i=function(pa,xa){this.Za.raiseEvent("UCI",new y(pa,xa))};a.prototype.HFa=function(pa){this.Za.addHandler("CSC",
pa)};a.prototype.ZHb=function(pa){this.Za.removeHandler("CSC",pa)};a.prototype.nGg=function(pa){this.Za.addHandler("RP",pa)};a.prototype.mGg=function(pa){this.Za.addHandler("RC",pa)};a.prototype.rGg=function(pa){this.Za.addHandler("RMID",pa)};a.prototype.lGg=function(pa){this.Za.addHandler("RPS",pa)};a.prototype.aHg=function(pa){this.Za.addHandler("UPSR",pa)};a.prototype.OFa=function(pa){this.Za.addHandler("PU",pa)};a.prototype.Oza=function(pa){this.Za.removeHandler("PU",pa)};a.prototype.XEg=function(pa){this.Za.addHandler("IPU",
pa)};a.prototype.ZGg=function(pa){this.Za.addHandler("UCI",pa)};a.prototype.EGg=function(pa){this.Za.addHandler("SUN",pa)};a.prototype.YEg=function(pa){this.Za.addHandler("IUNR",pa)};a.prototype.NYa=function(pa){this.Za.addHandler("UNR",pa)};a.prototype.rIb=function(pa){this.Za.removeHandler("UNR",pa)};a.prototype.WEg=function(pa){this.Za.addHandler("IPSU",pa)};a.prototype.VEg=function(pa){this.Za.addHandler("IPSC",pa)};a.prototype.$Gg=function(pa){this.Za.addHandler("UPSC",pa)};a.prototype.DGg=function(pa){this.Za.addHandler("SP",
pa)};a.prototype.GGg=function(pa){this.Za.addHandler("SPC",pa)};a.getInstance=function(){return a.Ma||(a.Ma=new a)};a.Ma=null;Object(x.a)(a,"RtcEventHub",null,[361])},1301:function(x,C,b){function a(D,J,R,Z,W,ka,ma,pa,xa,va,ta,fa,Ca){var Sa=this;Ca=void 0===Ca?null:Ca;this.F$d=(new Date(0)).getTime();this.Mae=0;this.pUb=!1;this.jge=null;this.EHd=36E5;this.sVa=a.d$e;this.qib=0;this.GQa=null;this.Cda=0;this.bcb=this.jBe=null;this.Dug=[h.Nzb,h.errorMessage,h.l4f,h.wC,h.U6,h.g4e,h.J8a,h.oBa,h.P8a];this.Cug=
[h.Nzb,h.errorMessage];this.wC=this.B8a=null;this.D6d=new l(ta?ta:function(){return t.AFrameworkApplication.oj},W,ka,ma,D,J);this.chb=fa;this.Dh=Z;this.Mg=J;this.nog=R;this.Vl=pa;this.mh=xa;this.Aib=Ca;this.E6d=!1;this.U9b=9E4;va&&va.execute(function(Gb){Gb.FZb(function(){w.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",Sa.Vl);Sa.D6d.hNf()})});2>=100*Math.random()&&(this.EHd=3E5);L.a.instance&&(L.a.instance.cVe=this.EHd)}function c(){}function e(){}function f(){}
function l(D,J,R,Z,W,ka){this.BEa=null;var ma=b(1301).FindSessionStrategy;this.Wtg=D;D=String.format("{0}={1}",m.clientId,Q.a.mf(Z));D=String.format("{0}&{1}={2}",D,m.userSessionId,Q.a.mf(W));D=String.format("{0}&{1}={2}",D,m.ITj,Q.a.mf(R.toString()));D=String.format("{0}&{1}={2}",D,m.userType,Q.a.mf("1"));D=String.format("{0}&{1}={2}",D,m.bUj,Q.a.mf(J));D=String.format("{0}&{1}={2}",D,m.zYg,Q.a.mf(ma.xYg));(J=l.HIh(R,ka))&&(D=String.format("{0}&{1}",D,J));this.qmg=D}function m(){}function r(){this.h4e=
this.Qof=this.Rof=this.Vof=0;this.Yhc=!1;this.correlationId=this.wC=this.U6=this.m2c=this.errorMessage=null}function h(){}b.r(C);x=b(0);var w=b(14),n=b(82),v=b(202),u=b(1188);h.P8a="throttling_messageDelay";h.Nzb="enabled";h.oBa="throttling_timeToWaitForResponse";h.J8a="throttling_maxNumberOfOutstandingMessages";h.g4e="throttling_globalMaxNumberOfOutstandingMessages";h.errorMessage="errorMessage";h.l4f="url";h.U6="queryString";h.wC="connectionString";Object(x.a)(h,"RtcFindSessionOutputFieldNameConstants",
null,[]);var t=b(4),y=b(80),E=b(39),B=b(497),z=b(898),M=b(112),Q=b(29),P=b(176);Ek.Object.defineProperties(r.prototype,{h0g:{configurable:!0,enumerable:!0,get:function(){return this.m2c+"?"+this.U6}}});Object(x.a)(r,"FindSessionResponse",null,[]);m.clientId="ClientId";m.ITj="UserApp";m.userSessionId="usid";m.userType="UserType";m.bUj="UserVersion";m.Zqc="qs";m.zYg="clientProtocol";m.HCi="NoAuth";Object(x.a)(m,"RtcFindSessionInputQueryParamConstants",null,[]);l.prototype.hNf=function(){this.BEa=this.Wtg()};
l.prototype.qcd=function(){this.BEa&&""!==this.BEa||(this.hNf(),w.ULS.sendTraceTag(575784194,500,this.BEa&&""!==this.BEa?50:15,"Query signature delegate called for refresh returned: {0} ",this.BEa));var D=String.format("{0}={1}",m.Zqc,Q.a.mf(this.BEa));return String.format("{0}&{1}",D,this.qmg)};l.HIh=function(D,J){return 4===D?String.format("{0}={1}",m.HCi,"1"):J?J.m_h():null};Object(x.a)(l,"FindSessionQueryStringGenerator",null,[]);var L=b(1144),ca=b(1085),U=b(926),aa=b(1191);f.jBh="FSType";Object(x.a)(f,
"RtcFindSessionRequestHeaders",null,[]);e.d5i="polling";Object(x.a)(e,"RtcFindSessionTypes",null,[]);var F=b(1190);c.QUj="RTC-TokenProofkey";c.ioi="RTC-IsWacJsBootFsRequest";Object(x.a)(c,"RtcRequestHeaders",null,[]);b.d(C,"FindSessionStrategy",function(){return a});a.prototype.Orj=function(D){this.bcb=D};a.prototype.init=function(){this.mh.rGg(Object(n.a)(this,this.tfj,"resetGetMachineIdDelay"));this.mh.HFa(Object(n.a)(this,this.uW,"onConnectionStateChanged"))};a.prototype.uW=function(D,J){this.Cda=
J.newState;2===J.newState&&(this.qib=0)};a.prototype.VYe=function(){var D=this.GQa.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.GQa.U6,a.qCe,Q.a.mf(D)),correlationId:D}};a.prototype.rWh=function(D,J,R,Z,W){var ka=this;this.dmj(function(){Z(W,"GetMachineIdSuccess")&&(w.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",ka.wC,ka.Vl),D(ka.jge),R(ka.cZh()))},function(ma){Z(W,"GetMachineIdFailure")&&(w.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",
ka.Vl),J(ma))},Z,W)};a.prototype.fgh=function(){this.Dye();this.o8h()};a.prototype.dmj=function(D,J,R,Z){var W=this;w.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.wC);if(this.wC)D();else{var ka=this.fTg();window.setTimeout(function(){W.sendFindSessionRequestToServerInternal(D,J,R,Z)},ka)}};a.prototype.sendFindSessionRequestToServerInternal=function(D,J,R,Z){var W=this;R(Z,"RequestMachineId")&&(this.F$d=(new Date).getTime(),
R=E.a.Ce(),this.WYe(function(ka){var ma=E.a.Ce();W.rFf(ka);W.bPd();D();ka=E.a.Ce()-ma;w.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",ka)},function(ka){var ma=E.a.Ce();W.Dye();L.a.instance&&L.a.instance.ly(2,3);J(ka);ka=E.a.Ce()-ma;w.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ka)},!1),R=E.a.Ce()-R,w.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",R))};a.prototype.o8h=function(){this.sVa+=a.RRh;this.sVa=Math.min(this.sVa,a.xyi)};a.prototype.fTg=
function(){var D=(new Date).getTime();D=this.F$d+this.sVa-D;0>D&&(D=0);return D};a.prototype.rFf=function(D){try{this.GQa=D,this.B8a=D.h0g,this.wC=D.wC,this.jBe=D.U6,this.jge=D.m2c}catch(J){w.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",J.toString())}};a.prototype.Dye=function(){this.wC=null;this.Eye()};a.prototype.bPd=function(){this.Eye();this.pUb=!0;this.Mae=window.setTimeout(Object(n.a)(this,this.I6i,"refreshMachineId"),this.EHd)};a.prototype.Eye=
function(){this.pUb&&(window.clearTimeout(this.Mae),this.pUb=!1)};a.prototype.I6i=function(){var D=this;this.pUb=!1;this.WYe(function(J){var R=D.jBe!==J.U6,Z=D.wC!==J.wC,W=D.wC;D.rFf(J);0!==D.Cda&&(Z?(w.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",W||"null",J.wC),D.mh.krc()):(D.mh.x3i(R,Z),D.bPd()))},function(){L.a.instance&&L.a.instance.ly(2,3);D.bPd()},!0)};a.prototype.tfj=function(){this.sVa=a.d$e};a.prototype.cZh=function(){return new aa.a(this.GQa.Vof,
this.GQa.Rof,this.GQa.Qof,this.GQa.h4e)};a.prototype.gLj=function(D){if(Object.getType(D)!==Object)return null;for(var J in D);return this.$5g(D)};a.prototype.$5g=function(D){if(!(h.Nzb in D))return null;for(var J=D[h.Nzb],R=El(J?this.Dug:this.Cug),Z=R.next();!Z.done;Z=R.next())if(!(Z.value in D))return null;R=Object.assign(new r,{Yhc:D[h.Nzb],errorMessage:D[h.errorMessage],correlationId:P.a.create().toString()});J&&(R.m2c=D[h.l4f],R.U6=D[h.U6],R.wC=D[h.wC],R.h4e=D[h.g4e],R.Qof=D[h.J8a],R.Rof=D[h.oBa],
R.Vof=D[h.P8a]);return R};a.prototype.AOh=function(D,J){var R=this;w.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.Aib.hBh.continueWith(function(){R.Aib.hBh.result?(w.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),D(R.Aib.iBh)):(w.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),J(R.Aib.iBh))})};a.prototype.fSf=function(D,J,R,Z,W){var ka=this;W=void 0===W?!1:W;return function(ma){ca.a.instance.nHb(0,
1);D&&D.stop();ka.bcb=null;ka.chb=null;ka.gmf(ma.data,!0,J);var pa=U.RtcUtils.deserialize(ma.data.ke,"FindSession",null);if(pa)if(pa=ka.gLj(pa)){if(pa.Yhc&&pa.U6&&pa.wC){w.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",ka.Vl);ka.Kti(ma.data);R(pa);return}J.FindSessionFailureReason="FindSessionInvalidResponse";J.IsRtcEnabled=pa.Yhc;J.IsQueryStringEmpty=!pa.U6;J.IsConnectionStringEmpty=!pa.wC;w.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",
ka.Vl,pa.Yhc,!pa.U6,!pa.wC)}else J.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",w.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",ka.Vl);else J.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",w.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",ka.Vl);ka.CKf(J,W);Z(null)}};a.prototype.ZRf=function(D,J,R,Z){var W=this;Z=void 0===Z?!1:Z;return function(ka){ca.a.instance.nHb(0,
1);D&&D.stop();W.bcb=null;W.chb=null;W.gmf(ka.data,!1,J);var ma=null,pa="unknown",xa="unknown";ka.data&&((pa=ka.data.responseHeaders)&&a.iJb in pa&&(ma=pa[a.iJb].toString()),pa=z.a[ka.data.status],xa=ka.data.httpStatus.toString());J.FindSessionFailureReason="FindSessionRequestFailed";J.HttpErrorCode=xa;J.HttpErrorStatus=pa;J[a.iJb]=ma;w.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",pa,xa,W.Vl,ma,Z);
W.CKf(J,Z);R(xa)}};a.prototype.WYe=function(D,J,R){var Z=this;R=void 0===R?!1:R;var W=null;w.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Vl);var ka={},ma=this.D6d.qcd();ka[B.a.hZ]=P.a.create().toString();this.bcb&&""!==this.bcb?ma=String.format("{0}&{1}={2}",ma,F.a.hMd,this.bcb):this.chb&&""!==this.chb&&(ma=String.format("{0}&{1}={2}",ma,F.a.hMd,this.chb),ka[c.QUj]="True",ka[c.ioi]="True");ma=this.nog+"?"+ma;R&&(ka[f.jBh]=e.d5i);var pa={};pa.IsNetworkOfflineBeforeSendRequest=
this.Mg.I6a;pa.HasAvailableConnectionsBeforeSendRequest=this.Mg.k6e;pa.MaxConnectionsAllowed=this.Mg.Zkc;pa.IsRefreshMachineId=R;this.Aib&&!this.E6d?(this.AOh(this.fSf(null,pa,D,J,R),this.ZRf(null,pa,J,R)),this.E6d=!0):(this.Dh&&(W=this.Dh.Gc("WebServiceCall","GetMachineIdFromTheServer")),L.a.instance&&L.a.instance.ly(2,0),0>this.Mg.K9(ma,1,null,ka,[a.h4b,a.iJb,a.FDb,a.gMd,a.uqf,a.Esf,a.Dsf],!1,1,this.fSf(W,pa,D,J,R),this.ZRf(W,pa,J,R),null,null,!1,null,this.U9b,"3",null,!0)&&(5<this.qib&&200>this.qib&&
w.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.qib),window.setTimeout(function(){Z.qib++;J("-1")},1E3)))};a.prototype.gmf=function(D,J,R){R||(R={});R.IsNetworkOfflineAfterRequestComplete=this.Mg.I6a;R.IsRequestSucceeded=J;D&&(R.EnqueueTime=D.Z7b,R.InvokedTime=D.pF,R.CompletedTime=D.s3,D.responseHeaders&&(a.h4b in D.responseHeaders&&(R.CorrelationId=D.responseHeaders[a.h4b]),a.FDb in D.responseHeaders&&
(R[a.FDb]=D.responseHeaders[a.FDb])));w.ULS.sendTraceTag(38633565,500,J?50:15,U.RtcUtils.yOa(R))};a.prototype.CKf=function(D,J){D||(D={});D.ConnectionState=u.a[this.Cda];J||this.mh.BKf(1,D)};a.prototype.Kti=function(D){try{var J=!1,R=!1,Z=D.responseHeaders,W=y.a.UM(D.request.get_url());if(Z&&a.gMd in Z){var ka=Z[a.gMd].toString().toLocaleLowerCase();R="true"===ka;J="false"===ka}Z=!1;var ma=0<=W.toLocaleLowerCase().indexOf("collab");R&&!ma?Z=!0:J&&ma&&(Z=!0);if(Z){J={HostName:W};J.Status=z.a[D.status];
J.HttpStatus=D.httpStatus.toString();var pa=D.request.get_headers(),xa;for(xa in pa){var va=pa[xa];(R=xa)&&0<R.length&&(W=0,va&&(W=va.toString().length),J["r_"+R]=W)}if(D.responseHeaders){var ta=new v.a;ta.add(a.h4b);ta.add(a.FDb);ta.add(a.iJb);ta.add(a.Esf);ta.add(a.Dsf);ta.add(a.uqf);a.hCg(J,D.responseHeaders,ta)}a.WBg(D.request.get_url(),J);var fa=M.a.toJSON(J);w.ULS.sendTraceTag(559437006,500,15,fa)}}catch(Ca){w.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",Ca.toString())}};
a.createInstance=function(D,J,R,Z,W,ka,ma,pa,xa,va,ta,fa){return a.T6g(D,J,R,Z,W,ka,ma,pa,xa,va,ta,void 0===fa?null:fa)};a.T6g=function(D,J,R,Z,W,ka,ma,pa,xa,va,ta,fa){fa=void 0===fa?null:fa;D=D||P.a.create().toString();D=new a(D,J,R,Z,W,ka,ma,pa,xa,va,null,ta,fa);D.init();return D};a.hCg=function(D,J,R){R=El(R);for(var Z=R.next();!Z.done;Z=R.next())Z=Z.value,Z in J&&(D[Z]=J[Z])};a.WBg=function(D,J){if(D){var R=D.indexOf("?");if(-1!==R)for(D=D.substr(R+1).split("&"),R=0;R<D.length;++R){var Z=D[R].split("=");
if(2===Z.length){var W=Z[0];if(W&&0<W.length){var ka=0;if(Z=Z[1])ka=Z.length;J["q_"+W]=ka}}}}};a.RRh=3E3;a.xyi=3E5;a.xYg="1.0";a.d$e=1E3;a.h4b="X-CorrelationId";a.qCe="corrid";a.iJb="RtcErrorCode";a.FDb="X-OfficeCluster";a.gMd="X-NewEnv";a.uqf="X-MSEdge-Ref";a.Dsf="X-OFFICEFD";a.Esf="X-OfficeFE";Object(x.a)(a,"FindSessionStrategy",null,[357])},1369:function(x,C,b){function a(){this.hce=this.ice=this.jce=this.fce=this.ece=this.gce=this.vkb=this.fOc=0;this.ISb=this.FMc=this.Gjb=this.yMc=this.zMc=this.pMc=
this.oqa=this.Djb=this.AWa=this.oMc=this.GSb=this.PVa=null;this.oNc=this.akb=this.hge=this.s3d=0;this.kbe=!1;this.pMf=this.kHd;this.sMf=this.nHd;this.rMf=this.mHd;this.wMf=this.pHd;this.vMf=this.oHd;this.vHd=this.wHd;this.sHd=this.tHd;this.bQa=this.qHd;this.oHb=this.rHd;this.qMf=this.lHd;this.hDb=this.Jxd;this.Wlc=this.Lxd}b.r(C);b.d(C,"RealtimeChannelMetrics",function(){return a});x=b(0);var c=b(14),e=b(243),f=b(112),l=b(926);a.prototype.kHd=function(){this.fOc++;this.oMc=new Date;this.PVa||(this.PVa=
new Date)};a.prototype.nHd=function(){this.vkb++;this.oqa=new Date;this.GSb||(this.GSb=this.oqa);this.Gjb=this.oqa;this.r0g()};a.prototype.mHd=function(){this.gce++;this.pMc=new Date};a.prototype.pHd=function(){this.ece++;this.AWa=new Date};a.prototype.oHd=function(){this.fce++;this.Djb=new Date};a.prototype.tHd=function(){this.zMc=new Date;this.jce++};a.prototype.rHd=function(){this.ISb||(this.ISb=new Date);this.ice++};a.prototype.qHd=function(){this.yMc=new Date;this.hce++};a.prototype.wHd=function(){!this.kbe&&
this.fOc&&(c.ULS.sendTraceTag(39321871,500,15,f.a.toJSON(this.BZg())),this.kbe=!0)};a.prototype.lHd=function(m){var r=l.RtcUtils.dyh(m);m=r.F8e;var h=r.H8e;r=r.exception;if(m&&m!==e.a.kP){var w={};c.ULS.sendTraceTag(40157596,500,15,f.a.toJSON((w.HttpErrorCode=m,w.HttpErrorStatus=h,w.Exception=r,w)));e.a.Ebf(m)&&this.s3d++;e.a.qgf(m)&&this.hge++}};a.prototype.Jxd=function(){this.FMc=new Date};a.prototype.Lxd=function(){this.AWa=this.Gjb=new Date};a.prototype.BZg=function(){var m={};return m.numberOfConnectionAttempts=
this.fOc,m.numberOfSuccessfulConnections=this.vkb,m.numberOfFailedConnections=this.gce,m.numberOfDisconnectedConnections=this.ece,m.numberOfExplicitDisconnectedConnections=this.fce,m.numberOfSentMessages=this.jce,m.numberOfReceivedMessages=this.ice,m.numberOfLostMessages=this.hce,m.firstConnectionAttempt=this.PVa?this.PVa:null,m.firstMessageReceived=this.ISb?this.ISb:null,m.firstConnectionSuccess=this.GSb?this.GSb:null,m.lastConnectionAttempt=this.oMc?this.oMc:null,m.lastConnectionSuccess=this.oqa?
this.oqa:null,m.lastConnectionFailure=this.pMc?this.pMc:null,m.lastMessageSent=this.zMc?this.zMc:null,m.lastMessageLost=this.yMc?this.yMc:null,m.lastDisconnect=this.AWa?this.AWa:null,m.lastExplicitDisconnect=this.Djb?this.Djb:null,m.lastTimeOnline=this.Gjb?this.Gjb:null,m.lastTimeOffline=this.FMc?this.FMc:null,m.maxDisconnectedTimeMs=this.akb,m.maxExplicitDisconnectedTimeMs=this.oNc,m.clientConnectionErrors=this.s3d,m.serverConnectionErrors=this.hge,m};a.prototype.r0g=function(){this.PVa&&1===this.vkb&&
(this.akb=Math.max(this.akb,this.oqa.getTime()-this.PVa.getTime()));this.AWa&&1<this.vkb&&(this.akb=Math.max(this.akb,this.oqa.getTime()-this.AWa.getTime()));this.Djb&&1<this.vkb&&(this.oNc=Math.max(this.oNc,this.oqa.getTime()-this.Djb.getTime()))};a.createInstance=function(m){a.Ma||(a.Ma=new a,c.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",m));return a.Ma};a.Ma=null;Object(x.a)(a,"RealtimeChannelMetrics",null,[358,88])},1370:function(x,C,b){function a(e,f){var l=
c.call(this)||this;l.bP=e;l.N3=f;return l}b.d(C,"a",function(){return a});x=b(0);var c=Sys.EventArgs;Am(a,c);Object(x.a)(a,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1448:function(x,C,b){function a(ya){this.$=ya}function c(ya,Cb,cc,Rc,yd){var od=nf.call(this)||this;od.Fj=null;od.pyd=!1;od.vkd=null;od.currentUserId=null;od.L$d=null;od.tBd=function(ze,gf){if(gf.bP){ze=gf.bP;for(var of in ze)(ze=of)&&ze!==od.currentUserId&&!od.O_a.has(ze)&&od.Wbc(ze).JRj()}};od.qI=function(){od.yMf()};od.Cca=function(ze,
gf){od.pyd=!0;var of=Object(ic.a)(Object,gf.g8);if(1===gf.type)if(ze=zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1),null===of||void 0===of?0:of[qc.a.O6h]){if(!ze||!Object(ic.a)(String,of[qc.a.o8e]))return;ze=od.MBe(Object(ic.a)(String,of[qc.a.o8e]));Object(ic.a)(String,of[qc.a.p8e])===qc.a.M6h?(ze=[ze],ze[0]===od.currentUserId||od.O_a.has(ze[0])||od.Wbc(ze[0]).GRj(),od.jRd(ze)&&od.KTa(ze,null)):Object(ic.a)(String,of[qc.a.p8e])===qc.a.N6h&&ze!==od.currentUserId&&
od.KTa(null,null)}else{gf=Array.isArray(gf.g8)?gf.g8:null;!gf&&of&&(gf=Array.isArray(of[qc.a.WJe])?of[qc.a.WJe]:null);if(gf&&ze)for(var tg=El(gf),Fe=tg.next();!Fe.done;Fe=tg.next())Fe=Fe.value,Fe===od.currentUserId||od.O_a.has(Fe)||od.Wbc(Fe).IRj();zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5930962_ProcessPeerNotificationAsFallback")?gf&&!od.jRd(gf)||od.KTa(gf,null):gf&&(ze||!od.jRd(gf))||od.KTa(gf,null);return}if(of)if(0===gf.type){var hh;(function(){var td=od.iob(of);hh=td.gMf;return td})().returnValue?
(od.xya(of),qc.a.rf in of&&(od.$.ea.KX(of[qc.a.rf],"ContentRefreshManager.OnUpdateNotificationReceived"),od.Qbg())):bc.ULS.sendTraceTag(22905367,0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",hh,od.$.ea.s7)}else{if(3===gf.type){if(!(qc.a.bUf in of)){bc.ULS.sendTraceTag(537154117,13,10,"RTC WetContentUpdate does not specify a type. Ignoring this update.");return}gf=of[qc.a.bUf];gf===qc.a.jij?od.G3h(of):gf!==qc.a.hij&&gf!==qc.a.lij&&gf!==qc.a.mij&&
gf!==qc.a.kij&&gf!==qc.a.iij&&bc.ULS.sendTraceTag(537154081,13,50,"RTC WetContentUpdate of unknown type {0}. Ignoring this update.",gf);return}if(4===gf.type){ze=!1;qc.a.aGf in of&&(ze=of[qc.a.aGf]);if(od.iob(of).returnValue)return;od.$.ea.vfi()&&od.b0c();if(od.$.ea.v7a&&ze)return;tg=of[qc.a.nXi];od.$.ea.sc&&tg&&od.mXi.XFf(new f(tg,ze,od.yuf))}else if(8===gf.type){if(od.w$i)return;var Dg=0,pg=of[qc.a.fij],Fc=of[qc.a.dij],jd=of[qc.a.eij];qc.a.cUf in of&&(Dg=of[qc.a.cUf]);od.$.ea.sc&&pg&&(ze=Object(pc.a)(new r,
{OcsSessionId:pg,ClientId:Fc&&zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5544917_HookUpRevisionTrackerOnXLO")?Fc:"",SeqNum:jd,XrevidSaved:Dg}),tg=Array(1),tg[0]=ze,y(od.$.na.ua,tg,od.yuf,function(){bc.ULS.sendTraceTag(537154080,0,10,"BatchCheckCollabServiceContent failed. OcsSessionId: {0}, ClientId: {1}, SeqNum: {2}, XrevidSaved: {3}",pg,Fc,jd,Dg)},null,null))}}2===gf.type?of&&od.iob(of).returnValue||(bc.ULS.sendTraceTag(537154079,0,50,"RTC : FileNameUpdate received. Now invoking CheckWorkbookFileNameUpdate web method"),
t(od.$.na.ua,null,null,null,null)):12!==gf.type||of&&od.iob(of).returnValue||od.raiseEvent("LabelUpdateEventKey")};od.yuf=function(ze){var gf=ze.Errors;bd.a.lr(gf)?(gf=bd.a.TF(gf,[1552731907],"ContentRefreshManager"),bd.a.Zga(gf)||od.$.ea.Fp(gf)):(gf=ze.StateId+1,ze.Result&&od.$.ea.rf<gf&&od.$.ea.KX(qc.a.Se,"ContentRefreshManager.OnCheckForUpdateSuccess"))};od.Th=function(){od.$hj&&od.pyd&&od.$.ea.H7b&&od.Qbg()};od.gvf=function(){od.pyd=!1;od.$.ea.rna=500;od.L$d=tf.a.Ta.Wb};od.aEb=function(ze,gf){od.DTd(gf.Fj)};
od.$=ya;od.Bn=Cb;od.$.na.Bq(od.Th);od.Bn.nZb(od.aEb);od.Bn.Qme(od.gvf);od.aZj=cc;od.mXi=Rc;od.cSj=yd;od.nLa={};od.O_a=new Set;od.Bn.J_a();zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&(od.currentUserId=od.$.workbookContext.ClientId,od.yMf(),od.$.ea.Qga(od.qI));od.w$i=zc.EwaSettings.isChangeGateEnabled("OfficeVSO:6195367_RemoveWebRequestsForCollabServiceContentUpdates");return od}function e(ya,Cb,cc){this.BGc={};this.CGc={};this.At=cc;this.H_b(ya,this.BGc);
this.H_b(Cb,this.CGc)}function f(ya,Cb,cc){this.Pah=ya;this.Lmc=Cb;this.At=cc}function l(ya,Cb,cc,Rc){this.BCc=this.vqc=this.Kpc=this.qec=0;this.t9d=this.Yaf=!1;this.clientId=ya;this.tah=Cb;this.$=Rc;this.Uvi=xe.a.Ce()+cc}function m(ya,Cb,cc,Rc,yd){var od=ge.call(this)||this;od.jj=ya;od.Tmj=Cb;od.Smj=cc;od.s7=Rc;od.b_g=yd;return od}function r(){}function h(ya){var Cb=Lc.call(this)||this;Cb.He=null;Cb.mergeSuspensionManager=null;Cb.Uwa=!1;Cb.rDd=null;Cb.Od=!1;Cb.lzc=!1;Cb.jzc=!1;Cb.kzc=!1;Cb.iFb=function(cc,
Rc){Cb.Uwa!==Rc.Uwa&&(Cb.Uwa=Rc.Uwa,Cb.rDd=Cb.Uwa?null:tf.a.Ta.Wb)};Cb.zd=function(){Cb.$.tv&&Cb.HFj()};Cb.od=function(cc,Rc){Rc.sc||Cb.Vr(cc,Rc)};Cb.Vr=function(){if(0<Cb.Zza.length||0<Cb.$da.count)bc.ULS.sendTraceTag(537154128,13,15,"Dropping {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",Cb.Zza.length,Cb.$da.count),Cb.Zza=[],Cb.$da=new ac.a;Cb.yob.cancel();Cb.wbg();Cb.VXd();Cb.XOj()};Cb.ZAf=function(cc,Rc){Cb.FFj();Cb.GFj();cc=new n;cc.Xluid=Rc.jj;cc.NotificationReceivedOn=
tf.a.Ta.Wb.toISOString();cc.CurrentPresenceUserCount=Cb.$.ea.Pm.length;cc.OurCollabModeIsUsingOcs=Cb.$.ea.v7a;cc.SenderCollabMode=Rc.Tmj;cc.SenderClientType=Rc.Smj;cc.SessionSiteIdentifier=Rc.s7;cc.CommandTimeInMs=Rc.b_g;bc.ULS.sendTraceTag(537154127,13,50,"ContentLatencyTracker.OnRemoteRevisionGenerated: RevisionGeneratedNotification: {0}",JSON.stringify(cc));Cb.Zza.push(cc)};Cb.Pi=function(){Cb.JCe(Cb.$.ea.rf,"OnBlockCacheConsistent")};Cb.cBf=function(cc,Rc){(cc=Object(ic.a)(494,Rc.tf))&&Cb.JCe(cc.DJ,
"OnRenderedContent")};Cb.tTj=function(){if(!Cb.$.ea.sc)bc.ULS.sendTraceTag(537154122,13,15,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: session isn't active");else if(Cb.Zza.length||Cb.$da.count){var cc=null;0<Cb.Zza.length&&(cc=Cb.Zza,Cb.Zza=[]);var Rc=null;if(0<Cb.$da.count){Rc=Array(Cb.$da.count);for(var yd=0,od=El(Cb.$da.values),ze=od.next();!ze.done;ze=od.next())ze=ze.value,Rc[yd++]=ze;Cb.$da=new ac.a}bc.ULS.sendTraceTag(537154120,13,100,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: Uploading {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",
cc?cc.length:0,Rc?Rc.length:0);yd=Cb.$.na.ua;od=Cb.kTi;ze=yd.Na(1,null);ze.GenerateNotifications=cc;ze.DownloadNotifications=Rc;Xc.i(yd,"UploadLatencyTelemetry",ze,od,null,null,null,128)}};Cb.kTi=function(cc){cc.Result&&0<cc.Result&&Cb.Svd()};Cb.$=ya;Cb.Ea=Pe.g(Cb.$).Ea;Cb.viewport=Pe.g(Cb.$).view;Cb.contentRefreshManager=Cb.$.da.Aa(292);Cb.qf=Cb.$.qf;Cb.Zza=[];Cb.$da=new ac.a;Cb.yob=xb.a.instance.BC(Cb.tTj,3E4,rd.a.G1g,!1,!1);Cb.$.nl(Cb.zd);Cb.$.ea.hk(Cb.od);Cb.$.ea.HVc(Cb.Vr);Cb.$.da.$a(291,function(cc){Cb.He=
cc});Cb.$.da.$a(343,function(cc){Cb.Od||(Cb.mergeSuspensionManager=cc,Cb.mergeSuspensionManager.RZb(Cb.iFb),Cb.mergeSuspensionManager.VGb())});bc.ULS.sendTraceTag(537154131,13,50,"ContentLatencyTracker initialized");Cb.zd(Cb.$,null);return Cb}function w(){}function n(){}function v(ya){this.$=ya}function u(ya){this.$=ya}function t(ya,Cb,cc,Rc,yd,od){od=ya.Na(1,void 0===od?null:od);return Xc.i(ya,"CheckWorkbookFileNameUpdate",od,Cb,cc,Rc,yd,0)}function y(ya,Cb,cc,Rc,yd,od,ze){ze=ya.Na(1,void 0===ze?
null:ze);ze.updateInfo=Cb;return Xc.i(ya,"BatchCheckCollabServiceContent",ze,cc,Rc,yd,od,516)}function E(ya,Cb,cc){var Rc=Of.call(this)||this;Rc.DEd=null;Rc.CPa=null;Rc.QEb=function(yd,od){if(od.bP){yd=[];var ze=[],gf=Pe.g(Rc.$).ha,of=!(2===gf.Ue||128===gf.Ue);gf=of?ne.k(gf.sa.selectedRanges,Rc.$):gf.Oa.oc.floatingObject;od=od.bP;for(var tg in od)Rc.presenceView.vHe(gf,of,yd,ze,tg);tg=El(Rc.XHa);for(od=tg.next();!od.done;od=tg.next())od=od.value,Array.contains(yd,od)||Array.contains(ze,od)||Rc.presenceView.vHe(gf,
of,yd,ze,od.UserID);Rc.XHa=[];Array.addRange(Rc.XHa,yd);Array.addRange(Rc.XHa,ze);Rc.DEd&&(Hc.a.Ha(Rc.CPa),Rc.CPa=null,Rc.DEd=null);var Fe=E.Aue(yd,ze);Rc.CPa=new Me.a;Rc.DEd=Za.TaskExtensions.Ba(zb.Task.delay(1),function(){Rc.ariaLiveNotifier.Iab(Fe,vg.a.sZa)},Rc.CPa.token,3)}};Rc.$=Cb;Rc.ariaLiveNotifier=ya;Rc.presenceView=cc;Rc.XHa=[];cc.NFa(Rc.QEb);Rc.$.da.Ga(231,Rc);return Rc}function B(ya){var Cb=dh.call(this)||this;Cb.manager=null;Cb.$=ya;Cb.Tb();return Cb}function z(ya,Cb){var cc=rg.call(this)||
this;cc.Fj=null;cc.fieldManagerPane=null;cc.N_=null;cc.hNb=null;cc.J8f=null;cc.messageId=0;cc.Bp=function(){cc.$&&cc.ENd(0,!1)};cc.gj=function(){cc.vVd?cc.hNb(!1):(cc.yc.PresenceType=1,cc.raiseEvent(z.J0),cc.sendPresenceToService(!1))};cc.ug=function(){cc.vVd?cc.J8f(!1):(cc.rcb(!1),cc.ANd())};cc.inc=function(){cc.ha.Oa.oc?cc.ENd(1,!1):cc.NNd(0,!1)};cc.cma=function(Rc,yd){cc.raiseEvent(z.BEd,yd)};cc.kd=function(){cc.NNd(Pe.g(cc.$).isEditing?1:0,!1)};cc.od=function(Rc,yd){ug.a(yd)&&(cc.Sqa={})};cc.IEb=
function(){cc.PWf()};cc.SDf=function(Rc,yd){if(yd&&yd.methodName in z.Tpc){Rc=!1;switch(z.Tpc[yd.methodName]){case 0:yd=yd.parameters.cell;break;case 1:yd=yd.parameters.parameters.Location;break;case 2:yd=ne.v(cc.ha.sa.activeRange,cc.$);Rc=!0;break;default:return}yd.LastColumn=yd.FirstColumn;yd.LastRow=yd.FirstRow;yd.NamedObjectName=null;cc.yc.SelectedRange=[yd];cc.yc.PresenceType=0;if(Rc){yd=[];Rc=El(cc.$.Hb.DSh());for(var od=Rc.next();!od.done;od=Rc.next()){od=od.value;var ze={};ze.ObjectType=cc.Vaa(od.type);
ze.ObjectPresenceType=1;ze.ObjectId=od.jj;yd.push(ze)}cc.yc.Object=yd}else yd=mb(yd,cc.$,1),Rc=null,yd&&(Rc={},Rc.ObjectType=cc.Vaa(yd.type),Rc.ObjectPresenceType=0,Rc.ObjectId=yd.jj),cc.yc.Object=[Rc];cc.raiseEvent(z.J0);cc.sendPresenceToService(!1)}};cc.Un=function(Rc,yd){yd.context.methodName in z.Tpc&&(cc.yc.Object=[null],cc.rcb(!1))};cc.Th=function(Rc,yd){yd.context.methodName in z.Tpc&&(cc.yc.Object=[null],cc.rcb(!1))};cc.zd=function(Rc,yd){yd.nN||(cc.Sqa={},zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",
!1)&&cc.$.ya.IsMeetingLiveSession&&cc.$.ya.IsMeetingPresenter&&(cc.yc.MeetingInfo=cc.pfd()),cc.$.tv?cc.l5a():cc.VNb())};cc.Yc=function(){cc.ANd()};cc.zhf=function(){cc.PWf();cc.vsf.Oz()};cc.$=ya;cc.ha=Pe.g(cc.$).ha;cc.sOa=Cb;cc.rgf=zc.EwaSettings.em();cc.$.nl(cc.zd);cc.$.Zk(cc.Yc);cc.Sqa={};cc.bXa=new Ob.a(null,null,null,null);cc.pAa={};cc.pAa.b=0;cc.pAa.c=0;cc.vsf=new M(cc.$);zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&cc.$.ya.IsMeetingLiveSession&&
cc.$.ya.IsMeetingPresenter&&(cc.yc.MeetingInfo=cc.pfd());cc.vVd=zc.EwaSettings.Fb();cc.vVd&&(cc.hNb=Gg.a(function(Rc){cc.yc.PresenceType=1;cc.raiseEvent(z.J0);cc.sendPresenceToService(Rc)},40,cc.$.la,"SelectionPresenceManager.SendPresenceToService",!0),cc.J8f=Gg.a(function(Rc){cc.rcb(Rc);cc.ANd()},40,cc.$.la,"SelectionPresenceManager.SendCurrentPresence",!0));return cc}function M(ya){var Cb=Cf.call(this)||this;Cb.statusBarManager=null;Cb.$=ya;Cb.$.da.$a(29,function(cc){Cb.statusBarManager=cc;cc.yJ(Cb)});
return Cb}function Q(ya,Cb,cc,Rc,yd){yd=void 0===yd?null:yd;var od=wf.call(this)||this;od.Su={};od.l4b=0;od.k4b=0;od.Nrb=null;od.Psd=null;od.Blf=3E4;od.bjd=!1;od.KQd=!0;od.zEd=null;od.cwf=function(){var ze=od.pma,gf;for(gf in ze)ze=gf,od.Rle(ze)?(od.jkc(ze,!0),delete od.J$a[ze],delete od.pma[ze]):bc.ULS.sendTraceTag(537154377,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",ze)};od.QBd=function(ze,gf){ze={};ze.UpdatedCount=gf.bP?Object.keys(gf.bP).length:0;ze.DisconnectedCount=
gf.N3?gf.N3.length:0;ze.Location="canvas";$d.b(od.$).Vd(ae.a.IEd,ze);ze=null;od.$.Ob&&(ze=od.$.Ob.$g("ModelUpdate","PresenceRendering"),ze.start());var of={};if(gf.bP){if(zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var tg=(new Date).getTime();Za.TaskExtensions.Ba(ub.GetServiceTaskFactory.Va(od.$.da,435,436,1),function(ue){ue.result.Zui(tg)},od.$.la,3)}od.Wtb||(od.wud(!0),od.Wtb=!0);var Fe=gf.bP;for(jd in Fe){var hh=Fe[jd],Dg=jd;od.sld[Dg]=tf.a.Ta.Wb;if(!Od.g(od.$)||
null==hh.NavigationState)if(od.Rze(Dg,new Date),od.QHg(hh),Dg!==od.Nrb){var pg=od.Su[Dg];pg||(od.Rle(Dg)?od.jkc(Dg,!0):(Dg in od.pma?bc.ULS.sendTraceTag(537154376,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",Dg):(od.J$a[Dg]=tf.a.Ta.Wb,of[Dg]=1),od.pma[Dg]=!0,pg=od.RTh(Dg),od.Su[Dg]=od.ZEe(pg)),pg=od.Su[Dg]);pg&&(pg.yc=hh,hh.SelectedRange&&1<hh.SelectedRange.length?od.l4b++:od.k4b++,od.aPf(Dg),od.L_a(pg))}}if(zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&
od.$.ea&&od.$.ea.d5a){var Fc=(new Date).getTime();Za.TaskExtensions.Ba(ub.GetServiceTaskFactory.Va(od.$.da,435,436,1),function(ue){ue.result.$ui(Fc)},od.$.la,3)}}if(gf.N3){var jd=0;for(Fe=gf.N3.length;jd<Fe;jd++)Dg=gf.N3[jd],od.D6c[Dg]=tf.a.Ta.Wb,od.SOf(Dg,!0)}if(gf.N3&&0<gf.N3.length||0<vf.a(of).length||0<vf.a(od.pma).length)jd=[],Array.addRange(jd,vf.a(of)),Array.addRange(jd,vf.a(od.pma)),(of=od.$.da.Aa(292))&&of.KTa(jd,gf.N3);ze&&ze.stop();od.bjd=!1;ze=od.Su;for(var td in ze)if(0===Object(ic.a)(Sa,
ze[td]).yc.CollabMode){od.bjd=!0;break}od.raiseEvent("pcek",gf)};od.o8=function(ze,gf){gf&&od.$.tv&&(gf.cGa.HasAnyNonOcsCoauthor=od.bjd)};od.IEb=function(){var ze=new Hd.a({},null),gf=od.SBa,of;for(of in gf){var tg=of,Fe=gf[of].yc;Fe.SelectedRange=Fe.SelectedRangeRaw;ze.bP[tg]=Fe}od.QBd(od,ze)};od.kd=function(){od.P5e()};od.bwi=function(){od.Psd&&Kf.a(tf.a.Ta,od.Psd)<od.Blf||(od.Psd=tf.a.Ta.Wb,od.Ttd(),od.ati(),od.Jti(),od.Wtb||od.wud(!1))};od.Iya=function(){od.P5e();var ze=od.Su,gf;for(gf in ze)od.L_a(ze[gf])};
od.Yc=function(){od.Ttd();od.Wtb||od.wud(!1);od.Wtb=!1};od.vAf=function(){var ze=od.Su,gf;for(gf in ze)ze[gf].dispose();od.Su={};od.nye();od.J$a={};od.TOc={};Array.clear(od.ny);od.Uxc()};od.aEb=function(ze,gf){od.DTd(gf.Fj)};od.D6c={};od.sld={};od.J$a={};od.TOc={};od.$=ya;od.sOa=Rc;od.Bn=Cb;od.cge=cc;D.uLb=!0;D.Ona=!0;od.l5a();od.Yw=new F(ya);od.$.xa&&od.$.xa.Bg(od.Iya);od.Bn.nZb(od.aEb);ya.na&&od.$.na.P9(od.o8);od.ny=[];od.Bn.J_a();ya.da.Ga(25,od);od.Wtb=!1;od.$.Zk(od.Yc);od.qXc=xb.a.instance.BC(od.bwi,
od.Blf/2,rd.a.y_i,!0,!1);od.AEd=yd;return od}function P(ya,Cb,cc){var Rc=Sa.call(this)||this;Rc.pH=new Nd.a(!0);Rc.b3c=0;Rc.c3c=0;Rc.countFloatingObjects=0;Rc.Tq=function(){Rc.MOd()};Rc.Iya=function(){Rc.MOd()};Rc.gA=new Gb(ya);Rc.k0f(ya);Rc.Yw=cc;Rc.OPd([]);Rc.$=Cb;Rc.$.xa.Bg(Rc.Iya);Pe.g(Rc.$).LP(Rc.Tq);return Rc}function L(ya,Cb,cc){var Rc=Td.call(this,Cb,Pe.g(Cb),!0,!1,ya.User.UserID)||this;Rc.Cz=[];Rc.n1d=46;Rc.RLb=!1;Rc.fhc=!1;Rc.REb=function(){Rc.Ep.User.UserID===L.excelLiveManager.$ya.IB&&
(Rc.Cz.forEach(function(yd){Rc.Y7e(yd);Rc.fdg(yd)}),Rc.Cz=[])};L.r0a||(L.r0a={});Rc.Ep=ya;Rc.ru=new U(Rc.gridView,Rc.Ep.User.UserID,Rc.Ep.User.UserName,Rc.Ep.UserColor,Rc,cc,Rc.$,Rc.Ep.IsAnonymous);Rc.wdf=Od.h(Rc.$);Rc.rki=zc.EwaSettings.isChangeGateEnabled("OfficeVSO:6191577_PresenterPresenceOnTop");Rc.REb=Rc.REb.bind(Rc);Rc.wdf&&Rc.Rri();return Rc}function ca(ya,Cb,cc){this.gh=this.objectId=this.vDa=null;this.Ep=ya;this.$=Cb;this.Yw=cc;this.ru=new U(Pe.g(this.$),this.Ep.User.UserID,this.Ep.User.UserName,
this.Ep.UserColor,null,cc,this.$,this.Ep.IsAnonymous)}function U(ya,Cb,cc,Rc,yd,od,ze,gf){var of=fb.call(this)||this;of.Jb=null;of.Nz={};of.kke=0;of.Fra=null;of.gh=null;of.Mqa=0;of.wEb=function(tg){of.Fra&&of.Fra!==tg||(of.Fra=null,of.Y4(!1));of.raiseEvent("hidePresenceTooltip")};of.aFb=function(tg){of.Fra&&of.Fra!==tg||(of.Fra=null,of.Pna(!0,!1));of.raiseEvent("showPresenceTooltip")};of.$Eb=function(tg){of.Fra||of.raiseEvent("showFullPresenceTooltip");of.Fra=tg};of.QEb=function(){of.Y4(!1);of.raiseEvent("presenceChanged")};
gf=cc===Ff.a.instance.Ab(87)||gf;of.dPc=new Ob.a(Cb,cc,Rc,new pd.a,null,null,null,null,gf);of.gridView=ya;of.HSc=Cb;of.highlight=yd;of.Yw=od;of.$=ze;return of}function aa(ya,Cb,cc,Rc,yd){var od=oa.call(this)||this;od.ny=[];od.j_a=null;od.visible=!1;od.oBb=null;od.wob=null;od.Hua=!1;od.nie=null;od.VAj=function(){Hc.a.Ha(od.wob);od.wob=null;od.visible&&(od.yMa()?od.raiseEvent("showPresenceTooltip"):od.Y4(!0))};od.SAd=function(ze){od.hbb(ze)};od.Pz=function(){od.Tbg()};od.GF=function(){od.Tbg()};od.domElement=
ya;od.gridView=Cb;od.HSc=ya.id;od.Mqa=Rc;od.$=yd;od.aic=!1;od.c8e();od.dPc=cc;od.gh=null;od.vx={};od.vx.FirstColumn=0;od.vx.FirstRow=0;od.vx.LastColumn=0;od.vx.LastRow=0;return od}function F(ya){var Cb=this;this.bic=!1;this.IB=this.Hoa=this.HEd=null;this.wEb=function(cc){var Rc=Cb.Waa(cc.Ry);Rc&&Cb.Bsc(Rc,cc.iza.clientId,cc.Ry)};this.aFb=function(cc){Cb.OB(!1,cc)};this.$Eb=function(cc){Cb.OB(!0,cc)};this.Pz=function(){Cb.Hdg()};this.GF=function(){Cb.Hdg()};this.Iya=function(){Cb.lrb();Cb.clearCache()};
this.y_h=function(cc){cc=Nc.DOMElementExtensions.getBounds(cc.element);cc=new dg.a(cc.x,cc.y,cc.width,cc.height);for(var Rc=El(J.JKa()),yd=Rc.next();!yd.done;yd=Rc.next())if(yd=Cb.gridView.Tf(yd.value),yd=Nc.DOMElementExtensions.getBoundingClientRect(yd.domElement),(new dg.a(yd.x,yd.y,yd.width,yd.height)).Hd(cc))return yd;return null};this.aTj=function(){var cc=Cb.Nz,Rc;for(Rc in cc){var yd=cc[Rc];if(yd){var od=yd.yMa(),ze=Cb.Waa(yd.Ry),gf=od?Cb.X0e(yd.wqc,yd.paneType,yd.range):null;if(gf!==ze){ze&&
Cb.Bsc(ze,yd.iza.clientId,yd.Ry);if(!D.Ona)break;gf&&od&&(gf.DYa(yd.iza),Cb.XTa[yd.Ry]=gf,yd.BMb(gf),Cb.d6e(gf,yd))}else Cb.d6e(ze,yd)}}};this.O8e=Mg.a.Fsh;this.cwa=20;this.gridView=Pe.g(ya);this.$=ya;this.vGb={};this.XTa={};this.Nz={};this.WTa={};this.$.xa&&this.$.xa.Bg(this.Iya);this.lrb()}function D(){}function J(ya,Cb,cc){var Rc=xd.call(this)||this;Rc.dza=null;Rc.VGf=null;Rc.PMd=!1;Rc.Pz=function(){Rc.mkd()};Rc.GF=function(){Rc.mkd()};Rc.gridView=ya;Rc.rtl=ya.rtl;Rc.ipd=!1;Rc.Uh=new Nd.a(!0);
for(var yd=0;4>yd;yd++)if(Rc.gridView.rb.dqd(cc,J.JKa()[yd])||1===J.JKa()[yd]){var od=Cb.V4g(),ze=ya.Tf(J.JKa()[yd]).domElement;ze.insertBefore(od.element,ze.firstChild);Rc.Uh.add(Enum.toString(ke,J.JKa()[yd]),od)}return Rc}function R(ya,Cb,cc){if(!Cb)return null;ya=ya.Uq;return new Sys.UI.Point(Cb.x+ya.x*(cc?1:-1),Cb.y+ya.y*(cc?1:-1))}function Z(ya){this.ze=ya;this.ze.BYa(10,je.a.instance);this.ze.BYa(9,qg.a.instance);this.ze.BYa(6,20);this.ze.BYa(13,pf.a.instance);this.ze.BYa(17,!1)}function W(ya,
Cb,cc){ya=fa.call(this,ya)||this;ya.wDa=!1;ya.nTb=!1;ya.Z8=!1;ya.lXa=!1;ya.IA=[];ya.gTb={};ya.ze=cc;ya.lj=cc.get(8,!1);ya.J7d=cc.get(15,!1);ya.bng=cc.get(12,0);ya.ssa=cc.get(6,0);ya.WWb=Cb;ya.kje=cc.get(16);ya.SIc=cc.get(17,!1);ya.xYj=cc.get(19,!1);ya.Itg=cc.get(20,!1);ya.dUb=0;ya.Etg=new ma(ya.lj,ya.SIc);ya.Agb=ya.iYe();ya.QOc=!1;ya.Tea=[];ya.ajb=[];ya.element.id=W.OFh();ya.element.className=fa.r9g(ya.lj);ya.dsb&&(ya.zIndex=ya.dsb);ya.rtl=ya.lj;ya.voj(Cb);ya.tfa=ya.createElement("div");ya.tfa.className=
"prFlyoutContainer";ya.element.appendChild(ya.tfa);ya.YL=[];ya.aqa=new ka(ya.YJ,ya.element,ya.ssa,4,6,32,ya.lj);ya.yA=cc.get(9);ya.yA.pa(Yd.a.pointerDown,ya.aqa.element,Object(Cd.a)(ya,ya.H9a,"onHitTarget"));ya.yA.pa(Yd.a.pointerOver,ya.aqa.element,Object(Cd.a)(ya,ya.H9a,"onHitTarget"));ya.yA.pa(Yd.a.pointerOut,ya.aqa.element,Object(Cd.a)(ya,ya.H9a,"onHitTarget"));return ya}function ka(ya,Cb,cc,Rc,yd,od,ze){this.YL=ya;this._parent=Cb;this.F3d=cc;this.Ylg=Rc;this.Opg=yd;this.OXa=od;this.qJ=ze;this._element=
document.createElement("div");this.element.className="prTouchTarget"}function ma(ya,Cb){this.lj=void 0===ya?!1:ya;this.SIc=void 0===Cb?!1:Cb}function pa(ya,Cb,cc,Rc){this.offsetTop=ya;this.offsetLeft=Cb;this.ifg=void 0===cc?2:cc;this.g8e=void 0===Rc?4:Rc}function xa(ya,Cb){var cc=fa.call(this,ya)||this;cc.Ci=null;cc.yA=null;cc.eHc=null;cc.sKc=null;cc.vGc=null;cc.Upa=null;cc.Qie=null;cc.qJ=Cb.get(8,!1);cc.Vhb=Cb.get(6,0);cc.Txg=Cb.get(15,!1);cc.ze=Cb;cc.l6d=0;cc.element=ya;cc.element.className=xa.ICh;
cc.MG=document.createElement("span");cc.element.appendChild(cc.MG);cc.yng=va.oMh(Cb.get(6,0));cc.Cv(Cb);cc._state=5;return cc}function va(){}function ta(ya,Cb){var cc=Be.call(this)||this;cc.type=ya;cc.mtb=Cb;return cc}function fa(ya){var Cb=Lf.call(this)||this;Cb._element=null;Cb.element=ya;return Cb}function Ca(){this.uP={}}function Sa(){var ya=Kd.call(this)||this;ya.gA=null;ya.Qde=null;ya.Sde=null;return ya}function Gb(ya){var Cb=de.call(this)||this;Cb.Vie=ya;Cb.Sqa=null;Cb.iPc=null;return Cb}function kb(ya){var Cb=
Bc.call(this)||this;Cb.$=ya;Cb.Tb();return Cb}function lb(ya){var Cb=this;this.HHf=this.EEd=this.JHf=this.FHf=this.OFf=this.eMd=this.dUf=this.lUf=this.kUf=!1;this.FEd=this.tDd=this.gJb=this.jJb=this.yuc=this.iMd=0;this.$ff=!1;this.Dxd=this.wpb=0;this.gic=!1;this.od=function(){Cb.gic=!0;Cb.$.ea.Dk(Cb.od)};this.$=ya;ba.a.ZP&&(this.Dxd=window.performance.timing.navigationStart);this.Dxd||bc.ULS.sendTraceTag(537154379,0,15,"Navigation start time is zero");this.$.ea.hk(this.od)}function Nb(){var ya=vd.call(this)||
this;ya.fCe=null;ya.Tb();return ya}function Aa(){}function qa(){}function Xa(ya){var Cb=this;this.Pa=new hd.a;this.ceg=this.disposed=!1;this.oFb=function(){bc.ULS.sendTraceTag(537154381,0,50,"PeopleInfoProvider.OnUserListUpdated fired");Cb.Pa.raiseEvent("UU",Cb)};this.$=ya;this.$.ea.Qga(this.oFb);this.ceg=zc.EwaSettings.isChangeGateEnabled("OfficeVSO:6220406_UseIsAnonymousForNewPresenceUser")}function Ha(ya){var Cb=Ub.call(this)||this;Cb.manager=null;Cb.$=ya;Cb.Tb();return Cb}function Ra(ya){var Cb=
nd.call(this)||this;Cb.bta=null;Cb.z0a=null;Cb.Ota=!1;Cb.qDc=!1;Cb.Hf=function(){var cc=Cb.$.ea.Qm;if(null===cc||void 0===cc?0:cc.SheetChanges){cc=El(cc.SheetChanges);for(var Rc=cc.next();!Rc.done;Rc=cc.next())if(Rc=Rc.value,2===Rc.Type){if(Cb.bta)for(var yd=El(Cb.bta),od=yd.next();!od.done;od=yd.next())od=od.value,od.Range.SheetName===Rc.Name&&(od.Range.SheetName=Rc.NewName);if(Cb.z0a)for(yd=El(Cb.z0a),od=yd.next();!od.done;od=yd.next())od=od.value,od.Range.SheetName===Rc.Name&&(od.Range.SheetName=
Rc.NewName)}}};Cb.Hxf=function(){bc.ULS.sendTraceTag(537154395,0,50,"NamedSheetViewConversionManager.OnGridLoaded");Cb.qDc=!1;Cb.Ymc(Cb,Sys.EventArgs.Empty)};Cb.Yc=function(){bc.ULS.sendTraceTag(537154394,0,50,"NamedSheetViewConversionManager.OnWorkbookClosing");Cb.qDc=!0};Cb.Ymc=function(){bc.ULS.sendTraceTag(50620166,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: triggered with version [{0}]",Cb.$.ea.bya);if(!Cb.$.isEditMode||!Cb.$.ea.sc||Cb.$.ea.$4a||Cb.qDc||Cb.$.ea.bya===qc.a.a6b)bc.ULS.sendTraceTag(537154393,
0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: Request skipped [Edit Mode: {0}] [IsSessionActive: {1}] [HasRaisedSessionEnded: {2}] [WorkbookClosed: {3}]",Cb.$.isEditMode,Cb.$.ea.sc,Cb.$.ea.$4a,Cb.qDc);else{Cb.bta=null;Cb.z0a=null;var cc=Cb.$.na.ua.hc(),Rc=Cb.$.na.ua,yd=Cb.cLi,od=Cb.bLi,ze=Rc.Na(1,null);Xc.i(Rc,"GetNamedSheetViewConversion",ze,yd,od,null,cc,132)}};Cb.cLi=function(cc){if(bd.a.lr(cc.Errors)){Cb.Ota=!0;var Rc=[-1100324317,-1857233882];bd.a.nh(cc.Errors,Rc)&&bc.ULS.sendTraceTag(537154392,
0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionSuccess Errors: [{0}]",bd.a.Wc(cc.Errors));cc=bd.a.TF(cc.Errors,Rc,"NamedSheetViewConversionManager:OnGetNamedSheetViewConversionSuccess");Cb.$.ea.Fp(cc)}else Cb.Ota=!1,cc=cc.Result,Cb.$.ea.bya=cc.ConversionVersion,Cb.B0i(cc.NamedSheetViewConversionEntries),Cb.H2i()};Cb.bLi=function(cc){Cb.Ota=!0;cc=md.a.pg(cc.data);bc.ULS.sendTraceTag(537154391,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionFailure: Errors: [{0}].",
bd.a.Wc(cc))};Cb.$=ya;bc.ULS.shipAssertTag(537154397,0,!!Cb.$.ea,"NamedSheetViewConversionManager ctor: EwaControl.SessionStateManager should not be null");Cb.$.Zk(Cb.Yc);Cb.$.ea.gU(Cb.Hxf);Cb.$.ea.xFg(Cb.Ymc);Cb.$.ea.Ot(Cb.Hf);Cb.$.ea.ku&&Cb.Ymc(Cb,Sys.EventArgs.Empty);return Cb}function mb(ya,Cb,cc){if(!Cb||!Cb.Hb)return null;for(var Rc=0;Rc<Cb.Hb.count;Rc++){var yd=Cb.Hb.getItem(Rc);if(yd&&yd.type===cc&&yd.usedRange&&yd.usedRange.contains(ne.D(ya))&&ed.a.equals(yd.sheetName,ya.SheetName,!0))return yd}return null}
function La(ya,Cb){return!!ya&&!!Cb&&ya.SheetName===Cb.SheetName&&(!!ya.NamedObjectName&&ya.NamedObjectName===Cb.NamedObjectName||!ya.NamedObjectName&&!Cb.NamedObjectName&&ne.D(ya).Hd(ne.D(Cb)))}function ha(){}function Ia(ya,Cb,cc,Rc,yd,od,ze,gf,of){of=void 0===of?!1:of;this.dpa=null;this.MIc=!0;this.cPc=this.LEa=this.yFc=null;this.Za=new hd.a;this.ssg=ya;this.zfe=Cb;this.Rde=cc;this.Pde=Rc;this.f2d=od;Ia.se=yd;this.Otg=ze;this.Gqa=gf;this.oug=of;zb.Task.WAA(Cb,cc).continueWith(Object(Cd.a)(this,
this.m9h,"initOnTaskReady"))}function gb(ya){var Cb=Na.call(this)||this;Cb.C3b=null;Cb.mUf=null;Cb.i2=null;Cb.R8d=!1;Cb.uW=function(cc,Rc){if(2===Rc.newState){if(Cb.Fj){if(zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var yd=(new Date).getTime();Za.TaskExtensions.Ba(ub.GetServiceTaskFactory.Va(Cb.$.da,435,436,1),function(od){od.result.svi(yd)},Cb.$.la,3)}Cb.raiseEvent("connectionCompleted",new Sb(Cb.Fj),Rc)}else bc.ULS.sendTraceTag(537167630,0,15,"RealTimeChannelController.OnConnectionStateChanged: new state is connected and this.RealTimeChannel is null");
Cb.C3b=Rc}else if(2===Rc.oldState||0===Rc.newState)Cb.C3b=null,Cb.raiseEvent("connectionLostEventKey")};Cb.Voc=function(){if(Cb.Fj){var cc=Object(ic.a)(309,Cb.Fj);cc&&(bc.ULS.sendTraceTag(537167629,0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),cc.disconnect(),cc.ZHb(Cb.uW))}Cb.i2=null};Cb.$=ya;Cb.$.Zk(Cb.Voc);Cb.$.ea.HVc(Cb.Voc);ya.da.$a(38,function(cc){cc.Mne(Cb.Voc)});return Cb}function Sb(ya){var Cb=Zb.call(this)||this;Cb.Fj=ya;return Cb}function wc(){}function tc(ya,
Cb,cc,Rc,yd,od,ze,gf,of){ze=void 0===ze?null:ze;gf=void 0===gf?null:gf;of=void 0===of?null:of;this.fee={};this.IGc={};this.j$d=new hc.a;this.djb=this.ux=this.gWb=null;this.khe=this.jhe=0;this.kFa=new Uc.a(function(){return ze.YQ("PresenceBootLatencyThreshold",1E4)});this.ZCa=new Uc.a(function(){return ze.YQ("PresenceBootLatencyCutoffThreshold",6E4)});this.lyg=new Uc.a(function(){return ze.YQ("PresenceLightupLatencyThreshold",2E3)});this.Omg=new Uc.a(function(){return ze.YQ("PresenceLightupLatencyCutoffThreshold",
1E4)});this.Dtg=Rc;this.C3d=ya;this.yfe=Cb;this.Qqa=cc;this.hi=yd;this.UWa=gf;this.ECa=od;this.Md=of;this.t2d=!1;this.init()}function Tb(ya,Cb,cc){this.$2d=this.A3d=this.bRb=this.mRb=this.LUa=0;this._id=ya;this.kFa=Cb;this.ZCa=cc;this.OUa=Object(ic.a)(String,wb.AFrameworkApplication.dc.Application)||""}function pb(ya,Cb,cc,Rc,yd,od,ze,gf,of){this.oge=!1;this._id=ya;this.Rp=Cb;this.XL=cc;this.RNc=Rc;this.lSc=yd;this.kFa=od;this.ZCa=ze;this.v3d=gf;this.ECa=of;this.OUa=Object(ic.a)(String,wb.AFrameworkApplication.dc.Application)||
""}function cb(){this.ct=this.vt=this.d=0}function ob(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}function rc(ya,Cb,cc,Rc){this.p9=null;this.WHc=this.QNc=!1;this.Okb=ya;this.XRc=Cb;this.vb=cc;this.UWa=Rc}function Db(ya){this.ux=null;this.nRb={};this.mVb={};this.cjb=null;this.Qqa=ya}function Ja(ya,Cb,cc,Rc,yd,od,ze,gf,of){this.rde=this.D3d=this.ux=null;this.nQb=ya;this.ZWb=new Kb.a;this.vb=cc;this.JGc=Cb;this.PUa=Rc;this.hi=yd;this.VOc=od;this.Qqa=ze;this.zkg=gf;
this.x7d=this.u7d=!1;this.uXb=0;this.B3d=1;this.ECa=of;this.Zie=this.vb.ra("PeoplesWellExtraButtonInfoIsEnabled");this.OUa=Object(ic.a)(String,wb.AFrameworkApplication.dc.Application)||""}function Qb(ya,Cb){this.p9=null;this.Okb=ya;this.Atg=Cb}b.r(C);var yc=b(0),Cd=b(82);Qb.prototype.init=function(){var ya=this;this.Okb.continueWith(function(){ya.p9=ya.Okb.result;ya.p9.OYa(Object(Cd.a)(ya,ya.LF,"onUsersUpdated"))})};Qb.prototype.LF=function(){Qb.Bre(this.p9.Vua())&&(this.p9.gtc(Object(Cd.a)(this,
this.LF,"onUsersUpdated")),this.Atg.IsRealCoauthSession=!0)};Qb.Bre=function(ya){var Cb,cc=null;ya=El(ya);for(Cb=ya.next();!Cb.done;Cb=ya.next())if(Cb=Cb.value)if(Cb=Cb.isAnonymous||!Cb.email?Cb.clientId:Cb.email.toUpperCase(),!cc)cc=Cb;else if(cc!==Cb)return!0;return!1};Object(yc.a)(Qb,"CoauthTelemetry",null,[604]);var bc=b(14),Kb=b(161),ic=b(83),wb=b(4),Wa;(function(ya){ya[ya.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";ya[ya.notImplemented=1]="notImplemented";ya[ya.renderHandled=
2]="renderHandled";ya[ya.renderHandledWithVeto=3]="renderHandledWithVeto"})(Wa||(Wa={}));Object(yc.b)("CoauthorGalleryTelemetryEndResult",Wa);var Xb=b(100),Gc=b(112),zb=b(55);Ja.prototype.init=function(){var ya=this;zb.Task.WAA.call(null,this.Qqa,this.JGc,this.VOc).continueWith(function(){ya.ux=ya.Qqa.result;ya.D3d=ya.JGc.result;ya.rde=ya.VOc.result;zb.Task.WAA.call(null,ya.JGc.result.k1c,ya.VOc.result.iAc).continueWith(function(){ya.B3d=ya.D3d.k1c.result;ya.uXb=ya.rde.iAc.result;ya.ux.OYa(Object(Cd.a)(ya,
ya.Roc,"onUsersUpdatedEventListener"));ya.ux.Vua().length&&ya.LF()})})};Ja.prototype.Roc=function(){this.LF()};Ja.prototype.LF=function(){this.zkg(this.ux.Vua())?(this.ux.gtc(Object(Cd.a)(this,this.Roc,"onUsersUpdatedEventListener")),this.EJi(this.u7d)):this.ZWb.mx(1);this.u7d=!0};Ja.prototype.EJi=function(ya){var Cb=this;this.x7d?this.M5f.continueWith(function(){bc.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",Wa[Cb.M5f.result])}):(this.x7d=!0,this.Z0i(0===
this.B3d&&!ya))};Ja.prototype.Z0i=function(ya){ya?this.PUa.Mk(4,Object(Cd.a)(this,this.QAd,"onInteractiveReady")):this.ZWb.mx(1)};Ja.prototype.QAd=function(){var ya=this.hi.AH("AppInitStatus_interactivityReady");bc.ULS.shipAssertTag(42259235,325,!!this.uXb);var Cb=this.uXb-ya;ya={InteractiveTime:ya};ya.ReactRenderComplete=this.uXb;ya.HadTabSwitch=this.ECa();ya.IsModernGallery=this.Zie;bc.ULS.sendTraceTag(594883104,325,50,Gc.a.toJSON(ya));this.Zie?(bc.ULS.sendTraceTag(42062997,325,15,Cb.toString()),
this.ZWb.mx(this.oVj(Cb)?3:2)):bc.ULS.sendTraceTag(594883103,325,15,Cb.toString())};Ja.prototype.oVj=function(ya){var Cb=ya>this.vb.Dd("CoauthorGalleryTimeToRenderDurationMs",1E4),cc="Word"===this.OUa;if(this.ECa())return bc.ULS.sendTraceTag(50455714,325,50,Cb.toString()),!1;cc&&Xb.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);Cb&&(cc&&Xb.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,
!0,null),bc.ULS.sendTraceTag(42062998,325,15,ya.toString()));return Cb};Ek.Object.defineProperties(Ja.prototype,{M5f:{configurable:!0,enumerable:!0,get:function(){return this.ZWb.task}}});Object(yc.a)(Ja,"CoauthorGalleryTelemetry",null,[605]);Db.prototype.acc=function(ya){var Cb=this,cc=new Kb.a;this.init().continueWith(function(){ya in Cb.nRb?cc.mx(Cb.nRb[ya]):Cb.mVb[ya]=cc});return cc.task};Db.prototype.init=function(){var ya=this;if(this.cjb)return this.cjb.task;this.cjb=new Kb.a;this.Qqa.continueWith(function(){ya.ux=
ya.Qqa.result;ya.ux.OYa(Object(Cd.a)(ya,ya.LF,"onUsersUpdated"));ya.ddg();ya.cjb.setResult(null)});return this.cjb.task};Db.prototype.ddg=function(){var ya=this.ux.Vua();ya.sort(Object(Cd.a)(this,this.$_g,"comparePresenceUsers"));this.nRb={};for(var Cb=0;Cb<ya.length&&ya[Cb]&&ya[Cb].Uka;Cb++)this.SBg(this.nRb,ya[Cb].clientId,Cb)};Db.prototype.SBg=function(ya,Cb,cc){ya[Cb]=cc;Cb in this.mVb&&(this.mVb[Cb].mx(cc),delete this.mVb[Cb])};Db.prototype.LF=function(){this.ddg()};Db.prototype.$_g=function(ya,
Cb){return ya.Uka>Cb.Uka?1:ya.Uka<Cb.Uka?-1:0};Object(yc.a)(Db,"CoauthorPositionFinder",null,[552]);var hc=b(202);rc.prototype.init=function(){var ya=this;this.Okb.continueWith(function(){ya.p9=ya.Okb.result;ya.p9.OYa(Object(Cd.a)(ya,ya.LF,"onUsersUpdated"))})};rc.prototype.LF=function(){this.AZg(this.p9.Vua());!this.QNc||this.zFe&&!this.WHc||this.p9.gtc(Object(Cd.a)(this,this.LF,"onUsersUpdated"))};rc.prototype.AZg=function(ya){var Cb=new hc.a,cc=0;ya=El(ya);for(var Rc=ya.next();!Rc.done;Rc=ya.next())(Rc=
Rc.value)&&Rc.isAnonymous&&(wb.AFrameworkApplication.rkc("70eb6120;2gfeb930"),this.zFe&&!this.WHc&&(Cb.contains(Rc.userName)?(bc.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected"),this.WHc=!0):Cb.add(Rc.userName)),Rc.clientId===this.UWa||this.QNc||(cc++,2<=cc&&this.Jui()))};rc.prototype.Jui=function(){var ya=this;bc.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.QNc=!0;this.u1h&&this.XRc&&this.XRc.continueWith(function(){window.setTimeout(function(){ya.XRc.result.logActivity("MultipleGuestsCoauthoring",
null)},5E3)})};Ek.Object.defineProperties(rc.prototype,{zFe:{configurable:!0,enumerable:!0,get:function(){return this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}},u1h:{configurable:!0,enumerable:!0,get:function(){return this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GuestCoauthFloodgateEnabled",!1)}}});Object(yc.a)(rc,"GuestCoauthTelemetry",null,[]);var Uc=b(615);Object(yc.a)(ob,"PL",null,[]);var jb=b(41);cb.mXf=function(ya,Cb,cc){var Rc=
new cb;Rc.d=ya;Rc.vt=Cb;Rc.ct=cc;return jb.c(Rc)};Object(yc.a)(cb,"VD",null,[]);var $a=b(356);pb.prototype.veto=function(ya){var Cb=this;zb.Task.WAA(this.RNc,this.lSc).continueWith(function(){if(Cb.RNc.result<=Cb.lSc.result)ya.mx(!1);else{var cc=Cb.XL-Cb.Rp,Rc=new ob;Rc.id=Cb._id;Rc.et=Cb.XL;Rc.st=Cb.Rp;Rc.d=Cb.XL-Cb.Rp;Rc.mp=Cb.RNc.result;Rc.tp=Cb.lSc.result;Rc.ct=Cb.EKh(Cb.v3d);Rc.vc=Cb.ECa();var yd=jb.c(Rc),od="Word"===Cb.OUa;bc.ULS.sendTraceTag(42078597,302,15,yd);if(od){var ze=new Map;ze.set("data",
yd);Xb.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",ze)}cc>Cb.kFa.value&&!Cb.oge&&!Rc.vc&&(Cb.oge=!0,ya.mx(!0),Rc=Object.assign(new $a.a,{inStaging:!0,extendedProperties:new Map}),Rc.extendedProperties.set("data",yd),od&&Xb.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,Rc),cc<Cb.ZCa.value&&bc.ULS.sendTraceTag(42078598,302,15,cb.mXf(cc,Cb.kFa.value,Cb.ZCa.value)));ya.task.isCompleted||ya.mx(!1)}})};pb.prototype.EKh=
function(ya){switch(ya){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}};Object(yc.a)(pb,"PresenceLatencyActivityLogger",null,[]);Tb.prototype.X_c=function(){!this.Fze&&this.LUa&&this.mRb&&(this.A3d=this.veto(this.mRb,"CoauthGalleryLightupDurationTooLong"));!this.Fwe&&this.LUa&&this.bRb&&(this.$2d=this.veto(this.bRb,"CanvasPresenceLightupDurationTooLong"))};Tb.prototype.veto=function(ya,Cb){var cc=ya-this.LUa,Rc=new ob;Rc.id=this._id;Rc.et=ya;Rc.st=this.LUa;
Rc.d=cc;var yd=jb.c(Rc);ya="Word"===this.OUa;Rc="CanvasPresenceLightupDurationTooLong"===Cb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===Cb?bc.ULS.sendTraceTag(572289499,302,15,yd):bc.ULS.sendTraceTag(571524118,302,15,yd);if(ya){var od=new Map;od.set("data",yd);Xb.Health.instance.recordKpiUsage(Rc,0,"wordcollabrel",od)}return cc>this.kFa.value?(od=Object.assign(new $a.a,{inStaging:!0,extendedProperties:new Map}),od.extendedProperties.set("data",
yd),yd=cc<this.ZCa.value,od.extendedProperties.set("cash",yd?"true":"false"),ya&&Xb.Health.instance.recordKpiFailure(Rc,Cb,!1,!0,od),bc.ULS.sendTraceTag(572289500,302,15,cb.mXf(cc,this.kFa.value,this.ZCa.value)),yd?2:1):3};Ek.Object.defineProperties(Tb.prototype,{WHg:{configurable:!0,enumerable:!0,get:function(){return this.LUa},set:function(ya){this.LUa=ya;this.X_c()}},sZg:{configurable:!0,enumerable:!0,get:function(){return this.mRb},set:function(ya){this.mRb=ya;this.X_c()}},EUg:{configurable:!0,
enumerable:!0,get:function(){return this.bRb},set:function(ya){this.bRb=ya;this.X_c()}},Fze:{configurable:!0,enumerable:!0,get:function(){return 0!==this.A3d}},Fwe:{configurable:!0,enumerable:!0,get:function(){return 0!==this.$2d}}});Object(yc.a)(Tb,"PresenceLightupLatencyLogger",null,[]);var I=b(58),ba=b(332);tc.prototype.qkh=function(ya,Cb,cc){var Rc=this;cc=void 0===cc?null:cc;var yd=void 0===yd?0:yd;cc&&(bc.ULS.shipAssertTag(42274970,302,!this.UWa||this.UWa===cc,"_myClientId is already set and you are trying to update it to something different"),
this.UWa=cc);var od=new Kb.a;this.init().continueWith(function(){Rc.jPi(ya);Rc.rkh(od,ya,Cb,yd)})};tc.prototype.init=function(){var ya=this;if(this.djb)return this.djb.task;this.djb=new Kb.a;this.ECa()&&bc.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.C3d.continueWith(function(){var Cb=ya.C3d.result,cc=Cb.k1c,Rc=Cb.FAi;Rc.continueWith(function(){cc.continueWith(function(){ya.Md&&ya.Md.addQosPillar("RealTimeCoauth");ya.qEj(cc.result,Rc.result);ya.djb.setResult(null)})})});this.yfe.continueWith(function(){ya.gWb=
ya.yfe.result;ya.gWb.HFa(Object(Cd.a)(ya,ya.nQi,"onRtcConnection"));ya.gWb.NYa(Object(Cd.a)(ya,ya.qHi,"onCoauthorBootReceived"))});this.Qqa.continueWith(function(){ya.ux=ya.Qqa.result;ya.ux.OYa(Object(Cd.a)(ya,ya.Roc,"onUsersUpdatedEventListener"));0<ya.ux.Vua().length&&ya.LF()});return this.djb.task};tc.prototype.sXe=function(){return this.hi.Zsa(I.a.UTa)?this.hi.AH(I.a.UTa):ba.a.ZP?window.performance.timing.fetchStart:-1};tc.prototype.nQi=function(ya,Cb){this.t2d||2!==Cb.newState||(ya=Date.now()-
this.sXe(),Cb={},Cb.clientId=this.Eqf,Cb.bootTime=ya,this.t2d=!0,this.gWb.Jda(15,Cb))};tc.prototype.qHi=function(ya,Cb){if(15===Cb.type){ya=Date.now();Cb=Cb.g8;var cc=Cb.bootTime;this.jfd(Cb.clientId).WHg=ya-cc}};tc.prototype.Roc=function(){this.LF()};tc.prototype.LF=function(){var ya=Date.now(),Cb=this.ux.Vua(),cc=new hc.a;Cb=El(Cb);for(var Rc=Cb.next();!Rc.done;Rc=Cb.next())Rc=Rc.value,this.j$d.contains(Rc.clientId)||(this.j$d.add(Rc.clientId),cc.add(Rc.clientId));if(0<cc.count)for(cc=El(cc),Cb=
cc.next();!Cb.done;Cb=cc.next())Cb=this.jfd(Cb.value),Cb.Fze||(Cb.sZg=ya)};tc.prototype.jPi=function(ya){ya=this.jfd(ya);ya.Fwe||(ya.EUg=Date.now())};tc.prototype.jfd=function(ya){return ya in this.IGc?this.IGc[ya]:this.IGc[ya]=new Tb(ya,this.lyg,this.Omg)};tc.prototype.qEj=function(ya,Cb){Cb=void 0===Cb?0:Cb;this.jhe=ya;this.khe=Cb?Cb:(new Date).getTime()};tc.prototype.rkh=function(ya,Cb,cc,Rc){cc=cc?cc.getTime():(new Date).getTime();Cb in this.fee?ya.fA():(Rc=new pb(Cb,this.WXh(),cc,this.acc(this.Eqf),
this.acc(Cb),this.kFa,this.ZCa,Rc,this.ECa),this.fee[Cb]=Rc,Rc.veto(ya))};tc.prototype.WXh=function(){return 1===this.jhe?this.khe:this.sXe()};tc.prototype.acc=function(ya){return this.Dtg.acc(ya)};Ek.Object.defineProperties(tc.prototype,{Eqf:{configurable:!0,enumerable:!0,get:function(){return this.UWa||"{"+wb.AFrameworkApplication.userSessionId+"}"}}});Object(yc.a)(tc,"PresenceBootTelemetry",null,[548]);var sa=b(139),Oa=b(255),qb=b(225),Qa=b(85),ib=b(566);wc.prototype.ei=function(ya){var Cb=this;
ya.register(Qb,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").Hc().Oc(function(){return new Qb(ib.a.ar(ya.lc("Common.IPeopleInfoProvider")),wb.AFrameworkApplication.ag)});ya.register(Ja,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").Hc().Oc(function(){return new Ja(wb.AFrameworkApplication.Ib,ib.a.ar(ya.lc("Common.ICoauthoringTelemeryInfoProvider")),wb.AFrameworkApplication.ga,sa.a.get_instance(),qb.a.instance,
ib.a.ar(ya.lc("Common.IPeoplesWell")),ib.a.ar(ya.lc("Common.IPeopleInfoProvider")),Qb.Bre,function(){return Cb.jue()})});ya.register(tc,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").Hc().Oc(function(){return new tc(ib.a.ar(ya.lc("Common.ICoauthoringTelemeryInfoProvider")),ib.a.ar(ya.lc("Common.IRealtimeChannelBasic")),ib.a.ar(ya.lc("Common.IPeopleInfoProvider")),ya.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),qb.a.instance,
function(){return Cb.jue()},wb.AFrameworkApplication.ga,null,Xb.Health.instance)});ya.register(Db,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").Hc().Oc(function(){return new Db(ib.a.ar(ya.lc("Common.IPeopleInfoProvider")))});ya.register(rc,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").Hc().Oc(function(){return new rc(ib.a.ar(ya.lc("Common.IPeopleInfoProvider")),ib.a.ar(ya.lc("Common.ISystemInitiatedFeedback")),wb.AFrameworkApplication.ga,
"{"+wb.AFrameworkApplication.userSessionId+"}")})};wc.prototype.init=function(){wb.AFrameworkApplication.ga.sv(function(){Qa.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();Qa.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();wb.AFrameworkApplication.ga.ra("CoauthorGalleryTelemetryIsEnabled")&&Qa.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();wb.AFrameworkApplication.ga.ra("CashTelemetryIsEnabled")&&(Qa.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),
Qa.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})};wc.prototype.dispose=function(){};wc.prototype.jue=function(){return ba.a.ZP&&qb.a.instance.Zsa(I.a.FOb)?0<qb.a.instance.AH(I.a.FOb)[I.a.yfg]:!1};wc.main=function(){Oa.a.instance.hj(new wc)};Ek.Object.defineProperties(wc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CoauthTelemetry"}}});Object(yc.a)(wc,"CoauthTelemetryPackage",null,[4,5]);var Mb=b(1013),Jb=b(38),Zb=Sys.EventArgs;Am(Sb,
Zb);Object(yc.a)(Sb,"ConnectionCompletedEventArgs",Sys.EventArgs,[]);var ub=b(51),Za=b(36),vc=b(54),zc=b(1),kd=b(49),wa=b(1297),Na=Jb.a;Am(gb,Na);gb.prototype.nZb=function(ya){this.addHandler("connectionCompleted",ya)};gb.prototype.eJd=function(ya){this.removeHandler("connectionCompleted",ya)};gb.prototype.DVc=function(ya){this.addHandler("rtcInitialized",ya)};gb.prototype.nIb=function(ya){this.removeHandler("rtcInitialized",ya)};gb.prototype.Qme=function(ya){this.addHandler("connectionLostEventKey",
ya)};gb.prototype.vPf=function(ya){this.removeHandler("connectionLostEventKey",ya)};gb.prototype.dispose=function(){this.Fj&&this.Fj.ZHb(this.uW);this.$&&this.$.rm(this.Voc);this.i2=this.$=null;Na.prototype.dispose.call(this)};gb.prototype.zEe=function(ya){Za.TaskExtensions.Ba(this.H1e().task,function(Cb){ya(Cb.result)},this.la)};gb.prototype.hBe=function(ya,Cb){this.R8d=Cb;this.DNi(ya)};gb.prototype.J_a=function(){this.Fj&&(this.raiseEvent("rtcInitialized"),2===this.Fj.connectionState&&this.C3b&&
this.raiseEvent("connectionCompleted",new Sb(this.Fj),this.C3b))};gb.prototype.xsi=function(){bc.ULS.sendTraceTag(537167633,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice");if(zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5856505_RtcDownloadBreakDownMetrics")){var ya=(new Date).getTime();Za.TaskExtensions.Ba(ub.GetServiceTaskFactory.Va(this.$.da,435,436,1),function(Rc){Rc.result.vvi(ya)},this.$.la,3)}var Cb=[];Cb.push(vc.a.current.kp(43));Cb.push(vc.a.current.kp(44));Cb=vc.a.Btd(Cb,this.$.la);
var cc=vc.a.loadScript(10,0,1);return zb.Task.WAA.call(null,Cb,cc)};gb.prototype.DNi=function(ya){var Cb=this,cc=this.xsi();Za.TaskExtensions.Ba(cc,function(){bc.ULS.sendTraceTag(537167632,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice Before RealtimeChannel create. RealtimeChannel = null: {0}",void 0===Mb.RealtimeChannel||null===Mb.RealtimeChannel);if(zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var Rc=(new Date).getTime();Za.TaskExtensions.Ba(ub.GetServiceTaskFactory.Va(Cb.$.da,
435,436,1),function(ze){ze.result.wvi(Rc)},Cb.$.la,3)}Cb.i2=Mb.RealtimeChannel.createInstance(ya,Cb.$.ya.UserSessionId,wb.AFrameworkApplication.nUf,wb.AFrameworkApplication.Jd,null,2,kd.b().G3e(),Cb.$.workbookContext.RtcEndpointUrl,void 0,new wa.a,void 0,void 0,Cb.$.workbookContext.RtcBootToken);bc.ULS.sendTraceTag(571770432,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice RealtimeChannel created");zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&
(Qa.a.instance.register(Mb.RealtimeChannel,"AppRealtimeChannel.RealtimeChannel").as("Common.IRealtimeChannelBasic").as("AppRealtimeChannel.IRealtimeChannel").Hc().Oc(function(){return Cb.Fj}),Qa.a.instance.resolve("Common.IRealtimeChannelBasic"));Cb.H1e().setResult(Cb.Fj);if(zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var yd=(new Date).getTime();Za.TaskExtensions.Ba(ub.GetServiceTaskFactory.Va(Cb.$.da,435,436,1),function(ze){ze.result.uvi(Cb.Bnd,yd)},Cb.$.la,
3)}Cb.raiseEvent("rtcInitialized");bc.ULS.sendTraceTag(571770403,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice raise RealTimeChannelInitializedEventKey");var od=Object(ic.a)(309,Cb.Fj);od&&(bc.ULS.sendTraceTag(571770402,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice attach changed handler"),od.HFa(Cb.uW),od.connect())},this.la,3)};gb.prototype.H1e=function(){return this.mUf||(this.mUf=new Kb.a)};gb.ka=function(ya){ya.da.Ga(26,new gb(ya))};Ek.Object.defineProperties(gb.prototype,
{Fj:{configurable:!0,enumerable:!0,get:function(){return this.i2}},Bnd:{configurable:!0,enumerable:!0,get:function(){return this.R8d}}});Object(yc.a)(gb,"RealTimeChannelController",Jb.a,[8,9]);var Vb=b(11),pc=b(7),hd=b(97),Ud=b(108),Zc=b(27);Ia.prototype.OKf=function(){this.Za.raiseEvent("u",null,this)};Ia.prototype.m9h=function(){this.zfe.result&&this.Rde.result&&(this.LEa=this.zfe.result,this.cPc=this.Rde.result,this.LEa.OFa(Object(Cd.a)(this,this.cma,"onPresenceUpdated")),this.yFc=new Ud.a(2,2,
this.f2d,Object(Cd.a)(this,this.xPj,"updateAwayClientsTask"),88),Ia.se.Sg(this.yFc))};Ia.prototype.cma=function(ya,Cb){(this.MIc||this.B5i(Cb.bP))&&Ia.se.Wma(this.yFc,0)};Ia.prototype.B5i=function(ya){for(var Cb in ya){var cc=this.Pde.Y0e({key:Cb,value:ya[Cb]});if(cc&&cc.clientId&&(cc=cc.clientId.toLowerCase(),(cc=this.dpa[cc]||this.dpa[cc.toUpperCase()])&&2===cc.status))return!0}return!1};Ia.prototype.xPj=function(ya){var Cb=this.LEa.iIh();if(Cb){var cc=new Date,Rc=!1;if(this.MIc){this.dpa=Cb;this.MIc=
!1;Cb=this.dpa;for(var yd in Cb){var od=yd,ze=Cb[yd];ze.X7a<cc&&(cc=ze.X7a);2===ze.status&&(Rc=!0,this.cPc.cPf(od))}Rc&&this.OKf();Ia.se.Wma(ya,this.a0e(cc))}else{ze=new hc.a;yd=!1;var gf=this.dpa;for(od in gf)if(gf=od,gf in this.dpa&&this.ssg.clientId!==gf){var of=this.dpa[gf],tg=Cb[gf];if(of&&tg){of=of.status;var Fe=tg.status;2===of&&1===Fe?(ze.add(gf),bc.ULS.sendTraceTag(38052609,392,50,gf+" returned from away")):1===of&&2===Fe&&(yd=Rc=!0,this.cPc.cPf(gf),bc.ULS.sendTraceTag(38052610,392,50,gf+
" went away"));1===Fe&&tg.X7a<cc&&(cc=tg.X7a)}}this.dpa=Cb;Ia.se.Wma(ya,this.a0e(cc));(0<ze.count||Rc)&&this.OKf();0<ze.count&&!this.oug?(ya=this.KKh(ze),this.DJj(ya)):ya=new hc.a;(yd||0<ya.count)&&this.Otg(Zc.a.j1c,2)}}};Ia.prototype.DJj=function(ya){if(ya.count){ya=El(ya);for(var Cb=ya.next();!Cb.done;Cb=ya.next())Cb=this.Gqa.P$(String.format(CommonUIStrings.l_EditorsToastArriving,Cb.value),!1),Cb.image=5,Cb.bka="CoAuth_AuthorStatus_16x16x32",this.Gqa.lE(Cb)}};Ia.prototype.KKh=function(ya){var Cb=
this.LEa.Vcd(),cc=new hc.a,Rc;for(Rc in Cb){var yd={key:Rc,value:Cb[Rc]};if(ya.contains(yd.key)){var od=this.Pde.Y0e(yd);od&&(cc.add(od.userName),ya.remove(yd.key))}}cc.count||bc.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return cc};Ia.prototype.a0e=function(ya){var Cb=new Date;return Math.max(ya.getTime()+this.f2d-Cb.getTime(),0)};Ia.se=null;Object(yc.a)(Ia,"AwayManager",null,[]);var Ob=b(1371),Ad=b(103),we=b(302),Wd=b(228);Object(yc.a)(ha,"NamedSheetViewConversionEntry",
null,[]);var qc=b(9),md=b(119),bd=b(30),Xc=b(84),ne=b(46),ed=b(21),nd=Jb.a;Am(Ra,nd);Ra.prototype.Ane=function(ya){this.addHandler("SVCU",ya)};Ra.prototype.XPf=function(ya){this.removeHandler("SVCU",ya)};Ra.prototype.dispose=function(){this.z0a=this.bta=null;this.$&&this.$.rm(this.Yc);this.$.ea&&(this.$.ea.hS(this.Hxf),this.$.ea.qbj(this.Ymc),this.$.ea.Ev(this.Hf));this.$=null;nd.prototype.dispose.call(this)};Ra.prototype.J2g=function(ya){return this.Ota?null:this.VBe(ya,this.z0a,"ConvertPresencePublicToPrivate")};
Ra.prototype.I2g=function(ya){return this.Ota?null:this.VBe(ya,this.bta,"ConvertPresencePrivateToPublic")};Ra.prototype.B0i=function(ya){ya?(this.Hbh(ya),this.bta=ya,this.z0a=this.V6g(this.bta)):bc.ULS.sendTraceTag(537154396,0,10,"NamedSheetViewConversionManager.ProcessConversionEntries: conversionEntries can be empty but not null")};Ra.prototype.H2i=function(){bc.ULS.sendTraceTag(537154390,0,50,"NamedSheetViewConversionManager.RaiseConversionUpdatedEvent: new version is update on client from server");
this.raiseEvent("SVCU")};Ra.prototype.VBe=function(ya,Cb,cc){if(!Cb||!Cb.length)return bc.ULS.sendTraceTag(537154389,0,50,"NamedSheetViewConversionManager.{0}: skipping convert due to {1} ConversionEntries. ",cc,Cb?"empty":"null"),ya;cc=El(ya);for(var Rc=cc.next();!Rc.done;Rc=cc.next()){Rc=Rc.value;for(var yd=El(Cb),od=yd.next();!od.done;od=yd.next())if(od=od.value,od.IsRow&&La(od.Range,Rc)&&!(Rc.FirstRow<=od.Range.FirstRow&&Rc.LastRow>=od.Range.LastRow)){var ze={};ze.SheetName=Rc.SheetName;ze.FirstRow=
ze.LastRow=Rc.FirstRow;ze.FirstColumn=ze.LastColumn=Rc.FirstColumn;La(od.Range,ze)?(ze=Rc.FirstRow-od.Range.FirstRow,0>ze||ze>=od.ConversionMap.length?bc.ULS.sendTraceTag(537154388,0,10,"NamedSheetViewConversionManager.ConvertRanges: invalid mapIndex after adjust. Index: [{0}], ConversionMap.Length: {1}",ze,od.ConversionMap.length):(ze=od.ConversionMap[ze]-ze,Rc.FirstRow+=ze,Rc.LastRow=Rc.FirstRow,Rc.LastColumn=Math.min(Rc.LastColumn,od.Range.LastColumn))):Rc.FirstRow<od.Range.FirstRow&&Rc.LastRow>=
od.Range.FirstRow?Rc.LastRow=od.Range.FirstRow-1:Rc.LastColumn>=od.Range.FirstColumn&&(Rc.LastColumn=od.Range.FirstColumn-1)}if(0>Rc.FirstRow||Rc.FirstRow>qc.a.wy)Rc.FirstRow=Math.max(Math.min(Rc.FirstRow,qc.a.wy),0);if(0>Rc.LastRow||Rc.LastRow>qc.a.wy)Rc.LastRow=Math.max(Math.min(Rc.LastRow,qc.a.wy),0);if(0>Rc.FirstColumn||Rc.FirstColumn>qc.a.wv)Rc.FirstColumn=Math.max(Math.min(Rc.FirstColumn,qc.a.wv),0);if(0>Rc.LastColumn||Rc.LastColumn>qc.a.wv)Rc.LastColumn=Math.max(Math.min(Rc.LastColumn,qc.a.wv),
0)}return ya};Ra.prototype.V6g=function(ya){if(!ya||!ya.length)return bc.ULS.sendTraceTag(537154387,0,50,"NamedSheetViewConversionManager.CreateInverseConversionEntries: skip creating inverse due to {0} ConversionEntries. ",this.bta?"empty":"null"),ya;for(var Cb=Array(ya.length),cc=0;cc<ya.length;++cc){var Rc=new ha;Rc.Range=ya[cc].Range;Rc.IsRow=ya[cc].IsRow;Rc.ConversionMap=Array(ya[cc].ConversionMap.length);Rc.IsRow||(this.Ota=!0,bc.ULS.sendTraceTag(537154386,0,10,"NamedSheetViewConversionManager.CreateInverseConversionEntries: adjusting presence against column sort map is NYI."));
for(var yd=0;yd<ya[cc].ConversionMap.length;++yd)Rc.ConversionMap[ya[cc].ConversionMap[yd]]=yd;Cb[ya.length-cc-1]=Rc}return Cb};Ra.prototype.Hbh=function(ya){if(ya&&ya.length){ya=El(ya);for(var Cb=ya.next();!Cb.done;Cb=ya.next()){Cb=Cb.value;this.Gbh(Cb);var cc=Cb.IsRow?Cb.Range.LastRow-Cb.Range.FirstRow+1:Cb.Range.LastColumn-Cb.Range.FirstColumn+1;Cb.ConversionMap.length!==cc&&(bc.ULS.shipAssertTag(537154385,0,!1,"NamedSheetViewConversionManager.DecompressEntries: decompressed conversion map doesn't match expected size - Expected: [{0}] | Actual: [{1}]",
cc,Cb.ConversionMap.length),this.Ota=!0)}}};Ra.prototype.Gbh=function(ya){var Cb=ya.ConversionMap;if(Cb&&Cb.length)if(0>Cb[0])bc.ULS.shipAssertTag(537154384,0,!1,"NamedSheetViewConversionManager.DecompressConversionMap: conversionMap starts with a negative number"),this.Ota=!0;else{for(var cc=[],Rc=0;Rc<Cb.length;++Rc)if(0>Cb[Rc])for(var yd=Cb[Rc-1],od=-1*Cb[Rc],ze=1;ze<=od;++ze)cc.push(yd+ze);else cc.push(Cb[Rc]);ya.ConversionMap=cc}};Object(yc.a)(Ra,"NamedSheetViewConversionManager",Jb.a,[699,3]);
var Ub=Wd.a;Am(Ha,Ub);Ha.prototype.create=function(){this.Eb(this.manager||(this.manager=new Ra(this.$)))};Object(yc.a)(Ha,"NamedSheetViewConversionManagerFactory",Wd.a,[]);var Hc=b(90),pd=b(1192);Xa.prototype.dispose=function(){this.disposed||(this.$&&this.$.ea&&this.$.ea.pda(this.oFb),Hc.a.zc([this.Pa]),this.$=this.Pa=null,this.disposed=!0)};Xa.prototype.OYa=function(ya){this.Pa.addHandler("UU",ya)};Xa.prototype.gtc=function(ya){this.Pa.removeHandler("UU",ya)};Xa.prototype.Vua=function(){for(var ya=
[],Cb=El(this.$.ea.Pm),cc=Cb.next();!cc.done;cc=Cb.next())ya.push(this.uUh(cc.value));bc.ULS.sendTraceTag(537154383,0,50,"PeopleInfoProvider.GetAllUsers: Count: [{0}]",ya.length);return ya};Xa.prototype.uUh=function(ya){return new Ob.a(ya.User.UserID,ya.User.UserName,ya.UserColor,new pd.a(1),null,ya.UserEmail,void 0,void 0,this.ceg?ya.IsAnonymous:void 0,void 0,void 0,ya.JoinCoauthTime)};Object(yc.a)(Xa,"PeopleInfoProvider",null,[347,3]);var jc=b(736);qa.prototype.lE=function(){bc.ULS.sendTraceTag(537154380,
0,50,"PresenceBootstrapper.AddNotificationBarEntry: User state changed from inactive to active")};qa.prototype.removeEntry=function(){};qa.prototype.P$=function(ya,Cb){return new jc.a(ya,Cb)};qa.prototype.dispose=function(){};Ek.Object.defineProperties(qa.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return!1}}});Ek.Object.defineProperties(qa,{instance:{configurable:!0,enumerable:!0,get:function(){qa.Ma||(qa.Ma=new qa);return qa.Ma}}});qa.Ma=null;Object(yc.a)(qa,"NoOpNotificationBar",
null,[252,3]);Aa.prototype.Y0e=function(ya){var Cb=ya.key;ya=ya.value;if(!ya)return null;var cc=ya.SupportsChat?4:0;return Object(pc.a)(new Ob.a,{clientId:Cb,W_c:ya.ChatThreadId,V_c:ya.ChatThreadDiscoveryUri,Rxb:ya.InChat,email:ya.Cid,capabilities:new pd.a(cc)})};Object(yc.a)(Aa,"PresenceConverter",null,[695]);var vd=Wd.a;Am(Nb,vd);Nb.prototype.create=function(){this.Eb(this.fCe||(this.fCe=new Aa))};Nb.ka=function(ya){ya.da.Ga(159,new Nb)};Object(yc.a)(Nb,"PresenceConverterFactory",Wd.a,[]);var ae=
b(131),$d=b(132);lb.prototype.vvi=function(ya){this.kUf||(this.iMd=ya,this.kUf=!0)};lb.prototype.wvi=function(ya){this.lUf||(this.yuc=ya,this.lUf=!0)};lb.prototype.uvi=function(ya,Cb){this.dUf||(this.jJb=Cb,this.$ff=ya,this.dUf=!0)};lb.prototype.svi=function(ya){this.eMd||(this.gJb=ya,this.eMd=!0)};lb.prototype.Zui=function(ya){!this.EEd&&this.eMd&&(this.FEd=ya,this.EEd=!0)};lb.prototype.Wui=function(ya){this.OFf||(this.tDd=ya,this.OFf=!0)};lb.prototype.Yui=function(ya){if(!this.FHf&&this.Yga&&!this.gic){this.FHf=
!0;var Cb=this.zdd();Cb.RtcIntializeToPeopleWellServiceCreate=this.tDd-this.jJb;Cb.PeopleWellServiceCreateToPresenceGalleryRender=ya-this.tDd;Cb.PresenceGalleryRenderTotalTime=ya-this.Yga;$d.b(this.$).Vd(ae.a.GHf,Cb,void 0,!0)}};lb.prototype.avi=function(ya){if(!this.JHf&&this.Yga&&!this.gic){this.JHf=!0;var Cb=this.zdd();Cb.RtcIntializeToRtcConnect=this.gJb-this.jJb;Cb.RtcConnectToPresenceSent=ya-this.gJb;Cb.PresenceSentTotalTime=ya-this.Yga;$d.b(this.$).Vd(ae.a.KHf,Cb,void 0,!0)}};lb.prototype.$ui=
function(ya){if(!this.HHf&&this.EEd&&this.Yga&&!this.gic){this.HHf=!0;var Cb=this.zdd();Cb.RtcIntializeToRtcConnect=this.gJb-this.jJb;Cb.RtcConnectToPresenceRenderInitiate=this.FEd-this.gJb;Cb.PresenceRenderInitiateToPresenceRenderFinish=ya-this.FEd;Cb.PresenceRenderTotalTime=ya-this.Yga;$d.b(this.$).Vd(ae.a.IHf,Cb,void 0,!0)}};lb.prototype.dispose=function(){this.$=null};lb.prototype.zdd=function(){var ya={};ya.CoAuthorCountsOnBoot=this.$.ea.Pm.length;ya.RtcConnectedLaterInSession=this.$ff;ya.BrowserVisibilityChanged=
this.hPg();ya.AppInteractiveAbsTime=this.Yga;ya.NavigationStartTime=this.Dxd;ya.AppInteractiveToRtcSliceDownloadInitialize=this.iMd-this.Yga;ya.RtcSliceDownloadInitializeToRtcSliceLoad=this.yuc-this.iMd;ya.AppInteractiveToRtcSliceLoad=this.yuc-this.Yga;ya.RtcSliceLoadToRtcInitialize=this.jJb-this.yuc;return ya};lb.prototype.hPg=function(){return ba.a.ZP&&qb.a.instance.Zsa(I.a.FOb)?0<qb.a.instance.AH(I.a.FOb)[I.a.yfg]:!1};Ek.Object.defineProperties(lb.prototype,{Yga:{configurable:!0,enumerable:!0,
get:function(){if(this.wpb)return this.wpb;qb.a.instance.Zsa("AppInitStatus_interactivityReady")&&(this.wpb=qb.a.instance.AH("AppInitStatus_interactivityReady"));this.wpb||bc.ULS.sendTraceTag(537154378,0,15,"App interactive time is zero");return this.wpb}}});Object(yc.a)(lb,"PresenceTelemetry",null,[693,3]);var Bc=Wd.a;Am(kb,Bc);kb.prototype.create=function(){this.Eb(this.$.da.Aa(435)||this.$.da.Ga(435,new lb(this.$)))};kb.ka=function(ya){ya.da.Ga(436,new kb(ya))};Object(yc.a)(kb,"PresenceTelemetryFactory",
Wd.a,[]);var Hd=b(1370),xb=b(47),rd=b(44),tf=b(28),Kf=b(117),Ff=b(15),Pe=b(22),Xe=b(76),de=Jb.a;Am(Gb,de);Gb.prototype.dispose=function(){this.raiseEvent("userPresenceChanged");this.raiseEvent("userLeft");this.iPc=this.Sqa=this.Vie=null;de.prototype.dispose.call(this)};Ek.Object.defineProperties(Gb.prototype,{KOb:{configurable:!0,enumerable:!0,get:function(){return this.Vie}},yc:{configurable:!0,enumerable:!0,get:function(){return this.Sqa||{}},set:function(ya){this.iPc=this.Sqa;this.Sqa=ya;this.raiseEvent("userPresenceChanged")}},
fFd:{configurable:!0,enumerable:!0,get:function(){return this.iPc}}});Object(yc.a)(Gb,"UserPresence",Jb.a,[]);var Kd=Xe.a;Am(Sa,Kd);Sa.prototype.OPd=function(ya){this.Qde=ya};Sa.prototype.k0f=function(ya){this.Sde=ya};Sa.prototype.L_a=function(){};Sa.prototype.i4a=function(){return null};Sa.prototype.ued=function(){return null};Sa.prototype.b4f=function(){};Sa.prototype.c4f=function(){};Sa.prototype.adg=function(){};Sa.prototype.Rxc=function(){};Sa.prototype.Xdc=function(){};Sa.VRj=function(ya,Cb){var cc=
ya.gA.yc;Hc.a.zc(ya.Gy);Hc.a.zc([ya.gA]);ya.gA=null;ya.gA=new Gb(Cb);ya.OPd([]);ya.k0f(Cb);ya.yc=cc};Ek.Object.defineProperties(Sa.prototype,{Gy:{configurable:!0,enumerable:!0,get:function(){return this.Qde}},Ep:{configurable:!0,enumerable:!0,get:function(){return this.Sde}},yc:{configurable:!0,enumerable:!0,get:function(){return this.gA.yc},set:function(ya){this.gA.yc=ya}}});Object(yc.a)(Sa,"IUserGridPresence",Xe.a,[]);var pe;(function(ya){ya[ya.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";
ya[ya.peopleImageClassName=1]="peopleImageClassName";ya[ya.peopleImageClusterPath=4]="peopleImageClusterPath";ya[ya.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";ya[ya.imageDimension=6]="imageDimension";ya[ya.rtl=8]="rtl";ya[ya.pointerInputManager=9]="pointerInputManager";ya[ya.clickInputManager=10]="clickInputManager";ya[ya.vertical=11]="vertical";ya[ya.zIndex=12]="zIndex";ya[ya.contextMenuInputManager=13]="contextMenuInputManager";ya[ya.imageDomElement=14]="imageDomElement";
ya[ya.useIdleTooltip=15]="useIdleTooltip";ya[ya.viewportBoundsCallback=16]="viewportBoundsCallback";ya[ya.flipHorizontalDirection=17]="flipHorizontalDirection";ya[ya.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";ya[ya.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";ya[ya.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(pe||(pe={}));Object(yc.b)("PresenceTooltipSettingKeys",pe);Ca.prototype.get=function(ya,Cb){ya=pe[ya];return"number"===typeof(void 0===Cb?null:
Cb)?(Cb=this.uP[ya])?Number.parseInvariant(Cb.toString()):0:this.uP[ya]};Ca.prototype.add=function(ya,Cb){this.uP[pe[ya]]=Cb};Ca.prototype.BYa=function(ya,Cb){pe[ya]in this.uP||(this.uP[pe[ya]]=Cb)};Ca.prototype.remove=function(ya){delete this.uP[pe[ya]]};Object(yc.a)(Ca,"PresenceTooltipSettings",null,[]);var Lf=hd.a;Am(fa,Lf);fa.prototype.dispose=function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;Lf.prototype.dispose.call(this)};
fa.prototype.createElement=function(ya){return this.element.ownerDocument.createElement(ya)};fa.prototype.Yyc=function(){return!0};fa.r9g=function(ya){return"prControl"+(ya?"Rtl":"")};Ek.Object.defineProperties(fa.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return this._element},set:function(ya){this._element=ya}},visible:{configurable:!0,enumerable:!0,get:function(){return"visible"===this.element.style.visibility},set:function(ya){this.element.style.visibility=ya?"visible":"hidden"}},
rtl:{configurable:!0,enumerable:!0,get:function(){return"rtl"===this.element.dir.toLowerCase()},set:function(ya){this.element.dir=ya?"rtl":"ltr"}},zIndex:{configurable:!0,enumerable:!0,get:function(){return this.element.style.zIndex},set:function(ya){this.element.style.zIndex=String(ya)}}});Object(yc.a)(fa,"BasePresenceControl",hd.a,[3,330]);var Be=Sys.EventArgs;Am(ta,Be);ta.mka="InteractivityChanged";Object(yc.a)(ta,"InteractivityChangedEventArgs",Sys.EventArgs,[]);va.oMh=function(ya){return va.pMh(ya)};
va.pMh=function(ya){var Cb=document.createElementNS(va.R_d,"svg");Cb.setAttribute("viewBox",String.format(va.Eah,va.lfg,va.kfg));Cb.appendChild(va.zYh(ya));return Cb};va.zYh=function(ya){var Cb=va.lfg/ya,cc=2*Cb,Rc=va.kfg/2;ya=(ya-12-8)*Cb/2;var yd=document.createElementNS(va.R_d,"g");Sys.UI.DomElement.addCssClass(yd,va.Dah);for(var od=1;3>=od;od++)yd.appendChild(va.BKh(od,cc,ya+(6*od-2)*Cb,Rc));return yd};va.BKh=function(ya,Cb,cc,Rc){var yd=document.createElementNS(va.R_d,"circle");Sys.UI.DomElement.addCssClass(yd,
String.format("{0}-{1}",va.hXg,ya));yd.setAttribute("cx",String.format("{0}",cc));yd.setAttribute("cy",String.format("{0}",Rc));yd.setAttribute("r",String.format("{0}",Cb));return yd};va.R_d="http://www.w3.org/2000/svg";va.Dah="prDancingDots";va.hXg="prAnimateCircle";va.Eah="0 0 {0} {1}";va.kfg=40;va.lfg=120;Object(yc.a)(va,"ModernPresenceTooltipDancingDots",null,[]);var eg=b(118),Jc=b(156),Yd=b(13),Ge=b(91),ud=b(122),Ye=b(57),mf=b(29);Am(xa,fa);xa.prototype.nVc=function(ya){this.addHandler(ta.mka,
ya)};xa.prototype.Ssc=function(ya){this.removeHandler(ta.mka,ya)};xa.prototype.dispose=function(){this.element&&(this.Ci.za(Yd.a.click,this.element,Object(Cd.a)(this,this.vd,"onClick")),this.Ci.za(Yd.a.kk,this.element,Object(Cd.a)(this,this.Yyc,"stopPropagationAndPreventDefaultBehavior")),this.yA.za(Yd.a.pointerDown,this.element,Object(Cd.a)(this,this.onPointerDown,"onPointerDown")),this.yA.za(Yd.a.pointerOut,this.element,Object(Cd.a)(this,this.WN,"onPointerOut")),this.yA.za(Yd.a.pointerOver,this.element,
Object(Cd.a)(this,this.Sw,"onPointerOver")),this.eHc.za(this.element,Object(Cd.a)(this,this.Yyc,"stopPropagationAndPreventDefaultBehavior")));fa.prototype.dispose.call(this)};xa.prototype.Cv=function(ya){this.Ci=ya.get(10);this.Ci.pa(Yd.a.click,this.element,Object(Cd.a)(this,this.vd,"onClick"));this.Ci.pa(Yd.a.kk,this.element,Object(Cd.a)(this,this.Yyc,"stopPropagationAndPreventDefaultBehavior"));this.yA=ya.get(9);this.yA.pa(Yd.a.pointerOver,this.element,Object(Cd.a)(this,this.Sw,"onPointerOver"));
this.yA.pa(Yd.a.pointerOut,this.element,Object(Cd.a)(this,this.WN,"onPointerOut"));this.yA.pa(Yd.a.pointerDown,this.element,Object(Cd.a)(this,this.onPointerDown,"onPointerDown"));this.eHc=ya.get(13);this.eHc.pa(this.element,Object(Cd.a)(this,this.Yyc,"stopPropagationAndPreventDefaultBehavior"))};xa.prototype.hide=function(ya,Cb,cc){ya=void 0===ya?null:ya;Cb=void 0===Cb?0:Cb;cc=void 0===cc?0:cc;this.Txg&&ya?this.xzj(ya,Cb,cc):(3===this.state&&this.zOf(),this.visible=!1,this._state=5)};xa.prototype.xzj=
function(ya,Cb,cc){this.show(ya,Cb,15,4,void 0,void 0===cc?0:cc)};xa.prototype.G2f=function(ya,Cb,cc,Rc,yd,od){this.show(ya,Cb,20,(void 0===cc?0:cc)?2:(void 0===Rc?0:Rc)?1:0,void 0===yd?!1:yd,void 0===od?0:od)};xa.prototype.Vyj=function(ya,Cb,cc,Rc,yd){this.show(ya,Cb,cc+20,3,void 0===Rc?!1:Rc,void 0===yd?0:yd)};xa.prototype.show=function(ya,Cb,cc,Rc,yd,od){Rc=void 0===Rc?3:Rc;od=void 0===od?0:od;!ya||Rc===this.state&&this.a5h(Cb,cc)||(this.kAg(Rc,void 0===yd?!1:yd,od),this.DYa(ya,Rc,od),this._state=
Rc,4===od||0===od&&!this.qJ?this.element.style.left=Cb+"px":this.element.style.right=Cb+"px",this.element.style.top=cc+"px",this.visible=!0)};xa.prototype.DYa=function(ya,Cb,cc){this.Qie=ya;Ye.a.fqb(this.MG);ud.a.iYg(this.MG);this.MG.id="fly_"+ya.clientId;this.MG.style.backgroundColor=ya.color;4!==Cb?(this.MG.style.height=this.Vhb+"px",this.MG.style.lineHeight=this.Vhb+"px",ud.a.JRa(this.MG,"border-radius",this.Vhb+"px")):4===cc||0===cc&&!this.qJ?this.MG.style.left="0px":this.MG.style.right="0px";
2!==Cb&&(4===Cb?Ye.a.fwc(this.MG,""):1===Cb?this.MG.appendChild(this.yng):(this.MG.setAttribute("dir","auto"),cc=mf.a.xQh(ya.userName),(!ya.isAnonymous||wb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&cc||0!==Cb?(ya=ya.userName,0===Cb&&(ya=cc,ud.a.JRa(this.MG,"text-align","center")),Ye.a.fwc(this.MG,ya)):(this.sKc||(this.sKc=this.l4g()),this.MG.appendChild(this.sKc),ud.a.JRa(this.MG,"text-align","start"))))};xa.prototype.vd=function(ya){if(0===
this.state)return this.raiseEvent(ta.mka,new ta(1,ya)),!0;3===this.state&&bc.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1};xa.prototype.WN=function(ya){3===this.state&&this.raiseEvent(ta.mka,new ta(3,ya));return!1};xa.prototype.Sw=function(ya){3!==ya.yb&&this.raiseEvent(ta.mka,new ta(2,ya));return!1};xa.prototype.onPointerDown=function(ya){if(3!==ya.yb)return!0;this.raiseEvent(ta.mka,new ta(4,ya));return!1};xa.prototype.l4g=function(){var ya=document.createElement("img");
ya.src=eg.a.Vsa("doughperson_white_glyph.svg");ya.setAttribute("Unselectable","on");Ge.a.yh(ya,Ge.a.Td,Ge.a.Sr);return Jc.createClusteredImageFromClusterWithImageClass(this.Vhb,this.Vhb,null,null,xa.LCh,"",!1,"",this.element.ownerDocument,ya)};xa.prototype.kAg=function(ya,Cb,cc){Cb=void 0===Cb?!1:Cb;cc=void 0===cc?0:cc;if(!this.Fyb(this.state)||!this.Fyb(ya))switch(Sys.UI.DomElement.removeCssClass(this.element,this.vGc),this.state){case 4:3===ya?this.Jga(xa.fbd,xa.jUe):this.Fyb(ya)&&this.Jga(xa.dbd,
xa.jUe);break;case 3:4===ya?this.Jga(xa.ibd,xa.iUe):this.Fyb(ya)&&(Cb&&this.zOf(),this.Jga(xa.dbd,xa.iUe,Cb?xa.KCh:""));break;case 0:case 1:case 2:4===ya?this.Jga(xa.ibd,xa.gbd):3===ya&&(Cb&&this.KAg(),this.Jga(xa.fbd,xa.gbd,Cb?xa.kUe:"",3===cc?xa.OCh:xa.MCh));break;default:4===ya?this.Jga(xa.ibd):3===ya?this.Jga(xa.fbd):this.Fyb(ya)&&this.Jga(xa.dbd)}};xa.prototype.Jga=function(ya){for(var Cb=[],cc=0;cc<arguments.length;++cc)Cb[cc-0]=arguments[cc];this.vGc=Cb.join(" ");Sys.UI.DomElement.addCssClass(this.element,
this.vGc)};xa.prototype.KAg=function(){var ya=this;this.l6d=window.setTimeout(function(){ya.element&&(ya.Upa=ya.element.cloneNode(!0),ya.element.parentNode.appendChild(ya.Upa),ya.element.style.zIndex="2",ya.Upa.style.zIndex="1")},300)};xa.prototype.zOf=function(){var ya=this;window.clearTimeout(this.l6d);this.Upa&&(Sys.UI.DomElement.removeCssClass(this.Upa,xa.gbd+" "+xa.kUe),Sys.UI.DomElement.addCssClass(this.Upa,xa.JCh),zb.Task.delay(300).continueWith(function(){ya.element&&ya.element.parentNode===
ya.Upa.parentNode&&ya.element.parentNode.removeChild(ya.Upa)}),ud.a.RHb(this.element,"z-index"))};xa.prototype.Fyb=function(ya){return 0===ya||1===ya||2===ya};xa.prototype.a5h=function(ya,Cb){var cc=ud.a.oD(this.element.style.top);return ud.a.oD(this.element.style.left)===ya&&cc===Cb};xa.prototype.OKd=function(ya){3===ya&&ud.a.i3(this.element,"left")?(ya=ud.a.oD(this.element.style.left),ud.a.RHb(this.element,"left"),this.element.style.right=-1*ya+"px"):4===ya&&ud.a.i3(this.element,"right")&&(ya=ud.a.oD(this.element.style.right),
ud.a.RHb(this.element,"right"),this.element.style.left=-1*ya+"px")};Ek.Object.defineProperties(xa.prototype,{user:{configurable:!0,enumerable:!0,get:function(){return this.Qie}},state:{configurable:!0,enumerable:!0,get:function(){return this._state}}});xa.ICh="prModernFlyout UIFont";xa.ibd="flyoutIdle";xa.fbd="flyoutExpanded";xa.dbd="flyoutCollapsed";xa.jUe="flyoutFromIdle";xa.iUe="flyoutFromExpanded";xa.gbd="flyoutFromCollapsed";xa.kUe="flyoutStacked";xa.KCh="flyoutFromStacked";xa.JCh="flyoutFadeOut";
xa.LCh="cui-img-cont-float cui-img-20by20";xa.MCh="flyoutLtrDir";xa.OCh="flyoutRtlDir";Object(yc.a)(xa,"ModernPresenceTooltipFlyoutControl",fa,[]);Object(yc.a)(pa,"FlyoutsPositioningInfo",null,[]);var xe=b(39);ma.prototype.jRh=function(ya,Cb,cc,Rc,yd){var od=yd.y,ze=yd.height,gf=this.uJh(Rc),of=gf+Cb,tg=ya*cc+2*(ya-1);cc=null;1===ya||this.STg(gf,tg,od,ze)?ya=new pa(0,0,2):(ya=this.Uad(of,tg,od,ze),ya.offsetTop-=gf);this.SIc?cc=new pa(0,0,void 0,this.lj?4:3):(Rc=this.tJh(Rc,yd),gf=Math.max(0,yd.x),
yd=yd.width,Cb=Rc+Cb,this.TTg(Rc,gf,yd)?cc=new pa(0,0,void 0,this.lj?3:4):this.UTg(Cb,gf)&&(cc=new pa(0,0,void 0,this.lj?4:3)),cc||(cc=this.SBh(Rc,Cb,gf,yd)));return new pa(ya.offsetTop,cc.offsetLeft,ya.ifg,cc.g8e)};ma.prototype.uJh=function(ya){return xe.a.sJh(ya)};ma.prototype.tJh=function(ya,Cb){return this.lj?Cb.width-xe.a.rJh(ya):xe.a.qJh(ya)};ma.prototype.STg=function(ya,Cb,cc,Rc){return ya+Cb<=cc+Rc};ma.prototype.Uad=function(ya,Cb,cc,Rc){var yd=1,od=Math.max(cc,ya-Cb);Cb>ya-cc&&(yd=2,od=Cb<
Rc?Rc-Cb:cc);return new pa(od,0,yd)};ma.prototype.TTg=function(ya,Cb,cc){return ya+150<=Cb+cc};ma.prototype.UTg=function(ya,Cb){return 150<=ya-Cb};ma.prototype.SBh=function(ya,Cb,cc,Rc){Rc-Cb>=ya-cc?ya=4:(Cb=ya,ya=3);return new pa(0,Cb,void 0,ya)};Object(yc.a)(ma,"ModernPresenceTooltipPositioner",null,[]);ka.prototype.update=function(ya,Cb){if(3!==ya)if(5!==ya&&this.YL&&this.YL.length){if(4===ya){var cc=this.Opg;var Rc=(this.OXa-cc)/2;this.element.style.height=this.OXa+"px";this.element.style.width=
this.OXa+"px";ya=ud.a.oD(this.YL[0].element.style.top);Cb=ud.a.oD(this.qJ?this.YL[0].element.style.right:this.YL[0].element.style.left)}else cc=this.F3d,Rc=(this.OXa-cc)/2,this.element.style.height=this.OXa+"px",this.element.style.width=this.MKh()+2*Rc+"px",ya=ud.a.oD(this.YL[this.YL.length-1].element.style.top),Cb=this.qTg(this.YL[this.YL.length-1].element,cc,Cb);ud.a.JRa(this.element,"border-radius",this.OXa+"px");this.element.style.top=ya-Rc-cc+"px";this.qJ?this.element.style.right=Cb-Rc+"px":
this.element.style.left=Cb-Rc+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)};ka.prototype.qTg=function(ya,Cb,cc){return this.qJ&&!cc?ud.a.oD(ya.style.right):this.qJ||cc?this.qJ&&cc?-ud.a.oD(ya.style.left)-Cb:-ud.a.oD(ya.style.right)-Cb:ud.a.oD(ya.style.left)};ka.prototype.MKh=function(){return this.YL&&this.YL.length?this.F3d+Math.min(this.YL.length-1,2)*this.Ylg:0};Ek.Object.defineProperties(ka.prototype,
{element:{configurable:!0,enumerable:!0,get:function(){return this._element}}});Object(yc.a)(ka,"ModernPresenceTooltipTarget",null,[]);var Qe=b(165),jg=b(275);Am(W,fa);W.prototype.nVc=function(ya){this.addHandler(ta.mka,ya)};W.prototype.Ssc=function(ya){this.removeHandler(ta.mka,ya)};W.prototype.dispose=function(){if(this.Fcf)this.QOc=!0;else{if(this.YJ)for(var ya=El(this.YJ),Cb=ya.next();!Cb.done;Cb=ya.next())Cb=Cb.value,Cb.Ssc(Object(Cd.a)(this,this.K9a,"onInteractivityChanged")),Hc.a.Ha(Cb);this.YL=
null;this.yA.za(Yd.a.pointerDown,this.aqa.element,Object(Cd.a)(this,this.H9a,"onHitTarget"));this.yA.za(Yd.a.pointerOver,this.aqa.element,Object(Cd.a)(this,this.H9a,"onHitTarget"));this.yA.za(Yd.a.pointerOut,this.aqa.element,Object(Cd.a)(this,this.H9a,"onHitTarget"));fa.prototype.dispose.call(this)}};W.prototype.uX=function(){this.gHa();this.visible=!0};W.prototype.Sda=function(){this.visible=!0;this.yRe();this.wDa=!0};W.prototype.hide=function(){this.QOf();this.y7e();this.aqa.update(this.uBa,this.lXa)};
W.prototype.DYa=function(ya){var Cb=this.uBa,cc=this.wDa;ya.clientId||(ya.clientId=(W.u8d++).toString());if(ya.clientId in this.gTb){var Rc=this.Rtb(ya.clientId);if(0<=Rc){Rc=this.IA[Rc];if(Rc.color===ya.color&&Rc.userName===ya.userName)return;this.hbb(ya.clientId)}}this.hide();Rc=new xa(this.createElement("div"),this.ze);Rc.nVc(Object(Cd.a)(this,this.K9a,"onInteractivityChanged"));this.tfa.insertBefore(Rc.element,this.tfa.firstChild);this.gTb[ya.clientId]=Rc;Array.add(this.IA,ya);Array.add(this.YJ,
Rc);this.Gdg(Cb,cc);this.visible=!0};W.prototype.hbb=function(ya){if(this.Fcf)Array.add(this.ajb,ya);else{var Cb=this.uBa,cc=this.wDa;this.hide();this.bPf(ya);this.Gdg(Cb,cc)}};W.prototype.U8a=function(ya){var Cb=this.Rtb(ya);if(!(0>=Cb)){var cc=this.IA[Cb];ya=this.gTb[ya];Array.removeAt(this.IA,Cb);Array.insert(this.IA,0,cc);Array.removeAt(this.YJ,Cb);Array.insert(this.YJ,0,ya);this.tfa.removeChild(ya.element);this.tfa.appendChild(ya.element);this.gHa()}};W.prototype.Gdg=function(ya,Cb){0>=this.IA.length?
this.hide():3===ya&&Cb?this.Sda():this.uX()};W.prototype.OKb=function(ya,Cb){Cb?this.Izg(ya):this.fOf(ya)};W.prototype.yna=function(ya){ya!==this.nTb&&(this.nTb=ya,this.qPd(ya))};W.prototype.position=function(ya,Cb){this.element.style.top=Cb+"px";this.element.style.left=ya+"px"};W.prototype.gHa=function(ya){if(void 0===ya||!ya||this.Z8){this.nTb&&this.qPd(!0);var Cb=Math.min(3,this.Xia)-1;ya=0;var cc=1,Rc=0;this.lXa&&(ya=this.Agb,cc=-1,Rc=-this.ssa);for(var yd=this.Xia-1;yd>Cb;yd--)this.YJ[yd].G2f(this.IA[yd],
-4*Cb*cc+Rc,!0,!1,!0,ya);for(;0<=Cb;Cb--)this.YJ[Cb].G2f(this.IA[Cb],-4*Cb*cc+Rc,0<Cb,Array.contains(this.Tea,this.IA[Cb].clientId),Cb!==this.dUb,ya);this.dUb=0;this.aqa.update(0,this.lXa);this.zIndex=this.dsb;this.wDa=!1;this.QOf(0);this.QOc&&this.dispose()}};W.prototype.yRe=function(){this.nTb&&this.qPd(!1);this.zIndex=this.dsb+1;var ya=this.qqj();var Cb=ya.offsetX;var cc=ya.offsetY;ya=ya.f8e;for(var Rc=0;Rc<this.Xia;Rc++)this.YJ[Rc].Vyj(this.IA[Rc],Cb,cc+(this.ssa+2)*Rc,Rc!==this.dUb,ya)};W.prototype.y7e=
function(){var ya=0,Cb=0;this.lXa&&(ya=this.Agb,Cb=-6);for(var cc=0;cc<this.Xia;cc++)this.YJ[cc].hide(this.IA[cc],Cb,ya);this.zIndex=this.dsb;this.visible=this.wDa=!1;this.QOc&&this.dispose()};W.prototype.p1c=function(ya){var Cb=this;(ya=void 0===ya?0:ya)?(this.Z8=!0,zb.Task.delay(ya).continueWith(function(){Cb.J7d?Cb.q6h():Cb.gHa(!0);Cb.Z8=!1})):this.J7d?this.hide():this.gHa()};W.prototype.q6h=function(){this.Z8&&this.hide()};W.prototype.VNg=function(){if(wb.AFrameworkApplication.ta&&wb.AFrameworkApplication.ta.Qa.Jz&&
Qe.c()){var ya=appChrome.selectors.getShyState();return ya.isActive&&0!==ya.state}return!1};W.prototype.K9a=function(ya,Cb){var cc=this;ya=this.uBa;this.VNg()||2!==Cb.type&&(4!==Cb.type||3===ya)?4===Cb.type&&3===ya?(this.Z8&&(this.Z8=!1),this.p1c()):3!==Cb.type||3!==ya||this.wDa||(1<this.Xia?(this.Z8=!0,zb.Task.delay(250).continueWith(function(){cc.gHa(!0);cc.Z8=!1})):this.p1c()):(this.Z8&&(this.Z8=!1),3!==ya&&(this.yRe(),3===Cb.mtb.yb&&this.p1c(2E3)));this.raiseEvent(ta.mka,Cb)};W.prototype.H9a=
function(ya){3===ya.yb?this.K9a(this,new ta(4,ya)):ya.eventName===Yd.a.pointerOver?this.K9a(this,new ta(2,ya)):ya.eventName===Yd.a.pointerOut&&this.K9a(this,new ta(3,ya));return!1};W.prototype.voj=function(ya){this.element.style.width=ya+"px";this.element.style.height=this.ssa+"px"};W.prototype.bPf=function(ya){this.fOf(ya);ya=this.Rtb(ya);if(!(0>ya)){var Cb=this.IA[ya];Array.removeAt(this.IA,ya);delete this.gTb[Cb.clientId];Cb=this.YJ[ya];this.tfa.removeChild(Cb.element);this.ze.get(18,!1)&&Cb.Ssc(Object(Cd.a)(this,
this.K9a,"onInteractivityChanged"));Array.removeAt(this.YJ,ya);Cb.dispose()}};W.prototype.QOf=function(ya){ya=void 0===ya?5:ya;if(this.ajb.length){this.visible&&this.y7e();for(var Cb=0;Cb<this.ajb.length;Cb++)this.bPf(this.ajb[Cb]);Array.clear(this.ajb);0>=this.IA.length||5===ya?this.hide():0===ya&&this.uX()}};W.prototype.Rtb=function(ya){for(var Cb=0;Cb<this.IA.length;Cb++)if(this.IA[Cb].clientId===ya)return Cb;return-1};W.prototype.Izg=function(ya){if(-1===this.Rtb(ya))bc.ULS.sendTraceTag(41706451,
302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.Tea,ya)){if(this.IA[0].clientId===ya)return;Array.remove(this.Tea,ya)}Array.add(this.Tea,ya);this.U8a(ya);1!==this.uBa&&this.gHa()}};W.prototype.fOf=function(ya){-1===this.Rtb(ya)?bc.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.Tea,ya)&&(Array.remove(this.Tea,ya),this.IA[0].clientId===ya&&0<this.Tea.length&&this.U8a(this.Tea[this.Tea.length-
1]),this.IA[0].clientId===ya&&1===this.uBa&&this.gHa())};W.prototype.qPd=function(ya){ya?Sys.UI.DomElement.addCssClass(this.tfa,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.tfa,"prBackgroundSelection")};W.prototype.qqj=function(){var ya;var Cb=ya=0;var cc=this.Agb;if(this.kje){var Rc=this.kje(this);if(!Rc)return{offsetX:ya,offsetY:Cb,f8e:cc};var yd=4===this.uBa;cc=this.Etg.jRh(this.Xia,yd?6:this.ssa,this.ssa,this.element,Rc);Cb=cc.offsetTop;this.dUb=this.uQh(cc.ifg,cc.offsetTop);
cc=cc.g8e;cc!==this.Agb&&(this.OKd(cc),this.element.dir=3===cc?"rtl":"ltr",this.Agb=cc);cc!==this.iYe()?(ya=this.Itg?-2:yd?-6:-this.ssa,this.lXa=!0):this.lXa=!1}return{offsetX:ya,offsetY:Cb,f8e:cc}};W.prototype.uQh=function(ya,Cb){if(1===ya)return this.Xia-1;ya=Math.abs(Cb);return 0<ya?ya/(this.ssa+2):0};W.prototype.OKd=function(ya){for(var Cb=0;Cb<this.Xia;Cb++)this.YJ[Cb].OKd(ya)};W.prototype.iYe=function(){return this.lj?3:4};W.OFh=function(){return String.format("{0}-{1}","presencetooltip",W.u8d++)};
Ek.Object.defineProperties(W.prototype,{xqc:{configurable:!0,enumerable:!0,get:function(){return jg.a.clone(this.IA)}},YJ:{configurable:!0,enumerable:!0,get:function(){return this.YL}},dsb:{configurable:!0,enumerable:!0,get:function(){return this.bng}},Xia:{configurable:!0,enumerable:!0,get:function(){return this.YJ?this.YJ.length:0}},uBa:{configurable:!0,enumerable:!0,get:function(){return 0<this.Xia?this.YJ[0].state:5}},Fcf:{configurable:!0,enumerable:!0,get:function(){return 3===this.uBa&&!this.wDa}}});
W.u8d=0;Object(yc.a)(W,"ModernPresenceTooltipControl",fa,[328,3]);var je=b(230),pf=b(366),qg=b(178);Z.prototype.V4g=function(){var ya=document.createElement("div");this.ze.BYa(15,!1);return new W(ya,20,this.ze)};Object(yc.a)(Z,"ModernPresenceTooltipFactory",null,[329]);var Gf=b(262),Mg=b(19),dg=b(60),lc=b(188),Nc=b(12),Nd=b(35),le=b(360),ke;(function(ya){ya[ya.none=0]="none";ya[ya.master=1]="master";ya[ya.fixed=2]="fixed";ya[ya.horizontal=3]="horizontal";ya[ya.vertical=4]="vertical";ya[ya.first=1]=
"first";ya[ya.last=4]="last"})(ke||(ke={}));Object(yc.b)("PaneType",ke);var xd=Jb.a;Am(J,xd);J.prototype.nVc=function(ya){this.addHandler("interactivityChanged",ya)};J.prototype.Ssc=function(ya){this.removeHandler("interactivityChanged",ya)};J.prototype.dispose=function(){if(0<this.Uh.count){this.hide();var ya=this.Uh.lu,Cb;for(Cb in ya)ya[Cb].dispose()}this.gridView=null;this.Uh.clear();xd.prototype.dispose.call(this)};J.prototype.jrj=function(ya){this.VGf=ya};J.prototype.uX=function(){var ya=this.Uh.lu,
Cb;for(Cb in ya)ya[Cb].uX()};J.prototype.Sda=function(){this.mkd();var ya=this.Uh.lu,Cb;for(Cb in ya)ya[Cb].Sda()};J.prototype.hide=function(){this.BTa();var ya=this.Uh.lu,Cb;for(Cb in ya)ya[Cb].hide()};J.prototype.DYa=function(ya){var Cb=this.Uh.lu,cc;for(cc in Cb)Cb[cc].DYa(ya)};J.prototype.U8a=function(ya){var Cb=this.Uh.lu,cc;for(cc in Cb)Cb[cc].U8a(ya)};J.prototype.hbb=function(ya){var Cb=this.Uh.lu,cc;for(cc in Cb)Cb[cc].hbb(ya)};J.prototype.OKb=function(ya,Cb){var cc=this.Uh.lu,Rc;for(Rc in cc)cc[Rc].OKb(ya,
Cb)};J.prototype.yna=function(ya){this.ipd!==ya&&(this.ipd=ya,ya=Nd.a.Nc(this.Uh.lu,Enum.toString(ke,J.JKa()[0])),this.dza&&ya&&(ya=Nc.DOMElementExtensions.getWidth(ya.element)/2,this.position(this.ipd?this.dza.x+14+ya:this.dza.x-14-ya,this.dza.y)))};J.prototype.position=function(ya,Cb){var cc=this.Uh.lu,Rc;for(Rc in cc){var yd=cc[Rc],od=Enum.parse(ke,Rc);od=this.gridView.Tf(od);var ze=R(od,new Sys.UI.Point(ya,Cb),!1);this.dza=new Sys.UI.Point(ya,Cb);0>ze.x&&(ze.x+=od.domElement.scrollLeft);Nc.DOMElementExtensions.updatePosition(yd.element,
ze.x,ze.y,!1,this.rtl)}};J.prototype.mkd=function(){this.dza&&(this.position(this.dza.x,this.dza.y),this.PMd||(this.PMd=!0,this.gridView.Ea.PG(this.Pz),this.gridView.Ea.Us(this.Pz),this.gridView.view.Vs(this.GF)))};J.prototype.BTa=function(){this.PMd&&(this.gridView.Ea.tI(this.Pz),this.gridView.Ea.Vq(this.Pz),this.gridView.view.Xq(this.GF))};J.JKa=function(){return J.U9||(J.U9=[1,3,2,4])};Ek.Object.defineProperties(J.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return null}},xqc:{configurable:!0,
enumerable:!0,get:function(){var ya=Nd.a.Nc(this.Uh.lu,Enum.toString(ke,J.JKa()[0]));return ya?ya.xqc:null}},hZi:{configurable:!0,enumerable:!0,get:function(){return this.VGf}}});J.U9=null;Object(yc.a)(J,"PaneInvariantTooltip",Jb.a,[328,3]);D.uLb=!1;D.Ona=!1;Object(yc.a)(D,"PresenceViewSettings",null,[]);F.prototype.dispose=function(){this.BTa();this.clearCache();this.$&&this.$.xa&&this.$.xa.Xg(this.Iya);this.gridView=null};F.prototype.BTa=function(){this.bic&&(this.gridView.Ea.tI(this.Pz),this.gridView.Ea.Vq(this.Pz),
this.gridView.view.Xq(this.GF),this.bic=!1)};F.prototype.XNj=function(ya){var Cb=this.Nz[ya],cc=this.Waa(ya);Cb&&this.yOf(Cb);cc&&this.Bsc(cc,Cb.iza.clientId,Cb.Ry);delete this.XTa[ya];delete this.Nz[ya];delete this.WTa[ya]};F.prototype.cZd=function(ya){var Cb=ya.Ry;this.Nz[Cb]||(this.l5a(ya),this.Nz[Cb]=ya)};F.prototype.MYd=function(ya){this.IB=ya;this.kPi(ya)};F.prototype.dTj=function(ya){var Cb=ya.Ry,cc=this.X0e(ya.wqc,ya.paneType,ya.range),Rc=this.Waa(Cb);cc&&cc!==Rc&&(ya.BMb(cc),this.XTa[Cb]=
cc,this.Nz[Cb]=ya,this.WTa[Cb]&&cc.yna(this.WTa[Cb]));Rc!==cc&&Rc&&this.Bsc(Rc,ya.iza.clientId,ya.Ry);!this.bic&&this.gridView&&(this.gridView.Ea.PG(this.Pz),this.gridView.Ea.Us(this.Pz),this.gridView.view.Vs(this.GF),this.bic=!0)};F.prototype.Bsc=function(ya,Cb,cc){ya.hbb(Cb);zc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")&&this.Waa(cc)===ya&&delete this.XTa[cc];ya.xqc&&ya.xqc.length||((Cb=ya.hZi)&&delete this.vGb[Cb],zc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")||
this.Waa(cc)===ya&&delete this.XTa[cc],ya.dispose())};F.prototype.yOf=function(ya){ya&&(ya.kJd(this.wEb),ya.KJd(this.aFb),ya.JJd(this.$Eb),ya.BMb(null))};F.prototype.l5a=function(ya){ya.mVc(this.wEb);ya.LVc(this.aFb);ya.KVc(this.$Eb)};F.prototype.OB=function(ya,Cb){if(D.Ona){Cb.Hua||this.cZd(Cb);this.dTj(Cb);var cc=this.Waa(Cb.Ry);cc&&(cc.DYa(Cb.iza),this.IB===Cb.Ry&&cc.U8a(Cb.Ry),Cb.yMa()?ya?cc.Sda():cc.uX():cc.hide())}};F.prototype.kPi=function(ya){var Cb=this.Waa(ya);Gf.a(function(){null===Cb||
void 0===Cb?void 0:Cb.U8a(ya)},this.$.la)};F.prototype.Waa=function(ya){return this.XTa[ya]};F.prototype.X0e=function(ya,Cb,cc){if(!ya)return null;ya=this.Xed(ya,Cb,cc);var Rc=this.gridView.Tf(Cb).Uq;Cb=F.mUh(ya,Cb,Rc).toString();Rc=Nd.a.Nc(this.vGb,Cb);Rc||(Rc=new J(this.gridView,this.HEd,cc),Rc.position(ya.x,ya.y),Rc.jrj(Cb),this.vGb[Cb]=Rc);return Rc};F.prototype.Xed=function(ya,Cb,cc){var Rc=this.gridView.Tf(Cb).zn,yd=this.gridView.Tf(Cb).Uq;Cb=le.a.VM(Cb,Rc.topLeft);var od=Math.max(yd.x,ya.x-
this.cwa/2-2);od=Math.min(Math.max(Cb.x+yd.x,od),Cb.x+yd.x+Rc.width-this.cwa);ya=Math.max(yd.y,ya.y-this.cwa/2+1);zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5703071_toolTipOnRightForFirstRow")&&(Cb.y+yd.y>ya||this.cKj(cc))&&(od=Math.min(od+this.cwa/4,Cb.x+yd.x+Rc.width-this.cwa));ya=Math.min(Math.max(Cb.y+yd.y,ya),Cb.y+yd.y+Rc.height-this.cwa);return new Sys.UI.Point(od,ya)};F.prototype.clearCache=function(){var ya=this.Nz,Cb;for(Cb in ya)this.yOf(ya[Cb]);ya=this.vGb;for(var cc in ya)ya[cc].dispose();
this.XTa={};this.Nz={};this.vGb={};this.WTa={};Hc.a.Ha(this.Hoa);this.Hoa=null};F.prototype.lrb=function(){var ya=new Ca;ya.add(0,Mg.a.H9c);ya.add(1,this.O8e);ya.add(12,49);ya.add(6,this.cwa);this.gridView&&(ya.add(4,vc.a.We(3)),ya.add(5,vc.a.We(3)),ya.add(8,this.gridView.rtl));ya.add(18,!0);this.HEd=new Z(ya);ya.add(16,this.y_h)};F.prototype.bSj=function(ya){var Cb=new Ca;Cb.add(0,Mg.a.H9c);Cb.add(1,this.O8e);Cb.add(12,Number.parseInvariant(ya.toString()));Cb.add(6,this.cwa);this.gridView&&(Cb.add(4,
vc.a.We(3)),Cb.add(5,vc.a.We(3)),Cb.add(8,this.gridView.rtl));this.HEd=new Z(Cb)};F.prototype.iTj=function(ya){this.bSj(ya)};F.prototype.Hdg=function(){D.Ona&&(this.Hoa=lc.AsyncMethodContext.$u(this.aTj,100,rd.a.x_i,this.Hoa))};F.prototype.d6e=function(ya,Cb){D.Ona&&(this.WTa[Cb.Ry]&&ya.yna(this.WTa[Cb.Ry]),Cb.yMa()?Cb.Pna(!0,!0):Cb.Pna(!1,!0))};F.prototype.yna=function(ya,Cb){this.WTa[ya]=Cb;(ya=this.Waa(ya))&&ya.yna(Cb)};F.prototype.OKb=function(ya,Cb){var cc=this.Waa(ya);cc&&cc.OKb(ya,Cb)};F.mUh=
function(ya,Cb,cc){return ya.x.toString()+"-"+ya.y.toString()+"-"+Cb.toString()+"-"+cc.x.toString()+"-"+cc.y.toString()};F.prototype.cKj=function(ya){var Cb;ya=Pe.g(this.$).Ea.Tua(ya.topRight);return null===(Cb=null===ya||void 0===ya?void 0:ya[0])||void 0===Cb?void 0:Cb.Mva};Object(yc.a)(F,"PresenceTooltipManager",null,[3]);var fc=b(104),fe=b(115),oa=Jb.a;Am(aa,oa);aa.prototype.mVc=function(ya){this.addHandler("hidePresenceTooltip",ya)};aa.prototype.kJd=function(ya){this.removeHandler("hidePresenceTooltip",
ya)};aa.prototype.LVc=function(ya){this.addHandler("showPresenceTooltip",ya)};aa.prototype.KJd=function(ya){this.removeHandler("showPresenceTooltip",ya)};aa.prototype.KVc=function(ya){this.addHandler("showFullPresenceTooltip",ya)};aa.prototype.JJd=function(ya){this.removeHandler("showFullPresenceTooltip",ya)};aa.prototype.NFa=function(ya){this.addHandler("presenceChanged",ya)};aa.prototype.Nza=function(ya){this.removeHandler("presenceChanged",ya)};aa.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");
this.raiseEvent("presenceChanged");this.Lye();this.BTa();Hc.a.Ha(this.wob);this.nie=this.domElement=this.gridView=null;oa.prototype.dispose.call(this)};aa.prototype.ISd=function(ya,Cb){var cc=!!ya&&!ne.D(ya).equals(ne.D(this.vx)),Rc=!!Cb&&(!this.gh||this.gh.get_id()!==Cb.get_id());if(cc||Rc)this.raiseEvent("presenceChanged"),this.Lye(),this.Hua=!1,this.vx=ya,this.gh=Cb,this.oBb=null};aa.prototype.Y4=function(ya){this.visible=this.Hua=!1;ya&&this.raiseEvent("hidePresenceTooltip")};aa.prototype.Lga=
function(ya){this.ny.push(ya);this.c8e();ya.NFa(this.SAd)};aa.prototype.Pna=function(ya,Cb){ya?(this.visible=!0,Cb&&(this.wob=lc.AsyncMethodContext.$u(this.VAj,this.$.ya.ShowTooltipDelayInMs,rd.a.hKj,this.wob))):this.Y4(Cb)};aa.prototype.BMb=function(ya){this.nie=ya};aa.prototype.Yeb=function(){if(this.domElement&&this.visible){this.j_a=Nc.DOMElementExtensions.getBoundingClientRect(this.domElement);var ya=Math.floor(this.j_a.x);this.j_a.x=ya===this.j_a.x?ya:ya+1;this.j_a.y=Math.floor(this.j_a.y)}};
aa.prototype.yMa=function(){if(!this.vx)return!1;if(zc.EwaSettings.ma(687)){var ya=this.tUh();return ya?this.gridView.Mki(ya,this.paneType):!1}ya=this.gridView.Tf(this.paneType).zn;var Cb=this.gridView.qg(this.range,this.paneType);return ya.Hd(Cb)};aa.prototype.tUh=function(){if(this.range.isSingle){var ya=this.gridView.Ea.lva(this.range,this.$.activeItemName);return ya?(ya=ya.hs(this.range))?ya.gF:null:null}return this.range};aa.prototype.Lye=function(){for(var ya=0,Cb=this.ny.length;ya<Cb;ya++)this.ny[ya].Nza(this.SAd);
Array.clear(this.ny);this.BTa()};aa.prototype.c8e=function(){!this.aic&&1<=this.ny.length&&(this.aic=!0,this.gridView.Ea.PG(this.Pz),this.gridView.Ea.Us(this.Pz),this.gridView.view.Vs(this.GF))};aa.prototype.BTa=function(){this.aic&&!this.ny.length&&(this.aic=!1,this.gridView&&(this.gridView.Ea.tI(this.Pz),this.gridView.Ea.Vq(this.Pz),this.gridView.view.Xq(this.GF)))};aa.prototype.hbb=function(ya){ya.Nza(this.SAd);Array.remove(this.ny,ya);this.BTa()};aa.prototype.Tbg=function(){this.Yeb();for(var ya=
0,Cb=this.ny.length;ya<Cb;ya++)this.ny[ya].Yeb()};Ek.Object.defineProperties(aa.prototype,{Ry:{configurable:!0,enumerable:!0,get:function(){return this.HSc}},iza:{configurable:!0,enumerable:!0,get:function(){return this.dPc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.Mqa}},wqc:{configurable:!0,enumerable:!0,get:function(){if(!this.domElement)return null;var ya=this.gridView.Tf(this.paneType).zn,Cb=this.gridView.rtl,cc=this.domElement.offsetWidth;if(!this.gh&&4>=cc){if(this.vx){cc=
this.gridView.Gh;var Rc=this.vx.FirstRow;Cb=Cb?this.vx.FirstColumn:this.vx.LastColumn;if(cc&&!(Rc>=cc.top&&Rc<=cc.bottom&&Cb>=cc.left&&Cb<=cc.right))return Rc=Rc<=cc.top?ya.y:ya.y+(Rc>=cc.bottom?ya.height:ya.height/2),Cb=Cb<=cc.left?ya.x:ya.x+(Cb>=cc.right?ya.width:ya.width/2),this.oBb=new Sys.UI.Point(Cb,Rc)}return this.oBb}if(this.gh){ya=this.domElement.offsetTop-2;Rc=parseInt(this.domElement.style.left,10);var yd=0;Cb&&(yd=parseInt(this.domElement.parentNode.style.width,10)-cc-Rc,yd-=this.gridView.tS.ixa&&
this.gridView.tS.Drd?fe.a.xu:0);return this.oBb=new Sys.UI.Point((Cb?yd:Rc)+cc+4,ya)}return this.oBb=new Sys.UI.Point(parseInt(Cb?this.domElement.style.right:this.domElement.style.left,10)+cc,this.domElement.offsetTop)}},range:{configurable:!0,enumerable:!0,get:function(){return ne.D(this.vx)}}});Object(yc.a)(aa,"TooltipNotificationUnit",Jb.a,[730,3]);var fb=Jb.a;Am(U,fb);U.prototype.mVc=function(ya){this.addHandler("hidePresenceTooltip",ya)};U.prototype.kJd=function(ya){this.removeHandler("hidePresenceTooltip",
ya)};U.prototype.LVc=function(ya){this.addHandler("showPresenceTooltip",ya)};U.prototype.KJd=function(ya){this.removeHandler("showPresenceTooltip",ya)};U.prototype.KVc=function(ya){this.addHandler("showFullPresenceTooltip",ya)};U.prototype.JJd=function(ya){this.removeHandler("showFullPresenceTooltip",ya)};U.prototype.NFa=function(ya){this.addHandler("presenceChanged",ya)};U.prototype.Nza=function(ya){this.removeHandler("presenceChanged",ya)};U.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");
this.raiseEvent("presenceChanged");this.Yw&&this.Yw.XNj(this.Ry);var ya=this.Nz,Cb;for(Cb in ya){var cc=ya[Cb];cc.kJd(this.wEb);cc.KJd(this.aFb);cc.JJd(this.$Eb);cc.Nza(this.QEb);cc.dispose()}this.Yw=this.Jb=this.highlight=this.gridView=this.Nz=null;fb.prototype.dispose.call(this)};U.prototype.j4f=function(ya,Cb,cc){cc=void 0===cc?null:cc;ya?(this.Jb=ne.D(ya),this.Mqa=this.gridView.rb.sj(this.Jb.topRight)):cc?(this.gh=cc,this.Mqa=cc.mg.paneType):this.Mqa=1;this.kke=Cb;this.rva(this.paneType);this.ISd(ya,
cc)};U.prototype.ISd=function(ya,Cb){var cc=this.Nz,Rc;for(Rc in cc)cc[Rc].ISd(ya,Cb)};U.prototype.Y4=function(ya){this.rva(this.paneType).Y4(ya);ya=this.Nz;for(var Cb in ya)ya[Cb].Y4(!1)};U.prototype.Ule=function(ya){var Cb=this.Nz,cc;for(cc in Cb){var Rc=Cb[cc];Rc.Lga(ya.rva(Rc.paneType))}};U.prototype.Lga=function(ya){this.rva(ya.paneType).Lga(ya)};U.prototype.yMa=function(){var ya=this.rva(this.paneType).yMa(),Cb=this.Nz,cc;for(cc in Cb)ya=Cb[cc].yMa()||ya;return ya};U.prototype.Pna=function(ya,
Cb){this.Yw.cZd(this);this.rva(this.paneType).Pna(ya,Cb);Cb=this.Nz;for(var cc in Cb)Cb[cc].Pna(ya,!1)};U.prototype.BMb=function(ya){var Cb=this.Nz,cc;for(cc in Cb)Cb[cc].BMb(ya)};U.prototype.Yeb=function(){var ya=this.Nz,Cb;for(Cb in ya)ya[Cb].Yeb();this.Yw.cZd(this)};U.prototype.rva=function(ya){return this.xTh(ya,this.kke)};U.prototype.MYd=function(ya){this.Yw.MYd(ya)};U.prototype.xTh=function(ya,Cb){var cc=this.highlight?this.highlight.Hw(Cb,ya).Nf:this.gh?this.gh.get_element():null;Cb=U.PZh(Cb,
ya);var Rc=Nd.a.Nc(this.Nz,Cb);Rc||(Rc=new aa(cc,this.gridView,this.iza,ya,this.$),this.Nz[Cb]=Rc,Rc.mVc(this.wEb),Rc.LVc(this.aFb),Rc.KVc(this.$Eb),Rc.NFa(this.QEb));return Rc};U.PZh=function(ya,Cb){return ya.toString()+Cb.toString()};Ek.Object.defineProperties(U.prototype,{Ry:{configurable:!0,enumerable:!0,get:function(){return this.HSc}},iza:{configurable:!0,enumerable:!0,get:function(){return this.dPc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.Mqa}},range:{configurable:!0,
enumerable:!0,get:function(){return this.Jb}},wqc:{configurable:!0,enumerable:!0,get:function(){return this.Jb||this.gh?R(this.gridView.Tf(this.paneType),this.rva(this.paneType).wqc,!0):null}},Hua:{configurable:!0,enumerable:!0,get:function(){return this.rva(this.paneType).Hua},set:function(ya){var Cb=this.Nz,cc;for(cc in Cb)Cb[cc].Hua=ya}}});Object(yc.a)(U,"PaneInvariantTooltipNotificationUnit",Jb.a,[730,3]);ca.prototype.dispose=function(){this.vxb();Hc.a.Ha(this.ru);this.objectId=this.$=this.Ep=
this.gh=null};ca.prototype.Lga=function(ya){this.ru.Ule(ya.ru)};ca.prototype.vxb=function(){this.gh&&this.Ep&&this.Ep.User&&(this.gh.CBc(!1,this.Ep.User.UserID,null),this.ru.Y4(!0))};ca.prototype.NLb=function(){D.uLb&&this.gh&&this.Ep&&this.Ep.User&&(this.gh.CBc(!0,this.Ep.User.UserID,this.Ep.UserColor),this.ru.Yeb())};ca.prototype.OB=function(ya){D.Ona&&(this.ru.Hua=ya,this.ru.Pna(ya,!0))};ca.prototype.WLb=function(ya,Cb){this.ru.j4f(null,0===Cb?46:47,ya)};Ek.Object.defineProperties(ca.prototype,
{gh:{configurable:!0,enumerable:!0,get:function(){return this.vDa},set:function(ya){this.vDa=ya;!this.vDa||zc.EwaSettings.isChangeGateEnabled("OfficeVSO:6032771_PresenceToolTipZIndexCheck")&&!this.vDa.Ty||this.Yw.iTj(this.vDa.Ty)}}});Object(yc.a)(ca,"FloatingObjectPresenceHighlight",null,[715,3]);var Rb=b(723),dc=b(71),uc=b(10),Bd=b(259),Od=b(162),Td=Rb.a;Am(L,Td);L.prototype.dispose=function(){var ya;Hc.a.Ha(this.ru);Td.prototype.dispose.call(this);var Cb=L.r0a,cc;for(cc in Cb){var Rc=cc,yd=Cb[cc];
yd&&!yd.children.length&&(Nc.DOMElementExtensions.Af(yd),L.r0a[Rc]=null)}null===(ya=L.excelLiveManager)||void 0===ya?void 0:ya.AJd(this.REb);this.Cz=null};L.prototype.Lga=function(ya){this.ru.Ule(ya.ru)};L.prototype.OB=function(ya){D.Ona&&(this.fhc||(this.ru.Hua=ya,this.ru.Pna(ya,!0)),this.RLb=ya&&this.fhc)};L.prototype.WLb=function(ya,Cb){this.ru.j4f(ya,0===Cb?46:47);this.RLb=!1};L.prototype.NLb=function(ya){D.uLb&&(this.ru.Pna(!0,!0),this.n1d=ya,this.Fn([ya]))};L.prototype.vxb=function(ya){this.Y4();
this.Nh(ya)};L.prototype.MEe=function(ya,Cb,cc){cc.className=dc.a.tuh;cc.style.borderColor=this.Ep.UserColor;var Rc=document.createElement("div");46!==ya&&47!==ya&&(Rc.style.backgroundColor=this.Ep.UserColor);cc.appendChild(Rc);Rc.className=[dc.a.vuh,dc.a.uuh][ya-46];ya=Nd.a.Nc(L.r0a,Cb.toString());if(!ya){var yd=this.gridView.Tf(Cb).domElement;ya=document.createElement("div");yd.insertBefore(ya,yd.firstChild);L.r0a[Cb.toString()]=ya}ya.appendChild(cc);this.wdf&&this.B7h(Rc)};L.prototype.sxb=function(){};
L.prototype.nZf=function(ya,Cb,cc,Rc){var yd=this.IHg(Rc,ya,Cb);Bd.c(cc,this.gridView.rtl,uc.HelperMethods.nc(yd.x));cc.width=uc.HelperMethods.nc(yd.width);cc.top=uc.HelperMethods.nc(yd.y);cc.height=uc.HelperMethods.nc(yd.height);Cb=Cb.Nf;cc=Cb.parentNode;47===ya?L.bHd(cc,Cb,!1):46===ya&&(yd=this.Hw(47),Rc.equals(yd.ejc)?L.bHd(cc,Cb,!1):L.bHd(cc,Cb,!0));this.qZi(ya)};L.prototype.T1f=function(){return!1};L.prototype.IHg=function(ya,Cb,cc){var Rc=ya.y+this.wvb(cc,!1);cc=ya.x+this.wvb(cc,!0)+fe.a.Fcd(cc.Nf.parentNode.parentNode,
this.gridView.rtl);var yd=ya.width;ya=ya.height+1;1>cc&&-1<=cc&&46===Cb&&(yd-=1-cc,cc=1);1>Rc&&-1<=Rc&&46===Cb&&(ya-=1-Rc,Rc=1);yd=Math.max(0,yd-1);ya=Math.max(0,ya-2);return new dg.a(cc,Rc,yd,ya)};L.prototype.qZi=function(ya){this.ru.Yeb();this.n1d=ya;this.fhc=!1;this.RLb&&this.OB(!0);this.RLb=!1};L.prototype.Y4=function(){this.fhc||(this.ru.Y4(!0),this.RLb=!1)};L.bHd=function(ya,Cb,cc){cc?Cb!==ya.firstChild&&(ya.removeChild(Cb),ya.insertBefore(Cb,ya.firstChild)):Cb!==ya.lastChild&&(ya.removeChild(Cb),
ya.appendChild(Cb))};L.prototype.B7h=function(ya){var Cb;(null===(Cb=L.excelLiveManager)||void 0===Cb?0:Cb.$ya.IB)?this.C7h(ya):this.Cz.push(ya)};L.prototype.C7h=function(ya){this.Ep.User.UserID===L.excelLiveManager.$ya.IB&&(this.Y7e(ya),this.fdg(ya))};L.prototype.Rri=function(){var ya=this;L.excelLiveManager?L.excelLiveManager.LZb(this.REb):this.$.da.$a(473,function(Cb){L.excelLiveManager=Cb;L.excelLiveManager.LZb(ya.REb)})};L.prototype.Y7e=function(ya){var Cb=this;Gf.a(function(){ya.style.backgroundColor=
Cb.Ep.UserColor;ya.classList.add(dc.a.Auh)},this.$.la)};L.prototype.fdg=function(ya){this.rki&&(this.ru.MYd(L.excelLiveManager.$ya.IB),Gf.a(function(){ya.parentElement.classList.add(dc.a.zuh)},this.$.la))};L.r0a=null;Object(yc.a)(L,"PresenceHighlight",Rb.a,[]);Am(P,Sa);P.prototype.Rxc=function(){for(var ya=1===this.yc.PresenceType?47:46,Cb=0;Cb<this.Gy.length;Cb++)this.Gy[Cb].NLb(ya);for(ya=0;ya<this.pH.count;ya++)this.pH.hg(ya).NLb()};P.prototype.Xdc=function(){for(var ya=1===this.yc.PresenceType?
47:46,Cb=0;Cb<this.Gy.length;Cb++)this.Gy[Cb].vxb([ya]);for(ya=0;ya<this.pH.count;ya++)this.pH.hg(ya).vxb()};P.prototype.dispose=function(){this.$&&(this.$.xa&&this.$.xa.Xg(this.Iya),Pe.g(this.$).cL(this.Tq));this.AIe();Hc.a.zc(this.Gy);Hc.a.zc([this.gA]);this.gA=this.$=null;this.OPd(null);this.pH=null;Sa.prototype.dispose.call(this)};P.prototype.AIe=function(){if(this.pH){for(var ya=0;ya<this.pH.count;ya++)this.pH.hg(ya).dispose();this.pH.clear()}};P.prototype.L_a=function(ya){1===this.yc.Version?
this.DWg(ya):this.EWg(ya)};P.prototype.DWg=function(ya){if(ya.yc.SelectedRange&&this.yc.SelectedRange)for(var Cb=this.yc.SelectedRange.length,cc=ya.yc.SelectedRange.length,Rc=0;Rc<Cb;Rc++)for(var yd=0;yd<cc;yd++)if(La(this.yc.SelectedRange[Rc],ya.yc.SelectedRange[yd])){this.Gy[Rc].Lga(ya.i4a(yd));return}};P.prototype.EWg=function(ya){var Cb,cc=0,Rc=0;if(this.yc&&this.yc.Object&&(null===(Cb=ya.yc)||void 0===Cb?0:Cb.Object)){Cb=this.yc.Object.length;for(var yd=ya.yc.Object.length,od=0;od<Cb;od++)if(this.yc.Object[od]&&
this.Hgd(this.yc.Object[od])){cc++;for(var ze=0;ze<yd;ze++)if(ya.yc.Object[ze]&&this.Hgd(ya.yc.Object[ze])&&(Rc++,this.XWc(this.yc.Object[od],ya.yc.Object[ze]))){var gf=this.i4a(cc),of=ya.i4a(Rc);if(gf&&of){gf.Lga(of);return}}}else if(this.yc.Object[od]&&ya.yc.Object[od]&&(0===this.yc.Object[od].ObjectType||2===this.yc.Object[od].ObjectType))for(ze=0;ze<yd;ze++)if(ya.yc.Object[ze]&&(0===ya.yc.Object[od].ObjectType||2===ya.yc.Object[od].ObjectType)&&this.yc.Object[od].ObjectId===ya.yc.Object[ze].ObjectId&&
(gf=this.ued(this.yc.Object[od].ObjectId),of=ya.ued(this.yc.Object[od].ObjectId),gf&&of)){gf.Lga(of);return}}if(ya.yc.SelectedRange&&this.yc.SelectedRange)for(Cb=this.yc.SelectedRange.length,yd=ya.yc.SelectedRange.length,od=0;od<Cb;od++)for(ze=0;ze<yd;ze++)if(La(this.yc.SelectedRange[od],ya.yc.SelectedRange[ze])&&(gf=this.i4a(cc+od),of=ya.i4a(Rc+ze),gf&&of)){gf.Lga(of);return}};P.prototype.XWc=function(ya,Cb){return!!ya&&!!Cb&&Cb.ObjectType===ya.ObjectType&&(1===ya.ObjectType||3===ya.ObjectType)&&
!ya.ObjectId.localeCompare(Cb.ObjectId)};P.prototype.i4a=function(ya){return 0<=ya&&this.Gy.length>ya?this.Gy[ya]:null};P.prototype.b4f=function(ya){for(var Cb=0,cc=this.Gy.length;Cb<cc;Cb++)this.Gy[Cb].OB(ya)};P.prototype.ued=function(ya){return ya&&this.pH.xb(ya)?this.pH.getItem(ya):null};P.prototype.c4f=function(ya,Cb){Cb=void 0===Cb?null:Cb;if(ya)(ya=this.pH.getItem(Cb))&&ya.OB(!0);else for(ya=0;ya<this.pH.count;ya++)(Cb=this.pH.hg(ya))&&Cb.OB(!1)};P.prototype.adg=function(ya){Sa.VRj(this,ya)};
P.prototype.d4c=function(ya,Cb){if(ya<Cb)return this.Gy[ya];if(!this.Ep||!this.$||!this.Yw)return null;ya=new L(this.Ep,this.$,this.Yw);this.Gy.push(ya);return ya};P.prototype.Ppj=function(){for(var ya=this.Gy.length,Cb=this.yc.SelectedRange?this.yc.SelectedRange.length:0,cc=this.$.xa.qa,Rc=0;Rc<Cb;Rc++){var yd=this.d4c(Rc,ya);yd&&this.yc.SelectedRange[Rc]&&(this.yc.SelectedRange[Rc].NamedObjectName?yd.Nh([47,46]):(yd.WLb(this.yc.SelectedRange[Rc],this.yc.PresenceType),P.LYd(this.yc.PresenceType,
yd,this.yc.SelectedRange[Rc],cc,this.Ep,this.Yw)))}for(Cb=this.gA&&this.gA.fFd&&this.gA.fFd.PresenceType!==this.gA.yc.PresenceType?0:Cb;Cb<ya;Cb++)this.Gy[Cb].Nh([1===this.gA.fFd.PresenceType?47:46])};P.prototype.Hgd=function(ya){return(null===ya||void 0===ya?0:ya.ObjectId)&&(1===this.Q_e(ya.ObjectType)||2===this.Q_e(ya.ObjectType))&&(ya=this.$.Hb.xfd(ya.ObjectId))?ne.w(ya):null};P.prototype.Qpj=function(){for(var ya=this.Gy.length,Cb=this.$.xa.qa,cc=this.yc.SelectedRange?this.yc.SelectedRange.length:
0,Rc=this.yc.Object?this.yc.Object.length:0,yd=0;yd<ya;yd++)this.Gy[yd].Nh([47,46]);this.NXg();for(var od=this.c3c=this.b3c=yd=0;od<Rc;od++){var ze=this.yc.Object[od],gf=this.Hgd(ze);if(gf){var of=this.d4c(yd,ya);1===ze.ObjectType?this.b3c++:3===ze.ObjectType&&this.c3c++;yd++;of.WLb(gf,ze.ObjectPresenceType);P.LYd(ze.ObjectPresenceType,of,gf,Cb,this.Ep,this.Yw)}}for(Rc=0;Rc<cc;Rc++)this.yc&&this.yc.SelectedRange&&(od=this.yc.SelectedRange[Rc],od.NamedObjectName||(ze=!!Cb&&od.SheetName===Cb.name,gf=
!!mb(od,this.$,1),ze&&gf||(ze=this.d4c(yd+Rc,ya),ze.WLb(od,this.yc.PresenceType),P.LYd(this.yc.PresenceType,ze,od,Cb,this.Ep,this.Yw))));0<(this.countFloatingObjects=this.GXf())&&bc.ULS.sendTraceTag(537154370,0,50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')};P.prototype.NXg=function(){this.GXf();this.AIe()};P.prototype.GXf=function(){var ya=0;if(this.yc&&this.yc.Object)for(var Cb=0;Cb<this.yc.Object.length;Cb++)this.FQj(this.yc.Object[Cb])&&ya++;return ya};P.prototype.Z7g=function(ya,
Cb){if(this.pH.xb(Cb))return Cb=this.pH.getItem(Cb),Cb.gh=ya,Cb;if(!this.Ep||!this.$||!this.Yw)return null;var cc=new ca(this.Ep,this.$,this.Yw);cc.gh=ya;this.pH.add(Cb,cc);return cc};P.prototype.FQj=function(ya){var Cb=!1;if((null===ya||void 0===ya?0:ya.ObjectId)&&(0===ya.ObjectType||2===ya.ObjectType))try{var cc=this.NOh(ya);if(cc){var Rc=this.Z7g(cc,ya.ObjectId);Rc.WLb(cc,ya.ObjectPresenceType);Rc.NLb();Cb=!0}}catch(yd){throw bc.ULS.sendTraceTag(537154369,0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',
yd.stack),yd;}return Cb};P.prototype.NOh=function(ya){if(!ya)return null;var Cb=null;2===ya.ObjectType?Cb=fc.a(this.$).hKa(ya.ObjectId):0===ya.ObjectType&&(ya=this.$.Hb.xfd(ya.ObjectId),null===ya||void 0===ya?0:ya.wLa)&&(Cb=fc.a(this.$).zQh(ya.wLa));return Cb};P.prototype.MOd=function(){try{1===this.yc.Version?(this.Ppj(),bc.ULS.sendTraceTag(537154368,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.Qpj(),bc.ULS.sendTraceTag(537154339,0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',
this.countFloatingObjects,this.b3c,this.c3c))}catch(ya){throw bc.ULS.sendTraceTag(537154338,0,10,'{{"SetGridHighlight Exception":"{0}"}',ya.stack),ya;}};P.prototype.Q_e=function(ya){switch(ya){case 0:return 0;case 1:return 1;case 3:return 2;case 2:return 9;default:return-1}};P.LYd=function(ya,Cb,cc,Rc,yd,od){var ze=1===ya?47:46;Rc&&cc&&Rc.name===cc.SheetName?(Cb.wj(ne.D(cc),[ze]),Cb.NLb(ze),bc.ULS.shipAssertTag(537154337,0,Cb.ru.Ry===yd.User.UserID,"UserID and UnitID should match"),od.OKb(Cb.ru.Ry,
1===ya)):Cb.vxb([ze])};Ek.Object.defineProperties(P.prototype,{yc:{configurable:!0,enumerable:!0,get:function(){return this.gA.yc},set:function(ya){this.gA.yc=ya;this.MOd()}}});Object(yc.a)(P,"UserGridPresence",Sa,[]);var Ze=b(45),vf=b(1001),wf=Jb.a;Am(Q,wf);Q.prototype.NFa=function(ya){this.addHandler("pcek",ya)};Q.prototype.Nza=function(ya){this.removeHandler("pcek",ya)};Q.prototype.cPf=function(ya){this.SBa[ya]&&this.SOf(ya,!1)};Q.prototype.DTd=function(ya){this.Nrb&&this.Nrb!==ya.clientId&&(this.KQd=
!1);!zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5657706_CorrectPresenceBootTelemetry")||this.$.ea.d5a&&Ze.PageLoadTrackingInfo.instance.ynj||(this.KQd=!1);this.nL.a1g(ya);this.Nrb=ya.clientId};Q.prototype.GQh=function(ya,Cb){var cc=[];var Rc=[];var yd=this.SBa,od;for(od in yd){var ze=yd[od];if(Cb){var gf=ne.k(ya,this.$);this.u3e(gf,cc,Rc,ze)}else this.t3e(ya,cc,Rc,ze)}return{hci:cc,zih:Rc}};Q.prototype.vHe=function(ya,Cb,cc,Rc,yd){(yd=this.SBa[yd])&&(Cb?this.u3e(ya,cc,Rc,yd):this.t3e(ya,cc,Rc,
yd))};Q.prototype.G_h=function(){var ya=[],Cb=this.SBa,cc;for(cc in Cb){var Rc=Cb[cc],yd=Rc.yc.SelectedRange;if(void 0!==yd&&null!==yd&&zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5280212_Guard_PresenceState.SelectedRange")){yd=El(yd);for(var od=yd.next();!od.done;od=yd.next()){od=od.value;var ze=ne.D(od),gf=Pe.g(this.$).ha.sa.x4;if(this.$.xa.qa.sheetName===od.SheetName&&ze.right===gf.right&&ze.top===gf.top){Rc=Rc.Ep;Rc=new Ob.a(Rc.User.UserID,Rc.User.UserName,Rc.UserColor,new pd.a(1),null,Rc.UserEmail,
void 0,void 0,void 0,void 0,void 0,Rc.JoinCoauthTime);ya.push(Rc);break}}}}return ya};Q.prototype.Rxc=function(){D.uLb=!0;D.Ona=!0;var ya=this.Su,Cb;for(Cb in ya)ya[Cb].Rxc()};Q.prototype.Xdc=function(){D.uLb=!1;D.Ona=!1;var ya=this.Su,Cb;for(Cb in ya)ya[Cb].Xdc()};Q.prototype.dispose=function(){this.VNb();this.$&&(this.$.xa&&this.$.xa.Xg(this.Iya),this.$.na&&this.$.na.qda(this.o8),this.$.rm(this.Yc));this.Bn&&this.Bn.eJd(this.aEb);this.qXc&&(this.qXc.dispose(),this.qXc=null);if(this.Su){var ya=this.Su,
Cb;for(Cb in ya)ya[Cb].dispose()}Hc.a.zc([this.nL,this.Yw]);this.nye();this.Su=this.$=this.cge=null;Array.clear(this.ny);wf.prototype.dispose.call(this)};Q.prototype.VNb=function(){this.nL&&(this.nL.Nza(this.QBd),this.nL.qaj(this.cwf),this.nL.Qbj(this.vAf),this.nL.oda(this.kd));this.sOa.XPf(this.IEb)};Q.prototype.ZEe=function(ya){return new P(ya,this.$,this.Yw)};Q.prototype.Rle=function(ya){var Cb=this.$.ea.shd(ya);if(Cb)if(ya in this.Su)this.Su[ya].adg(Cb);else{var cc=this.ZEe(Cb);this.Su[ya]=cc;
this.L_a(cc)}return!!Cb};Q.prototype.u3e=function(ya,Cb,cc,Rc){if(ya){ya=El(ya);for(var yd=ya.next();!yd.done;yd=ya.next()){if(yd=yd.value){var od=mb(yd,this.$,1);if(od&&Q.uhd(od.jj,Cb,cc,Rc))break;if((od=mb(yd,this.$,2))&&Q.uhd(od.jj,Cb,cc,Rc))break}if(Rc.yc.SelectedRange){od=El(Rc.yc.SelectedRange);for(var ze=od.next();!ze.done;ze=od.next())if((ze=ze.value)&&yd&&La(yd,ze)){Array.add(1===Rc.yc.PresenceType?cc:Cb,Rc.gA.KOb.User);return}}}}};Q.prototype.t3e=function(ya,Cb,cc,Rc){ya&&Q.uhd(this.TOh(ya),
Cb,cc,Rc)};Q.prototype.QHg=function(ya){ya.SelectedRange&&(ya.SelectedRangeRaw=this.Mbh(ya.SelectedRange),ya.SelectedRange=this.sOa.J2g(ya.SelectedRange))};Q.prototype.Mbh=function(ya){for(var Cb=Array(ya.length),cc=0;cc<ya.length;cc++){var Rc=cc,yd=ya[cc],od={};od.SheetName=yd.SheetName;od.FirstColumn=yd.FirstColumn;od.FirstRow=yd.FirstRow;od.LastRow=yd.LastRow;od.LastColumn=yd.LastColumn;od.NamedObjectName=yd.NamedObjectName;Cb[Rc]=od}return Cb};Q.prototype.TOh=function(ya){if(ya)switch(ya.type){case 0:return(ya=
this.$.Hb.P_e(ya.id))?ya.jj:null;case 2:return ya.jj}return null};Q.prototype.l5a=function(){this.nL.NFa(this.QBd);this.nL.hGg(this.vAf);this.nL.nEg(this.cwf);this.nL.R2(this.kd);this.sOa.Ane(this.IEb)};Q.prototype.Xlf=function(ya,Cb,cc,Rc){var yd={};yd.a=this.$.ya.UserSessionId;yd.b=ya;yd.c=cc?"PendingUserRemoved":"Non-PendingUserRemoved";yd.d=Rc?"Disconnected":"Inactivity";yd.e=Cb;kd.b().Qe(22,yd,!0)};Q.prototype.SOf=function(ya,Cb){ya in this.Su&&(this.aPf(ya),this.Su[ya].dispose(),delete this.Su[ya],
bc.ULS.sendTraceTag(537154375,0,50,"PresenceView.RemovePresenceForUser: userId=[{0}] removed due to inactivity",ya),this.Xlf(ya,tf.a.Ta.Wb,!1,Cb));ya in this.pma&&(this.jkc(ya,!1),delete this.J$a[ya],delete this.pma[ya],bc.ULS.sendTraceTag(537154374,0,50,"PresenceView.RemovePresenceForUser: Pending userId=[{0}] removed due to inactivity",ya),this.Xlf(ya,tf.a.Ta.Wb,!0,Cb))};Q.prototype.aPf=function(ya){for(var Cb=this.ny.length-1;0<=Cb;Cb--)if(this.ny[Cb].User.UserID===ya){Array.removeAt(this.ny,Cb);
for(var cc=El(this.Su[ya].Gy),Rc=cc.next();!Rc.done;Rc=cc.next())this.Yw.yna(Rc.value.ru.Ry,!1);this.Uxc()}};Q.prototype.Jti=function(){if(this.k4b||this.l4b)this.$.Xd(-70383382,-1,0,null),bc.ULS.sendTraceTag(537154373,0,50,"PresenceView.LogDiscontinuousCountPresenceData: Discontinuous Presence Received with count= [{0}], Continuous Presence Received with count= [{1}]",this.l4b,this.k4b);this.l4b=this.k4b=0};Q.prototype.nye=function(){this.Ttd();this.TOc=this.J$a=null};Q.prototype.Ttd=function(){var ya=
this.pma,Cb;for(Cb in ya)this.jkc(Cb,!1)};Q.prototype.ati=function(){var ya=this.D6c,Cb;for(Cb in ya)this.Hlf(Cb,!0,ya[Cb]);ya=this.sld;for(var cc in ya)this.Hlf(cc,!1,ya[cc]);this.D6c={};this.sld={}};Q.prototype.jkc=function(ya,Cb){if(this.$.tv&&this.$.ea.sc){var cc={};cc.a=this.$.ya.UserSessionId;cc.b=ya;cc.c=Cb;cc.e=!1;cc.d=-1;cc.f=tf.a.Ta.Wb;this.$.ea&&(cc.e=this.$.ea.IM);if(ya=this.J$a[ya])cc.d=Kf.a(tf.a.Ta,ya);kd.b().Qe(20,cc,!0)}};Q.prototype.wud=function(ya){if(this.$.tv){var Cb={e:-1,f:-1,
c:!1,d:!1};Cb.b=ya;Cb.a=this.$.ya.UserSessionId;this.$.ea&&(Cb.c=this.$.ea.d5a,Cb.d=this.$.ea.IM,Cb.e=this.$.ea.Pm.length,this.$.ea.fCa&&(Cb.f=Kf.a(tf.a.Ta,this.$.ea.YWj)));kd.b().Qe(21,Cb,!0)}};Q.prototype.Hlf=function(ya,Cb,cc){if(this.$.tv){var Rc={};Rc.a=this.$.ya.UserSessionId;Rc.b=ya;Rc.c=Cb;Rc.d=cc;kd.b().Qe(19,Rc,!0)}};Q.prototype.P5e=function(){var ya=[],Cb=this.Su,cc;for(cc in Cb){var Rc=Cb[cc];if(this.nL.GWf(Rc.yc)){this.Cme(ya,Rc);Array.remove(this.ny,Rc.gA.KOb);if(1===this.nL.yc.PresenceType){var yd=
{};yd.a=1===Rc.yc.PresenceType?"Editing":"Non-Editing";yd.b=this.$.ya.UserSessionId;yd.c=tf.a.Ta.Wb;kd.b().Qe(18,yd)}yd=El(Rc.Gy);for(Rc=yd.next();!Rc.done;Rc=yd.next())this.Yw.yna(Rc.value.ru.Ry,!0)}else for(yd=El(Rc.Gy),Rc=yd.next();!Rc.done;Rc=yd.next())this.Yw.yna(Rc.value.ru.Ry,!1)}Array.clear(this.ny);this.ny=ya;this.Uxc()};Q.prototype.Cme=function(ya,Cb){var cc=Cb.gA.KOb;if(0===Cb.yc.PresenceType){Cb=ya.length;var Rc;for(Rc=0;Rc<Cb&&0===this.Su[ya[Rc].User.UserID].yc.PresenceType;Rc++);Array.insert(ya,
Rc,cc)}else ya.push(cc)};Q.prototype.L_a=function(ya){this.nL.GWf(ya.yc)&&(this.Cme(this.ny,ya),this.Uxc());var Cb=ya.gA.KOb.User.UserID,cc=this.Su,Rc;for(Rc in cc){var yd=cc[Rc];Rc!==Cb&&ya.L_a(yd)}};Q.prototype.Uxc=function(){0<this.ny.length&&this.WAj()};Q.prototype.WAj=function(){for(var ya=0,Cb=this.ny.length;ya<Cb;ya++){var cc=this.Su[this.ny[ya].User.UserID];if(cc)if(this.nL.UKf(cc.yc)){cc.b4f(!0);cc=El(cc.Gy);for(var Rc=cc.next();!Rc.done;Rc=cc.next())this.Yw.yna(Rc.value.ru.Ry,!0)}else(Rc=
this.nL.YZe(cc.yc))&&cc.c4f(!0,Rc)}};Q.prototype.RTh=function(ya){var Cb={User:{}};Cb.User.UserID=ya;Cb.User.UserName=Ff.a.instance.Ab(87);Cb.UserColor="#AAAAAA";return Cb};Q.prototype.Rze=function(ya,Cb){var cc=this;this.KQd&&this.AEd&&(ya&&Cb?this.zEd?this.zEd.qkh(ya,Cb,this.Nrb):this.AEd.continueWith(function(){cc.zEd=cc.AEd.result;cc.Rze(ya,Cb)}):bc.ULS.sendTraceTag(537154372,0,15,"userId: [{0}], endTime: [{1}]",ya,Cb))};Q.uhd=function(ya,Cb,cc,Rc){if(!Rc||!Rc.yc||!Rc.yc.Object)return!1;for(var yd=
El(Rc.yc.Object),od=yd.next();!od.done;od=yd.next())if(od=od.value,ya&&od&&od.ObjectId&&!od.ObjectId.localeCompare(ya))return Array.add(1===od.ObjectPresenceType?cc:Cb,Rc.gA.KOb.User),!0;return!1};Ek.Object.defineProperties(Q.prototype,{nL:{configurable:!0,enumerable:!0,get:function(){return this.cge}},SBa:{configurable:!0,enumerable:!0,get:function(){return this.Su}},pma:{configurable:!0,enumerable:!0,get:function(){return this.TOc}}});Object(yc.a)(Q,"PresenceView",Jb.a,[660,661]);var Wf=b(211),
ug=b(231),Gg=b(328),Cf=Jb.a;Am(M,Cf);M.prototype.Aq=function(ya){this.addHandler("OSC",ya)};M.prototype.Wq=function(ya){this.removeHandler("OSC",ya)};M.prototype.Oz=function(){this.raiseEvent("OSC")};M.prototype.es=function(ya,Cb){if("QueryOcsConnectionStatus"===ya)Cb.Value=this.$.ea.v7a?Ff.a.instance.fa(906):Ff.a.instance.fa(907);else return!1;return!0};M.prototype.vn=function(){return!0};M.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.SF(this),this.statusBarManager=
null);this.$=null;Cf.prototype.dispose.call(this)};Object(yc.a)(M,"OcsStatusBarManager",Jb.a,[3,483,271]);var rg=Jb.a;Am(z,rg);z.prototype.pfd=function(){this.N_||(this.N_={},this.N_.IsPresenter=this.$.ya.IsMeetingPresenter,this.N_.MeetingId=this.$.ya.MeetingId);this.N_.MessageId=++this.messageId;bc.ULS.sendTraceTag(524940883,0,50,"SelectionPresenceManager::getMeetingInfo: Sending presence with messageId: "+this.messageId);return this.N_};z.prototype.NFa=function(ya){this.addHandler(z.BEd,ya)};z.prototype.Nza=
function(ya){this.removeHandler(z.BEd,ya)};z.prototype.nEg=function(ya){this.$.ea.Qga(ya)};z.prototype.qaj=function(ya){this.$.ea.pda(ya)};z.prototype.R2=function(ya){this.addHandler(z.J0,ya)};z.prototype.oda=function(ya){this.removeHandler(z.J0,ya)};z.prototype.hGg=function(ya){this.addHandler(z.CEd,ya)};z.prototype.Qbj=function(ya){this.removeHandler(z.CEd,ya)};z.prototype.dispose=function(){this.$&&(this.VNb(),this.$.Sl(this.zd),this.$.rm(this.Yc));this.Fj&&this.Fj.Oza(this.cma);Hc.a.Ha(this.vsf);
this.$=this.Fj=this.N_=null;rg.prototype.dispose.call(this)};z.prototype.a1g=function(ya){this.Fj?this.Fj.Oza(this.cma):this.l5a();(this.Fj=ya)?(this.Fj.OFa(this.cma),this.rcb(!0)):this.VNb()};z.prototype.l5a=function(){var ya=this;this.ha.SG(this.kd);Pe.g(this.$).nE(this.Bp);var Cb=Pe.g(this.$).rc;Cb.mo(this.ug);Cb.ml(this.gj);this.$.ea.hk(this.od);this.$.ea.mne(this.zhf);this.sOa.Ane(this.IEb);Cb=this.$.na.ua;Cb.PFa(this.SDf);Cb.Bq(this.Th);Cb.dz(this.Un);this.rgf?this.$.da.$a(16,function(cc){cc.cne(ya.inc);
cc.bne(ya.ug)}):(Cb=ub.GetServiceTaskFactory.Va(this.$.da,16,74,1),Za.TaskExtensions.Ba(Cb,function(cc){ya.fieldManagerPane=cc.result;ya.fieldManagerPane.cne(ya.inc);ya.fieldManagerPane.bne(ya.ug)},Wf.a.none,3))};z.prototype.VNb=function(){var ya=this;this.ha.WF(this.kd);Pe.g(this.$).UF(this.Bp);var Cb=Pe.g(this.$).rc;Cb.Dn(this.ug);Cb.fl(this.gj);this.$.ea.Dk(this.od);this.$.ea.NPf(this.zhf);this.sOa.XPf(this.IEb);this.$.na.ua.uQa(this.SDf);this.$.na.ua.Dr(this.Th);this.$.na.ua.Wz(this.Un);this.rgf?
this.$.da.$a(16,function(cc){cc.EPf(ya.inc);cc.DPf(ya.ug)}):this.fieldManagerPane&&(this.fieldManagerPane.EPf(this.inc),this.fieldManagerPane.DPf(this.ug));this.raiseEvent(z.CEd)};z.prototype.GWf=function(ya){return this.UKf(ya)||!!this.YZe(ya)};z.prototype.UKf=function(ya){if(2===this.yc.Version&&this.yc.Object&&2===ya.Version&&ya.Object&&0<this.yc.Object.length&&0<ya.Object.length)for(var Cb=this.yc.Object.length,cc=ya.Object.length,Rc=0;Rc<Cb;Rc++)for(var yd=0;yd<cc;yd++)if(this.XWc(this.yc.Object[Rc],
ya.Object[yd]))return!0;if(this.yc.SelectedRange&&ya.SelectedRange)for(Cb=this.yc.SelectedRange.length,cc=ya.SelectedRange.length,Rc=0;Rc<Cb;Rc++)for(yd=0;yd<cc;yd++)if(z.LKg(this.yc.SelectedRange[Rc],ya.SelectedRange[yd]))return!0;return!1};z.prototype.YZe=function(ya){if(2===this.yc.Version&&this.yc.Object&&2===ya.Version&&ya.Object&&0<this.yc.Object.length&&0<ya.Object.length)for(var Cb=this.yc.Object.length,cc=ya.Object.length,Rc=0;Rc<Cb;Rc++)for(var yd=0;yd<cc;yd++)if(z.xEi(this.yc.Object[Rc],
ya.Object[yd]))return this.yc.Object[Rc].ObjectId;return null};z.prototype.XWc=function(ya,Cb){return!!ya&&!!Cb&&ya.ObjectType===Cb.ObjectType&&(1===ya.ObjectType||3===ya.ObjectType)&&!!ya.ObjectId&&!!Cb.ObjectId&&!ya.ObjectId.localeCompare(Cb.ObjectId)};z.prototype.PWf=function(){this.rcb(!1)};z.prototype.rcb=function(ya){this.ha.Oa.oc?this.ENd(0,ya):this.NNd(Pe.g(this.$).rc.isEditing?1:0,ya)};z.prototype.ENd=function(ya,Cb){var cc={};this.$.Bj(cc);if(this.ha.Oa.oc){var Rc=this.ha.Oa.oc.floatingObject;
cc.FirstColumn=-1;cc.FirstRow=-1;cc.LastColumn=-1;cc.LastRow=-1;cc.NamedObjectName=Rc?Rc.Vg():null;this.yc.SelectedRange=[cc];this.yc.PresenceType=0;cc=null;if(Rc)switch(Rc.type){case 0:if(Rc=this.$.Hb.P_e(Rc.id))cc={},cc.ObjectType=this.Vaa(0),cc.ObjectPresenceType=ya,cc.ObjectId=Rc.jj;break;case 2:Rc.id&&(cc={},cc.ObjectType=this.Vaa(9),cc.ObjectPresenceType=ya,cc.ObjectId=Rc.jj)}this.yc.Object=[cc]}this.raiseEvent(z.J0);this.sendPresenceToService(Cb)};z.prototype.NNd=function(ya,Cb){if(!Pe.g(this.$).isEditing&&
!Pe.g(this.$).Mi){var cc=this.$.Ob.$g("ModelUpdate","SendRangePresence");cc.start();var Rc=ne.k(this.ha.sa.selectedRanges,this.$);this.yc.SelectedRange=this.sOa.I2g(Rc);this.yc.Object=[];Rc=El(Rc);for(var yd=Rc.next();!yd.done;yd=Rc.next())if(yd=mb(yd.value,this.$,1)){var od={};od.ObjectType=this.Vaa(yd.type);od.ObjectPresenceType=0;od.ObjectId=yd.jj;this.yc.Object.push(od)}this.yc.PresenceType=ya;this.raiseEvent(z.J0);this.yc.SelectedRange||this.yc.Object?this.sendPresenceToService(Cb):bc.ULS.sendTraceTag(537154371,
0,50,"SelectionPresenceManager.SendRangePresence: skip sending range presence since selected range/object are both null.  UserId: [{0}]",this.Fj.clientId);cc.stop()}};z.prototype.sendPresenceToService=function(ya){if(this.$.ea.H7b||!this.$.ea.B3b||ya)if(this.amIAlone||++this.pAa.b,this.Fj){this.yc.Version=2;this.yc.ClientType=1;this.yc.ChatThreadId=this.bXa.W_c;this.yc.ChatThreadDiscoveryUri=this.bXa.V_c;this.yc.InChat=this.bXa.Rxb;this.yc.Cid=this.bXa.email;this.yc.SupportsChat=!!this.bXa.capabilities&&
this.bXa.capabilities.VKa(4);this.yc.CollabMode=this.$.ea.v7a?2:0;this.yc.OcsCapable=this.$.ea.ocsCapable;this.$.ya.IsMeetingLiveSession&&this.$.ya.IsMeetingPresenter&&zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&(this.yc.MeetingInfo=this.pfd());this.Fj.eXf(this.yc);if(zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&this.$.ea&&this.$.ea.d5a){var Cb=(new Date).getTime();Za.TaskExtensions.Ba(ub.GetServiceTaskFactory.Va(this.$.da,
435,436,1),function(cc){cc.result.avi(Cb)},this.$.la,3)}this.amIAlone||++this.pAa.c}};z.prototype.ANd=function(){this.$.tv&&(this.pAa.a=this.$.ya.UserSessionId,kd.b().Qe(26,this.pAa,!0));this.pAa.b=0;this.pAa.c=0};z.prototype.Vaa=function(ya){switch(ya){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}};z.xEi=function(ya,Cb){return!!ya&&!!ya.ObjectId&&!!Cb&&!!Cb.ObjectId&&(0===ya.ObjectType||2===ya.ObjectType)&&ya.ObjectType===Cb.ObjectType&&!ya.ObjectId.localeCompare(Cb.ObjectId)};
z.LKg=function(ya,Cb){return!ya.NamedObjectName&&La(ya,Cb)};Ek.Object.defineProperties(z.prototype,{yc:{configurable:!0,enumerable:!0,get:function(){return this.Sqa}},amIAlone:{configurable:!0,enumerable:!0,get:function(){return!this.$.ea||this.$.ea.amIAlone}}});Ek.Object.defineProperties(z,{Tpc:{configurable:!0,enumerable:!0,get:function(){var ya={};return z.Dde||(z.Dde=(ya.ApplyFilter=1,ya.ApplyPivot=0,ya.ApplyPivotSort=0,ya.ApplyPivotSortByValue=1,ya.ApplyWellKnownPivotFilter=0,ya.RemovePivotFilter=
0,ya.SetCustomFilter=1,ya.SetTop10Filter=1,ya.TogglePivotDrill=0,ya.RefreshAll=2,ya))}}});z.BEd="presenceChanged";z.CEd="presenceDisabled";z.J0="selectionChanged";z.Dde=null;Object(yc.a)(z,"SelectionPresenceManager",Jb.a,[676,3,677]);var dh=Wd.a;Am(B,dh);B.prototype.create=function(){var ya=this;this.manager?this.Eb(this.manager):Za.TaskExtensions.Ba(ub.GetServiceTaskFactory.create(this.$.da,28,this.la,this.ub),function(Cb){ya.Eb(ya.manager||(ya.manager=new z(ya.$,Cb.result)))},this.la,3)};Object(yc.a)(B,
"SelectionPresenceManagerFactory",Wd.a,[]);var fh=b(1318),vg=b(5),Me=b(197),Of=Xe.a;Am(E,Of);E.prototype.ZZe=function(ya,Cb){this.XHa=[];Cb=this.presenceView.GQh(ya,Cb);ya=Cb.hci;Cb=Cb.zih;Array.addRange(this.XHa,ya);Array.addRange(this.XHa,Cb);return E.Aue(ya,Cb)};E.prototype.dispose=function(){this.presenceView.Nza(this.QEb);this.CPa&&(Hc.a.Ha(this.CPa),this.CPa=null);Of.prototype.dispose.call(this)};E.Aue=function(ya,Cb){if(!ya.length&&!Cb.length)return"";if(Cb.length){if(1===Cb.length)return ya=
Ff.a.instance.Ab(83),String.format(ya,Cb[0].UserName);ya=Ff.a.instance.Ab(84);return String.format(ya,Cb.length)}if(1===ya.length)return Cb=Ff.a.instance.Ab(85),String.format(Cb,ya[0].UserName);Cb=Ff.a.instance.Ab(86);return String.format(Cb,ya.length)};Object(yc.a)(E,"PresenceReadoutHandlerService",Xe.a,[659]);u.prototype.Jcd=function(ya){return ya};u.prototype.ADd=function(ya){for(var Cb=Array(ya.aHa.count),cc=0,Rc=El(ya.aHa.values),yd=Rc.next();!yd.done;yd=Rc.next())Cb[cc]=yd.value,cc++;return y(this.$.na.ua,
Cb,ya.At,ya.taa,null,null)};u.prototype.kWc=function(ya,Cb){if(!Cb)return ya;if(!ya)return bc.ULS.shipAssertTag(537154136,0,!!ya,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),Cb;bc.ULS.shipAssertTag(537154135,0,1===ya.aHa.count,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: newActionParameters has unexpected number of entries");for(var cc={},Rc=El(ya.aHa),yd=Rc.next();!yd.done;cc={hP:cc.hP,Sea:cc.Sea},yd=Rc.next())cc.hP=
yd.value,cc.Sea=void 0,function(od){return function(){var ze=Cb.aHa.Nc(od.hP.key);od.Sea=ze.value;return ze}}(cc)().returnValue?cc.Sea.OcsSessionId!==cc.hP.value.OcsSessionId?(bc.ULS.sendTraceTag(537154134,0,15,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Found nonidentical OcsSessionIds. new SeqNum: {0}, aggregated SeqNum: {1}",cc.hP.value.SeqNum,cc.Sea.SeqNum),Cb.aHa.ia(cc.hP.key,cc.hP.value.SeqNum<cc.Sea.SeqNum?cc.hP.value:cc.Sea),Cb.At=cc.hP.value.SeqNum<cc.Sea.SeqNum?
ya.At:Cb.At):(cc.hP.value.SeqNum>cc.Sea.SeqNum&&Cb.aHa.ia(cc.hP.key,cc.hP.value),Cb.At=ya.At):(Cb.aHa.add(cc.hP.key,cc.hP.value),Cb.At=ya.At);return Cb};Object(yc.a)(u,"CheckCollabServiceActionAggregationPerformer",null,[656,657]);v.prototype.Jcd=function(ya){return ya};v.prototype.ADd=function(ya){var Cb=this.$.na.ua,cc=ya.Pah,Rc=ya.Lmc;ya=ya.At;var yd=Cb.Na(1,null);yd.Id=cc;yd.OnBehalfOfOcs=Rc;return Xc.i(Cb,"CheckPersistedContentUpdate",yd,ya,null,null,null,516)};v.prototype.kWc=function(ya,Cb){if(!Cb)return ya;
if(!ya)return bc.ULS.shipAssertTag(537154133,0,!1,"CheckPersistedActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),Cb;ya.Lmc=Cb.Lmc&&ya.Lmc;return ya};Object(yc.a)(v,"CheckPersistedActionAggregationPerformer",null,[656,657]);Object(yc.a)(n,"RevisionGeneratedNotification",null,[]);Object(yc.a)(w,"StateDownloadedNotification",null,[]);var ac=b(170),Lc=Xe.a;Am(h,Lc);h.prototype.dispose=function(){this.Od=!0;this.yob&&(this.yob.dispose(),this.yob=null);this.contentRefreshManager&&
(this.wbg(),this.contentRefreshManager=null);this.Ea&&(this.VXd(),this.Ea=null);this.viewport&&(this.VXd(),this.viewport=null);this.qf&&(this.qf=null);this.$&&(this.$.Sl(this.zd),this.$.ea.Dk(this.od),this.$.ea.hQf(this.Vr),this.$=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.etc(this.iFb),this.mergeSuspensionManager=null);Lc.prototype.dispose.call(this)};h.prototype.HFj=function(){this.lzc||(this.contentRefreshManager.pGg(this.ZAf),this.lzc=!0,this.yob.Zq())};h.prototype.wbg=function(){this.lzc&&
(this.contentRefreshManager.Wbj(this.ZAf),this.lzc=!1)};h.prototype.FFj=function(){this.jzc||(this.Ea.Gx(this.Pi),this.jzc=!0)};h.prototype.VXd=function(){this.jzc&&(this.Ea.Dv(this.Pi),this.jzc=!1)};h.prototype.GFj=function(){this.kzc||(this.viewport.qGg(this.cBf),this.kzc=!0)};h.prototype.XOj=function(){this.kzc&&(this.viewport.Zbj(this.cBf),this.kzc=!1)};h.prototype.JCe=function(ya,Cb){if(ya!==qc.a.Se&&!this.$da.xb(ya)){var cc=tf.a.Ta.Wb.toISOString();cc=Object(pc.a)(new w,{StateId:ya,DownloadedOn:cc,
IsHidden:this.He?this.He.Ai:"visible"!==window.document.visibilityState,DocumentLastUnhidden:this.He&&this.He.ijc?this.He.ijc.toISOString():null,LastLostRtcConnection:this.contentRefreshManager&&this.contentRefreshManager.Yif?this.contentRefreshManager.Yif.toISOString():null,LastOffline:this.qf&&this.qf.sxa?this.qf.sxa.toISOString():null});this.mergeSuspensionManager&&(cc.IsPendingMergeBlockedByClient=this.Uwa,this.rDd&&(cc.PendingMergeBlockedByClientLastEnded=this.rDd.toISOString()));bc.ULS.sendTraceTag(537154124,
13,50,"ContentLatencyTracker.CreateAndAddstateDownloadedNotifications: {0} - StateDownloadedNotification: {1}",Cb,JSON.stringify(cc));this.$da.add(ya,cc)}};h.prototype.Svd=function(){wb.AFrameworkApplication.ag&&wb.AFrameworkApplication.ag.Svd()};Object(yc.a)(h,"ContentLatencyTracker",Xe.a,[]);var wd=b(1086);Object(yc.a)(r,"UpdateInfo",null,[]);var Mc=b(1087),ge=Sys.EventArgs;Am(m,ge);Object(yc.a)(m,"RevisionGeneratedEventArgs",Sys.EventArgs,[]);l.prototype.JRj=function(){this.vqc||(this.vqc=xe.a.Ce(),
this.ZBb())};l.prototype.GRj=function(){this.qec||(this.qec=xe.a.Ce(),this.ZBb())};l.prototype.IRj=function(){this.Kpc||(this.Kpc=xe.a.Ce(),this.ZBb())};l.prototype.KRj=function(ya){this.BCc||(this.BCc=xe.a.Ce(),this.Yaf=ya,this.ZBb())};l.prototype.ZBb=function(ya){ya=void 0===ya?0:ya;this.fef||(ya&&ya>this.Uvi?this.Exa(!0):this.vqc&&this.Kpc&&this.qec&&this.BCc&&this.Exa(!1))};l.prototype.dispose=function(){this.$=null};l.prototype.Exa=function(ya){var Cb={};Cb.CoAuthorsCount=this.$.ea.Pm.length;
Cb.HostNotificationTime=this.qec;Cb.PeerNotificationTime=this.Kpc;Cb.PresenceNotificationTime=this.vqc;Cb.UserFetchTime=this.BCc;Cb.IsAlreadyFetchedFromServer=this.Yaf;Cb.IsTimeout=ya;Cb.ClientId=this.clientId;Cb.CurrentUserClientId=this.tah;bc.ULS.sendTraceTag(541388879,0,50,"Host Notification Latency Entry: {0}",Cb);this.t9d=!0};Ek.Object.defineProperties(l.prototype,{fef:{configurable:!0,enumerable:!0,get:function(){return this.t9d}}});Object(yc.a)(l,"HostNotificationLatencyEntry",null,[3]);Object(yc.a)(f,
"PersistedContentUpdateActionParameters",null,[]);e.prototype.aOj=function(ya){this.H_b(ya.N0c,this.BGc);this.H_b(ya.O0c,this.CGc)};e.prototype.H_b=function(ya,Cb){if(ya){ya=El(ya);for(var cc=ya.next();!cc.done;cc=ya.next())Cb[cc.value]=!0}};Ek.Object.defineProperties(e.prototype,{N0c:{configurable:!0,enumerable:!0,get:function(){return vf.a(this.BGc)}},O0c:{configurable:!0,enumerable:!0,get:function(){return vf.a(this.CGc)}},edf:{configurable:!0,enumerable:!0,get:function(){return!this.N0c.length&&
!this.O0c.length}}});Object(yc.a)(e,"UpdatePresenceUsersActionParameters",null,[]);var nf=Jb.a;Am(c,nf);c.prototype.pGg=function(ya){this.addHandler("ekcrmrrg",ya)};c.prototype.Wbj=function(ya){this.removeHandler("ekcrmrrg",ya)};c.prototype.LYa=function(ya){this.addHandler("ekcrmmcu",ya)};c.prototype.pbb=function(ya){this.removeHandler("ekcrmmcu",ya)};c.prototype.gFg=function(ya){this.addHandler("LabelUpdateEventKey",ya)};c.prototype.abj=function(ya){this.removeHandler("LabelUpdateEventKey",ya)};
c.prototype.KTa=function(ya,Cb){this.$.ea.sc&&(bc.ULS.sendTraceTag(537154119,0,50,"ContentRefreshManager.UpdatePresenceUsers: clientIdsToAdd=[{0}] clientIdsToRemove=[{1}]",ya?ya.join(","):"null",Cb?Cb.join(","):"null"),this.cSj.XFf(new e(ya,Cb,null)))};c.prototype.dispose=function(){this.Fj&&(this.Fj.rIb(this.Cca),this.Fj.Oza(this.tBd));this.$&&(this.$.na.Dr(this.Th),this.$.ea.pda(this.qI));this.Bn&&(this.Bn.eJd(this.aEb),this.Bn.vPf(this.gvf));this.$=this.Fj=this.O_a=this.nLa=null;nf.prototype.dispose.call(this)};
c.prototype.DTd=function(ya){this.Fj&&(this.Fj.rIb(this.Cca),this.Fj.Oza(this.tBd));this.Fj=Object(ic.a)(309,ya);this.Fj.NYa(this.Cca);zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&this.Fj.OFa(this.tBd);this.currentUserId=this.Fj.clientId};c.prototype.yMf=function(){for(var ya=!this.Fj,Cb=El(this.$.ea.Pm),cc=Cb.next();!cc.done;cc=Cb.next())(cc=cc.value.User.UserID)&&cc!==this.currentUserId&&!this.O_a.has(cc)&&this.Wbc(cc).KRj(ya)};c.prototype.G3h=function(ya){if(qc.a.aUf in
ya&&qc.a.$Tf in ya&&qc.a.ZTf in ya){var Cb=ya[qc.a.ZTf];1!==Cb||qc.a.s7 in ya&&qc.a.xuc in ya||bc.ULS.sendTraceTag(537154076,13,10,"RTC WetContentUpdate was sent from ECS and is missing some expected fields. Has SessionSiteIdentifier: {0}, Has UserOperationTimeInMs: {1}.",qc.a.s7 in ya,qc.a.xuc in ya);var cc=this.iob(ya);var Rc=cc.gMf;cc.returnValue||(ya=new m(ya[qc.a.aUf],ya[qc.a.$Tf],Cb,Rc,qc.a.xuc in ya?ya[qc.a.xuc]:0),this.raiseEvent("ekcrmrrg",ya,this))}else bc.ULS.sendTraceTag(537154077,13,
10,"RTC WetContentUpdate is missing some critical fields. Ignoring this update.")};c.prototype.iob=function(ya){ya=qc.a.s7 in ya?ya[qc.a.s7]:null;return{returnValue:this.$.ea.s7===ya,gMf:ya}};c.prototype.Qbg=function(){this.$.ea.rna=Math.max(c.dNg,this.$.ea.rna)};c.prototype.jRd=function(ya){ya=El(ya);for(var Cb=ya.next();!Cb.done;Cb=ya.next())if(!this.$.ea.shd(Cb.value))return!0;return!1};c.prototype.b0c=function(){this.$.Xd(1562177611,-1,0,null)};c.prototype.xya=function(ya){qc.a.Cpf in ya&&qc.a.Dpf in
ya&&qc.a.Epf in ya&&(ya=Object(pc.a)(new wd.a,{Pending:ya[qc.a.Dpf],Current:ya[qc.a.Cpf],SuspensionStartTimestamp:ya[qc.a.Epf]}),this.raiseEvent("ekcrmmcu",new Mc.a(ya),this))};c.prototype.Wbc=function(ya){ya=this.MBe(ya);if(!this.nLa[ya]){var Cb=new l(ya,this.currentUserId,4E4,this.$);this.nLa[ya]=Cb}this.FVf();return Object(ic.a)(l,this.nLa[ya])};c.prototype.MBe=function(ya){if(!ya)return ya;var Cb=ya.toLocaleLowerCase();Cb.startsWith("{")||(Cb="{"+ya+"}");return Cb};c.prototype.FVf=function(){var ya=
this;this.vkd||Gc.a.isEmpty(this.nLa)||!zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)||(this.vkd=zb.Task.delay(2E4).continueWith(function(){ya.L6h()}))};c.prototype.L6h=function(){var ya=[],Cb=xe.a.Ce(),cc=this.nLa,Rc;for(Rc in cc){var yd=Rc,od=Object(ic.a)(l,cc[Rc]);od.ZBb(Cb);od.fef&&(od.dispose(),ya.push(yd))}ya=El(ya);for(Cb=ya.next();!Cb.done;Cb=ya.next())Cb=Cb.value,delete this.nLa[Cb],this.O_a.add(Cb);this.vkd=null;this.FVf()};Ek.Object.defineProperties(c.prototype,
{Yif:{configurable:!0,enumerable:!0,get:function(){return this.L$d}},$hj:{configurable:!0,enumerable:!0,get:function(){return!!this.Fj&&2===this.Fj.connectionState}}});c.dNg=3E4;Object(yc.a)(c,"ContentRefreshManager",Jb.a,[658]);var Ee=b(62);a.prototype.Jcd=function(ya){return ya+5E3};a.prototype.ADd=function(ya){var Cb=this;return this.$.ea.sc?Za.TaskExtensions.ts(Za.TaskExtensions.ts(zb.Task.delay(0),function(){var cc=Cb.$.na.ua,Rc=ya.N0c,yd=ya.O0c,od=ya.At,ze=cc.Na(1,null);ze.clientIdsToAdd=Rc;
ze.clientIdsToRemove=yd;return Xc.i(cc,"UpdatePresenceUsers",ze,od,null,null,null,0)},Wf.a.none,0,Ee.a.current),function(){return zb.Task.delay(5E3)},Wf.a.none,0,Ee.a.current):zb.Task.Sa(!0)};a.prototype.kWc=function(ya,Cb){if(!Cb)return ya;if(!ya)return bc.ULS.shipAssertTag(537154073,0,!1,"UpdatePresenceUsersActionAggregationPerformer.AggregateActionParameters: Received null newActionParameter"),Cb;if(Cb.edf)return Cb;if(ya.edf)return ya;Cb.aOj(ya);return Cb};Object(yc.a)(a,"UpdatePresenceUsersActionAggregationPerformer",
null,[656,657]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.CoauthTelemetry");wc.main();Type.registerNamespace("Common.App.CollabControls");Type.registerNamespace("Common.App.Presence");Type.registerNamespace("RealtimePresenceUI");Vb.a.Fa(gb.ka);(function(){Vb.a.Fa(function(ya){zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&kb.ka(ya);var Cb=ya.da;Cb.Ga(28,new Ha(ya));Cb.Ga(158,new B(ya));Vb.a.Fa(Nb.ka);var cc=ub.GetServiceTaskFactory.create(ya.da,
158,Cb.la,1),Rc=ub.GetServiceTaskFactory.create(ya.da,28,Cb.la,1);Za.TaskExtensions.Ba(Za.TaskExtensions.ye([cc,Rc],Cb.la),function(){var yd=new Kb.a,od=Cb.Aa(26);od.zEe(Object(Cd.a)(yd,yd.setResult,"setResult"));var ze=new Q(ya,od,cc.result,Rc.result,ib.a.ar(Qa.a.instance.lc("Common.App.CoauthTelemetry.IPresenceBootTelemetry")));we.a.getInstance(ya.da).add(ze);Cb.Ga(159,new Nb);Za.TaskExtensions.Ba(ub.GetServiceTaskFactory.create(Cb,159,Cb.la,1),function(gf){var of=new Kb.a;of.setResult(ze);new Ia(Object(pc.a)(new Ob.a,
{clientId:ya.workbookContext.ClientId}),yd.task,of.task,gf.result,Ad.a.instance,wb.AFrameworkApplication.ga.ra("AwayStatusOneMinuteTimeoutIsEnabled")?6E4:wb.AFrameworkApplication.ga.Dd("AwayCoauthorThresholdMs",9E5),Object(Cd.a)(wb.AFrameworkApplication.Ib,wb.AFrameworkApplication.Ib.processAction,"processAction"),qa.instance)},Cb.la)},Cb.la,3);Qa.a.instance.register(650,"Microsoft.Office.Excel.WebUI.Client.ISessionStateManager").as("Common.ICoauthoringTelemeryInfoProvider").Hc().Oc(function(){return ya.ea});
Qa.a.instance.resolve("Common.ICoauthoringTelemeryInfoProvider");Qa.a.instance.register(Xa,"Microsoft.Office.Excel.WebUI.Client.Presence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").Hc().Oc(function(){return new Xa(ya)});Qa.a.instance.resolve("Common.IPeopleInfoProvider")})})();Vb.a.Fa(fh.a.ka);Vb.a.Fa(function(ya){var Cb=ya.da,cc=ub.GetServiceTaskFactory.Va(ya.da,211,212,1);Cb.$a(25,function(Rc){Za.TaskExtensions.Ba(cc,function(yd){Cb.Aa(231)||new E(yd.result,ya,Rc)},Cb.la,3)})});(function(){Vb.a.Fa(function(ya){Za.TaskExtensions.Ba(ub.GetServiceTaskFactory.Va(ya.da,
12,477,0),function(Cb){var cc=new u(ya),Rc=ya.da.Aa(291);cc=Cb.result.g3c(cc,cc,Rc,"collabService");var yd=new v(ya);Rc=Cb.result.g3c(yd,yd,Rc,"persisted");yd=new a(ya);Cb=Cb.result.g3c(yd,yd,null,"updatePresence");ya.da.Ga(292,new c(ya,ya.da.Aa(26),cc,Rc,Cb));we.a.getInstance(ya.da).add(new h(ya));we.a.getInstance(ya.da).add(cc);we.a.getInstance(ya.da).add(Rc)},ya.la)})})()},926:function(x,C,b){function a(){}b.r(C);b.d(C,"RtcUtils",function(){return a});x=b(0);var c=b(14),e=b(1013),f=b(41);a.Z_c=
function(l,m){m=void 0===m?e.RealtimeChannel.$vd:m;try{var r=f.c(l)}catch(h){throw l=String.format("Failed to JSON-serialize payload : {0}",h),c.ULS.sendTraceTag(18637072,500,10,l),Error.argument("payload",l);}if(r.length>m)throw l=String.format("Payload exceeds maximum length: {0} > {1}.",r.length,m),c.ULS.sendTraceTag(18637074,500,10,l),Error.argument("payload",l);return r};a.deserialize=function(l,m,r){if(!l)return null;if(Object.getType(l)!==String){var h=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",
m,Object.getType(l).getName(),r);c.ULS.sendTraceTag(18637075,500,10,h);return null}h=null;try{h=f.a(l)}catch(w){l=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",m,w,r),c.ULS.sendTraceTag(18637077,500,10,l)}return h};a.yOa=function(l){if(!l)return"";if("string"===typeof l)return l.toString();try{return f.c(l)}catch(m){return l.toString()}};a.dyh=function(l){var m;var r=0;var h=m=null;if(!l)return{F8e:r,H8e:m,exception:h};try{var w=l.source;
w&&Object.getType(w)===String&&(h=w);var n=l.context;n&&(l=n,r=l.status?l.status:0,m=l.statusText?l.statusText:null)}catch(v){}return{F8e:r,H8e:m,exception:h}};Object(x.a)(a,"RtcUtils",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.cl.js.map/93b6ba597232501ec1797b79e7c71a69/EwaDS.cl.js.map