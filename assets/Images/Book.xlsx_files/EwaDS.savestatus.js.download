(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[38],{1466:function(x,C,b){function a(aa){var F=U.call(this)||this;F.Tc=aa;F.Tb();return F}function c(aa,F){var D=this;this.Gfe=this.PKc=!1;this.Nya=function(J,R){(null===R||void 0===R?0:R.nH)&&L.a.OKg([R.nH])&&(D.Nuc=!0)};this.Io=function(){D.Nuc=!1};this.od=function(J,R){P.b(R)&&D.yea(!0);D.Nuc=!1};this.zd=function(){D.kR=D.$.kR;D.yea()};this.ABf=function(){D.WS()};this.BAf=function(){D.kR=D.$.kR};this.Fzd=function(){ca.g(D.$).Ea.Dv(D.Fzd);
D.kR=D.$.kR};this.gVf=F;this.$=aa;this.$.userOperationManager.Vu(this.BAf);this.$.nl(this.zd);this.$.ea.xGg(this.ABf);this.$.ea.hk(this.od);this.$.GZb(this.Nya);this.$.ea.mM(this.Io);this.yea()}function e(){this.AQc=this.BPc=this.ylb=this.tb=null}function f(aa,F,D,J){this.cga=this.Xfa=this.gga=this.fga=null;this.cEa=0;this.eE=this.zQc=this.vCa=this.kFc=this.$Ea=null;this.Wd=aa;this.X8=F;this.P1=D;this.lj=J;this.f9d=!0;this.$L=!1;this.mA=3;this.dra=!0}function l(aa,F){this.ls=null;this.fga=CommonUIStrings.l_SavedStatus;
this.gga=CommonUIStrings.l_SavingStatus;this.Xfa=CommonUIStrings.l_ReadOnlyStatus;this.cga=CommonUIStrings.l_ReviewModeStatus;this.cTb=F;this.P1=aa;this.mA=3;this.dra=!0}function m(aa){this.cga=this.Xfa=this.gga=this.fga=null;this.q7d=this.G$d=this.tx=this.$L=!1;this.LPc=this.V$d=null;this.N$d=0;this.vb=this.T$d=null;this.P1=aa;this.mA=3;this.hjb=!0}b.r(C);x=b(0);var r=b(82),h=b(14),w=b(165),n=b(39);m.prototype.initialize=function(aa,F,D){var J=this;this.fga=this.vgd(aa,F);this.gga=CommonUIStrings.l_SavingStatus;
this.Xfa=CommonUIStrings.l_ReadOnlyStatus;this.cga=CommonUIStrings.l_ReviewModeStatus;this.P1&&this.P1.execute(function(R){R.uVc(Object(r.a)(J,J.yOb,"updateToSavingStatus"))});this.tx=!0;this.vb=D;return!0};m.prototype.yea=function(aa,F){this.$L=aa;this.mA=F;this.WS(this.hjb)};m.prototype.WS=function(aa){!this.hjb&&aa&&(this.T$d=new Date);this.hjb=aa;aa=null;3===this.mA&&(aa=this.hjb?this.fga:this.gga);this.Bfh(aa)};m.prototype.vgd=function(aa,F){return aa?String.format(CommonUIStrings.l_SavedToStatus,
CommonUIStrings.l_OneDriveName):F&&F.length?String.format(CommonUIStrings.l_SavedToStatus,F):CommonUIStrings.l_SavedStatus};m.prototype.yOb=function(){this.WS(!1)};m.prototype.fSh=function(){switch(this.mA){case 1:return this.Xfa;case 2:return this.cga;default:return null}};m.prototype.ogi=function(aa){return this.G$d===this.$L&&this.N$d===this.mA&&this.V$d===aa};m.prototype.J6c=function(aa){var F=this;appChrome.getHeaderApi().then(function(D){D.updateDocumentTitleStatus(F.$L,aa,F.fSh(),F.T$d,F.hjb);
F.q7d=!0;return null});this.LPc=null};m.prototype.Bfh=function(aa){var F=this;this.tx&&w.c()&&!this.ogi(aa)&&(!this.q7d&&this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.J6c(aa):n.a.aSf()?(this.LPc&&h.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.LPc=window.requestIdleCallback(function(){F.J6c(aa)})):window.requestAnimationFrame(function(){F.J6c(aa)}),this.G$d=this.$L,this.V$d=aa,this.N$d=
this.mA)};Object(x.a)(m,"ReactSaveStatusUIHandler",null,[594]);var v=b(168);l.prototype.Cv=function(){var aa=this;this.P1&&this.P1.execute(function(F){F.uVc(Object(r.a)(aa,aa.yOb,"updateToSavingStatus"))});this.cTb.execute(function(F){aa.ls=F})};l.prototype.yea=function(aa,F){this.mA=F;3===F?this.WS(this.dra):2===F?this.wXd(this.cga):this.wXd(this.Xfa)};l.prototype.yOb=function(){this.WS(!1)};l.prototype.WS=function(aa){this.dra=aa;this.wXd(this.dra?this.fga:this.gga)};l.prototype.wXd=function(aa){this.ls&&
this.ls.Hj(v.a.sNj,this.r1g(aa))};l.prototype.r1g=function(aa){var F={};F.StatusText=aa;return F};Object(x.a)(l,"SaveStatusPostMessageHandler",null,[594]);var u=b(94),t=b(122),y=b(57);f.prototype.initialize=function(aa,F){if(!this.Wd)return!1;this.fga=this.vgd(aa,F);this.gga=CommonUIStrings.l_SavingStatus;this.Xfa=CommonUIStrings.l_ReadOnlyStatus;this.cga=CommonUIStrings.l_ReviewModeStatus;this.Cv();return!0};f.prototype.vgd=function(aa,F){return aa?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):
F&&F.length?String.format(CommonUIStrings.l_SavedToStatus,F):CommonUIStrings.l_SavedStatus};f.prototype.Cv=function(){var aa=this;this.X8&&this.X8.execute(function(F){F.XFg(Object(r.a)(aa,aa.KEe,"createStatusAndModeElements"));F.OFg(Object(r.a)(aa,aa.szj,"showHideSaveStatusElement"));F.nKj&&aa.KEe(null,null)});this.P1&&this.P1.execute(function(F){F.uVc(Object(r.a)(aa,aa.yOb,"updateToSavingStatus"))})};f.prototype.Tv=function(){this.eE&&this.Wd&&this.Wd.tG(this.eE)};f.prototype.szj=function(aa,F){this.yea("true"===
F,this.mA)};f.prototype.yea=function(aa,F){this.$L=aa;this.mA=F;this.kFc&&(this.kFc.style.display=this.$L||3===this.mA||!this.$Ea?"none":"");this.vCa&&(this.vCa.style.display=this.$L||3===this.mA?"none":"",this.vCa.innerText=1===this.mA?this.Xfa:this.cga,this.vCa.title=1===this.mA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.zQc&&(this.zQc.style.display=this.$L||1===this.mA||!this.$Ea&&!this.vCa?"none":"");this.eE&&(this.eE.style.display=this.$L||1===this.mA?
"none":"",this.WS(this.dra),this.eE.title=CommonUIStrings.l_SaveStatusTooltip)};f.prototype.KEe=function(aa,F){aa=document.getElementById(u.CuiHelper.l7e);F&&F.yWj||!aa||""===this.fga||""===this.gga||""===this.Xfa||""===this.cga||(this.$Ea=document.getElementById(u.CuiHelper.W0b),this.kFc=u.CuiHelper.ita(aa,"BreadcrumbAppModeDash","-",null,!1),this.vCa=u.CuiHelper.ita(aa,"BreadcrumbAppModeStatus",1===this.mA?this.Xfa:this.cga,null,!1),this.rcg(this.vCa),this.zQc=u.CuiHelper.ita(aa,"BreadcrumbSaveStatusDash",
"-",null,!1),this.eE=u.CuiHelper.ita(aa,"BreadcrumbSaveStatus",this.fga,null,!1),this.rcg(this.eE),this.yea(this.$L,this.mA))};f.prototype.yOb=function(){this.WS(!1)};f.prototype.WS=function(aa){this.dra=aa;this.nSj(this.dra?this.fga:this.gga)};f.prototype.nSj=function(aa){!this.eE||3!==this.mA&&2!==this.mA||(this.f9d&&!this.dra?(this.cEa=this.eE.offsetWidth<this.cEa?this.cEa:this.eE.offsetWidth,this.qPj(this.gga),this.f9d=!1):this.eE.innerText=aa)};f.prototype.rcg=function(aa){aa.style.direction=
this.lj?"rtl":"ltr";aa.style.width="auto";aa.style.textAlign=this.lj?"right":"left";aa.style.display=this.$L?"none":"";aa.setAttribute("Unselectable","on")};f.prototype.qPj=function(aa){this.eE&&(this.eE.style.width="",this.eE.innerText=aa,this.cEa=this.eE.offsetWidth<this.cEa?this.cEa:this.eE.offsetWidth,aa=t.a.lB(this.eE),this.eE.style.width=this.cEa-y.a.nD(aa.paddingLeft)-y.a.nD(aa.paddingRight)+1+"px")};Object(x.a)(f,"SaveStatusUIHandler",null,[594]);var E=b(4),B=b(93);e.prototype.ei=function(aa){var F=
this;this.tb=aa;E.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&E.AFrameworkApplication.hideHeaderEmbedded?this.tb.register(l,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Hc().Oc(function(){return new l(F.tb.lc("Common.App.HostNotification.EditNotificationEventSource"),F.tb.lc("Postmessage.IHostPostmessenger"))}):E.AFrameworkApplication.ta.Qa.Tgf||(E.AFrameworkApplication.ta.Qa.isReactSharedHeaderUxEnabled?this.tb.register(m,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Hc().Oc(function(){return new m(F.tb.lc("Common.App.HostNotification.EditNotificationEventSource"))}):
this.tb.register(f,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Hc().Oc(function(){return new f(B.EventHandlerManager.instance,F.tb.lc("Common.App.Header.HeaderEventSource"),F.tb.lc("Common.App.HostNotification.EditNotificationEventSource"),E.AFrameworkApplication.isRtl)}))};e.prototype.init=function(){E.AFrameworkApplication.ga.sv(Object(r.a)(this,this.EB,"onFullAppSettingsReady"))};e.prototype.EB=function(){var aa=E.AFrameworkApplication.ga,F=!!E.AFrameworkApplication.ta.Qa&&
4===E.AFrameworkApplication.ta.Qa.Sj;if(aa.ra("WordEditorAutoSaveImprovementIsEnabled")||aa.ra("PptEditorSaveStatusInHeaderEnabled")||F&&aa.ra("SimplifiedReactRibbonUxIsEnabled")||aa.ra("ExcelSaveStatusInHeaderEnabled")||aa.ra("VisioSaveStatusInHeaderEnabled"))E.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&E.AFrameworkApplication.hideHeaderEmbedded?(this.AQc=this.tb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.AQc.Cv():E.AFrameworkApplication.ta.Qa.Tgf||(E.AFrameworkApplication.ta.Qa.isReactSharedHeaderUxEnabled?
(this.BPc=this.tb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.BPc.initialize(aa.ra("IsSkyDrive"),aa.Ua("HostNameToIncludeInSavedStatus"),E.AFrameworkApplication.ga):(this.ylb=this.tb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.ylb.initialize(aa.ra("IsSkyDrive"),aa.Ua("HostNameToIncludeInSavedStatus")))};e.prototype.dispose=function(){this.ylb&&this.ylb.Tv()};Ek.Object.defineProperties(e.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveStatus"}}});
Object(x.a)(e,"PackageManager",null,[4,5]);C=b(255);var z=b(11),M=b(85),Q=b(228),P=b(231),L=b(30),ca=b(22);c.prototype.dispose=function(){this.$&&(this.$.Sl(this.zd),this.$.Zsc(this.Nya),this.$.userOperationManager&&this.$.userOperationManager.Cr(this.BAf),this.$.ea&&(this.$.ea.fcj(this.ABf),this.$.ea.Dk(this.od),this.$.ea.iS(this.Io)),ca.g(this.$)&&ca.g(this.$).Ea&&ca.g(this.$).Ea.Dv(this.Fzd))};c.prototype.yea=function(aa){aa=!this.$.isEditMode||(void 0===aa?!1:aa);this.gVf.yea(aa,this.$.isEditMode?
3:1);this.WS()};c.prototype.WS=function(){this.$.isEditMode&&this.gVf.WS(!this.kR&&!this.$pi&&!this.Nuc)};Ek.Object.defineProperties(c.prototype,{$pi:{configurable:!0,enumerable:!0,get:function(){return this.$.ea?this.$.ea.ojf:!1}},kR:{configurable:!0,enumerable:!0,get:function(){return this.PKc},set:function(aa){aa?this.PKc=!0:ca.g(this.$)&&ca.g(this.$).Ea&&(ca.g(this.$).Ea.g_()?this.PKc=!1:ca.g(this.$).Ea.Gx(this.Fzd));this.WS()}},Nuc:{configurable:!0,enumerable:!0,get:function(){return this.Gfe},
set:function(aa){this.Gfe=aa;this.WS()}}});Object(x.a)(c,"SaveStatusManager",null,[3]);var U=Q.a;Am(a,U);a.prototype.create=function(){var aa=this,F=M.a.instance;F.lc("Common.App.SaveStatus.ISaveStatusUIHandler").execute(function(D){var J=new c(aa.Tc,D);F.register(c,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").Hc().Oc(function(){return J});aa.Eb(F.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"))})};a.ka=function(aa){aa.da.Ga(299,new a(aa))};Object(x.a)(a,
"SaveStatusFactory",Q.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.SaveStatus");C.a.instance.hj(new e);z.a.Fa(a.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.savestatus.js.map/5a033d10390b327fba7b84dd74ae3ede/EwaDS.savestatus.js.map