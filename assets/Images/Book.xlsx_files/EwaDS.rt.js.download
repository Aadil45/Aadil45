(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1451:function(x,C,b){function a(qc){var md=Wd.call(this)||this;md.Bn=null;md.$t=null;md.SOa=function(){md.Bn.nIb(md.SOa);kb.ULS.sendTraceTag(537162849,0,50,"ExcelLiveManager::OnRealTimeChannelInitialized");md.Eb(md.$.da.Aa(473)||new m(md.$,md.Bn,md.$t))};md.$=qc;md.Tb();return md}function c(qc){var md=we.call(this)||this;md.fw=null;md.eJa=null;md.dJa=null;md.wAb=!1;md.pMa=null;md.vkc="ExcelLiveController::";md.$=qc;md.wAb=
rc.g(md.$);md.n$h();return md}function e(qc,md){md=void 0===md?null:md;this.container=null;this.Tm=0;this.GPa=null;this.Wg=!1;md&&(this.$=qc,this.initialize(md),this.Wg=Ra.AFrameworkApplication.ta.Qa.Wg)}function f(qc,md){var bd=this;md=void 0===md?null:md;this.uoa=null;this.LWd=this.HTe=!0;this.container=null;this.Tm=0;this.GPa=this.kza=null;this.lastUpdateTime=0;this.$=null;this.g4h=function(){bd.LWd||(bd.EQf(),bd.LWd=!0,bd.container.classList.remove("ewa-excelLive-meetingPill-container-hidden"))};
md&&this.initialize(qc,md);this.$=qc}function l(qc){this.Vde=this.Ude=this.Tde=null;this.mde=void 0;this.$=qc}function m(qc,md,bd){this.Spa=this.pib=this.Vkb=this.Fib=null;this.$=qc;this.zee=md;this.$n=new r(this.$,bd);this.i2=Object(wc.a)(309,this.Bn.Fj);rc.g(this.$)&&(this.Yc=this.Yc.bind(this),this.goc=this.goc.bind(this),this.i2.HFa(this.goc),this.$.Zk(this.Yc));this.Spa=bd;this.Z8h()}function r(qc,md){this.Pvd=this.YTf=0;this.zjd=!1;this.Pvd=jb.HelperMethods.$b();this.$=qc;this.$t=md;this.fMd=
new Map;this.hJb=new Map;this.wuc=new Map;this.fUf=this.TZj}function h(qc,md,bd){this.controller=this.N_=null;this.$Bi=1E4;this.JCb=0;this.$=qc;this.gridView=ic.g(this.$);this.$n=new w(this.$);this.realtimeChannel=md;this.controller=bd;this.Tob();this.Doj();this.iEj()}function w(qc){this.Frb=this.kRa=this.QHf=0;this.Nad=Number.MAX_SAFE_INTEGER;this.SAb=Number.MIN_SAFE_INTEGER;this.JCb=0;this.$=qc;this.QHf=jb.HelperMethods.$b();this.GVd=new M}function n(qc,md,bd){this.vkc="ExcelLiveParticipantV0";
this.viewBlockContainerHelpers=this.YOb=this.N6=null;this.uod=this.HMa=!1;this.C2a=0;this.lSe=10;this.mSe=500;this.nSe=3E4;this.Xka=0;this.$t=bd;this.realtimeChannel=md;this.$=qc;this.gridView=ic.g(qc);this.tdc=this.tdc.bind(this);this.bma=this.bma.bind(this);this.lSe=this.$.ya.FetchPresenterNavigationStateMaxRetries;this.mSe=this.$.ya.FetchPresenterNavigationStateRetryBaseInMs;this.nSe=this.$.ya.FetchPresenterNavigationStateRetryMaxDelayInMs;this.initialize()}function v(qc,md,bd){this.statusBarManager=
null;this.laa=new t;this.ssd=this.EGb=null;this.DZ=this.FGb=0;this.hSe=10;this.iSe=1E3;this.jSe=3E4;this.h_d=.98;this.twa=this.W5a=this.qgc=this.Syb=this.dod=this.Tyb=this.UMa=this.tod=!1;this.Rsd=null;this.Fwa=this.ypd=!1;var Xc=jb.HelperMethods.$b();this.controller=bd;this.realtimeChannel=md;this.$=qc;this.gridView=ic.g(qc);this.$n=new B(this.$,Xc,3);this.statusBarManager=new y(this.$,this.laa);this.h_d=this.$.ya.ExcelLiveViewportRoundOffFactor;this.hSe=this.$.ya.FetchPresenterNavigationStateMaxRetries;
this.iSe=this.$.ya.FetchPresenterNavigationStateRetryBaseInMs;this.jSe=this.$.ya.FetchPresenterNavigationStateRetryMaxDelayInMs;this.Fwa=Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6175128_ExcelLiveExploreTransitionsFix");this.Tob();this.GLg();this.wzc()}function u(qc){qc=qc.endsWith("_Vacs")?qc.split("_",1)[0]:qc;return!ub.has(qc)}function t(){return Mb.call(this)||this}function y(qc,md){var bd=ib.call(this)||this;bd.statusBarManager=null;bd.G5b=2;bd.Aqc=null;bd.NDf=function(Xc,ne){bd.G5b=ne.G5b;
bd.Aqc=ne.Aqc;bd.Oz()};bd.$=qc;bd.$.da.$a(29,function(Xc){bd.statusBarManager=Xc;Xc.yJ(bd)});bd.laa=md;bd.laa.eHg(bd.NDf);return bd}function E(qc,md){var bd=Oa.call(this)||this;bd.G5b=qc;bd.Aqc=md;return bd}function B(qc,md,bd){this.IRe=this.bsf=this.asf=this.sbd=this.uUe=this.rfg=this.YCc=this.G$c=this.HRe=this.QFb=0;this.Bjc=void 0;this.Mqc=this.qjc=this.hjf=this.c$b=this.Qad=this.xGb=this.rlc=this.U_d=this.SUd=0;this.$=qc;this.QFb=md;this.muc=new Map;this.muc[sa[bd]]=1;this.$Ha=bd;this.Mqc=md;
this.XLd=new Map;this.nuc=new Map;this.Hpf=new M}function z(qc,md){kb.ULS.sendTraceTag(523015437,0,50,md+" = "+qc)}function M(){this.average=0;this.max=Number.MIN_SAFE_INTEGER;this.min=Number.MAX_SAFE_INTEGER;this.Irc=this.last=0}function Q(qc,md){qc=document.getElementById(qc.Mb+Xb.a.c1a);return{bPb:qc.clientWidth/md,ZOb:qc.clientHeight/md}}function P(qc){return Ja.call(this,qc)||this}function L(qc,md){this.$=qc;this.excelLiveManager=md}function ca(){this.tb=null}function U(qc){this.wvg=qc}function aa(qc){this.bqg=
qc}function F(){}function D(){}function J(){}function R(){}function Z(qc,md,bd,Xc){Xc=void 0===Xc?null:Xc;this.am=new Sb.a;this.btg=qc;this.Urg=md;this.vb=bd;this.Nib=Xc}function W(){}function ka(){}function ma(){}function pa(qc,md){this.La=qc;this.JWa=md}function xa(){this.tx=this.Am=!1}function va(qc,md,bd,Xc,ne,ed,nd,Ub,Hc){var pd=this;this.Am=!1;this.yWb=this.jXa=this.JP=this.bga=null;this.Xlb=va.qEc;this.Za=new Ha.a;this.pra=new ta(0);this.pra.NVc(Object(lb.a)(this,this.URi,"onStateMachineChanged"));
this.bvg=qc;this.fWb=md;this.$ug=bd;this.oQc=Xc;this.se=ne;this.RT=ed;nd.execute(function(jc){pd.Am||(pd.jXa=jc,pd.jXa.NYa(Object(lb.a)(pd,pd.Cca,"onUpdateNotificationReceived")),pd.start())});Ub.execute(function(jc){pd.Am||(pd.yWb=jc,jc.FZb(Object(lb.a)(pd,pd.oDf,"onTokenRefreshed")))});this.iie=Hc}function ta(qc){this.Za=new Ha.a;this.mhe=new Date;this.Khb=qc;this.jIc=0}function fa(qc,md,bd,Xc,ne){var ed=Xa.call(this)||this;ed.jFd=qc;ed.newState=md;ed.T_i=bd;ed.U_i=Xc;ed.K_j=ne;return ed}function Ca(qc,
md){var bd=Nb.call(this)||this;bd.g_j=qc;bd.ZZj=md;return bd}b.r(C);var Sa=b(557),Gb=b(0),kb=b(14),lb=b(82),Nb=Sys.EventArgs;Am(Ca,Nb);Object(Gb.a)(Ca,"RtcHostNotificationEventArgs",Sys.EventArgs,[]);var Aa;(function(qc){qc[qc.notYetStarted=0]="notYetStarted";qc[qc.polling=1]="polling";qc[qc.subscribed=2]="subscribed";qc[qc.blocked=3]="blocked";qc[qc.permanentlyStopped=4]="permanentlyStopped"})(Aa||(Aa={}));Object(Gb.b)("RtcHostNotificationSubscriptionState",Aa);var qa=b(108),Xa=Sys.EventArgs;Am(fa,
Xa);Object(Gb.a)(fa,"StateChangedEventArgs",Sys.EventArgs,[]);var Ha=b(97);ta.prototype.event=function(qc,md){this.currentState!==qc&&(this.ABh(this.currentState,qc,this.iMe,void 0===md?null:md),this.jIc=0,this.mhe=new Date);this.Khb=qc;this.jIc=this.iMe+1};ta.prototype.ABh=function(qc,md,bd,Xc){qc=new fa(qc,md,bd,this.mhe,Xc);this.Za.raiseEvent("c",qc)};ta.prototype.NVc=function(qc){this.Za.addHandler("c",qc)};ta.prototype.pQf=function(qc){this.Za.removeHandler("c",qc)};Ek.Object.defineProperties(ta.prototype,
{currentState:{configurable:!0,enumerable:!0,get:function(){return this.Khb}},iMe:{configurable:!0,enumerable:!0,get:function(){return this.jIc}}});Object(Gb.a)(ta,"StateMachine",null,[249]);va.prototype.start=function(){0!==this.Vdb?kb.ULS.sendTraceTag(573100178,502,15,"HostNotifications: Tried starting poll when in state {0}",Aa[this.Vdb]):(this.pra.event(1),this.PNd(null))};va.prototype.PNd=function(){this.bga=null;if(this.tgf){kb.ULS.sendTraceTag(573100181,502,50,"HostNotifications: Send event when connected.  Current state: {0}",
Aa[this.Vdb]);var qc=null;this.oQc&&this.oQc.length&&(qc={},qc.etts=this.oQc);this.jXa.Jda(14,qc,!0);this.JVf(this.bvg)}else this.pra.event(3)};va.prototype.JVf=function(qc){this.bga=qa.a.N4b(1E3*qc,Object(lb.a)(this,this.PNd,"sendSubscribeEvent"),this.fWb,192,"RtcHostNotificationSubscribe");this.se.Sg(this.bga)};va.prototype.Vjj=function(qc){qc=1E3*(qc+this.$ug);var md=this.iie().getTime()+qc;this.Xlb=new Date(md);qc-=this.fWb;this.JP?this.se.Wma(this.JP,qc):(this.JP=qa.a.N4b(qc,Object(lb.a)(this,
this.YKj,"transitionToPollingEvent"),this.fWb/2,194,"RtcHostNotificationTransitionToPolling"),this.se.Sg(this.JP))};va.prototype.YKj=function(){this.JP=null;2===this.Vdb&&(this.pra.event(1),kb.ULS.shipAssertTag(573100185,502,!!this.bga,"Missing task to ensure that we re-subscribe."))};va.prototype.oDf=function(){this.I1h()};va.prototype.I1h=function(){3===this.Vdb&&this.tgf&&(this.pra.event(this.H5?2:1),this.PNd(null))};va.prototype.Cca=function(qc,md){if(13===md.type&&(qc=md.g8,md={},kb.ULS.sendTraceTag(573100183,
502,50,"HostNotifications: Subscription status: {0}",(md.SerializableHostNotificationSubscription=qc,md.DurationBeforeExpirationToResubscribeInSec=this.fWb,md)),md=qc.cts,!this.VMj(md))){if(qc.sb){var bd=2;this.Vjj(qc.cts)}else bd=1,this.Xlb=va.qEc,this.JP&&(this.se.$p(this.JP),this.JP=null);this.pra.event(bd);this.bga?this.se.Wma(this.bga,1E3*md):this.JVf(md)}};va.prototype.VMj=function(qc){if(!isNaN(qc)&&isFinite(qc)&&0<qc)return!1;this.d6f(!1);return!0};va.prototype.d6f=function(qc){this.bga&&
(this.se.$p(this.bga),this.bga=null);this.JP&&(this.se.$p(this.JP),this.JP=null);this.jXa&&(this.jXa.rIb(Object(lb.a)(this,this.Cca,"onUpdateNotificationReceived")),this.jXa=null);this.yWb&&(this.yWb.vJd(Object(lb.a)(this,this.oDf,"onTokenRefreshed")),this.yWb=null);qc||this.pra.event(4)};va.prototype.URi=function(qc,md){qc=md.newState;var bd=md.jFd,Xc={};Xc.NewState=Aa[qc];Xc.PreviousState=Aa[bd];Xc.PreviousStateHits=md.T_i;Xc.PreviousStateTransitionTime=md.U_i.toISOString();Xc.IsSubscribed=this.H5;
this.Xlb!==va.qEc&&(Xc.SubscriptionExpiringTime=this.Xlb.toISOString());kb.ULS.sendTraceTag(572346515,502,4===qc?15:50,"HostNotificationChanged: {0}",Xc);this.Za.raiseEvent("HN",new Ca(bd,qc))};va.prototype.dispose=function(){this.Am||(this.Am=!0,this.d6f(!0),this.JP&&(this.se.$p(this.JP),this.JP=null))};Ek.Object.defineProperties(va.prototype,{Vdb:{configurable:!0,enumerable:!0,get:function(){return this.pra.currentState}},tgf:{configurable:!0,enumerable:!0,get:function(){return!this.RT||this.RT.Fhf}},
H5:{configurable:!0,enumerable:!0,get:function(){return 2===this.Vdb&&this.iie()<this.Xlb}}});va.qEc=new Date(0);Object(Gb.a)(va,"RtcHostNotificationSubscriptionManager",null,[907,3]);var Ra=b(4),mb=b(255),La=b(740),ha=b(85);xa.prototype.ei=function(qc){var md=this;qc.register(va,"Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").as("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager").Hc().Oc(function(){var bd=Ra.AFrameworkApplication.ga;
return new va(bd.Dd("RtcHostNotificationRetryIntervalIdeallyInSeconds",1800),bd.Dd("RtcHostNotificationRetryIntervalBufferInSeconds",120),bd.Dd("RtcHostNotificationSubscriptionLostBufferInSeconds",60),md.zWh(bd),Ra.AFrameworkApplication.Qi,La.SessionStatusManager.instance,qc.lc("Common.IRealtimeChannelBasic"),qc.lc("Common.ISessionExpirationManager"),function(){return new Date})})};xa.prototype.init=function(){var qc=this;Ra.AFrameworkApplication.ga.sv(function(){!qc.Am&&Ra.AFrameworkApplication.ga.ra("RtcHostNotificationEnabled")&&
(qc.tx=!0,ha.a.instance.resolve("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager"))})};xa.prototype.dispose=function(){this.Am||(this.Am=!0,this.tx&&ha.a.instance.resolve("Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").dispose())};xa.prototype.zWh=function(qc){return qc.mz("RtcEventTypesToSubscribe")?qc.Iw("RtcEventTypesToSubscribe"):null};xa.main=function(){mb.a.instance.hj(new xa)};Ek.Object.defineProperties(xa.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return"RtcHostNotificationSubscription"}}});Object(Gb.a)(xa,"RtcHostNotificationSubscriptionPackage",null,[4,5]);var Ia=b(107),gb=b(27);pa.prototype.Qg=function(){this.La.fc(gb.a.okf,Ia.a.frame,Object(lb.a)(this,this.pkf,"livePersonaCardActionHandler"))};pa.prototype.WNb=function(){this.La.yD(gb.a.okf,Ia.a.frame,Object(lb.a)(this,this.pkf,"livePersonaCardActionHandler"))};pa.prototype.pkf=function(qc,md,bd,Xc,ne){if(!ne||3===bd)return 2;if(1===bd)return this.kYa(this.JWa.awe(ne.upn||
ne.aadObjectId));if(!this.glh(ne))return 8;switch(ne.action){case 0:return this.kYa(this.JWa.gAg(ne));case 1:return this.kYa(this.JWa.fAg(ne));case 2:return this.kYa(this.JWa.hAg(ne));case 3:return this.kYa(this.JWa.openCard(ne));case 4:return this.kYa(this.JWa.r9i(ne));default:return 2}};pa.prototype.glh=function(qc){var md=qc.upn||qc.aadObjectId;return qc.targetElement&&(4===qc.action||md&&""!==md)?!0:!1};pa.prototype.kYa=function(qc){return qc?32:8};Object(Gb.a)(pa,"LivePersonaCardActor",null,
[]);var Sb=b(161),wc=b(83);Object(Gb.a)(ma,"BootstrapperConfig",null,[]);Object(Gb.a)(ka,"LivePersonaCardInitializerResult",null,[]);W.Ote=null;Object(Gb.a)(W,"LivePersonaCardModule",null,[]);var tc=b(620);Z.prototype.init=function(){this.eef()?this.btg.rsi().continueWith(Object(lb.a)(this,this.QOi,"onPackageLoaded")):this.am.setResult(Object.assign(new ka,{isInitialized:!1,isEnabled:!1,failureMessage:"LivePersonaCard is not enabled."}));return this.am.task};Z.prototype.QOi=function(){var qc=this,
md=W.Ote;if(md){var bd=this.kJh();try{md.initializeLivePersonaCardAsync(bd).then(function(){qc.am.setResult(Object.assign(new ka,{isInitialized:!0,isEnabled:!0}))}).catch(function(Xc){var ne=Object(wc.a)(String,Xc);ne?qc.am.setException(Error.create(ne)):qc.am.setException(Error.create(JSON.stringify(Xc)))})}catch(Xc){this.am.setException(Xc)}}else this.am.setResult(Object.assign(new ka,{isInitialized:!1,isEnabled:!0,failureMessage:"LivePersonaCardBootstrapper package is not loaded."}))};Z.prototype.kJh=
function(){var qc=tc.a.wH(Ra.AFrameworkApplication.lcid);return Object.assign(new ma,{culture:qc?qc.name.toLocaleLowerCase():"en-us",clientType:this.vb.Ua("LivePersonaCardClientType"),clientContextType:"Generic",clientCorrelationId:Ra.AFrameworkApplication.userSessionId,complianceEnvironment:this.jLh(),logMessage:Object(lb.a)(this,this.logMessage,"logMessage"),getAuthToken:Object(lb.a)(this,this.getAuthToken,"getAuthToken")})};Z.prototype.eef=function(){if(!this.vb.ra("LivePersonaCardIsEnabled")||
!this.gJg())return!1;var qc=this.vb.Ua("SovereignEnvironmentName");return qc&&""!==qc?qc.toLocaleLowerCase()==="USGov".toLocaleLowerCase()||qc.toLocaleLowerCase()==="Blackforest".toLocaleLowerCase()?!0:!1:!0};Z.prototype.gJg=function(){return this.vb.ra("CoauthorGalleryLivePersonaCardIsEnabled")||!!Ra.AFrameworkApplication.ta&&Ra.AFrameworkApplication.ta.Qa.WRa};Z.prototype.jLh=function(){return this.vb.Ua("LivePersonaCardComplianceEnvironment")};Z.prototype.logMessage=function(qc,md,bd){var Xc={};
qc=JSON.stringify((Xc["Log Type"]=qc,Xc["Log Result Type"]=md,Xc.Message=bd,Xc));kb.ULS.sendTraceTag(50431106,3006,50,qc)};Z.prototype.getAuthToken=function(qc,md){var bd=this;Ra.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?this.Nib.continueWith(function(Xc){Xc.Oh||Xc.ig?md("LokiTokenManagerTask is either canceled or faulted.",Ra.AFrameworkApplication.userSessionId):bd.Nib.result.nfd().then(function(ne){ne.isSuccess&&ne.token&&ne.token.length?
qc(ne.token,Ra.AFrameworkApplication.userSessionId):md(ne.errorMessage,Ra.AFrameworkApplication.userSessionId)}).catch(function(ne){return kb.ULS.sendTraceTag(539617039,3006,10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(ne))})}):this.Urg.nfd().then(function(Xc){Xc.isSuccess&&Xc.token&&Xc.token.length?qc(Xc.token,Ra.AFrameworkApplication.userSessionId):md(Xc.errorMessage,Ra.AFrameworkApplication.userSessionId)}).catch(function(Xc){return kb.ULS.sendTraceTag(50431107,3006,
10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(Xc))})};Object(Gb.a)(Z,"LivePersonaCardInitializer",null,[]);Object(Gb.a)(R,"Behavior",null,[]);Object(Gb.a)(J,"Identifiers",null,[]);Object(Gb.a)(D,"LivePersonaCardParameters",null,[]);Object(Gb.a)(F,"PersonaInfo",null,[]);aa.prototype.awe=function(qc){return this.bqg.eef()&&qc&&""!==qc?!!window.self.LPC:!1};aa.prototype.gAg=function(qc){return this.MNb("addedPersonaToPageV2",qc,0)};aa.prototype.fAg=function(qc){return this.MNb("addedPersonaToPageV2",
qc,1)};aa.prototype.hAg=function(qc){return this.MNb("addedPersonaToPageV2",qc,2)};aa.prototype.openCard=function(qc){return this.MNb("openCard",qc)};aa.prototype.r9i=function(qc){return this.MNb("removedPersonaFromPage",qc)};aa.prototype.RTg=function(qc){return!!qc.targetElement&&(this.awe(qc.upn||qc.aadObjectId)||4===qc.action)};aa.prototype.MNb=function(qc,md,bd){bd=void 0===bd?3:bd;if(!this.RTg(md))return!1;bd=4!==md.action?this.f7g(md,bd):null;var Xc=window.self.LPC;if(Xc&&Xc[qc]){if(bd)Xc[qc](md.targetElement,
bd);else Xc[qc](md.targetElement);return!0}return!1};aa.prototype.f7g=function(qc,md){md=void 0===md?3:md;var bd=Object.assign(new J,{PersonaType:"User",Upn:qc.upn,AadObjectId:qc.aadObjectId});return Object.assign(new D,{personaInfo:Object.assign(new F,{identifiers:bd,displayName:qc.name,personaCoinColor:qc.color}),behavior:Object.assign(new R,{onCardOpen:function(){kb.ULS.sendTraceTag(595067869,3006,100,"LivePersonaCard opened");if(qc.onCardOpen)qc.onCardOpen()},onCardClose:qc.onCardClose,disableClick:2===
md||3===md,disableHover:0===md||3===md})})};Object(Gb.a)(aa,"LivePersonaCardManager",null,[]);U.prototype.rsi=function(){var qc=Ra.AFrameworkApplication.tO("midgardbootstrapper.js",5);return this.wvg.Ktd(qc).continueWith(function(){W.Ote=window.self.MidgardBootstrapper})};Object(Gb.a)(U,"LivePersonaCardPackageLoader",null,[906]);var Tb=b(566);ca.prototype.init=function(){Ra.AFrameworkApplication.ga&&Ra.AFrameworkApplication.ga.sv(Object(lb.a)(this,this.EB,"onFullAppSettingsReady"))};ca.prototype.dispose=
function(){};ca.prototype.ei=function(qc){this.tb=qc};ca.prototype.EB=function(){var qc=Ra.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?new Z(new U(this.tb.resolve("Common.ISharedDependencyLoader")),null,Ra.AFrameworkApplication.ga,Tb.a.ar(this.tb.lc("Common.ILokiTokenManager"))):new Z(new U(this.tb.resolve("Common.ISharedDependencyLoader")),this.tb.resolve("Common.ILokiTokenManager"),Ra.AFrameworkApplication.ga);qc.init().continueWith(function(md){md.ig&&
md.exception?kb.ULS.sendTraceTag(50431108,3006,15,"Failed to initialize LivePersonaCard, exception: [{0}]",md.exception.message):((md=md.result)||kb.ULS.sendTraceTag(595067868,3006,15,"LivePersonaCardInitializer did not return a result"),md.isInitialized?kb.ULS.sendTraceTag(50431109,3006,100,"Successfully initialized LivePersonaCard"):kb.ULS.sendTraceTag(595067867,3006,md.isEnabled?15:100,"Failed to initialize LivePersonaCard, failure message: [{0}]",md.failureMessage))});(new pa(Ra.AFrameworkApplication.Ib,
new aa(qc))).Qg()};ca.main=function(){mb.a.instance.hj(new ca)};Ek.Object.defineProperties(ca.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.LivePersonaCard"}}});Object(Gb.a)(ca,"LivePersonaCardPackage",null,[4,5]);var pb=b(11),cb=b(906),ob=b(36),rc=b(162),Db=b(186);L.prototype.Zc=function(){return!1};L.prototype.Lc=function(qc,md){switch(md.command){case 1491932557:return rc.g(this.$)&&2===this.excelLiveManager.$ya.Tm;case -440259636:return rc.f(this.$)&&2===this.excelLiveManager.$ya.Tm;
default:return!1}};L.prototype.executeCommand=function(qc,md){qc=ob.TaskExtensions.hl();var bd=md.command;switch(md.command){case -440259636:this.excelLiveManager.Ohd();break;case 1491932557:this.excelLiveManager.UUd();break;default:qc=Db.a(bd)}return qc};L.prototype.jd=function(){return!1};Object(Gb.a)(L,"ExcelLiveCommandHandler",null,[429]);var Ja=cb.a;Am(P,Ja);P.prototype.Nd=function(){var qc=this;this.$.da.$a(473,function(md){qc.Cd([new L(qc.$,md)])})};P.ka=function(qc){cb.a.fe(469,new P(qc))};
Object(Gb.a)(P,"ExcelLiveCommandHandlerFactory",cb.a,[]);var Qb=b(228),yc=b(9),Cd=b(48),bc=b(25),Kb=b(46),ic=b(22),wb=b(237),Wa=b(33),Xb=b(5),Gc=b(128),zb=b(47),hc=b(277),Uc=b(700),jb=b(10),$a;(function(qc){qc[qc.complete=0]="complete";qc[qc.nonComplete=1]="nonComplete";qc[qc.unknown=2]="unknown"})($a||($a={}));Object(Gb.b)("FollowerViewState",$a);var I;(function(qc){qc[qc.none=0]="none";qc[qc.selection=1]="selection";qc[qc.scroll=2]="scroll";qc[qc.zoom=4]="zoom";qc[qc.default=0]="default"})(I||(I=
{}));Object(Gb.b)("UpdateType",I);var ba=b(56),sa;(function(qc){qc[qc.presenter=0]="presenter";qc[qc.follower=1]="follower";qc[qc.explorer=2]="explorer";qc[qc.unknown=3]="unknown"})(sa||(sa={}));Object(Gb.b)("ParticipantRole",sa);M.prototype.T2=function(qc){this.min=qc<this.min?qc:this.min;this.max=qc>this.max?qc:this.max;++this.Irc;this.average=(qc+this.average*(this.Irc-1))/this.Irc;this.last=qc};M.prototype.toString=function(){return"{average: "+this.average+", min: "+this.min+", max: "+this.max+
", last: "+this.last+", recordsCount: "+this.Irc+"}"};Object(Gb.a)(M,"Aggregates",null,[]);B.prototype.dispose=function(){this.$=null};B.prototype.qkc=function(){var qc=jb.HelperMethods.$b(),md={};md.FollowerViewState=0<this.sbd?"Hybrid":$a[this.Bjc];md.FollowerViewStateTransitions=this.sbd;md.FollowerZoomInOppositeDirectionCount=this.uUe;md.ExplorerConsumptionTrends=0<this.IRe?"WorkbookEdited":"WorkbookViewed";md.ExplorerNSVModeTrends=this.asf;md.ExplorerNSVSwitchTrends=this.bsf;md.ViewportChangesInNonCompleteViewCount=
this.rfg;md.ParticipantSessionInitTimestamp=this.QFb;md.FirstMessageIdReceived=this.Qad;md.LastMessageIdReceived=this.hjf;md.FirstMessageReceivedTimestamp=this.c$b;md.LastMessageReceivedTimestamp=this.qjc;md.TimeSinceLastMessageReceivedInMs=qc-this.qjc;md.TotalMessagesReceived=this.rlc;md.MessagesReceptionLatencyAggregates=this.Hpf;md.PresenterIdentifiedTimestamp=this.xGb;md.PresenterID=this.PHf;md.TimeToIdentifyPresenterFromCreationInMs=this.xGb-this.QFb;md.CurrentRole=this.$Ha;md.TimeInCurrentRole=
qc-this.Mqc;md.PreviousRole=this.S_i;md.RoleSwitchCounts=this.muc;md.RoleSwitchDurationsInMs=this.XLd;md.RoleSwitchDurationsTrackerAggregates=this.nuc;qc=ba.a.Kc(md);this.$.sendBeaconTraceTag(523015447,50,!1,"ExcelLiveFollowerOrExplorer.logSessionTelemetry: "+qc)};B.prototype.tud=function(){2E3>jb.HelperMethods.$b()-this.YCc&&(++this.rfg,z(jb.HelperMethods.$b()-this.YCc,"ExcelLiveFollowerOrExplorer.logNonCompleteViewStateTelemetry: TimeElapsedSinceLastViewportChange"),this.YCc=0)};B.prototype.CKj=
function(qc,md){this.Bjc&&qc!==this.Bjc&&++this.sbd;this.Bjc=qc;z(jb.HelperMethods.$b()-md,"ExcelLiveFollowerOrExplorer.trackAndLogFollowerViewStateTransitions: TimeTakenToSyncFollowerViewport")};B.prototype.HKj=function(qc){qc=jb.HelperMethods.$b()-qc;kb.ULS.sendTraceTag(523015446,0,50,"ExcelLiveFollowerOrExplorer.trackAndLogTimeToProcessReceivedMessage: Total time to process received message: ["+qc+"]ms with current role: ["+this.$Ha+"]")};B.prototype.IKj=function(qc){kb.ULS.sendTraceTag(523015445,
0,50,"ExcelLiveFollowerOrExplorer.trackAndLogTotalTimeToSyncFollowerViewport: Total time to sync: ["+(Date.now()-qc)+"]ms with current role: ["+this.$Ha+"]")};B.prototype.BKj=function(qc){this.G$c=jb.HelperMethods.$b();++this.HRe;1===this.HRe&&z(jb.HelperMethods.$b()-this.QFb,"ExcelLiveFollowerOrExplorer.trackAndLogExplorerTransitions: TimeToFirstExplorerTransition");kb.ULS.sendTraceTag(523015444,0,50,"ExcelLiveFollowerOrExplorer.trackAndLogExplorerTransitions: Last Update Type from Presenter Was = {0}. Current View State = {1}",
I[qc],ic.g(this.$).Lac().pB(!0))};B.prototype.DKj=function(){Wa.a(this.$);var qc=jb.HelperMethods.$b()-this.U_d;1E4>qc&&(z(qc,"ExcelLiveFollowerOrExplorer.trackAndLogFollowerZoomTrends: TimeToZoomChangeInOppositeDirection"),this.U_d=0);this.KKj()};B.prototype.KKj=function(){jb.HelperMethods.$b()<this.QFb+12E4&&++this.uUe};B.prototype.Nvi=function(){var qc=jb.HelperMethods.$b()-this.G$c;5E3>qc&&z(qc,"ExcelLiveFollowerOrExplorer.logSyncBackToPresenterTelemetry: TimeElapsedToSyncBackSinceBecomingExplorer");
this.G$c=0};B.prototype.Mvi=function(qc,md,bd){qc=void 0===qc?!1:qc;z(jb.HelperMethods.$b()-this.SUd,"ExcelLiveFollowerOrExplorer.logSyncBackToPresenterTelemetry: Synced via Presence Notification = "+qc+", IsSyncBack = "+md+", Retries = "+bd+" TimeElapsedInSyncingExplorerBackToPresenter");this.SUd=0};B.prototype.LKj=function(qc){typeof qc===typeof Uc.a?++this.asf:++this.bsf};B.prototype.OKj=function(){this.SUd=jb.HelperMethods.$b()};B.prototype.PKj=function(){this.YCc=jb.HelperMethods.$b()};B.prototype.QKj=
function(){this.U_d=jb.HelperMethods.$b()};B.prototype.JKj=function(){++this.IRe};B.prototype.FKj=function(qc,md){var bd,Xc=jb.HelperMethods.$b(),ne=Date.now();0===this.Qad&&(this.Qad=qc,this.c$b=Xc);this.hjf=qc;++this.rlc;md=ne-md;1<this.rlc&&this.Hpf.T2(md);ne=Xc-(null!==(bd=this.qjc)&&void 0!==bd?bd:this.c$b);this.qjc=Xc;kb.ULS.sendTraceTag(523015443,0,50,"ExcelLiveFollowerOrExplorer.trackAndLogMessageReceived: Received message number ["+this.rlc+"] MessageID: ["+qc+"] Time since last message: ["+
ne+"]ms with reception latency: ["+md+"]ms")};B.prototype.cvi=function(qc){this.xGb=jb.HelperMethods.$b();this.PHf=qc;kb.ULS.sendTraceTag(523015442,0,50,"ExcelLiveFollowerOrExplorer.logPresenterIdentified: Presenter identified at ["+this.xGb+"] after ["+(this.xGb-this.c$b)+"]ms since first valid message with clientId=["+this.PHf+"]")};B.prototype.NKj=function(qc){var md,bd;if(this.$Ha!==qc){3===qc&&this.qkc();var Xc=jb.HelperMethods.$b(),ne=sa[this.$Ha],ed=sa[qc];this.muc[ed]=1+(null!==(md=this.muc[ed])&&
void 0!==md?md:0);md=Xc-this.Mqc;this.XLd[ne]=md+(null!==(bd=this.XLd[ne])&&void 0!==bd?bd:0);this.nuc.has(ne)||(this.nuc[ne]=new M);this.nuc[ne].T2(md);this.Mqc=Xc;this.S_i=this.$Ha;this.$Ha=qc}};Object(Gb.a)(B,"ExcelLiveFollowerOrExplorerTelemetryHelper",null,[3]);var Oa=Sys.EventArgs;Am(E,Oa);Object(Gb.a)(E,"ExcelLiveViewStateChangedArgs",Sys.EventArgs,[]);var qb=b(38),Qa=b(1),ib=qb.a;Am(y,ib);y.prototype.Aq=function(qc){this.addHandler("followerViewStateInfoChanged",qc)};y.prototype.Wq=function(qc){this.removeHandler("followerViewStateInfoChanged",
qc)};y.prototype.Oz=function(){this.vn("QueryExcelLiveViewState")&&this.raiseEvent("followerViewStateInfoChanged")};y.prototype.es=function(qc,md){return"QueryExcelLiveViewState"!==qc?!1:this.p3h(md)};y.prototype.vn=function(){return Object(rc.g)(this.$)&&Qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowExcelLiveViewStateInStatusBar",!1)};y.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.SF(this),this.statusBarManager=null);this.laa.Gcj(this.NDf);this.$=
this.laa=null;ib.prototype.dispose.call(this)};y.prototype.p3h=function(qc){if(!this.$)return!1;qc.Value=String.format("View State: {0} | Presenter Visible Range: {1}",$a[this.G5b],this.Aqc);return!0};Object(Gb.a)(y,"ExcelLiveStatusBarManager",qb.a,[3,483,271]);var Mb=qb.a;Am(t,Mb);t.prototype.eHg=function(qc){this.addHandler("FollowerViewStateChanged",qc)};t.prototype.Gcj=function(qc){this.removeHandler("FollowerViewStateChanged",qc)};t.prototype.R2i=function(qc){this.raiseEvent("FollowerViewStateChanged",
qc)};Object(Gb.a)(t,"ExcelLiveFollowerOrExplorerEventManager",qb.a,[]);var Jb=b(79),Zb=b(105),ub=new Set([Zb.a.Bgg,Zb.a.are,Zb.a.A7f,Zb.a.B7f,Zb.a.C4e,Zb.a.Zhd]);v.prototype.dispose=function(){this.Cdh();2!==this.controller.Tm&&(this.oHe(),this.isb());this.gridView=this.$=this.controller=this.realtimeChannel=this.ssd=this.Vsd=this.c8a=this.Rsd=this.EGb=null};v.prototype.UUd=function(){this.$n.OKj();this.wzc(!0)};v.prototype.wzc=function(qc,md){var bd=this;qc=void 0===qc?!1:qc;md=void 0===md?null:
md;var Xc;qc&&this.$n.Nvi();if(md)this.PMb(md)||this.twa?this.Zld(qc):kb.ULS.sendTraceTag(527496925,0,15,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Could not sync to presenter from presence update"),this.DZ=0;else if(++this.DZ,this.DZ>this.hSe)kb.ULS.sendTraceTag(527496924,0,10,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Presenter Nav State not available after "+(this.DZ-1)+" retries."),this.tod=!0,this.DZ=0;else{if(1===this.DZ){var ne=null!==(Xc=this.ssd)&&
void 0!==Xc?Xc:this.EGb;if(null!==ne&&(this.PMb(ne,!0)||this.twa)){this.Zld(qc,!0,this.DZ);this.DZ=0;return}}(Xc=this.cad())&&(this.PMb(Xc)||this.twa)?(this.Zld(qc,!0,this.DZ),this.DZ=0):1!==this.controller.Tm&&(this.h8(3,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry"),kb.ULS.sendTraceTag(527496923,0,15,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Retry\n           "+this.DZ+" - Presenter Nav State not available."),zb.a.instance.create(function(){bd.wzc(qc,md)},
hc.a.wva(this.DZ,this.iSe,this.jSe,!0),"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry",void 0,!0))}};v.prototype.Zld=function(qc,md,bd){qc=void 0===qc?!1:qc;md=void 0===md?!1:md;bd=void 0===bd?0:bd;this.h8(1,"ExcelLiveFollowerOrExplorer::initializeFollower");this.FLg();this.q0b();this.tod=!1;qc&&this.$n.Mvi(md,qc,bd);Qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveSurvey",!1)&&this.controller.LAc()};v.prototype.Tob=function(){this.bma=this.bma.bind(this);this.iD=
this.iD.bind(this);this.gD=this.gD.bind(this);this.Hf=this.Hf.bind(this);this.Soc=this.Soc.bind(this);this.gj=this.gj.bind(this);this.Jmc=this.Jmc.bind(this);this.fj=this.fj.bind(this);this.Joc=this.Joc.bind(this);this.Gnc=this.Gnc.bind(this);this.JOa=this.JOa.bind(this);this.Yoc=this.Yoc.bind(this);this.onScroll=this.onScroll.bind(this);this.k$a=this.k$a.bind(this);this.Yc=this.Yc.bind(this);this.V9a=this.V9a.bind(this);this.F9a=this.F9a.bind(this);this.Ge=this.Ge.bind(this);this.Qoc=this.Qoc.bind(this)};
v.prototype.gSe=function(){var qc=this.cad();return this.PMb(qc)};v.prototype.cad=function(qc){qc=void 0===qc?null:qc;if(qc=null!==qc&&void 0!==qc?qc:this.realtimeChannel.Vcd())for(var md in qc){var bd=md,Xc=qc[md];if(!Xc)break;if(Xc.NavigationState&&Xc.MeetingInfo&&(Xc.MeetingInfo.MeetingId===this.$.ya.MeetingId||rc.d()))return this.$n.FKj(Xc.MeetingInfo.MessageId,Xc.NavigationState.MessageBroadcastTime),this.controller.IB&&this.controller.IB===bd||this.controller.Jeg(bd,"ExcelLiveFollowerOrExplorer:extractNavigationStateFromMeetingPresence")&&
this.$n.cvi(bd),Xc.NavigationState}return null};v.prototype.h8=function(qc,md){this.$n.NKj(qc);this.controller.h8(qc,md)};v.prototype.PMb=function(qc,md){md=void 0===md?!1:md;var bd=jb.HelperMethods.$b(),Xc=this.x0g(qc,this.EGb,md);if(0===Xc)return this.XUf(Xc,qc),!0;if(!this.QMj(qc.SheetID))return!1;Xc&4&&this.setZoom(this.EGb,qc);md=this.s0g(qc);this.BGj(qc,Xc,md);this.XUf(Xc,qc);qc=Kb.D(qc.VisibleAreaRange);this.laa.R2i(new E(md,qc.toString()));this.$n.CKj(md,bd);return!0};v.prototype.BGj=function(qc,
md,bd){this.Tyb=!0;0===bd?this.z7f(md,qc):this.CGj(md,qc)};v.prototype.XUf=function(qc,md){this.EGb=md;this.FGb=qc};v.prototype.QMj=function(qc){qc=this.$.xa.getItemByName(qc);var md=this.$.xa.qa;this.Rsd=qc;if(!qc)return this.twa=!0,!1;if(qc!==md){if(!qc.visible)return!1;this.UMa=!0;qc.activate();md=qc}if(Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6146876_ExcelLiveSkipNSVPrompts")){if(!md.Yd.tK&&!md.Yd.qy)return!0;qc={};this.$.Xd(1690118309,Jb.a.Ub,0,(qc[rc.a]=!0,qc)).continueWith(function(){return!0})}return!0};
v.prototype.setZoom=function(qc,md){qc&&qc.SheetID===md.SheetID&&(qc=(md.ZoomLevel-qc.ZoomLevel)/qc.ZoomLevel*100,md=Wa.a(this.$).zoom,qc=md+md*qc/100,Wa.a(this.$).Hgg(qc),this.$n.QKj())};v.prototype.z7f=function(qc,md){qc&2&&(qc=Kb.D(md.VisibleAreaRange),this.c8a=bc.Range.hd(qc.top,qc.left),this.Vsd=new Cd.a(md.TopLeftCellOffsets.X,md.TopLeftCellOffsets.Y),md=wb.a(this.c8a,this.Vsd,this.gridView.Qs,this.gridView.rb,0,0,this.$,this.gridView.D4()),this.gridView.i_b(md,this.c8a,60,this.c8a,Zb.a.A7f))};
v.prototype.CGj=function(qc,md){var bd=Kb.D(md.SelectedRanges[md.IndexOfActiveRange]),Xc=qc!==this.FGb,ne=Kb.D(md.VisibleAreaRange);qc&1?(this.Bfg=this.gridView.Lac(),this.gridView.nt(bd,64,Zb.a.B7f,!0),qc=this.gridView.Gja(),this.c8a=qc.BL,this.Vsd=qc.dD,Xc&&(this.Fwa?this.ypd=!0:this.gridView.uZb(this.F9a))):qc&2&&(!ne.Hd(bd)||this.FGb&2||this.FGb&4)&&(this.z7f(qc,md),Xc&&this.$n.tud());this.$n.PKj()};v.prototype.Z6e=function(qc){var md=this.gridView.Lac();return md.Hd(qc)&&qc.Hd(md)?!0:!1};v.prototype.x0g=
function(qc,md,bd){bd=void 0===bd?!1:bd;if(!qc)return 0;if(!md&&qc||bd)return 7;var Xc=Kb.D(qc.SelectedRanges[qc.IndexOfActiveRange]),ne=Kb.D(md.SelectedRanges[md.IndexOfActiveRange]),ed=Kb.D(qc.VisibleAreaRange),nd=Kb.D(md.VisibleAreaRange);if(md.SheetID===qc.SheetID&&(md.SheetID!==qc.SheetID||md.ZoomLevel===qc.ZoomLevel&&Xc.equals(ne)&&ed.equals(nd)&&md.TopLeftCellOffsets.X===qc.TopLeftCellOffsets.X&&md.TopLeftCellOffsets.Y===qc.TopLeftCellOffsets.Y))return bd?7:0;Xc=Kb.D(qc.VisibleAreaRange);bd=
Kb.D(qc.SelectedRanges[qc.IndexOfActiveRange]);Xc=bc.Range.hd(Xc.top,Xc.left);ne=new Cd.a(qc.TopLeftCellOffsets.X,qc.TopLeftCellOffsets.Y);nd=Kb.D(md.VisibleAreaRange);ed=Kb.D(md.SelectedRanges[md.IndexOfActiveRange]);nd=bc.Range.hd(nd.top,nd.left);var Ub=new Cd.a(md.TopLeftCellOffsets.X,md.TopLeftCellOffsets.Y),Hc=0;qc.SheetID!==md.SheetID?Hc|=3:(ed.equals(bd)||(Hc|=1),qc.ZoomLevel!==md.ZoomLevel&&(Hc|=4),ne.equals(Ub)&&Xc.equals(nd)||(Hc|=2));return Hc};v.prototype.s0g=function(qc){var md=Q(this.$,
Wa.a(this.$).zoom),bd=md.ZOb;return md.bPb<qc.ViewportWidth*this.h_d||bd<qc.ViewportHeight*this.h_d?1:0};v.prototype.FLg=function(){var qc=this;this.$.ea.QG(this.iD);this.$.ea.IYa(this.gD);this.$.da.$a(419,function(md){md.moe(qc.k$a);md.noe(qc.k$a)})};v.prototype.oHe=function(){var qc=this;this.$&&(this.$.ea.VF(this.iD),this.$.ea.mbb(this.gD),this.$.da.$a(419,function(md){md.tQf(qc.k$a);md.uQf(qc.k$a)}))};v.prototype.k$a=function(){this.$n.DKj()};v.prototype.iD=function(){this.$.ea.rf!==yc.a.Se&&
this.$.ea.sc&&(this.twa&&this.$.ea.Ot(this.Hf),this.W5a=!0)};v.prototype.Hf=function(){(this.W5a||this.twa)&&this.gSe()&&(this.$.ea.Ev(this.Hf),this.twa=this.W5a=!1)};v.prototype.gD=function(){this.UMa?this.UMa=!1:this.W5a&&this.gSe()&&(this.W5a=!1)};v.prototype.q0b=function(){var qc=this;this.Fwa?(this.gridView.view.cHg(this.Qoc),this.gridView.uZb(this.F9a)):(this.gridView.PYa(this.Soc),this.$.Jme(this.Jmc),this.$.QA(this.fj),this.$.da.$a(419,function(md){md.kHg(qc.Yoc)}),this.gridView.Tme(this.JOa));
this.gridView.rc.ml(this.gj);this.$.da.$a(65,function(md){md.DFg(qc.Joc)})};v.prototype.isb=function(){this.gridView&&(this.Fwa?(this.gridView.view.Ecj(this.Qoc),this.gridView.Nsc(this.F9a)):(this.gridView.ubb(this.Soc),this.gridView.yPf(this.JOa)),this.gridView.rc.fl(this.gj));if(!this.Fwa){this.$&&(this.$.lPf(this.Jmc),this.$.zD(this.fj));var qc=this.$.da.Aa(419);qc&&qc.Jcj(this.Yoc)}(qc=this.$.da.Aa(65))&&qc.vbj(this.Joc)};v.prototype.Soc=function(){this.Syb?this.Syb=!1:this.qgc||this.UMa||this.Tyb||
this.foi()||(this.dod?this.dod=!1:this.Ula())};v.prototype.Qoc=function(){this.Ula()};v.prototype.F9a=function(qc,md){1!==this.controller.Tm||u(md.gotoCaller)||kb.ULS.sendTraceTag(523015448,0,50,"ExcelLiveFollowerOrExplorer.onGoToEnded: Function called for viewport sync action");this.Fwa?u(md.gotoCaller)?this.Ula():this.ypd&&this.Z6e(this.Bfg)&&(this.$n.tud(),this.ypd=!1):(this.gridView.Nsc(this.F9a),this.Z6e(this.Bfg)&&this.$n.tud())};v.prototype.foi=function(){var qc=this.gridView.Gja().BL;return this.Rsd===
this.$.qa&&qc.equals(this.c8a)?!0:!1};v.prototype.gj=function(){this.Ula()};v.prototype.Jmc=function(){this.Syb=!0};v.prototype.fj=function(){this.Syb=!0};v.prototype.Yoc=function(){this.qgc=!0};v.prototype.JOa=function(){this.qgc=!1};v.prototype.onScroll=function(qc){this.Tyb&&1===this.controller.Tm&&(this.Tyb=!1,this.dod=!0);qc.stopPropagation()};v.prototype.Joc=function(){this.Ula()};v.prototype.Ula=function(){this.Mfj();this.$n.BKj(this.FGb);this.h8(2,"ExcelLiveFollowerOrExplorer::onExploreActionsObserved");
this.oHe();this.isb();this.controller.xye()};v.prototype.GLg=function(){this.realtimeChannel.OFa(this.bma);this.$.ea.wne(this.Gnc);this.Fwa||Gc.a.instance.Zd(this.gridView.domElement).ka("scroll",this.onScroll);this.$.Zk(this.Yc);this.$.qa.Yd.LFa(this.V9a);this.$.qa.Yd.CZb(this.V9a);this.$.xa.Bg(this.Ge)};v.prototype.Cdh=function(){this.realtimeChannel&&this.realtimeChannel.Oza(this.bma);null!==this.$&&(this.$.ea.gbj(this.Gnc),this.$.rm(this.Yc),this.$.qa.Yd.qbb(this.V9a),this.$.qa.Yd.rJd(this.V9a),
this.$.xa.Xg(this.Ge))};v.prototype.bma=function(qc,md){qc=jb.HelperMethods.$b();this.BFd(md.N3);this.IFd(md.bP);this.$n.HKj(qc)};v.prototype.BFd=function(qc){var md=this;!qc||1>qc.length||2===this.controller.Tm||qc.forEach(function(bd){bd===md.controller.IB&&(md.controller.vsc(),md.h8(3,"ExcelLiveFollowerOrExplorer:processDisconnectedClients"))})};v.prototype.IFd=function(qc){!qc||1>qc.length||(qc=this.cad(qc),null!==qc&&(this.ssd=qc,2!==this.controller.Tm&&(3===this.controller.Tm?this.wzc(this.tod,
qc):(this.PMb(qc),this.$n.IKj(qc.MessageOriginTime)))))};v.prototype.Mfj=function(){this.twa=this.Tyb=this.UMa=this.Syb=this.qgc=!1};v.prototype.Gnc=function(){1!==this.controller.Tm||this.UMa?this.$n.JKj():this.Ula()};v.prototype.V9a=function(qc,md){this.$n.LKj(md)};v.prototype.Ge=function(){this.UMa||this.Fwa&&this.W5a||this.Ula()};v.prototype.Yc=function(qc,md){md.Hg||this.$n.qkc()};Object(Gb.a)(v,"ExcelLiveFollowerOrExplorer",null,[]);var Za=b(29),vc=b(51),zc=b(104),kd=b(393),wa=b(15);n.prototype.dispose=
function(){this.isb();this.Fdh();this.$=this.gridView=this.viewBlockContainerHelpers=this.YOb=this.realtimeChannel=this.HPa=this.$t=null};n.prototype.Ohd=function(){kb.ULS.sendTraceTag(537162846,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action performed");this.HPa&&this.HPa.Nq&&kd.a.az.notificationBar.removeEntry(this.HPa);if(this.uod)this.D3f(),kb.ULS.sendTraceTag(537162845,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action ignored due to floating object selection.");else{var qc=!0;this.HMa||
(qc=this.I0h());qc?this.r5f():this.D3f()}};n.prototype.bma=function(qc,md){this.BFd(md.N3);this.IFd(md.bP)};n.prototype.tdc=function(){var qc=this;if(0===this.$t.Tm)kb.ULS.sendTraceTag(529064851,0,50,"ExcelLiveParticipantV0::HandleViewportChanged: Viewport changed for presenter.");else if(!this.YOb||this.YOb&&!this.YOb.vp)this.YOb=zb.a.instance.create(function(){qc.Ula()},500,"ExcelLiveParticipantV0.HandleViewportChanged",void 0,!0)};n.prototype.Ula=function(){kb.ULS.sendTraceTag(529064849,0,50,"ExcelLiveParticipantV0::onExploreActionsObserved: Explore action observed.");
this.hMe();this.HMa||this.p5f("ExcelLiveParticipantV0::onExploreActionsObserved")};n.prototype.D3f=function(){this.HPa||(this.HPa=kd.a.az.notificationBar.P$(wa.a.instance.fa(2221),!1),this.HPa.image=0);kd.a.az.notificationBar.lE(this.HPa);kb.ULS.sendTraceTag(528786756,0,50,"ExcelLiveParticipantV0.GoToPresenter - Action not performed. Location not available.")};n.prototype.initialize=function(){rc.e(this.$)?(this.$8h(),this.q0b()):(this.VLg(),this.Q9e())};n.prototype.$8h=function(){this.$t.h8(0,this.vkc+
"initExcelLivePresenter")};n.prototype.Q9e=function(){var qc=this;++this.C2a;if(this.C2a>this.lSe)kb.ULS.sendTraceTag(527766151,0,10,"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable: Presenter data not available after "+(this.C2a-1)+" retries.");else{var md=this.kSe();md?this.O9e(md):(kb.ULS.sendTraceTag(527766150,0,15,"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable: Retry "+this.C2a+" - Presenter data not available."),zb.a.instance.create(function(){qc.Q9e()},hc.a.wva(this.C2a,this.mSe,
this.nSe,!0),"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable",void 0,!0))}};n.prototype.O9e=function(qc){qc?(this.C2a=0,kb.ULS.sendTraceTag(537162844,0,50,"ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer: Update received from presenter with CID: "+this.$t.IB+" and messageId:"+this.Xka),this.N6=qc,this.hMe(),this.HMa&&3===this.$t.Tm?this.r5f():this.HMa||this.p5f("ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer")):kb.ULS.sendTraceTag(527766149,0,50,"ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer: Update not from presenter.")};
n.prototype.r5f=function(){this.$t.h8(1,"ExcelLiveParticipantV0::startFollowing");this.q0b();Qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveSurvey",!1)&&this.$t.LAc()};n.prototype.p5f=function(qc){this.$t.h8(2,qc);this.isb();this.$t.xye()};n.prototype.VLg=function(){this.realtimeChannel.OFa(this.bma)};n.prototype.Fdh=function(){this.realtimeChannel.Oza(this.bma)};n.prototype.q0b=function(){this.gridView.PYa(this.tdc)};n.prototype.isb=function(){this.gridView.ubb(this.tdc)};
n.prototype.BFd=function(qc){var md=this;!qc||1>qc.length||qc.forEach(function(bd){bd===md.$t.IB&&(md.N6=void 0,md.$t.vsc(),md.$t.h8(3,"ExcelLiveParticipantV0::onMeetingPresenceUpdated"))})};n.prototype.IFd=function(qc){!qc||1>qc.length||(qc=this.kSe(qc),this.O9e(qc))};n.prototype.kSe=function(qc){qc=(void 0===qc?null:qc)||this.realtimeChannel.Vcd();if(!qc)return null;this.$t.IB||this.D7h(qc);if(this.$t.IB&&(qc=qc[this.$t.IB])){var md=qc.MeetingInfo.MessageId;if(this.Xka+1<md)kb.ULS.sendTraceTag(524940886,
0,15,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Presenter message lost. LastMessageId: "+this.Xka+", CurrentMessageId: "+md);else{if(this.Xka>md)return kb.ULS.sendTraceTag(524940885,0,15,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Older Presenter message received. LastMessageId: "+this.Xka+", CurrentMessageId: "+md),null;if(this.Xka===md)return kb.ULS.sendTraceTag(524940884,0,50,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Duplicate Presenter message received. LastMessageId: "+
this.Xka+", CurrentMessageId: "+md),null}this.Xka=md;return qc.SelectedRange}return null};n.prototype.D7h=function(qc){for(var md in qc){var bd=md,Xc=qc[md];if((null===Xc||void 0===Xc?0:Xc.MeetingInfo)&&Xc.MeetingInfo.IsPresenter&&Xc.MeetingInfo.MeetingId===this.$.ya.MeetingId){this.Xka=Xc.MeetingInfo.MessageId-1;this.$t.Jeg(bd,"ExcelLiveParticipantV0:identifyPresenterFromPresenceData");break}}};n.prototype.hMe=function(){if(this.N6){for(var qc=this.N6.length,md=0;md<qc;md++){var bd=this.N6[md].NamedObjectName;
if(Za.a.h0c(bd)){if(kb.ULS.sendTraceTag(537162837,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to false"),this.uod=!1,this.N6[md].SheetName===this.$.xa.qa.sheetName&&this.gridView.w5(Kb.D(this.N6[md]))){kb.ULS.sendTraceTag(537162836,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.HMa=!0;return}}else if(kb.ULS.sendTraceTag(537162839,
0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to true"),this.uod=!0,this.N6[md].SheetName===this.$.xa.qa.sheetName&&this.uhi(bd)){kb.ULS.sendTraceTag(537162838,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.HMa=!0;return}}kb.ULS.sendTraceTag(537162835,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to false")}this.HMa=
!1};n.prototype.uhi=function(qc){var md=this;qc=zc.a(this.$).Hq(qc);if(!qc||!qc.floatingObject||!qc.domElement)return!1;this.viewBlockContainerHelpers||ob.TaskExtensions.Ba(vc.GetServiceTaskFactory.Va(this.$.da,103,104,0),function(Xc){md.viewBlockContainerHelpers=Xc.result},this.$.la,8);if(!this.viewBlockContainerHelpers)return!1;var bd=this.viewBlockContainerHelpers.NZ(qc.mg,qc.domElement);return qc.mg.zn.Hd(bd)?!0:!1};n.prototype.I0h=function(){kb.ULS.sendTraceTag(537162834,0,50,"ExcelLiveParticipantV0.GoToPresenterLocation - Update participant viewport");
var qc=this.N6&&0<this.N6.length?this.N6[0]:null;if(!qc||!qc.SheetName)return!1;var md=this.$.xa.getItemByName(qc.SheetName);if(!md||md!==this.$.qa&&!md.visible)return kb.ULS.sendTraceTag(529109851,0,15,"ExcelLiveParticipantV0.GoToPresenterLocation - sheet not available"),!1;md!==this.$.qa&&md.activate();this.gridView.nt(Kb.D(qc),3,"ExcelLiveParticipantV0.GoToPresenterLocation");return!0};Object(Gb.a)(n,"ExcelLiveParticipantV0",null,[]);w.prototype.dispose=function(){this.GVd=this.$=null};w.prototype.GKj=
function(qc){var md=ic.g(this.$).ha.sa.activeRange;qc=qc.Hd(md)?!0:!1;md=jb.HelperMethods.$b();if(!qc&&0===this.kRa)this.kRa=md;else if(0<this.kRa){var bd=md-this.kRa;this.Frb+=bd;this.kRa=md;qc&&z(bd,"ExcelLivePresenter.trackAndLogSelectionVisibility: Selection was outside presenter Viewport. TimeSpentWithoutSelectionVisible")}};w.prototype.qkc=function(){var qc=jb.HelperMethods.$b(),md=qc-this.QHf,bd=0;0<this.kRa&&(bd=qc-this.kRa,this.Frb+=bd);var Xc={};Xc.PercentageTimeSelectionVisible=(md-this.Frb)/
md*100;Xc.TimeSpentWithoutSelectionVisibleSinceLastBroadcast=bd;Xc.FirstMessageBroadcastTimestamp=this.Nad;Xc.LastMessageBroadcastTimestamp=this.SAb;Xc.TotalMessagesBroadcasted=this.JCb;Xc.TimeSinceLastBroadcastInMs=qc-this.SAb;Xc.TimeToCreateNavigationStateAggregatesInMs=this.GVd;qc=ba.a.Kc(Xc);this.$.sendBeaconTraceTag(523015439,50,!1,"ExcelLivePresenter.logSessionTelemetry: "+qc)};w.prototype.EKj=function(qc){++this.JCb;var md=jb.HelperMethods.$b();this.Nad=Math.min(this.Nad,md);var bd=md-this.SAb;
this.SAb=Math.max(this.SAb,md);kb.ULS.sendTraceTag(523015438,0,50,"ExcelLivePresenter.trackAndLogMessageBroadcasted: Sent message number ["+qc+"] after ["+(md-this.Zqf)+"]ms of viewport change by presenter and after ["+bd+"]ms of sending previous message")};w.prototype.MKj=function(){this.Zqf=jb.HelperMethods.$b()};w.prototype.Mui=function(){var qc=jb.HelperMethods.$b()-this.Zqf;z(qc,"ExcelLivePresenter.getCurrentViewportNavigationState: TimeToCreateNavigationState");this.GVd.T2(qc)};Object(Gb.a)(w,
"ExcelLivePresenterTelemetryHelper",null,[3]);h.prototype.dispose=function(){this.Hdh();this.gridView=this.$=this.realtimeChannel=this.controller=null};h.prototype.Tob=function(){this.rnc=this.rnc.bind(this);this.Lva=this.Lva.bind(this);this.edc=this.edc.bind(this);this.Yc=this.Yc.bind(this)};h.prototype.iEj=function(){this.mqc(!0);this.dMg()};h.prototype.dMg=function(){this.$.xa.AJ(this.edc);this.gridView.PYa(this.Lva);this.gridView.ha.oE(this.Lva);this.$.Zk(this.Yc)};h.prototype.Hdh=function(){this.$&&
(this.$.xa.bL(this.edc),this.$.rm(this.Yc));this.gridView&&(this.gridView.ubb(this.Lva),this.gridView.ha.uI(this.Lva))};h.prototype.edc=function(){this.gridView.ubb(this.Lva);this.gridView.LP(this.rnc)};h.prototype.rnc=function(){this.mqc();this.gridView.cL(this.rnc);this.gridView.PYa(this.Lva)};h.prototype.Lva=function(){this.$.xa&&this.$.xa.Qaf||this.mqc()};h.prototype.Yc=function(qc,md){md.Hg||this.$n.qkc()};h.prototype.dMh=function(){var qc=Date.now();this.$n.MKj();var md=this.gridView.Lac();
if(null===md)return null;var bd=this.gridView.Gja().dD;qc={MessageOriginTime:qc};qc.SheetID=this.$.qa?this.$.qa.sheetName:null;qc.ZoomLevel=Wa.a(this.$).zoom;qc.SelectedRanges=Kb.k(this.gridView.ha.sa.selectedRanges,this.$);qc.IndexOfActiveRange=this.gridView.ha.sa.rB;qc.VisibleAreaRange=Kb.v(md,this.$);qc.TopLeftCellOffsets={};qc.TopLeftCellOffsets.X=bd.x;qc.TopLeftCellOffsets.Y=bd.y;bd=Q(this.$,qc.ZoomLevel);var Xc=bd.bPb;qc.ViewportHeight=bd.ZOb;qc.ViewportWidth=Xc;this.$n.GKj(md);this.$n.Mui();
return qc};h.prototype.Doj=function(){this.N_={};this.N_.MeetingId=this.$.ya.MeetingId;this.N_.IsPresenter=!0};h.prototype.mqc=function(qc){var md=this;qc=void 0===qc?!1:qc;var bd=this.dMh();if(null===bd)kb.ULS.sendTraceTag(527962826,0,15,"ExcelLivePresenter:postViewportUpdatesToMeetingParticipants CurrentViewportNavigationState is null");else{var Xc={};Xc.MeetingInfo=this.N_;Xc.MeetingInfo.MessageId=++this.JCb;Xc.NavigationState=bd;Xc.NavigationState.MessageBroadcastTime=Date.now();this.realtimeChannel.eXf(Xc);
this.$n.EKj(this.JCb);qc&&Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6085564_ExcelLive_ResendViewportStateAfterInterval")&&zb.a.instance.create(function(){md.mqc(qc)},this.$Bi+this.t0g(),"ExcelLivePresenter::postViewportUpdatesToMeetingParticipants",void 0,!0)}};h.prototype.t0g=function(){var qc=void 0===qc?-3E3:qc;return Math.random()*(3E3-qc+1)+qc};Object(Gb.a)(h,"ExcelLivePresenter",null,[]);var Na=b(1188);r.prototype.dispose=function(){this.$t=this.$=null};r.prototype.AKj=function(qc,md){var bd,
Xc,ne=jb.HelperMethods.$b(),ed=ne-this.fUf;this.zjd=this.zjd||2==md;2!==md&&this.zjd&&++this.YTf;kb.ULS.sendTraceTag(523015441,0,50,"ExcelLiveManagerTelemetryHelper::trackAndLogConnectionStateChanged: Recorded ConnectionState change from ["+qc+"] to ["+md+"] after ["+ed+"]ms with current participant role ["+this.$t.Tm+"]");qc=Na.a[qc];md=Na.a[md];this.hJb.has(qc)||(this.hJb[qc]=1);this.hJb[md]=1+(null!==(bd=this.hJb[md])&&void 0!==bd?bd:0);this.fMd[qc]=ed+(null!==(Xc=this.fMd[qc])&&void 0!==Xc?Xc:
0);this.wuc.has(qc)||(this.wuc[qc]=new M);this.wuc[qc].T2(ed);this.fUf=ne};r.prototype.Avi=function(){var qc={};qc.RTCDisconnects=this.YTf;qc.RTCConnectionStateCounts=this.hJb;qc.RTCConnectionStateDurationsInMs=this.fMd;qc.RTCConnectionStateDurationsAggregatesInMs=this.wuc;qc.MeetingID=this.$.ya.MeetingId;qc.AmIPresenter=this.$.ya.IsMeetingPresenter;qc.MeetingManagerCreated=this.Pvd;qc.SessionDurationInMs=jb.HelperMethods.$b()-this.Pvd;qc=ba.a.Kc(qc);this.$.sendBeaconTraceTag(523015440,50,!1,"ExcelLiveManagerTelemetryHelper.logSessionTelemetry: "+
qc)};Object(Gb.a)(r,"ExcelLiveManagerTelemetryHelper",null,[]);m.prototype.dispose=function(){this.Vkb&&(this.Vkb.dispose(),this.Vkb=null);this.Fib&&(this.Fib.dispose(),this.Fib=null);this.pib&&(this.pib.dispose(),this.pib=null);rc.g(this.$)&&(this.i2.ZHb(this.goc),this.$.rm(this.Yc));this.$=this.i2=this.zee=this.Spa=null};m.prototype.UUd=function(){this.vUe?this.vUe.UUd():kb.ULS.sendTraceTag(537162880,0,10,"ExcelLiveManager::SyncToPresenter - FollowerOrExplorer object is not available to complete the action")};
m.prototype.Ohd=function(){this.WQe?this.WQe.Ohd():kb.ULS.sendTraceTag(537162851,0,10,"ExcelLiveManager::GoToPresenter - ExcelLiveParticipantV0 object is not available to complete the action")};m.prototype.LZb=function(qc){this.Spa.LZb(qc)};m.prototype.AJd=function(qc){this.Spa.AJd(qc)};m.prototype.Z8h=function(){rc.g(this.$)?rc.e(this.$)?this.Vkb=new h(this.$,this.i2,this.Spa):this.Fib=new v(this.$,this.i2,this.Spa):rc.f(this.$)&&(this.pib=new n(this.$,this.i2,this.Spa))};m.prototype.goc=function(qc,
md){md.oldState!==md.newState&&this.$n.AKj(md.oldState,md.newState)};m.prototype.Yc=function(qc,md){md.Hg||this.$n.Avi()};Ek.Object.defineProperties(m.prototype,{Bn:{configurable:!0,enumerable:!0,get:function(){return this.zee}},$ya:{configurable:!0,enumerable:!0,get:function(){return this.Spa.$ya}},vUe:{configurable:!0,enumerable:!0,get:function(){return this.Fib}},presenter:{configurable:!0,enumerable:!0,get:function(){return this.Vkb}},WQe:{configurable:!0,enumerable:!0,get:function(){return this.pib}}});
Object(Gb.a)(m,"ExcelLiveManager",null,[905,3]);l.prototype.dispose=function(){this.$=null};l.prototype.cjj=function(qc,md,bd){kb.ULS.sendTraceTag(527171654,0,50,"ExcelLiveFollowerOrExplorer:"+bd+" Setting presenter information to CID: "+qc+" from CID: "+this.IB);this.IB=qc;this.kza=md.User.UserName;this.zqc=md.UserColor};l.prototype.vsc=function(){this.zqc=this.kza=this.IB=void 0};Ek.Object.defineProperties(l.prototype,{Tm:{configurable:!0,enumerable:!0,get:function(){return this.mde},set:function(qc){this.mde=
qc}},IB:{configurable:!0,enumerable:!0,get:function(){return this.Tde},set:function(qc){this.Tde=qc}},kza:{configurable:!0,enumerable:!0,get:function(){return this.Ude},set:function(qc){this.Ude=qc}},zqc:{configurable:!0,enumerable:!0,get:function(){return this.Vde},set:function(qc){this.Vde=qc}}});Object(Gb.a)(l,"ExcelLiveParticipantModel",null,[3]);var Vb=b(254),pc=b(12),hd=b(271),Ud=b(21);f.prototype.WJd=function(qc,md,bd,Xc){bd=void 0===bd?null:bd;Xc=void 0===Xc?null:Xc;this.Exa(qc,md);this.Tm=
md;this.kza=bd;this.GPa=Xc;this.HTe?(this.HTe=!1,this.EQf()):(this.LWd=!1,this.container.classList.add("ewa-excelLive-meetingPill-container-hidden"))};f.prototype.dispose=function(){$removeHandler(this.container,"transitionend",this.uoa);$removeHandler(this.container,"transitioncancel",this.uoa);this.container=null};f.prototype.Wf=function(qc,md){if(md)return!1;qc=this.container.querySelectorAll(pc.DOMElementExtensions.sr);var bd;for(md=0;md<qc.length;md++){var Xc=qc[md];pc.DOMElementExtensions.canReceiveFocus(Xc)&&
(bd=Xc)}if(!bd)return kb.ULS.sendTraceTag(529109852,0,10,"ExcelLiveMeetingPillUtility.SetFocusOnSection: Could not find focusable element in live meeting pill"),!1;bd.focus();return!0};f.prototype.ph=function(qc){return pc.DOMElementExtensions.Ff(this.uc,qc)};f.prototype.Cj=function(){};f.prototype.Rj=function(){};f.prototype.initialize=function(qc,md){this.container=document.createElement("div");this.container.id="excelLiveMeetingPillContainer";this.container.classList.add("ewa-excelLive-meetingPill-container");
md.appendChild(this.container);rc.c(qc)&&(this.container.style.height="32px",kb.ULS.sendTraceTag(529073433,0,50,"ExcelLiveMeetingPillUtility.initialize:Changed the height of meeting pill container for mobile"));this.uoa=this.g4h;$addHandler(this.container,"transitionend",this.uoa);$addHandler(this.container,"transitioncancel",this.uoa);hd.a(qc).$h(this)};f.prototype.EQf=function(){var qc={};qc.participantRole=this.Tm;Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5931413_ShortenMeetingPillDisplayNameForMobile")&&
this.$.hN?(kb.ULS.sendTraceTag(527991135,0,50,"ExcelLiveMeetingPillUtility.renderMeetingPillInternal: Getting shortened user name for mobile meeting pill"),qc.presenterName=this.AXh(this.kza)):qc.presenterName=this.kza;qc.presenterColor=this.GPa;appChrome.renderLiveMeetingPill(this.container,qc)};f.prototype.AXh=function(qc){if(Ud.a.Fh(qc))return kb.ULS.sendTraceTag(527991134,0,15,"ExcelLiveMeetingPillUtility.getShortenedUserName: Username is null or empty"),qc;var md=qc.split(" "),bd=md.length;return 2>
bd||Ud.a.Fh(md[bd-1])?qc:md[0]+" "+md[bd-1].substring(0,1)};f.prototype.Exa=function(qc,md){md=sa[md];if(0===this.lastUpdateTime)kb.ULS.sendTraceTag(527766152,0,50,qc+"::FirstRole - ["+md+"]"),this.lastUpdateTime=jb.HelperMethods.$b();else{var bd=sa[this.Tm];if(bd===md)kb.ULS.sendTraceTag(523548820,0,15,"{0}:RoleTransition: Received transition to participant role which is same as current role: [{1}]",qc,bd);else{var Xc=jb.HelperMethods.$b()-this.lastUpdateTime;kb.ULS.sendTraceTag(528786757,0,50,"{0}:RoleTransition: Transition participant role from [{1}] to [{2}] after {3}s",
qc,bd,md,(Xc/1E3).toFixed(2));this.lastUpdateTime=jb.HelperMethods.$b()}}};Ek.Object.defineProperties(f.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return this.container}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!!this.container&&2===this.Tm}},we:{configurable:!0,enumerable:!0,get:function(){return Vb.a.nkf}}});Object(Gb.a)(f,"ExcelLiveMeetingPillUtility",null,[444,3]);e.prototype.uIb=function(qc,md){this.Tm=qc;this.GPa=void 0===md?null:md;appChrome.renderLiveMeetingBoundary(this.container,
this.EOg)};e.prototype.dispose=function(){this.container=null;this.$.zD(this.Dab);this.$.ecj(this.Dab)};e.prototype.initialize=function(qc){this.Tob();this.container=document.createElement("div");this.container.id="excelLiveMeetingBoundaryContainer";this.container.classList.add("ewa-excelLive-meetingBoundary-container");qc.append(this.container);this.uIb(this.Tm,this.GPa);this.$.QA(this.Dab);this.$.wGg(this.Dab)};e.prototype.Tob=function(){this.Dab=this.Dab.bind(this)};e.prototype.Dab=function(){this.uIb(this.Tm,
this.GPa)};Ek.Object.defineProperties(e.prototype,{PDh:{configurable:!0,enumerable:!0,get:function(){var qc;return(qc=this.Wg?document.getElementById("AdditionalBarsRegion"):document.getElementById(this.$.Mb+Xb.a.Xrb))?qc.clientHeight:0}},PRg:{configurable:!0,enumerable:!0,get:function(){var qc;return(qc=this.Wg?document.getElementById("BusinessBar"):document.getElementById(this.$.Mb+Xb.a.Mue))?qc.clientHeight:0}},Ayh:{configurable:!0,enumerable:!0,get:function(){var qc=null;this.Wg&&(qc=document.getElementById("FarPaneRegion"));
return qc?qc.clientWidth:0}},kJg:{configurable:!0,enumerable:!0,get:function(){var qc=rc.c(this.$)?(qc=document.getElementById(this.$.Mb+Xb.a.i0a))?qc.clientHeight:0:this.$.Kka?0:this.$.XSg();return qc}},yuj:{configurable:!0,enumerable:!0,get:function(){var qc;return(qc=this.Wg?document.getElementById("Header"):document.getElementById(Xb.a.lGa))?qc.clientHeight:0}},M0c:{configurable:!0,enumerable:!0,get:function(){return this.Wg?document.getElementById("EditorContainer"):this.$.zE}},Tte:{configurable:!0,
enumerable:!0,get:function(){return this.yuj+this.kJg+this.PRg+this.PDh}},DOg:{configurable:!0,enumerable:!0,get:function(){return this.M0c.clientLeft}},FOg:{configurable:!0,enumerable:!0,get:function(){return this.M0c.clientWidth+this.Ayh-3}},COg:{configurable:!0,enumerable:!0,get:function(){if(this.Wg){var qc=document.getElementById("StatusBar");return qc.offsetTop+qc.clientHeight-this.Tte}return this.M0c.clientHeight}},EOg:{configurable:!0,enumerable:!0,get:function(){var qc={};qc.participantRole=
this.Tm;qc.presenterColor=this.GPa;qc.top=this.Tte;qc.left=this.DOg;qc.width=this.FOg;qc.height=this.COg;qc.size=3;return qc}}});Object(Gb.a)(e,"ExcelLiveMeetingBoundaryUtility",null,[3]);var Zc=b(90),Ob=b(44),Ad=b(188),we=qb.a;Am(c,we);c.prototype.dispose=function(){this.$=null;this.fw&&(this.fw.dispose(),this.fw=null);this.eJa&&(this.eJa.dispose(),this.eJa=null);this.dJa&&(this.dJa.dispose(),this.dJa=null);this.pMa&&(Zc.a.Ha(this.pMa),this.pMa=null)};c.prototype.h8=function(qc,md){this.fw.Tm&&this.fw.Tm===
qc||(this.fw.Tm=qc,this.IQf(md))};c.prototype.Jeg=function(qc,md){if(!qc)return kb.ULS.sendTraceTag(528086352,0,10,"ExcelLiveController:savePresenterDetails Presenter CID is undefined"),!1;var bd=this.$.ea.shd(qc);if(!bd)return kb.ULS.sendTraceTag(528086351,0,10,"ExcelLiveController:savePresenterDetails Failed to get presenter information from sessionStateManager"),!1;this.fw.cjj(qc,bd,md);this.IQf(String.format("{0};{1}",md,this.vkc+"savePresenterDetails"));this.raiseEvent(c.MEd);return!0};c.prototype.vsc=
function(){this.fw.vsc()};c.prototype.LZb=function(qc){this.addHandler(c.MEd,qc)};c.prototype.AJd=function(qc){this.removeHandler(c.MEd,qc)};c.prototype.LAc=function(){var qc=this;this.pMa=Ad.AsyncMethodContext.$u(function(){qc.$.Xd(-1404915046,-1,0,null)},this.$.ya.ExcelLiveSurveyTriggerThresholdTimeInMs,Ob.a.LAc,this.pMa)};c.prototype.xye=function(){this.pMa&&this.pMa.cancel()};c.prototype.n$h=function(){this.fw=new l(this.$);var qc=this.$.zE;Ra.AFrameworkApplication.ta.Qa.Wg&&(qc=document.getElementById("StatusBarRegion"));
this.eJa=new f(this.$,qc);qc=this.$.kr;Ra.AFrameworkApplication.ta.Qa.Wg&&(qc=document.getElementById("regionComposerRoot"));this.wAb&&(this.dJa=new e(this.$,qc));qc=rc.e(this.$)?0:3;this.h8(qc,this.vkc+"initializeController")};c.prototype.IQf=function(qc){switch(this.fw.Tm){case 2:this.eJa.WJd(qc,this.fw.Tm,this.fw.kza);this.wAb&&this.dJa.uIb(this.fw.Tm);break;case 1:this.eJa.WJd(qc,this.fw.Tm,this.fw.kza,this.fw.zqc);this.wAb&&this.dJa.uIb(this.fw.Tm,this.fw.zqc);break;case 3:case 0:this.eJa.WJd(qc,
this.fw.Tm),this.wAb&&this.dJa.uIb(this.fw.Tm)}};Ek.Object.defineProperties(c.prototype,{$ya:{configurable:!0,enumerable:!0,get:function(){return this.fw}},Tm:{configurable:!0,enumerable:!0,get:function(){return this.fw.Tm}},IB:{configurable:!0,enumerable:!0,get:function(){return this.fw.IB}}});c.MEd="PDS";Object(Gb.a)(c,"ExcelLiveController",qb.a,[3]);var Wd=Qb.a;Am(a,Wd);a.prototype.create=function(){this.Y8h()};a.prototype.dispose=function(){this.Bn&&this.Bn.nIb(this.SOa);this.Bn=null;this.$t&&
(this.$t.dispose(),this.$t=null);Wd.prototype.dispose.call(this)};a.prototype.Y8h=function(){var qc=this;this.$t=new c(this.$);this.$.da.$a(26,function(md){qc.Bn=md;qc.b1g()})};a.prototype.b1g=function(){kb.ULS.sendTraceTag(537162850,0,50,"ExcelLiveCommandHandlerFactory::ConnectToRealTimeChannel - attach RealTimeChannelInitialized handler");this.Bn.DVc(this.SOa);this.Bn.J_a()};a.ka=function(qc){kb.ULS.sendTraceTag(537162848,0,50,"ExcelLiveManagerFactory::Attach: Begin service registration");qc.da.Ga(474,
new a(qc));kb.ULS.sendTraceTag(537162847,0,50,"ExcelLiveManagerFactory::Attach: Complete service registration")};Object(Gb.a)(a,"ExcelLiveManagerFactory",Qb.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ExcelLive");Type.registerNamespace("_Ewa");Sa.a.Ki(".ewa-excelLive-meetingPill-container{height:24px;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s;position:absolute;width:100%;bottom:0;pointer-events:none;z-index:992}.ewa-excelLive-meetingPill-container-hidden{height:0 !important;overflow:hidden;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s}.ewa-excelLive-meetingBoundary-container{position:fixed;z-index:992}");
Type.registerNamespace("Common.App.RtcHostNotificationSubscription");xa.main();Type.registerNamespace("Common.App.LivePersonaCard.Contracts");Type.registerNamespace("Common.App.LivePersonaCard");ca.main();Type.registerNamespace("AppRealtimeChannel");(function(){pb.a.Fa(function(qc){a.ka(qc);P.ka(qc)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.rt.js.map/dc4ea5bad5570dbfeed9a2449bd03f71/EwaDS.rt.js.map