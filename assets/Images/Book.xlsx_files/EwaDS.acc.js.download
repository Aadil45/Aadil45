(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[28],{1441:function(x,C,b){function a(T){var ra=Qi.call(this)||this;ra.$=T;ra.Tb();return ra}function c(T,ra){var hb=Tf.call(this)||this;hb.Aob=function(Eb,sc){Eb=sc.a5;var vb=hb.gridView;sc=sc.B6h;var Wc=sc.Nf,Zd=sc.j$;Da.a.Eh&&Zd.push(new y(Wc,vb));switch(Eb){case 24:sc.j$.push(new u(Wc,sc));break;case 0:sc.j$.push(new E(Wc,vb));Da.a.rp||(df.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?
(Zd.push(new z(Wc,hb.gridView.$,sc.paneType,hb.tableManager,hb.ro)),df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&Array.add(Zd,new B(Wc,hb.gridView.$,sc.paneType,hb.tableManager,hb.ro))):Zd.push(new Q(Wc,hb.gridView.$,sc.paneType,hb.tableManager,hb.ro)));Zd.push(new e(sc,Wc,vb,sc.paneType));break;case 3:Zd.push(new F(Wc));Da.a.rp||(Zd.push(new ca(Wc,hb.gridView.$,sc.paneType,hb.vy,hb.ro,sc)),Zd.push(new h(Wc,hb.gridView,hb.vy,hb.ro,sc)),Zd.push(new r(Wc,
hb.gridView,hb.vy,hb.ro,sc)));break;case 4:case 5:Zd.push(new m(Wc));break;case 30:Zd.push(new l(Wc));break;case 16:Zd.push(new f(Wc));Zd.push(new v(sc,Wc,vb,sc.paneType));break;case 11:case 12:Zd.push(new n(Wc,11===Eb));break;case 17:Zd.push(new F(Wc));break;case 19:Zd.push(new F(Wc)),Zd.push(new D(sc,Wc,vb,sc.paneType))}sc.H0b=!0};hb.$=T;hb.gridView=Mf.g(T);hb.tableManager=ra;hb.vy=new t(hb.gridView);hb.ro=new W(hb.gridView);hb.gridView.Cb&&(hb.gridView.Cb.OEg(hb.Aob),hb.gridView.Cb.update(!1));
T.da.Ga(64,hb);return hb}function e(T,ra,hb,Eb){return J.call(this,T,ra,hb,Eb)||this}function f(T){var ra=Z.call(this,T)||this;f.xrb(T,da.a.Svh+" "+ff.a.vua);f.xrb(T,da.a.Rvh+" "+ff.a.vua);f.xrb(T,da.a.Ovh+" "+ff.a.vua);f.xrb(T,da.a.Qvh+" "+ff.a.vua);f.xrb(T,ff.a.Pvh);return ra}function l(T){var ra=Z.call(this,T)||this;appChrome.renderSpinner(T);return ra}function m(T){var ra=Z.call(this,T)||this;m.hrb(T,da.a.rvh+" "+ff.a.vua);m.hrb(T,da.a.qvh+" "+ff.a.vua);m.hrb(T,da.a.nvh+" "+ff.a.vua);m.hrb(T,
da.a.pvh+" "+ff.a.vua);m.hrb(T,ff.a.ovh);return ra}function r(T,ra,hb,Eb,sc){var vb=w.call(this,T,ra,hb,Eb,sc)||this;vb.zEb=function(){var Wc=3===ce.a.Ub;vb.xsd&&!Wc?vb.ro.IKb(vb.gba,vb.iL,!1):!vb.xsd&&Wc&&vb.ro.IKb(vb.gba,vb.iL,!0);vb.xsd=Wc};vb.$Pi=function(Wc,Zd){Zd.Wxb===vb.gba.E$&&vb.ro.IKb(vb.gba,vb.iL,!Zd.start&&vb.pRd())};ce.a.vne(vb.zEb);vb.xsd=3===ce.a.Ub;vb.ro.qFg(vb.$Pi);return vb}function h(T,ra,hb,Eb,sc){return w.call(this,T,ra,hb,Eb,sc)||this}function w(T,ra,hb,Eb,sc){var vb=Z.call(this,
T)||this;vb.mL=null;vb.Ya=null;vb.C3=0;vb.sourceRange=null;vb.Jb=null;vb.ISa=!1;vb.onPointerDown=function(Wc){Wc=Sf.a(vb.$).je(Wc);if(vb.z1f(Wc)&&!vb.ISa){vb.omf();vb.Ya=vb.ro.Lcd();vb.mL=vb.ro.Q1e(Wc);if(!vb.Ya||!vb.mL||!vb.mL.range)return fc.ULS.shipAssertTag(537159361,0,!!vb.Ya,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),fc.ULS.shipAssertTag(537159360,0,!!vb.mL,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),fc.ULS.shipAssertTag(537159331,0,
!!vb.mL.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;vb.Jb=vb.mL.range.clone();vb.sourceRange=vb.Jb.clone();vb.C3=vb.ZYe(Wc);if(4===vb.C3)return fc.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;var Zd=vb.J_e(Wc,!0);if(!Zd)return fc.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!vb.YDe(Zd))return fc.ULS.shipAssertTag(537159328,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;vb.gridView.zLa=!0;vb.Ya.$G(!1);vb.vy.sJe(Wc.Lb);vb.ro.oKf(!0,vb.gba.E$);vb.Ya.textBox.removeSelection();vb.Ya.zZb(vb.w5e);vb.FNf();vb.ISa=!0;qh.b(vb.$,!0)}return!0};vb.w5e=function(){vb.V9b(!0)};vb.gridView=ra;vb.$=ra.$;vb.iL=[];vb.ha=vb.gridView.ha;vb.vy=hb;vb.ro=Eb;vb.gba=sc;vb.coloredReferencesManager=vb.$.da.Aa(281);fc.ULS.shipAssertTag(537159362,0,!!vb.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
ra=El(vb.KSf());for(hb=ra.next();!hb.done;hb=ra.next())hb=vb.ro.mDe(T,hb.value,vb.voe(),vb.onPointerDown),vb.iL.push(hb);T=El(vb.iL);for(ra=T.next();!ra.done;ra=T.next())ra=ra.value,Oe.a.instance.pa(Df.a.JW,ra,Object(pf.a)(vb.vy,vb.vy.C8e,"hoveringStarted")),Oe.a.instance.pa(Df.a.Fy,ra,Object(pf.a)(vb.vy,vb.vy.D8e,"hoveringStopped"));vb.VYa(sc);return vb}function n(T,ra){var hb=Z.call(this,T)||this;var Eb=document.createElement("div"),sc=document.createElement("div");Eb.className=ra?aa.Uvh:aa.Wvh;
sc.className=ra?aa.Vvh:aa.Tvh;T.appendChild(Eb);T.appendChild(sc);return hb}function v(T,ra,hb,Eb){return J.call(this,T,ra,hb,Eb)||this}function u(T,ra){var hb=Z.call(this,T)||this;hb.oAf=function(){if(!hb.rv)return fc.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;hb.rv.FKf(hb.MH,!1);hb.rv.lLe(hb.MH,!1);if(3===hb.rv.model.state)return!0;hb.rv.y8e(!0);return!0};hb.yca=function(){if(!hb.rv)return!1;hb.rv.K2i();hb.rv.bLd(hb.MH,
!1);if(3===hb.rv.model.state)return!0;hb.rv.y8e(!1);return!0};hb.onPointerDown=function(Eb){return hb.rv?2===Eb.yb&&Eb.Tn===Sys.UI.MouseButton.leftButton?!0:!1:!1};hb.EEb=function(){if(!hb.rv)return!1;hb.rv.bLd(hb.MH,!0);hb.rv.FKf(hb.MH,!0);hb.rv.lLe(hb.MH,!0);hb.rv.MJb(!0);return!0};hb.onDoubleClick=function(Eb){if(Eb.Ca)return Eb.Ca.stopPropagation(),!0;fc.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};hb.rv=Object(ug.a)(Kh.a,
ra.metadata);hb.jK=document.createElement("div");hb.jK.id=String.format("{0}-{1}",T.id,re.a.Nwe);hb.jK.className=$e.a.VUg;hb.MH=document.createElement("div");hb.MH.id=String.format("{0}-{1}",T.id,re.a.x_c);hb.MH.className=$e.a.x_c;hb.jK.appendChild(hb.MH);T.appendChild(hb.jK);fc.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");Oe.a.instance.pa(Df.a.JW,hb.jK,hb.oAf);Oe.a.instance.pa(Df.a.Fy,hb.jK,
hb.yca);Oe.a.instance.pa(Df.a.pointerDown,hb.jK,hb.onPointerDown);ee.a.instance.pa(Df.a.click,hb.jK,hb.EEb);ee.a.instance.pa(Df.a.kk,hb.jK,hb.onDoubleClick);return hb}function t(T){var ra=this;this.Kg=function(){ra.Xod=!1};this.Dp=function(){ra.Xod=!0};this.gridView=T;this.p5a=0;this.Xod=this.Ogc=!1;this.P5=Number.NaN;this.gridView.ha.S2(this.Dp);this.gridView.ha.IY(this.Kg);this.gridView.ha.OZb(this.Kg)}function y(T,ra){var hb=Z.call(this,T)||this;hb.UQi=function(Eb){var sc=Qg.HelperMethods.Jm(Eb),
vb=hb.Fva.$Zd(Eb.clientPoint);if(!vb)return!1;var Wc=vb.tf,Zd=hb.Fva.Ea.yvb(Wc.hashCode).cva(vb.vG);if(!Zd)return!1;Eb=Wc.zj.domElement;vb=Qg.HelperMethods.Wle(Qg.HelperMethods.rKa(Wc.domElement,Eb),vb.vG);Wc=0;Zd=hb.Fva.kc(Zd.getRange());for(var uf=0,If=y.axe.length;uf<If;++uf){var ng=y.axe[uf];if(128!==ng&&64!==ng||!hb.Fva.$.isEditMode){var gg=Zd.mKa(ng);if(gg&&gg.M5a&&"none"!==gg.M5a.style.display){gg=gg.M5a;var Wh=Qg.HelperMethods.rKa(gg,Eb);gg=new Sys.UI.Bounds(Wh.x,Wh.y,gg.offsetWidth,gg.offsetHeight);
if(fb.a.xB(gg,vb)){Wc=ng;break}}}}return 0!==Wc?(Zd.invoke(Wc,sc),!0):!1};hb.kpg=ra;$c.a.instance.pa(Df.a.click,T,hb.UQi);return hb}function E(T,ra){var hb=F.call(this,T)||this;hb.Kg=function(){hb.domElement.classList.remove(aa.selecting);kc.c(hb.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};hb.Dp=function(){hb.domElement.classList.add(aa.selecting)};hb.onPointerDown=function(Eb){2===Eb.yb&&Eb.Tn===Sys.UI.MouseButton.leftButton&&(hb.gridView.ha.selectionType=4,hb.gridView.ha.sourceRange=
hb.gridView.ha.sa.qd,kc.c(hb.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};hb.tca=function(){hb.gridView.$.Xd(1983983164,2,30,null);return!0};hb.zd=function(){se.DOMElementExtensions.setVisible(hb.yaa,hb.gridView.$.isEditMode)};hb.C6=function(){se.DOMElementExtensions.setVisible(hb.yaa,!1)};hb.B6=function(){se.DOMElementExtensions.setVisible(hb.yaa,!0)};hb.Fxf=function(){se.DOMElementExtensions.setVisible(hb.yaa,!1)};hb.Exf=function(){se.DOMElementExtensions.setVisible(hb.yaa,
!0)};hb.$Db=function(Eb,sc){se.DOMElementExtensions.setVisible(hb.yaa,!sc.qke)};hb.gridView=ra;ra=document.createElement("div");ra.className=ff.a.Mvh;hb.yaa=ra;hb.zd(null,null);T.appendChild(ra);Oe.a.instance.pa(Df.a.pointerDown,hb.yaa,hb.onPointerDown);$c.a.instance.pa(Df.a.kk,hb.yaa,hb.tca);hb.gridView.ha.S2(hb.Dp);hb.gridView.ha.IY(hb.Kg);hb.gridView.$.nl(hb.zd);hb.gridView.$.zb.WZb(hb.C6);hb.gridView.$.zb.VZb(hb.B6);hb.gridView.Pme(hb.$Db);hb.gridView.wc.ml(hb.Fxf);hb.gridView.wc.mo(hb.Exf);return hb}
function B(T,ra,hb,Eb,sc){var vb=M.call(this,T,ra,hb,sc)||this;vb.VOa=function(){vb.hq&&vb.Osa(!0)};vb.QK=function(Wc){Sf.a(vb.$).je(Wc);vb.hq=!1;vb.Cb.Nh(vb.Mh);vb.ha.sourceRange=vb.sourceRange.clone();vb.qL();vb.$s(vb.PK,vb.QK);vb.pj=-1;return!0};vb.PK=function(Wc){Wc=Sf.a(vb.$).je(Wc);var Zd=Wc.clientPoint;vb.Ww=Wc;if(Wc=vb.ha.Vn(Zd,Wc.Lb,5,void 0,void 0,!0)){vb.Tcg(Wc,vb.isRow,Zd);if(vb.isRow||vb.ef)vb.Jb=vb.r$(Wc);vb.ha.sourceRange=vb.Jb;vb.Cb.wj(vb.Jb,vb.Mh);vb.Cb.Fn(vb.Mh);vb.Cb.Nh(vb.mB());
vb.OB()}return!0};vb.tableManager=Eb;vb.ha.OZb(vb.VOa);return vb}function z(T,ra,hb,Eb,sc){var vb=M.call(this,T,ra,hb,sc)||this;vb.cA=null;vb.Pq=!1;vb.Oq=!1;vb.OAb=0;vb.GM=null;vb.GO=null;vb.Nn=0;vb.pia=Fe.a.instance.fa(2213);vb.Esb=Fe.a.instance.fa(2214);vb.Lna=Fe.a.instance.fa(2215);vb.dLb=Fe.a.instance.fa(2216);vb.cud=df.EwaSettings.isChangeGateEnabled("OfficeVSO:6287205_LogDragDropActivity");vb.onKeyDown=function(Wc){if(vb.Xh){if(vb.tka(Wc)||Wc.Ca.keyCode===zd.a.Eea)return vb.AMa||(lf.KeyInputManager.instance.pa(Df.a.Ud,
vb.domElement.ownerDocument.body,vb.onKeyUp),vb.AMa=!0),!vb.hu&&vb.tka(Wc)&&(Mf.g(vb.$).rg.Mo(z.Xqb),vb.hu=!0),vb.iu||Wc.Ca.keyCode!==zd.a.Eea||(Mf.g(vb.$).rg.Mo(U.L1a),vb.iu=!0,2===vb.Nn?(vb.cH(!1),vb.CE=0,vb.Mh=vb.Oq?[11]:[12],vb.Pq=vb.Oq,vb.fQa(),vb.HL()):3===vb.Nn?(vb.k3(!1),vb.CE=vb.isRow?1:2,vb.c7(),vb.LD()):1===vb.Nn&&(vb.Osa(!1),vb.c7(),vb.LD())),!0}else if(!vb.hu&&(Wc.Ca.keyCode===zd.a.m8||Da.a.isMac&&Wc.Ca.keyCode===zd.a.Joa))return lf.KeyInputManager.instance.pa(Df.a.Ud,vb.domElement.ownerDocument.body,
vb.onKeyUp),Mf.g(vb.$).rg.Mo(z.Xqb),vb.hu=!0;return!1};vb.onKeyUp=function(Wc){if(vb.Xh){if(vb.tka(Wc)||Wc.Ca.keyCode===zd.a.Eea)return vb.OAb=vb.tka(Wc)?0:1,vb.hq&&Mf.g(vb.$).rg.Mo(U.L1a),Wc.Ca.keyCode===zd.a.Eea&&(2===vb.Nn?(vb.k3(!1),vb.CE=0,vb.c7(!0),vb.LD(!0)):3===vb.Nn?(vb.cH(!1),vb.CE=vb.isRow?1:2,vb.Mh=vb.isRow?[11]:[12],vb.fQa(!0),vb.HL(!0)):1===vb.Nn&&(vb.cH(!1),vb.Mh=vb.Oq?[11]:[12],vb.xHb(!0),vb.HL(!0))),vb.Boa(vb.OAb),!0}else if(Wc.Ca.keyCode===zd.a.m8||Da.a.isMac&&Wc.Ca.keyCode===zd.a.Joa)return vb.Boa(),
vb.hq&&Mf.g(vb.$).rg.Mo(U.g7c),!0;return!1};vb.QK=function(Wc){Wc=Sf.a(vb.$).je(Wc);5===vb.pj?vb.sBd(Wc):(vb.hq=!1,vb.Cb.Nh(vb.Mh),!vb.$.Cq([vb.Jb],!1)||vb.cHd()||vb.Fzb()||(vb.ha.sourceRange=vb.sourceRange.clone(),vb.Xh?vb.HFd():vb.Etb(),vb.ry()?vb.Jb.top>vb.sourceRange.top&&(Wc=vb.Jb.height,vb.Jb.top-=Wc,vb.Jb.bottom-=Wc):vb.Jb.left>vb.sourceRange.left&&(Wc=vb.Jb.width,vb.Jb.left-=Wc,vb.Jb.right-=Wc),vb.qL()),vb.cud&&vb.bud());vb.$s(vb.PK,vb.QK);vb.tableRange=null;vb.pj=-1;vb.Xh&&(vb.cA=null,vb.Nn=
0);return!0};vb.x6=function(){vb.hq=!1;vb.Nn=0;vb.Cb.Nh(vb.Mh);if(!vb.$.Cq([vb.Jb],!1))return vb.$s(vb.w6,vb.x6),vb.pj=-1,!0;if(!(vb.ha.sa.qd.equals(vb.Jb)||vb.nka(vb.Jb)||vb.nka(vb.sourceRange)||vb.Fzb())){vb.qL();vb.ha.sourceRange=vb.sourceRange.clone();var Wc=vb.ha.sourceRange,Zd=vb.ha.sa.qd,uf={};vb.$.Xd(-694765314,2,30,(uf[re.a.aua]=vb.hu,uf[re.a.r7b]=!0,uf[re.a.s7b]=vb.Pq,uf[re.a.Y3]=Wc,uf[re.a.X3]=Zd,uf[re.a.Bsb]=vb.iu,uf));vb.hu||(vb.Jb.top>vb.sourceRange.top&&(vb.isRow||vb.Jb.left===vb.sourceRange.left&&
vb.Pq)?(Wc=vb.Jb.height,vb.Jb.top-=Wc,vb.Jb.bottom-=Wc):vb.Jb.left>vb.sourceRange.left&&(vb.ef||vb.Jb.top===vb.sourceRange.top&&!vb.Pq)&&(Wc=vb.Jb.width,vb.Jb.left-=Wc,vb.Jb.right-=Wc),vb.qL())}vb.$s(vb.w6,vb.x6);vb.tableRange=null;vb.cA=null;vb.pj=-1;vb.Pq=!1;vb.cud&&vb.bud();return!0};vb.PK=function(Wc){var Zd=df.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Zd&&(Wc=Sf.a(vb.$).je(Wc));var uf=Wc.clientPoint;Zd||(Wc=Sf.a(vb.$).je(Wc));vb.Xh&&(vb.Ww=Wc);if(Wc=
vb.ha.Vn(uf,Wc.Lb,5,void 0,void 0,!0)){if(vb.tableRange.contains(Wc.topLeft)){if(vb.Tcg(Wc,vb.ry(),uf),vb.Jb=vb.r$(Wc),vb.ha.sourceRange=vb.Jb,vb.Cb.wj(vb.Jb,vb.Mh),vb.Cb.Fn(vb.Mh),vb.Cb.Nh(vb.mB()),6!==vb.pj){for(uf=1;4>=uf;uf++)Wc=vb.Uh[uf.toString()],Wc.parentNode.removeChild(Wc),vb.Cb.Hw(vb.ry()?11:12,uf).Nf.appendChild(Wc);vb.pj=6}}else if(vb.Jb=vb.Aha(Wc),vb.Xh)vb.Dwb(!1);else if(vb.Cb.wj(vb.Jb,vb.mB()),vb.Cb.Fn(vb.mB()),vb.Cb.Nh(vb.Mh),5!==vb.pj){for(uf=1;4>=uf;uf++)Wc=vb.Uh[uf.toString()],
Wc.parentNode.removeChild(Wc),vb.Cb.Hw(vb.pja(),uf).Nf.appendChild(Wc);vb.pj=5}vb.OB()}return!0};vb.w6=function(Wc){var Zd=df.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Zd&&(Wc=Sf.a(vb.$).je(Wc));var uf=Wc.clientPoint;Zd||(Wc=Sf.a(vb.$).je(Wc));vb.Ww=Wc;if(Zd=vb.ha.Vn(uf,Wc.Lb,5,void 0,void 0,!0)){if(vb.Rwb(Zd))return vb.Jb=vb.Aha(Zd),vb.Cwb(!1),!0;var If=Mf.g(vb.$),ng=If.qg(Zd),gg=If.Tf(vb.paneType);uf=bh.a.Es(gg.view.ti,vb.domElement.parentNode,uf,If.rtl);
gg=!1;var Wh=2;vb.Pq=!1;if(vb.isRow||vb.ef){vb.isRow&&uf.y-ng.topLeft.y>ng.height/2?(gg=!0,Wh=1):vb.ef&&uf.x-ng.topLeft.x>ng.width/2&&(gg=!0);if(gg){Wc=If.vk("DragSelectionClickBehaviorTableRange.OnPointerMoveDragInsert",If.tH,Wh);try{Wc.ps(Zd),Wc.$$mn(),Zd=Wc.$$cu().range}finally{Wc&&Wc.dispose()}}vb.Jb=vb.Aha(Zd)}else{uf.x-ng.topLeft.x===ng.width?(vb.Pq=!1,gg=!0):uf.y-ng.topLeft.y>ng.height/2&&(gg=!0,vb.Pq=!0,Wh=1);vb.cA&&(vb.Pq=vb.Oq);if(gg){If=If.vk("DragSelectionClickBehaviorTableRange.OnPointerMoveDragInsert",
If.tH,Wh);try{If.ps(Zd),If.$$mn(),Zd=If.$$cu().range}finally{If&&If.dispose()}}vb.Cb.Nh(vb.Mh);vb.Mh=vb.Pq?[11]:[12];for(If=1;4>=If;If++)(ng=vb.Uh[If.toString()])&&ng.parentNode.removeChild(ng),vb.Uh[If.toString()]=null;vb.NB(Wc.clientPoint,Wc.Lb,vb.Pq?11:12,!0);vb.Jb=vb.r$(Zd)}vb.ha.sourceRange=vb.Jb;vb.Cb.wj(vb.Jb,vb.Mh);vb.Cb.Fn(vb.Mh);vb.Cb.Nh(vb.mB());if(6!==vb.pj){for(Wc=1;4>=Wc;Wc++)Zd=vb.Uh[Wc.toString()],Zd.parentNode.removeChild(Zd),vb.Cb.Hw(vb.isRow||vb.Pq?11:12,Wc).Nf.appendChild(Zd);
vb.pj=6}vb.OB()}return!0};vb.VOa=function(){vb.Xh?vb.hq&&5<=vb.pj&&(vb.tableRange?vb.iu?vb.cH(!0):vb.Osa(!0):vb.iu?vb.isRow||vb.ef?vb.cH(!0):vb.k3(!0):vb.isRow||vb.ef?vb.k3(!0):vb.cH(!0)):vb.hq&&5<=vb.pj&&(vb.tableRange?(vb.Cb.Nh(vb.Mh),vb.$s(vb.PK,vb.QK)):(vb.Cb.Nh(vb.mB()),vb.$s(Object(pf.a)(vb,vb.Sh,"onPointerMove"),Object(pf.a)(vb,vb.Of,"onPointerUp"))))};vb.tableManager=Eb;vb.tableRange=null;vb.iu=!1;vb.hu=!1;vb.AMa=!1;vb.ha.OZb(vb.VOa);return vb}function M(T,ra,hb,Eb){var sc=U.call(this,T,ra,
hb,Eb)||this;sc.Mh=null;sc.isRow=!1;sc.ef=!1;sc.Kg=function(){sc.domElement.classList.remove(aa.selecting)};sc.Dp=function(){sc.domElement.classList.add(aa.selecting)};sc.kd=function(){if(sc.$.isEditMode){var vb=sc.yxc();sc.dwc(vb)}};sc.Uh={};sc.hq=!1;sc.ha.S2(sc.Dp);sc.ha.IY(sc.Kg);sc.ha.oE(sc.kd);return sc}function Q(T,ra,hb,Eb,sc){var vb=U.call(this,T,ra,hb,sc)||this;vb.pia=Fe.a.instance.fa(2213);vb.Esb=Fe.a.instance.fa(2214);vb.Lna=Fe.a.instance.fa(2215);vb.dLb=Fe.a.instance.fa(2216);vb.Mh=null;
vb.cA=null;vb.Pq=!1;vb.isRow=!1;vb.ef=!1;vb.Oq=!1;vb.GM=null;vb.GO=null;vb.OAb=0;vb.Nn=0;vb.onKeyDown=function(Wc){if(vb.Xh){if(vb.tka(Wc)||Wc.Ca.keyCode===zd.a.Eea)return vb.AMa||(lf.KeyInputManager.instance.pa(Df.a.Ud,vb.domElement.ownerDocument.body,vb.onKeyUp),vb.AMa=!0),!vb.hu&&vb.tka(Wc)&&(Mf.g(vb.$).rg.Mo(Q.Xqb),vb.hu=!0),vb.iu||Wc.Ca.keyCode!==zd.a.Eea||(Mf.g(vb.$).rg.Mo(U.L1a),vb.iu=!0,2===vb.Nn?(vb.cH(!1),vb.CE=0,vb.Mh=vb.Oq?[11]:[12],vb.Pq=vb.Oq,vb.fQa(),vb.HL()):3===vb.Nn?(vb.k3(!1),vb.CE=
vb.isRow?1:2,vb.c7(),vb.LD()):1===vb.Nn&&(vb.Osa(!1),vb.c7(),vb.LD())),!0}else if(!vb.hu&&(Wc.Ca.keyCode===zd.a.m8||Da.a.isMac&&Wc.Ca.keyCode===zd.a.Joa))return lf.KeyInputManager.instance.pa(Df.a.Ud,vb.domElement.ownerDocument.body,vb.onKeyUp),Mf.g(vb.$).rg.Mo(Q.Xqb),vb.hu=!0;return!1};vb.onKeyUp=function(Wc){if(vb.Xh){if(vb.tka(Wc)||Wc.Ca.keyCode===zd.a.Eea)return vb.OAb=vb.tka(Wc)?0:1,vb.hq&&Mf.g(vb.$).rg.Mo(U.L1a),Wc.Ca.keyCode===zd.a.Eea&&(2===vb.Nn?(vb.k3(!1),vb.CE=0,vb.c7(!0),vb.LD(!0)):3===
vb.Nn?(vb.cH(!1),vb.CE=vb.isRow?1:2,vb.Mh=vb.isRow?[11]:[12],vb.fQa(!0),vb.HL(!0)):1===vb.Nn&&(vb.cH(!1),vb.Mh=vb.Oq?[11]:[12],vb.xHb(!0),vb.HL(!0))),vb.Boa(vb.OAb),!0}else if(Wc.Ca.keyCode===zd.a.m8||Da.a.isMac&&Wc.Ca.keyCode===zd.a.Joa)return vb.Boa(),vb.hq&&Mf.g(vb.$).rg.Mo(U.g7c),!0;return!1};vb.QK=function(Wc){Wc=Sf.a(vb.$).je(Wc);5===vb.pj?vb.sBd(Wc):(vb.hq=!1,vb.Cb.Nh(vb.Mh),!vb.$.Cq([vb.Jb],!1)||vb.cHd()||vb.Fzb()||(vb.ha.sourceRange=vb.sourceRange.clone(),vb.Xh?vb.HFd():vb.Etb(),vb.ry()?
vb.Jb.top>vb.sourceRange.top&&(Wc=vb.Jb.height,vb.Jb.top-=Wc,vb.Jb.bottom-=Wc):vb.Jb.left>vb.sourceRange.left&&(Wc=vb.Jb.width,vb.Jb.left-=Wc,vb.Jb.right-=Wc),vb.qL()));vb.$s(vb.PK,vb.QK);vb.tableRange=null;vb.pj=-1;vb.Xh&&(vb.cA=null,vb.Nn=0);return!0};vb.x6=function(){vb.hq=!1;vb.Nn=0;vb.Cb.Nh(vb.Mh);if(!vb.$.Cq([vb.Jb],!1))return vb.$s(vb.w6,vb.x6),vb.pj=-1,!0;if(!(vb.ha.sa.qd.equals(vb.Jb)||vb.nka(vb.Jb)||vb.nka(vb.sourceRange)||vb.Fzb())){vb.qL();vb.ha.sourceRange=vb.sourceRange.clone();var Wc=
vb.ha.sourceRange,Zd=vb.ha.sa.qd,uf={};vb.$.Xd(-694765314,2,30,(uf[re.a.aua]=vb.hu,uf[re.a.r7b]=!0,uf[re.a.s7b]=vb.Pq,uf[re.a.Y3]=Wc,uf[re.a.X3]=Zd,uf[re.a.Bsb]=vb.iu,uf));vb.hu||(vb.Jb.top>vb.sourceRange.top&&(vb.isRow||vb.Jb.left===vb.sourceRange.left&&vb.Pq)?(Wc=vb.Jb.height,vb.Jb.top-=Wc,vb.Jb.bottom-=Wc):vb.Jb.left>vb.sourceRange.left&&(vb.ef||vb.Jb.top===vb.sourceRange.top&&!vb.Pq)&&(Wc=vb.Jb.width,vb.Jb.left-=Wc,vb.Jb.right-=Wc),vb.qL())}vb.$s(vb.w6,vb.x6);vb.tableRange=null;vb.cA=null;vb.pj=
-1;vb.Pq=!1;return!0};vb.PK=function(Wc){var Zd=df.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Zd&&(Wc=Sf.a(vb.$).je(Wc));var uf=Wc.clientPoint;Zd||(Wc=Sf.a(vb.$).je(Wc));vb.Xh&&(vb.Ww=Wc);if(Wc=vb.ha.Vn(uf,Wc.Lb,5,void 0,void 0,!0)){if(vb.tableRange.contains(Wc.topLeft)){Zd=Mf.g(vb.$);var If=Zd.qg(Wc),ng=Zd.Tf(vb.paneType);uf=bh.a.Es(ng.view.ti,vb.domElement.parentNode,uf,Zd.rtl);ng=!1;var gg=2;vb.ry()&&uf.y-If.topLeft.y>If.height/2?(ng=!0,gg=1):!vb.ry()&&
uf.x-If.topLeft.x>If.width/2&&(ng=!0);if(ng){Zd=Zd.vk("DragSelectionClickBehavior.OnPointerMoveRearrange",Zd.tH,gg);try{Zd.ps(Wc),Zd.$$mn(),Wc=Zd.$$cu().range}finally{Zd&&Zd.dispose()}}vb.Jb=vb.r$(Wc);vb.ha.sourceRange=vb.Jb;vb.Cb.wj(vb.Jb,vb.Mh);vb.Cb.Fn(vb.Mh);vb.Cb.Nh(vb.mB());if(6!==vb.pj){for(Wc=1;4>=Wc;Wc++)Zd=vb.Uh[Wc.toString()],Zd.parentNode.removeChild(Zd),vb.Cb.Hw(vb.ry()?11:12,Wc).Nf.appendChild(Zd);vb.pj=6}}else if(vb.Jb=vb.Aha(Wc),vb.Xh)vb.Dwb(!1);else if(vb.Cb.wj(vb.Jb,vb.mB()),vb.Cb.Fn(vb.mB()),
vb.Cb.Nh(vb.Mh),5!==vb.pj){for(Wc=1;4>=Wc;Wc++)Zd=vb.Uh[Wc.toString()],Zd.parentNode.removeChild(Zd),vb.Cb.Hw(vb.pja(),Wc).Nf.appendChild(Zd);vb.pj=5}vb.OB()}return!0};vb.w6=function(Wc){var Zd=df.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Zd&&(Wc=Sf.a(vb.$).je(Wc));var uf=Wc.clientPoint;Zd||(Wc=Sf.a(vb.$).je(Wc));vb.Ww=Wc;if(Zd=vb.ha.Vn(uf,Wc.Lb,5,void 0,void 0,!0)){if(vb.Rwb(Zd))return vb.Jb=vb.Aha(Zd),vb.Cwb(!1),!0;var If=Mf.g(vb.$),ng=If.qg(Zd),gg=If.Tf(vb.paneType);
uf=bh.a.Es(gg.view.ti,vb.domElement.parentNode,uf,If.rtl);gg=!1;var Wh=2;vb.Pq=!1;if(vb.isRow||vb.ef){vb.isRow&&uf.y-ng.topLeft.y>ng.height/2?(gg=!0,Wh=1):vb.ef&&uf.x-ng.topLeft.x>ng.width/2&&(gg=!0);if(gg){Wc=If.vk("DragSelectionClickBehavior.OnPointerMoveDragInsert",If.tH,Wh);try{Wc.ps(Zd),Wc.$$mn(),Zd=Wc.$$cu().range}finally{Wc&&Wc.dispose()}}vb.Jb=vb.Aha(Zd)}else{uf.x-ng.topLeft.x===ng.width?(vb.Pq=!1,gg=!0):uf.y-ng.topLeft.y>ng.height/2&&(gg=!0,vb.Pq=!0,Wh=1);vb.cA&&(vb.Pq=vb.Oq);if(gg){If=If.vk("DragSelectionClickBehavior.OnPointerMoveDragInsert",
If.tH,Wh);try{If.ps(Zd),If.$$mn(),Zd=If.$$cu().range}finally{If&&If.dispose()}}vb.Cb.Nh(vb.Mh);vb.Mh=vb.Pq?[11]:[12];for(If=1;4>=If;If++)(ng=vb.Uh[If.toString()])&&ng.parentNode.removeChild(ng),vb.Uh[If.toString()]=null;vb.NB(Wc.clientPoint,Wc.Lb,vb.Pq?11:12,!0);vb.Jb=vb.r$(Zd)}vb.ha.sourceRange=vb.Jb;vb.Cb.wj(vb.Jb,vb.Mh);vb.Cb.Fn(vb.Mh);vb.Cb.Nh(vb.mB());if(6!==vb.pj){for(Wc=1;4>=Wc;Wc++)Zd=vb.Uh[Wc.toString()],Zd.parentNode.removeChild(Zd),vb.Cb.Hw(vb.isRow||vb.Pq?11:12,Wc).Nf.appendChild(Zd);
vb.pj=6}vb.OB()}return!0};vb.Kg=function(){vb.domElement.classList.remove(aa.selecting)};vb.Dp=function(){vb.domElement.classList.add(aa.selecting)};vb.kd=function(){if(vb.$.isEditMode){var Wc=vb.yxc();vb.dwc(Wc)}};vb.VOa=function(){vb.Xh?vb.hq&&5<=vb.pj&&(vb.tableRange?vb.iu?vb.cH(!0):vb.Osa(!0):vb.iu?vb.isRow||vb.ef?vb.cH(!0):vb.k3(!0):vb.isRow||vb.ef?vb.k3(!0):vb.cH(!0)):vb.hq&&5<=vb.pj&&(vb.tableRange?(vb.Cb.Nh(vb.Mh),vb.$s(vb.PK,vb.QK)):(vb.Cb.Nh(vb.mB()),vb.$s(Object(pf.a)(vb,vb.Sh,"onPointerMove"),
Object(pf.a)(vb,vb.Of,"onPointerUp"))))};vb.tableManager=Eb;vb.tableRange=null;vb.Uh={};vb.hq=!1;vb.hu=!1;vb.iu=!1;vb.AMa=!1;vb.ha.S2(vb.Dp);vb.ha.IY(vb.Kg);vb.ha.OZb(vb.VOa);vb.ha.oE(vb.kd);return vb}function P(T,ra){this.destinationRange=this.sourceRange=null;this.sourceRange=T;this.destinationRange=ra}function L(T,ra,hb,Eb,sc,vb,Wc,Zd){Zd=T.Na(41,void 0===Zd?null:Zd);Zd.sourceRange=ra;Zd.destinationRange=hb;return Vg.i(T,"RearrangeRowColumn",Zd,Eb,sc,vb,Wc,0)}function ca(T,ra,hb,Eb,sc,vb){var Wc=
U.call(this,T,ra,hb,sc)||this;Wc.mL=null;Wc.Ya=null;Wc.v5e=function(){Wc.Itb(!0)};Wc.gridView=Mf.g(Wc.$);Wc.vy=Eb;Wc.coloredReferencesManager=Wc.$.da.Aa(281);fc.ULS.shipAssertTag(537159391,0,!!Wc.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");T=El(Wc.cs);for(ra=T.next();!ra.done;ra=T.next())ra=ra.value,Oe.a.instance.pa(Df.a.JW,ra,Object(pf.a)(Wc.vy,Wc.vy.C8e,"hoveringStarted")),Oe.a.instance.pa(Df.a.Fy,
ra,Object(pf.a)(Wc.vy,Wc.vy.D8e,"hoveringStopped"));Wc.VYa(vb);return Wc}function U(T,ra,hb,Eb){var sc=F.call(this,T)||this;sc.ISa=!1;sc.nke=null;sc.mke=null;sc.Era=0;sc.Xh=df.EwaSettings.getBooleanFeatureGate(Ig.a.q7b,!1);sc.tgi=df.EwaSettings.getBooleanFeatureGate(Ig.a.qhh,!1);sc.CE=0;sc.mec=0;sc.QCc=0;sc.yma=null;sc.sourceRange=null;sc.Jb=null;sc.Ww=null;sc.onPointerDown=function(vb){vb=Sf.a(sc.$).je(vb);if(2===vb.yb&&vb.Tn===Sys.UI.MouseButton.leftButton&&!sc.ISa){var Wc=sc.jcc(vb);if(!Wc)return fc.ULS.shipAssertTag(537159379,
0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;sc.Jb=Wc.clone();sc.sourceRange=sc.Jb.clone();sc.yma=sc.Jb;if(Wc=sc.qSh(vb))sc.pj=5,sc.QCc=Wc.top-sc.sourceRange.top,sc.mec=Wc.left-sc.sourceRange.left,Mf.g(sc.$).rg.Mo(sc.Xh?U.L1a:U.g7c),sc.doc(vb),sc.ISa=!0,qh.b(sc.$,!0)}return!1};sc.zd=function(vb,Wc){Wc.nN||sc.dwc(sc.$.isEditMode)};sc.cs=[];sc.$=ra;sc.ha=Mf.g(sc.$).ha;sc.paneType=hb;sc.ro=Eb;ra=df.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
hb=Da.a.xf;ra=El(sc.tgi?ra&&!hb?[aa.Hvh,aa.uvh,aa.zvh,aa.Dvh]:[aa.Jvh,aa.wvh,aa.Bvh,aa.Fvh]:ra&&!hb?[aa.Gvh,aa.tvh,aa.yvh,aa.Cvh]:[aa.Ivh,aa.vvh,aa.Avh,aa.Evh]);for(hb=ra.next();!hb.done;hb=ra.next())hb=sc.ro.mDe(T,hb.value,sc.Xh?[aa.xvh]:[aa.svh],sc.onPointerDown),sc.cs.push(hb);sc.$.nl(sc.zd);sc.dwc(sc.$.isEditMode);return sc}function aa(){}function F(T){var ra=Z.call(this,T)||this;var hb=document.createElement("div");hb.className=ff.a.Nvh;T.appendChild(hb);return ra}function D(T,ra,hb,Eb){return J.call(this,
T,ra,hb,Eb)||this}function J(T,ra,hb,Eb){var sc=Z.call(this,ra)||this;sc.fob=!1;sc.UWc=!1;sc.qrd=!1;sc.zpb=null;sc.nrd=!1;sc.yba=!1;sc.Tw=function(){sc.fob&&sc.nrd?sc.Qna():sc.X4()};sc.Kxf=function(Wc){3===Wc.yb&&(sc.nrd=!0,sc.Qna());return!1};sc.Lxf=function(Wc){if(3===Wc.yb){if(!Wc.Lb||sc.Xgi(Wc))return!1;sc.nrd=!1;sc.X4()}return!1};sc.Kg=function(){sc.yba&&sc.TXd();sc.Qna();sc.qrd=!1};sc.Dp=function(){sc.X4();sc.qrd=!0};sc.Gya=function(Wc,Zd){Zd.a5===sc.a5&&(Zd.visible?sc.qrd||sc.Qna():sc.X4())};
sc.sDf=function(){sc.Mxf(sc.aP.domElement,!1)};sc.$tf=function(){sc.Mxf(sc.rM.domElement,!0)};sc.snc=function(Wc,Zd){sc.ha.wza(Zd)};sc.tnc=function(Wc,Zd){sc.ha.wza(ie.b(Zd))};sc.zEb=function(){3===ce.a.Ub?sc.Qna():sc.X4();sc.yba&&1===ce.a.Ub&&sc.TXd()};sc.tDf=function(){sc.Vnj()};sc.RJe=function(){sc.X4()};sc.Bp=function(){sc.ha.Oa.oc&&sc.X4()};sc.Otf=function(){sc.X4()};sc.Dxf=function(Wc,Zd){sc.TXd();3===Zd.yb?sc.Qna():sc.X4()};sc.orc=function(){sc.fob&&(sc.X4(),sc.Qna())};var vb=hb.$;sc.fr=hb;
sc.ha=hb.ha;sc.gba=T;sc.vlj=ra;sc.paneType=Eb;T=sc.domElement.currentStyle;ra="#000000";T&&(ra=T.borderTopColor);sc.aP=new R(sc.Dad(),ra,vb);sc.rM=new R(sc.Dad(),ra,vb);sc.Lef=vb.ea.isNamedObjectViewMode&&1===vb.workbookContext.NovMode;sc.aP.kne(sc.sDf);sc.aP.jne(sc.snc);sc.aP.lne(sc.tnc);sc.rM.kne(sc.$tf);sc.rM.jne(sc.snc);sc.rM.lne(sc.tnc);T=El(sc.gridView.yn);for(ra=T.next();!ra.done;ra=T.next())ra=ra.value,Zg.a.instance.pa(Df.a.Kf,ra.domElement,sc.Lxf),Zg.a.instance.pa(Df.a.De,ra.domElement,sc.Kxf);
hb.view.Vs(sc.Tw);hb.rc.ml(sc.RJe);hb.Cb.Fnb(sc.Gya);hb.cVc(sc.Otf);vb.QA(sc.orc);hb.Nt(sc.orc);sc.ha.IY(sc.Kg);sc.ha.S2(sc.Dp);hb.nE(sc.Bp);sc.ha.oZb(sc.Dxf);ce.a.vne(sc.zEb);Rc.TaskExtensions.Ba(cc.GetServiceTaskFactory.Va(vb.da,376,377,0),function(Wc){Wc.result.RGg(sc.tDf)},vb.la,3);return sc}function R(T,ra,hb){var Eb=fg.call(this,document.createElement("div"))||this;Eb.w5b=null;Eb.dPb=!1;Eb.onPointerDown=function(vb){vb=Sf.a(Eb.$)?Sf.a(Eb.$).je(vb):vb;Eb.dPb=!1;if(3===(ce.a.Ub=vb.yb)){var Wc=
vb.Ca.rawEvent,Zd=Wc.srcElement||Wc.target;se.DOMElementExtensions.Ff(Eb.domElement,Zd)&&se.DOMElementExtensions.Ff(Wc.currentTarget,Zd)&&(Eb.dPb=!0,Eb.w5b=vb.clientPoint)}return!1};Eb.Of=function(vb){vb=Sf.a(Eb.$)?Sf.a(Eb.$).je(vb):vb;Eb.raiseEvent("GrPointerUp",vb);return Eb.dPb=!1};Eb.Sh=function(vb){vb=Sf.a(Eb.$)?Sf.a(Eb.$).je(vb):vb;3===vb.yb&&Eb.dPb&&Eb.U4h(vb.clientPoint)&&(Eb.raiseEvent("GrDrag"),Eb.dPb=!1);return!1};Eb.vd=function(vb){Sf.a(Eb.$)&&Sf.a(Eb.$).je(vb);return!0};Eb.$=hb;hb=df.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
var sc=Da.a.xf;Eb.domElement.classList.add(!hb||sc?ff.a.xQe:ff.a.wQe);Eb.domElement.classList.add(ff.a.S8b);T.appendChild(Eb.domElement);se.DOMElementExtensions.setVisible(Eb.domElement,!1);Eb.RKa=document.createElement("div");Eb.RKa.classList.add(ff.a.R8b);Eb.RKa.style.borderColor=ra;Eb.domElement.appendChild(Eb.RKa);Oe.a.instance.pa(Df.a.pointerDown,Eb.domElement,Eb.onPointerDown);Oe.a.instance.pa(Df.a.$d,Eb.domElement,Eb.Of);Zg.a.instance.pa(Df.a.De,Eb.domElement,Eb.Of);Oe.a.instance.pa(Df.a.vh,
Eb.domElement,Eb.Sh);Zg.a.instance.pa(Df.a.yg,Eb.domElement,Eb.Sh);$c.a.instance.pa(Df.a.click,Eb.domElement,Eb.vd);return Eb}function Z(T,ra){return sd.call(this,T,void 0===ra?null:ra)||this}function W(T){var ra=dd.call(this)||this;ra.Dof=[3];ra.gridView=T;return ra}function ka(T,ra){var hb=gc.call(this)||this;hb.start=T;hb.Wxb=ra;return hb}function ma(T){var ra=Ga.call(this)||this;ra.$=T;ra.Tb();return ra}function pa(T){var ra=V.call(this)||this;T.da.Ga(376,ra);return ra}function xa(T){var ra=be.call(this)||
this;ra.$=T;ra.Tb();return ra}function va(){this.JLd=Nc.AFrameworkApplication.JWj;this.Tyi=Nc.AFrameworkApplication.HWj;this.$O=Nc.AFrameworkApplication.v0h();this.priority=Nc.AFrameworkApplication.H_d;this.$ee=this.xrj();this.jTc=Nc.AFrameworkApplication.u0h()}function ta(T,ra,hb,Eb,sc,vb,Wc){var Zd=this;Eb=void 0===Eb?null:Eb;sc=void 0===sc?!1:sc;vb=void 0===vb?null:vb;Wc=void 0===Wc?!1:Wc;this.$qa=0;this.rga=this.Wi=null;this.yXb=new ue.a;this.tT=new ue.a;this.am=null;this.WTb=!1;this.se=T;this.Nde=
ra;this.Nde.execute(function(uf){uf.Rl(uc.a.zkd,Object(pf.a)(Zd,Zd.iMi,"onHostResponseReceived"))});this.t9=hb;this.mie=new Ni.a("WebServiceCall","TokenRefresh");this.mj=Eb||new fa(T);this.mvg=sc;this.RT=vb?vb:Pi.SessionStatusManager.instance;this.R5d=Wc}function fa(T){this.Po={};this.YX={};this.Ctg={};this.Jlf=15;this.$9d=!1;this.svg=new Date;this.bUb=new Date;this.se=T;this.oXb=new Td.a(2,2,6E4*this.Jlf,Object(pf.a)(this,this.ugg,"writeMeasures"),135,"SL",!1);this.se.Sg(this.oXb);this.hai()}function Ca(){}
function Sa(T,ra){var hb=this;this.documentVisibilityObserver=null;this.Pa=new bg.a;this.Lx=null;this.Rdb=this.jlb=!1;this.Trc=null;this.AHb=!1;this.Nud=!0;this.E$d=this.e$d=this.oH=this.lmb=!1;this.mT=null;this.B5e=function(){if(!hb.h$b||hb.h$b&&hb.$.ea.sc)hb.c6e(!1);else if(hb.Nud){hb.Nud=!1;var Eb=Wb.a(hb.$);fc.ULS.sendTraceTag(537170709,0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [{0}] TimeUntilTokenExpirationInMin [{1}]",
Eb.wi?Eb.wi.activityName:"None",hb.d9f())}};this.od=function(Eb,sc){hb.context&&(Eb=hb.$.ea,sc.SH&&hb.context.uHb&&!hb.context.uAc?(hb.context.uAc=!0,sc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},sc.IsUserActive=Eb.sf.vr,sc.RefreshAccessTokenCorrelationID=hb.context.correlationID,sc=xh.a.Kc(sc),fc.ULS.sendTraceTag(537170708,0,50,sc)):hb.h$b&&hb.jlb&&!Eb.sc&&!hb.context.D4c&&(sc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},
hb.Lx&&(hb.Lx.C(),sc.Aborted=!0,df.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(sc.ResetStopRefreshRetriesUntilTokenExpired=!0,hb.Rdb=!1)),sc.TimeUntilTokenExpirationInMin=hb.d9f(),sc.RefreshAccessTokenCorrelationID=hb.context.correlationID,sc=xh.a.Kc(sc),fc.ULS.sendTraceTag(572019856,0,50,sc)))};this.Cya=function(){if(hb.context&&hb.context.uHb&&!hb.context.uAc){var Eb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Eb.CreatedForExpired=
hb.context.D4c;Eb.RefreshAccessTokenCorrelationID=hb.context.correlationID;Eb.OpenWorkbookErrors=lh.a.Wc(hb.$.ea.MF);Eb.ExecutionContextErrors=lh.a.Wc(Wb.a(hb.$).ud.errors);Eb.accesstokenTTL=Nc.AFrameworkApplication.uk;Eb=xh.a.Kc(Eb);fc.ULS.sendTraceTag(537170707,0,15,Eb)}};this.b6e=function(){hb.Rdb=!1;hb.c6e(!0)};this.iCd=function(){hb.AHb&&(hb.$.ea.sf.Pza(hb.iCd),hb.AHb=!1);hb.G5f()};this.$=T;this.eWd=ra;this.HHd=T.Ob.$g("WebServiceCall","refreshToken");this.h$b=df.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");
Lg.a.instance.IVc(this.b6e);Lg.a.instance.GVc(this.B5e);ra=this.$.ea;ra.hk(this.od);ra.HZb(this.Cya);this.Wzi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.Z0f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.NMf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.Fdg(T.ea.VEf,Nc.AFrameworkApplication.uk);T=new Date;ra={};fc.ULS.sendTraceTag(537170714,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",(ra.AccessTokenTtl=Nc.AFrameworkApplication.uk,ra.NowGetTime=
T.getTime(),ra.BootTime=Nc.AFrameworkApplication.oha,ra.WopiTokenExpiresAfterMinutes=Nc.AFrameworkApplication.F_d,ra.WopiTokenTaskItemPriority=Nc.AFrameworkApplication.H_d,ra));this.$.da.$a(291,function(Eb){hb.documentVisibilityObserver=Eb})}function Gb(T,ra){this.yXb=T;this.tT=ra}function kb(){return lb.apply(this,arguments)||this}function lb(){}function Nb(){}function Aa(T,ra){this.uHb=!1;this.correlationID=T;this.D4c=ra;this.uAc=!1;this.creationTime=wh.a.Ta.Wb}function qa(T){var ra=Xa.call(this)||
this;ra.Pa=new bg.a;ra.lmb=!1;ra.oH=!1;ra.$=T;return ra}function Xa(){this.mge=this.QQc=!1;var T=Nc.AFrameworkApplication.uk;if(!(0>=T)){this.uk=T;T=new Date;var ra={};fc.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",(ra.AccessTokenTtl=this.uk,ra.NowGetTime=T.getTime(),ra.BootTime=Nc.AFrameworkApplication.oha,ra));Lg.a.instance.IVc(Object(pf.a)(this,this.WOa,"onSessionExpiredDetected"));Lg.a.instance.GVc(Object(pf.a)(this,this.eCf,"onSessionExpiringDetected"))}}function Ha(T){var ra=
ti.call(this)||this;ra.$=T;ra.Tb();return ra}function Ra(T,ra,hb){hb=void 0===hb?null:hb;var Eb=$g.call(this,ra)||this;Eb.sheetTabActivatePreviousHidden=Fe.a.instance.fa(722);Eb.sheetTabActivateNextHidden=Fe.a.instance.fa(724);Eb.svgIconProvider=null;Eb.Ah=[];Eb.HK=Array(6);Eb.Bxd=Array(6);Eb.Wk=null;Eb.BQd=null;Eb.Zwc=null;Eb.edb=null;Eb.Xwc=null;Eb.QH=null;Eb.lyb=null;Eb.RRa=null;Eb.isRtl=!1;Eb.hv=0;Eb.vK=0;Eb.rtc=!1;Eb.l7b=!1;Eb.gna=0;Eb.Zpc=0;Eb.u7b=null;Eb.daa=null;Eb.a4=null;Eb.HM=null;Eb.TC=
0;Eb.Pcc=0;Eb.NMb=null;Eb.UAb=-1;Eb.mZ=null;Eb.gpc=0;Eb.Nyc=-1;Eb.Cma=0;Eb.Pta=new Ja;Eb.CLc=!1;Eb.P_=null;Eb.yge=null;Eb.CQd=null;Eb.DQd=null;Eb.stc=null;Eb.R9d=!1;Eb.yld=null;Eb.Twd=!1;Eb.xge=null;Eb.hD=function(sc,vb){Eb.rCf(vb.item)};Eb.Kya=function(sc,vb){sc=Eb.$.xa.qa.index;for(var Wc=0,Zd=Eb.Ah.length;Wc<Zd;Wc++){var uf=Eb.aR(Wc);if(uf.name===vb.oldName){uf.name=vb.newName;Eb.t0();Wc===sc&&Eb.F0(6);break}}};Eb.wCf=function(sc,vb){(sc=Eb.K2a(vb.item))&&sc.sfb()};Eb.xCf=function(sc,vb){vb.visible?
(Eb.IRa(!1),Eb.tCf(vb.item)):Eb.rCf(vb.item)};Eb.LK=function(sc){Eb.tF?(Eb.mZ=sc,Eb.gOb()):(Eb.mZ&&(Eb.Zpc+=Eb.mZ.clientPoint.x-sc.clientPoint.x),Eb.mZ=sc,Math.abs(Eb.Zpc)>=Eb.xhh&&Eb.gOb());return!0};Eb.YN=function(sc){sc.Ca.preventDefault();return!1};Eb.dWf=function(sc){Eb.aWf(sc,!0)};Eb.cWf=function(sc){Eb.aWf(sc,!1)};Eb.X_=function(sc){if(Eb.tF&&(Eb.Gz||Eb.Bgf(sc)))if(Eb.l7b=Eb.Dcf(sc),Eb.Gz){var vb;sc=(vb=Eb.aR(Eb.TC+1))?vb.sheet:null;Eb.reorderSheets(sc,Eb.TC+1===Eb.zQd,!0)}else sc=Eb.Twd?null:
Eb.yld,Eb.reorderSheets(sc,Eb.Twd,!0);Eb.GQ();return!0};Eb.gi=function(sc,vb){vb.NF&&Eb.aZd(vb.NF);Eb.cwc(!1);Eb.t0();vb.qa&&(Eb.aZd(vb.qa),Eb.F0(6),Eb.ea.hma())};Eb.etf=function(sc,vb){Eb.lCc(vb.item)};Eb.ftf=function(sc,vb){Eb.lCc(vb.item)};Eb.gtf=function(sc,vb){Eb.lCc(vb.item)};Eb.QOa=function(sc,vb){Eb.lCc(vb.item)};Eb.mya=function(){Eb.H0c()};Eb.zd=function(){Eb.isVisible=!Eb.ea.isNamedObjectViewMode;Eb.H0c();Eb.u4c();df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",
!1)&&(Sg.d(Eb.$)||Sg.e(Eb.$))&&(cg.PageLoadTrackingInfo.instance.dX(re.a.Jna,["sheetTabBar"]),cg.PageLoadTrackingInfo.instance.kS(re.a.Jna,["sheetTabBar"]));Eb.c4c();Eb.t0();Eb.IRa(!0);Eb.F0(6)};Eb.fj=function(){Eb.isVisible&&(Eb.t0(),Eb.F0(6))};Eb.Hf=function(){Object(Uf.a)(ob,Eb.QH)===Pa.k(Eb.$.kg)&&Eb.c4c();for(var sc=El(Eb.Ah),vb=sc.next();!vb.done;vb=sc.next())vb.value.Lnj(!Pa.k(Eb.$.kg))};Eb.vCf=function(sc,vb){Eb.bdj(vb.item,vb.isUserOperation)};Eb.ZEb=function(sc,vb){Eb.tCf(vb.item)};Eb.onKeyDown=
function(sc){switch(sc.keyCode){case 9:var vb=Eb.domElement.querySelectorAll(se.DOMElementExtensions.sr),Wc=se.DOMElementExtensions.Km(vb);vb=se.DOMElementExtensions.nB(vb);se.DOMElementExtensions.una(sc,Wc,vb);break;case 39:case 37:se.DOMElementExtensions.bZf(sc,Eb.domElement.querySelectorAll(se.DOMElementExtensions.sr),39===sc.keyCode?!Eb.isRtl:Eb.isRtl)}fc.ULS.sendTraceTag(537153691,0,50,"SheetTabBarControl.OnKeyDown: Press on {0}",sc.keyCode)};Eb.onScroll=function(){Eb.Wk.scrollLeft!==Eb.gna&&
Eb.mIj()};Eb.t6=function(sc){if(sc.ctrlKey||sc.p3)return!1;Eb.Wk.scrollLeft+=Math.floor(30*sc.dCa);if(Eb.Gz&&Eb.tF){var vb=Eb.pZe("OnMouseWheel");vb&&Eb.NUd(0<sc.dCa,vb.x+vb.width/2)}return!0};Eb.HF=function(sc,vb){if(Eb.Pta)Eb.K5e("PartialInteractivity",vb.gM?3:0);else{Eb.GQ(!1);Eb.ePd(vb.gM);sc=El(Eb.bte);for(var Wc=sc.next();!Wc.done;Wc=sc.next())(Wc=Wc.value)&&Wc.GX(vb.gM);sc=El(Eb.Ah);for(Wc=sc.next();!Wc.done;Wc=sc.next())(Wc=Wc.value)&&Wc.GX(vb.gM)}};Eb.$Db=function(sc,vb){sc=0;vb.qke&&(sc=
2|(vb.Fuj?1:0));Eb.K5e("ComponentRangePicker",sc)};Eb.$=T;Eb.ea=Eb.$.ea;Eb.Gz=Dc.a.uef();Eb.C7b=Eb.Gz&&!df.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");Eb.om=df.EwaSettings.ma(507);Eb.Nw=Dc.a.tqd();Eb.zgf=Eb.om&&!(df.EwaSettings.isChangeGateEnabled("OfficeVSO:6179307_hideSheetDropDownMenuForMobileMeetings")&&Eb.$.hN);Eb.Gz&&(Eb.R9d=Eb.om&&!Da.a.uv);Eb.LBi=Eb.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;Eb.KBi=Eb.$.ya.SheetTabNavigateButtonIntervalPeriodMS;
Eb.xhh=Eb.$.ya.SheetTabDragStartPixelThreshold;Eb.wPa=-1;Eb.vPa=-1;Eb.E2c=!1;Eb.Nw&&(Eb.svgIconProvider=hb);Eb.nC=new d.a(Eb.domElement,3);Eb.om&&Eb.domElement.classList.add(Db.ash);Eb.B7g();Eb.c5g();Eb.C7g();Eb.E8g();Eb.cwc(!0);Eb.zd(null,null);T=Eb.$.xa;T.Bg(Eb.gi);T.fVc(Eb.mya);T.GY(Eb.hD);T.Oga(Eb.ZEb);T.JFa(Eb.Kya);T.sne(Eb.vCf);T.KYa(Eb.xCf);T.$Eg(Eb.wCf);T.oVc(Eb.etf);T.pne(Eb.ftf);T.qne(Eb.gtf);T.rne(Eb.QOa);Eb.$.nl(Eb.zd);Eb.$.QA(Eb.fj);nf.a(Eb.$).$h(Eb);Eb.$.da.Ga(32,Eb);df.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&
Eb.$.ea.Ot(Eb.Hf);Eb.Ywc=Eb.he.Zd(Eb.domElement);Eb.Ywc.ka("keydown",Eb.onKeyDown);uh.a(Eb.$).Mq()&&Eb.HF(null,new tb.a(!0));uh.a(Eb.$).vg.Pga(Eb.HF);Mf.g(Eb.$).Pme(Eb.$Db);df.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Eb.Ywc.ka("mousedown",function(sc){sc.preventDefault()});ee.a.instance.pa(Df.a.bD,Eb.domElement,Eb.t6);Eb.AQd=Eb.he.Zd(Eb.Wk);Eb.AQd.ka("scroll",Eb.onScroll);Eb.mIj=A.a(function(){Eb.t0()},200,Eb.$.la,Ec.a.Kuj,!0);Eb.$.KH(re.a.vBj);Eb.zgf&&
(Eb.xge=new Tb(Eb.$,Eb.RRa.domElement));df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&cg.PageLoadTrackingInfo.instance.g7(re.a.Jna,["sheetTabBar"]);return Eb}function mb(T,ra,hb){ra=rc.call(this,document.createElement("a"),ra)||this;ra.wha=df.EwaSettings.ma(507)?da.a.v9c:da.a.gth;hb.Bb(ra.domElement,Fe.a.instance.fa(713),0,ra.wha,Fe.a.instance.fa(713),Te.a.T1c,!0);T.appendChild(ra.domElement);ra.Jc.ka("contextmenu",function(Eb){od.g(Eb)});return ra}function La(T,
ra,hb,Eb,sc,vb,Wc){var Zd=rc.call(this,document.createElement("li"),T)||this;Zd.R0f=0;Zd.S0f=0;Zd.s1c=0;Zd.t1c=0;Zd.J4c=.5;Zd.uQd=!1;Zd.mV=!1;Zd.XO=null;Zd.cDb=null;Zd.EE=null;Zd.CHc=null;Zd.color=null;Zd.aef=!1;Zd.Dhc=!1;Zd.C5b="#BEBBB8";Zd.bFc=null;Zd.onKeyDown=function(uf){return 13!==uf.Ca.keyCode||Zd.disabled?!1:(Zd.activateSheet(1),!0)};Zd.Qz=function(uf){return 32!==uf.Ca.charCode||Zd.disabled?!1:(Zd.activateSheet(1),!0)};Zd.UN=function(){Zd.disabled||(Zd.AS.tRi(Zd),Zd.AS.tF||Zd.Bna(!0,void 0,
"OnMouseOver"))};Zd.SN=function(){Zd.disabled||Zd.Bna(!1,void 0,"OnMouseOut")};Zd.zya=function(){Zd.AS.tF||(Zd.SDj(),Zd.sheet.A7||Mf.g(Zd.$).HIb(Zd.sheet.sheetName));return!1};Zd.Aya=function(){Zd.aLe(!1);return!1};Zd.vd=function(uf){if(Zd.disabled)return!0;var If=Mf.g(Zd.$);Zd.sheet.active||3!==uf.yb?Zd.om?Zd.activateSheet(uf.yb):Dc.a.erd()&&If.focus():(!Dc.a.$Ma(Zd.$)&&!Zd.AAb||If.isEditing||If.Mi||If.msb(),Zd.activateSheet(uf.yb));return 3!==uf.yb};Zd.onPointerDown=function(uf){if(Zd.disabled)return!0;
Zd.aLe(!0);Mf.g(Zd.$).inRangePicker&&fc.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var If=3===uf.yb;if(2===uf.yb||If&&Zd.Xwa)Zd.om?(Zd.Bna(!0,!If,"OnPointerDown"),If=Ue.Task.delay(If?Zd.S0f:Zd.R0f).CWR(function(){return!0})):If=Zd.activateSheet(uf.yb),Zd.X6a&&(Zd.Dhc=!0,Zd.AS.stc=Rc.TaskExtensions.Ba(If,function(){Zd.Dhc&&Zd.AS.vRi(Zd,uf)},Zd.la,11));return!1};Zd.Of=function(uf){if(Zd.disabled||!Zd.X6a&&
df.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;var If=Zd.AS.tF&&!Dc.a.uef();Zd.Dhc=!1;Zd.om&&Zd.Bna(2===uf.yb,void 0,"OnPointerUp");Zd.AS.stc&&(Rc.TaskExtensions.Ba(Zd.AS.stc,function(){Zd.AS.uRi(Zd)},Zd.la,11),Zd.AS.stc=null);return If};Zd.YN=function(){if(!Zd.X6a&&df.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;Zd.Dhc=!1;Zd.uQd||Zd.Bna(!1,void 0,"OnTouchMove");return!1};Zd.Qye=new ha(Zd,T);Zd.om=vb;
Zd.Nw=Wc;Zd.AAb=Dc.a.AAb(T);Zd.Qnd=df.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!Zd.Nw;Zd.om?(Zd.R0f=T.ya.SheetDragReorderDelayInMilliseconds,Zd.S0f=T.ya.SheetDragReorderDelayInMillisecondsForTouch,Zd.s1c=18,Zd.t1c=20):(Zd.s1c=19,Zd.t1c=22);Zd.$=T;Zd.EWb=Eb;Zd.AS=sc;Zd.X6a=sc.ipe();Zd.S9g();Zd.R3g();Zd.Ckd=T.Ob.$g("UserAction",Zd.name);Zd.Qod=!1;se.DOMElementExtensions.zu(Zd.domElement,re.a.Sr,null,null);Zd.domElement.appendChild(Zd.anchor);Zd.anchor.appendChild(Zd.EE);
Zd.Hna=new ue.a;T=new Sb(Zd.sheet,Zd.om,Zd.Nw);Zd.Hna.add(new Ia(Zd.$,T));Zd.$.ea.$Kb&&(T=new wc(Zd.sheet,Zd.om,Zd.Nw),Zd.Hna.add(new Ia(Zd.$,T)));Zd.Qnd||(T=new gb(Zd.sheet,Zd.AS.Uwc,function(){return Zd.color?La.BRd(Zd.color):!1},Zd.Nw),Zd.cDb=new Ia(Zd.$,T),Zd.Hna.add(Zd.cDb));Zd.Xwa=Zd.AS.Xwa;Zd.sfb();Zd.B8i();Zd.aue=new d.a(Zd.domElement,1);ra.insertBefore(Zd.domElement,hb);kc.a(Zd.$)&&Zd.vdg(!0);return Zd}function ha(T,ra){var hb=Yf.call(this,T.domElement)||this;hb.onKeyDown=function(Eb){121===
Eb.keyCode&&Eb.shiftKey&&!hb.Kna.disabled&&(hb.showContextMenu(new Sys.UI.Point(0,0),1,hb.Kna.anchor),od.g(Eb))};hb.tca=function(Eb){if(!hb.$.isEditMode||hb.Kna.disabled)return!0;hb.rename(!1,Eb.yb);return!0};hb.xl=function(Eb){return hb.Kna.disabled?!0:hb.showContextMenu(Eb.clientPoint,Eb.yb,Eb.Lb)};hb.Dge=T;hb.$=ra;$c.a.instance.pa(Df.a.kk,T.domElement,hb.tca);te.a.instance.pa(T.domElement,hb.xl);hb.Jc.ka("keydown",hb.onKeyDown);return hb}function Ia(T,ra){var hb=this;this.tqa=this.O1=this.bBa=
this.ul=null;this.nff=!1;this.zRc=this.eoa=this.Nsa=this.Gha=this.Msa=null;this.UN=function(){hb.dataSource.lN()&&Rc.TaskExtensions.Ba(hb.RBb,function(){dialogControls.renderToolTip(hb.dataSource.Rv(),"SheetIconTooltip",hb.dataSource.jWd(),hb.MI,10,!1,!1,1)},hb.$.la,3)};this.SN=function(){hb.dataSource.lN()&&hb.clearToolTip()};this.$=T;this.dataSource=ra;this.Nw=Dc.a.tqd()}function gb(T,ra,hb,Eb){this.sheet=T;this.altText=Fe.a.instance.fa(1869);this.gKj=ra;this.r2f=hb;this.Nw=Eb}function Sb(T,ra,
hb){this.om=ra;this.Nw=hb;this.sheet=T;this.altText=Fe.a.instance.fa(1946)}function wc(T,ra,hb){this.om=ra;this.Nw=hb;this.sheet=T;this.altText=Fe.a.instance.fa(1947)}function tc(T,ra,hb){var Eb=rc.call(this,document.createElement("a"),T,!0)||this;Eb.Jg=function(){Eb.GX(!1);Eb.$.ea.Wn(Eb.Jg)};Eb.vd=function(sc){Eb.A9f(sc.yb);return!0};Eb.onKeyDown=function(sc){return 13===sc.Ca.keyCode||32===sc.Ca.keyCode?(Eb.A9f(sc.yb),!0):!1};Eb.xsa=ra.Bb(Eb.domElement,Fe.a.instance.fa(515),0,da.a.Hrh,Fe.a.instance.fa(515),
Te.a.w1h,Eb.disabled);Eb.domElement.classList.add(Db.Krh);hb.appendChild(Eb.domElement);Eb.$.ea.Fl(Eb.Jg);Eb.o7i();return Eb}function Tb(T,ra){var hb=qf.call(this,document.createElement("div"))||this;hb.XR=function(){fc.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");hb.RQf(!1,"OnSheetsChanged")};hb.RIi=function(){hb.Ck()};hb.QIi=function(){hb.vm()};hb.$=T;hb.jHj=ra;hb.mV=!1;hb.wNb=0;return hb}function pb(T,ra){this.sheetName=null;this.newSheetIndex=0;this.sheetName=T;this.newSheetIndex=
ra}function cb(T,ra,hb){var Eb=rc.call(this,document.createElement("a"),ra)||this;Eb.vd=function(sc){Eb.$.Xd(-684145703,sc.yb,0,null);return!0};Eb.FEb=function(sc){Qg.HelperMethods.aWd(Eb.Sue,Eb.wha,Eb.wha+re.a.tec,("mouseover"===sc.type||"focus"===sc.type)&&!Mf.g(Eb.$).inRangePicker)};Eb.$=ra;Eb.wha=df.EwaSettings.ma(507)?da.a.v9c:da.a.ZOe;Eb.Sue=hb.Bb(Eb.domElement,Fe.a.instance.fa(513),0,Eb.wha,Fe.a.instance.fa(514),Te.a.T1c);T.appendChild(Eb.domElement);Eb.Jc.ka("contextmenu",function(sc){od.g(sc)});
Eb.Jc.ka("mouseover",Eb.FEb);Eb.Jc.ka("mouseout",Eb.FEb);$c.a.instance.pa(Df.a.click,Eb.domElement,Eb.vd);Eb.gNa=lf.KeyInputManager.instance.xs(Eb.domElement,Eb.vd,zd.a.di,zd.a.n1);return Eb}function ob(T,ra,hb,Eb){Eb=void 0===Eb?!1:Eb;var sc=rc.call(this,document.createElement("a"),ra,Eb)||this;sc.vd=function(vb){sc.disabled||sc.$.Xd(-1935155518,vb.yb,30,null);return!0};sc.FEb=function(vb){vb="mouseover"===vb.type||"focus"===vb.type;var Wc=kc.a(sc.$)?sc.$$a:sc.xsa;Qg.HelperMethods.aWd(Wc,sc.wha,
sc.wha+re.a.tec,vb&&!Mf.g(sc.$).inRangePicker)};sc.gj=function(){sc.GX(!0)};sc.ug=function(){sc.GX(!1)};sc.wha=df.EwaSettings.ma(507)?da.a.v9c:da.a.ZOe;sc.xsa=hb.Bb(sc.domElement,Fe.a.instance.fa(511),0,sc.wha,Fe.a.instance.fa(512),Te.a.T1c,Eb);T.appendChild(sc.domElement);sc.Jc.ka("contextmenu",function(vb){od.g(vb)});df.EwaSettings.ma(507)||(sc.Jc.ka("mouseover",sc.FEb),sc.Jc.ka("mouseout",sc.FEb));$c.a.instance.pa(Df.a.click,sc.domElement,sc.vd);sc.gNa=lf.KeyInputManager.instance.xs(sc.domElement,
sc.vd,zd.a.di,zd.a.n1);df.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(Mf.g(sc.$).wc.ml(sc.gj),Mf.g(sc.$).wc.mo(sc.ug));return sc}function rc(T,ra,hb){hb=void 0===hb?!1:hb;T=qe.call(this,T)||this;T.xsa=null;T.$$a=null;T.$=ra;T.dY=hb;return T}function Db(){}function Ja(){this.aIe=new Ef.a(!0);this.PHc=0}function Qb(T){return Yc.call(this,T)||this}function yc(T){this.Qhh=T}function Cd(T){return nb.call(this,T)||this}function bc(T,ra,hb,Eb){var sc=this;this.menuId=
null;this.iRa=-1;this.ZCf=function(){sc.gda()};this.OSi=function(vb){if(!(sc.sa.PLa()||(!df.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||kg.a(vb)||sc.gMa())&&kg.a(vb)&&sc.gMa())){vb=sc.sa.activeCell;var Wc=sc.sa.activeRange,Zd=sc.tableManager.Eg.usedRange;2===sc.iRa&&he.g(sc.tableManager.Eg)&&vb.bottom===Zd.bottom&&(Wc=Wc.G5?new Se.Range(Wc.top-1,Wc.left,Wc.bottom-1,Wc.right,!1,!0):new Se.Range(Wc.top,Wc.left,Wc.bottom-1,Wc.right,!1,!0),vb=Wc.contains(vb)?
vb:Se.Range.hd(Wc.bottom,vb.left),Mf.g(sc.$).ha.updateSelection(Wc,vb,0,3))}};this.gSi=function(vb){kg.a(vb)?(fc.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),sc.$.Bf()):fc.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.fSi=function(){fc.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");sc.$.Bf()};this.hSi=function(vb,Wc){Wc&&
sc.CL(Wc);kg.b(vb,-569193796)&&(Wb.a(sc.$).ud.kE(-569193796),sc.Tqi(vb.Errors[0]))};this.$=T;this.tableManager=ra;this.namedSheetViewPublic=hb;this.frame=this.$.frame;this.ha=Mf.g(this.$).ha;this.sa=this.ha.sa;this.oy=df.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.tableStyleManager=Eb;this.tableStyleManager.oGg(this.ZCf)}function Kb(T){T=ph.call(this,T)||this;var ra=Mf.g(T.$);ra=ra.Rb.Qj(ra.ha.sa.activeCell);tg.a.Fh(ra.VSa)?T.GCd="":T.GCd=ra.VSa;tg.a.Fh(ra.WSa)?T.ECd="":
T.ECd=ra.WSa;ra=T.GV(T.GCd,T.ECd);T.initializeAndShow(Fe.a.instance.fa(742),T.RGj,ra);return T}function ic(T){var ra=zi.call(this,T)||this;ra.$Gj=function(hb,Eb){1===hb&&ra.ILj(Ka.D(ra.uFf(Eb[ic.SKf])))};ra.Gvb=function(hb){hb=ra.cfd(hb);return ra.tcd(hb)};ra.gridView=Mf.g(T);ra.sa=ra.gridView.ha.sa;ra.hpc=ra.gridView.Rb.Qj(ra.sa.activeCell).usedRange;T=ra.GV(ra.hpc.toString());ra.initializeAndShow(Fe.a.instance.fa(733),ra.$Gj,T);return ra}function wb(T,ra){T=ci.call(this,T)||this;T.eBa=ra;return T}
function Wa(T,ra){T=Xg.call(this,T,Fe.a.instance.fa(732))||this;T.eBa=ra;return T}function Xb(T,ra,hb){this.Ozb=!1;this.sharedSheetRange=ra;this.$=T;this.kh=this.$.Ob.$g("UserAction","ConvertToRangeManager");this.tableName=hb}function Gc(T,ra){var hb=this;this.h0d=null;this.i0d=0;this.kj=null;this._state=0;this.moveNext=function(){try{for(hb._state=1;1===hb._state;)hb.Qu=hb.Qu()}catch(Eb){hb.dispose(),hb._state=3}};this.Cf=T;this.mCa=ra;this.Qu=this.ML;this.moveNext()}function zb(T){this.tableName=
null;this.tableName=T}function hc(T,ra,hb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=T;this.optionType=ra;this.isPivotTable=hb}function Uc(T){this.originalRange=null;this.originalRange=T}function jb(T,ra){this.newName=this.oldName=null;this.oldName=T;this.newName=ra}function $a(T,ra,hb){this.description=this.title=this.tableRange=null;this.tableRange=T;this.title=ra;this.description=hb}function I(T,ra,hb,Eb){T=ba.call(this,T,hb)||this;T.hasHeaders=!1;T.isCreation=
!1;T.hasHeaders=ra;T.isCreation=Eb;return T}function ba(T,ra){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=T;this.tableRange=Ka.l(T.Ranges[0],T.SheetName);this.styleIndex=ra}function sa(T){this.autoFilterOptions=null;this.autoFilterOptions=T}function Oa(T,ra){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=T;this.sortType=ra}function qb(T){var ra=pi.call(this)||this;ra.tableStyleManager=null;ra.$=T;ra.Tb();return ra}function Qa(T,ra,hb){var Eb=ag.call(this)||
this;var sc={};Eb.O_i=(sc.height="100%",sc);Eb.yHb={};Eb.ahd=0;Eb.UHa=0;Eb.lastSyncTime=new Date;Eb.Hda=-1;Eb.eO=null;Eb.xma={};Eb.xL=null;Eb.jG={};Eb.XSa={};Eb.Prc=null;Eb.lff=!1;Eb.isInitialized=!1;Eb.s6a=!1;Eb.pAb=!1;Eb.Suc=null;Eb.GUe=!1;Eb.zMb=!1;Eb.dzc=!1;Eb.Syh=function(){Eb.ric()?Eb.$.ea.dJd(Eb.Syh):Eb.EKa("tableStyleManagerInitialization")};Eb.yxf=function(vb,Wc,Zd){var uf=!1,If=df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1);if(kg.a(vb))-315732528!==
vb.Errors[0].MessageId&&(fc.ULS.sendTraceTag(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}",lh.a.Wc(vb.Errors)),Eb.GAd(null,Wc,Zd));else if(fc.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(vb=vb.Result)&&vb.TableStyleItems.length){Zd=60<vb.TableStyleItems.length;var ng=!1,gg=!1;if(Eb.xL)for(var Wh=0;60>Wh;++Wh){var di=vb.TableStyleItems[Wh],uj=Eb.xL.TableStyleItems[Wh];if(If&&di.HasStyleViolations!==
uj.HasStyleViolations){uf=gg=!0;break}for(var qj=0;9>qj&&!(qj>=di.TableStyleElementsList.length);qj++)if(!tg.a.equals(di.TableStyleElementsList[qj].BackgroundColor,uj.TableStyleElementsList[qj].BackgroundColor,!1)){uf=ng=!0;break}}else for(Eb.UHa=0,Wh=El(vb.TableStyleItems),di=Wh.next();!di.done;di=Wh.next())di=di.value,di.TableStyleElementsList&&di.TableStyleElementsList.sort(Mb.Mmf),Eb.jG[di.Name]=di;if(ng||gg)for(ng=0;60>ng;++ng)gg=vb.TableStyleItems[ng],Eb.jG[gg.Name]=gg;if(Zd&&Eb.xL)for(fc.ULS.sendTraceTag(42821700,
0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - {0}",vb.TableStyleItems.length-60),uf=!0,Zd=60;Zd<vb.TableStyleItems.length;++Zd)ng=vb.TableStyleItems[Zd],ng.Name in Eb.jG||ng.TableStyleElementsList&&ng.TableStyleElementsList.sort(Mb.Mmf),Eb.jG[ng.Name]=ng;if(Gi.a(Eb.jG).length!==vb.TableStyleItems.length)for(uf=!0,ng=Zd=60;ng<Eb.xL.TableStyleItems.length;)Zd>=vb.TableStyleItems.length?delete Eb.jG[Eb.xL.TableStyleItems[ng].Name]:Zd>=vb.TableStyleItems.length||!tg.a.equals(vb.TableStyleItems[Zd].Name,
Eb.xL.TableStyleItems[ng].Name,!1)?delete Eb.jG[Eb.xL.TableStyleItems[ng].Name]:++Zd,++ng;Eb.xL=vb;Eb.jNf(uf);uf&&Eb.cZc();If&&Wc&&("accessibility"===Wc?(Eb.zMb=!1,Eb.dzc=!0):Eb.dzc=!1);Eb.lff||(Eb.Umi()&&Eb.$.Bf(),Eb.lff=!0);Eb.ahd=0;Eb.pAb||Eb.GUe?If&&Eb.dzc&&Eb.raiseEvent("RefreshTableStyleGallery"):(Eb.raiseEvent("RefreshTableStyleGallery"),Eb.GUe=!0)}};Eb.GAd=function(){fc.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");Eb.ahd++;5>Eb.ahd&&Yb.a.instance.create(function(){Eb.EKa("getTableStylesFailed")},
1E3,Ec.a.P7f,!0,!0)};Eb.YCf=function(){Eb.pAb&&(Eb.pAb=!1,Eb.Suc&&Eb.Suc(),Yb.a.instance.create(function(){Eb.EKa("galleryMenuClosed")},1E3,Ec.a.P7f,!0,!0))};Eb.$=T;Eb.Ra=ra;Eb.tableManager=hb;Eb.$.da.Ga(329,Eb);Eb.yZc=Eb.jvb();Eb.$.Ka.KFa(Eb.YCf);return Eb}function ib(T,ra,hb,Eb,sc,vb){this.headerRow=T;this.totalRow=ra;this.firstCol=hb;this.lastCol=Eb;this.oS=sc;this.Pha=vb}function Mb(){}function Jb(){}function Zb(T){var ra=$h.call(this)||this;ra.tableManager=null;ra.$=T;ra.Tb();return ra}function ub(T){var ra=
hd.call(this,Mf.g(T))||this;ra.Bpb=null;ra.Ezc=null;ra.$0=null;ra.Dpb=null;ra.Ppe=!1;ra.s$d=null;ra.MRb=0;ra.E5b=null;ra.t0b=function(){var hb={},Eb=ra.lgd(),sc;for(sc in Eb){var vb=Eb[sc];if(vb){var Wc=ra.FYh(vb);if(Wc){if(Wc in ra.uFa){var Zd=ra.uFa[Wc];if(Zd.vB){Zd.Zn.equals(vb)||(Zd.Zn=vb);delete ra.uFa[Wc];hb[Wc]=Zd;continue}}(Zd=zc.createInstance(Mf.g(ra.$),vb,ra.ZHh(),ra))?hb[Wc]=Zd:fc.ULS.sendTraceTag(537151239,0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",
vb.pB(!1))}}}ra.u2b(null,null);ra.rQb=hb};ra.u2b=function(){var hb=ra.uFa,Eb;for(Eb in hb){var sc=Eb,vb=hb[Eb];vb&&(vb.dispose(),delete ra.uFa[sc])}ra.rQb={}};ra.WKf=function(){ra.u2b(null,null);ra.t0b(null,null)};ra.onFocus=function(){ra.s$d=Mf.g(ra.$).ha.sa.activeCell};ra.o6=function(){ra.$.isEditMode&&ra.Rh(null,null)};ra.Rh=function(){!ra.Ppe&&bb.c(ra.$,ra.gridView.ha.sa.activeCell)&&ra.usi()};ra.HN=function(){ra.eyb(1);ra.$.ea.Wn(ra.HN)};ra.pGb=function(){ra.Ppe=!0;ra.Ezc=new Za(ra.$)};ra.$=
T;ra.gridView=Mf.g(ra.$);ra.$.da.Ga(66,ra);ra.rQb={};ra.t0b(null,null);ra.$.xa&&ra.$.xa.Bg(ra.WKf);ra.Pne(ra.t0b);ra.$.ea.N2(ra.o6);ra.gridView.ha.zJ(ra.Rh);ra.$.isEditMode&&ra.Rh(null,null);return ra}function Za(T){var ra=oi.call(this,document.createElement("div"))||this;ra.cR=!1;ra.pFf=!1;ra.bod=!1;ra.NTc=!1;ra.PJb=null;ra.Rh=function(){bb.c(ra.$,ra.gridView.ha.sa.activeCell)?(ra.QLa=!0,ra.drb(!1)):(ra.QLa=!1,ra.k5=!1,ra.ybg())};ra.tt=function(){ra.QLa?ra.drb(!0):ra.k5=!1};ra.ouf=function(){ra.NTc=
!0;ra.QLa&&(ra.k5=!1)};ra.onContentReady=function(){ra.$.isEditMode?bb.c(ra.$,ra.gridView.ha.sa.activeCell)&&(ra.QLa=!0,ra.drb(!1)):ra.k5=!1};ra.RDb=function(){ra.NTc=!1;ra.QLa?ra.drb(!1):ra.k5=!1};ra.zf=function(hb,Eb){ra.QLa&&(hb=ra.gridView.spc(Eb.nd.block.qe.BlockCachePosition.PaneType).uG(Eb.nd.hash))&&(hb.NJd(ra.aLa),hb.QVc(ra.aLa))};ra.aLa=function(){ra.MQf()};ra.$=T;ra.gridView=Mf.g(ra.$);ra.parentElement=ra.domElement;ra.parentElement.className=vc.lsh;ra.MKa=ra.gridView.Nj;ra.QLa=!0;ra.Q$h();
ra.JLg();ra.drb(!1);fc.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ");return ra}function vc(){}function zc(T,ra,hb,Eb){var sc=ji.call(this,T)||this;sc.O7f=[6];sc.I7f=[26];sc.Tr=null;sc.Aic=!1;sc.Dzb=!1;sc.aba=null;sc.qt=null;sc.onPointerDown=function(vb){if(1!==sc.$.Ka.xH())return!0;vb=Sf.a(sc.$).je(vb);if(sc.vB)return!0;var Wc=uh.a(sc.$).Tod||uh.a(sc.$).Mq();if(sc.Iqd||Wc)return sc.Ibb(),!0;sc.qt=sc.Zn;sc.wId();sc.ikd();Wc=2===vb.yb&&vb.Tn===Sys.UI.MouseButton.leftButton;
var Zd=3===vb.yb;if(Wc||Zd)vb=sc.ha.Vn(vb.clientPoint,vb.Lb,5,void 0,void 0,!0),vb||(vb=sc.qt),sc.Dzb=Wc,sc.Aic=Zd,sc.qt=sc.r3e(vb),sc.ikd(),Wc?sc.X7i():Zd&&sc.K8i(),qh.b(sc.$,!0);return!0};sc.Sh=function(vb){vb=Sf.a(sc.$).je(vb);if(!sc.vB)return!1;if(vb=sc.Dzb?sc.ha.Vn(vb.clientPoint,vb.Lb,5,void 0,void 0,!0):sc.ha.Vn(vb.clientPoint,vb.Lb,5,!0,!1,!0))vb=sc.r3e(sc.WYa(vb)),sc.X0b(vb.bottomRight),sc.qt.equals(vb)||(sc.qt=vb,sc.LHb(!1),sc.wId(!1),sc.ikd(!1),sc.w6h(),sc.Cb.update(!1)),sc.jQj(sc.qt);
return!0};sc.Of=function(vb){Sf.a(sc.$).je(vb);if(!sc.vB)return!1;sc.resizeTable();sc.Ibb();return!0};sc.jFb=function(vb){Sf.a(sc.$).je(vb);if(!sc.vB)return fc.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;sc.resizeTable();sc.Ibb();return!0};sc.yca=function(vb){Sf.a(sc.$).je(vb);sc.Ibb();return!0};sc.juf=function(){sc.vB&&sc.Ibb()};sc.gridView=ra;sc.$=ra.$;sc.tableManager=Eb;sc.ha=ra.ha;sc.Cb=ra.Cb;sc.parentElement=T;sc.qRg();
Da.a.rp||Da.a.Bka||Oe.a.instance.pa(Df.a.pointerDown,sc.aba,sc.onPointerDown);sc.Zn=hb;sc.Iqd=!1;sc.OLc=!1;sc.tableManager.IDg(sc.juf);return sc}function kd(T){var ra=rf.call(this)||this;ra.$=T;ra.Tb();return ra}function wa(T){var ra=this;this.Jg=function(){ra.skf();ra.$.ea.Wn(ra.Jg)};this.$=T;this.v7f={};this.KUd={};var hb=df.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",Eb=this.NZe(hb);Eb?(this.pme(Eb),this.$.ea.sh?this.skf():
T.ea.Fl(this.Jg),this.$.da.Ga(388,this)):fc.ULS.sendTraceTag(537151263,0,15,"window[{0}].icons returned null.",hb)}function Na(){}function Vb(T){var ra=Re.call(this)||this;ra.sparklineManager=null;ra.$=T;ra.Tb();return ra}function pc(T,ra){T=hd.call(this,T)||this;ra.Ga(240,T);return T}function hd(T){var ra=Jg.call(this)||this;ra.HT=[];ra.zf=function(Zd,uf){var If,ng=uf.nd.block;Zd=!1;if(ng.mk&&ng.state&1&&(If=ra.view.Tf(uf.nd.block.qe.BlockCachePosition.PaneType).uG(uf.nd.hash))){ng=ra.xGd(ng.Be);
if(If=If.uf)for(var gg=ra.HT.length-1;0<=gg;gg--)If.contains(ra.HT[gg].bottomRight)&&(Array.removeAt(ra.HT,gg),Zd=!0);if(ng)for(If=0,gg=ng.length;If<gg;If++)ra.rangeList.push(nc.a.RQ(ng[If])),Zd=!0;Zd&&(uf=(df.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?ra.view.spc(uf.nd.block.qe.BlockCachePosition.PaneType):ra.view.n3).uG(uf.nd.hash),ra.raiseEvent(hd.yGd,new cf.a(uf)))}};ra.Sm=function(){ra.FHb()};ra.Go=function(){ra.HT=[]};ra.hje=T;var hb=T.Ea;hb.Us(ra.zf);
hb.Nga(ra.zf);hb.lZb(ra.zf);hb.PG(ra.Sm);T.$.xa.AJ(ra.Go);T.$.Hb.AJ(ra.Go);hb=El(T.yn);for(var Eb=hb.next();!Eb.done;Eb=hb.next()){Eb=El(Eb.value);for(var sc=Eb.next();!sc.done;sc=Eb.next()){sc=El(sc.value);for(var vb=sc.next();!vb.done;vb=sc.next()){vb=vb.value;var Wc=T.Ea.sl(vb.hashCode);ra.zf(ra,new oc.a(new Dd.a(Wc,vb.hashCode),null))}}}return ra}function Ud(T){var ra=Hf.call(this)||this;ra.$=T;ra.Tb();return ra}function Zc(T,ra){var hb=this;this.xW=function(){hb.Od||hb.Ipe()};this.Od=!1;this.oZ=
ra.PU;this.ariaLiveNotifier=T;this.K_d=new Ad(T,ra);this.oZ&&this.oZ.lR?this.Ipe():this.Ck()}function Ob(T,ra,hb){var Eb=this;this.xyf=function(){Eb.K_d.ILf();Eb.ariaLiveNotifier.setEnabled(!0)};this.$=ra;this.ariaLiveNotifier=T;this.K_d=new Ad(T,ra);this.r$b=hb.Nfd(this.$);this.r$b.fFg(this.xyf)}function Ad(T,ra){this.$=ra;this.ariaLiveNotifier=T}function we(T){var ra=jf.call(this)||this;ra.$=T;ra.Tb();return ra}function Wd(T,ra,hb,Eb,sc){var vb=this;this.gridReadoutNotifier=null;this.Cab=!1;this.zsa=
this.uob=null;this.Zca=function(){df.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!vb.$?fc.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):Mf.g(vb.$).isEditing||vb.g0b.Zq()};this.iFi=function(){if(!Mf.g(vb.$).ha.Oa.Kpd){var Wc=vb.zHh();vb.readText(Wc.returnValue,Wc.activeCell)}};this.Cp=function(){var Wc=vb.activeCell;vb.readText("Editing",Wc);df.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||
Wc&&Wc.XKa&&!Mf.g(vb.$).s6e||vb.g0b.cancel()};this.kd=function(){df.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!vb.$?fc.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):(vb.Zca(),vb.Cab&&Mf.g(vb.$).inRangePicker&&1===ce.a.Ub&&(null===vb.uob?vb.uob=Yb.a.instance.create(vb.VGd,Wd.KTc,"readSelectedRanges"):vb.uob.Zq()))};this.$=ra;this.ariaLiveNotifier=T;this.sparklineManager=Eb;this.tableManager=hb;this.uD=new qc;
this.p6a=ne.p6a();this.Cab=df.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.p6a&&(df.EwaSettings.Fb()?this.gridReadoutNotifier=sc:this.gridReadoutNotifier=ra.da.Aa(244),fc.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),Wd.KTc=700);this.g0b=Yb.a.instance.create(this.iFi,Wd.KTc,Ec.a.Llj,!1);this.Ck()}function qc(){this.activeItemName=null;this.lgf=!1;this.tableName=null;this.b0a=
0;this.Azc=!1}function md(){}function bd(T){switch(T){case 1:return 1425;case 2:return 1426;case 3:return 1427;case 4:return 1428;case 5:return 1429;case 6:return 1430;case 7:return 1431;case 8:return 1432;case 9:return 1433;case 10:return 1434;case 11:return 1435;case 12:return 1436;case 13:return 1437;case 14:return 1438;case 15:return 1439;case 16:return 1440;case 17:return 1441;case 18:return 1442;case 19:return 1443;case 20:return 1444;case 21:return 1445;case 22:return 1448;case 23:return 1446;
case 24:return 1447;case 25:return 1449;case 26:return 1450;case 27:return 1451;case 28:return 1452;default:return 1453}}function Xc(T){var ra=Sd.call(this)||this;ra.$=T;ra.Tb();return ra}function ne(T,ra){this.s0=this.XW=this.hO=null;this.Yia=ra;this.W8g(T);this.$Zi();df.EwaSettings.Fb()&&T.da.Ga(244,this)}function ed(T){var ra=zh.call(this)||this;ra.$=T;ra.Tb();return ra}function nd(T,ra,hb){var Eb=this;this.Vuf=function(sc,vb){Eb.zLf(vb.Rd.command)};this.$=T;this.Xea=document.createElement("div");
this.Xea.setAttribute(re.a.RP,re.a.Mj);this.Xea.className=hg.a.o9c;ra.insertBefore(this.Xea,hb);this.hga=document.createElement("div");this.hga.setAttribute(re.a.RP,re.a.Mj);this.hga.className=hg.a.o9c;ra.insertBefore(this.hga,this.Xea);this.Vrg=Fe.a.instance.Wa(2);this.iha=document.createElement("div");this.iha.setAttribute(re.a.Td,re.a.esa);this.iha.setAttribute(re.a.gsa,re.a.kob);this.iha.className=hg.a.o9c;ra.insertBefore(this.iha,this.hga);this.register();this.$.da.Ga(211,this)}function Ub(T,
ra){ra&&(T.append(ra),T.append(Hc.Rud))}function Hc(T){this.Fuc=T||""}function pd(T){var ra=Qf.call(this)||this;ra.$=T;ra.Tb();return ra}function jc(T){var ra=Vf.call(this)||this;ra.gtd=null;ra.$=T;fc.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created");return ra}function vd(){return jd.call(this)||this}function ae(T){var ra=hh.call(this)||this;ra.$=T;ra.Tb();return ra}function $d(T){var ra=Bc.call(this,document.documentElement,T)||this;ra.bC=0;ra.jNg=[Lc.a.iCe,Lc.a.syd,Lc.a.Ndc,Lc.a.K9f,
Lc.a.OLd,Lc.a.eZc,Lc.a.Pbd,Lc.a.x4e,Lc.a.nYc,Lc.a.Kzc,Lc.a.CBj,Lc.a.Ycc,Lc.a.s_c,Lc.a.cub,Lc.a.yQd,Lc.a.z_c,Lc.a.Q5f,Lc.a.nkf,Lc.a.JYc];ra.jVj=[Lc.a.Ndc,Lc.a.efg,Lc.a.dfg,Lc.a.ffg];ra.e0i=[Lc.a.Ndc,Lc.a.rIf,Lc.a.sIf,Lc.a.vIf];ra.iVg=[Lc.a.PUe,Lc.a.w4e,Lc.a.Nbd,Lc.a.Kbd];ra.F_i=[Lc.a.iCe,Lc.a.syd,Lc.a.eZc,Lc.a.Pbd,Lc.a.nYc,Lc.a.Kzc,Lc.a.Ycc,Lc.a.s_c,Lc.a.cub,Lc.a.yQd,Lc.a.OHf,Lc.a.z_c,Lc.a.JYc];ra.P_i=[Lc.a.Ycc,Lc.a.UUe];var hb=Fe.a.instance.Wa(251);ra.Epj=ra.$.shortcutKeyManager.kKa(hb);ra.mode=0;
T.da.Ga(15,ra);Rc.TaskExtensions.Ba(cc.GetServiceTaskFactory.Va(T.da,21,137,1),function(Eb){Eb=Eb.result;Eb.io(uc.a.Amb);Eb.Rl(uc.a.Amb,ra.RIb)},T.la);return ra}function Bc(T,ra){var hb=gf.call(this,T)||this;hb.b9=[];hb.o$d=null;hb.RIb=function(Eb){var sc="forward";Eb.Values[dc.a.direction]?sc=Eb.Values[dc.a.direction].toLowerCase():fc.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");Eb=0;var vb=!0;"backward"===sc?(Eb=hb.osd.length-1,vb=!1):"forward"===sc?(Eb=0,vb=!0):fc.ULS.sendTraceTag(537166663,
0,15,"Received unknown direction to resume focus: {0}",sc);hb.jqf(vb,Eb,!1)};hb.wyf=function(){hb.b9=[]};hb.vya=function(Eb){if(-411645385===hb.$.shortcutKeyManager.cu(Eb,!0)&&hb.Pdf()){var sc={};hb.$.Ka.Xb(new yd.a(-411645385,1,hb.$.ed,6,null),(sc.event=Eb,sc),Eb);Eb.stopPropagation()}};hb.cNi=function(Eb){hb.xca(Eb)};hb.wb=ra;hb.Jc.ka("keydown",hb.cNi);hb.Jc.ka("keyup",hb.vya);nf.a(ra).AGg(hb.wyf);ya.a(ra.ya,27)&&Rc.TaskExtensions.Ba(cc.GetServiceTaskFactory.Va(ra.da,21,137,1),function(Eb){Eb=Eb.result;
Eb.io(uc.a.i8e);Eb.Rl(uc.a.i8e,hb.RIb)},ra.la);return hb}function Hd(){this.pmb=this.xee=this.tb=null;this.Am=!1}function xb(T,ra,hb,Eb,sc,vb,Wc){this.zgb={};this.f2=T;this.Nrg=ra;this.Wqa=new tf(Nc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),Nc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.Uw.Xlc);this.Ara=new tf(Nc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),Nc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.Uw.Xlc);this.hug=hb;this.Aje=Eb;this.xyg={};this.zT=new Kf;this.Oog=sc;this.EUb="";this.Zv=vb;this.S5d=Wc;this.iug=Nc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25);return this}function rd(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}function tf(T,ra,hb){this.task=null;this.Xec=T;this.Ryi=ra;
this.taskManager=hb;this.retryCount=this.oyb=0;this.gPc=this.cBb=null}function Kf(){this._state=0;this.Abe=this.Cbe=this.Bbe=null;this.state=this.lie=0;this.JKc=!1;return this}function Ff(T,ra,hb,Eb,sc){this.Vpg=6E4;this.r9e="inactive";this.fke="active";this.wT=!0;this.se=T;this.Sog=ra;this.mJc=hb;this.vXb=Eb;this.Za=new Wf.a;sc&&this.UDj();this.t$d=this.i_e()}function Pe(T,ra){this.zgb={};this.f2=T;this.rlb=new Xe(ra,this.PCb.Xlc,"GetMoreInfo");this.Qo=new Kd;return this}function Xe(T,ra,hb){this.uWb=
this.Wi=null;this.ZPc=0;this.ovg=T;this.se=ra;this.U4d=hb}function de(T,ra,hb,Eb,sc,vb,Wc,Zd){this.La=T;this.Mg=ra;this.tkg=hb;this.x1=Eb;this.se=sc;this.mJc=vb;this.ppg=Wc;this.iXb=Zd}function Kd(){this._state=0;this.LRc=this.Qkb=null;this.state=0;this.JKc=this.v8d=!1;return this}function pe(){this._state=0}function Lf(){this.zgb={}}function Be(){this.tb=null}function eg(){this.gWa=null}function Jc(T){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",Nc.AFrameworkApplication.ga.appSettings.RoamingServiceHandlerWebServiceBase||
"",T,Nc.AFrameworkApplication.oj)}function Yd(T){var ra=new lc.a;Nc.AFrameworkApplication.Jd.El(Jc(T),1,null,null,!0,2,function(hb){200===hb.data.httpStatus?ra.setResult("true"===hb.data.ke.toLowerCase()):ra.setResult(!1)},function(){ra.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return ra.task}function Ge(T,ra){this.La=T;this.mQb=ra}function ud(T){var ra=Gf.call(this,!1,!1,!0)||this;ra.mQb=T;return ra}function Ye(T,ra){this.ID=T;this.type=ra}function mf(T,ra){this.value=T;this.contextId=
ra}function xe(T,ra,hb,Eb,sc,vb,Wc,Zd){this.type=T;this.startTime=null==hb||void 0==hb.value?new mf(hb,null):hb;this.endTime=null==Eb||void 0==Eb.value?new mf(Eb,null):Eb;null!=sc&&void 0!=sc.value||new mf(sc,null);null!=vb&&void 0!=vb.value||new mf(vb,null);this.operationType=Zd}function Qe(T){this.ID=T}function jg(){this.Qe=[];this.Vnb=[];this.wWc=0;this.duration=this.startTime=null;this.J7b={};this.ewd=this.Jwd=this.UXc=-1}b.r(C);var je=b(0),pf=b(82),qg=b(149),Gf=qg.a;Am(ud,Gf);ud.prototype.start=
function(){var T={},ra={};T=(ra.id="AccessibilitySettingsDialog",ra.bodyControls=(T.tooltipPersistenceEnabled=this.mQb.A8e,T),ra);this.initializeAndShow("",Object(pf.a)(this,this.Lgj,"resultHandler"),T)};ud.prototype.Lgj=function(T,ra){1===T&&(this.mQb.A8e=ra.tooltipPersistenceEnabled)};Object(je.a)(ud,"AccessibilitySettingsDialog",qg.a,[]);var Mg=b(107),dg=b(27);Ge.prototype.Qg=function(){this.La.fc(dg.a.byj,Mg.a.frame,Object(pf.a)(this,this.cyj,"showAccessibilitySettingsDialogHandler"))};Ge.prototype.cyj=
function(){(new ud(this.mQb)).start();return 32};Object(je.a)(Ge,"AccessibilitySettingsDialogActor",null,[615]);var lc=b(161),Nc=b(4),Nd=b(165);eg.prototype.jsi=function(){var T=this,ra=new lc.a;if(this.gWa)ra.setResult(this.gWa);else if(this.Zff()){var hb=Yd("getHoverableRibbonTooltipIsEnabled");hb.continueWith(function(){T.gWa=hb.result;Nd.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(hb.result);ra.setResult(hb.result)},8)}else ra.setResult(!1)};eg.prototype.Zff=
function(){var T=Nc.AFrameworkApplication.ga.ra("IsRoamingServiceEnabled"),ra=Nc.AFrameworkApplication.ga.ra("IsAnonymousUser");return T&&!ra};Ek.Object.defineProperties(eg.prototype,{A8e:{configurable:!0,enumerable:!0,get:function(){return!!this.gWa},set:function(T){T!==this.gWa&&(this.gWa=T,Nd.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(T),this.Zff()&&Nc.AFrameworkApplication.Jd.El(Jc("saveHoverableRibbonTooltipIsEnabled"),2,T.toString().toLowerCase(),null,
!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}}});Object(je.a)(eg,"AccessibilitySettingsInfo",null,[521]);var le=b(255),ke=b(171);Be.prototype.ei=function(T){var ra=this;this.tb=T;this.tb.register(eg,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Oc(function(){return new eg}).Hc();this.tb.register(Ge,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Oc(function(){return new Ge(Nc.AFrameworkApplication.Ib,
ra.tb.Kh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))}).Hc()};Be.prototype.init=function(){var T=this.tb.Kh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ra=this.tb.Kh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");T&&ra?(ra.Qg(),T.jsi()):ke.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")};Be.prototype.dispose=function(){};Be.main=function(){le.a.instance.hj(new Be)};
Ek.Object.defineProperties(Be.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.AccessibilitySettings"}}});Object(je.a)(Be,"AccessibilitySettingsPackage",null,[4,5]);var xd=b(615),fc=b(14);Lf.prototype.fzg=function(T){this.zgb[T.id.toString()]=T};Lf.prototype.lDi=function(T){var ra=this.zgb,hb;for(hb in ra)ra[hb].notify(T,!1);this.zgb={}};Lf.prototype.Q1i=function(T,ra){ra&&this.fzg(ra);return this.nBf(T,ra)};Lf.prototype.W7c=function(T){this.lDi(T)};Lf.prototype.GKe=
function(T,ra){T.notify(ra,!0)};Object(je.a)(Lf,"AEventEmitter",null,[942]);var fe;(function(T){T[T.notStarted=0]="notStarted";T[T.waiting=1]="waiting";T[T.shouldRetry=2]="shouldRetry";T[T.complete=3]="complete"})(fe||(fe={}));Object(je.b)("EventResultState",fe);Ek.Object.defineProperties(pe.prototype,{state:{configurable:!0,enumerable:!0,get:function(){return this._state},set:function(T){var ra={};fc.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",(ra.OldState=fe[this._state],
ra.NewState=fe[T],ra),"ResultType",this.z1e());this._state=T}}});Object(je.a)(pe,"AEventResult",null,[962]);Am(Kd,pe);Kd.prototype.z1e=function(){return"GetMoreInfo Result"};Ek.Object.defineProperties(Kd.prototype,{aS:{configurable:!0,enumerable:!0,get:function(){return this.Qkb}},boa:{configurable:!0,enumerable:!0,get:function(){return this.LRc}},dci:{configurable:!0,enumerable:!0,get:function(){return this.v8d}}});Object(je.a)(Kd,"GetMoreInfoResult",pe,[963,962]);var oa=b(80),fb=b(39),Rb=b(898),
dc=b(390),uc=b(168),Bd=b(741),Od=b(640);de.prototype.c7i=function(){this.c9a.fc(dg.a.openUrlInNewTab,Mg.a.frame,Object(pf.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.c9a.fc(dg.a.cPa,Mg.a.frame,Object(pf.a)(this,this.cPa,"openDocumentUrl"));Nc.AFrameworkApplication.AQ?this.Plf():this.c9a.Te(dg.a.k7b,Mg.a.frame,Object(pf.a)(this,this.k7b,"documentLoaded"),96)};de.prototype.openUrlInNewTab=function(T,ra,hb,Eb,sc){sc&&sc.MenuItemId&&(T={},fc.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",
(T.Id=sc.SourceControlId,T.AppType=Od.a[this.kca],T)),fb.a.jf(sc.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};de.prototype.cPa=function(T,ra,hb,Eb,sc){if(sc&&sc.MenuItemId){var vb=Nc.AFrameworkApplication.ga.ra("WacInTabOpenMRUIsEnabledForUiHost"),Wc=Nc.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures");fc.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",vb,Wc);if(vb&&Wc){T={};fc.ULS.sendTraceTag(592237458,
202,50,"Opening new tab {0}",(T.Id=sc.SourceControlId,T.AppType=Od.a[this.kca],T));sc=sc.MenuItemId.toString();var Zd={};Zd[dc.a.ZPa]="1";Zd[dc.a.documentUrl]=sc;Zd[dc.a.reason]=Bd.a.open;fc.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");Nc.AFrameworkApplication.HV().execute(function(uf){uf.Hj(uc.a.Wta,Zd)})}else this.openUrlInNewTab(T,ra,hb,Eb,sc)}return 32};de.prototype.k7b=function(){this.Plf();return 32};de.prototype.$ba=function(T,ra,hb){hb=void 0===
hb?"":hb;if(ra&&ra.pF){var Eb=Rb.a[ra.status];ra=ra.pF.getTime();var sc=this.Gw()-ra,vb={};fc.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",(vb.Caller=T,vb.RequestStatus=Eb,vb.ElapsedMs=sc,vb.StartTime=ra,vb.Notes=hb,vb))}else hb={},fc.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",(hb.Caller=T,hb))};de.prototype.Plf=function(){var T=Nc.AFrameworkApplication.ga.ra("QPGVCI"),ra=oa.a.oB(document.URL,"wdNewAndOpenCt",
T);if(ra){ra=parseInt(ra);var hb=oa.a.oB(document.URL,"wdPreviousSession",T);T=oa.a.oB(document.URL,"wdPreviousCorrelation",T);var Eb=Nc.AFrameworkApplication.ga.ra("NAOPLP");if(Nc.AFrameworkApplication.AQ){var sc=Nc.AFrameworkApplication.AQ.getTime();if(!ra||ra>sc)Eb={},fc.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",(Eb.ClickTimestamp=ra,Eb.DocumentLoadedTime=sc,Eb.SessionId=hb,Eb.Correlation=T,Eb));else{var vb={};fc.ULS.sendTraceTag(5849683,
202,Eb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",(vb.ClickToLoadTime=sc-ra,vb.ClickTimestamp=ra,vb.SessionId=hb,vb.Correlation=T,vb))}}else sc={},fc.ULS.sendTraceTag(5849681,202,Eb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",(sc.ClickTimestamp=ra,sc.SessionId=hb,sc.Correlation=T,sc))}};de.RM=function(){return new de(new xd.a(function(){return Nc.AFrameworkApplication.Ib}),new xd.a(function(){return Nc.AFrameworkApplication.Jd}),
new xd.a(function(){return Nc.AFrameworkApplication.ta}),new xd.a(function(){return Nc.AFrameworkApplication.ta.Qa.Sj}),new xd.a(function(){return Nc.AFrameworkApplication.Qi}),function(){return(new Date).getTime()},new xd.a(function(){return Nc.AFrameworkApplication.ta.Qa.sW}),new xd.a(function(){return Nc.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage}))};Ek.Object.defineProperties(de.prototype,{c9a:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},iDb:{configurable:!0,
enumerable:!0,get:function(){return this.Mg.value}},crf:{configurable:!0,enumerable:!0,get:function(){return this.tkg.value}},kca:{configurable:!0,enumerable:!0,get:function(){return this.x1.value}},Xlc:{configurable:!0,enumerable:!0,get:function(){return this.se.value}},Gw:{configurable:!0,enumerable:!0,get:function(){return this.mJc}},sW:{configurable:!0,enumerable:!0,get:function(){return this.ppg.value}},supportsGetMoreInfoForPersonalStorage:{configurable:!0,enumerable:!0,get:function(){return this.iXb.value}}});
Ek.Object.defineProperties(de,{instance:{configurable:!0,enumerable:!0,get:function(){return de.Ma||(de.Ma=de.RM())}}});de.Ma=null;Object(je.a)(de,"NewAndOpenCommonHelpers",null,[941]);var Td=b(108);Xe.prototype.$Hg=function(){this.ZPc=this.Vbb+1};Xe.prototype.gLd=function(T){this.Wi&&(this.se.$p(this.Wi),this.Wi=null);T&&(this.ZPc=0)};Xe.prototype.bEj=function(T){var ra=this.hJj;0<=ra?(this.$Hg(),this.gLd(!1),this.Wi=new Td.a(4,1,ra,T,107),this.se.Sg(this.Wi)):(this.gLd(!0),T={},fc.ULS.sendTraceTag(5849676,
202,50,"Retries exhausted {0}",(T.Action=this.U4d,T)))};Ek.Object.defineProperties(Xe.prototype,{Vbb:{configurable:!0,enumerable:!0,get:function(){return this.ZPc}},hJj:{configurable:!0,enumerable:!0,get:function(){return this.Vbb>=this.qXf.length?-1:this.qXf[this.Vbb]}},qXf:{configurable:!0,enumerable:!0,get:function(){if(!this.uWb){var T=(this.ovg.value||"0").split(",");this.uWb=[];for(var ra=0;ra<T.length;ra++){var hb=parseInt(T[ra]);isNaN(hb)?(hb={},fc.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",
(hb.Action=this.U4d,hb.Entry=T[ra],hb))):Array.add(this.uWb,hb)}}return this.uWb}}});Object(je.a)(Xe,"RetryHelper",null,[]);var Ze=b(41),vf=b(29);Am(Pe,Lf);Pe.prototype.oxi=function(){this.Jvd("Document opened")};Pe.prototype.k7g=function(T){var ra=this;return function(){ra.Jvd(T,!0)}};Pe.prototype.nBf=function(T,ra){ra=void 0===ra?null:ra;var hb={};fc.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",(hb.Trigger=T,hb));3===this.Qo.state?(ra&&this.GKe(ra,this.Qo),ra={},
fc.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",(ra.Trigger=T,ra))):this.Jvd(T);return this.Qo};Pe.prototype.Jvd=function(T,ra){this.rlb.gLd(!(void 0===ra?0:ra));1===this.Qo.state?(ra={},fc.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",(ra.Trigger=T,ra.RetryIndex=this.rlb.Vbb,ra))):(ra={},fc.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",(ra.Trigger=T,ra.RetryIndex=this.rlb.Vbb,ra)),this.Qo.state=1,ra=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.PCb.sW,Nc.AFrameworkApplication.oj),this.PCb.iDb.K9(ra,1,null,null,[Pe.yde,Pe.the],!1,5,this.q6g(),this.p6g(T),null))};Pe.prototype.q6g=function(){var T=this;return function(ra){var hb=!1,Eb=!1,sc=!1;if(Nc.AFrameworkApplication.ga.ra("GetMoreInfoDataFromResponseBody"))if(ra.data.ke){var vb=Ze.d(ra.data.ke);var Wc=vb.dv;vb.returnValue?Wc?(sc=!0,T.Qo.LRc=Wc.StorageServiceDisplayName,T.Qo.Qkb=Pe.Ehf(Wc.PersonalFileStorageUrl)?Wc.PersonalFileStorageUrl:"",""===T.Qo.aS&&"SharePointOnlineConsumer"===
Nc.AFrameworkApplication.ga.Ua("FileSource")&&(T.Qo.Qkb=oa.a.ida(Nc.AFrameworkApplication.breadcrumbFolderUrl)),hb=""===T.Qo.aS&&""!==T.Qo.boa):fc.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):fc.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else fc.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");
sc||((Wc=ra.data.responseHeaders)?(T.Qo.LRc=(Wc[Pe.the]||"").toString(),hb=(Wc[Pe.yde]||"").toString(),T.Qo.Qkb=Pe.Ehf(hb)?hb:"",""===T.Qo.aS&&"SharePointOnlineConsumer"===Nc.AFrameworkApplication.ga.Ua("FileSource")?(T.Qo.Qkb=oa.a.ida(Nc.AFrameworkApplication.breadcrumbFolderUrl),hb=""===T.Qo.aS&&""!==T.Qo.boa):hb=""===hb&&""!==T.Qo.boa):(fc.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Eb=!0));sc=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
T.rlb.Vbb,Eb,hb,sc);T.PCb.$ba("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",ra.data,sc);T.IXf(3,hb,Eb)}};Pe.prototype.p6g=function(T){var ra=this;return function(hb){ra.PCb.$ba("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",hb.data,"Failure");ra.IXf(2);ra.rlb.bEj(ra.k7g(T))}};Pe.prototype.IXf=function(T,ra,hb){this.Qo.state=T;this.Qo.v8d=void 0===ra?!1:ra;this.Qo.JKc=void 0===hb?!1:hb;this.W7c(this.Qo)};Pe.RM=function(){return new Pe(new xd.a(function(){return de.instance}),
new xd.a(function(){return Nc.AFrameworkApplication.oSh}))};Pe.Ehf=function(T){if(!T)return fc.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(vf.a.Ul(T).startsWith("https://"))return!0;fc.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1};Ek.Object.defineProperties(Pe.prototype,{PCb:{configurable:!0,enumerable:!0,get:function(){return this.f2.value}}});Ek.Object.defineProperties(Pe,{instance:{configurable:!0,enumerable:!0,
get:function(){return Pe.Ma||(Pe.Ma=Pe.RM())}}});Pe.yde="PersonalFileStorageUrl";Pe.the="StorageServiceDisplayName";Pe.Ma=null;Object(je.a)(Pe,"GetMoreInfoActor",Lf,[]);var wf=b(103),Wf=b(97);Ff.prototype.kUc=function(T){this.Za.addHandler(this.fke,T)};Ff.prototype.ABg=function(T){this.Za.addHandler(this.r9e,T)};Ff.prototype.UDj=function(){var T=new Td.a(5,2,this.Vpg,Object(pf.a)(this,this.j8h,"inactiveLoop"),108);this.k8h.Sg(T)};Ff.prototype.j8h=function(){var T=this.i_e(),ra=this.Gw()-T;if(ra>this.jAc&&
this.wT){var hb={};fc.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",(hb.TimeSinceLastActive=ra,hb));this.wT=!1;this.Za.raiseEvent(this.r9e)}T-this.t$d>this.jAc&&(this.wT=!0,this.Za.raiseEvent(this.fke));this.t$d=T};Ff.RM=function(){return new Ff(new xd.a(function(){return wf.a.instance}),function(){return Nc.AFrameworkApplication.Bjf.getTime()},function(){return(new Date).getTime()},new xd.a(function(){return Nc.AFrameworkApplication.jAc}),!0)};Ek.Object.defineProperties(Ff.prototype,{k8h:{configurable:!0,
enumerable:!0,get:function(){return this.se.value}},i_e:{configurable:!0,enumerable:!0,get:function(){return this.Sog}},Gw:{configurable:!0,enumerable:!0,get:function(){return this.mJc}},jAc:{configurable:!0,enumerable:!0,get:function(){return this.vXb.value}}});Ek.Object.defineProperties(Ff,{instance:{configurable:!0,enumerable:!0,get:function(){return Ff.Ma||(Ff.Ma=Ff.RM())}}});Ff.Ma=null;Object(je.a)(Ff,"InactivityManager",null,[]);var ug=b(83),Gg=b(1113);Am(Kf,pe);Kf.prototype.z1e=function(){return"MruActor Result"};
Ek.Object.defineProperties(Kf.prototype,{bxd:{configurable:!0,enumerable:!0,get:function(){return this.Bbe}},qqf:{configurable:!0,enumerable:!0,get:function(){return this.Cbe}},axd:{configurable:!0,enumerable:!0,get:function(){return this.Abe}},mJj:{configurable:!0,enumerable:!0,get:function(){return this.lie}}});Object(je.a)(Kf,"MruResult",pe,[961,962]);var Cf=b(243);tf.prototype.fki=function(T,ra){return T===Cf.a.Bbd||20===ra||18===ra||3===ra};tf.prototype.qli=function(T){return 3===T||5===T||6===
T||7===T||9===T||10===T||11===T||12===T||13===T||14===T||15===T||16===T||23===T||26===T||27===T||28===T};tf.prototype.reset=function(){this.oyb=this.retryCount=0;this.gPc=this.cBb=null;this.task&&(this.taskManager.$p(this.task),this.task=null)};tf.prototype.fbi=function(T,ra,hb,Eb){this.gPc=String.format("{0}_{1}",hb,Eb);if(this.retryCount>=this.Ryi)return fc.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.fki(hb,Eb))return fc.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),
!1;if(this.qli(Eb)&&1<=this.oyb)return this.cBb=hb,!1;ra=Math.max(ra,this.Xec*Math.pow(2,this.oyb));if(26===Eb)ra=Math.max(ra,3E4);else if(27===Eb||28===Eb)ra=Math.max(ra,6E4);9===Eb||412===hb&&(null==this.cBb||412!==this.cBb)?ra=500:this.oyb+=1;this.cBb=hb;this.retryCount+=1;this.task&&this.taskManager.$p(this.task);fc.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",ra);this.task=new Td.a(2,1,ra,T,107);this.taskManager.Sg(this.task);return!0};Ek.Object.defineProperties(tf.prototype,
{Jqc:{configurable:!0,enumerable:!0,get:function(){return this.gPc}}});Object(je.a)(tf,"RetryManager",null,[]);var rg=b(100),dh=b(134);Object(je.a)(rd,"WriteOptions",null,[]);var fh=b(620),vg=b(356);Am(xb,Lf);xb.prototype.Q8i=function(){this.Uw.c9a.fc(dg.a.renameMostRecentlyUsedFileEntry,Mg.a.frame,Object(pf.a)(this,this.Lcj,"renameMruEntry"))};xb.prototype.Lcj=function(){return this.Q_d("Rename")};xb.prototype.zxi=function(){this.sof("File Opened")};xb.prototype.Axi=function(){this.sof("IntervalUpdate")};
xb.prototype.sof=function(T){var ra={};fc.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",(ra.Trigger=T,ra));this.Q_d(T)};xb.prototype.C4=function(T){(T=vf.a.C4(T))&&T.startsWith(".")&&(T=T.substring(1,T.length));return T};xb.prototype.BWe=function(){switch(this.Uw.kca){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}};xb.prototype.o_h=function(T){var ra=this.Oog();if(!ra)return null;var hb=new rd;
hb.documentUrl=this.S5d.value?encodeURI(ra):ra;hb.mruItemId=this.EUb;hb.app=this.BWe();if(ra=this.Zv())hb.folderName=ra.breadcrumbFolderName,ra=ra.hn,hb.documentName=vf.a.Gq(ra),hb.documentExt=this.C4(ra);T&&(hb.documentName?hb.documentName.length?255<=hb.documentName.length?T.set("DocumentNameLength","Long"):2084<=hb.documentName.length&&T.set("DocumentNameLength","VeryLong"):T.set("DocumentNameLength","0"):T.set("DocumentNameLength","Null"));return JSON.stringify(hb)};xb.prototype.Q_d=function(T,
ra){ra=void 0===ra?!1:ra;if(4===this.Uw.kca&&!Nc.AFrameworkApplication.Vta)return 2;var hb=dh.a.Xr();hb&&(hb.set("Trigger",T),hb.set("IsRetry",ra?"true":"false"),hb.set("MruIdSent",this.EUb?"true":"false"),hb.set("URLEncoded",this.S5d.value?"true":"false"));rg.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",hb);T=this.o_h(hb);if(!T)return ra=!Nc.AFrameworkApplication.webEditingEnabled,hb&&(hb.set("WebEditingIsEnabled",Nc.AFrameworkApplication.webEditingEnabled?"true":"false"),hb.set("ProtectedFile",
Nc.AFrameworkApplication.Uqc?"true":"false")),rg.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",ra,!1,Object.assign(new vg.a,{extendedProperties:hb})),2;this.Ara&&!ra&&this.Ara.reset();hb=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.Uw.sW,this.localeName);this.Aje?this.uDc["X-FileId"]=Nc.AFrameworkApplication.oj:hb+=String.format("&{0}",Nc.AFrameworkApplication.oj);Nc.AFrameworkApplication.dc&&(this.uDc["X-Office-AudienceGroup"]=Object(ug.a)(String,Nc.AFrameworkApplication.dc.AudienceGroup)||
"");this.uDc["X-Timeout"]=15E3;return this.Uw.iDb.El(hb,2,T,this.uDc,!0,5,Object(pf.a)(this,this.gXj,"writeMruV2EntryOnServerSuccessCallback"),Object(pf.a)(this,this.S$g,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")};xb.prototype.gXj=function(T){this.A5e(T.data)};xb.prototype.A5e=function(T){var ra=dh.a.Xr();this.Ara&&(ra&&this.Ara.Jqc&&(ra.set("LastError",this.Ara.Jqc),ra.set("NumRetries",this.Ara.retryCount.toString())),this.Ara.reset());var hb=Gg.c(T.ke);
hb&&hb.diagnostics_data&&(this.EUb=hb.diagnostics_data.mru_id);T=+T.s3-+T.pF;ra&&ra.set("RequestDuration",T.toString());rg.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new vg.a,{extendedProperties:ra}))};xb.prototype.S$g=function(T){if(T.data.httpStatus===Cf.a.Drb)this.A5e(T.data);else{var ra=T.data.httpStatus===Cf.a.sGb,hb=dh.a.Xr();this.N5e(this.Ara,T,this.H$g(),hb);hb&&(hb.set("StatusCode",T.data.httpStatus.toString()),ra||this.tUc(T.data,hb));rg.Health.instance.recordKpiFailure("WriteMru",
String.format("RequestFailed_{0}",T.data.httpStatus),ra,!1,Object.assign(new vg.a,{extendedProperties:hb}))}};xb.prototype.H$g=function(){var T=this;return function(){T.Q_d("Retry",!0)}};xb.prototype.vSh=function(){this.F8a("Polling")};xb.prototype.uSh=function(){this.F8a("Retry",!0)};xb.prototype.sxi=function(){this.F8a("Open")};xb.prototype.rxi=function(){this.F8a("Activity")};xb.prototype.qxi=function(){this.F8a("OpenRecentLinks",!1,!0)};xb.prototype.pxi=function(){this.F8a("ActivityRecentLinks",
!1,!0)};xb.prototype.F8a=function(T,ra,hb){ra=void 0===ra?!1:ra;hb=void 0===hb?!1:hb;var Eb={};fc.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",(Eb.Trigger=T,Eb));if(Eb=dh.a.Xr())Eb.set("Trigger",T),Eb.set("IsRetry",ra?"true":"false"),hb&&Eb.set("RecentLinks","true");rg.Health.instance.recordKpiUsage("GetMru",0,"smartfio",Eb);this.Wqa&&!ra&&this.Wqa.reset();hb?this.FDe(Object(pf.a)(this,this.wSh,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(pf.a)(this,this.sSh,"getMruForRecentLinksFromServerFailureCallback"),
!0):this.FDe(Object(pf.a)(this,this.xSh,"getMruV2FromServerSuccessCallback"),Object(pf.a)(this,this.tSh,"getMruFromServerFailureCallback"))};xb.prototype.tUc=function(T,ra){T&&T.responseHeaders&&(T=T.responseHeaders["X-CorrelationId"])&&ra.set("ServerCorrelationId",T)};xb.prototype.jui=function(T,ra){T&&(ra&&ra.set("RequestDuration",(+T.s3-+T.pF).toString()),rg.Health.instance.recordKpiSuccess("GetMru",Object.assign(new vg.a,{extendedProperties:ra})))};xb.prototype.xSh=function(T){this.L_e(T)};xb.prototype.L_e=
function(T,ra){ra=void 0===ra?!1:ra;var hb="",Eb=null,sc=null,vb=null,Wc=Gg.c(T.data.ke);Wc&&(Eb=Wc.places?Wc.places.items:[],sc=Wc.documents?Wc.documents.items:[],(vb=Gg.a(Wc,ra))&&(hb=Ze.c(vb)));Nc.AFrameworkApplication.ta&&Nc.AFrameworkApplication.ta.Qa.q_&&Nd.c()&&!ra&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(hb,!0));hb=dh.a.Xr();this.Wqa&&(hb&&this.Wqa.Jqc&&(hb.set("LastError",this.Wqa.Jqc),hb.set("NumRetries",this.Wqa.retryCount.toString())),this.Wqa.reset());ra&&hb&&hb.set("RecentLinks",
"true");vb||Eb||sc?(ra?this.Uw.$ba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",T.data,"Success"):this.Uw.$ba("MruActor.GetMruV2FromServerSuccessCallback",T.data,"Success"),this.aCc(3,vb,Eb,sc),this.jui(T.data,hb)):(ra?this.Uw.$ba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",T.data,"Failure: Invalid JSON"):this.Uw.$ba("MruActor.GetMruV2FromServerSuccessCallback",T.data,"Failure: Invalid JSON"),hb&&this.tUc(T.data,hb),rg.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",
!1,!1,Object.assign(new vg.a,{extendedProperties:hb})),this.aCc(3,null,null,null,!0));this.W7c(this.zT)};xb.prototype.wSh=function(T){this.L_e(T,!0)};xb.prototype.N5e=function(T,ra,hb,Eb){var sc=0,vb=0,Wc=Gg.c(ra.data.ke);Wc&&(null!=Wc.response_code&&(sc=Wc.response_code,Eb&&Eb.set("MruResponseCode",sc.toString()),9===sc&&(this.EUb="")),Wc.error_data&&null!=Wc.error_data.retry_after_ms&&(vb=Wc.error_data.retry_after_ms,Eb&&Eb.set("ExpectedRetryAfter",vb.toString())));T&&(ra=T.fbi(hb,vb,ra.data.httpStatus,
sc),Eb&&(Eb.set("CurrentRetryCount",T.retryCount.toString()),Eb.set("RetryScheduled",ra?"true":"false")))};xb.prototype.tSh=function(T){this.K_e(T)};xb.prototype.K_e=function(T,ra){ra=void 0===ra?!1:ra;var hb=T.data.httpStatus===Cf.a.sGb,Eb=dh.a.Xr();Eb&&(Eb.set("StatusCode",T.data.httpStatus.toString()),ra&&Eb.set("RecentLinks","true"),hb||this.tUc(T.data,Eb));ra?this.Uw.$ba("MruActor.GetMruForRecentLinksFromServerFailureCallback",T.data,"Failure"):this.Uw.$ba("MruActor.GetMruFromServerFailureCallback",
T.data,"Failure");this.aCc(2);this.N5e(this.Wqa,T,Object(pf.a)(this,this.uSh,"getMruFromServerRetryTask"),Eb);rg.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",T.data.httpStatus),hb,!1,Object.assign(new vg.a,{extendedProperties:Eb}));this.W7c(this.zT);Nc.AFrameworkApplication.ta&&Nc.AFrameworkApplication.ta.Qa.q_&&Nd.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),ra||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))};xb.prototype.sSh=
function(T){this.K_e(T,!0)};xb.prototype.aCc=function(T,ra,hb,Eb,sc){if(3!==this.zT.state||3===T)this.zT.Bbe=void 0===ra?null:ra,this.zT.Cbe=void 0===hb?null:hb,this.zT.Abe=void 0===Eb?null:Eb,this.zT.state=T,this.zT.JKc=void 0===sc?!1:sc,this.zT.lie=this.Uw.Gw()};xb.prototype.nBf=function(T,ra){var hb={};fc.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",(hb.Trigger=T,hb.ResultState=this.zT.state,hb));ra&&3===this.zT.state&&this.GKe(ra,this.zT);return this.zT};xb.prototype.FDe=function(T,
ra,hb){hb=void 0===hb?!1:hb;this.aCc(1);var Eb={};var sc=hb?String.format(this.Uw.sW+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.iug,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.Uw.sW+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.BWe(),this.localeName);this.hug.value||(sc+="&entity=docs");Nc.AFrameworkApplication.dc&&(Eb["X-Office-AudienceGroup"]=Object(ug.a)(String,Nc.AFrameworkApplication.dc.AudienceGroup)||"");hb&&(Eb["X-Office-Application"]=
"147");this.Aje?Eb["X-FileId"]=Nc.AFrameworkApplication.oj:sc+=String.format("&{0}",Nc.AFrameworkApplication.oj);this.Uw.iDb.El(sc,1,null,Eb,!0,5,T,ra,null)};xb.RM=function(){return new xb(new xd.a(function(){return de.instance}),new xd.a(function(){return fh.a.wH(Nc.AFrameworkApplication.lcid).name}),new xd.a(function(){return Nc.AFrameworkApplication.ta.Qa.vv}),Nc.AFrameworkApplication.ga.ra("MruWriteFileIdInHeader"),function(){return Nc.AFrameworkApplication.ta.Qa.Px},function(){return Nc.AFrameworkApplication.jm},
new xd.a(function(){return Nc.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled")}))};Ek.Object.defineProperties(xb.prototype,{uDc:{configurable:!0,enumerable:!0,get:function(){return this.xyg}},Uw:{configurable:!0,enumerable:!0,get:function(){return this.f2.value}},localeName:{configurable:!0,enumerable:!0,get:function(){return this.Nrg.value}}});Ek.Object.defineProperties(xb,{instance:{configurable:!0,enumerable:!0,get:function(){return xb.Ma||(xb.Ma=xb.RM())}}});xb.Ma=null;Object(je.a)(xb,"MruActor",
Lf,[]);Hd.prototype.ei=function(T){this.tb=T;T.register(941,"Common.INewAndOpenCommonHelpers").Hc().Oc(function(){return de.instance});T.register(942,"Common.IEventEmitter<Common.IGetMoreInfoResult>").Hc().Oc(function(){return Pe.instance});T.register(942,"Common.IEventEmitter<Common.IMruResult>").Hc().Oc(function(){return xb.instance})};Hd.prototype.init=function(){var T=this;Nc.AFrameworkApplication.ga.sv(function(){T.Zxb()})};Hd.prototype.Zxb=function(){this.tb.resolve("Common.INewAndOpenCommonHelpers");
this.tb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.tb.resolve("Common.IEventEmitter<Common.IMruResult>");var T=!1;de.instance.c7i();Nc.AFrameworkApplication.Cla&&(T=!0);Nc.AFrameworkApplication.BLf&&(xb.instance.sxi(),Nc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&xb.instance.qxi(),0<Nc.AFrameworkApplication.rqf&&this.zle(),this.Utj(),T=!0);Nc.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&T&&Pe.instance.oxi();
Nc.AFrameworkApplication.yRj&&(T=xb.instance,T.Q8i(),T.zxi(),wf.a.instance.Sg(this.zRj))};Hd.prototype.Utj=function(){Ff.instance.kUc(Object(pf.a)(xb.instance,xb.instance.rxi,"makeGetMruRequestActivityTrigger"));Nc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&Ff.instance.kUc(Object(pf.a)(xb.instance,xb.instance.pxi,"makeGetMruForRecentLinksRequestActivityTrigger"));Ff.instance.kUc(Object(pf.a)(this,this.zle,"addGetMruFromServerTask"));Ff.instance.ABg(Object(pf.a)(this,
this.Sch,"deleteGetMruFromServerTask"))};Hd.prototype.Sch=function(){wf.a.instance.$p(this.sqf)};Hd.prototype.zle=function(){wf.a.instance.Sg(this.sqf)};Hd.prototype.dispose=function(){this.Am||(this.Am=!0,this.pmb&&(wf.a.instance.$p(this.pmb),this.pmb=null))};Ek.Object.defineProperties(Hd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.Core"}},sqf:{configurable:!0,enumerable:!0,get:function(){return this.xee||(this.xee=new Td.a(5,2,Nc.AFrameworkApplication.rqf,
Object(pf.a)(xb.instance,xb.instance.vSh,"getMruFromServerTask"),109))}},zRj:{configurable:!0,enumerable:!0,get:function(){return this.pmb||(this.pmb=new Td.a(2,2,6E4*Nc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(pf.a)(xb.instance,xb.instance.Axi,"makeUpdateMruTask"),197))}}});Object(je.a)(Hd,"CorePackageManager",null,[4,5,3]);var Me=b(557);new Ye(0,0,0,0,0,0);new Ye(1,1,0,0,0,0);new Ye(2,2,0,0,0,0);new Ye(3,3,0,0,0,1);new Ye(4,
3,1,0,1,1);new Ye(5,3,0,0,.42,1);new Ye(6,3,.83,0,1,1);new Ye(7,3,0,0,.58,1);new Ye(8,3,.42,0,.58,1);new Ye(9,3,.1,.25,.75,.9);new Ye(10,3,.1,.9,.2,1);new Ye(11,3,.1,.9,.2,1);new Ye(12,3,.9,.1,.2,1);new Ye(13,3,.4,0,0,1);new Ye(14,3,.13,.21,.1,.7);new Ye(15,3,.02,.33,.38,.77);new Ye(16,3,.57,.17,.95,.75);new Ye(17,3,0,.19,.07,.72);new Ye(18,3,0,0,.95,.37);new Ye(19,3,.66,0,.34,1);new Ye(20,3,.8,0,.2,1);new Ye(21,3,.8,0,.2,1);xe.prototype={type:0,startTime:new mf(0,null),endTime:new mf(0,null),J_j:new mf(0,
null),kZj:new mf(0,null),operationType:0};new Qe(0,[new xe(5,0,0,0,null,1,1,0)]);new Qe(1,[new xe(5,2,0,0,null,0,2,0),new xe(5,2,0,50,null,1,1,0)]);new Qe(2,[new xe(1,3,0,167,null,0,1,1),new xe(2,3,0,167,null,0,1,1)]);new Qe(3,[new xe(3,3,0,167,null,0,1,1),new xe(4,3,0,167,null,0,1,1)]);new Qe(4,[new xe(5,2,0,0,null,0,2,0),new xe(5,2,0,167,null,1,1,0)]);new Qe(5,[new xe(5,2,0,167,null,0,1,0)]);new Qe(6,[new xe(1,3,0,100,null,0,1,1),new xe(2,3,0,100,null,0,1,1)]);new Qe(7,[new xe(3,3,0,100,null,0,
1,1),new xe(4,3,0,100,null,0,1,1)]);new Qe(8,[new xe(5,2,0,100,null,1,1,0)]);new Qe(9,[new xe(5,2,0,0,null,0,2,0),new xe(5,2,0,100,null,1,1,0)]);new Qe(10,[new xe(5,2,0,100,null,0,1,0)]);new Qe(11,[new xe(1,3,0,267,null,0,1,1),new xe(2,3,0,267,null,0,1,1)]);new Qe(12,[new xe(3,3,0,267,null,0,1,1),new xe(4,3,0,267,null,0,1,1)]);new Qe(13,[new xe(5,2,0,267,null,1,1,0)]);new Qe(14,[new xe(5,2,0,0,null,0,2,0),new xe(5,2,0,267,null,1,1,0)]);new Qe(15,[new xe(5,2,0,267,null,0,1,0)]);new Qe(16,[new xe(6,
3,0,267,null,0,1,1),new xe(7,3,0,267,null,0,1,1)]);new Qe(17,[new xe(1,3,0,750,null,0,1,1),new xe(2,3,0,750,null,0,1,1)]);new Qe(18,[new xe(3,3,0,750,null,0,1,1),new xe(4,3,0,750,null,0,1,1)]);new Qe(19,[new xe(5,2,0,750,null,1,1,0)]);new Qe(20,[new xe(5,2,0,0,null,0,2,0),new xe(5,2,0,750,null,1,1,0)]);new Qe(21,[new xe(6,3,0,1E3,null,0,1,1),new xe(7,3,0,1E3,null,0,1,1)]);new Qe(22,[new xe(1,3,0,367,null,0,1,1),new xe(2,3,0,367,null,0,1,1)]);new Qe(23,[new xe(3,3,0,367,null,0,1,1),new xe(4,3,0,367,
null,0,1,1)]);new Qe(24,[new xe(5,2,0,367,null,1,1,0)]);new Qe(25,[new xe(5,2,0,0,null,0,2,0),new xe(5,2,0,367,null,1,1,0)]);new Qe(26,[new xe(5,2,0,367,null,0,1,0)]);new Qe(27,[new xe(5,2,0,0,null,1,1,0),new xe(5,2,0,50,null,0,1,0)]);new Qe(28,[new xe(1,3,0,433,null,0,1,1),new xe(2,3,0,433,null,0,1,1)]);new Qe(29,[new xe(5,2,0,0,null,0,2,0),new xe(5,2,0,50,null,1,1,0),new xe(2,3,0,0,null,40,1,1),new xe(2,3,0,100,null,0,1,1)]);new Qe(30,[new xe(2,0,0,0,null,32,1,1),new xe(2,0,0,100,null,32,1,1),new xe(2,
3,101,350,null,0,1,1),new xe(3,0,0,0,null,0,2,1),new xe(3,0,0,100,null,0,2,1),new xe(3,3,101,350,null,0,1,1),new xe(5,0,0,0,null,0,2,0),new xe(5,0,0,100,null,1,1,0)]);new Qe(31,[new xe(2,3,0,267,null,32,1,1),new xe(3,3,0,267,null,0,2,1),new xe(5,2,0,0,null,1,0,0),new xe(5,2,0,267,null,0,2,0)]);new Qe(32,[new xe(5,2,0,0,null,0,2,0),new xe(5,2,0,100,null,0,2,0),new xe(5,2,101,267,null,1,1,0)]);new Qe(33,[new xe(1,10,0,300,null,0,1,1),new xe(2,10,0,300,null,0,1,1)]);new Qe(34,[new xe(3,10,0,300,null,
0,1,1),new xe(4,10,0,300,null,0,1,1)]);new Qe(35,[new xe(1,8,0,750,null,0,1,1),new xe(2,8,0,750,null,0,1,1)]);new Qe(36,[new xe(5,2,0,0,null,0,2,0),new xe(5,2,0,200,null,0,2,0),new xe(5,3,201,500,null,1,1,0)]);new Qe(37,[new xe(1,2,0,0,null,0,2,1),new xe(2,2,0,0,null,0,2,1),new xe(1,2,0,200,null,0,2,1),new xe(2,2,0,200,null,0,2,1),new xe(1,3,201,267,null,0,1,1),new xe(2,3,201,267,null,0,1,1)]);new Qe(38,[new xe(1,3,0,267,null,0,1,1),new xe(2,3,0,267,null,0,1,1)]);new Qe(39,[new xe(5,2,0,0,null,0,
2,0),new xe(5,2,0,267,null,1,1,0)]);new Qe(40,[new xe(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(T){window.setTimeout(T,16)}}();jg.prototype={Qe:null,eJg:5,Vnb:null,wWc:0,startTime:null,duration:null,J7b:null,UXc:-1,Jwd:-1,ewd:-1};jg.prototype.Start=
function(){this.startTime=new Date;this.J7b={}};jg.prototype.GetRecentAnimationStats=function(){var T,ra=[],hb=0;for(T=Of.wWc;T<Of.eJg;T++)null!=Of.Vnb[T]&&(ra[hb]=Of.Vnb[T],hb++);for(T=0;T<Of.wWc;T++)null!=Of.Vnb[T]&&(ra[hb]=Of.Vnb[T],hb++);return ra};jg.prototype.GetAnimationSqmStats=function(){var T=[];return T[0]=0>Of.UXc?0:Of.UXc,T[1]=0>Of.Jwd?0:Of.Jwd,T[2]=0>Of.ewd?0:Of.ewd,T};var Of=new jg;var ac=b(228),Lc=b(254),wd=b(742),Mc=b(91),ge=b(88),nf=b(271),Ee=b(166),ya=b(75),Cb=b(393),cc=b(51),Rc=
b(36),yd=b(95),od=b(72),ze=b(638),gf=ge.a;Am(Bc,gf);Bc.prototype.dispose=function(){this.$&&nf.a(this.$).icj(this.wyf);this.wb=null;Array.clear(this.b9);gf.prototype.dispose.call(this)};Bc.prototype.E0i=function(T){this.xca(T)};Bc.prototype.jqf=function(T,ra,hb,Eb){Eb=void 0===Eb?null:Eb;var sc=this.sGj(T,ra,void 0===hb?!0:hb,Eb);if(!sc){hb=ra;var vb=T?1:-1,Wc=this.osd;do{sc=!1;if(ya.a(this.$.ya,27)){if(hb+=vb,hb>=Wc.length||0>hb)sc=!0}else hb=(hb+vb+Wc.length)%Wc.length;if(sc){this.nwi(T,ra,Eb);
break}else if(sc=this.rGj(T,ra,hb,Eb))break}while(hb!==ra)}};Bc.prototype.sGj=function(T,ra,hb,Eb){Eb=void 0===Eb?null:Eb;var sc=null;0<=ra&&(sc=this.b9[ra]);return(null===sc||void 0===sc?0:sc.canReceiveFocus)&&sc.Wf(T,void 0===hb?!0:hb)?(Eb&&od.g(Eb),fc.ULS.sendTraceTag(537166669,0,50,"Switched focus inside current section {0} into a sub region",sc.we),sc.Cj(),!0):!1};Bc.prototype.rGj=function(T,ra,hb,Eb){Eb=void 0===Eb?null:Eb;hb=this.b9[hb];if((null===hb||void 0===hb?0:hb.canReceiveFocus)&&hb.Wf(T,
!1)){Eb&&od.g(Eb);hb.Cj();if(T=this.b9[ra])T.Rj(),fc.ULS.sendTraceTag(537166668,0,50,"Switched focus from section {0} to {1}",T.we,hb.we);return!0}return!1};Bc.prototype.nwi=function(T,ra,hb){(hb=void 0===hb?null:hb)&&od.g(hb);if(ra=this.b9[ra])ra.Rj(),fc.ULS.sendTraceTag(537166666,0,50,"Lost focus from section {0}",ra.we);Rc.TaskExtensions.Ba(cc.GetServiceTaskFactory.Va(this.$.da,21,137,0),function(Eb){var sc={};Eb.result.Hj(uc.a.Amb,(sc[dc.a.direction]=T?"forward":"backward",sc))},this.$.la)};Bc.prototype.xca=
function(T){var ra=this.$.isEditMode?Ee.a(this.$):null;if(!this.$.zb.Qwa||Bc.yii(ra))if(117===T.keyCode&&(T.ctrlKey||od.b(T))){ra=this.JWh(T.target);var hb=!T.shiftKey;fc.ULS.sendTraceTag(537166662,0,50,"AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: {0}",ra);Nc.AFrameworkApplication.ta.Qa.Jz&&this.$.Kka&&1===ra&&1===this.$.iyc&&wd.ShyRibbon.dQ(1,0);this.jqf(hb,ra,!0,T)}else 117!==T.keyCode||Bc.TRe?-411645385===this.$.shortcutKeyManager.cu(T)?this.Pdf()&&(ra={},this.$.Ka.Xb(new yd.a(-411645385,
1,this.$.ed,6,null),(ra.event=T,ra),T),T.stopPropagation()):1588554917===this.$.shortcutKeyManager.cu(T)?0===this.mode?(ze.a(this.$)||(ra={},this.$.Ka.Xb(new yd.a(1588554917,1,this.$.ed,6,null),(ra.event=T,ra),T)),T.preventDefault(),T.stopPropagation()):3===this.mode&&(T.preventDefault(),T.stopPropagation()):this.o2h(T):(T=Cb.a.az.notificationBar.P$(Mc.a.aOh(),!1),T.image=0,Cb.a.az.notificationBar.lE(T),Bc.TRe=!0)};Bc.prototype.JWh=function(T){for(var ra=this.osd,hb=0,Eb=ra.length;hb<Eb;++hb){var sc=
ra[hb];if(sc&&sc.ph(T))return hb}return-1};Bc.prototype.f_e=function(){for(var T=[],ra=0,hb=this.nxa.length;ra<hb;ra++){var Eb=nf.a(this.$).YM(this.nxa[ra]);Eb&&T.push(Eb)}return T};Bc.prototype.Pdf=function(){return 0===this.mode||4===this.mode};Bc.yii=function(T){return T?T.inKeytipMode:!1};Ek.Object.defineProperties(Bc.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},osd:{configurable:!0,enumerable:!0,get:function(){this.b9.length||(this.b9=this.f_e());return this.b9}},
nxa:{configurable:!0,enumerable:!0,get:function(){return this.o$d},set:function(T){this.o$d=T;this.b9=this.f_e()}}});Bc.TRe=!1;Object(je.a)(Bc,"AccessibilityManager",ge.a,[953,3]);var of=b(153),tg=b(21),Fe=b(15);Am($d,Bc);$d.prototype.xca=function(T){this.$.Pd&65536&&Bc.prototype.xca.call(this,T)};$d.prototype.o2h=function(T){if(tg.a.equals(this.Epj,this.$.shortcutKeyManager.Med(T),!1)){var ra=of.b(this.$);if(null===ra||void 0===ra?0:ra.canReceiveFocus)od.g(T),ra.Wf(!0,!1)}};Ek.Object.defineProperties($d.prototype,
{mode:{configurable:!0,enumerable:!0,get:function(){return this.bC},set:function(T){this.bC=T;switch(T){case 0:this.nxa=this.jNg;break;case 2:this.nxa=this.jVj;break;case 3:this.nxa=this.e0i;break;case 4:this.nxa=this.iVg;break;case 5:this.nxa=this.F_i;break;case 6:this.nxa=this.P_i;break;default:fc.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}}});Object(je.a)($d,"EwaAccessibilityManager",Bc,[]);var hh=ac.a;Am(ae,hh);ae.prototype.create=function(){this.Eb(this.$.da.Aa(15)||
new $d(this.$))};ae.ka=function(T){T.da.Ga(157,new ae(T))};Object(je.a)(ae,"AccessibilityManagerFactory",ac.a,[]);var Dg=b(11),pg=b(147),Fc=b(696),jd=Fc.a;Am(vd,jd);vd.prototype.dispose=function(){pg.WacAirSpace.Wmd()&&pg.WacAirSpace.oAc()};vd.prototype.animate=function(T,ra,hb,Eb,sc){ra&&pg.WacAirSpace.oL(T.element,ra);pg.WacAirSpace.animate(T,Eb,sc);hb&&pg.WacAirSpace.l9i(T.element,hb)};Object(je.a)(vd,"AnimationManager",Fc.a,[3]);var td=b(101),ue=b(202),He=b(1018),bf=b(566),Rf=b(85),ig=b(76),Vf=
ig.a;Am(jc,Vf);jc.prototype.Tgj=function(){var T=new ue.a,ra=bf.a.ar(Rf.a.instance.lc("Common.IEventEmitter<Common.IMruResult>")),hb=new xd.a(function(){return ra.result});this.gtd=new xd.a(function(){return new He.a(hb.value,null)});if(!this.gtd)return T;var Eb=this.gtd.value.Az("NewAndOpenCoreManager",!1);if(!Eb||3!==Eb.state||!Eb.axd)return Eb?fc.ULS.sendTraceTag(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: {0}, mruResult MruDocuments is null: {1}",Eb.state,!Eb.axd):
fc.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;Eb=Eb.axd;for(var sc=["xlsx","xlsb","xlsm"],vb=0;vb<Eb.length;vb++){var Wc=Eb[vb];if(!(0>Array.indexOf(sc,Wc.extension))){var Zd=String.format("{0}.{1}",Wc.title,Wc.extension),uf=Gg.b(Wc,Nc.AFrameworkApplication.isRtl);Wc=Wc.url;if(Zd&&uf&&Wc){var If={};T.add((If[jc.fileName]=Zd,If[jc.friendlyPath]=uf,If[jc.section]="mru",If[jc.absoluteUrl]=Wc,If))}else Wc||fc.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}}return T};
jc.prototype.dispose=function(){Vf.prototype.dispose.call(this)};jc.fileName="FileName";jc.friendlyPath="FriendlyPath";jc.section="Section";jc.absoluteUrl="AbsoluteUrl";Object(je.a)(jc,"NewAndOpenCoreManager",ig.a,[940,3]);var Qf=ac.a;Am(pd,Qf);pd.prototype.create=function(){this.Eb(this.$.da.Aa(451)||this.$.da.Ga(451,new jc(this.$)))};pd.ka=function(T){T.da.Ga(164,new pd(T))};Object(je.a)(pd,"NewAndOpenCoreFactory",ac.a,[]);var df=b(1),hg=b(31),re=b(5),se=b(12),wg=b(249),Mf=b(22);Hc.f3a=function(T){T=
vf.a.Sf(T||"");return new Hc(T)};Hc.L$b=function(T){return Hc.f3a(Fe.a.instance.fa(T))};Hc.bcd=function(T){return new Hc(Fe.a.instance.Wa(T))};Hc.wEh=function(T,ra){for(var hb=[],Eb=1;Eb<arguments.length;++Eb)hb[Eb-1]=arguments[Eb];return Hc.vEh.apply(null,[Fe.a.instance.Ab(T)].concat(hb))};Hc.vEh=function(T,ra){for(var hb=[],Eb=1;Eb<arguments.length;++Eb)hb[Eb-1]=arguments[Eb];Eb=hb.length;for(var sc=Array(Eb),vb=0;vb<Eb;vb++)sc[vb]=(hb[vb]||Hc.LKe).Fuc;return new Hc(String.format.apply(null,[T].concat(sc)))};
Ek.Object.defineProperties(Hc,{LKe:{configurable:!0,enumerable:!0,get:function(){return Hc.P5d||(Hc.P5d=new Hc(""))}},Rud:{configurable:!0,enumerable:!0,get:function(){return Hc.Jae||(Hc.Jae=Hc.bcd(2).Fuc)}}});Hc.P5d=null;Hc.Jae=null;Object(je.a)(Hc,"SafeHtml",null,[960]);nd.prototype.dispose=function(){this.$&&this.unregister();se.DOMElementExtensions.Af(this.iha);se.DOMElementExtensions.Af(this.Xea);se.DOMElementExtensions.Af(this.hga);this.hga=this.Xea=this.iha=this.$=null};nd.prototype.setEnabled=
function(T){this.CYf(this.hga,T)};nd.prototype.bpj=function(){this.CYf(this.Xea,!0)};nd.prototype.readText=function(T){this.hHb(Hc.f3a(T),!0)};nd.prototype.VPa=function(T){this.hHb(Hc.f3a(T),!1)};nd.prototype.CLf=function(T,ra){if(1>ra||!T)fc.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var hb=new Sys.StringBuilder;T=String.format(Fe.a.instance.Ab(34),ra,T);Ub(hb,T);Ub(hb,Fe.a.instance.fa(852));this.hHb(Hc.f3a(hb.toString()),!1)}};nd.prototype.Z4i=function(T,ra,hb){if(1>
hb||1>ra||ra>hb||!T)fc.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Eb=new Sys.StringBuilder;Ub(Eb,T);Eb.append(String.format(Fe.a.instance.Ab(55),ra,hb));this.hHb(Hc.f3a(Eb.toString()),!1)}};nd.prototype.zLf=function(T){T=this.fWh(T);this.hHb(T,!1)};nd.prototype.hHb=function(T,ra){if(T=T?T.Fuc:null)ra=ra?this.hga:this.Xea,tg.a.equals(ra.innerHTML,T,!1)&&(T+=Hc.Rud),ra.innerHTML=T};nd.prototype.Iab=function(T,ra){this.iha.getAttribute(re.a.gsa)!==ra&&this.iha.setAttribute(re.a.gsa,
ra);T=T?Hc.f3a(T).Fuc:"";this.iha.innerHTML=T};nd.prototype.$4i=function(T,ra,hb,Eb){var sc=!0;sc=void 0===sc?!1:sc;var vb=Fe.a.instance.Ab(54);fc.ULS.shipAssertTag(537153949,0,!(void 0===T||null===T));fc.ULS.shipAssertTag(537153948,0,!(void 0===ra||null===ra));fc.ULS.shipAssertTag(537153947,0,!(void 0===hb||null===hb));fc.ULS.shipAssertTag(537153946,0,!(void 0===Eb||null===Eb));fc.ULS.shipAssertTag(537153945,0,!(void 0===vb||null===vb));T=String.format(vb,T||"",ra||"",hb||"",Eb||"");sc?this.Iab(T,
re.a.sZa):this.readText(T)};nd.prototype.sPj=function(T){var ra=this.hga.style;T?(T=wg.a.e1b(T.cell,ra),ra=T.wL,ra.top=ra.left=ra.bottom=ra.right=null,T.a$()):ra.cssText=""};nd.prototype.fWh=function(T){switch(T){case -1985798686:return Hc.L$b(12);case -911352779:return Hc.L$b(11);case 237279923:return Hc.L$b(13);case -1502853784:return Hc.bcd(81);case -111689794:return Hc.bcd(78);case -287251124:return this.rgd(1303,function(ra){return ra.bold});case -1925065947:return this.rgd(1304,function(ra){return ra.italic});
case 1764140053:return this.rgd(1305,function(ra){return ra.underline})}return null};nd.prototype.register=function(){fc.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(fc.ULS.shipAssertTag(537153943,0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.Ora(this.Vuf))};nd.prototype.unregister=function(){this.$&&this.$.Ka.Mza(this.Vuf)};nd.prototype.CYf=function(T,ra){var hb=T===this.Xea;ra?(T.setAttribute(re.a.gsa,re.a.sZa),
hb&&T.setAttribute(re.a.Td,re.a.esa),T.setAttribute(re.a.RP,re.a.Tp),T.removeAttribute(re.a.RP),T.innerHTML+=" "):(T.removeAttribute(re.a.gsa),hb&&T.removeAttribute(re.a.Td),T.setAttribute(re.a.RP,re.a.Mj))};nd.prototype.rgd=function(T,ra){var hb=this.activeCell;if(!hb)return null;ra=ra(hb)?7:8;return Hc.wEh(ra,Hc.L$b(T))};Ek.Object.defineProperties(nd.prototype,{Fxa:{configurable:!0,enumerable:!0,get:function(){return this.Vrg}},isActive:{configurable:!0,enumerable:!0,get:function(){return!0}},activeCell:{configurable:!0,
enumerable:!0,get:function(){return Mf.g(this.$).kc(null)}}});Object(je.a)(nd,"AriaLiveNotifier",null,[995,944,3]);var zh=ac.a;Am(ed,zh);ed.prototype.create=function(){this.Eb(this.$.da.Aa(211)||new nd(this.$,this.$.uw,this.$.Lf))};ed.ka=function(T){T.da.Ga(212,new ed(T))};Object(je.a)(ed,"AriaLiveNotifierFactory",ac.a,[]);var Da=b(24),Ib=b(221),Ic=b(140),Gd=b(65);ne.prototype.readText=function(T){T=String.format(Fe.a.instance.Ab(30),T);this.hO.setAttribute(re.a.Pt,T);this.XW.setAttribute(re.a.Pt,
T);this.xGj()};ne.prototype.dispose=function(){this.s0&&this.s0.parentNode&&this.s0.parentNode.removeChild(this.s0);this.XW=this.hO=this.s0=this.Yia=null};ne.prototype.W8g=function(T){var ra=T.Mb+"readoutElementWrapper",hb=T.Mb+"readoutElement1",Eb=T.Mb+"readoutElement2";this.s0=document.getElementById(ra);this.s0||(this.s0=document.createElement(Ib.a.div),this.s0.id=ra,this.hO=document.createElement(Ib.a.label),this.hO.id=hb,this.hO.setAttribute(Ic.a.contentEditable,Gd.a.VOb),this.hO.setAttribute(re.a.Td,
re.a.tZa),this.XW=document.createElement(Ib.a.label),this.XW.id=Eb,this.XW.setAttribute(Ic.a.contentEditable,Gd.a.VOb),this.XW.setAttribute(re.a.Td,re.a.tZa),this.hO.style.width="0px",this.hO.style.height="0px",this.XW.style.width="0px",this.XW.style.height="0px",this.hO.tabIndex=-1,this.XW.tabIndex=-1,this.s0.appendChild(this.hO),this.s0.appendChild(this.XW),T=T.Mb+re.a.x2c,ra=document.getElementById(T),fc.ULS.shipAssertTag(537153942,3,!!ra,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",
T),ra&&ra.appendChild(this.s0))};ne.prototype.$Zi=function(){this.Yia&&this.hO&&this.XW&&(this.Yia.setAttribute(re.a.X2,this.hO.id),this.Yia.setAttribute(re.a.eXc,String.format("{0} {1}",this.hO.id,this.XW.id)))};ne.prototype.xGj=function(){if(this.isActive){var T="";se.DOMElementExtensions.hasAttribute(this.Yia,re.a.X2)&&(T=this.Yia.getAttribute(re.a.X2).toString());this.Yia.setAttribute(re.a.X2,T===this.hO.id?this.XW.id:this.hO.id)}else fc.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")};
ne.p6a=function(){if(null==ne.jub)if(df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!Da.a.QMa)ne.jub=!0,fc.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(ne.jub=!1,Da.a.XH||Da.a.Gf)ne.jub=!0,fc.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return ne.jub};ne.ka=function(T){ne.p6a()&&T.da.Ga(244,
new ne(T,Mf.g(T).wc.textBox.lf))};Ek.Object.defineProperties(ne.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return!!this.Yia&&document.activeElement===this.Yia}}});ne.jub=null;Object(je.a)(ne,"FocusBasedReadout",null,[944,3]);var Sd=ac.a;Am(Xc,Sd);Xc.prototype.create=function(){var T=this;ne.p6a()?Mf.g(this.$).wc.textBox.yU(function(){var ra=T.$.da.Aa(244)||new ne(T.$,Mf.g(T.$).wc.textBox.lf);T.Eb(ra)}):this.Eb(null)};Xc.ka=function(T){T.da.Ga(315,new Xc(T))};Object(je.a)(Xc,
"FocusBasedReadoutFactory",ac.a,[]);var We=b(7),Ne=b(90),Se=b(25),Ka=b(46),bb=b(247),Yb=b(47),Ec=b(44),ad=b(120);md.hgd=function(T){return md.e1e(T.toString())};md.e1e=function(T){return md.GWg.test(T)?T.replace(md.P3i,"$1 ").replace(md.O3i,' "$1"').trim():T};md.udj=function(T){var ra=T.lastIndexOf("!");return T.substring(0,-1<ra?ra+1:0)+md.e1e(T.substring(-1<ra?ra+1:0,T.length))};Ek.Object.defineProperties(md,{P3i:{configurable:!0,enumerable:!0,get:function(){return md.oee||(md.oee=RegExp("([A-Z]+)",
"g"))}},O3i:{configurable:!0,enumerable:!0,get:function(){return md.nee||(md.nee=RegExp("([A-Z])","g"))}},GWg:{configurable:!0,enumerable:!0,get:function(){return md.k3d||(md.k3d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}}});md.oee=null;md.nee=null;md.k3d=null;Object(je.a)(md,"RangeAriaExtensions",null,[]);Object(je.a)(qc,"SelectionReadoutState",null,[]);var Rd=b(63),ce=b(79);Wd.prototype.dispose=function(){this.$&&
this.vm();Ne.a.Ha(this.g0b);this.sparklineManager=this.$=this.g0b=null};Wd.prototype.dXe=function(T,ra,hb){hb=void 0===hb?!0:hb;if(!T)return"";var Eb=this.$.da,sc=new Sys.StringBuilder;this.RJg(sc,T,ra);if(df.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var vb=this.tableManager.uva(T.range);(null===vb||void 0===vb?0:vb.MRd)&&this.hqe(sc,vb);vb=this.tableManager.rn(T.range);(null===vb||void 0===vb?0:vb.eba)&&this.hqe(sc,vb)}vb=T.cba?this.LZe(T):T.text;Ub(sc,vb);vb=this.$.activeItemName;
this.uD.activeItemName!==vb&&(Ub(sc,vb),this.uD.activeItemName=vb);vb=1===ra.length?Ka.K(ra).isSingle?"":Fe.a.instance.fa(848):String.format(Fe.a.instance.Ab(31),ra.length);Ub(sc,vb);vb=El(ra);for(var Wc=vb.next();!Wc.done;Wc=vb.next())Wc=Wc.value,Ub(sc,md.hgd(Wc)),1===ra.length&&Wd.wni(Wc)&&(Wc=Mf.g(this.$).Ea.gs(Wc.bottomRight),void 0!==Wc&&null!==Wc&&Wc.text&&(Wc=Wc.cba?this.KZe(Wc,Wc.text):Wc.text,Ub(sc,Wc)));vb=T.cell;vb=this.HTh(vb.Xhj,vb.NZg);Ub(sc,vb);this.BJg(sc,T);hb&&(T.Q6a?Ub(sc,Fe.a.instance.fa(836)):
T.EMa&&Ub(sc,Fe.a.instance.fa(837)));if(T.hasAutoFilter||T.V4)this.SJg(sc,T.hasAutoFilter?T.cell.Iob:T.cell.CXi),hb&&Ub(sc,Fe.a.instance.fa(839));bb.c(this.$,T.range)&&Ub(sc,Fe.a.instance.fa(843));this.yJg(sc,T);hb=(hb=Eb.Aa(14))?hb.yIh():"";Ub(sc,hb);T.IH&&(hb=Mf.g(this.$).Ea.gs(T.range),hb=!!hb&&hb.H6e,Wd.avj(T)?Wd.zJg(sc,T):df.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&hb?Ub(sc,Fe.a.instance.fa(841)):Ub(sc,Fe.a.instance.fa(840)));T.bba&&(Ub(sc,Fe.a.instance.fa(842)),
T.Qwb&&Ub(sc,String.format(Fe.a.instance.Ab(16),T.dbh)),Ub(sc,T.iconName));T.hasRichValueIcon&&(vb=this.$.da.Aa(271),hb="",vb&&T.cell.gkf&&(vb=vb.BQ(T.cell.gkf))&&vb.DomainId.Id!==Wd.zWj&&(hb=vb.Name),T.cell.iei?(Ub(sc,String.format(Fe.a.instance.Ab(178),hb)),Ub(sc,Fe.a.instance.fa(1775))):(Ub(sc,String.format(Fe.a.instance.Ab(176),hb)),Ub(sc,Fe.a.instance.fa(1774))));this.K4h(T)&&Ub(sc,Wd.pPh(T));(Eb=Eb.Aa(231))&&Ub(sc,Eb.ZZe(ra,!0));1===ra.length&&ra[0].isSingle&&Wd.$uj(T,ra[0],this.$)&&(ra=this.$.da.Aa(271))&&
Ub(sc,ra.JIh());T.zNb&&T.ANb&&Ub(sc,T.ANb);(ra=T.cell.oVg)&&Ub(sc,ra);df.EwaSettings.isChangeGateEnabled("OfficeVSO:5463515_PhoneticSlice1")&&T.Fka&&T.cGb&&(T=T.GDd)&&(Ub(sc,Fe.a.instance.fa(1938)),Ub(sc,T));return sc.toString()};Wd.prototype.hve=function(T){this.zsa=this.uD;this.uD=Object(We.a)(new qc,{activeItemName:this.zsa.activeItemName,Azc:T?this.zsa.Azc:!1,tableName:T?this.zsa.tableName:"",b0a:T?this.zsa.b0a:-1})};Wd.prototype.dTf=function(){this.zsa&&(this.uD=this.zsa,this.zsa=null)};Wd.prototype.HTh=
function(T,ra){return 2===T||2===ra?Fe.a.instance.fa(869):1===T||1===ra?Fe.a.instance.fa(870):""};Wd.prototype.LZe=function(T){return this.KZe(T.cell,T.text)};Wd.prototype.RJg=function(T,ra,hb){if(hb&&1===hb.length&&hb[0].isSingle){hb="";var Eb=this.tableManager.uva(ra.range);if(Eb)hb=Eb.pivotTableName,this.EWc(T,hb),this.jqe(T,!0,hb,Eb.ugc?Fe.a.instance.fa(831):""),Ub(T,this.tableManager.xli(Eb,ra.range)?Fe.a.instance.fa(833):""),Ub(T,this.tableManager.zfi(Eb,ra.range)?Fe.a.instance.fa(832):"");
else if(Eb=this.tableManager.rn(ra.range)){var sc=Mf.g(this.$).Rb.Qj(ra.range);hb=sc?sc.name:"";this.EWc(T,hb);var vb="";sc&&df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(vb=(sc.VSa?sc.VSa+" . ":"")+(sc.WSa?sc.WSa:""));this.jqe(T,!1,hb,vb);Ub(T,this.tableManager.ndf(Eb,ra.range)?Fe.a.instance.fa(832):"")}else this.EWc(T,hb),this.uD.tableName="",this.uD.b0a=-1}};Wd.prototype.EWc=function(T,ra){ra!==this.uD.tableName&&this.uD.tableName&&(T.append(Fe.a.instance.fa(this.uD.Azc?
830:829)),Ub(T," "+this.uD.tableName))};Wd.prototype.jqe=function(T,ra,hb,Eb){hb!==this.uD.tableName&&(T.append(Fe.a.instance.fa(ra?828:827)),Ub(T," "+hb),Ub(T,Eb),this.uD.tableName=hb,this.uD.Azc=ra,this.uD.b0a=-1)};Wd.prototype.hqe=function(T,ra){var hb=Mf.g(this.$).ha.sa.activeCell;if(hb.top!==ra.top&&hb.left!==this.uD.b0a){T.append(Fe.a.instance.fa(832));ra=new Se.Range(ra.top,hb.left,ra.top,hb.left,!0,!0);Ub(T,md.hgd(ra));if(ra=Mf.g(this.$).kc(ra))ra=ra.cba?this.LZe(ra):ra.text,Ub(T,ra);this.uD.b0a=
hb.left}};Wd.prototype.KZe=function(T,ra){var hb=T.r5a;return T.Twb?String.format(Fe.a.instance.Ab(14),ra,hb):String.format(Fe.a.instance.Ab(13),ra,md.udj(hb))};Wd.prototype.Ck=function(){fc.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var T=Mf.g(this.$);fc.ULS.shipAssertTag(537153929,0,!!T,"Can't register to grid's events");T&&(T.rc.ml(this.Cp),T.Ea.Gx(this.Zca),T.nE(this.Zca),this.Cab&&T.rc.mo(this.ug.bind(this)),T=T.ha,fc.ULS.shipAssertTag(537153928,
0,!!T,"Can't register to selectionManager's events"),T&&(T.SG(this.kd),T.zJ(this.Zca),T.Oa.P2(this.Zca),this.Cab&&(this.VGd=this.VGd.bind(this))))}};Wd.prototype.vm=function(){if(this.$){var T=Mf.g(this.$);T&&(T.rc.fl(this.Cp),T.Ea.Dv(this.Zca),T.UF(this.Zca),this.Cab&&T.rc.Dn(this.ug),T=T.ha)&&(T.WF(this.Zca),T.lO(this.Zca),T.Oa.Oma(this.Zca))}};Wd.prototype.readText=function(T,ra){this.p6a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(T):(df.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&
this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(T),this.Cab&&!ra||this.ariaLiveNotifier.sPj(ra))};Wd.prototype.ug=function(){this.uob&&this.uob.cancel()};Wd.prototype.VGd=function(){this.readText(this.QWh())};Wd.prototype.QWh=function(){var T=this,ra="";Mf.g(this.$).ha.rangePicker.XK.forEach(function(hb){ra+=T.GXh(hb)});return ra+=" selected"};Wd.prototype.GXh=function(T){return" "+(T.sheetId!==Rd.d(this.$.qa)?this.$.xa.Igd(T.sheetId).name:"")+" "+T.range.topLeft+" "+(T.range.isSingle?
"":T.range.bottomRight)};Wd.prototype.zHh=function(){var T=null;var ra=Mf.g(this.$).ha;if(1!==ra.Ue&&!ra.Oa.oc)return fc.ULS.sendTraceTag(537153927,0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",ra.Ue),{returnValue:"",activeCell:T};switch(ra.Ue){case 2:return{returnValue:this.sKh(ra),activeCell:T};case 64:var hb=ra.Oa.oc.floatingObject,Eb="";if(ra=ra.Oa.oc.Gs||ra.Oa.oc.Sd)Eb=(Eb=ra.firstChild)?se.DOMElementExtensions.getTextContent(Eb):
"";return{returnValue:String.format(Fe.a.instance.Ab(53),Wd.Z$b(hb.altText,hb.altTextDescription,hb.name),Eb,hb.altTextDescription),activeCell:T};case 4:return{returnValue:Wd.LIg(ra.Oa.oc.floatingObject),activeCell:T};case 512:return{returnValue:ad.a.zYe(ra.Oa.oc.floatingObject.A7c),activeCell:T};case 8:return hb=(hb=ra.Oa.oc.floatingObject)?hb.name:"",{returnValue:String.format(Fe.a.instance.Ab(51),hb),activeCell:T};case 1:return T=this.activeCell,{returnValue:this.dXe(T,ra.sa.selectedRanges),activeCell:T}}return{returnValue:"",
activeCell:T}};Wd.prototype.sKh=function(T){var ra=new Sys.StringBuilder;ra.append(Wd.WVg(T));var hb=this.$.da.Aa(231);hb&&Ub(ra,hb.ZZe(T.Oa.oc.floatingObject,!1));return ra.toString()};Wd.prototype.K4h=function(T){T=T.vbf();var ra=!1;this.uD.lgf!==T&&(this.uD.lgf=T,ra=!0);return ra};Wd.prototype.BJg=function(T,ra){if(ra.cxb)if(ra=this.sparklineManager.OXh(ra)){var hb=Fe.a.instance,Eb=hb.fa;a:switch(ra.type){case 0:var sc=824;break a;case 1:sc=825;break a;default:sc=826}hb=Eb.call(hb,sc);Ub(T,String.format(Fe.a.instance.Ab(25),
hb));ra=String.format(Fe.a.instance.Ab(24),md.hgd(ra.VCj));Ub(T,ra)}else fc.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),Ub(T,String.format(Fe.a.instance.Ab(25),""))};Wd.prototype.SJg=function(T,ra){switch(ra){case 1:case 11:Ub(T,Fe.a.instance.fa(844));break;case 6:Ub(T,Fe.a.instance.fa(844));Ub(T,Fe.a.instance.fa(846));break;case 7:Ub(T,Fe.a.instance.fa(844));Ub(T,Fe.a.instance.fa(847));break;case 2:Ub(T,Fe.a.instance.fa(845));Ub(T,Fe.a.instance.fa(846));
break;case 3:Ub(T,Fe.a.instance.fa(845));Ub(T,Fe.a.instance.fa(847));break;default:Ub(T,Fe.a.instance.fa(845))}};Wd.prototype.yJg=function(T,ra){var hb,Eb=this.$.da.Aa(65);ra=Eb?Eb.ZJa(ra.range):null;var sc="",vb=Object(ug.a)(642,ra);if(ra)sc=!ra.z6a&&vb&&vb.Ymi?String.format(Fe.a.instance.Ab(29),vb.lHj):String.format(Fe.a.instance.Ab(23),ra.author);else if(null===(hb=null===Eb||void 0===Eb?void 0:Eb.Rm)||void 0===hb?0:hb.kF)sc=String.format(Fe.a.instance.Ab(28),Eb.Rm.AN.author);Ub(T,sc)};Wd.LIg=
function(T){return String.format(Fe.a.instance.Ab(52),Wd.Z$b(T.altText,T.altTextDescription,T.name),T.altTextDescription)};Wd.pPh=function(T){return Fe.a.instance.fa(T.vbf()?834:835)};Wd.Z$b=function(T,ra,hb){return T||ra?T:hb};Wd.WVg=function(T){var ra=T.Oa.oc;T=ra.floatingObject;var hb=T.$c,Eb=hb.ChartTitle,sc=T.altText,vb=T.altTextDescription,Wc=!!(hb.Attributes&4);return(ra=ra.getSelectionDescription())?ra:hb.DataRangeForDisplay?String.format(Fe.a.instance.Ab(Wc?49:47),Wd.Z$b(sc,vb,T.name),vb,
Eb,Fe.a.instance.fa(bd(hb.ChartCategory)),hb.DataRangeForDisplay):String.format(Fe.a.instance.Ab(Wc?50:48),Wd.Z$b(sc,vb,T.name),vb,Eb,Fe.a.instance.fa(bd(hb.ChartCategory)))};Wd.avj=function(T){return df.EwaSettings.ma(103)&&(T.i6a||T.rgc)};Wd.zJg=function(T,ra){if(!ra.DSa)fc.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(ra.i6a)ra=ra.DSa.topLeft.toString(),Ub(T,String.format(Fe.a.instance.Ab(26),
ra));else if(ra.rgc){var hb=ra.DSa.SS();ra=(hb.LastColumn-hb.FirstColumn+1).toString();hb=(hb.LastRow-hb.FirstRow+1).toString();Ub(T,String.format(Fe.a.instance.Ab(27),ra,hb))}};Wd.$uj=function(T,ra,hb){return T.IH||!df.EwaSettings.ma(139)?!1:(T=hb.da.Aa(271))?T.Qfc(ra):!1};Wd.wni=function(T){return T.top===T.bottom&&T.left+1===T.right||T.top+1===T.bottom&&T.left===T.right};Ek.Object.defineProperties(Wd.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return Mf.g(this.$).kc(null)}}});
Wd.zWj=268435712;Wd.KTc=500;Object(je.a)(Wd,"SelectionReadoutHandler",null,[943,3]);var Ue=b(55),jf=ac.a;Am(we,jf);we.prototype.create=function(){var T=this,ra=this.$.da,hb=cc.GetServiceTaskFactory.Va(ra,211,212,this.ub),Eb=cc.GetServiceTaskFactory.Va(ra,66,134,this.ub),sc=cc.GetServiceTaskFactory.Va(ra,240,239,this.ub),vb=Ue.Task.Sa(null);df.EwaSettings.Fb()&&(vb=cc.GetServiceTaskFactory.Va(ra,244,315,this.ub));Rc.TaskExtensions.Ba(Rc.TaskExtensions.ye([hb,Eb,sc,vb],this.la),function(){var Wc=ra.Aa(226)||
new Wd(hb.result,T.$,Eb.result,sc.result,vb.result);T.Eb(Wc)},this.$.la,3)};we.ka=function(T){T.da.Ga(227,new we(T))};Object(je.a)(we,"SelectionReadoutHandlerFactory",ac.a,[]);Ad.prototype.ILf=function(){var T=this.AIh();this.ariaLiveNotifier.Iab(T,re.a.kob)};Ad.prototype.AIh=function(){var T=new Sys.StringBuilder;this.$.workbookContext&&Ub(T,this.$.workbookContext.WorkbookFileName);Ub(T,Fe.a.instance.fa(850));Ub(T,this.CIh());Ub(T,this.BIh());Ub(T,Fe.a.instance.fa(851));return T.toString()};Ad.prototype.CIh=
function(){return this.$.isEditMode?Fe.a.instance.fa(855):Fe.a.instance.fa(856)};Ad.prototype.BIh=function(){var T=this.HVj(),ra=this.$.xa.qa;T=1!==T?String.format(Fe.a.instance.Ab(32),T):Fe.a.instance.fa(849);T=new Sys.StringBuilder(T);ra&&ra.sheetName&&(T.append(Hc.Rud),T.append(String.format(Fe.a.instance.Ab(33),ra.sheetName)));return T.toString()};Ad.prototype.HVj=function(){for(var T=0,ra=El(this.$.xa.items),hb=ra.next();!hb.done;hb=ra.next())hb.value.visible&&T++;return T};Object(je.a)(Ad,"WorkbookReadout",
null,[]);Ob.prototype.dispose=function(){this.r$b&&this.r$b.Zaj(this.xyf);this.r$b=this.ariaLiveNotifier=this.$=null};Object(je.a)(Ob,"EmbeddedWorkbookReadoutHandler",null,[3]);Zc.prototype.dispose=function(){this.vm();this.ariaLiveNotifier=this.oZ=null;this.Od=!0};Zc.prototype.Ck=function(){if(this.oZ){this.oZ.Nt(this.xW);this.oZ.Ea.Gx(this.xW);this.oZ.nE(this.xW);var T=Object(ug.a)(439,this.oZ);T&&(T.rc.ml(this.xW),T.ha.SG(this.xW),T.ha.zJ(this.xW),T.ha.Oa.P2(this.xW))}else fc.ULS.sendTraceTag(537153923,
0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")};Zc.prototype.vm=function(){if(this.oZ){this.oZ.Ea.Dv(this.xW);this.oZ.UF(this.xW);var T=Object(ug.a)(439,this.oZ);T&&(T.rc.fl(this.xW),T.ha.WF(this.xW),T.ha.lO(this.xW),T.ha.Oa.Oma(this.xW))}};Zc.prototype.Ipe=function(){this.K_d.ILf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.bpj();this.dispose()};Object(je.a)(Zc,"WorkbookReadoutHandler",null,[3]);var Hf=ac.a;Am(Ud,Hf);Ud.prototype.create=function(){var T=
this,ra=cc.GetServiceTaskFactory.Va(this.$.da,211,212,this.ub);if(this.$.kN){var hb=cc.GetServiceTaskFactory.Va(this.$.da,12,477,this.ub);Rc.TaskExtensions.Ba(Rc.TaskExtensions.ye([ra,hb],this.$.la),function(){var Eb=new Ob(ra.result,T.$,hb.result);T.Eb(Eb)},this.$.la,3)}else Rc.TaskExtensions.Ba(ra,function(Eb){Eb=new Zc(Eb.result,T.$);T.Eb(Eb)},this.$.la,3)};Ud.ka=function(T){T.da.Ga(229,new Ud(T))};Object(je.a)(Ud,"WorkbookReadoutHandlerFactory",ac.a,[]);var bg=b(38),Dd=b(248),oc=b(375),nc=b(190),
cf=b(706),Jg=bg.a;Am(hd,Jg);hd.prototype.dispose=function(){this.view&&(this.view.Ea.Vq(this.zf),this.view.Ea.tI(this.Sm),this.view.Ea.ibb(this.zf),this.view.Ea.WHb(this.zf),this.view.$.xa.bL(this.Go),this.view.$.Hb.bL(this.Go));this.HT=this.hje=null;Jg.prototype.dispose.call(this)};hd.prototype.dZb=function(T){T=this.xGd(T);var ra=df.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.view.tH:this.view.Gh;if(T&&0<T.length&&ra)for(var hb=0,Eb=T.length;hb<
Eb;hb++)ra.contains(this.HT[hb])||this.HT.push(nc.a.RQ(T[hb]))};hd.prototype.FHb=function(){var T=df.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.view.tH:this.view.Gh;if(this.HT.length&&T)for(var ra=this.HT.length-1;0<=ra;ra--)T.contains(this.HT[ra])||Array.removeAt(this.HT,ra)};hd.prototype.h1e=function(T){return this.C0e(T)};hd.prototype.C0e=function(T){T=Ka.I(T,this.HT,!0);return 0<T.length?T[0]:null};Ek.Object.defineProperties(hd.prototype,
{rangeList:{configurable:!0,enumerable:!0,get:function(){return this.HT}},view:{configurable:!0,enumerable:!0,get:function(){return this.hje}}});hd.yGd="lrc";Object(je.a)(hd,"LoadedRangeCollection",bg.a,[]);Am(pc,hd);pc.prototype.OXh=function(T){for(var ra=El(this.rangeList),hb=ra.next();!hb.done;hb=ra.next())if(hb=hb.value,T.range.contains(hb))return hb;return null};pc.prototype.xGd=function(T){return T.GridBlockModel&&(T=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(T.GridBlockModel))?
T.getSparklineRanges():null};Object(je.a)(pc,"SparklineManager",hd,[939]);var Re=ac.a;Am(Vb,Re);Vb.prototype.create=function(){this.Eb(this.sparklineManager||(this.sparklineManager=new pc(Mf.g(this.$),this.$.da)))};Vb.ka=function(T){T.da.Ga(239,new Vb(T))};Object(je.a)(Vb,"SparklineManagerFactory",ac.a,[]);var ve=b(54),zf=b(300);Na.oOe="ewa-svg-icon";Object(je.a)(Na,"CssClassNames",null,[]);var zg=b(324),Ed=b(256);wa.prototype.dispose=function(){this.KUd=null;this.$.ea.Wn(this.Jg)};wa.prototype.Ava=
function(T,ra,hb,Eb,sc){Eb=void 0===Eb?null:Eb;sc=void 0===sc?null:sc;var vb;(vb=this.KUd[T])||(this.KUd[T]=vb=this.yWi(this.v7f[T]));if(!vb)return fc.ULS.shipAssertTag(537151262,0,!1,"SvgIconProvider.GetSvgElement: id {0} was not found in loaded SVG sprites.",T),null;var Wc=vb.cloneNode(!0);if(!Wc.style){var Zd=zg.b(vb),uf=zg.b(Wc),If={};If.iconId=T;If.isOriginalNodeStyleNull=void 0===vb.style||null===vb.style;If.isOriginalNodeCurrentStyleNull=void 0===vb.currentStyle||null===vb.currentStyle;If.isClonedNodeCurrentStyleNull=
void 0===Wc.currentStyle||null===Wc.currentStyle;If.originalNode=Zd.substring(0,Zd.indexOf(">")+1);If.clonedNode=uf.substring(0,uf.indexOf(">")+1);fc.ULS.sendTraceTag(537151261,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: {0}",JSON.stringify(If))}T=String.format("height: {0}px; width: {0}px;",ra,hb);Wc.setAttribute("style",T);sc&&(T=document.createElement("title"),T.innerHTML=sc,Wc.insertBefore(T,Wc.childNodes[0]));if(Eb)for(Eb=El(Eb),sc=Eb.next();!sc.done;sc=Eb.next())Sys.UI.DomElement.addCssClass(Wc,
sc.value);return Wc};wa.prototype.oba=function(T,ra,hb,Eb,sc,vb,Wc,Zd){sc=void 0===sc?0:sc;vb=void 0===vb?0:vb;Wc=void 0===Wc?null:Wc;Zd=void 0===Zd?null:Zd;sc&&vb||(vb=se.DOMElementExtensions.getBoundingClientRect(Eb),sc=vb.height,vb=vb.width);if(Wc=this.Ava(T,ra,hb,Wc,Zd))Eb.appendChild(Wc),(Eb=se.DOMElementExtensions.KZ(Wc,"style",null))?Wc.setAttribute("style",Eb+String.format(" margin: {0}px {1}px;",(sc-ra)/2,(vb-hb)/2)):fc.ULS.sendTraceTag(537151260,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: {0}',
T);return Wc};wa.prototype.skf=function(){var T=this;Rc.TaskExtensions.Ba(cc.GetServiceTaskFactory.Va(this.$.da,283,284,0),function(ra){ra=Ed.c(ra.result.Jn.loadScript("excel-uiSlice20-sprite"));Rc.TaskExtensions.Ba(ra,function(){var hb=T.NZe("excelUiSlice20Sprite");hb?T.pme(hb):fc.ULS.sendTraceTag(537151259,0,15,"window[{0}].icons returned null.","excelUiSlice20Sprite")},T.$.la,3)},this.$.da.la,3)};wa.prototype.pme=function(T){T=El(T);for(var ra=T.next();!ra.done;ra=T.next())ra=ra.value,ra.type===
Ib.a.t7f&&(this.v7f[ra.id]=ra)};wa.prototype.yWi=function(T){if(!T)return null;var ra=T.viewBox;T=T.children;var hb=document.createElementNS(zf.a.MUd,Ib.a.t7f);Sys.UI.DomElement.addCssClass(hb,Na.oOe);hb.setAttribute("focusable","false");hb.setAttribute("viewBox",ra);this.FCg(hb,T);return hb};wa.prototype.FCg=function(T,ra){ra=El(ra);for(var hb=ra.next();!hb.done;hb=ra.next()){hb=hb.value;var Eb=document.createElementNS(zf.a.MUd,hb.type),sc;for(sc in hb){var vb=sc,Wc=hb[sc];"className"===vb?Eb.setAttribute("class",
Wc):Eb.setAttribute(vb,Wc)}T.appendChild(Eb)}};wa.prototype.NZe=function(T){return(T=window[T])?T.icons:null};Object(je.a)(wa,"SvgIconProvider",null,[938,3]);var rf=ac.a;Am(kd,rf);kd.prototype.create=function(){var T=this;Rc.TaskExtensions.Ba(ve.a.E_([106],4,this.ub,void 0,void 0,void 0,387),function(){var ra=df.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite";window[ra]?T.Eb(T.$.da.Aa(388)||new wa(T.$)):fc.ULS.sendTraceTag(537151258,
0,50,"window.[{0}] returned null.",ra)},this.la,3)};kd.ka=function(T){T.da.Ga(387,new kd(T))};Object(je.a)(kd,"SvgIconProviderFactory",ac.a,[]);var Uf=b(438),lg=b(570),ni=b(245),he=b(167),Ke=b(128),Qg=b(10),Rg=b(354),Oe=b(178),Df=b(13),Zg=b(160),qh=b(244),Xi=b(105),uh=b(43),Sf=b(33),ji=ge.a;Am(zc,ji);zc.prototype.dispose=function(){this.Ibb();this.tableManager.N$i(this.juf);this.Vgf||Da.a.rp||Da.a.Bka||Oe.a.instance.za(Df.a.pointerDown,this.aba,this.onPointerDown);if(this.vB){qh.b(this.$,!1);try{this.Tv()}catch(T){fc.ULS.sendTraceTag(537151236,
0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",T)}}this.parentElement&&this.parentElement.contains(this.aba)&&this.parentElement.removeChild(this.aba);this.aba=this.parentElement=null;ji.prototype.dispose.call(this)};zc.prototype.r3e=function(T){var ra=T.bottom-this.Zn.topLeft.bottom-1;return 0<=T.right-this.Zn.topLeft.right+1&&0<=ra&&T.bottom>=this.Zn.top&&T.right>=this.Zn.left?new Se.Range(this.Zn.top,this.Zn.left,T.bottom,T.right,!1,!1):this.qt};zc.prototype.ikd=
function(T){this.mwc([this.qt],6,void 0===T?!0:T);this.Cb.Fn(this.O7f)};zc.prototype.LHb=function(T){T=void 0===T?!0:T;this.Cb.Nh(this.O7f);this.mwc([null],6,T)};zc.prototype.wId=function(T){T=void 0===T?!0:T;this.Cb.Nh(this.I7f);this.mwc([null],26,T)};zc.prototype.w6h=function(){var T=!1;T=void 0===T?!0:T;var ra=this.ZGj();0<ra.length&&(this.mwc(ra,26,T),this.Cb.Fn(this.I7f))};zc.prototype.ZGj=function(){var T=[];this.Zn.contains(this.qt)&&(this.Zn.right!==this.qt.right&&T.push(new Se.Range(this.Zn.top,
this.qt.right+1,this.qt.bottom,this.Zn.right,!1,!1)),this.Zn.bottom!==this.qt.bottom&&T.push(new Se.Range(this.qt.bottom+1,this.Zn.left,this.Zn.bottom,this.Zn.right,!1,!1)));return T};zc.prototype.resizeTable=function(){if(!this.qt.equals(this.Zn)){var T=new Se.Range(this.Zn.top,this.Zn.left,this.qt.bottom,this.qt.right,!1,!1);this.NLj(T);this.Iqd=!0}};zc.prototype.onKeyDown=function(T){Sf.a(this.$).je(T);return!0};zc.prototype.D9a=function(){this.Vgf&&(Da.a.rp||Da.a.Bka||(Oe.a.instance.pa(Df.a.pointerDown,
this.aba,this.onPointerDown),this.aba.classList.remove("ewr-table-resize-default-cursor"),this.OLc=this.aba.disabled=!1),this.OLc=!1)};zc.prototype.qRg=function(){var T=document.createElement("div");T.className="ewr-table-resize-handle";var ra=document.createElement("div");ra.className="ewr-table-resize-fillhandle-higher";var hb=document.createElement("div");hb.className="ewr-table-resize-fillhandle-broader";T.appendChild(ra);T.appendChild(hb);this.aba=T;this.parentElement.appendChild(this.aba)};
zc.prototype.X0b=function(T){var ra=this,hb=this.qt.contains(T),Eb=T.top,sc=T.bottom,vb=T.left;T=T.right;var Wc=null;if(hb){if(this.gridView.p_(this.Zn.topLeft)&&!this.Zn.xSa)return;Eb=Math.max(1,sc-5,this.Zn.top);vb=Math.max(1,T-5,this.Zn.left);sc=Eb;T=vb;Wc=new Se.Range(Eb,vb,Eb,vb,!1,!1)}else sc+=5,T+=5,Eb=sc,vb=T,Wc=new Se.Range(sc,T,sc,T,!1,!1);this.gridView.p_(Wc)||(this.Tr?this.Tr.vp||(this.Tr=Yb.a.instance.create(function(){ra.gridView.nt(Wc,60,Xi.a.L7f)},40,Ec.a.M7f)):this.Tr=Yb.a.instance.create(function(){ra.gridView.nt(Wc,
60,Xi.a.L7f)},40,Ec.a.M7f))};zc.prototype.WYa=function(T){var ra=T;if(this.gridView.rb.U4){if(!this.gridView.kc(T.topLeft)){var hb=this.gridView.vk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.tH,this.qt.top!==T.top?1:2);try{hb.al=this.qt.top<T.top||this.qt.left<T.left,hb.ps(T.topLeft),ra=hb.$$cu().range}finally{hb&&hb.dispose()}}ra.right=ra.left+T.width-1;ra.bottom=ra.top+T.height-1}return ra};zc.prototype.mwc=function(T,ra,hb){hb=void 0===hb?!0:hb;var Eb=[];T=El(T);for(var sc=T.next();!sc.done;sc=
T.next())Eb.push(new Rg.a(sc.value,Rd.d(this.$.qa)));this.Cb.jx(Eb,[ra],!0,void 0,hb)};zc.prototype.X7i=function(){for(var T=El(this.gridView.yn),ra=T.next();!ra.done;ra=T.next())Oe.a.instance.pa(Df.a.vh,ra.value.domElement,this.Sh);Oe.a.instance.pa(Df.a.$d,document.documentElement,this.Of);this.UHe()};zc.prototype.K8i=function(){for(var T=El(this.gridView.yn),ra=T.next();!ra.done;ra=T.next())Zg.a.instance.pa(Df.a.yg,ra.value.domElement,this.Sh);Zg.a.instance.pa(Df.a.De,document.documentElement,this.jFb);
this.UHe()};zc.prototype.Tv=function(){this.Dzb&&this.AOj();this.Aic&&this.LOj()};zc.prototype.AOj=function(){for(var T=El(this.gridView.yn),ra=T.next();!ra.done;ra=T.next())Oe.a.instance.za(Df.a.vh,ra.value.domElement,this.Sh);Oe.a.instance.za(Df.a.$d,document.documentElement,this.Of);this.LMf()};zc.prototype.LOj=function(){for(var T=El(this.gridView.yn),ra=T.next();!ra.done;ra=T.next())Zg.a.instance.za(Df.a.yg,ra.value.domElement,this.Sh);Zg.a.instance.za(Df.a.De,document.documentElement,this.jFb);
this.LMf()};zc.prototype.UHe=function(){Oe.a.instance.pa(Df.a.Fy,document.documentElement,this.yca);this.gridView.wc.Q7b(!0)};zc.prototype.LMf=function(){Oe.a.instance.za(Df.a.Fy,document.documentElement,this.yca);this.gridView.wc.Q7b(!1)};zc.prototype.NLj=function(T){var ra={};T=(ra.ResizeTableRange=T,ra.OriginalTableRange=this.Zn,ra);this.$.Xd(-1400250766,ce.a.Ub,30,T)};zc.prototype.jQj=function(T){if(!this.Zn.contains(T)){T=this.YGj();T=El(T);for(var ra=T.next();!ra.done;ra=T.next())if(this.tableManager.grd(ra.value)){this.gridView.rg.Mo(re.a.ZCi);
return}}this.gridView.rtl?this.gridView.rg.Mo(re.a.dCi):this.gridView.rg.Mo(re.a.qEi)};zc.prototype.Ibb=function(){if(this.vB){qh.b(this.$,!1);try{this.Tv()}catch(T){fc.ULS.sendTraceTag(537151232,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",T)}}this.Tr&&(this.Tr.cancel(),this.Tr.dispose());this.Aic=this.Dzb=!1;this.LHb();this.wId();qh.b(this.$,!1);this.gridView.rg.Mo(re.a.P4)};zc.prototype.YGj=function(){var T=[];this.Zn.right!==this.qt.right&&T.push(new Se.Range(this.Zn.top,
this.Zn.right+1,this.qt.bottom,this.qt.right,!1,!1));this.Zn.bottom!==this.qt.bottom&&T.push(new Se.Range(this.Zn.bottom+1,this.Zn.left,this.qt.bottom,this.Zn.right,!1,!1));return T};zc.createInstance=function(T,ra,hb,Eb){if(!ra)return null;var sc=T.Cb;sc.jx(hb,[27],!0);sc.Fn(zc.TGj);hb=sc.Hw(27,T.rb.sj(ra.bottomRight),zc.eNh(ra,hb)).Nf;return new zc(hb,T,ra,Eb)};zc.eNh=function(T,ra){for(var hb,Eb=0;Eb<ra.length;Eb++)if((null===(hb=ra[Eb])||void 0===hb?0:hb.range)&&ra[Eb].range.equals(T))return Eb;
return 0};Ek.Object.defineProperties(zc.prototype,{vB:{configurable:!0,enumerable:!0,get:function(){return this.Dzb||this.Aic}},Vgf:{configurable:!0,enumerable:!0,get:function(){return this.OLc}}});zc.TGj=[27];Object(je.a)(zc,"TableResizeBehavior",ge.a,[]);var Uh=b(242);vc.lsh="ewa-ttrd-buttonarea";Object(je.a)(vc,"CssClassNames",null,[]);var sh=b(48),Jh=b(131),Dh=b(132),Og=b(272),oi=Uh.a;Am(Za,oi);Za.prototype.dispose=function(){this.$&&this.Edh();this.$=this.gridView=this.parentElement=this.MKa=
null;oi.prototype.dispose.call(this)};Za.prototype.VKh=function(T){var ra=this.CZh(this.gridView.kc(null).range);return ra?String.format("=SUBTOTAL({0},{1})",T,ra):null};Za.prototype.CZh=function(T){var ra=Mf.g(this.$).Rb.Qj(T);if(!ra)return null;ra=he.a(ra,!1);ra.right=ra.left=T.left;return ra.toString()};Za.prototype.Q$h=function(){Za.oM={};Za.oM["100"]=Fe.a.instance.fa(1071);Za.oM["101"]=Fe.a.instance.fa(1074);Za.oM["102"]=Fe.a.instance.fa(1073);Za.oM["103"]=Fe.a.instance.fa(1078);Za.oM["104"]=
Fe.a.instance.fa(1075);Za.oM["105"]=Fe.a.instance.fa(1076);Za.oM["109"]=Fe.a.instance.fa(1072);Za.oM["107"]=Fe.a.instance.fa(1079);Za.oM["110"]=Fe.a.instance.fa(1081);Za.oM["111"]=Fe.a.instance.fa(1132)};Za.prototype.XVi=function(){var T=this.gridView.kc(null);if(T&&(T=T.IH?T.formulaBarText:null))if("=SUBTOTAL("===T.substring(0,10)){if(T=T.substring(10,13),T in Za.oM)return T}else return"111";return"100"};Za.prototype.JLg=function(){this.gridView.Ea.Us(this.zf);this.gridView.ha.zJ(this.Rh);this.gridView.Nt(this.onContentReady);
this.gridView.wc.ml(this.ouf);this.gridView.wc.mo(this.RDb)};Za.prototype.Edh=function(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.lO(this.Rh),this.gridView.Ea.Vq(this.zf)),this.gridView.cx(this.onContentReady),this.gridView.wc&&(this.gridView.wc.fl(this.ouf),this.gridView.wc.Dn(this.RDb)),this.ybg())};Za.prototype.drb=function(T){this.uQj(T);this.tAb&&(this.zFj(),this.Lmb?(this.pFf||this.ULg(),this.NTc?this.k5=!1:(this.k5=!0,this.MQf())):(fc.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),
this.k5=!1))};Za.prototype.MQf=function(){var T=this;appChrome.renderTableTotalRowOptions(this.parentElement,Za.oM,Za.oM[this.XVi()].toString(),Math.round(Sf.a(this.$).Ei(17)),function(ra){fc.ULS.sendTraceTag(537151198,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : {0}",ra);var hb={};hb=(hb.SelectedOption=Za.oM[ra],hb.FunctionKeyCode=ra,hb.Location="canvas",hb);Dh.b(T.$).Vd(Jh.a.cHj,hb,null,!0);if("111"===ra)return T.odi(),!0;if("100"!==ra){T.PJb=T.VKh(ra);if(!T.PJb)return fc.ULS.sendTraceTag(537151197,
0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;T.uRa(T.PJb)}else T.uRa("");se.DOMElementExtensions.setFocus(T.gridView.rc.textBox.domElement);return!0})};Za.prototype.odi=function(){fc.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");var T=new yd.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Xb(T)};Za.prototype.qva=function(T){if(!T)return null;var ra=this.gridView.wc.textBox.domElement;
var hb=0<se.DOMElementExtensions.getHeight(ra)&&0<se.DOMElementExtensions.getWidth(ra)&&0<=ra.offsetTop&&0<=ra.offsetLeft;if(hb)ra=se.DOMElementExtensions.qva(ra,this.gridView.Nj);else{ra=this.gridView.getCellBounds(T.cell);var Eb=se.DOMElementExtensions.getBoundingClientRect(this.gridView.Nj);ra=new Sys.UI.Bounds(ra.x-Eb.x,ra.y-Eb.y,ra.width,ra.height)}if(ra)if(hb)2<ra.height&&2<ra.height&&(ra.x+=1,ra.y+=1,ra.height-=2,ra.width-=2);else if(hb=Mf.g(this.$).$J(T.cell))hb=hb.width,Eb=tg.a.equals(wg.a.E3a(T.cell,
this.gridView.rtl),"right",!0),this.gridView.rtl&&Eb&&(ra.x=ra.x+ra.width-hb),T.Lka&&this.gridView.rtl===Eb&&(ra.width=hb);else return null;return ra};Za.prototype.uQj=function(T){var ra=this.Lmb;if(ra){var hb=17>=ra.height?ra.y:ra.y+ra.height-17-2;ra=this.Uii?this.gridView.rtl?ra.x:ra.x+ra.width-(17<ra.height?17:ra.height):this.gridView.rtl?ra.x-(17<ra.height?17:ra.height):ra.x+ra.width;var Eb=Sf.a(this.$).Aja(new Sys.UI.Point(ra,hb));this.parentElement.style.top=Qg.HelperMethods.nc(Eb.y);this.parentElement.style.left=
Qg.HelperMethods.nc(Eb.x);Sf.a(this.$).Sqj(this.parentElement);T&&(this.k5=this.gridView.Jic(new sh.a(ra,hb)))}else this.k5=!1};Za.prototype.ULg=function(){this.MKa.insertBefore(this.parentElement,this.MKa.firstChild);this.pFf=!0};Za.prototype.zFj=function(){this.cR||(this.gridView.view.Vs(this.tt),this.cR=!0)};Za.prototype.ybg=function(){this.cR&&this.gridView.view&&(this.gridView.view.Xq(this.tt),this.cR=!1)};Za.prototype.uRa=function(T){var ra=this.gridView.rc,hb=this.gridView.kc(null);hb&&(T=
Object(We.a)(new Og.a,{Text:T}),this.gridView.setCell(T,hb.range,0,127,null),ra.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))};Ek.Object.defineProperties(Za.prototype,{k5:{configurable:!0,enumerable:!0,get:function(){return this.bod},set:function(T){this.bod!==T&&(this.bod=this.isVisible=T)}},tAb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Pd&16)}},Uii:{configurable:!0,enumerable:!0,get:function(){var T=this.gridView.ha.sa.activeCell;return T.right===T.maxColumns}},Lmb:{configurable:!0,
enumerable:!0,get:function(){var T=this.gridView.kc(null);return T&&this.gridView.w5(T.range)?this.qva(T):(T&&fc.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}}});Za.bHj="TableTotalRowDropDownIconButtonId";Za.oM=null;Object(je.a)(Za,"TableTotalRowOptions",Uh.a,[3]);Am(ub,hd);ub.prototype.Pne=function(T){this.addHandler(hd.yGd,T)};ub.prototype.aQf=function(T){this.removeHandler(hd.yGd,T)};ub.prototype.IDg=function(T){this.addHandler("tce",
T)};ub.prototype.N$i=function(T){this.removeHandler("tce",T)};ub.prototype.grd=function(T){return!!this.C0e(T)};ub.prototype.rn=function(T){return this.jVh(this.h1e(T))};ub.prototype.Qub=function(T){return this.h1e(T)};ub.prototype.G8i=function(T){T?(this.Dpb?this.Dpb!==T&&(Ne.a.Ha(this.$0),this.$0=null,this.Dpb=T):this.Dpb=T,this.$0||(this.$0=Ke.a.instance.Zd(this.Dpb)),this.$0.un("focusin")||this.$0.ka("focusin",this.onFocus)):fc.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")};
ub.prototype.ndf=function(T,ra){return T?T.eba&&T.top===ra.top:(fc.ULS.shipAssertTag(537151244,0,!!T,"autofilterRange can't be null"),!1)};ub.prototype.uva=function(T){T=this.Bpb?Ka.I(T,this.Bpb):this.view.getRangeInformation(T);return 0<T.length&&Object(Uf.a)(ni.PivotTableRange,T[0])?T[0]:null};ub.prototype.zfi=function(T,ra){return T?!T.ugc&&!!T.AM&&T.AM.Hd(ra):(fc.ULS.shipAssertTag(537151243,0,!!T,"Pivot table can't be null"),!1)};ub.prototype.xli=function(T,ra){return T?!T.ugc&&!!T.mX&&T.mX.Hd(ra):
(fc.ULS.shipAssertTag(537151242,0,!!T,"Pivot table can't be null"),!1)};ub.prototype.dZb=function(T){hd.prototype.dZb.call(this,T);if((T=Qg.HelperMethods.P0e(T))&&0<T.length){this.Bpb=Array(T.length);for(var ra=0;ra<T.length;ra++)this.Bpb[ra]=nc.a.RQ(T[ra])}};ub.prototype.FHb=function(){hd.prototype.FHb.call(this);this.Bpb=null};ub.prototype.w3g=function(T,ra){return this.uCe(T,ra).returnValue};ub.prototype.uCe=function(T,ra){var hb=this;var Eb=!1;if(!T||!ra)return{returnValue:!1,TY:Eb};T=T.clone();
T.right+=1;T.left=T.right;if(!T.isValidRange)return{returnValue:!1,TY:Eb};if(T.top<ra.rb.$i){var sc=T.clone();sc.bottom>=ra.rb.$i&&(sc.bottom=ra.rb.$i-1);if(!function(){var Wc=hb.tCe(sc,ra);Eb=Wc.TY;return Wc}().returnValue)return{returnValue:!1,TY:Eb}}if(T.bottom>=ra.rb.$i){var vb=T.clone();vb.top<=ra.rb.$i&&(vb.top=ra.rb.$i);if(!function(){var Wc=hb.tCe(vb,ra);Eb=Wc.TY;return Wc}().returnValue)return{returnValue:!1,TY:Eb}}return{returnValue:!0,TY:Eb}};ub.prototype.N7f=function(T){(T=this.rn(T.topLeft))&&
T.toString()in this.uFa&&(this.uFa[T.toString()].Iqd=!1)};ub.prototype.C2i=function(){this.raiseEvent("tce")};ub.prototype.Wh=function(T,ra){if(!this.Ezc)return!1;switch(ra){case -569786022:case 541421805:if(this.Ezc.k5){var hb=document.getElementById(Za.bHj);hb&&Yb.a.instance.create(function(){se.DOMElementExtensions.rfc(hb,null)},0,Ec.a.WGj,!0,!0)}return!0;default:return!1}};ub.prototype.dispose=function(){this.u2b(null,null);this.aQf(this.t0b);this.$.xa.Xg(this.WKf);this.$.rm(this.u2b);this.rQb=
null;this.$.ea&&this.$.ea.x0(this.o6);this.gridView.ha.lO(this.Rh);this.Ezc=null;df.EwaSettings.ma(412)&&this.$0&&(Ne.a.Ha(this.$0),this.$0=null);hd.prototype.dispose.call(this)};ub.prototype.c4h=function(T,ra,hb,Eb){var sc=this.gridView.Rb.Qj(new Se.Range(ra,hb,ra,hb,!1,!1));if(this.E5b=sc){var vb=sc.usedRange,Wc=T.ctrlKey||Da.a.isMac&&od.b(T),Zd=!T.shiftKey&&Wc;T=T.shiftKey&&!Wc;df.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(Mf.g(this.$).ha.selectionType=3);switch(Eb){case 0:this.MRb=
0;df.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ra=this.z4c(T,vb.top,hb,vb.bottom,hb),this.xPd(ra,Zd,T)):this.yPd(vb.top,hb,vb.bottom,hb,he.d(sc),he.g(sc),Zd);break;case 1:this.MRb=1;df.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ra=this.z4c(T,ra,vb.left,ra,vb.right),this.xPd(ra,Zd,T)):this.yPd(ra,vb.left,ra,vb.right,!1,!1,Zd);break;case 2:this.MRb=2;df.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(ra=this.z4c(T,vb.top,vb.left,vb.bottom,vb.right),this.xPd(ra,Zd,T)):this.yPd(vb.top,vb.left,vb.bottom,vb.right,he.d(sc),he.g(sc),Zd);break;default:fc.ULS.shipAssertTag(537151240,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: {0}",Eb.toString());return}df.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(Mf.g(this.$).ha.selectionType=3);fc.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else fc.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")};ub.prototype.xvj=function(T){var ra=this.E5b.usedRange;return this.wff(T)||1!==this.cIa&&this.wff(new Se.Range(ra.top,T.left,ra.bottom,T.right,!1,!1))?!0:!1};ub.prototype.xGd=function(T){return T.Autofilters};ub.prototype.tCe=function(T,ra){var hb=!1;var Eb=ra.rb.sj(T),sc=ra.Tf(Eb).Gh;if(!sc)return fc.ULS.sendTraceTag(537151238,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",
Eb),{returnValue:!1,TY:hb};if(!sc.Me(T))return{returnValue:!0,TY:hb};T=ra.vk("TableManager.CouldExpandImpl",T,2);try{for(;T.$$mn();){if(T.$$cu().text||T.to.I6e)return hb=!0,{returnValue:!1,TY:hb};if(T.$$cu().rF)return{returnValue:!1,TY:hb}}}finally{T&&T.dispose()}return{returnValue:!0,TY:hb}};ub.prototype.jVh=function(T){if(!T)return null;var ra=new lg.AutofilterRange(T.top,T.left,T.bottom,T.right,null,null,null,T.id,T.eba);ra.xSa=T.xSa;for(var hb=0,Eb=this.rangeList.length;hb<Eb;hb++){var sc=this.rangeList[hb];
sc.id===T.id&&sc!==T&&this.Fki(sc)&&(ra.union(sc),sc.xSa&&(ra.xSa=!0))}return ra};ub.prototype.Fki=function(T){return!!Mf.g(this.$).Rb.Qj(T)};ub.prototype.ZHh=function(){for(var T=[],ra=El(this.rangeList),hb=ra.next();!hb.done;hb=ra.next())hb=new Rg.a(this.rn(hb.value.topLeft),Rd.d(this.$.qa)),T.push(hb);return T};ub.prototype.lgd=function(){for(var T={},ra=El(this.rangeList),hb=ra.next();!hb.done;hb=ra.next())if(hb=hb.value){var Eb=this.rn(hb.topLeft);Eb&&(T[Eb.toString()]=this.rn(hb.topLeft))}return T};
ub.prototype.usi=function(){this.$.ea.sh?this.eyb(0):this.$.ea.Fl(this.HN)};ub.prototype.eyb=function(T){var ra=this;this.$.RC(function(hb){hb.Wua(T).then(ra.pGb)})};ub.prototype.FYh=function(T){var ra=this.gridView.Rb.Qj(T);return ra?ra.name:T.toString()};ub.prototype.yPd=function(T,ra,hb,Eb,sc,vb,Wc){var Zd=T+(sc?1:0),uf=hb-(vb?1:0),If=this.gridView.inRangePicker||this.gridView.Mi,ng=!1,gg=new Se.Range(Zd,ra,uf,Eb,!1,!1);if(sc||vb)for(sc=If?Rg.a.wrb(this.gridView.ha.rangePicker.XK):this.gridView.ha.sa.selectedRanges,
sc=El(sc),vb=sc.next();!vb.done;vb=sc.next()){vb=vb.value;ng=this.Fqb(vb,Zd,ra,uf,Eb);var Wh=this.Fqb(vb,T,ra,hb,Eb);if(If&&ng)break;if(!If&&(ng||Wh)){this.gridView.ha.updateSelection(vb,vb.topLeft,0,1);if(Wc&&Wh)return;break}}ng&&(gg.top=T,gg.bottom=hb);T=gg.topLeft;Wc?this.gridView.ha.updateSelection(gg,T,0,1):If?this.gridView.ha.ED([gg],0,T,0):this.gridView.ha.updateSelection(gg,T,0,3)};ub.prototype.xPd=function(T,ra,hb){T&&(hb=hb?Mf.g(this.$).ha.sa.activeCell:T.topLeft,ra?this.gridView.ha.updateSelection(T,
hb,0,1):this.gridView.ha.ED([T],0,hb,0))};ub.prototype.z4c=function(T,ra,hb,Eb,sc){var vb=he.d(this.E5b),Wc=he.g(this.E5b),Zd=ra+(1!==this.cIa&&vb?1:0),uf=Eb-(1!==this.cIa&&Wc?1:0),If=this.gridView.inRangePicker||this.gridView.Mi;if(T){var ng=df.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&If&&!Rg.a.wrb(this.gridView.ha.rangePicker.XK).length?new Se.Range(Zd,hb,uf,sc,!1,!1):If?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.sa.activeCell;ng=new Se.Range(ng.top<
Zd?ng.top:Zd,ng.left<hb?ng.left:hb,ng.bottom>uf?ng.bottom:uf,ng.right>sc?ng.right:sc,!1,!1)}else ng=new Se.Range(Zd,hb,uf,sc,!1,!1);if(1!==this.cIa&&(vb||Wc)&&(!T||T&&this.Fqb(ng,Zd,hb,uf,sc)))for(T=If?Rg.a.wrb(this.gridView.ha.rangePicker.XK):this.gridView.ha.sa.selectedRanges,T=El(T),vb=T.next();!vb.done;vb=T.next())if(this.Fqb(vb.value,Zd,hb,uf,sc)){ng.top=ra;ng.bottom=Eb;break}return ng};ub.prototype.wff=function(T){var ra=this.gridView.inRangePicker||this.gridView.Mi?Rg.a.wrb(this.gridView.ha.rangePicker.XK):
this.gridView.ha.sa.selectedRanges;ra=El(ra);for(var hb=ra.next();!hb.done;hb=ra.next())if(this.Fqb(hb.value,T.top,T.left,T.bottom,T.right))return!0;return!1};ub.prototype.Fqb=function(T,ra,hb,Eb,sc){return!!T&&T.top===ra&&T.bottom===Eb&&T.left===hb&&T.right===sc};Ek.Object.defineProperties(ub.prototype,{uFa:{configurable:!0,enumerable:!0,get:function(){return this.rQb}},qsd:{configurable:!0,enumerable:!0,get:function(){return this.s$d}},cIa:{configurable:!0,enumerable:!0,get:function(){return this.MRb}},
Eg:{configurable:!0,enumerable:!0,get:function(){var T=Mf.g(this.$);return T.Rb.Qj(T.ha.sa.activeCell,!1)}},hFd:{configurable:!0,enumerable:!0,get:function(){return this.qsd?Mf.g(this.$).Rb.Qj(this.qsd,!1):null}}});Object(je.a)(ub,"TableManager",hd,[936,3]);var $h=ac.a;Am(Zb,$h);Zb.prototype.create=function(){this.Eb(this.tableManager||(this.tableManager=new ub(this.$)))};Object(je.a)(Zb,"TableManagerFactory",ac.a,[]);var Ch=b(112),Gh=b(1024),Oi=b(1478),Di=b(934),nh=b(1430),Vg=b(84),li=b(111),wh=
b(28),Hi=b(198),lh=b(30),kg=b(292);Object(je.a)(Jb,"TableStyleElement",null,[]);var Fg=b(960),xi=b(213),Ng=b(89),Sh=b(591);Mb.Mmf=function(T,ra){return Mb.Q7f[T.Type]-Mb.Q7f[ra.Type]};Mb.U3a=function(T,ra){try{return appChrome.buildTableStyleGalleryIconNew(Mb.cBa,Mb.goa,T,ra)}catch(hb){return null}};Mb.Xgf=function(T){return T&&ce.a.ld in T&&(T=T[ce.a.ld])?tg.a.uL(T,re.a.yGb):!1};Mb.cta=function(T){var ra=[],hb=0;T=El(T);for(var Eb=T.next();!Eb.done;Eb=T.next()){Eb=Eb.value;ra[hb]={};ra[hb].backgroundColor=
"white";ra[hb].color="black";for(var sc in Eb){var vb=Eb[sc];switch(sc){case "background-color":ra[hb].backgroundColor=vb;break;case "color":ra[hb].color=vb;break;case "font-size":ra[hb].fontSize=vb;break;case "border-bottom":ra[hb].borderBottom=vb;break;case "border-right":ra[hb].borderRight=vb;break;case "border-left":ra[hb].borderLeft=vb;break;case "border-top":ra[hb].borderTop=vb}}hb++}return ra};Mb.d4b=function(T,ra){var hb=[];if(null===T||void 0===T?0:T.TableStyleElementsList)for(var Eb=0===
T.Category,sc=0;sc<Mb.goa;sc++)hb.push.apply(hb,Mb.TLh(T,ra,Eb,sc));else{if(Mb.Z5c)return Mb.Z5c;T={color:"black","background-color":"white"};for(ra=0;ra<Mb.goa;ra++)for(Eb=0;Eb<Mb.cBa;Eb++)hb.push(T);Mb.Z5c=hb}return hb};Mb.GYh=function(T,ra){if(!T.TableStyleElementsList)return"";var hb="";T=El(T.TableStyleElementsList);for(var Eb=T.next();!Eb.done;Eb=T.next())if(Eb=Eb.value,Eb.BackgroundColor&&"#000000"!==Eb.BackgroundColor)switch(Eb.Type){case 0:hb=Eb.BackgroundColor;break;case 5:case 7:if(ra.Pha||
ra.oS)hb=Eb.BackgroundColor;break;case 3:case 4:if(ra.firstCol||ra.lastCol)hb=Eb.BackgroundColor;break;case 2:ra.totalRow&&(hb=Eb.BackgroundColor);break;case 1:ra.headerRow&&(hb=Eb.BackgroundColor)}return hb};Mb.c3b=function(T){T=new xi.a(parseInt(String("0x"+T.substr(1,2)),16),parseInt(String("0x"+T.substr(3,2)),16),parseInt(String("0x"+T.substr(5,2)),16));return Fg.a.pKa(T)};Mb.N2e=function(T,ra){if(!T||!ra)return"";ra=(ra=Mb.GYh(T,ra))?Mb.c3b(ra)+", ":Fe.a.instance.fa(2023)+", ";switch(T.Index){case 0:return ra+
Fe.a.instance.fa(1957);case 1:return ra+Fe.a.instance.fa(1958);case 2:return ra+Fe.a.instance.fa(1959);case 3:return ra+Fe.a.instance.fa(1960);case 4:return ra+Fe.a.instance.fa(1961);case 5:return ra+Fe.a.instance.fa(1962);case 6:return ra+Fe.a.instance.fa(1963);case 7:return ra+Fe.a.instance.fa(1964);case 8:return ra+Fe.a.instance.fa(1965);case 9:return ra+Fe.a.instance.fa(1966);case 10:return ra+Fe.a.instance.fa(1967);case 11:return ra+Fe.a.instance.fa(1968);case 12:return ra+Fe.a.instance.fa(1969);
case 13:return ra+Fe.a.instance.fa(1970);case 14:return ra+Fe.a.instance.fa(1971);case 15:return ra+Fe.a.instance.fa(1972);case 16:return ra+Fe.a.instance.fa(1973);case 17:return ra+Fe.a.instance.fa(1974);case 18:return ra+Fe.a.instance.fa(1975);case 19:return ra+Fe.a.instance.fa(1976);case 20:return ra+Fe.a.instance.fa(1977);case 21:return ra+Fe.a.instance.fa(1978);case 22:return ra+Fe.a.instance.fa(1979);case 23:return ra+Fe.a.instance.fa(1980);case 24:return ra+Fe.a.instance.fa(1981);case 25:return ra+
Fe.a.instance.fa(1982);case 26:return ra+Fe.a.instance.fa(1983);case 27:return ra+Fe.a.instance.fa(1984);case 28:return ra+Fe.a.instance.fa(1985);case 29:return ra+Fe.a.instance.fa(1986);case 30:return ra+Fe.a.instance.fa(1987);case 31:return ra+Fe.a.instance.fa(1988);case 32:return ra+Fe.a.instance.fa(1989);case 33:return ra+Fe.a.instance.fa(1990);case 34:return ra+Fe.a.instance.fa(1991);case 35:return ra+Fe.a.instance.fa(1992);case 36:return ra+Fe.a.instance.fa(1993);case 37:return ra+Fe.a.instance.fa(1994);
case 38:return ra+Fe.a.instance.fa(1995);case 39:return ra+Fe.a.instance.fa(1996);case 40:return ra+Fe.a.instance.fa(1997);case 41:return ra+Fe.a.instance.fa(1998);case 42:return ra+Fe.a.instance.fa(1999);case 43:return ra+Fe.a.instance.fa(2E3);case 44:return ra+Fe.a.instance.fa(2001);case 45:return ra+Fe.a.instance.fa(2002);case 46:return ra+Fe.a.instance.fa(2003);case 47:return ra+Fe.a.instance.fa(2004);case 48:return ra+Fe.a.instance.fa(2005);case 49:return ra+Fe.a.instance.fa(2006);case 50:return ra+
Fe.a.instance.fa(2007);case 51:return ra+Fe.a.instance.fa(2008);case 52:return ra+Fe.a.instance.fa(2009);case 53:return ra+Fe.a.instance.fa(2010);case 54:return ra+Fe.a.instance.fa(2011);case 55:return ra+Fe.a.instance.fa(2012);case 56:return ra+Fe.a.instance.fa(2013);case 57:return ra+Fe.a.instance.fa(2014);case 58:return ra+Fe.a.instance.fa(2015);case 59:return ra+Fe.a.instance.fa(2016);default:return T.Name?T.Name:""}};Mb.USh=function(T){return(T+1)%Mb.p7h};Mb.pwb=function(T,ra,hb){hb=void 0===
hb?"":hb;return T||!hb?String.format("{0}, {1}, -version, {2}",Mb.Q8e,T.Index.toString(),ra.toString()):String.format("{0}, {1}, -version, {2}",Mb.Q8e,hb,ra.toString())};Mb.TLh=function(T,ra,hb,Eb){for(var sc=[],vb=0;vb<Mb.cBa;vb++)sc.push(Mb.Jdd(T,ra,hb,Eb,vb));return sc};Mb.Jdd=function(T,ra,hb,Eb,sc){var vb=T.TableStyleElementsList;T=new Jb;var Wc={};if(!vb)return Wc;for(var Zd=El(vb),uf=Zd.next();!uf.done;uf=Zd.next())if(uf=uf.value,0===uf.Type){T=uf;break}Zd=!!T.BackgroundColor;var If="";!hb&&
T.TableStyleBorderFromatList&&0<T.TableStyleBorderFromatList.length&&(If=T.TableStyleBorderFromatList[0].Color);Wc["background-color"]=Zd?T.BackgroundColor:"#FFFFFF";T.FontColor||(T.FontColor="#000000");Wc.color=T.FontColor;Mb.yxe(Eb,sc,Wc,T,If,hb,Zd);vb=El(vb);for(uf=vb.next();!uf.done;uf=vb.next())(uf=uf.value)&&0!==uf.Type&&(2!==uf.Type||Zd||(uf.BackgroundColor=T.BackgroundColor),Mb.ard(uf,Eb,sc,ra)&&(uf.BackgroundColor&&(Wc["background-color"]=uf.BackgroundColor),Wc.color=uf.FontColor||T.FontColor,
Mb.yxe(Eb,sc,Wc,uf,If,hb,Zd)));return Wc};Mb.AV=function(T,ra,hb,Eb,sc,vb){hb&&(hb.Color&&!hb.Style&&(hb.Style=1),hb.Style&&!hb.Color&&(hb.Color=sc?"#000000":Eb?Eb:vb?"#FFFFFF":"#000000"),ra[Mb.borders[T]]="1px "+Mb.mW[hb.Style]+" "+hb.Color)};Mb.ard=function(T,ra,hb,Eb){return-1===T.Type?!1:Mb.brd(T,ra,hb,Eb)||Mb.Emi(T,ra,hb,Eb)||Mb.crd(T,ra,hb,Eb)};Mb.Emi=function(T,ra,hb,Eb){return!ra&&Eb.headerRow||ra===Mb.goa-1&&Eb.totalRow?!1:1===ra%2&&5===T.Type&&Eb.oS&&Eb.headerRow||1<ra&&!!((ra-1)%(T.BandSize+
1))&&6===T.Type&&Eb.oS&&Eb.headerRow||!(ra%2)&&5===T.Type&&Eb.oS&&!Eb.headerRow||!!(ra%(T.BandSize+1))&&6===T.Type&&Eb.oS&&!Eb.headerRow||!(hb%2)&&7===T.Type&&Eb.Pha||!!(hb%(T.BandSize+1))&&8===T.Type&&Eb.Pha};Mb.crd=function(T,ra,hb,Eb){return ra===Mb.goa-1&&2===T.Type&&Eb.totalRow||hb===Mb.cBa-1&&ra===Mb.goa-1&&12===T.Type&&Eb.totalRow&&Eb.lastCol||!hb&&ra===Mb.goa-1&&11===T.Type&&Eb.totalRow&&Eb.firstCol||hb===Mb.cBa-1&&4===T.Type&&Eb.lastCol};Mb.brd=function(T,ra,hb,Eb){return!ra&&1===T.Type&&
Eb.headerRow||!hb&&3===T.Type&&Eb.firstCol||!hb&&!ra&&9===T.Type&&Eb.headerRow&&Eb.firstCol||hb===Mb.cBa-1&&!ra&&10===T.Type&&Eb.headerRow&&Eb.lastCol};Mb.yxe=function(T,ra,hb,Eb,sc,vb,Wc){if(Eb.TableStyleBorderFromatList)for(var Zd=El(Eb.TableStyleBorderFromatList),uf=Zd.next();!uf.done;uf=Zd.next())if(uf=uf.value,uf.Style)switch(uf.Position){case 0:T&&12!==Eb.Type&&11!==Eb.Type&&2!==Eb.Type&&5!==Eb.Type&&6!==Eb.Type||Mb.AV(0,hb,uf,sc,vb,Wc);break;case 1:T!==Mb.goa-1&&1!==Eb.Type&&10!==Eb.Type&&
9!==Eb.Type&&5!==Eb.Type&&6!==Eb.Type||Mb.AV(1,hb,uf,sc,vb,Wc);break;case 2:ra&&12!==Eb.Type&&10!==Eb.Type&&7!==Eb.Type&&8!==Eb.Type&&4!==Eb.Type||Mb.AV(2,hb,uf,sc,vb,Wc);break;case 3:ra!==Mb.cBa-1&&9!==Eb.Type&&11!==Eb.Type&&3!==Eb.Type&&7!==Eb.Type&&8!==Eb.Type||Mb.AV(3,hb,uf,sc,vb,Wc);break;case 5:ra!==Mb.cBa-1&&3!==Eb.Type&&4!==Eb.Type&&7!==Eb.Type&&8!==Eb.Type&&Mb.AV(3,hb,uf,sc,vb,Wc);break;case 6:T!==Mb.goa-1&&2!==Eb.Type&&1!==Eb.Type&&5!==Eb.Type&&6!==Eb.Type&&Mb.AV(1,hb,uf,sc,vb,Wc)}};Mb.JYh=
function(){var T=Array(12);T[0]=0;T[7]=1;T[8]=2;T[5]=3;T[6]=4;T[4]=5;T[3]=6;T[1]=7;T[2]=8;T[9]=9;T[10]=10;T[11]=11;T[12]=13;return T};Mb.goa=5;Mb.cBa=5;Mb.p7h=5;Mb.Q8e="TableStyleIcon";Mb.mW=[null,Ng.a.solid,Ng.a.dashed,Ng.a.dotted,Ng.a.dashed,Ng.a.dotted,Ng.a.dashed,Ng.a.double];Mb.borders=[Sh.a.borderTop,Sh.a.borderBottom,Sh.a.borderLeft,Sh.a.borderRight];Mb.Q7f=Mb.JYh();Mb.Z5c=null;Object(je.a)(Mb,"TableStyleHelper",null,[]);ib.prototype.equals=function(T){return T?this.headerRow===T.headerRow&&
this.totalRow===T.totalRow&&this.firstCol===T.firstCol&&this.lastCol===T.lastCol&&this.Pha===T.Pha&&this.oS===T.oS:!1};Object(je.a)(ib,"TableStyleOptions",null,[]);var Gi=b(1001),ag=bg.a;Am(Qa,ag);Qa.prototype.Z5e=function(T){var ra=this.tableManager.Eg;if(!ra)return!1;T=T[ce.a.ld];if(!T)return!1;switch(Number.parseInvariant(T)){case 0:return he.d(ra);case 1:return he.c(ra);case 2:return he.g(ra);case 3:return he.e(ra);case 4:return he.f(ra);case 5:return he.b(ra);case 6:return ra.hasAutoFilter}return!1};
Qa.prototype.QGf=function(T,ra){if(Ch.a.isEmpty(this.jG))return!0;if("PopulateTableMoreStylesMenu"!==T&&"PopulateTableAccessibleStylesMenu"!==T)return!1;if(df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&"PopulateTableAccessibleStylesMenu"===T&&!this.dzc)return this.zMb||(this.zMb=!0,this.EKa("accessibilityTab")),!0;this.pAb=!0;var hb=this.Ra.Yp("TableStylesMenu"),Eb=this.Ra.dB("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),sc=this.Ra.dB("Ribbon.TableTools.TableStyles.Gallery.Dark",
7,"Size48by48"),vb=this.Ra.dB("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),Wc=this.Ra.dB("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48"),Zd=-123538519;if(ra.MenuId)if(tg.a.contains(ra.MenuId,"FormatAsTable",!0))Zd=753331043,this.s6a=!0;else{var uf=Fe.a.instance.fa(1956);var If=Mb.pwb(null,1,"-1");df.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Wc.Mt("-1",Zd,"QueryTableStyle",0,"-1",If,void 0,void 0,uf):Wc.Mt("-1",Zd,"QueryTableStyle",
0,"-1",void 0,void 0,void 0,uf);this.s6a=!1}If=0;var ng=this.jG,gg;for(gg in ng){var Wh=ng[gg];if(!df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||"PopulateTableAccessibleStylesMenu"!==T||!Wh.HasStyleViolations){uf=Mb.N2e(Wh,this.jvb());var di=Mb.pwb(Wh,this.UHa);if(Wh)switch(Wh.Category){case 0:Eb.Mt(Wh.Index.toString(),Zd,"QueryTableStyle",0,Wh.Index.toString(),di,void 0,void 0,uf);If++;break;case 3:sc.Mt(Wh.Index.toString(),Zd,"QueryTableStyle",0,Wh.Index.toString(),
di,void 0,void 0,uf);break;case 2:vb.Mt(Wh.Index.toString(),Zd,"QueryTableStyle",0,Wh.Index.toString(),di,void 0,void 0,uf);break;case 1:Wc.Mt(Wh.Index.toString(),Zd,"QueryTableStyle",0,Wh.Index.toString(),di,void 0,void 0,uf)}}}0<If&&this.J2(hb,Eb,1924);this.J2(hb,Wc,1925);this.J2(hb,vb,1926);this.J2(hb,sc,1927);ra.MenuItems=hb.oC();this.isInitialized||(this.isInitialized=!0);return!0};Qa.prototype.Zid=function(T){var ra=this;T[Gh.a.On]=!1;var hb=T[ce.a.ld];if(hb&&!Ch.a.isEmpty(this.jG)){tg.a.contains(T.ParentMenuId,
"FormatAsTable",!0)?this.s6a=!0:this.s6a=!1;this.s6a||this.icg();Mb.Xgf(T)&&(hb=this.Fvb(hb).toString());var Eb=this.jvb();T[Gh.a.Alt]="-1"===hb?Fe.a.instance.fa(1956):Mb.N2e(this.$gd(hb),Eb);if(hb in this.XSa&&Eb.equals(this.yZc))this.SGf(T,hb,Eb,!0);else{if(!this.Prc||this.Prc&&!this.Prc.vp)this.xma={},this.Prc=Yb.a.instance.create(function(){ra.jNf();ra.yZc=ra.jvb()},0,Ec.a.aHj,!0,!0);this.cEd(Eb,T,hb)}}};Qa.prototype.getTableStyleIndexFromName=function(T){if(!T||Ch.a.isEmpty(this.jG))return-1;
if(T in this.jG)return this.jG[T].Index;this.EKa("getTableStyleIndexFromName");return-1};Qa.prototype.ric=function(){return!!this.xL};Qa.prototype.Fvb=function(T){this.eO||this.cZc();return T in this.eO?this.eO[T]:-1};Qa.prototype.EKa=function(T){if(this.$.isEditMode)if(df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)){var ra=new Date;if(30<li.getElapsedSeconds(this.lastSyncTime,ra)||Ch.a.isEmpty(this.jG)||this.zMb){var hb=this.$.na.ua.hc();this.lastSyncTime=
ra;T=this.zMb&&"accessibilityTab"===T||"galleryMenuClosed"===T;Vg.s(this.$.na.ua,T,this.yxf,this.GAd,null,T?"accessibility":"normal",hb)}}else if(hb=new Date,30<li.getElapsedSeconds(this.lastSyncTime,hb)||Ch.a.isEmpty(this.jG))T=this.$.na.ua.hc(),this.lastSyncTime=hb,Vg.r(this.$.na.ua,this.yxf,this.GAd,null,null,T)};Qa.prototype.dispose=function(){this.eO=this.XSa=this.xL=this.jG=null;this.$.Ka.obb(this.YCf);ag.prototype.dispose.call(this)};Qa.prototype.oGg=function(T){this.addHandler("RefreshTableStyleGallery",
T)};Qa.prototype.Vbj=function(T){this.removeHandler("RefreshTableStyleGallery",T)};Qa.prototype.cZc=function(){var T={};this.tableManager.Eg&&(this.Hda=this.getTableStyleIndexFromName(this.tableManager.Eg.Dzc));for(var ra=1;7>=ra;ra++)T["preview"+ra]=this.XRh(ra);this.eO=T};Qa.prototype.XRh=function(T){var ra=this.xL.TableStyleItems.length;ra=4>=this.Hda?this.Hda+T-1:4<this.Hda&&this.Hda<ra-4?4===T?this.Hda:Math.floor(this.Hda+T-4):this.Hda+T-1;-1===ra||ra.toString()in this.XSa||(ra=T-3);return ra};
Qa.prototype.icg=function(){if(this.tableManager.Eg){var T=!1,ra=this.getTableStyleIndexFromName(this.tableManager.Eg.Dzc);if(ra!==this.Hda){if(this.eO){var hb=this.eO,Eb;for(Eb in hb)hb[Eb]===ra&&(T=!0)}this.Hda=ra;T||Ch.a.isEmpty(this.XSa)||this.cZc()}}};Qa.prototype.J2=function(T,ra,hb){var Eb=this.Ra.Pc();Eb.aq="Thin";Eb.title=Fe.a.instance.fa(hb);Eb.buttons.push(ra);T.Ec.push(Eb)};Qa.prototype.jvb=function(){var T=this.tableManager.Eg;return this.s6a||!T?new ib(!0,!1,!1,!1,!0,!1):new ib(he.d(T),
he.g(T),he.c(T),he.e(T),he.f(T),he.b(T))};Qa.prototype.jNf=function(T){T=void 0===T?!1:T;var ra={},hb={},Eb=this.jvb();if(!Ch.a.isEmpty(this.jG)&&(this.tableManager.Eg&&this.icg(),!Eb.equals(this.yZc)||T||Ch.a.isEmpty(this.XSa))){this.UHa=Mb.USh(this.UHa);T=this.jG;for(var sc in T){var vb=T[sc],Wc=Mb.pwb(vb,this.UHa);ra[vb.Index.toString()]=Mb.U3a(Mb.cta(Mb.d4b(vb,Eb)),Wc);hb[Wc]=ra[vb.Index.toString()];this.wHb(hb)}sc=Mb.pwb(null,this.UHa,"-1");ra["-1"]=Mb.U3a(Mb.cta(Mb.d4b(null,Eb)),sc);hb[sc]=
ra["-1"];this.wHb(hb);Hi.c(this.XSa,ra,!1)}};Qa.prototype.Umi=function(){var T=Ee.a(this.$);return T?T.Vm.Gp===re.a.Hab:!1};Qa.prototype.cEd=function(T,ra,hb){Number.parseInvariant(hb);"-1"===hb&&tg.a.contains(ra.ParentMenuId,"FormatAsTable",!0)||this.SGf(ra,hb,T,!1)};Qa.prototype.SGf=function(T,ra,hb,Eb){var sc=Mb.pwb(null,this.UHa,ra);Mb.Xgf(T)?(sc in this.xma?hb=this.xma[sc]:(hb=Mb.cta(Mb.d4b(this.$gd(ra),hb)),this.xma[sc]=hb),T[Gh.a.GalleryButtonProps]=Object(We.a)(new Oi.a,{Command:"-123538519",
QueryCommand:"QueryTableStyle",Id:sc,Alt:T[Gh.a.Alt],MenuItemId:ra,TableCellStyles:hb,TableStyles:this.O_i})):(T[Di.a.Icon]=sc,T[Gh.a.GalleryButtonProps]=Object(We.a)(new nh.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:sc,Alt:T[Gh.a.Alt],MenuItemId:ra}),Eb||(Eb=[],this.$gd(ra),"-1"===ra||tg.a.contains(T.ParentMenuId,"FormatAsTable",!0)||(Eb=Mb.d4b(this.xL.TableStyleItems[Number.parseInvariant(ra)],hb)),this.XSa[ra]=Mb.U3a(Mb.cta(Eb),sc)))};Qa.prototype.wHb=function(T){var ra=this;if(this.pAb)this.Suc=
function(){ra.wHb(T)};else{this.Suc=null;var hb=[],Eb;for(Eb in T){var sc=Eb;sc in this.yHb?hb.push(sc):this.yHb[sc]=!0}try{0<hb.length&&appChrome.api.unregisterIcons(hb),Ch.a.isEmpty(T)||appChrome.api.registerIconProvider(function(){return T})}catch(vb){}}};Qa.prototype.$gd=function(T){T=Number.parseInvariant(T);if(-1===T||!this.xL)return null;if(60<T)for(var ra=60;ra<this.xL.TableStyleItems.length;++ra){var hb=this.xL.TableStyleItems[ra];if(hb.Index===T)return hb}return this.xL.TableStyleItems[T]};
Object(je.a)(Qa,"TableStyleManager",bg.a,[935,3]);var pi=ac.a;Am(qb,pi);qb.prototype.create=function(){var T=this,ra=cc.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub),hb=cc.GetServiceTaskFactory.Va(this.$.da,66,134,this.ub);Rc.TaskExtensions.Ba(Ue.Task.WAA(ra,hb),function(){T.Eb(T.tableStyleManager||(T.tableStyleManager=new Qa(T.$,ra.result,hb.result)))},this.$.la,8)};Object(je.a)(qb,"TableStyleManagerFactory",ac.a,[]);var Th=b(906),xh=b(56);Oa.prototype.wV=function(){return this.autoFilterOptions};
Object(je.a)(Oa,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[445]);sa.prototype.wV=function(){return this.autoFilterOptions};Object(je.a)(sa,"MacroRecorderRangeItemFilteredPayload",null,[445]);var Ea=b(1133),ua=b(387),Ab=b(175),Xd=b(186),oe=b(291);Object(je.a)(ba,"MacroRecorderTableStyleAppliedPayload",null,[445]);Am(I,ba);Object(je.a)(I,"MacroRecorderRangeFormatedAsTablePayload",ba,[]);$a.prototype.rn=function(){return this.tableRange};$a.prototype.getTitle=function(){return this.title};
$a.prototype.getDescription=function(){return this.description};Object(je.a)($a,"MacroRecorderTableAltTextEditedPayload",null,[445]);Object(je.a)(jb,"MacroRecorderTableRenamedPayload",null,[445]);Object(je.a)(Uc,"MacroRecorderTableResizedPayload",null,[445]);Object(je.a)(hc,"MacroRecorderTableStyleOptionToggledPayload",null,[445]);Object(je.a)(zb,"MacroRecorderTableConvertedToRangePayload",null,[445]);Gc.prototype.ML=function(){fc.ULS.sendTraceTag(537151186,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken to show Get IsRangeQueryTable is {0} milliseconds",
this.Cf.kh.Bc);if(this.mCa&&!kg.a(this.mCa)){this.Cf.Ozb=this.mCa.Result;if(this.Cf.Ozb)return this.h0d=lh.a.gd(3,2,0,738,0,-66108047,"ConvertToRange"),this.kj=uh.a(this.Cf.$).si(this.h0d).G(),this.kj.isCompleted||(this._state=2,this.kj.NN(this.moveNext)),this.JDc;this.Cf.dCe();return this.Sfb}return this.s1};Gc.prototype.s1=function(){this.Cf.kh.stop();fc.ULS.sendTraceTag(537151185,0,50,"ConvertToRangeManager.ShowDialogOld: Total Time taken for complete operation is {0} milliseconds",this.Cf.kh.Bc);
this._state=3};Gc.prototype.Sfb=function(){return this.s1};Gc.prototype.JDc=function(){this.i0d=this.kj.Az();fc.ULS.sendTraceTag(537151184,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken for User Input is {0} milliseconds",this.Cf.kh.Bc);0===this.i0d&&this.Cf.cCe();return this.Sfb};Gc.prototype.dispose=function(){};Object(je.a)(Gc,"$$sm_Microsoft$Office$Excel$WebUI$Client$TableOperations$ConvertToRangeManager$ShowDialogOld",null,[3]);var yf=b(954);Xb.prototype.M$a=function(){var T=this;this.kh.start();
var ra=this.$.na.ua.hc();return df.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?yf.h(this.$.na.ua,this.sharedSheetRange,function(hb){T.showDialog(hb)},null,null,null,ra):yf.h(this.$.na.ua,this.sharedSheetRange,function(hb){T.Nyj(hb)},null,null,null,ra)};Xb.prototype.showDialog=function(T){var ra=this;fc.ULS.sendTraceTag(537151193,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",
this.kh.Bc);T&&!kg.a(T)&&((this.Ozb=T.Result)?(T=lh.a.gd(3,2,0,738,0,-66108047,"ConvertToRange"),Rc.TaskExtensions.Ba(uh.a(this.$).si(T),function(hb){fc.ULS.sendTraceTag(537151192,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",ra.kh.Bc);0===hb.result&&ra.cCe()},this.$.la,11)):this.dCe());this.kh.stop();fc.ULS.sendTraceTag(537151191,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.kh.Bc)};Xb.prototype.Nyj=
function(T){new Gc(this,T)};Xb.prototype.lue=function(){var T={};T.IsQueryTable=this.Ozb;T.Range=this.sharedSheetRange;return T};Xb.prototype.cCe=function(){var T=this,ra=this.$.na.ua;fc.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.Maf(194,function(hb,Eb,sc){return yf.d(ra,T.lue(),hb,Eb,sc,null)});fc.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")};Xb.prototype.dCe=function(){var T=this,ra=this.$.na.ua;fc.ULS.sendTraceTag(537151188,
0,50,"Convert To Range initiated for Normal Table");this.Maf(193,function(hb,Eb,sc){return yf.c(ra,T.lue(),hb,Eb,sc,null)},function(){return new zb(T.tableName)});fc.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")};Xb.prototype.Maf=function(T,ra,hb){hb=void 0===hb?null:hb;ua.a(this.$.userOperationManager,ra,function(Eb){return new Ab.a(T,0,Eb,void 0,hb)},null)};Object(je.a)(Xb,"ConvertToRangeManager",null,[]);var Pg=b(1287),Af=b(1286),ch=b(1322),Xg=ch.a;Am(Wa,Xg);Wa.prototype.Zi=
function(){var T=this,ra=Ka.s(this.AC.TableRange);return function(){return new I(ra,T.W4a.checked,T.eBa,!0)}};Wa.prototype.Kx=function(){var T=this,ra=Ka.s(this.AC.TableRange);return function(hb,Eb,sc){return yf.g(T.$.na.ua,ra,T.W4a.checked,!1,T.AC.HasTotalRow,T.eBa,hb,Eb,sc,null)}};Wa.prototype.Ay=function(T,ra,hb){Xg.prototype.Ay.call(this,T,ra,hb)};Ek.Object.defineProperties(Wa.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},Gu:{configurable:!0,enumerable:!0,
get:function(){return 215}}});Object(je.a)(Wa,"FormatAsTableDialogDeprecated",ch.a,[]);var vh=b(1154),ci=vh.a;Am(wb,ci);wb.prototype.Zi=function(){var T=this,ra=Ka.s(this.AC.TableRange);return function(){return new I(ra,T.hasHeaders,T.eBa,!0)}};wb.prototype.Kx=function(){var T=this,ra=Ka.s(this.AC.TableRange),hb=this.AC.HasTotalRow;return function(Eb,sc,vb){return yf.g(T.$.na.ua,ra,T.hasHeaders,!1,hb,T.eBa,Eb,sc,vb,null)}};Ek.Object.defineProperties(wb.prototype,{Cc:{configurable:!0,enumerable:!0,
get:function(){return"FormatAsTableDialog"}},Gu:{configurable:!0,enumerable:!0,get:function(){return 215}},Hm:{configurable:!0,enumerable:!0,get:function(){return Fe.a.instance.fa(732)}}});Object(je.a)(wb,"FormatAsTableReactDialog",vh.a,[]);var Ih=b(388),Ae=b(87),zi=Ih.a;Am(ic,zi);ic.prototype.uFf=function(T){T=T.startsWith("=")?T.substring(1,T.length):T;var ra=Ka.Z(T,this.$.xa);T=ra.sheetName;var hb=ra.range;return ra.returnValue&&hb?(hb=Ka.v(hb,this.$),hb.SheetName=tg.a.equals(T,"",!0)?this.$.qa.name:
T,hb):null};ic.prototype.GV=function(T){var ra={};return ra[ic.d5]="ResizeTableDialog",ra[ic.SKf]=T,ra.getInputErrorIfInvalid=this.Gvb,ra};ic.prototype.cfd=function(T){T=this.uFf(T);if(!T)return 1;var ra=Ka.D(T);return tg.a.equals(T.SheetName,this.$.qa.sheetName,!0)&&this.hpc.top===ra.top&&this.hpc.Hd(ra)?0:2};ic.prototype.tcd=function(T){var ra="";switch(T){case 1:ra=Fe.a.instance.fa(74);break;case 2:ra=Ae.a.fg(Fe.a.instance.fa(73))}return ra};ic.prototype.ILj=function(T){var ra={};T=(ra.ResizeTableRange=
T,ra.OriginalTableRange=this.hpc,ra);this.$.Xd(-1400250766,ce.a.Ub,8,T)};Ek.Object.defineProperties(ic.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ResizeTableDialog"}}});ic.d5="id";ic.SKf="range";Object(je.a)(ic,"ResizeTableDialog",Ih.a,[]);var ph=Ih.a;Am(Kb,ph);Kb.prototype.RGj=function(T,ra){if(1===T&&(T=ra[Kb.sJj],ra=ra[Kb.jdh],T!==this.GCd||ra!==this.ECd)){var hb={};T=(hb.Title=T,hb.Description=ra,hb);this.$.Xd(868579142,ce.a.Ub,8,T)}};Kb.prototype.GV=function(T,ra){var hb=
{};return hb.id="AltTextDialog",hb.title=T,hb.description=ra,hb};Ek.Object.defineProperties(Kb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"TableAltTextDialog"}}});Kb.d5="id";Kb.sJj="title";Kb.jdh="description";Object(je.a)(Kb,"TableAltTextDialog",Ih.a,[]);var yg=b(981),na=b(982),sb=b(144),Wb=b(66),Dc=b(37);bc.prototype.Zc=function(T,ra){switch(ra){case -544558380:return!(this.tableManager&&this.sa.nK()&&!this.gMa()&&he.d(this.tableManager.Eg));case 1544516694:return!(this.tableManager&&
(this.sa.nK()?!this.gMa():this.sa.PLa()));case -697806646:case 323142015:return!this.sa.nK();case 341449783:case 2128797448:return df.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.sa.nK()?!this.gMa():this.sa.PLa())):!(this.tableManager&&this.tableManager.grd(this.sa.activeCell));case -123538519:return!(this.sa.nK()&&this.tableStyleManager&&this.tableStyleManager.ric());case 756677940:return!(df.EwaSettings.ma(412)&&this.Idi());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&
this.Jdi());case 844144422:return!this.sa.nK();case -723113214:return!(df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&this.sa.nK())}return!1};bc.prototype.executeCommand=function(T,ra,hb){var Eb=this,sc;T=Rc.TaskExtensions.hl();var vb=this.$.na.ua,Wc=null,Zd=1,uf=ra.command,If=this.$.na.ua.hc(),ng=null;switch(uf){case -2058042992:var gg=xh.a.mi(hb[ce.a.Cg]);bc.OXf(this.$,gg);Wc=function(ih,vj,$f){return yf.a(vb,gg,null,null,!1,!1,!1,yg.a.zva(sb.a.nsa,
na.a.clearAutoFilter,ih),vj,$f,null)};Zd=176;ng=function(){return new sa(gg)};break;case 504133448:case -798968736:case 477776686:var Wh=xh.a.mi(hb[ce.a.Cg]),di=hb.TopCellAddress;bc.OXf(this.$,Wh);var uj=504133448===ra.command?1:-798968736===ra.command?2:3;if(df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&di){hb=this.tableManager.rn(di);if(!hb&&df.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var qj=this.$.xa.qa;(null===
(sc=Ka.D(qj.P0))||void 0===sc?0:sc.contains(di))?hb=Ka.D(qj.P0):fc.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!df.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||hb&&!this.$.YWc([hb],!0,1))break}else if(hb&&!this.$.Cq([hb],!0,1))break}Wc=function(ih,vj,$f){return Vg.ib(vb,Wh,uj,oe.b(ih,Eb.hSi),vj,$f,di,If)};Zd=177;ng=function(){return new Oa(Wh,uj)};
break;case 341449783:case 2128797448:this.iRa=341449783===uf?0:2;sc=this.toggleTableStyleOption(vb,If);Wc=sc.bCa;Zd=sc.operationName;ng=sc.Zi;break;case -712419744:this.oy?this.xaf(hb[re.a.event]):this.xaf(null);break;case 1868184698:if(df.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&(hb=this.H$f(null,If),sc=hb.Jyb,Wc=hb.bCa,ng=hb.Zi,sc)){Zd=206;break}df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new Af.a(this.$):(sc=new Pg.a(this.$),
sc.initialize(),sc.kf());break;case 844144422:new ic(this.$);break;case 1544516694:case -544558380:if(sc=hb[ce.a.ld])this.iRa=this.IYh(sc),-1!==this.iRa&&(sc=this.toggleTableStyleOption(vb,If),Wc=sc.bCa,Zd=sc.operationName,ng=sc.Zi);break;case 756677940:if(this.gMa()&&this.pff()){fc.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}var Ag=hb.Text,Eg=this.cRh();if(Eg){Wc=
function(ih,vj,$f){return yf.i(vb,Ag,Eg,oe.b(ih,Eb.gSi),oe.a(vj,Eb.fSi),$f,If)};Zd=217;var Jj=null;this.tableManager.Eg?Jj=this.tableManager.Eg.name:this.tableManager.hFd?Jj=this.tableManager.hFd.name:fc.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");Jj&&(ng=function(){return new jb(Jj,Ag)})}else return fc.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),
Ue.Task.Sa(!1);break;case 323142015:if(this.gMa())break;return(new Xb(this.$,this.Mcd(),this.tableManager.Eg.name)).M$a();case -1400250766:Zd=211;Wc=this.bgj(hb,vb,If);var Fi=Ka.m(hb.OriginalTableRange,this.$.xa.qa);ng=function(){return new Uc(Fi)};break;case 1872288872:this.tableManager.C2i();break;case -123538519:var mj=this.HYh(hb);sc=tg.a.contains(hb[ce.a.ld],re.a.yGb,!0)||tg.a.contains(hb[re.a.LI],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";fc.ULS.sendTraceTag(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",
sc,mj.toString());var Xh=this.U1e();Xh&&(Wc=function(ih,vj,$f){return yf.b(vb,Xh,mj,ih,vj,$f,null,If)},ng=function(){return new ba(Xh,mj)},Zd=212);break;case 753331043:sc=hb[ce.a.ld];if(!sc)break;var Dj=Number.parseInvariant(sc);if(this.sa.nK()){fc.ULS.sendTraceTag(51181321,0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",Dj);var vk=this.U1e();vk&&(Wc=function(ih,vj,$f){return yf.g(vb,vk,!1,!1,!1,Dj,ih,vj,$f,null,If)},ng=function(){return new I(vk,!1,Dj,!1)},
Zd=215);break}if(df.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&(qj=this.H$f(Dj,If),hb=qj.Jyb,Wc=qj.bCa,ng=qj.Zi,hb)){Zd=215;break}fc.ULS.sendTraceTag(51181322,0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",Dj);df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new wb(this.$,Number.parseInvariant(sc)):(sc=new Wa(this.$,Number.parseInvariant(sc)),sc.initialize(),sc.kf());break;case 71074531:var Hj=
hb.HasHeader,xk=hb.TableRange;Wc=function(ih,vj,$f){return yf.e(vb,xk,Hj,!1,!1,ih,vj,$f,null)};ng=function(){return new Ea.a(Hj,xk)};Zd=206;break;case -723113214:new Kb(this.$);break;case 868579142:fc.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");Zd=1022;var Xj=hb.Title,Yj=hb.Description,mi=this.Mcd();Wc=function(ih,vj,$f){return yf.f(vb,Xj,Yj,mi,ih,vj,$f,null)};if(this.tableManager.Eg){qj=tg.a.Fh(this.tableManager.Eg.VSa)?"":this.tableManager.Eg.VSa;var th=tg.a.Fh(this.tableManager.Eg.WSa)?
"":this.tableManager.Eg.WSa}ng=Xj==qj?function(){return new $a(mi,void 0,Yj)}:Yj==th?function(){return new $a(mi,Xj,void 0)}:function(){return new $a(mi,Xj,Yj)};break;default:return Xd.a(uf)}if(Wc){var Rh=function(ih){return new Ab.a(Zd,0,ih,void 0,ng)};T=!this.namedSheetViewPublic||-2058042992!==uf&&504133448!==uf&&-798968736!==uf&&477776686!==uf?ua.a(this.$.userOperationManager,Wc,Rh,ra):this.namedSheetViewPublic.OAa().continueWith(function(ih){ih.result&&ua.a(Eb.$.userOperationManager,Wc,Rh,ra)})}return T};
bc.prototype.toggleTableStyleOption=function(T,ra){var hb=this,Eb=this.sa.PLa();fc.ULS.sendTraceTag(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",Eb?"PivotTable":"table",this.iRa);var sc=this.Mcd();return{bCa:function(vb,Wc,Zd){return yf.k(T,sc,hb.iRa,oe.b(vb,hb.OSi),Wc,Zd,null,ra)},operationName:196,Zi:function(){return new hc(sc,hb.iRa,Eb)}}};bc.prototype.bgj=function(T,ra,hb){function Eb(uf){uf.Errors&&vb.tableManager.N7f(Wc)}function sc(){vb.tableManager.N7f(Wc)}
var vb=this,Wc=T.OriginalTableRange,Zd=Ka.m(T.ResizeTableRange,this.$.xa.qa);return function(uf,If,ng){return yf.j(ra,Zd,oe.b(uf,Eb),oe.a(If,sc),ng,null,hb)}};bc.prototype.HYh=function(T){var ra=-1;T[ce.a.ld]&&(ra=T[ce.a.ld],ra=tg.a.contains(ra,re.a.yGb,!0)?this.tableStyleManager.Fvb(ra):Number.parseInvariant(T[ce.a.ld]));return ra};bc.prototype.Lc=function(T,ra){T=!1;switch(ra.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:T=
!0;break;case 756677940:T=df.EwaSettings.ma(412);break;case -723113214:case 868579142:T=df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)}return T};bc.prototype.jd=function(T,ra,hb){T=!1;switch(ra){case "PopulateTableMoreStylesMenu":this.menuId=hb.MenuId;this.tableStyleManager.ric()||this.tableStyleManager.EKa("formatAsTableMenu");T=this.tableStyleManager.QGf(ra,hb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=hb.MenuId,this.tableStyleManager.ric()||
this.tableStyleManager.EKa("accessibilityTab"),T=this.tableStyleManager.QGf(ra,hb)}return T};bc.prototype.dispose=function(){this.tableStyleManager.Vbj(this.ZCf)};bc.prototype.gda=function(){(tg.a.contains(this.menuId,"Format",!0)||tg.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Uv(this.menuId)};bc.prototype.Mcd=function(){return Ka.v(this.sa.activeCell,this.$)};bc.prototype.cRh=function(){var T=this.tableManager.qsd;return T?Ka.v(T,this.$):null};bc.prototype.xaf=function(T){if(this.tableManager){var ra=
Mf.g(this.$),hb=this.sa.activeCell,Eb=this.tableManager.rn(hb),sc=null;if(!Eb||Eb.xSa)for(ra=El(ra.n3),Eb=ra.next();!Eb.done;Eb=ra.next()){Eb=El(Eb.value);for(var vb=Eb.next();!vb.done;vb=Eb.next()){vb=vb.value;var Wc=vb.Qn;hb.left>=Wc[0]&&hb.left<=Wc[Wc.length-1]&&(sc=(vb=vb.hs(hb).bK())?se.DOMElementExtensions.Pj(vb,hg.a.Toe):null)}}else{var Zd=ra.kc(Se.Range.hd(Eb.top,hb.left));if(this.oy){Yb.a.instance.create(function(){Zd.invoke(8,T)},0,Ec.a.G7f,!0,!0);return}sc=Zd.mKa(56).M5a}sc&&Yb.a.instance.create(function(){se.DOMElementExtensions.rfc(sc,
null)},0,Ec.a.G7f,!0,!0)}};bc.prototype.IYh=function(T){T=Number.parseInvariant(T);return-1<T&&8>=T?T:-1};bc.prototype.gMa=function(){return!this.tableManager.Eg};bc.prototype.pff=function(){return this.tableManager.hFd?!1:(fc.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)};bc.prototype.Jdi=function(){var T=this.sa.nK(),ra=this.sa.Ig&&!Mf.g(this.$).Rb.x5(this.sa.qd);return T||ra};bc.prototype.Idi=function(){return this.sa.nK()||
!this.pff()};bc.prototype.KYh=function(T){var ra=[];T=El(T);for(var hb=T.next();!hb.done;hb=T.next())if(hb=bb.b(this.$,hb.value),null===hb||void 0===hb?0:hb.length){hb=El(hb);for(var Eb=hb.next();!Eb.done;Eb=hb.next())Eb=Eb.value,Eb.usedRange&&!Array.contains(ra,Eb.usedRange)&&ra.push(Eb.usedRange)}return ra};bc.prototype.U1e=function(){var T=this.sa.selectedRanges,ra=[];if(df.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))ra=this.KYh(T);else{T=
El(T);for(var hb=T.next();!hb.done;hb=T.next())hb=hb.value,Mf.g(this.$).Rb.x5(hb)&&ra.push(hb)}return ra&&ra.length?Ka.r(ra,this.$):null};bc.prototype.CL=function(T){Dc.a.Fba(this.$)&&Rc.TaskExtensions.Ba(cc.GetServiceTaskFactory.Va(this.$.da,430,431,1),function(ra){ra.result.qea(T);fc.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};bc.prototype.Tqi=function(T){var ra=this;Rc.TaskExtensions.Ba(cc.GetServiceTaskFactory.Va(this.$.da,
446,447,0),function(hb){hb.result.R9g(ra.$,T)},this.$.la,3)};bc.OXf=function(T,ra){ra.SheetName=T.qa.name;ra.NamedObjectView=T.ea.isNamedObjectViewMode};bc.prototype.H$f=function(T,ra){var hb=this;if(!this.sa.Ig||1!=this.sa.qd.uM)return{Jyb:!1,bCa:Wc,Zi:Zd};var Eb=Ka.v(this.sa.qd,this.$);Eb.LastColumn=Eb.FirstColumn+3-1;Eb.LastRow=Eb.FirstRow+4-1;var sc=Ka.D(Eb),vb=Mf.g(this.$);if(!sc.isValidRange||!vb.Rb.JMa(sc))return{Jyb:!1,bCa:Wc,Zi:Zd};Nc.AFrameworkApplication.j8a("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");
if(!df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",!1))return{Jyb:!1,bCa:Wc,Zi:Zd};if(null==T){var Wc=function(If,ng,gg){return yf.e(hb.$.na.ua,Eb,!1,!1,!1,If,ng,gg,ra)};var Zd=function(){return new Ea.a(!1,Eb)}}else{var uf=Ka.s(Eb);Wc=function(If,ng,gg){return yf.g(hb.$.na.ua,uf,!1,!1,!1,T,If,ng,gg,ra)};Zd=function(){return new I(uf,!1,T,!0)}}return{Jyb:!0,bCa:Wc,Zi:Zd}};Object(je.a)(bc,"TableCommandHandler",null,[429]);var nb=Th.a;Am(Cd,nb);Cd.prototype.dispose=
function(){nb.prototype.dispose.call(this)};Cd.prototype.Nd=function(){var T=this,ra=cc.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ub),hb=cc.GetServiceTaskFactory.create(this.$.da,330,this.la,this.ub),Eb=cc.GetServiceTaskFactory.Va(this.$.da,309,310,this.ub);Rc.TaskExtensions.Ba(Ue.Task.WAA(ra,Eb,hb),function(){T.Cd([new bc(T.$,ra.result,Eb.result,hb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)};Cd.ka=function(T){Th.a.fe(86,new Cd(T))};
Object(je.a)(Cd,"TableCommandHandlerFactory",Th.a,[]);yc.prototype.Zc=function(){return!1};yc.prototype.executeCommand=function(T,ra){T=ra.command;ra=null;switch(T){case 1243860697:this.Qhh.QJj();break;default:ra=Xd.a(T)}return ra||Ue.Task.Sa(!0)};yc.prototype.Lc=function(T,ra){return 1243860697===ra.command};yc.prototype.jd=function(){return!1};Object(je.a)(yc,"SheetDropdownMenuCommandHandler",null,[429]);var Yc=Th.a;Am(Qb,Yc);Qb.prototype.Nd=function(){var T=this;this.$.RC(function(ra){ra.Rec().then(function(){Rc.TaskExtensions.Ba(cc.GetServiceTaskFactory.Va(T.$.da,
32,33,T.ub),function(hb){T.Cd([new yc(hb.result.Duj)])},T.$.la)})})};Qb.ka=function(T){Th.a.fe(392,new Qb(T))};Object(je.a)(Qb,"SheetDropdownMenuCommandHandlerFactory",Th.a,[]);var ee=b(195),ye=b(42),lf=b(109),Ef=b(35);Ja.prototype.bKg=function(T,ra){this.aIe.add(T,ra);this.XS()};Ja.prototype.XS=function(){var T=this;this.PHc=0;Ef.a.forEach(this.aIe.lu,function(ra){T.PHc=T.C6c|ra.value})};Ek.Object.defineProperties(Ja.prototype,{C6c:{configurable:!0,enumerable:!0,get:function(){return this.PHc}},
navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.C6c&1)}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.C6c&2)}}});Object(je.a)(Ja,"SheetTabBarDisabledStateManager",null,[]);Db.ash="ewa-stb-uir";Db.ZNe="ewa-stb-drag";Db.Lrh="ewa-stb-navarea";Db.Mrh="ewa-stb-navarea-dimensions";Db.Orh="ewa-stb-navbutton";Db.kZ="cui-disabled";Db.eia="cui-img-container";Db.Nrh="ewa-stb-navareaextra";Db.Irh="ewa-stb-contentarea";Db.$Ne="ewa-stb-left-scrollable";
Db.lOe="ewa-stb-right-scrollable";Db.Zrh="ewa-stb-tabarea";Db.Yrh="ewa-stb-sheettabmoveindicator";Db.nOe="ewa-stb-tabs";Db.EGj="tab-active";Db.LGj="tab-inactive";Db.KGj="tab-hover";Db.$rh="ewa-stb-tabs-ghost";Db.GGj="tab-anchor-text";Db.dark="dark";Db.light="light";Db.FGj="tab-active-text";Db.IGj="tab-content-container";Db.NGj="tab-text";Db.Rrh="ewa-stb-nsv-inactive";Db.Srh="ewa-stb-nsv-inactive-svg";Db.Prh="ewa-stb-nsv-active";Db.Qrh="ewa-stb-nsv-active-svg";Db.vqh="ewa_nsv_margin";Db.Jrh="ewa-stb-disable-scrollbar";
Db.eri="leave-size-fixed-on-tab-hover-old";Db.dri="leave-size-fixed-on-tab-hover";Db.dOe="ewa-stb-locked-sheet";Db.eOe="ewa-stb-locked-sheet-svg";Db.fOe="ewa-stb-locked-sheet-svg-16px";Db.Krh="ewa-stb-dropdown-menu-button";Db.$lh="ewa-active-sheet-menu-item";Object(je.a)(Db,"CssClassNames",null,[]);var O=b(619),da=b(19),Pa=b(102),rb=b(562),d=b(295),A=b(328),S=b(99),ja=b(359),Ua=b(196),kc=b(389),tb=b(385),$c=b(230),zd=b(86),qe=Uh.a;Am(rc,qe);rc.prototype.dispose=function(){this.$$a=this.xsa=this.$=
null;qe.prototype.dispose.call(this)};rc.prototype.GX=function(T){this.dY=T;this.domElement.setAttribute(re.a.fsa,T.toString());se.DOMElementExtensions.toggleCssClass(this.domElement,O.a.kZ,T)};Ek.Object.defineProperties(rc.prototype,{disabled:{configurable:!0,enumerable:!0,get:function(){return this.dY}}});Object(je.a)(rc,"SheetBarButton",Uh.a,[]);var Te=b(921);Am(ob,rc);ob.prototype.dispose=function(){$c.a.instance.za(Df.a.click,this.domElement,this.vd);lf.KeyInputManager.instance.Sv(this.domElement,
this.gNa);df.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Mf.g(this.$)&&Mf.g(this.$).wc&&(Mf.g(this.$).wc.fl(this.gj),Mf.g(this.$).wc.Dn(this.ug));rc.prototype.dispose.call(this)};ob.prototype.GX=function(T){var ra=ob.x1f(this.$);rc.prototype.GX.call(this,T||ra)};ob.x1f=function(T){return!T.isEditMode||!T.xa.count};Object(je.a)(ob,"InsertSheetButton",rc,[]);Am(cb,rc);cb.prototype.dispose=function(){$c.a.instance.za(Df.a.click,this.domElement,this.vd);lf.KeyInputManager.instance.Sv(this.domElement,
this.gNa);this.Sue=null;rc.prototype.dispose.call(this)};Object(je.a)(cb,"InsertTemplateButton",rc,[]);pb.prototype.getSheetName=function(){return this.sheetName};Object(je.a)(pb,"MacroRecorderSheetReorderedPayload",null,[445]);var qf=Uh.a;Am(Tb,qf);Tb.prototype.dispose=function(){this.vm();qf.prototype.dispose.call(this)};Tb.prototype.QJj=function(){this.RQf(!0,"TogglerSheetDropdownMenu")};Tb.prototype.RQf=function(T,ra){fc.ULS.sendTraceTag(537153795,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: {0}, toggle: {1}, toggleStateId: {2}",
ra,T,this.wNb);T&&(this.wNb+=1);var hb=this.$.Ob.Gc("UserAction",String.format("SheetDropdownMenu.RenderSheetMenuInternal: caller: {0}, toggle: {1}, toggleStateId: {2}, sheetCount: {3}",ra,T,this.wNb,this.$.xa.count));T=this.H9g();appChrome.renderSheetDropdownMenu(this.domElement,this.jHj,T,this.wNb,this.RIi,this.QIi,function(){hb.stop()},kc.a(this.$))};Tb.prototype.H9g=function(){for(var T=this.$.xa,ra=[],hb=0;hb<T.count;hb++){var Eb=Object(ug.a)(S.a,T.getItem(hb));0===Eb.Py&&(Eb=this.G9g(Eb),ra.push(Eb))}return ra};
Tb.prototype.G9g=function(T){var ra={};ra.key=T.name;ra.text=T.name;ra.onClick=this.I9g(T);T.active&&(ra.className=kc.a(this.$)?"ewa-active-sheet-menu-item-present-mode":Db.$lh);return ra};Tb.prototype.I9g=function(T){var ra=this;return function(){var hb=new yd.a(-1876836819,0,ra.$.ed,30,null),Eb={};ra.$.Ka.Xb(hb,(Eb[re.a.wQd]=T.name,Eb))}};Tb.prototype.Ck=function(){if(!this.mV){var T=this.$.xa;T.Bg(this.XR);T.fVc(this.XR);T.GY(this.XR);T.Oga(this.XR);T.JFa(this.XR);T.sne(this.XR);T.KYa(this.XR);
this.mV=!0}};Tb.prototype.vm=function(){if(this.mV){var T=this.$.xa;T.Xg(this.XR);T.bJd(this.XR);T.e7(this.XR);T.Pma(this.XR);T.sQa(this.XR);T.SPf(this.XR);T.hIb(this.XR);this.mV=!1}};Object(je.a)(Tb,"SheetDropdownMenu",Uh.a,[964,3]);var la=b(368);Am(tc,rc);tc.prototype.dispose=function(){this.sOj();rc.prototype.dispose.call(this)};tc.prototype.GX=function(T){rc.prototype.GX.call(this,T||!this.$.ea.xwa)};tc.prototype.A9f=function(T){this.disabled||(fc.ULS.sendTraceTag(537153793,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: {0}",
la.a[T]),this.$.Ka.Xb(new yd.a(1243860697,T,this.$.ed,30,null)))};tc.prototype.o7i=function(){$c.a.instance.pa(Df.a.click,this.domElement,this.vd);lf.KeyInputManager.instance.pa(Df.a.Yb,this.domElement,this.onKeyDown)};tc.prototype.sOj=function(){$c.a.instance.za(Df.a.click,this.domElement,this.vd);lf.KeyInputManager.instance.za(Df.a.Yb,this.domElement,this.onKeyDown)};Object(je.a)(tc,"SheetDropdownMenuAnchor",rc,[]);var ab=b(203),ec=b(126),Vc=b(59),Kc=b(229),Fd=b(172);wc.prototype.lN=function(){return this.sheet.active};
wc.prototype.Rod=function(){return this.sheet.isLockPausedInSession};wc.prototype.Msa=function(){return this.om?da.a.cOe:this.lN()?da.a.bOe:da.a.aOe};wc.prototype.eoa=function(){return this.sheet.uj?Te.a.mJf:df.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?Te.a.eOj:Te.a.dOj};wc.prototype.JUd=function(){return df.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};wc.prototype.LUd=function(){return df.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
16:12};wc.prototype.Gha=function(){return null};wc.prototype.Nsa=function(){return this.om?this.Nw?df.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?Db.fOe:Db.eOe:Db.dOe:null};wc.prototype.jWd=function(){return null};wc.prototype.Rv=function(){return null};wc.prototype.bld=function(){return 0};wc.prototype.DWc=function(){return!0};Object(je.a)(wc,"LockPausedSheetIconDataSource",null,[957]);Sb.prototype.lN=function(){return this.sheet.active};Sb.prototype.Rod=function(){return this.sheet.uj};
Sb.prototype.Msa=function(){return this.om?da.a.cOe:this.lN()?da.a.bOe:da.a.aOe};Sb.prototype.eoa=function(){return Te.a.mJf};Sb.prototype.JUd=function(){return df.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};Sb.prototype.LUd=function(){return df.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:12};Sb.prototype.Gha=function(){return null};Sb.prototype.Nsa=function(){return this.om?this.Nw?df.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
Db.fOe:Db.eOe:Db.dOe:null};Sb.prototype.jWd=function(){return null};Sb.prototype.Rv=function(){return null};Sb.prototype.bld=function(){return 0};Sb.prototype.DWc=function(){return!0};Object(je.a)(Sb,"LockedSheetIconDataSource",null,[957]);gb.prototype.lN=function(){return this.sheet.active};gb.prototype.Rod=function(){return this.sheet.Yd.qy};gb.prototype.Gha=function(){return this.Nw?this.lN()?Db.Qrh:Db.Srh:this.lN()?Db.Prh:Db.Rrh};gb.prototype.Msa=function(){return!this.lN()&&this.r2f()?da.a.Qth:
da.a.Pth};gb.prototype.eoa=function(){return!this.lN()&&this.r2f()?Te.a.Nuj:Te.a.Muj};gb.prototype.JUd=function(){return 14};gb.prototype.LUd=function(){return 16};gb.prototype.Nsa=function(){return Db.vqh};gb.prototype.jWd=function(){return this.sheet.Yd.Qmb};gb.prototype.Rv=function(){return this.gKj};gb.prototype.bld=function(){return 8};gb.prototype.DWc=function(){return!1};Object(je.a)(gb,"NamedSeetViewSheetIconDataSource",null,[957]);Ia.prototype.Gcg=function(){if(this.MI&&(this.ul||this.bBa)){if(this.Nw){var T=
this.dataSource.eoa();this.eoa!==T&&(this.bBa&&this.bBa.parentNode.removeChild(this.bBa),this.L$e(),this.eoa=T)}else T=this.dataSource.Msa(),this.Msa!==T&&(this.eKd(this.ul,this.Msa,T),this.Msa=T);T=this.dataSource.Gha();this.Gha!==T&&(this.Nw?this.kdj(this.bBa,this.Gha,T):this.eKd(this.ul,this.Gha,T),this.Gha=T);T=this.dataSource.Nsa();this.Nsa!==T&&(this.eKd(this.MI,this.Nsa,T),this.Nsa=T);this.dataSource.Rv()&&!this.dataSource.lN()&&this.clearToolTip()}};Ia.prototype.pzj=function(T,ra,hb){this.Lai(T,
ra,hb);se.DOMElementExtensions.setVisible(this.MI,this.dataSource.Rod())};Ia.prototype.clearToolTip=function(){var T=this;Rc.TaskExtensions.Ba(this.RBb,function(){dialogControls.clearToolTip(T.dataSource.Rv())},this.$.la,3)};Ia.prototype.Lai=function(T,ra,hb){this.MI&&this.nff!==T&&(this.MI.parentNode.removeChild(this.MI),this.Nsa=this.Gha=this.eoa=this.Msa=this.zRc=null,this.dataSource.Rv()&&(this.Jc.detach("mouseover",!0),this.Jc.detach("mouseout",!0)));this.MI||(this.zRc=document.createElement("span"),
Sys.UI.DomElement.addCssClass(this.MI,O.a.eia),Sys.UI.DomElement.addCssClass(this.MI,da.a.rw),df.EwaSettings.ma(507)?T===this.dataSource.DWc()?ra.appendChild(this.MI):ra.insertBefore(this.MI,hb):T?ra.insertBefore(this.MI,hb):ra.appendChild(this.MI),this.Nw?this.L$e():(this.ul=document.createElement("img"),this.ul.tabIndex=-1,this.ul.alt=this.dataSource.altText,this.MI.appendChild(this.ul),this.ul.src=ve.a.We(this.dataSource.bld())),this.dataSource.Rv()&&(this.Jc.ka("mouseover",this.UN,!0),this.Jc.ka("mouseout",
this.SN,!0)),this.nff=T)};Ia.prototype.kdj=function(T,ra,hb){T&&(Sys.UI.DomElement.removeCssClass(T,ra),Sys.UI.DomElement.addCssClass(T,hb))};Ia.prototype.eKd=function(T,ra,hb){ra&&Sys.UI.DomElement.removeCssClass(T,ra);hb&&Sys.UI.DomElement.addCssClass(T,hb)};Ia.prototype.dispose=function(){Ne.a.Ha(this.O1)};Ia.prototype.L$e=function(){var T=this.$.da.Aa(388);T?(this.bBa=T.Ava(this.dataSource.eoa(),this.dataSource.JUd(),this.dataSource.LUd()))?this.MI.appendChild(this.bBa):fc.ULS.shipAssertTag(537153763,
0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id {0} was not found.",this.dataSource.eoa()):fc.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")};Ek.Object.defineProperties(Ia.prototype,{Jc:{configurable:!0,enumerable:!0,get:function(){return this.O1||(this.O1=Ke.a.instance.Zd(this.MI))}},RBb:{configurable:!0,enumerable:!0,get:function(){var T=this;if(this.tqa)return this.tqa;var ra=new lc.a;this.$.RC(function(hb){Rc.TaskExtensions.Ba(hb.Ctd(),
function(){ra.setResult(!0)},T.$.la,3)});return this.tqa=ra.task}},MI:{configurable:!0,enumerable:!0,get:function(){return this.zRc}}});Object(je.a)(Ia,"SheetIcon",null,[3]);var te=b(366),hf=b(157),Yf=ge.a;Am(ha,Yf);ha.prototype.dispose=function(){this.Kna&&($c.a.instance.za(Df.a.kk,this.Kna.domElement,this.tca),te.a.instance.za(this.Kna.domElement,this.xl),this.Dge=null);this.$=null;Yf.prototype.dispose.call(this)};ha.prototype.showContextMenu=function(T,ra,hb){this.Kna.activate(ra,Dc.a.erd());ra=
new yd.a(-1075099431,ra,this.$.ed,30,null);var Eb,sc={};return!hf.a(Eb=this.$.Ka.Xb(ra,(sc[re.a.V0f]=T,sc[ha.Euj]=this.Kna.sheet,sc[re.a.W0f]=hb,sc)))&&(6!==Eb.status||Eb.result)};ha.prototype.rename=function(T,ra){this.$.Xd(817296323,ra,T?19:0,null)};Ek.Object.defineProperties(ha.prototype,{Kna:{configurable:!0,enumerable:!0,get:function(){return this.Dge}}});ha.Euj="Sheet";Object(je.a)(ha,"SheetOpsSheetClickHelper",ge.a,[]);Am(La,rc);La.prototype.VOh=function(){return se.DOMElementExtensions.canReceiveFocus(this.anchor)?
this.anchor:null};La.prototype.dispose=function(){if(this.mV){Oe.a.instance.za(Df.a.pointerDown,this.domElement,this.onPointerDown);lf.KeyInputManager.instance.za(Df.a.Yb,this.domElement,this.onKeyDown);lf.KeyInputManager.instance.za(Df.a.yp,this.domElement,this.Qz);$c.a.instance.za(Df.a.click,this.domElement,this.vd);Oe.a.instance.za(Df.a.JW,this.domElement,this.zya);Oe.a.instance.za(Df.a.Fy,this.domElement,this.Aya);if(this.X6a||df.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))Oe.a.instance.za(Df.a.$d,
this.domElement,this.Of),this.Xwa&&(Zg.a.instance.za(Df.a.De,this.domElement,this.Of),Zg.a.instance.za(Df.a.yg,this.domElement,this.YN));this.mV=!1;this.C5b="#BEBBB8"}Ne.a.zc([this.Qye,this.aue]);this.XO=this.EE=this.bFc=this.AS=this.aue=this.Qye=null;if(this.Hna){for(var T=El(this.Hna),ra=T.next();!ra.done;ra=T.next())ra.value.dispose();this.Hna=null}this.color=this.EWb=null;rc.prototype.dispose.call(this)};La.prototype.GX=function(T){T&&this.Bna(!1,!1);rc.prototype.GX.call(this,T)};La.prototype.gSd=
function(T){if(Vc.a.Fg.tR){this.iIe();var ra=cc.GetServiceTaskFactory.Va(this.$.da,322,323,1);Rc.TaskExtensions.Ba(ra,function(hb){ab.UISurfaces.$Q().then(function(Eb){var sc=hb.result;sc.Jqj(Eb);sc.show(T);return null},function(Eb){fc.ULS.sendTraceTag(537153688,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",Eb);return null})},this.la,3)}};La.prototype.$le=function(){var T=this;if(this.sheet.active&&this.$.kr){var ra=this.$.kr,hb=Mf.g(this.$),Eb=hb.iq;
if(this.sheet.Yd.qy){if(!this.cDb){var sc=new gb(this.sheet,this.AS.Uwc,function(){return T.color?La.BRd(T.color):!1},this.Nw);this.cDb=new Ia(this.$,sc);this.Hna.add(this.cDb)}Eb?hb.gfb(1):ra.classList.add(da.a.BQe);ra=La.wfd(re.a.Qqf);hb=La.wfd(re.a.rxd);Eb=La.wfd(re.a.Hqf);sc=this.sheet.Yd.nRd;this.sheet.Yd.nRd=!1;"true"===Eb&&sc&&this.$.ea.qRd?(ec.a.Kv(re.a.Hqf,"false",ec.a.rW),this.$.ea.qRd=!1,this.gSd(3)):"true"===ra&&"true"===hb&&"true"===Eb?this.$.ea.rRd&&this.$.ea.vLb&&(this.sheet.Yd.tK?
(ra=1,ec.a.Kv(re.a.rxd,"false",ec.a.rW),this.$.ea.vLb=!1):ra=0,ec.a.Kv(re.a.Qqf,"false",ec.a.rW),this.$.ea.rRd=!1,this.gSd(ra)):this.sheet.Yd.tK&&"true"===hb&&"true"===Eb&&this.$.ea.vLb&&(ec.a.Kv(re.a.rxd,"false",ec.a.rW),this.$.ea.vLb=!1,this.gSd(2))}else this.iIe(),Eb?hb.gfb(0):ra.classList.remove(da.a.BQe)}};La.prototype.iIe=function(){if(df.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")){var T=this.$.da.Aa(322);T&&T.dismiss()}else this.$.Pqd&&(T=cc.GetServiceTaskFactory.Va(this.$.da,
322,323,0),Rc.TaskExtensions.Ba(T,function(ra){ra.result.dismiss()},this.$.la,3))};La.prototype.sfb=function(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.K6a()?Db.EGj:Db.LGj;df.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.XO.parentNode.classList.add(Db.dri):this.XO.parentNode.classList.add(Db.eri);this.wdg();this.Qnd&&this.$le();this.qzj();this.Cdg();this.vBc();this.Qnd||this.$le()};La.prototype.rRi=function(){this.uQd=!0;this.Bna(!0,
!0,"OnSheetReorderStarted")};La.prototype.qRi=function(){this.uQd=!1;this.Bna(!1,void 0,"OnSheetReorderEnded")};La.prototype.activate=function(T,ra){T=void 0===T?0:T;ra=void 0===ra?!1:ra;this.p2b()||(this.sheet.activate(),ra&&Mf.g(this.$).focus(),ra={},T=(ra.InputMethod=la.a[T],ra.AppMode=this.$.ed,ra.Location="canvas",ra),Dh.b(this.$).Vd(Jh.a.Auj,T))};La.prototype.vdg=function(T){this.C5b=T?"#797775":"#BEBBB8";this.J4c=T?-.5:.5;this.CHc=T?Kc.a.fp("#3B3A39"):Kc.a.fp("#F5F5F5");this.Cdg()};La.prototype.Lnj=
function(T){this.X6a=T};La.prototype.Wzd=function(T){T.h2c();this.lxe(T)};La.prototype.lxe=function(T){T.l0a();this.sheet.activate()};La.prototype.pzg=function(T){T=new yd.a(-1876836819,T,this.$.ed,30,null);var ra={};return this.$.Ka.Xb(T,(ra[re.a.wQd]=this.sheet.name,ra))};La.prototype.wdg=function(){this.XO.parentNode.setAttribute("sheet-title",this.XO.innerText)};La.prototype.vBc=function(){var T=this.zIh();this.anchor.setAttribute(re.a.Pt,T);this.anchor.setAttribute(re.a.cha,this.sheet.active.toString())};
La.prototype.zIh=function(){var T=this.sheet.Yd.qy,ra=this.sheet.Yd.Qmb,hb=this.sheet.uj,Eb=this.sheet.isLockPausedInSession;return T&&hb?String.format(Fe.a.instance.Ab(20),this.name,ra):T&&Eb?String.format(Fe.a.instance.Ab(22),this.name,ra):T?String.format(Fe.a.instance.Ab(19),this.name,ra):hb?String.format(Fe.a.instance.Ab(18),this.name):Eb?String.format(Fe.a.instance.Ab(21),this.name):this.name};La.prototype.activateSheet=function(T){T=void 0===T?0:T;if(Dc.a.erd()){if(df.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&
this.p2b())return Ue.Task.Sa(!1);Fd.a.current.rS="ActivateSheet";this.sheet.activate();return Ue.Task.Sa(!0)}return this.pzg(T)};La.prototype.Cdg=function(){var T=this.sheet.tabColor;this.color=T?Kc.a.fp(T):this.nch;this.aef=La.BRd(this.color);this.Bna(!1,void 0,"UpdateTabColor")};La.prototype.Bna=function(T,ra,hb){ra=void 0===ra?!1:ra;hb=void 0===hb?null:hb;if(this.sheet){hb=this.sheet.active;var Eb=this.K6a(),sc=!!this.sheet.tabColor,vb=Kc.a.nG(hb||Eb?xi.a.white:this.color);this.EE.style.background=
"";hb||Eb?(sc?df.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.jLa?this.Bsj():this.om?this.Asj():this.zsj():this.om||(this.EE.style.backgroundColor=vb),this.EE.style.height=this.s1c.toString()+"px"):(this.EE.style.filter="",this.EE.style.backgroundColor=vb,this.EE.style.height=this.t1c.toString()+"px");this.XO.className=hb?Db.FGj:Eb?Db.dark:this.aef?Db.light:Db.dark;vb=El(this.Hna);for(var Wc=vb.next();!Wc.done;Wc=vb.next())Wc.value.Gcg();this.om&&
(T&&!sc&&(this.EE.style.backgroundColor="#E1DFDD"),se.DOMElementExtensions.toggleCssClass(this.domElement,Db.KGj,T),ra?(sc||(this.EE.style.backgroundColor=this.C5b),this.domElement.style.backgroundColor=this.C5b):(sc||(this.EE.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.XO.style.fontWeight=hb||Eb||!this.om&&T?this.om?"600":"bold":""}else fc.ULS.sendTraceTag(537153687,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",
hb)};La.prototype.Asj=function(){var T=this.EE.style,ra=Kc.a.nG(La.I_c(this.color,this.J4c));T.background=ra};La.prototype.zsj=function(){var T=this.EE.style,ra=Kc.a.nG(La.I_c(this.color,1)),hb=Kc.a.nG(La.I_c(this.color,this.J4c)),Eb="";if(Da.a.jxa)Eb="-webkit-";else if(Da.a.Gf)Eb="-moz-";else if(Da.a.xf){if(Eb="-ms-",!Da.a.x6a){T.filter=String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",ra,hb);return}}else Da.a.Ref&&(Eb="-o-");T.background=String.format("{0}linear-gradient({1}, {2})",
Eb,ra,hb)};La.prototype.Bsj=function(){this.EE.style.background="transparent"};La.prototype.R3g=function(){this.bFc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=Db.GGj;se.DOMElementExtensions.zu(this.anchor,re.a.nob,null,null);this.tabIndex=-1};La.prototype.S9g=function(){this.EE=document.createElement("span");this.EE.className=Db.IGj;this.XO=document.createElement("span");this.XO.className=Db.NGj;this.XO.dir=this.sheet.rtlName?"rtl":"ltr";this.EE.appendChild(this.XO)};
La.prototype.qzj=function(){for(var T=this.$.wJ,ra=El(this.Hna),hb=ra.next();!hb.done;hb=ra.next())hb.value.pzj(T,this.EE,this.XO)};La.prototype.K6a=function(){return Mf.g(this.$).K6a(this.sheet)};La.prototype.SDj=function(){this.Ckd.start();this.Qod=!0};La.prototype.aLe=function(T){if(this.Qod){this.Ckd.stop();var ra={};T=(ra["Sheet index"]=this.sheet.index,ra["Active Sheet"]=this.sheet.active,ra["Hovering time"]=this.Ckd.Bc,ra["Has been clicked"]=T,ra);fc.ULS.sendTraceTag(537153686,0,50,Ze.c(T));
this.Qod=!1}};La.prototype.B8i=function(){Oe.a.instance.pa(Df.a.pointerDown,this.domElement,this.onPointerDown);lf.KeyInputManager.instance.pa(Df.a.Yb,this.domElement,this.onKeyDown);lf.KeyInputManager.instance.pa(Df.a.yp,this.domElement,this.Qz);this.Jc.ka("mouseover",this.UN);this.Jc.ka("mouseout",this.SN);Oe.a.instance.pa(Df.a.JW,this.domElement,this.zya);Oe.a.instance.pa(Df.a.Fy,this.domElement,this.Aya);if(this.X6a||df.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))Oe.a.instance.pa(Df.a.$d,
this.domElement,this.Of),this.Xwa&&(Zg.a.instance.pa(Df.a.De,this.domElement,this.Of),Zg.a.instance.pa(Df.a.yg,this.domElement,this.YN));$c.a.instance.pa(Df.a.click,this.domElement,this.vd);this.mV=!0};La.prototype.p2b=function(){var T=this.$.da.Aa(65);return T&&T.tba()?(T.tJb(),this.lxe(T),!0):!1};La.wfd=function(T){var ra=ec.a.get(T);ra||(ec.a.Kv(T,"true",ec.a.rW),ra=ec.a.get(T));return ra};La.I_c=function(T,ra){if(1<ra||-1>ra)return T;var hb=T.r,Eb=T.g;T=T.b;0<ra?(hb=hb*(1-ra)+255*ra,Eb=Eb*(1-
ra)+255*ra,T=T*(1-ra)+255*ra):(hb*=1+ra,Eb*=1+ra,T*=1+ra);return xi.a.zub(Math.round(hb),Math.round(Eb),Math.round(T))};La.BRd=function(T){return 128>=(222*T.r+707*T.g+71*T.b)/1E3};Ek.Object.defineProperties(La.prototype,{nch:{configurable:!0,enumerable:!0,get:function(){return this.CHc||(this.CHc=Kc.a.fp("#F5F5F5"))}},name:{configurable:!0,enumerable:!0,get:function(){return this.XO.innerText},set:function(T){this.XO&&(this.XO.innerText=T,this.vBc(),this.wdg())}},sheet:{configurable:!0,enumerable:!0,
get:function(){return this.EWb}},anchor:{configurable:!0,enumerable:!0,get:function(){return this.bFc}},tabIndex:{configurable:!0,enumerable:!0,get:function(){return this.anchor.tabIndex},set:function(T){this.anchor.tabIndex=T}}});Object(je.a)(La,"SheetTabButton",rc,[]);Am(mb,rc);Object(je.a)(mb,"WorkbookProtectionButton",rc,[]);var mg=b(49),cg=b(45),Sg=b(53),$g=Uh.a;Am(Ra,$g);Ra.prototype.Bb=function(T,ra,hb,Eb,sc,vb,Wc){Wc=void 0===Wc?!1:Wc;T.removeAttribute("Href");T.setAttribute(re.a.Td,re.a.Ws);
T.className=Db.Orh;T.title=ra;T.tabIndex=0;this.Nw&&vb?hb=this.svgIconProvider.oba(vb,12,12,T,24,24):(ra=document.createElement("span"),ra.className=this.om?da.a.EYg:da.a.rw,ra.classList.add(O.a.eia),ra.tabIndex=-1,T.appendChild(ra),vb=document.createElement("img"),vb.src=ve.a.We(hb),vb.className=Eb,vb.alt=sc,vb.tabIndex=-1,ra.appendChild(vb),hb=vb);Wc&&T.classList.add(O.a.kZ);return hb};Ra.prototype.dispose=function(){if(this.$){var T=this.$.xa;T.Xg(this.gi);T.bJd(this.mya);T.e7(this.hD);T.Pma(this.ZEb);
T.sQa(this.Kya);T.SPf(this.vCf);T.hIb(this.xCf);T.Taj(this.wCf);T.mJd(this.etf);T.PPf(this.ftf);T.QPf(this.gtf);T.RPf(this.QOa);this.$.Sl(this.zd);this.$.zD(this.fj);uh.a(this.$)&&uh.a(this.$).vg.Qma(this.HF);this.Pta&&Mf.g(this.$).uPf(this.$Db);ee.a.instance.za(Df.a.bD,this.domElement,this.t6)}Ne.a.zc(this.Bxd);this.Bxd=null;if(this.HK)for(T=0;T<this.HK.length;T++){var ra=se.DOMElementExtensions.bK(this.HK[T],this.domElement,!1,"a");ra&&ye.a.Lma(ra)}Ne.a.Ha(this.nC);Ne.a.Ha(this.Ywc);Ne.a.Ha(this.AQd);
this.AQd=this.Ywc=this.lyb=this.QH=this.nC=null;this.$&&this.Gz&&this.GQ(!1);this.daa=null;this.zOd(null,"Dispose");this.NMb=this.HM=this.u7b=null;this.H0c();this.edb=this.Zwc=this.BQd=this.Wk=this.HK=this.$=this.ea=null;$g.prototype.dispose.call(this)};Ra.prototype.Wf=function(T,ra){if(!ra){fc.ULS.shipAssertTag(537153760,0,0<this.Ah.length,"There is no sheet tab button.");if(!this.Ah.length)return!1;T=null;for(var hb=El(this.Ah),Eb=hb.next();!Eb.done&&!(T=Eb.value.VOh());Eb=hb.next());if(!T)return fc.ULS.shipAssertTag(537153759,
0,!1,"There is no focusable tab element."),!1;se.DOMElementExtensions.setFocus(T)}return!ra};Ra.prototype.ph=function(T){return se.DOMElementExtensions.Ff(this.uc,T)};Ra.prototype.Cj=function(){};Ra.prototype.Rj=function(){};Ra.prototype.reorderSheets=function(T,ra,hb){if(this.P_&&this.P_!==T){var Eb=this.P_.index;this.adj(this.P_,T,ra);T=T?T.index-1:ra?this.$.xa.count-1:0;Eb!==T&&(this.ovi(Eb,T,hb),this.ykh(this.P_.name,T))}};Ra.prototype.F_h=function(T){T=this.Qia(T);return-1!==T&&this.hv<=T&&T<=
this.vK?this.Ah[T].domElement:null};Ra.prototype.zSj=function(T){if(this.Nw){for(var ra=0;ra<this.HK.length;ra++){var hb=this.HK[ra];if(hb&&this.svgIconProvider){var Eb=hb.parentNode;this.ZOf(hb);Eb&&(this.HK[ra]=this.svgIconProvider.oba(T?this.MHf[ra]:this.Cxd[ra],12,12,Eb,24,24))}}for(ra=0;ra<this.Ah.length;ra++)this.Ah[ra].vdg(T);this.RRa&&this.RRa.xsa&&this.udg(Te.a.x1h,this.RRa,T);this.QH&&this.QH.xsa&&this.udg(Te.a.O_g,this.QH,T)}};Ra.prototype.udg=function(T,ra,hb){ra.$$a||(ra.$$a=this.svgIconProvider.oba(T,
12,12,ra.xsa.parentNode,24,24));ra.$$a&&(se.DOMElementExtensions.setVisible(ra.xsa,!hb),se.DOMElementExtensions.setVisible(ra.$$a,hb))};Ra.prototype.vRi=function(T,ra){var hb=Mf.g(this.$),Eb=hb.inRangePicker,sc=Qg.HelperMethods.Jm(ra);if(hb.isEditing&&!Eb){var vb=hb.Dj?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed",Wc=void 0;df.EwaSettings.M6a&&(Wc=[Object(Ua.a)(hb.wc.textBox.jBa)]);Ua.b(this.$).qTa(sc.rawEvent,vb,Wc);hb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}hb=this.Xwa&&
3===ra.yb;!(2===ra.yb&&sc.button===Sys.UI.MouseButton.leftButton||hb)||Eb||this.tF||uh.a(this.$).Mq()||(hb&&T.rRi(),this.UAb=ra.clientPoint.x,this.mZ=ra,this.ANg(T))};Ra.prototype.tRi=function(T){!this.Gz&&this.tF&&this.rSd(T.sheet,!1)};Ra.prototype.uRi=function(T){this.Gz||(this.tF&&this.reorderSheets(T.sheet,!1,!0),this.GQ());this.t0()};Ra.prototype.ipe=function(){return this.$.isEditMode&&!Pa.k(this.$.kg)};Ra.prototype.t0=function(){var T=this,ra=Qg.HelperMethods.hca(function(){T.DQj();T.om&&T.asj();
T.ePd()});fc.ULS.sendTraceTag(537153757,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",ra)};Ra.prototype.asj=function(){var T=this.vK===this.Ah.length-1;se.DOMElementExtensions.toggleCssClass(this.edb,this.$.wJ?Db.lOe:Db.$Ne,!!this.hv);se.DOMElementExtensions.toggleCssClass(this.edb,this.$.wJ?Db.$Ne:Db.lOe,!T)};Ra.prototype.ePd=function(T){T=void 0===T?!1:T;var ra=!this.hv,hb=this.vK===this.Ah.length-1;this.KZf(4,this.sheetTabActivatePreviousHidden,!ra);this.KZf(5,this.sheetTabActivateNextHidden,
!hb);this.twc(0,ra||T);this.twc(1,ra||T);this.twc(2,hb||T);this.twc(3,hb||T)};Ra.prototype.KZf=function(T,ra,hb){if(T=this.HK[T]){se.DOMElementExtensions.setVisible(T,hb);var Eb=this.T_e(T);Eb.title="img"===T.nodeName?T.alt=0<this.Ah.length&&hb?ra:"":T.title=0<this.Ah.length&&hb?ra:"";Eb.tabIndex=hb?0:-1}};Ra.prototype.T_e=function(T){return this.Nw?T.parentNode:T.parentNode.parentNode};Ra.prototype.twc=function(T,ra){if(T=this.HK[T])T=this.T_e(T),void 0!==T&&null!==T&&(!this.Ah.length||ra?(T.classList.add(O.a.kZ),
T.setAttribute(re.a.fsa,"true")):(T.classList.remove(O.a.kZ),T.setAttribute(re.a.fsa,"false")))};Ra.prototype.IRa=function(T){var ra=this.$.wJ?this.Ah.length-1:0,hb=this.g2e(this.$.wJ?0:this.Ah.length-1);hb&&(hb.borderRightWidth=T?"1px":"0");this.hv!==this.vK&&(hb=this.g2e(ra))&&(hb.borderRightWidth="0")};Ra.prototype.lme=function(T,ra){this.Ah||(this.Ah=[]);-1===ra?Array.add(this.Ah,T):Array.insert(this.Ah,ra,T)};Ra.prototype.T4b=function(T,ra){var hb=-1,Eb=null;ra||(hb=this.TSh(T.index),-1!==hb&&
(Eb=this.BKa(hb)));T=new La(this.$,this.Wk,Eb,T,this,this.om,this.Nw);this.lme(T,hb);se.DOMElementExtensions.setVisible(T.domElement,!0)};Ra.prototype.rSd=function(T,ra){var hb=this.K2a(T);if(hb){this.yld=T;this.Twd=ra;T=hb.domElement;hb=this.isRtl?T.offsetLeft+(this.Wk.scrollWidth-this.Wk.clientWidth-this.Wk.scrollLeft):T.offsetLeft-this.Wk.scrollLeft;if(!this.isRtl&&ra||this.isRtl&&!ra)hb+=T.offsetWidth;this.Xwc.style.left=Qg.HelperMethods.nc(hb-4);se.DOMElementExtensions.setVisible(this.Xwc,!0)}};
Ra.prototype.Q7e=function(){se.DOMElementExtensions.setVisible(this.Xwc,!1)};Ra.prototype.F0=function(T){var ra=this,hb=Qg.HelperMethods.hca(function(){switch(T){case 0:ra.Xuc(0);break;case 1:ra.Xuc(ra.hv-1);break;case 2:ra.Xuc(ra.hv+1);break;case 3:ra.scrollIntoView(ra.Ah.length-1);break;case 4:ra.hv&&1<=ra.Ah.length&&(ra.bke(ra.hv-1),ra.VMd());break;case 5:ra.vK!==ra.Ah.length-1&&1<=ra.Ah.length&&(ra.bke(ra.vK+1),ra.VMd());break;case 6:ra.VMd()}});this.C7b&&this.tF&&this.gOb();fc.ULS.sendTraceTag(537153755,
0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",T,hb)};Ra.prototype.bke=function(T){(T=this.aR(T))&&T.activate()};Ra.prototype.pBh=function(T){if(0===T.Py)for(var ra=this.$.xa,hb=0,Eb=0,sc=ra.count;Eb<sc;Eb++){var vb=Object(ug.a)(S.a,ra.getItem(Eb));if(vb===T)return hb;0===vb.Py&&hb++}return-1};Ra.prototype.cBh=function(T){var ra=this.$.xa;T=T.index+1;for(var hb=ra.count;T<hb;T++){var Eb=Object(ug.a)(S.a,ra.getItem(T));if(0===Eb.Py)return Eb}return null};Ra.prototype.Qia=
function(T){for(var ra=0;ra<this.Ah.length;ra++){var hb=this.aR(ra);if(!hb)fc.ULS.sendTraceTag(537153754,0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",ra);else if(hb.sheet===T)return ra}return-1};Ra.prototype.K2a=function(T){T=this.Qia(T);return this.aR(T)};Ra.prototype.ovi=function(T,ra,hb){var Eb={};Eb.a=this.$.ya.UserSessionId;Eb.b=hb;Eb.c=this.l7b;Eb.d=T;Eb.e=ra;Eb.f=this.$.xa.count;mg.b().Qe(2,Eb,hb)};Ra.prototype.adj=
function(T,ra,hb){var Eb=Object(ug.a)(ja.a,this.$.xa);ra?(ra=ra.index,ra=T.index<ra?ra-1:ra):ra=hb?Eb.count-1:0;Eb.reorderSheet(T,ra,!0)};Ra.prototype.hZf=function(T){Mf.g(this.$).rg.Mo(T)};Ra.prototype.ANg=function(T){if(!this.rtc){var ra=this.domElement.ownerDocument.body;this.Gz?(Oe.a.instance.pa(Df.a.vh,document.documentElement,this.LK),this.Xwa&&(Zg.a.instance.pa(Df.a.yg,document.documentElement,this.LK),Zg.a.instance.pa(Df.a.yg,this.domElement,this.YN))):(Oe.a.instance.pa(Df.a.vh,ra,this.LK),
Zg.a.instance.pa(Df.a.yg,ra,this.LK));Oe.a.instance.pa(Df.a.$d,document.documentElement,this.X_);Zg.a.instance.pa(Df.a.De,ra,this.X_);this.rtc=!0}this.P_=T.sheet;this.l7b=!1;this.Gz?(this.HM=null,this.u7b=T,this.daa=T.domElement,this.zOd(se.DOMElementExtensions.getBoundingClientRect(this.daa),"BeginSheetTabButtonDrag")):(fc.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),this.domElement.classList.add(Db.ZNe),this.domElement.style.cursor=
"",this.hZf("pointer"))};Ra.prototype.GQ=function(T){T=void 0===T?!0:T;if(this.rtc){this.hZf(re.a.P4);var ra=this.domElement.ownerDocument.body;this.Gz?(Oe.a.instance.za(Df.a.vh,document.documentElement,this.LK),this.Xwa&&(Zg.a.instance.za(Df.a.yg,document.documentElement,this.LK),Zg.a.instance.za(Df.a.yg,this.domElement,this.YN))):(Oe.a.instance.za(Df.a.vh,ra,this.LK),Zg.a.instance.za(Df.a.yg,ra,this.LK));Oe.a.instance.za(Df.a.$d,document.documentElement,this.X_);Zg.a.instance.za(Df.a.De,ra,this.X_);
this.CLc=this.rtc=!1}this.Zpc=0;this.l7b=!1;this.yld=this.P_=null;this.Gz?(this.daa&&(this.daa.style.visibility="visible",this.daa=null),this.u7b=null,this.zOd(null,"EndSheetTabButtonDrag"),this.HM&&(this.HM.parentNode&&this.HM.parentNode.removeChild(this.HM),this.HM=null),this.pfj(T)):(this.domElement.classList.remove(Db.ZNe),this.Q7e())};Ra.prototype.pfj=function(T){this.bUd(T);this.TC=this.UAb=-1};Ra.prototype.ykh=function(T,ra){function hb(Wc,Zd,uf){var If=vb.Na(9,null);If.sheetName=T;If.newSheetIndex=
ra;return Vg.i(vb,"ReorderSheets",If,Wc,Zd,uf,null,0)}function Eb(){return new pb(T,ra)}var sc=this.$.na,vb=sc?sc.ua:null;df.EwaSettings.qc()?this.$.userOperationManager.ic(new Ab.a(557,0,hb,64,Eb),null):this.$.userOperationManager.ic(new rb.a(557,0,hb,void 0,Eb),null)};Ra.prototype.aR=function(T){return 0<=T&&T<this.Ah.length?this.Ah[T]:null};Ra.prototype.f2e=function(T){return(T=this.aR(T))?T.sheet:null};Ra.prototype.BKa=function(T){return(T=this.aR(T))?T.domElement:null};Ra.prototype.g2e=function(T){return(T=
this.BKa(T))?T.style:null};Ra.prototype.TSh=function(T){var ra=this.$.xa;T+=1;for(var hb=-1,Eb=this.Ah?this.Ah.length:0;T<ra.count;){var sc=Object(ug.a)(S.a,ra.getItem(T));if(0===sc.Py){for(hb=0;hb<Eb&&this.f2e(hb)!==sc;hb++);break}T++}return-1===hb||hb===Eb?-1:hb};Ra.prototype.rCf=function(T){var ra=this.K2a(T);ra&&(this.Gz&&this.tF&&(fc.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),df.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.GQ()),this.Wk.removeChild(ra.domElement),ra=Array.indexOf(this.Ah,ra),Array.removeAt(this.Ah,ra),this.t0(),(!this.isRtl&&ra===this.Ah.length||this.isRtl&&!ra)&&this.IRa(!0),this.C7b&&this.tF?T===this.P_?(this.GQ(),this.F0(6)):this.gOb():this.F0(6))};Ra.prototype.tCf=function(T){var ra=Object(ug.a)(S.a,T);this.Gz&&this.tF&&(fc.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),df.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.GQ());if(0===ra.Py){this.IRa(!1);var hb=this.Qia(T);-1===hb&&(fc.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.T4b(ra,!1),hb=this.Qia(T));this.T5e(hb,!0)}};Ra.prototype.bdj=function(T,ra){var hb=this.K2a(T);hb&&(this.Gz&&this.tF&&!ra&&(fc.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),df.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.GQ()),T=this.AGj(T,hb),!df.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.Gz&&T&&ra&&T.qRi())};Ra.prototype.AGj=function(T,ra){var hb=Array.indexOf(this.Ah,ra),Eb=this.pBh(Object(ug.a)(S.a,T));if(-1===Eb||-1===hb)return null;hb!==Eb||this.Gz?(this.IRa(!1),Eb=Ra.Ycj(hb,Eb,this.hv,this.vK),this.hv=Eb.PBh,this.vK=Eb.dqi,ra&&ra.domElement.parentNode===this.Wk&&(this.Wk.removeChild(ra.domElement),Array.removeAt(this.Ah,hb)),ra=this.cBh(T),hb=this.Qia(ra),
ra=new La(this.$,this.Wk,this.BKa(hb),Object(ug.a)(S.a,T),this,this.om,this.Nw),this.lme(ra,hb),hb=this.Qia(T),this.T5e(hb,!1,!this.om)):ra=null;return ra};Ra.prototype.klh=function(){for(var T=this.Ah?this.Ah.length:0,ra=this.hv,hb=this.vK,Eb=0;Eb<T;Eb++){var sc=this.aR(Eb),vb=Eb>=ra;sc&&(sc.tabIndex=vb&&Eb<=hb?0:-1)}};Ra.prototype.oPj=function(){for(var T=this.Ah?this.Ah.length:0,ra=0;ra<T;ra++){var hb=this.aR(ra);hb&&hb.sfb()}};Ra.prototype.T5e=function(T,ra,hb){hb=void 0===hb?!0:hb;ra&&T<=this.hv&&
this.hv++;this.klh();this.IRa(!0);this.t0();this.C7b&&this.tF?this.gOb():hb&&this.F0(6)};Ra.prototype.cwc=function(T){var ra=this.$.wJ;if(T||this.isRtl!==ra)this.isRtl=ra,this.domElement.classList.remove(this.isRtl?da.a.gOe:da.a.mOe),this.domElement.classList.add(this.isRtl?da.a.mOe:da.a.gOe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.oPj();T||this.IRa(!0);for(T=0;T<this.HK.length;T++)0!==T&&3!==T&&(!this.om||4!==T&&5!==T)&&this.LZf(T)};Ra.prototype.B7g=function(){var T=this.BQd=document.createElement("div");
T.className=Db.Lrh;this.om&&T.classList.add(Db.Mrh);this.domElement.appendChild(T);this.M4b(T,1,717,716);this.M4b(T,2,719,718);this.zgf&&(this.RRa=new tc(this.$,this,T));this.om||this.M4b(T,4,723,722)};Ra.prototype.C7g=function(){var T=this.Zwc=document.createElement("div");T.className=Db.Nrh;this.domElement.appendChild(T);this.om||this.M4b(T,5,725,724);this.c4c()};Ra.prototype.E8g=function(){var T=document.getElementById(re.a.Buj),ra=document.getElementById(re.a.Cuj);T&&!ra&&fc.ULS.sendTraceTag(537153746,
0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: {0}. progressBar div has child: {1}. ProgressBarMessage div exists: {2}",T.parentNode.id,!!T.firstChild,!!document.getElementById(re.a.rQd));if(Dc.a.Fgf(this.$)&&T&&ra)this.domElement.appendChild(T),this.CQd=T.firstChild,this.DQd=document.getElementById(re.a.rQd),ra.style.visibility="visible";else{T=document.createElement("div");ra=document.createElement("div");T.className=da.a.Wrh;ra.className=
da.a.Urh;ra.style.display="none";var hb=document.createElement("div");hb.className=da.a.Xrh;var Eb=document.createElement("div");Eb.className=da.a.Vrh;var sc=document.createElement("div");sc.className=da.a.Trh;ra.appendChild(hb);ra.appendChild(Eb);ra.appendChild(sc);T.appendChild(ra);this.domElement.appendChild(T);this.CQd=ra;this.DQd=Eb}};Ra.prototype.LZf=function(T){var ra=this.HK[T];if(ra)if(this.Nw){var hb=ra.parentNode;this.ZOf(ra);ra=kc.a(this.$)?this.MHf[T]:this.Cxd[T];this.HK[T]=this.svgIconProvider.oba(ra,
12,12,hb,24,24)}else ra.className=this.Axd[T]};Ra.prototype.ZOf=function(T){(null===T||void 0===T?0:T.parentNode)&&T.parentNode.removeChild(T)};Ra.prototype.c5g=function(){var T=this.edb=document.createElement("div");T.className=Db.Irh;this.domElement.appendChild(T);this.J9g(T)};Ra.prototype.J9g=function(T){var ra=document.createElement("div");ra.className=Db.Zrh;ra.classList.add(Db.Jrh);this.$.printingEnabled||ra.classList.add(hg.a.vQe);T.appendChild(ra);this.Wk=document.createElement("ul");se.DOMElementExtensions.zu(this.Wk,
re.a.hXc,null,null);this.Wk.className=hg.a.nOe;ra.appendChild(this.Wk);this.u7g();this.yge=document.createElement("div");this.Uwc.id="SheetIconTooltipContainer";ra.appendChild(this.Uwc)};Ra.prototype.u7g=function(){var T=document.createElement("div"),ra="<div class='"+da.a.HYg+"'>{0}</div>",hb=ve.a.sdd(da.a.fth,0,"55_16_N","");T.innerHTML=String.format(ra,hb);T.className=Db.Yrh;se.DOMElementExtensions.setVisible(T,!1);this.Xwc=T;this.Wk.appendChild(T)};Ra.prototype.u4c=function(){for(var T=this.$.xa,
ra=0,hb=T.count;ra<hb;ra++){var Eb=Object(ug.a)(S.a,T.getItem(ra));0===Eb.Py&&(this.T4b(Eb,!0),Eb.active&&Eb.activate())}};Ra.prototype.H0c=function(){Ne.a.zc(this.Ah);this.Ah=[];this.vK=this.hv=0};Ra.prototype.M4b=function(T,ra,hb,Eb){function sc(uf){"mouseup"===uf.type&&vb.Gz&&vb.tF||od.g(uf);Wc.classList.contains(O.a.kZ)||(Zd?vb.hOi(uf,ra):vb.om||vb.Dzf(uf,ra))}var vb=this,Wc=document.createElement("a");T.appendChild(Wc);T=this.Cxd[ra];this.HK[ra]=this.Bb(Wc,Fe.a.instance.fa(Eb),0,this.Axd[ra],
Fe.a.instance.fa(hb),T);if(5===ra||4===ra)se.DOMElementExtensions.bK(this.HK[ra],Wc,!1,"span").style.marginTop="10px";this.LZf(ra);hb=this.Bxd[ra]=this.he.Zd(Wc);Oe.a.instance.pa(Df.a.pointerDown,Wc,function(uf){return uf.ctrlKey&&vb.gIi(ra)?!0:vb.Bzf(ra)});Oe.a.instance.pa(Df.a.$d,Wc,function(){return vb.Czf()});Zg.a.instance.pa(Df.a.De,Wc,function(){return vb.Czf()});Oe.a.instance.pa(Df.a.pointerOut,Wc,function(){return vb.z0c()});lf.KeyInputManager.instance.pa(Df.a.Yb,Wc,function(uf){return 13!==
uf.Ca.keyCode&&32!==uf.Ca.keyCode||vb.E2c?!1:(vb.E2c=!0,vb.Bzf(ra))});lf.KeyInputManager.instance.pa(Df.a.Ud,Wc,function(uf){return 13===uf.Ca.keyCode||32===uf.Ca.keyCode?(vb.E2c=!1,vb.z0c()):!1});var Zd=this.ipe();hb.ka("mouseover",sc);hb.ka("mouseout",sc);hb.ka("focus",sc);hb.ka("blur",sc);Zd&&hb.ka("mouseup",sc)};Ra.prototype.Dcf=function(T){var ra=!1,hb=this.$.Lf;hb&&(ra=fb.a.xB(se.DOMElementExtensions.getBoundingClientRect(hb),T.clientPoint));return ra};Ra.prototype.Bgf=function(T){return fb.a.xB(se.DOMElementExtensions.getBoundingClientRect(this.domElement),
T.clientPoint)||this.Dcf(T)};Ra.prototype.lBh=function(T){var ra=null,hb=T.clientPoint,Eb=this.hv;if(this.Bgf(T))for(Eb=this.hv;Eb<=this.vK;Eb++)if(ra=this.aR(Eb))if(T=se.DOMElementExtensions.getBoundingClientRect(ra.domElement),!this.isRtl&&hb.x<T.x+T.width||this.isRtl&&hb.x>T.x)break;return{returnValue:ra,fyj:Eb>this.vK}};Ra.prototype.gOb=function(){if(this.Gz){if(!this.HM){fc.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");
this.HM=this.daa.cloneNode(!0);if(!this.yUf(this.HM,this.daa,!0,"UpdateDragAndDropState"))return;this.daa.style.visibility="hidden";this.HM.classList.add(Db.$rh);this.HM.style.borderRightWidth="";this.Pcc=this.mZ.clientPoint.x-this.a4.width/2;this.HM.style.left=this.Pcc+"px";this.TC=this.Qia(this.P_);0>this.TC&&fc.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.C7b&&(this.TC=this.Qia(this.P_));var T=se.DOMElementExtensions.getBoundingClientRect(this.Wk),
ra=T.x;T=T.x+T.width;var hb=this.mZ.clientPoint.x-this.a4.width/2;hb=Math.min(hb,T-this.a4.width);hb=Math.max(hb,ra);this.HM.style.transform="translateX("+Math.abs(hb-this.Pcc)*(this.Pcc<hb?1:-1)+"px)";var Eb=this.mZ.clientPoint.x>this.UAb,sc=this.mZ.clientPoint.x;hb>=T-this.a4.width?(sc=T-this.a4.width/2,this.TMd()||this.Cma||(fc.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.gpc=this.Wk.scrollLeft,
this.Cma=window.requestAnimationFrame(this.dWf))):hb<=ra?(sc=ra+this.a4.width/2,this.SMd()||this.Cma||(fc.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.gpc=this.Wk.scrollLeft,this.Cma=window.requestAnimationFrame(this.cWf))):this.Cma&&(fc.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.bUd());this.mZ.clientPoint.x!==
this.UAb&&(this.NUd(Eb,sc),this.UAb=this.mZ.clientPoint.x)}else T=this.lBh(this.mZ),ra=T.fyj,(T=T.returnValue)?this.rSd(T.sheet,ra):this.Q7e();this.CLc=!0};Ra.prototype.NUd=function(T,ra){for(var hb=this,Eb;function(){var sc=hb.yhh(ra,T);Eb=sc.P1b;return sc}().returnValue;)this.NMb=Eb,this.ZIg(T)};Ra.prototype.ZIg=function(T){if(this.NMb){var ra=(T?1:-1)*this.a4.width;if(T&&!this.$.wJ||!T&&this.$.wJ){var hb=this.daa;var Eb=this.TC+1;var sc=!0}else hb=(Eb=this.aR(this.TC+1))?Eb.domElement:null,Eb=
this.TC-1,sc=!1;if(this.yUf(this.NMb,hb,sc,"AnimateSheetSwap")){fc.ULS.sendTraceTag(537153738,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",this.TC,Eb,this.zQd,T);0<=this.TC&&this.TC<this.Ah.length&&0<=Eb&&Eb<this.Ah.length?(T=this.Ah[Eb],this.Ah[Eb]=this.Ah[this.TC],this.Ah[this.TC]=T):(fc.ULS.sendTraceTag(537153737,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",
this.Ah.length,this.TC,Eb),this.GQ());this.TC=Eb;var vb=this.NMb;vb.style.transform="translateX("+ra+"px)";window.requestAnimationFrame(function(){vb.style.transform="translateX(0px)"})}}};Ra.prototype.yUf=function(T,ra,hb,Eb){function sc(vb){return vb?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",vb.id,vb.className,vb.nodeName):null}try{return this.Wk.insertBefore(T,ra),!0}catch(vb){return T=this.K2a(this.P_),fc.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
T?T!==this.u7b?"Changed":"NoChange":"Removed",Eb,sc(ra),sc(ra.parentNode),sc(this.Wk),hb,this.TC,this.zQd,vb),this.GQ(),!1}};Ra.prototype.yhh=function(T,ra){var hb=this.$.wJ===ra?this.aR(this.TC-1):this.aR(this.TC+1);if(!hb)return{returnValue:!1,P1b:null};hb=hb.domElement;var Eb=se.DOMElementExtensions.getBoundingClientRect(hb);return this.a4?ra?{returnValue:T+this.a4.width/2>=Eb.x+.5*Eb.width,P1b:hb}:{returnValue:T-this.a4.width/2<=Eb.x+.5*Eb.width,P1b:hb}:(fc.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.GQ(),{returnValue:!1,P1b:hb})};Ra.prototype.aWf=function(T,ra){var hb=ra?this.dWf:this.cWf;if(-1===this.Nyc)this.Nyc=T,this.Cma=window.requestAnimationFrame(hb);else{T=Math.floor((T-this.Nyc)/1E3*300);var Eb=this.ZIb>this.BBb?1:-1;this.scrollLeft(Math.abs(this.Wk.scrollLeft-(ra?this.gpc+T*Eb:this.gpc-T*Eb))*(ra?-1:1));if(T=this.pZe("ScrollStep"))this.NUd(ra,T.x+T.width/2),ra&&!this.TMd()||!ra&&!this.SMd()?this.Cma=window.requestAnimationFrame(hb):(fc.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.bUd())}};Ra.prototype.TMd=function(){var T=this.ZIb>this.BBb;return T&&this.gna>=this.ZIb||!T&&this.gna<=this.ZIb};Ra.prototype.SMd=function(){var T=this.ZIb>this.BBb;return T&&this.gna<=this.BBb||!T&&this.gna>=this.BBb};Ra.prototype.bUd=function(T){T=void 0===T?!0:T;this.Wk&&(this.gna=this.Wk.scrollLeft);window.cancelAnimationFrame(this.Cma);this.Cma=0;this.Nyc=-1;T&&this.t0()};Ra.prototype.zOd=function(T,ra){T||fc.ULS.sendTraceTag(537153733,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",
ra);this.a4=T};Ra.prototype.gIi=function(T){return 2===T?(this.F0(3),!0):1===T?(this.F0(0),!0):!1};Ra.prototype.Bzf=function(T){var ra=this;fc.ULS.shipAssertTag(537153732,0,-1===this.wPa&&-1===this.vPa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.wPa&&(window.clearTimeout(this.wPa),this.wPa=-1);-1!==this.vPa&&(window.clearInterval(this.vPa),this.vPa=-1);this.F0(T);this.wPa=window.setTimeout(function(){ra.hEj(T)},
this.LBi);return!0};Ra.prototype.hEj=function(T){var ra=this;this.vPa=window.setInterval(function(){ra.F0(T)},this.KBi)};Ra.prototype.Czf=function(){this.z0c();return!this.Gz||!this.tF};Ra.prototype.z0c=function(){window.clearTimeout(this.wPa);window.clearInterval(this.vPa);this.vPa=this.wPa=-1;return!0};Ra.prototype.Dzf=function(T,ra){var hb=this.Axd[ra];Qg.HelperMethods.aWd(this.HK[ra],hb,hb+re.a.tec,"mouseover"===T.type||"focus"===T.type)};Ra.prototype.hOi=function(T,ra){var hb=this.Mgc(ra),Eb=
5===ra;if("mouseup"===T.type){if(Eb||4===ra)hb||this.reorderSheets(null,Eb,!1),this.GQ()}else!this.Gz&&this.tF?(hb||this.rSd(this.f2e(Eb?this.vK:this.hv),Eb),this.F0(Eb?2:1)):this.om||this.Dzf(T,ra)};Ra.prototype.Mgc=function(T){return!!se.DOMElementExtensions.ped(this.HK[T],"a").title};Ra.prototype.lCc=function(T){this.aZd(T);this.t0()};Ra.prototype.aZd=function(T){(T=this.K2a(T))&&T.sfb()};Ra.prototype.VMd=function(){var T=this.$.xa;if(T.qa&&(!Sg.e(this.$)||T.count))if(T=this.Qia(T.qa),-1===T)fc.ULS.sendTraceTag(537153729,
0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var ra=this.BKa(T);T<this.hv?this.Xuc(T):T>this.hv&&!this.frd(ra)&&this.scrollIntoView(T)}};Ra.prototype.DQj=function(){this.hv=0;this.vK=this.Ah.length-1;for(var T=!1,ra=0;ra<this.Ah.length;ra++){var hb=this.aR(ra);if(!hb)break;var Eb=this.frd(hb.domElement);hb.tabIndex=Eb?0:-1;if(!T&&Eb)this.hv=ra,T=!0;else if(T&&!Eb){this.vK=ra-1;break}}};Ra.prototype.Xuc=function(T){this.$.xa.count&&(this.Ah.length||
this.u4c(),this.RXf(this.BKa(Math.max(0,Math.min(T,this.Ah.length-1)))),this.t0())};Ra.prototype.scrollIntoView=function(T){fc.ULS.shipAssertTag(537153697,0,T>=this.hv,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.Ah.length||this.u4c();var ra=this.BKa(Math.max(0,Math.min(T,this.Ah.length-1))),hb=this.BKa(this.hv);if(!this.frd(ra)){ra=se.DOMElementExtensions.getBoundingClientRect(ra);var Eb=se.DOMElementExtensions.getBoundingClientRect(this.edb);
ra=this.isRtl?Eb.x-ra.x:ra.x+ra.width-(Eb.x+Eb.width);for(Eb=0;hb&&Eb<ra;){var sc=se.DOMElementExtensions.getBoundingClientRect(hb);Eb+=sc.width;hb=hb.nextSibling}hb?this.RXf(hb):fc.ULS.sendTraceTag(537153696,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",this.hv,this.vK,T)}this.t0()}};Ra.prototype.RXf=function(T){var ra=se.DOMElementExtensions.getBoundingClientRect(this.Wk);T=se.DOMElementExtensions.getBoundingClientRect(T);
this.isRtl?this.scrollLeft(Math.floor(ra.x+ra.width-(T.x+T.width+.5))):this.scrollLeft(Math.ceil(ra.x-T.x-.5))};Ra.prototype.scrollLeft=function(T){(0>T&&this.TMd()||0<T&&this.SMd())&&fc.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var ra=this.Wk.scrollLeft;if(this.isRtl){if(Da.a.wF||Da.a.Gf){this.Wk.scrollLeft=this.gna=ra-T;return}if(Da.a.uB||Da.a.XH){this.Wk.scrollLeft=this.gna=ra+T;return}fc.ULS.sendTraceTag(537153694,
0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Wk.scrollLeft=this.gna=ra-T};Ra.prototype.frd=function(T){T=se.DOMElementExtensions.getBoundingClientRect(T);var ra=se.DOMElementExtensions.getBoundingClientRect(this.edb);return T&&ra?T.x>=ra.x-1&&T.x+T.width<=ra.x+ra.width+1:(fc.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)};Ra.prototype.W7g=function(){var T=this.Zwc;if(ob.x1f(this.$))this.om?(Ne.a.Ha(this.QH),
this.QH=new ob(T,this.$,this,!0)):(Ne.a.Ha(this.QH),this.QH=null);else if(!this.QH||this.om)Ne.a.Ha(this.QH),Pa.k(this.$.kg)?this.QH=new mb(T,this.$,this):this.QH=new ob(T,this.$,this)};Ra.prototype.eEe=function(T,ra){var hb=this.$.xa;if(!this.$.isEditMode||!hb.count)Ne.a.Ha(ra),ra=null;else if(!ra)if(hb=this.om?this.BQd:this.Zwc,Pa.k(this.$.kg))ra=new mb(hb,this.$,this);else switch(T){case 0:ra=new ob(hb,this.$,this);break;case 1:ra=new cb(hb,this.$,this);break;default:fc.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return ra};Ra.prototype.c4c=function(){df.EwaSettings.ma(429)?(this.QH=this.eEe(0,this.QH),this.lyb=this.eEe(1,this.lyb)):this.W7g()};Ra.prototype.pZe=function(T){var ra=se.DOMElementExtensions.getBoundingClientRect(this.HM);ra||(fc.ULS.sendTraceTag(537153689,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",
T),this.GQ());return ra};Ra.prototype.K5e=function(T,ra){this.Pta.bKg(T,ra);this.GQ(!1);this.ePd(this.navigationButtonsDisabled);T=El(this.MGj);for(ra=T.next();!ra.done;ra=T.next())(ra=ra.value)&&ra.GX(this.navigationButtonsDisabled);T=El(this.bte);for(ra=T.next();!ra.done;ra=T.next())(ra=ra.value)&&ra.GX(this.operationButtonsDisabled)};Ra.Ycj=function(T,ra,hb,Eb){T<hb?(ra>hb&&hb--,ra>Eb&&Eb--):T>Eb?(ra<hb&&hb++,ra<Eb&&Eb++):ra<hb&&hb++;return{PBh:hb,dqi:Eb}};Ek.Object.defineProperties(Ra.prototype,
{uc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},we:{configurable:!0,enumerable:!0,get:function(){return Lc.a.yQd}},tF:{configurable:!0,enumerable:!0,get:function(){return this.CLc}},zQd:{configurable:!0,enumerable:!0,get:function(){return this.Ah.length}},Uwc:{configurable:!0,enumerable:!0,get:function(){return this.yge}},Xwa:{configurable:!0,enumerable:!0,get:function(){return this.R9d}},
navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Pta&&this.Pta.navigationButtonsDisabled}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Pta&&this.Pta.operationButtonsDisabled}},Axd:{configurable:!0,enumerable:!0,get:function(){return this.om?this.$.wJ?[da.a.C8b,da.a.iOe,da.a.kOe,da.a.B8b,da.a.sua,da.a.sua]:[da.a.B8b,da.a.kOe,da.a.iOe,da.a.C8b,da.a.sua,da.a.sua]:this.$.wJ?[da.a.C8b,da.a.hOe,da.a.jOe,da.a.B8b,da.a.sua,da.a.sua]:
[da.a.B8b,da.a.jOe,da.a.hOe,da.a.C8b,da.a.sua,da.a.sua]}},Cxd:{configurable:!0,enumerable:!0,get:function(){return this.$.wJ?[null,Te.a.CAe,Te.a.AAe]:[null,Te.a.AAe,Te.a.CAe]}},MHf:{configurable:!0,enumerable:!0,get:function(){return this.$.wJ?[null,Te.a.DAe,Te.a.BAe]:[null,Te.a.BAe,Te.a.DAe]}},BBb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(Da.a.wF)return 0;if(Da.a.Gf)return-1*(this.Wk.scrollWidth-this.Wk.clientWidth);if(Da.a.uv)return this.Wk.scrollWidth-this.Wk.clientWidth;
fc.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}},ZIb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(Da.a.wF)return this.Wk.scrollWidth-this.Wk.clientWidth;if(Da.a.Gf||Da.a.uv)return 0;fc.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Wk.scrollWidth-this.Wk.clientWidth}},bte:{configurable:!0,enumerable:!0,get:function(){return this.Pta?[this.QH,this.lyb]:[this.QH,this.lyb,
this.RRa]}},MGj:{configurable:!0,enumerable:!0,get:function(){return this.Ah.concat(this.RRa)}},Duj:{configurable:!0,enumerable:!0,get:function(){return this.xge}}});Object(je.a)(Ra,"SheetTabBarControl",Uh.a,[932,3,444]);var ti=ac.a;Am(Ha,ti);Ha.prototype.create=function(){var T=this,ra=this.$.Mb,hb=df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.makingFosSheetTabOptional",!1);if(ya.a(this.$.ya,1))hb&&cg.PageLoadTrackingInfo.instance.sda(re.a.Jna,["sheetTabBar"]);else{var Eb=document.getElementById(ra+
re.a.A5c);Eb?(df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&cg.PageLoadTrackingInfo.instance.tAa(re.a.Jna),Dc.a.tqd()?Rc.TaskExtensions.Ba(cc.GetServiceTaskFactory.Va(this.$.da,388,387,this.ub),function(sc){T.Eb(T.$.da.Aa(32)||new Ra(T.$,Eb,sc.result))},this.$.la,3):this.Eb(this.$.da.Aa(32)||new Ra(this.$,Eb))):hb&&cg.PageLoadTrackingInfo.instance.sda(re.a.Jna,["sheetTabBar"])}};Ha.ka=function(T){T.da.Ga(33,new Ha(T))};Object(je.a)(Ha,"SheetTabBarFactory",ac.a,
[]);var Hh=b(52),Lg=b(200);Xa.prototype.WOa=function(){Lg.a.instance.HJd(Object(pf.a)(this,this.WOa,"onSessionExpiredDetected"));fc.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.O3h()};Xa.prototype.eCf=function(){Lg.a.instance.GJd(Object(pf.a)(this,this.eCf,"onSessionExpiringDetected"));this.mge||this.QQc||(fc.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.mge=!0,this.HAj())};Xa.prototype.O3h=function(){this.QQc||(Nc.AFrameworkApplication.ZF(Hh.a.Ivc),
this.QQc=!0,this.GAj())};Object(je.a)(Xa,"ASessionExpirationManager",null,[]);var Tg=b(258),Vh=b(6),fi=b(81),Gj=b(261);Am(qa,Xa);qa.prototype.Mne=function(T){this.Pa.addHandler("SessionExpired",T)};qa.prototype.FZb=function(T){this.Pa.addHandler("TokenRefreshed",T)};qa.prototype.vJd=function(T){this.Pa.removeHandler("TokenRefreshed",T)};qa.prototype.Fdc=function(){return Lg.a.instance.wR(Nc.AFrameworkApplication.uk)};qa.prototype.dispose=function(){Ne.a.Ha(this.Pa);this.$=null};qa.prototype.HAj=function(){this.$.isEditMode&&
this.ddc(!1)};qa.prototype.GAj=function(){this.lmb=!0;this.ddc(!0);this.Pa.raiseEvent("SessionExpired")};qa.prototype.ddc=function(T){var ra=this;fc.ULS.sendTraceTag(537170715,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",T,this.$.ea.Yaa);var hb=this.$.zb.Zp;T&&hb&&hb.isVisible&&1299163859===hb.error.MessageId&&this.$.zb.Zp.Ut();var Eb=this.gd(T);uh.a(this.$).wt(new Tg.a(Vh.a.wz,5,function(){var sc=Wb.a(ra.$),vb=sc.ud.activityState;
vb[fi.a.z2]=ra.$.ipb(ra.$.isEditMode);vb[fi.a.iM]=fi.a.$8a;vb[Gj.a.hr]=Vh.a.accessTokenExpiringWarning;sc.ud.Lt([Eb])}))};qa.prototype.gd=function(T){return T?lh.a.EEe():this.D9g()};qa.prototype.D9g=function(){var T=lh.a.gd(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");T.Description=this.accessTokenExpiringMessage;return T};Ek.Object.defineProperties(qa.prototype,{accessTokenExpiringMessage:{configurable:!0,enumerable:!0,get:function(){var T=(new Date(this.uk)).format(this.$.ya.ShortTimeFormat);
return String.format(Fe.a.instance.Ab(78),T)}},tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.lmb}},hdb:{configurable:!0,enumerable:!0,get:function(){return!1}},Lba:{configurable:!0,enumerable:!0,get:function(){return!1}},JHd:{configurable:!0,enumerable:!0,get:function(){return!1}},N5:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(je.a)(qa,"EwaAccessTokenExpirationManager",Xa,[934,312,3]);var Zi=b(176),Sj=b(739);Object(je.a)(Aa,"RefreshAccessTokenContext",
null,[]);var oh=b(188),Li=b(117),Ai=b(145),Ri=b(34),ki=b(114);Object(je.a)(Nb,"Error",null,[]);Object(je.a)(lb,"NamedResult",null,[]);Am(kb,lb);Object(je.a)(kb,"ErrorInfo",lb,[]);Ek.Object.defineProperties(Gb.prototype,{$O:{configurable:!0,enumerable:!0,get:function(){return this.yXb}},errors:{configurable:!0,enumerable:!0,get:function(){return this.tT}}});Object(je.a)(Gb,"TokenRefreshArgs",null,[951]);Sa.prototype.Mne=function(T){this.Pa.addHandler("SessionExpired",T)};Sa.prototype.FZb=function(T){this.Pa.addHandler("TokenRefreshed",
T)};Sa.prototype.vJd=function(T){this.Pa.removeHandler("TokenRefreshed",T)};Sa.prototype.Fdc=function(){return Lg.a.instance.wR(Nc.AFrameworkApplication.uk)};Sa.prototype.dispose=function(){Lg.a.instance.HJd(this.b6e);Lg.a.instance.GJd(this.B5e);var T=this.$.ea;T&&(T.Dk(this.od),T.$sc(this.Cya));Ne.a.Ha(this.Pa);this.documentVisibilityObserver=this.$=null};Sa.prototype.d9f=function(){return this.Fdc()?0:(Nc.AFrameworkApplication.uk-(new Date).getTime())/6E4};Sa.prototype.Fdg=function(T,ra){if(0<ra&&
!this.Fdc()){var hb=Nc.AFrameworkApplication.ga.Dd("AccessTokenExpirationPromptSeconds",Nc.AFrameworkApplication.AY),Eb=(ra-T.getTime())/6E4;fc.ULS.shipAssertTag(537170713,0,0<=Eb,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [{0}] creationTime [{1}] tokenLifetimeInMin [{2}]",ra,T.getTime(),Eb);Eb<this.Wzi?(fc.ULS.sendTraceTag(537170712,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",
this.Z0f,Eb),Nc.AFrameworkApplication.AY=this.Z0f):Nc.AFrameworkApplication.AY!==hb&&(fc.ULS.sendTraceTag(537170711,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",hb,Eb),Nc.AFrameworkApplication.AY=hb)}};Sa.prototype.$3g=function(T){return!this.context||this.context.uHb||this.context.D4c!==T?(T=new Aa(Zi.a.create().toString(),T),this.context&&!this.context.uAc&&fc.ULS.sendTraceTag(537170710,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",
T.correlationID,this.context.correlationID,this.context.uHb),this.mT=T,!0):!1};Sa.prototype.rfj=function(T){T&&this.oH&&!this.Lba&&this.$.ea.sf.vr&&!this.N5&&(this.oH=!1)};Sa.prototype.c6e=function(T){var ra=this;this.rfj(T);if(!(this.jlb||this.Rdb&&!T||this.oH)&&this.hdb){this.jlb=!0;var hb=this.context?this.context.creationTime:null,Eb=this.$3g(T);this.Nud=!0;var sc=this.$.ea,vb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",newContextCreated:Eb};vb.IsUserActive=sc.sf.vr;vb.IsSessionActive=
sc.sc;vb.ContainsChangesWorkbookOperations=this.$.userOperationManager.wHa();vb.isSessionExpired=T;vb.stopRefreshRetriesUntilTokenExpired=this.Rdb;vb.FailedToRefreshExpiredToken=this.oH;vb.numOfFailuresWhileUserIsActive=ki.a.j6;vb.numOfFailuresWhileUserIsInActive=ki.a.k6;vb.numOfFailuresWhileOffline=ki.a.gya;vb.RefreshAccessTokenCorrelationID=this.context.correlationID;Eb&&hb&&(vb.TimeInMinFromPreviosContextCreation=Math.round(Li.b(wh.a.Ta,hb)/60));hb=xh.a.Kc(vb);fc.ULS.sendTraceTag(40416199,0,50,
hb);this.HHd.start();this.e$d=sc.sf.vr;this.Lx=new Sj.a;this.Eri(T);var Wc=this.eWd.N6i(!T,this.Lx?this.Lx.token:null);Wc.continueWith(function(){ra.IXg();var Zd=ra.eWd.b1i(Wc);ra.HHd.stop();var uf=ra.Fdc();if(!Zd||df.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&uf){var If=Wc.result.errors;Zd&&uf&&ra.JAg(If);ra.w3h(If,T)}else ra.Rdb=!1,ra.y3h(Wc.result.$O,T);ra.jlb=!1},this.h$b?8:0)}};Sa.prototype.JAg=function(T){var ra=[Object(We.a)(new Nb,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];
T.add(Object(We.a)(new kb,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:ra}))};Sa.prototype.Eri=function(T){T&&(this.$.ea.sf.vr?this.G5f():(this.$.ea.sf.Qra(this.iCd),this.AHb=!0))};Sa.prototype.G5f=function(){var T=this;this.Trc=oh.AsyncMethodContext.$u(function(){T.M6i()},1E3*this.NMf,Ec.a.t6i,this.Trc)};Sa.prototype.IXg=function(){this.Trc&&this.Trc.cancel();this.AHb&&(this.$.ea.sf.Pza(this.iCd),this.AHb=!1);this.Lx=null};Sa.prototype.M6i=function(){fc.ULS.sendTraceTag(537170706,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [{0}]",
this.NMf);this.Lx.C()};Sa.prototype.w3h=function(T,ra){this.Rdb=!0;ra&&(this.oH||(this.lmb=this.oH=!0),this.eWd.xhc(T)&&(this.E$d=!0));var hb=!ra||this.hdb&&!ki.a.qxc?40380379:39982555;ra=this.kDe(ra);ra.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";ra.FailedToRefreshExpiredToken=this.oH;ra.LastErrorIsPermanent=this.N5;if(0<T.count){var Eb=T.oa(0);ra.errorName=Eb.Name;0<Eb.Errors.length&&(ra.ErrorId=Eb.Errors[0].Id,Eb=Eb.Errors[0].Details,ra.ErrorDetails=this.Ygh(Eb.toString())?
"PiiScrubbed":Eb)}ra=xh.a.Kc(ra);fc.ULS.sendTraceTag(hb,0,15,ra);this.Pa.raiseEvent("TokenRefreshed",new Gb(null,T))};Sa.prototype.Ygh=function(T){return tg.a.contains(T,"makes the internet safe for businesses",!0)};Sa.prototype.kDe=function(T){var ra={},hb=this.$.ea;ra.Name="";ra.IsUserActive=hb.sf.vr;ra.IsSessionActive=hb.sc;ra.GotDeploymentOrTimedOutError=hb.Yaa;ra.TimeInSecFromLastStatefulSuccessfulRequest=hb.W7;ra.TimeFromLastUserActivityInMs=hb.sf.oeb;ra.calledFromSessionExpiredFlow=T;ra.RefreshTokenDurationInMS=
this.HHd.Bc;ra.numOfFailuresWhileUserIsActive=ki.a.j6;ra.numOfFailuresWhileUserIsInActive=ki.a.k6;ra.numOfFailuresWhileOffline=ki.a.gya;ra.RefreshAccessTokenCorrelationID=this.context.correlationID;ra.accessTokenTTL=Nc.AFrameworkApplication.uk;ra.ContainsChangesWorkbookOperations=this.$.userOperationManager.wHa();ra.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.Ai.toString():"Unknown";ra.TimeFromFirstOpenInHr=Math.floor(Li.b(wh.a.Ta,li.toUtc(hb.VEf))/3600);return ra};
Sa.prototype.y3h=function(T,ra){this.oH=!1;this.$Sj();this.Fdg(new Date,Nc.AFrameworkApplication.uk);var hb=this.$.ea,Eb=!ra&&hb.sf.vr,sc=!this.$.isEditMode&&hb.Lab;ra=this.kDe(ra);ra.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";ra.shouldTriggerSilentReloadAfterExpiring=Eb;ra.WopiTokenTaskItemPriority=Nc.AFrameworkApplication.H_d;ra.isDirtyViewSession=sc;ra=xh.a.Kc(ra);fc.ULS.sendTraceTag(39982556,0,15,ra);this.Pa.raiseEvent("TokenRefreshed",new Gb(T,null));sc?hb.sf.vr&&(fc.ULS.sendTraceTag(537170705,
0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),hb.Gbd()):hb.sf.vr?Eb&&(T=Wb.a(this.$).ud.activityState,T[ki.a.Heb]=!0,T[Ai.a.EY]=!0,T[Ri.a.Ss]=this.$.isEditMode,uh.a(this.$).wt(new Tg.a(Vh.a.qna,2,null))):hb.sc&&Vg.m(this.$.na.ua,!0,!1,!1,null,null,null,null,null)};Sa.prototype.$Sj=function(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=
oa.a.dU(this.$.ea.workbookContext.WorkbookUri,Nc.AFrameworkApplication.KP,Nc.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=oa.a.dU(this.$.ea.workbookContext.WorkbookUri,Nc.AFrameworkApplication.BY,Nc.AFrameworkApplication.uk.toString()),this.$.ea.Woc()):fc.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=Nc.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=Nc.AFrameworkApplication.uk;
void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=oa.a.dU(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,Nc.AFrameworkApplication.KP,Nc.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=oa.a.dU(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,Nc.AFrameworkApplication.BY,Nc.AFrameworkApplication.uk.toString()));
void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=oa.a.dU(this.$.ya.EmbedConfiguratorUrl,Nc.AFrameworkApplication.KP,Nc.AFrameworkApplication.accessToken),this.$.ya.EmbedConfiguratorUrl=oa.a.dU(this.$.ya.EmbedConfiguratorUrl,Nc.AFrameworkApplication.BY,Nc.AFrameworkApplication.uk.toString()));this.context.uHb=!0};Ek.Object.defineProperties(Sa.prototype,{tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.lmb}},Lba:{configurable:!0,
enumerable:!0,get:function(){return this.e$d}},N5:{configurable:!0,enumerable:!0,get:function(){return this.E$d}},context:{configurable:!0,enumerable:!0,get:function(){return this.mT}},hdb:{configurable:!0,enumerable:!0,get:function(){return this.N5?!1:this.$.ea.sf.vr?1>ki.a.j6:6>ki.a.k6}},JHd:{configurable:!0,enumerable:!0,get:function(){return this.jlb}}});Object(je.a)(Sa,"EwaAccessTokenExpirationRefreshManager",null,[934,312,3]);Ca.AYb="ActivityDuration";Ca.error="Error";Ca.Flh="Errors";Ca.failed=
"Failed";Ca.CBh="FirstActivity";Ca.initialized="Initialized";Ca.Ppi="LastActivity";Ca.Zgj="RetryOverride";Ca.Pej="RequestGroups";Ca.requests="Requests";Ca.$Sf="Responses";Ca.Jvc="SessionDuration";Ca.status="Status";Ca.success="Success";Ca.EMb="Successful";Ca.$O="Tokens";Object(je.a)(Ca,"SessionExpirationStrings",null,[]);fa.prototype.ugg=function(){var T={};fc.ULS.sendTraceTag(41964821,217,50,fc.ULS.Kc((T.Aggregate=this.YX,T.Current=this.Po,T)))};fa.prototype.hai=function(){this.YX[Ca.Pej]=0;this.YX[Ca.requests]=
0;this.YX[Ca.$Sf]=0;this.YX[Ca.status]=Ca.initialized;this.YX[Ca.CBh]=new Date;this.YX[Ca.Jvc]=0;this.YX[Ca.AYb]=0;this.YX[Ca.Jvc]=0;this.Po[Ca.Jvc]=0;this.YX[Ca.AYb]=0;this.Po[Ca.AYb]=0};fa.prototype.uld=function(T,ra){var hb=T[ra];hb=hb?hb:0;hb++;T[ra]=hb;this.VOd(T)};fa.prototype.VOd=function(T){var ra=new Date;T[Ca.AYb]=+ra-+this.bUb;this.bUb=ra;T[Ca.Jvc]=+this.bUb-+this.svg;T[Ca.Ppi]=this.bUb};fa.prototype.Ncb=function(T,ra){this.Po[T]=ra;this.VOd(this.Po)};fa.prototype.qYf=function(T,ra){this.Po[T]=
ra;this.VOd(this.Po)};fa.prototype.incrementCounter=function(T){this.uld(this.Po,T);this.uld(this.YX,T);this.uld(this.Ctg,T)};fa.prototype.flush=function(){this.$9d||(this.YX[Ca.status]=this.Po[Ca.status],this.ugg(this.oXb),this.se.Wma(this.oXb,6E4*this.Jlf))};fa.prototype.stop=function(){fc.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.$9d=!0;this.se.$p(this.oXb)};Object(je.a)(fa,"SessionLogger",null,[955]);var Pi=b(740),Ni=b(1143);ta.prototype.iMi=
function(T){if(T.MessageId!==uc.a.zkd)ke.a(39408099,306,15,"Unexpected message.");else{var ra=new ue.a,hb=new ue.a;this.mj.incrementCounter(Ca.$Sf);var Eb=T.Values[dc.a.wXf];if(!Eb||0>=Eb.length)ke.a(40122317,306,15,"Found no tokens in the dictionary"),Eb=T.Values;ke.a(40122318,306,100,"The Tokens array contains {0} tokens",Eb.length);this.mj.Ncb("Correlation",T.CorrelationId);for(var sc="",vb=0;vb<Eb.length;vb++){this.mj.qYf(Ca.$O,Eb.length);var Wc=Eb[vb],Zd=Wc;if(Zd&&Zd.Name){this.mj.incrementCounter(Zd.Name);
var uf=Wc;if(uf&&uf.Value)ke.a(39408128,306,100,"Received token with name: {0}",uf.Name),ra.add(uf),this.yXb.add(uf),this.mj.Ncb(Ca.status,Ca.success),this.R5d&&this.RT&&this.RT.Pfj();else if(Wc=this.IWh(Wc),ke.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Zd.Name,JSON.stringify(Wc),this.rga),hb.add(Wc),this.tT.add(Wc),sc=JSON.stringify(Wc),this.mj.Ncb(Ca.error,JSON.stringify(Wc)),this.mj.Ncb(Ca.status,Ca.failed),this.R5d)for(Zd=El(Wc.Errors),Wc=Zd.next();!Wc.done;Wc=
Zd.next())Wc=this.QNh(Wc.value),this.RT&&this.RT.YCg(Wc)}}0<hb.count&&""!==sc?(Eb=Object.assign(new vg.a,{extendedProperties:new Map}),Eb.extendedProperties.set("Errors",sc),rg.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Eb)):rg.Health.instance.recordKpiSuccess("WACTokenRefresh",null);ke.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ra.count,hb.count,T.CorrelationId,this.rga);0<hb.count&&!this.xhc(hb)?(T=
this.t9.dWh(hb),T!==this.t9.JLd&&(this.mj.qYf(Ca.Zgj,T),this.se.Wma(this.Wi,T))):(this.mj.flush(),this.Wi&&(ke.a(39408131,306,100,"Deleting task {0} from task manager",this.Wi.name),this.se.$p(this.Wi)),this.am&&!this.am.task.isCompleted&&this.am.setResult(new Gb(ra,hb)))}};ta.prototype.IWh=function(T){if(!T)return null;var ra=Object.assign(new kb,{Name:T.Name,Errors:[]});T=El(T.Errors);for(var hb=T.next();!hb.done;hb=T.next()){hb=hb.value;var Eb=new Nb;Eb.Id=hb.Id;Eb.Details=this.HWh(hb.Details);
ra.Errors.push(Eb)}return ra};ta.prototype.HWh=function(T){if(!T)return"";var ra=T.toLowerCase();return 0<ra.indexOf("<!doctype")?this.mgd("Seems to contain HTML - Contains <!DOCTYPE"):0<ra.indexOf("<html")?this.mgd("Seems to contain HTML - Contains <html>"):500<ra.length?this.mgd(String.format("Error details content too long: Length: {0}",ra.length)):T};ta.prototype.mgd=function(T){return String.format("{0} - Reason: [{1}]","### REDACTED ###",T)};ta.prototype.requestTokensOnce=function(){this.gSf()};
ta.prototype.gSf=function(){Nc.AFrameworkApplication.rkc("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.$qa>=this.t9.Tyi?(ke.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.rga),this.qDe(this.am,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(rg.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Plj())};ta.prototype.Plj=function(){var T={};T[dc.a.wXf]=
this.t9.$O;var ra=Zi.a.create().toString();ke.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.t9.$O),this.$qa+1,ra,this.rga);this.Nde.execute(function(hb){hb.Hj(uc.a.Xpe,T,ra)});this.$qa++;this.mj.incrementCounter(Ca.requests)};ta.prototype.qDe=function(T,ra,hb){for(var Eb=new ue.a,sc=0;sc<this.t9.$O.length;sc++){var vb=Object.assign(new kb,{Name:this.t9.$O[sc],Errors:[Object.assign(new Nb,{Id:ra,Details:hb})]});Eb.add(vb);this.tT.add(vb)}this.se.$p(this.Wi);
this.mj.Ncb(Ca.Flh,JSON.stringify(this.tT));this.mj.Ncb(Ca.status,Ca.failed);T&&!T.task.isCompleted&&T.setResult(new Gb(new ue.a,this.tT))};ta.prototype.N6i=function(T,ra){var hb=this;ra=void 0===ra?null:ra;this.mie.start();this.WTb=T;this.rga=Zi.a.create().toString();ke.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.rga,this.WTb);this.$qa=0;this.tT.clear();this.yXb.clear();var Eb=new lc.a;this.am=Eb;ra&&ra.R(function(){var sc=!!Eb&&!Eb.task.isCompleted;ke.a(588096223,
306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",hb.rga,hb.WTb,sc);sc&&hb.qDe(Eb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.Wi=new Td.a(this.t9.priority,2,this.t9.JLd,Object(pf.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,uc.a.Xpe,!0);this.mvg&&this.gSf();this.se.Sg(this.Wi);return this.am.task};ta.prototype.b1i=function(T){this.mie.stop();var ra=this.G4h(T.result.errors);fc.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!ra,this.rga,this.WTb,this.$qa,this.tT.count,0<T.result.errors.count?T.result.errors.oa(0).Name:"",0<T.result.errors.count&&0<T.result.errors.oa(0).Errors.length?T.result.errors.oa(0).Errors[0].Id:"",0<T.result.errors.count&&0<T.result.errors.oa(0).Errors.length?T.result.errors.oa(0).Errors[0].Details:"");return ra?!1:this.a1i(T.result.$O)};ta.prototype.xhc=function(T){return this.t9.xhc(T)};ta.prototype.a1i=function(T){for(var ra=0;ra<T.count;ra++){var hb=T.oa(ra);if(hb.Name===dc.a.accessToken){var Eb=
(new Date).getTime();if(hb.Expiry>Nc.AFrameworkApplication.uk){var sc={};fc.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",(sc.AccessTokenTtl=hb.Expiry,sc.NowGetTime=Eb,sc.BootTime=Nc.AFrameworkApplication.oha,sc),"PreviousAccessTokenTtl",Nc.AFrameworkApplication.uk);Nc.AFrameworkApplication.accessToken=hb.Value;Nc.AFrameworkApplication.uk=Math.floor(hb.Expiry);Nc.AFrameworkApplication.G_d=Eb;Nc.AFrameworkApplication.gYa=Math.floor(hb.Expiry)}else sc={},fc.ULS.sendTraceTag(39706828,
217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",(sc.AccessTokenTtl=hb.Expiry,sc.NowGetTime=Eb,sc.BootTime=Nc.AFrameworkApplication.oha,sc),"PreviousAccessTokenTtl",Nc.AFrameworkApplication.uk)}}return!0};ta.prototype.G4h=function(T){for(var ra=!1,hb=0;hb<T.count;hb++){ra=!0;var Eb=T.oa(hb);fc.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Eb.Name,JSON.stringify(Eb.Errors),this.rga)}return ra};ta.prototype.QNh=function(T){var ra=
Hh.a.Ivc;T=parseInt(T.Id);if(isNaN(T))ra=Hh.a.DWj;else{switch(T){case 401:ra=Hh.a.GWj;break;case 403:ra=Hh.a.BWj;break;case 500:ra=Hh.a.CWj;break;case 503:ra=Hh.a.FWj}ra===Hh.a.Ivc&&(ra=500<T?Hh.a.EWj:Hh.a.AWj)}return ra};Object(je.a)(ta,"TokenRefreshManager",null,[933]);va.prototype.xhc=function(T){T=JSON.stringify(T);if(this.jTc&&0<this.jTc.length)for(var ra=El(this.jTc),hb=ra.next();!hb.done;hb=ra.next())if(hb=hb.value,0<hb.length&&0<=T.indexOf(hb))return!0;return!1};va.prototype.dWh=function(T){try{if(T)for(var ra=
El(T),hb=ra.next();!hb.done;hb=ra.next()){var Eb=hb.value;if(Eb.Errors)for(var sc=El(Eb.Errors),vb=sc.next();!vb.done;vb=sc.next()){var Wc=vb.value;if(Wc.Id in this.$ee)return Number.parseInvariant(this.$ee[Wc.Id].toString())}}}catch(Zd){fc.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Zd.toString())}return this.JLd};va.prototype.xrj=function(){var T={};try{if(!Nc.AFrameworkApplication.Occ()||0>=Nc.AFrameworkApplication.Occ().length||""===Nc.AFrameworkApplication.Occ()[0])return T;
for(var ra=El(Nc.AFrameworkApplication.Occ()),hb=ra.next();!hb.done;hb=ra.next()){var Eb=hb.value;0<Eb.length&&(T[Eb]=Nc.AFrameworkApplication.IWj)}}catch(sc){fc.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",sc.toString())}return T};Object(je.a)(va,"TokenRefreshPolicy",null,[931]);var be=ac.a;Am(xa,be);xa.prototype.create=function(){Nc.AFrameworkApplication.tN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");
Nc.AFrameworkApplication.ga.ra("RefreshAccessTokenSilently")?this.Eb(this.T5g()):this.Eb(this.$.da.Aa(38)||this.$.da.Ga(38,new qa(this.$)))};xa.prototype.T5g=function(){var T=this.$.da.Aa(38);if(T)return T;T=new ta(Nc.AFrameworkApplication.Qi,Nc.AFrameworkApplication.HV(),new va);return this.$.da.Ga(38,new Sa(this.$,T))};xa.ka=function(T){T.da.Ga(39,new xa(T))};Object(je.a)(xa,"AccessTokenExpirationManagerFactory",ac.a,[]);var V=bg.a;Am(pa,V);pa.prototype.RGg=function(T){this.addHandler("TAF",T)};
pa.prototype.wcj=function(T){this.removeHandler("TAF",T)};pa.prototype.P2i=function(){this.raiseEvent("TAF")};Object(je.a)(pa,"GridHighlightBehaviorEventManager",bg.a,[930,3]);var Ga=ac.a;Am(ma,Ga);ma.prototype.create=function(){this.Eb(this.$.da.Aa(376)||new pa(this.$))};ma.ka=function(T){T.da.Ga(377,new ma(T))};Object(je.a)(ma,"GridHighlightBehaviorEventManagerFactory",ac.a,[]);var Bb=b(121),gc=Sys.EventArgs;Am(ka,gc);Object(je.a)(ka,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var dd=
bg.a;Am(W,dd);W.prototype.qFg=function(T){this.addHandler("mrek",T)};W.prototype.Iy=function(T,ra,hb){for(var Eb=El(this.gridView.yn),sc=Eb.next();!sc.done;sc=Eb.next())Oe.a.instance.pa(Df.a.vh,sc.value.domElement,T);Oe.a.instance.pa(Df.a.$d,document.documentElement,ra);this.gridView.wc.Q7b(!0);hb&&Oe.a.instance.pa(Df.a.Fy,this.gridView.Nj,ra)};W.prototype.PXd=function(T,ra,hb){for(var Eb=El(this.gridView.yn),sc=Eb.next();!sc.done;sc=Eb.next())Oe.a.instance.za(Df.a.vh,sc.value.domElement,T);Oe.a.instance.za(Df.a.$d,
document.documentElement,ra);this.gridView.wc.Q7b(!1);hb&&Oe.a.instance.za(Df.a.Fy,this.gridView.Nj,ra)};W.prototype.I7i=function(T,ra){for(var hb=El(this.gridView.yn),Eb=hb.next();!Eb.done;Eb=hb.next())Zg.a.instance.pa(Df.a.yg,Eb.value.domElement,T);Zg.a.instance.pa(Df.a.De,document.documentElement,ra)};W.prototype.wOj=function(T,ra){for(var hb=El(this.gridView.yn),Eb=hb.next();!Eb.done;Eb=hb.next())Zg.a.instance.za(Df.a.yg,Eb.value.domElement,T);Zg.a.instance.za(Df.a.De,document.documentElement,
ra)};W.prototype.mDe=function(T,ra,hb,Eb){var sc=document.createElement("div");sc.className=ra;ra=El(hb);for(hb=ra.next();!hb.done;hb=ra.next())sc.classList.add(hb.value);T.appendChild(sc);Oe.a.instance.pa(Df.a.pointerDown,sc,Eb);return sc};W.prototype.Q1e=function(T){T=T.Lb.parentNode;if(!T)return fc.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;T=parseInt(T.getAttribute(re.a.Wxb),10);return isNaN(T)?(fc.ULS.shipAssertTag(537159393,
0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.Cb.Hw(3,1,T)};W.prototype.IKb=function(T,ra,hb){T=(void 0===hb?!0:hb)&&!!this.coloredReferencesManager&&this.coloredReferencesManager.gji(T);ra=El(ra);for(hb=ra.next();!hb.done;hb=ra.next())se.DOMElementExtensions.setVisible(hb.value,T)};W.prototype.Lcd=function(){return this.gridView.Dj?Bb.a(this.gridView.$):this.gridView.rc};W.prototype.dMf=function(){var T=this.Lcd();
T&&this.coloredReferencesManager?this.coloredReferencesManager.IX(T,null):(fc.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Cb.Nh(this.Dof),this.gridView.Cb.wj(null,this.Dof))};W.prototype.oKf=function(T,ra){this.raiseEvent("mrek",new ka(T,ra))};Ek.Object.defineProperties(W.prototype,{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){var T=this.gridView.$.da.Aa(281);
T||fc.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return T}}});Object(je.a)(W,"BehaviorHelperMethods",bg.a,[]);var sd=ge.a;Am(Z,sd);Z.prototype.VYa=function(){};Object(je.a)(Z,"HighlightFlyweightBehavior",ge.a,[]);var ie=b(496),Ce=b(115),af=b(9),ff=b(71),fg=Uh.a;Am(R,fg);R.prototype.kne=function(T){this.addHandler("GrDrag",
T)};R.prototype.LPf=function(T){this.removeHandler("GrDrag",T)};R.prototype.jne=function(T){this.addHandler("GrContxt",T)};R.prototype.KPf=function(T){this.removeHandler("GrContxt",T)};R.prototype.lne=function(T){this.addHandler("GrPointerUp",T)};R.prototype.MPf=function(T){this.removeHandler("GrPointerUp",T)};R.prototype.dispose=function(){ye.a.Lma(this.domElement);fg.prototype.dispose.call(this)};R.prototype.$cg=function(T){this.domElement.parentNode.removeChild(this.domElement);T.appendChild(this.domElement)};
R.prototype.NXf=function(){this.domElement.classList.remove(ff.a.S8b);this.RKa.classList.remove(ff.a.R8b);this.RKa.classList.add(ff.a.yQe)};R.prototype.tbg=function(){this.RKa.classList.remove(ff.a.yQe);this.RKa.classList.add(ff.a.R8b);this.domElement.classList.add(ff.a.S8b)};R.prototype.U4h=function(T){return!!this.w5b&&(3<Math.abs(T.x-this.w5b.x)||3<Math.abs(T.y-this.w5b.y))};R.$ub=function(T){var ra=df.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),hb=Da.a.xf;return ra&&!hb?
(T=Sf.a(T.$)?Sf.a(T.$).zoom:af.a.V_,Math.round(9/Math.max(T,1))):9};R.Qvd=0;Object(je.a)(R,"TouchGrippie",Uh.a,[]);Am(J,Z);J.prototype.dispose=function(){Ne.a.zc([this.aP,this.rM]);this.aP.LPf(this.sDf);this.aP.KPf(this.snc);this.aP.MPf(this.tnc);this.rM.LPf(this.$tf);this.rM.KPf(this.snc);this.rM.MPf(this.tnc);for(var T=El(this.gridView.yn),ra=T.next();!ra.done;ra=T.next())ra=ra.value,Zg.a.instance.za(Df.a.Kf,ra.domElement,this.Lxf),Zg.a.instance.za(Df.a.De,ra.domElement,this.Kxf);this.gridView.view.Xq(this.Tw);
this.gridView.rc.fl(this.RJe);this.gridView.Cb.oIb(this.Gya);this.gridView.$Id(this.Otf);this.gridView.$.zD(this.orc);this.gridView.cx(this.orc);this.ha.$W(this.Kg);this.ha.f7(this.Dp);this.gridView.UF(this.Bp);this.ha.Hsc(this.Dxf);ce.a.UPf(this.zEb);this.yba&&fc.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(T=this.gridView.$.da.Aa(376))&&T.wcj(this.tDf);Z.prototype.dispose.call(this)};J.prototype.aSa=function(){if(!this.gba.range||!this.gba.range.equals(this.ocb))return!1;
var T=!this.gridView.DMa();return this.gridView.isEditing&&T&&(this.ocb.isRow||this.ocb.ef)?!1:this.yba?!0:3===ce.a.Ub};J.prototype.X4=function(){this.fob&&(this.aP.set_visible(!1),this.rM.set_visible(!1),this.fob=!1)};J.prototype.Qna=function(){if(this.aSa()){this.SRj();var T=se.DOMElementExtensions.getBoundingClientRect(this.zpb);T||fc.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.Lef,this.UWc,this.gridView.Nj,this.gridView.rb.dj);var ra=se.DOMElementExtensions.getBoundingClientRect(this.vlj),hb=new Sys.UI.Bounds(ra.x-T.x,ra.y-T.y,ra.width,ra.height),Eb=this.ocb,sc=Eb.topLeft,vb=Eb.bottomRight,Wc=Eb.isRow||Eb.ef;if(Eb.ef){var Zd=this.RAh();Eb=hb.x-2*R.$ub(this.gridView);var uf=Zd;var If=hb.x+ra.width}else Eb.isRow?(Eb=If=this.QAh(),uf=hb.y-2*R.$ub(this.gridView),Zd=hb.y+ra.height):(uf=hb.y,Zd=hb.y+ra.height,this.gridView.rtl?(Eb=
hb.x+ra.width,If=hb.x):(Eb=hb.x,If=hb.x+ra.width));ra=R.Qvd+(Wc?0:R.$ub(this.gridView));this.aP.style.left=Qg.HelperMethods.nc(Eb-ra);this.aP.style.top=Qg.HelperMethods.nc(uf-ra);this.rM.style.left=Qg.HelperMethods.nc(If-ra);this.rM.style.top=Qg.HelperMethods.nc(Zd-ra);this.aP.set_visible(this.ldf(uf,Eb,sc,Wc,T));this.rM.set_visible(this.ldf(Zd,If,vb,Wc,T));this.fob=!0}};J.prototype.ldf=function(T,ra,hb,Eb,sc){var vb=se.DOMElementExtensions.getBoundingClientRect(this.gridView.Tf(this.paneType).domElement);
sc=new Sys.UI.Bounds(vb.x-sc.x-3,vb.y-sc.y-3,vb.width+6,vb.height+6);return(this.gridView.rb.sj(hb)===this.paneType||Eb)&&fb.a.xB(sc,new Sys.UI.Point(ra,T))};J.prototype.SRj=function(){if(this.Lef!==this.UWc){this.zpb=null;var T=this.Dad();this.aP.$cg(T);this.rM.$cg(T)}};J.prototype.RAh=function(){return(this.gridView.view.visibleArea.height+this.gridView.rb.height+R.Qvd-R.$ub(this.gridView))/2};J.prototype.QAh=function(){return(this.gridView.view.visibleArea.width+this.gridView.rb.width+R.Qvd-R.$ub(this.gridView))/
2};J.prototype.IBf=function(){this.Qna()};J.prototype.Xgi=function(T){return se.DOMElementExtensions.dcb(T.Lb,da.a.$o)&&(this.aii(T)||this.bii(T))};J.prototype.bii=function(T){if(this.gridView.rtl)T=T.clientPoint.x;else{var ra=se.DOMElementExtensions.getBoundingClientRect(T.Lb);T=T.clientPoint.x-(ra.x+ra.width-Ce.a.xu)}return 0<T&&T<=Ce.a.xu};J.prototype.aii=function(T){var ra=se.DOMElementExtensions.getBoundingClientRect(T.Lb);T=T.clientPoint.y-(ra.y+ra.height-Ce.a.xu);return 0<T&&T<=Ce.a.xu};J.prototype.Mxf=
function(T,ra){this.yba&&fc.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.k_c(T,ra,this.yba);this.X4()};J.prototype.Vnj=function(){this.yba||(fc.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.yba=!0,this.aP.NXf(),this.rM.NXf(),this.gridView.ha.sourceRange=this.gridView.ha.sa.qd,this.Qna())};J.prototype.TXd=function(){this.yba&&(fc.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),
this.yba=!1,this.aP.tbg(),this.rM.tbg())};J.prototype.Dad=function(){this.zpb||(this.UWc=!1,this.zpb=this.gridView.Nj);return this.zpb};Ek.Object.defineProperties(J.prototype,{gridView:{configurable:!0,enumerable:!0,get:function(){return this.fr}}});Object(je.a)(J,"SelectionTouchGrippiesBehaviorBase",Z,[]);Am(D,J);D.prototype.aSa=function(){var T=this.gridView.Mi||this.gridView.isEditing;return!this.gridView.ha.sa.Ig&&!T&&J.prototype.aSa.call(this)};Ek.Object.defineProperties(D.prototype,{a5:{configurable:!0,
enumerable:!0,get:function(){return 19}},ocb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.sa.activeRange}}});Object(je.a)(D,"DiscontinuousSelectionTouchGrippiesBehavior",J,[]);var Ig=b(326);Am(F,Z);Object(je.a)(F,"SelectionBorderBehavior",Z,[]);aa.svh="ewr-selection-draghandle";aa.xvh="ewr-selection-draghandle-grab";aa.Ivh="ewr-selection-draghandle-top-ie";aa.Jvh="ewr-selection-draghandle-top-ie-enhanced";aa.Gvh="ewr-selection-draghandle-top";aa.Hvh="ewr-selection-draghandle-top-enhanced";
aa.vvh="ewr-selection-draghandle-bottom-ie";aa.wvh="ewr-selection-draghandle-bottom-ie-enhanced";aa.tvh="ewr-selection-draghandle-bottom";aa.uvh="ewr-selection-draghandle-bottom-enhanced";aa.Avh="ewr-selection-draghandle-left-ie";aa.Bvh="ewr-selection-draghandle-left-ie-enhanced";aa.yvh="ewr-selection-draghandle-left";aa.zvh="ewr-selection-draghandle-left-enhanced";aa.Evh="ewr-selection-draghandle-right-ie";aa.Fvh="ewr-selection-draghandle-right-ie-enhanced";aa.Cvh="ewr-selection-draghandle-right";
aa.Dvh="ewr-selection-draghandle-right-enhanced";aa.FQe="ewr-selection-dragtooltip";aa.GQe="ewr-selection-dragtooltip-updated";aa.Uvh="ewr_selection_rearrangeleft";aa.Vvh="ewr_selection_rearrangeright";aa.Wvh="ewr_selection_rearrangetop";aa.Tvh="ewr_selection_rearrangebottom";aa.selecting="selecting";aa.Xvh="ewr-selection-resizemarqueehandle";aa.$vh="ewr-selection-resizemarqueehandle-topleft";aa.awh="ewr-selection-resizemarqueehandle-topright";aa.Yvh="ewr-selection-resizemarqueehandle-bottomleft";
aa.Zvh="ewr-selection-resizemarqueehandle-bottomright";aa.ivh="ewr-marquee-thick";aa.mvh="ewr-resizemarqueehandle-thick";Object(je.a)(aa,"CssClassNames",null,[]);Am(U,F);U.prototype.dispose=function(){var T=this;this.cs.forEach(function(ra){Oe.a.instance.za(Df.a.pointerDown,ra,T.onPointerDown)});Array.clear(this.cs);this.yma=this.sourceRange=this.Jb=null;fc.ULS.sendTraceTag(537159381,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",this.Era,!this.$);
this.$&&(this.$.Sl(this.zd),1===this.Era&&(fc.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.$s(this.mke,this.nke,!1)));F.prototype.dispose.call(this)};U.prototype.Of=function(T){T=Sf.a(this.$).je(T);return this.sBd(T)};U.prototype.sBd=function(T){if(5!==this.pj)return!1;(T=this.Dya(T))||this.Itb(!1);qh.b(this.$,!1);return T};U.prototype.Sh=function(T){T=Sf.a(this.$).je(T);if(this.Xh&&this.foc(T))return!0;if(T=this.ha.Vn(T.clientPoint,
T.Lb,5,void 0,void 0,!0)){T=this.Aha(T);if(this.Jb.equals(T))return!0;this.Jb=T;if(!this.LD())return fc.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Itb(!0),!1}return!0};U.prototype.Iy=function(T,ra){fc.ULS.shipAssertTag(537159377,0,!this.Era,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.Era+=1;this.mke=T;this.nke=ra;this.ro.Iy(T,ra,this.KAc())};U.prototype.Aha=
function(T){if(!T||!this.Jb)return fc.ULS.shipAssertTag(537159376,0,!!T,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),fc.ULS.shipAssertTag(537159375,0,!!this.Jb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var ra=this.Jb.clone();1!==this.CE&&(ra.left=Math.max(T.left-this.mec,1),ra.right=ra.left+this.sourceRange.width-1);2!==this.CE&&(ra.top=Math.max(T.top-this.QCc,1),ra.bottom=ra.top+this.sourceRange.height-1);return this.WYa(ra)};
U.prototype.$s=function(T,ra,hb,Eb){hb=void 0===hb?!0:hb;Eb=void 0===Eb?!0:Eb;fc.ULS.shipAssertTag(537159374,0,1===this.Era,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.Era;this.Xh||Mf.g(this.$).rg.Mo(re.a.P4);this.ro.PXd(T,ra,this.KAc());hb&&this.bqb(Eb);this.CE=0;this.ISa=!1};U.prototype.WYa=function(T){var ra=Mf.g(this.$),hb=T;if(ra.rb.U4){if(!ra.kc(T.topLeft)){ra=ra.vk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ra.tH,this.yma.top!==T.top?
1:2);try{ra.al=this.yma.top<T.top||this.yma.left<T.left,ra.ps(T.topLeft),hb=ra.$$cu().range}finally{ra&&ra.dispose()}}hb.right=hb.left+T.width-1;hb.bottom=hb.top+T.height-1}return this.yma=hb};U.prototype.dwc=function(T){this.cs.forEach(function(ra){se.DOMElementExtensions.setVisible(ra,T)})};U.prototype.qSh=function(T){var ra=T.Lb;T=T.clientPoint;if(!ra||!T)return fc.ULS.shipAssertTag(537159373,0,!!ra,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),fc.ULS.shipAssertTag(537159372,
0,!!T,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;T.y+=ra===this.cs[U.FIa]?2:ra===this.cs[U.l7c]?-2:0;T.x+=ra===this.cs[U.m7c]?2:ra===this.cs[U.EIa]?-2:0;return this.ha.Vn(T,ra,5,void 0,void 0,!0)};Ek.Object.defineProperties(U.prototype,{Cb:{configurable:!0,enumerable:!0,get:function(){return Mf.g(this.$).Cb}},pj:{configurable:!0,enumerable:!0,get:function(){return this.ha.selectionType},set:function(T){this.ha.selectionType=T}}});U.g7c="move";U.L1a="grabbing";U.FIa=
0;U.l7c=1;U.m7c=2;U.EIa=3;Object(je.a)(U,"DragSelectionClickBehaviorBase",F,[]);Am(ca,U);ca.prototype.VYa=function(T){this.ro.IKb(T,this.cs);this.vy.Wza()};ca.prototype.doc=function(T){fc.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.zLa=!0;this.Ya.$G(!1);this.pj=5;this.vy.sJe(T.Lb);this.Ya.textBox.removeSelection();this.Ya.zZb(this.v5e);this.Iy(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,
"onPointerUp"));this.CE=this.sourceRange.isRow?1:this.sourceRange.ef?2:0};ca.prototype.Dya=function(){var T=this.qL();this.pj=-1;this.$s(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"));return T};ca.prototype.bqb=function(){this.gridView.zLa=!1;this.vy.tJe(this.cs[0]);this.Ya.textBox.setCaretPositionToEnd();this.Ya.Tsc(this.v5e);this.ro.dMf()};ca.prototype.Itb=function(T){fc.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");
T&&this.$s(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"))};ca.prototype.jcc=function(T){this.Ya=this.ro.Lcd();this.mL=this.ro.Q1e(T);return this.Ya&&this.mL&&this.mL.range?this.mL.range:(fc.ULS.shipAssertTag(537159388,0,!!this.Ya,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),fc.ULS.shipAssertTag(537159387,0,!!this.mL,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),fc.ULS.shipAssertTag(537159386,0,!!this.mL.range,
"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)};ca.prototype.qL=function(){return this.mL?this.coloredReferencesManager.lqf(this.Ya,this.mL,this.Jb):(fc.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)};ca.prototype.LD=function(){return this.qL()};ca.prototype.KAc=function(){return!0};ca.prototype.foc=function(){return!1};Object(je.a)(ca,
"DragMarqueeClickBehavior",U,[]);var ah=b(973),bh=b(918),me=b(119);Object(je.a)(P,"MacroRecorderTableRowColumnRearrangedPayload",null,[445]);Am(Q,U);Q.prototype.dispose=function(){this.ha&&(this.ha.f7(this.Dp),this.ha.$W(this.Kg),this.ha.DJd(this.VOa),this.ha.uI(this.kd));if(this.Uh)for(var T=1;4>=T;T++)se.DOMElementExtensions.Af(this.Uh[T.toString()]);this.Uh=this.Mh=null;this.hu&&this.Boa();this.Xh&&this.iu&&this.Boa(1);U.prototype.dispose.call(this)};Q.prototype.doc=function(T){this.Xh&&(this.Ww=
T,this.cA=null,this.Oq=this.isRow=this.ef=this.Pq=!1,lf.KeyInputManager.instance.pa(Df.a.Yb,this.domElement.ownerDocument.body,this.onKeyDown));this.hq=!0;this.tableRange=this.FZc(this.tableManager.rn(this.sourceRange.topLeft));Mf.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Xh?(this.cA=this.tableRange,this.Nn=1,this.Mh=(this.Oq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.pj=6,this.Iy(this.PK,this.QK),this.GM=
this.pia,this.GO=this.Lna,this.NB(T.clientPoint,T.Lb,this.Oq?11:12,!0,!0),this.HL(!0)):(this.Mh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.pj=6,this.Iy(this.PK,this.QK),this.NB(T.clientPoint,T.Lb,this.isRow?11:12,!0)):(this.tableRange=null,this.Xh?(this.isRow=this.sourceRange.isRow,this.ef=this.sourceRange.ef,this.isRow||this.ef?(this.Nn=3,this.CE=this.isRow?1:2,this.pj=6,this.Mh=this.isRow?[11]:[12],this.Iy(this.w6,this.x6),
this.GM=this.pia,this.GO=this.Lna,this.NB(T.clientPoint,T.Lb,this.isRow?11:12,!0,!0),this.HL(!0)):(this.Nn=2,this.CE=0,this.Iy(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp")),this.GM=this.Esb,this.GO=this.dLb,this.NB(T.clientPoint,T.Lb,this.pja(),!1,!0),this.LD(!0))):(this.Iy(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp")),lf.KeyInputManager.instance.pa(Df.a.Yb,this.domElement.ownerDocument.body,this.onKeyDown),this.CE=this.sourceRange.isRow?
1:this.sourceRange.ef?2:0,this.NB(T.clientPoint,T.Lb,this.pja(),!1),this.LD()))};Q.prototype.Dya=function(){this.hq=!1;this.Xh&&(this.Nn=0);this.Cb.Nh(this.mB());if(!this.$.Cq([this.Jb],!1))return this.$s(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp")),this.pj=-1,!0;if(this.ha.sa.qd.equals(this.Jb)||this.nka(this.Jb)||this.nka(this.sourceRange))this.pj=-1;else{this.qL();this.ha.sourceRange=this.sourceRange.clone();var T=this.ha.sourceRange,ra=this.ha.sa.qd;if(this.Xh){var hb=
{};this.$.Xd(-694765314,2,30,(hb[re.a.aua]=this.hu,hb[re.a.Y3]=T,hb[re.a.X3]=ra,hb[re.a.Bsb]=this.iu,hb))}else hb={},this.$.Xd(-694765314,2,30,(hb[re.a.aua]=this.hu,hb[re.a.Y3]=T,hb[re.a.X3]=ra,hb))}!this.Xh&&this.tableRange||this.$s(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"));return!0};Q.prototype.bqb=function(T){T&&(lf.KeyInputManager.instance.za(Df.a.Yb,this.domElement.ownerDocument.body,this.onKeyDown),this.Xh&&Mf.g(this.$).rg.Mo(re.a.P4),this.hq=!1);for(T=
1;4>=T;T++){var ra=this.Uh[T.toString()];ra&&ra.parentNode.removeChild(ra);this.Uh[T.toString()]=null}this.Mh=null};Q.prototype.foc=function(T){var ra=this.ha.Vn(T.clientPoint,T.Lb,5,void 0,void 0,!0);this.Ww=T;return this.Rwb(ra)?(this.Jb=this.r$(ra),this.Cwb(!0),!0):this.kjd(ra)?(this.Jb=this.Aha(ra),this.Dwb(!0),!0):!1};Q.prototype.Rwb=function(T){return!!this.cA&&1!==this.Nn&&!!T&&this.cA.contains(T.topLeft)};Q.prototype.kjd=function(T){return!!this.cA&&1===this.Nn&&!!T&&!this.cA.contains(T.topLeft)};
Q.prototype.Cwb=function(T){this.tableRange=this.cA;this.Nn=1;var ra=!this.iu;T?(this.cH(!1),this.Mh=this.Oq?[11]:[12],this.xHb(ra),this.HL(ra)):(this.k3(!1),this.c7(ra),this.LD(ra))};Q.prototype.Dwb=function(T){this.tableRange=null;this.Nn=2;var ra=!this.iu;T?(this.cH(!1),this.Mh=this.Oq?[11]:[12],this.Pq=this.Oq,this.fQa(ra),this.HL(ra)):(this.Osa(!1),this.c7(ra),this.LD(ra))};Q.prototype.jcc=function(){return this.ha.sa.qd};Q.prototype.qL=function(){this.ha.updateSelection(this.Jb,this.Jb.topLeft,
0);return!0};Q.prototype.LD=function(T){T=void 0===T?!1:T;this.Cb.wj(this.Jb,this.mB());this.Cb.Fn(this.mB());this.OB(T);return!0};Q.prototype.HL=function(T){T=void 0===T?!1:T;this.Cb.wj(this.Jb,this.Mh);this.Cb.Fn(this.Mh);this.OB(T)};Q.prototype.Itb=function(){fc.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")};Q.prototype.KAc=function(){return!1};Q.prototype.yxc=function(){if(!Mf.g(this.$).ha.sa.Ig)return!1;
var T=Mf.g(this.$).getRangeInformation(this.ha.sa.qd);T=El(T);for(var ra=T.next();!ra.done;ra=T.next())if(Object(Uf.a)(ni.PivotTableRange,ra.value))return!1;return!0};Q.prototype.FZc=function(T){if(T&&T.contains(this.sourceRange)&&!T.equals(this.sourceRange)){if(T.eba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===T.top){var ra=new Se.Range(this.sourceRange.top,this.sourceRange.left,T.bottom,this.sourceRange.right,!1,!1);if(!ra.equals(T))return this.sourceRange=ra,this.ha.updateSelection(this.sourceRange,
this.sourceRange.topLeft,0),T}this.Xh?this.Oq=T.left===this.sourceRange.left&&T.right===this.sourceRange.right:this.isRow=T.left===this.sourceRange.left&&T.right===this.sourceRange.right;if(T.top===this.sourceRange.top&&T.bottom===this.sourceRange.bottom||this.ry())return T}return null};Q.prototype.r$=function(T){var ra=T.clone();this.ry()?ra.left=Math.max(T.left-this.mec,1):ra.top=Math.max(T.top-this.QCc,1);ra.right=ra.left+this.sourceRange.width-1;ra.bottom=ra.top+this.sourceRange.height-1;return this.WYa(ra)};
Q.prototype.Fzb=function(){var T=this.Jb.topLeft.Hd(this.sourceRange);return T||this.Xh&&!this.tableRange?T:this.ry()?this.Jb.top===this.sourceRange.bottom+1:this.Jb.left===this.sourceRange.right+1};Q.prototype.cHd=function(){if(this.ry()&&this.Jb.left!==this.tableRange.left||!this.ry()&&this.Jb.top!==this.tableRange.top){var T=lh.a.gd(1,1,0,900,0,2065438552,"RearrangeInvalidDest");uh.a(this.$).Bs([T]);return!0}return!1};Q.prototype.HFd=function(){var T=this,ra=this.$.Ob.Gc("UserAction","RearrangeRowColumnClientSide"),
hb={},Eb=(hb.CopyPasteTargetType=1,hb.OperationId=Zi.a.create().toString(),hb.Stopwatch=ra,hb.DragDropIsShiftKeyDown=this.iu,hb.EncounteredDeploymentErrors=!1,hb),sc=this.hu?2:1,vb=this.$.da.Aa(254);(new Promise(function(Wc,Zd){T.Etb(function(uf){uf.Errors&&0<uf.Errors.length?Zd(new ah.a(22,uf.Errors)):Wc(!0)},function(uf){uf=me.a.pg(uf.data);Zd(new ah.a(22,uf))})})).then(function(){fc.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="{0}"',
1);vb&&vb.Zlf(Eb,sc,T.sourceRange,T.Jb);return Promise.resolve(!0)},function(Wc){fc.ULS.sendTraceTag(537159382,0,10,'DragSelectionClickBehavior.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',Wc?copyPasteInfra.getStringifiedError(Wc):"null",1);return vb?vb.RAf(Wc,Eb,sc,T.sourceRange,T.Jb):Promise.reject(Wc)})};Q.prototype.Etb=function(T,ra){function hb(){return new P(Wc,vb)}function Eb(Zd,uf,If){return L(sc.$.na.ua,Wc,vb,T?oe.b(Zd,T):Zd,ra?oe.a(uf,ra):uf,If,null)}var sc=this;T=void 0===T?null:
T;ra=void 0===ra?null:ra;var vb={};this.ry()?(vb.FirstRow=this.Jb.top-1,vb.FirstColumn=0,vb.DeltaColumn=0,vb.DeltaRow=this.Jb.bottom-this.Jb.top+1):(vb.FirstRow=0,vb.FirstColumn=this.Jb.left-1,vb.DeltaColumn=this.Jb.right-this.Jb.left+1,vb.DeltaRow=0);vb.LastRow=af.a.wy;vb.LastColumn=af.a.wv;vb.SheetName=this.$.xa.qa?this.$.xa.qa.name:this.$.Hb.getItemByName(this.$.Hb.qa.name).sheetName;var Wc=Ka.v(this.sourceRange,this.$);df.EwaSettings.qc()?this.$.userOperationManager.ic(new Ab.a(514,0,Eb,64,hb),
null):this.$.userOperationManager.ic(new rb.a(514,0,Eb,void 0,hb),null)};Q.prototype.nka=function(T){T=Mf.g(this.$).getRangeInformation(T);for(var ra=0,hb=T.length;ra<hb;++ra)if(Object(Uf.a)(ni.PivotTableRange,T[ra]))return T=lh.a.gd(1,0,0,895,0,2105176604,"InsDelCellsPivotTable"),uh.a(this.$).Bs([T]),!0;return!1};Q.prototype.NB=function(T,ra,hb,Eb,sc){sc=void 0===sc?!1:sc;var vb=se.DOMElementExtensions.getBoundingClientRect(ra),Wc=ra===this.cs[U.FIa]||ra===this.cs[U.l7c];if(this.Xh){var Zd=ra===
this.cs[U.m7c]||ra===this.cs[U.EIa];this.isRow&&Zd||this.ef&&Wc?Zd="100px":(Wc=this.isRow||Wc,Zd=(Wc?sc?Q.mWd:Q.sWd:sc?Q.lWd:Q.pWd)+"px");ra=Wc?ra===this.cs[U.FIa]?"top":"bottom":ra===this.cs[U.EIa]?"right":"left";T=100*(Wc?T.x-vb.x:T.y-vb.y)/(Wc?vb.width:vb.height);for(vb=1;4>=vb;vb++){Eb=document.createElement("div");var uf=document.createElement("div"),If=document.createElement("div");Eb.appendChild(uf);Eb.appendChild(If);sc&&(uf=document.createElement("div"),Eb.appendChild(uf),If.style.fontWeight=
"bold");Eb.className=aa.GQe;this.Uh[vb.toString()]=Eb;this.Cb.Hw(hb,vb).Nf.appendChild(Eb);Eb=this.Uh[vb.toString()];Eb.style[ra]=Zd;Eb.style[Wc?"left":"top"]=T+"%"}}else for(sc=(Wc?-Q.rWd:-Q.oWd)+"px",Zd=Wc?ra===this.cs[U.FIa]?"top":"bottom":ra===this.cs[U.EIa]||Eb?"right":"left",ra=100*(Wc?Eb?0:T.x-vb.x:T.y-vb.y)/(Wc?vb.width:vb.height),T=1;4>=T;T++)vb=document.createElement("div"),vb.className=aa.FQe,this.Uh[T.toString()]=vb,this.Cb.Hw(hb,T).Nf.appendChild(vb),vb=this.Uh[T.toString()],vb.style[Zd]=
sc,vb.style[Wc?"left":"top"]=ra+"%"};Q.prototype.OB=function(T){T=void 0===T?!1:T;var ra=this.Jb.toString();if(this.Xh)for(var hb=1;4>=hb;hb++)this.Uh[hb.toString()].childNodes[0].innerText=ra,this.Uh[hb.toString()].childNodes[1].innerText=this.GM,T&&(this.Uh[hb.toString()].childNodes[2].innerText=this.GO);else for(T=1;4>=T;T++)this.Uh[T.toString()].innerText=ra};Q.prototype.Boa=function(T){T=void 0===T?0:T;0===T?this.hu=!1:1===T&&(this.iu=!1);this.Xh&&(this.hu||this.iu)||(lf.KeyInputManager.instance.za(Df.a.Ud,
this.domElement.ownerDocument.body,this.onKeyUp),this.AMa=!1)};Q.prototype.cH=function(T){this.Cb.Nh(this.mB());this.$s(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"),void 0,T)};Q.prototype.k3=function(T){this.Cb.Nh(this.Mh);this.$s(this.w6,this.x6,void 0,T)};Q.prototype.Osa=function(T){this.Cb.Nh(this.Mh);this.$s(this.PK,this.QK,void 0,T)};Q.prototype.c7=function(T){T=void 0===T?!1:T;this.pj=5;this.Iy(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,
this.Of,"onPointerUp"));this.GM=this.Esb;this.GO=this.dLb;this.NB(this.Ww.clientPoint,this.Ww.Lb,this.pja(),!1,T)};Q.prototype.fQa=function(T){T=void 0===T?!1:T;this.pj=6;this.Iy(this.w6,this.x6);this.GM=this.pia;this.GO=this.Lna;this.NB(this.Ww.clientPoint,this.Ww.Lb,this.isRow||this.Oq?11:12,!0,T)};Q.prototype.xHb=function(T){T=void 0===T?!1:T;this.pj=6;this.Iy(this.PK,this.QK);this.GM=this.pia;this.GO=this.Lna;this.NB(this.Ww.clientPoint,this.Ww.Lb,this.ry()?11:12,!0,T)};Q.prototype.tka=function(T){return T.Ca.keyCode===
zd.a.m8||Da.a.isMac&&T.Ca.keyCode===zd.a.Joa};Q.prototype.ry=function(){return!this.Xh&&this.isRow||this.Xh&&this.Oq};Q.prototype.pja=function(){return this.Xh?45:6};Q.prototype.mB=function(){return this.Xh?Q.i7c:Q.n7c};Q.oWd=50;Q.rWd=25;Q.pWd=-85;Q.sWd=-40;Q.lWd=-120;Q.mWd=-50;Q.Xqb="copy";Q.n7c=[6];Q.i7c=[45];Object(je.a)(Q,"DragSelectionClickBehavior",U,[]);Am(M,U);M.prototype.dispose=function(){this.ha&&(this.ha.f7(this.Dp),this.ha.$W(this.Kg),this.ha.DJd(this.VOa),this.ha.uI(this.kd));if(this.Uh)for(var T=
1;4>=T;T++)se.DOMElementExtensions.Af(this.Uh[T.toString()]);this.Uh=this.Mh=null;U.prototype.dispose.call(this)};M.prototype.bqb=function(T){T&&(this.Xh&&Mf.g(this.$).rg.Mo(re.a.P4),this.hq=!1);for(T=1;4>=T;T++){var ra=this.Uh[T.toString()];ra&&ra.parentNode.removeChild(ra);this.Uh[T.toString()]=null}this.Mh=null};M.prototype.jcc=function(){return this.ha.sa.qd};M.prototype.qL=function(){this.ha.updateSelection(this.Jb,this.Jb.topLeft,0);return!0};M.prototype.LD=function(T){T=void 0===T?!1:T;this.Cb.wj(this.Jb,
this.mB());this.Cb.Fn(this.mB());this.OB(T);return!0};M.prototype.HL=function(T){T=void 0===T?!1:T;this.Cb.wj(this.Jb,this.Mh);this.Cb.Fn(this.Mh);this.OB(T)};M.prototype.Itb=function(){fc.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")};M.prototype.KAc=function(){return!1};M.prototype.NB=function(T,ra,hb,Eb,sc){sc=void 0===sc?!1:sc;var vb=se.DOMElementExtensions.getBoundingClientRect(ra),Wc=ra===this.cs[U.FIa]||
ra===this.cs[U.l7c];if(this.Xh){var Zd=ra===this.cs[U.m7c]||ra===this.cs[U.EIa];this.isRow&&Zd||this.ef&&Wc?Zd="100px":(Wc=this.isRow||Wc,Zd=(Wc?sc?M.mWd:M.sWd:sc?M.lWd:M.pWd)+"px");ra=Wc?ra===this.cs[U.FIa]?"top":"bottom":ra===this.cs[U.EIa]?"right":"left";T=100*(Wc?T.x-vb.x:T.y-vb.y)/(Wc?vb.width:vb.height);for(vb=1;4>=vb;vb++){Eb=document.createElement("div");var uf=document.createElement("div"),If=document.createElement("div");Eb.appendChild(uf);Eb.appendChild(If);sc&&(uf=document.createElement("div"),
Eb.appendChild(uf),If.style.fontWeight="bold");Eb.className=aa.GQe;this.Uh[vb.toString()]=Eb;this.Cb.Hw(hb,vb).Nf.appendChild(Eb);Eb=this.Uh[vb.toString()];Eb.style[ra]=Zd;Eb.style[Wc?"left":"top"]=T+"%"}}else for(sc=(Wc?-M.rWd:-M.oWd)+"px",Zd=Wc?ra===this.cs[U.FIa]?"top":"bottom":ra===this.cs[U.EIa]||Eb?"right":"left",ra=100*(Wc?Eb?0:T.x-vb.x:T.y-vb.y)/(Wc?vb.width:vb.height),T=1;4>=T;T++)vb=document.createElement("div"),vb.className=aa.FQe,this.Uh[T.toString()]=vb,this.Cb.Hw(hb,T).Nf.appendChild(vb),
vb=this.Uh[T.toString()],vb.style[Zd]=sc,vb.style[Wc?"left":"top"]=ra+"%"};M.prototype.Tcg=function(T,ra,hb){var Eb=Mf.g(this.$),sc=Eb.qg(T),vb=Eb.Tf(this.paneType);hb=bh.a.Es(vb.view.ti,this.domElement.parentNode,hb,Eb.rtl);vb=!1;var Wc=2;ra&&hb.y-sc.topLeft.y>sc.height/2?(vb=!0,Wc=1):!ra&&hb.x-sc.topLeft.x>sc.width/2&&(vb=!0);if(vb){ra=Eb.vk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",Eb.tH,Wc);try{ra.ps(T),ra.$$mn(),ra.$$cu()}finally{ra&&ra.dispose()}}};M.prototype.Osa=function(T){this.Cb.Nh(this.Mh);
this.$s(this.PK,this.QK,void 0,T)};M.prototype.pja=function(){return this.Xh?45:6};M.prototype.mB=function(){return this.Xh?M.i7c:M.n7c};M.oWd=50;M.rWd=25;M.pWd=-85;M.sWd=-40;M.lWd=-120;M.mWd=-50;M.n7c=[6];M.i7c=[45];Object(je.a)(M,"DragSelectionClickBehaviorTemporary",U,[]);Am(z,M);z.prototype.dispose=function(){this.hu&&this.Boa();this.Xh&&this.iu&&this.Boa(1);M.prototype.dispose.call(this)};z.prototype.doc=function(T){this.Xh&&(this.Ww=T,this.cA=null,this.Oq=this.isRow=this.ef=this.Pq=!1,lf.KeyInputManager.instance.pa(Df.a.Yb,
this.domElement.ownerDocument.body,this.onKeyDown));this.hq=!0;this.tableRange=this.FZc(this.tableManager.rn(this.sourceRange.topLeft));Mf.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Xh?(this.cA=this.tableRange,this.Nn=1,this.Mh=(this.Oq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.pj=6,this.Iy(this.PK,this.QK),this.GM=this.pia,this.GO=this.Lna,this.NB(T.clientPoint,T.Lb,this.Oq?11:12,!0,!0),this.HL(!0)):
(this.Mh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.pj=6,this.Iy(this.PK,this.QK),this.NB(T.clientPoint,T.Lb,this.isRow?11:12,!0)):(this.tableRange=null,this.Xh?(this.isRow=this.sourceRange.isRow,this.ef=this.sourceRange.ef,this.isRow||this.ef?(this.Nn=3,this.CE=this.isRow?1:2,this.pj=6,this.Mh=this.isRow?[11]:[12],this.Iy(this.w6,this.x6),this.GM=this.pia,this.GO=this.Lna,this.NB(T.clientPoint,T.Lb,this.isRow?11:12,!0,
!0),this.HL(!0)):(this.Nn=2,this.CE=0,this.Iy(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp")),this.GM=this.Esb,this.GO=this.dLb,this.NB(T.clientPoint,T.Lb,this.pja(),!1,!0),this.LD(!0))):(this.Iy(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp")),lf.KeyInputManager.instance.pa(Df.a.Yb,this.domElement.ownerDocument.body,this.onKeyDown),this.CE=this.sourceRange.isRow?1:this.sourceRange.ef?2:0,this.NB(T.clientPoint,T.Lb,this.pja(),
!1),this.LD()))};z.prototype.Dya=function(){this.hq=!1;this.Xh&&(this.Nn=0);this.Cb.Nh(this.mB());if(!this.$.Cq([this.Jb],!1))return this.$s(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp")),this.pj=-1,!0;if(this.ha.sa.qd.equals(this.Jb)||this.nka(this.Jb)||this.nka(this.sourceRange))this.pj=-1;else{this.qL();this.ha.sourceRange=this.sourceRange.clone();var T=this.ha.sourceRange,ra=this.ha.sa.qd;if(this.Xh){var hb={};this.$.Xd(-694765314,2,30,(hb[re.a.aua]=this.hu,
hb[re.a.Y3]=T,hb[re.a.X3]=ra,hb[re.a.Bsb]=this.iu,hb))}else hb={},this.$.Xd(-694765314,2,30,(hb[re.a.aua]=this.hu,hb[re.a.Y3]=T,hb[re.a.X3]=ra,hb))}!this.Xh&&this.tableRange||this.$s(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"));this.cud&&this.bud();return!0};z.prototype.bqb=function(T){T&&lf.KeyInputManager.instance.za(Df.a.Yb,this.domElement.ownerDocument.body,this.onKeyDown);M.prototype.bqb.call(this,T)};z.prototype.foc=function(T){var ra=this.ha.Vn(T.clientPoint,
T.Lb,5,void 0,void 0,!0);this.Ww=T;return this.Rwb(ra)?(this.Jb=this.r$(ra),this.Cwb(!0),!0):this.kjd(ra)?(this.Jb=this.Aha(ra),this.Dwb(!0),!0):!1};z.prototype.OB=function(T){T=void 0===T?!1:T;var ra=this.Jb.toString();if(this.Xh)for(var hb=1;4>=hb;hb++)this.Uh[hb.toString()].childNodes[0].innerText=ra,this.Uh[hb.toString()].childNodes[1].innerText=this.GM,T&&(this.Uh[hb.toString()].childNodes[2].innerText=this.GO);else for(T=1;4>=T;T++)this.Uh[T.toString()].innerText=ra};z.prototype.Rwb=function(T){return!!this.cA&&
1!==this.Nn&&!!T&&this.cA.contains(T.topLeft)};z.prototype.kjd=function(T){return!!this.cA&&1===this.Nn&&!!T&&!this.cA.contains(T.topLeft)};z.prototype.Cwb=function(T){this.tableRange=this.cA;this.Nn=1;var ra=!this.iu;T?(this.cH(!1),this.Mh=this.Oq?[11]:[12],this.xHb(ra),this.HL(ra)):(this.k3(!1),this.c7(ra),this.LD(ra))};z.prototype.Dwb=function(T){this.tableRange=null;this.Nn=2;var ra=!this.iu;T?(this.cH(!1),this.Mh=this.Oq?[11]:[12],this.Pq=this.Oq,this.fQa(ra),this.HL(ra)):(this.Osa(!1),this.c7(ra),
this.LD(ra))};z.prototype.yxc=function(){if(!Mf.g(this.$).ha.sa.Ig)return!1;var T=Mf.g(this.$).getRangeInformation(this.ha.sa.qd);T=El(T);for(var ra=T.next();!ra.done;ra=T.next())if(Object(Uf.a)(ni.PivotTableRange,ra.value))return!1;return!0};z.prototype.FZc=function(T){if(T&&T.contains(this.sourceRange)&&!T.equals(this.sourceRange)){if(T.eba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===T.top){var ra=new Se.Range(this.sourceRange.top,this.sourceRange.left,T.bottom,this.sourceRange.right,
!1,!1);if(!ra.equals(T))return this.sourceRange=ra,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),T}this.Xh?this.Oq=T.left===this.sourceRange.left&&T.right===this.sourceRange.right:this.isRow=T.left===this.sourceRange.left&&T.right===this.sourceRange.right;if(T.top===this.sourceRange.top&&T.bottom===this.sourceRange.bottom||this.ry())return T}return null};z.prototype.r$=function(T){var ra=T.clone();this.ry()?ra.left=Math.max(T.left-this.mec,1):ra.top=Math.max(T.top-this.QCc,
1);ra.right=ra.left+this.sourceRange.width-1;ra.bottom=ra.top+this.sourceRange.height-1;return this.WYa(ra)};z.prototype.Fzb=function(){var T=this.Jb.topLeft.Hd(this.sourceRange);return T||this.Xh&&!this.tableRange?T:this.ry()?this.Jb.top===this.sourceRange.bottom+1:this.Jb.left===this.sourceRange.right+1};z.prototype.cHd=function(){if(this.ry()&&this.Jb.left!==this.tableRange.left||!this.ry()&&this.Jb.top!==this.tableRange.top){var T=lh.a.gd(1,1,0,900,0,2065438552,"RearrangeInvalidDest");uh.a(this.$).Bs([T]);
return!0}return!1};z.prototype.HFd=function(){var T=this,ra=this.$.Ob.Gc("UserAction","RearrangeRowColumnClientSide"),hb={},Eb=(hb.CopyPasteTargetType=1,hb.OperationId=Zi.a.create().toString(),hb.Stopwatch=ra,hb.DragDropIsShiftKeyDown=this.iu,hb.EncounteredDeploymentErrors=!1,hb),sc=this.hu?2:1,vb=this.$.da.Aa(254);(new Promise(function(Wc,Zd){T.Etb(function(uf){uf.Errors&&0<uf.Errors.length?Zd(new ah.a(22,uf.Errors)):Wc(!0)},function(uf){uf=me.a.pg(uf.data);Zd(new ah.a(22,uf))})})).then(function(){fc.ULS.sendTraceTag(523638492,
0,50,'DragSelectionClickBehaviorTableRange.RearrangeRowColumn: success. copyPasteTargetType="{0}"',1);vb&&vb.Zlf(Eb,sc,T.sourceRange,T.Jb);return Promise.resolve(!0)},function(Wc){fc.ULS.sendTraceTag(523638491,0,10,'DragSelectionClickBehaviorTableRange.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',Wc?copyPasteInfra.getStringifiedError(Wc):"null",1);return vb?vb.RAf(Wc,Eb,sc,T.sourceRange,T.Jb):Promise.reject(Wc)})};z.prototype.Etb=function(T,ra){function hb(){return new P(Wc,vb)}function Eb(Zd,
uf,If){return L(sc.$.na.ua,Wc,vb,T?oe.b(Zd,T):Zd,ra?oe.a(uf,ra):uf,If,null)}var sc=this;T=void 0===T?null:T;ra=void 0===ra?null:ra;var vb={};this.ry()?(vb.FirstRow=this.Jb.top-1,vb.FirstColumn=0,vb.DeltaColumn=0,vb.DeltaRow=this.Jb.bottom-this.Jb.top+1):(vb.FirstRow=0,vb.FirstColumn=this.Jb.left-1,vb.DeltaColumn=this.Jb.right-this.Jb.left+1,vb.DeltaRow=0);vb.LastRow=af.a.wy;vb.LastColumn=af.a.wv;vb.SheetName=this.$.xa.qa?this.$.xa.qa.name:this.$.Hb.getItemByName(this.$.Hb.qa.name).sheetName;var Wc=
Ka.v(this.sourceRange,this.$);df.EwaSettings.qc()?this.$.userOperationManager.ic(new Ab.a(514,0,Eb,64,hb),null):this.$.userOperationManager.ic(new rb.a(514,0,Eb,void 0,hb),null)};z.prototype.nka=function(T){T=Mf.g(this.$).getRangeInformation(T);for(var ra=0,hb=T.length;ra<hb;++ra)if(Object(Uf.a)(ni.PivotTableRange,T[ra]))return T=lh.a.gd(1,0,0,895,0,2105176604,"InsDelCellsPivotTable"),uh.a(this.$).Bs([T]),!0;return!1};z.prototype.Boa=function(T){T=void 0===T?0:T;0===T?this.hu=!1:1===T&&(this.iu=!1);
this.Xh&&(this.hu||this.iu)||(lf.KeyInputManager.instance.za(Df.a.Ud,this.domElement.ownerDocument.body,this.onKeyUp),this.AMa=!1)};z.prototype.c7=function(T){T=void 0===T?!1:T;this.pj=5;this.Iy(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"));this.GM=this.Esb;this.GO=this.dLb;this.NB(this.Ww.clientPoint,this.Ww.Lb,this.pja(),!1,T)};z.prototype.fQa=function(T){T=void 0===T?!1:T;this.pj=6;this.Iy(this.w6,this.x6);this.GM=this.pia;this.GO=this.Lna;this.NB(this.Ww.clientPoint,
this.Ww.Lb,this.isRow||this.Oq?11:12,!0,T)};z.prototype.xHb=function(T){T=void 0===T?!1:T;this.pj=6;this.Iy(this.PK,this.QK);this.GM=this.pia;this.GO=this.Lna;this.NB(this.Ww.clientPoint,this.Ww.Lb,this.ry()?11:12,!0,T)};z.prototype.tka=function(T){return T.Ca.keyCode===zd.a.m8||Da.a.isMac&&T.Ca.keyCode===zd.a.Joa};z.prototype.ry=function(){return!this.Xh&&this.isRow||this.Xh&&this.Oq};z.prototype.cH=function(T){this.Cb.Nh(this.mB());this.$s(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,
this.Of,"onPointerUp"),void 0,T)};z.prototype.k3=function(T){this.Cb.Nh(this.Mh);this.$s(this.w6,this.x6,void 0,T)};z.prototype.bud=function(){var T=Rf.a.instance.lc("Common.ISystemInitiatedFeedback");T&&T.execute(function(ra){ra.logActivity("DragDrop",null)})};z.Xqb="copy";Object(je.a)(z,"DragSelectionClickBehaviorTableRange",M,[]);Am(B,M);B.prototype.doc=function(T){this.Ww=T;this.isRow=this.ef=!1;this.hq=!0;this.Fc=this.tableManager.uva(this.sourceRange);Mf.g(this.$);Mf.g(this.$).rg.Mo(U.L1a);
this.Yfi()&&(this.isRow=this.zli(),this.ef=this.Afi(),this.isRow||this.ef)&&(this.Mh=this.isRow?[11]:[12],this.pj=6,this.Iy(this.PK,this.QK),this.NB(T.clientPoint,T.Lb,this.isRow?11:12,!0,!1),this.Jb=this.r$(this.Jb),this.HL())};B.prototype.Dya=function(){return!1};B.prototype.foc=function(T){this.ha.Vn(T.clientPoint,T.Lb,5,void 0,void 0,!0);this.Ww=T;return!0};B.prototype.OB=function(){for(var T=1;4>=T;T++)this.Uh[T.toString()].childNodes[0].innerText=this.Jb.toString()};B.prototype.yxc=function(){if(!Mf.g(this.$).ha.sa.Ig)return!1;
var T=Mf.g(this.$).getRangeInformation(this.ha.sa.qd);T=El(T);for(var ra=T.next();!ra.done;ra=T.next())if(Object(Uf.a)(ni.PivotTableRange,ra.value))return!0;return!1};B.prototype.r$=function(T){T=T.clone();this.isRow?(T.left=this.sourceRange.left,T.right=this.Fc.right,T.bottom=T.top+this.sourceRange.height-1):this.ef&&(T.top=this.sourceRange.top,T.bottom=this.Fc.mX.bottom,T.right=T.left+this.sourceRange.width-1);return this.WYa(T)};B.prototype.Yfi=function(){return this.Jb.left>=this.Fc.mX.left&&
this.Jb.right<=this.Fc.AM.right&&this.Jb.top>=this.Fc.AM.top&&this.Jb.bottom<=this.Fc.mX.bottom};B.prototype.zli=function(){return this.Fc.mX.top<=this.Jb.top&&this.Fc.mX.left<=this.Jb.left&&this.Fc.mX.right>=this.Jb.left};B.prototype.Afi=function(){return this.Fc.AM.top==this.Jb.top&&this.Fc.AM.left<=this.Jb.left&&this.Fc.AM.right>=this.Jb.right};Object(je.a)(B,"DragSelectionClickBehaviorPivotTableRange",M,[]);Am(E,F);E.prototype.dispose=function(){Oe.a.instance.za(Df.a.pointerDown,this.yaa,this.onPointerDown);
$c.a.instance.za(Df.a.kk,this.yaa,this.tca);this.gridView.$&&(this.gridView.ha.f7(this.Dp),this.gridView.ha.$W(this.Kg),this.gridView.$.Sl(this.zd),this.gridView.$.zb.itc(this.C6),this.gridView.$.zb.htc(this.B6),this.gridView.uPf(this.$Db),this.gridView.wc.fl(this.Fxf),this.gridView.wc.Dn(this.Exf));F.prototype.dispose.call(this)};Object(je.a)(E,"FillHandleClickBehavior",F,[]);Am(y,Z);Ek.Object.defineProperties(y.prototype,{Fva:{configurable:!0,enumerable:!0,get:function(){return this.kpg}}});y.axe=
[1,2,32,256,128,64];Object(je.a)(y,"IPadSelectionClickThroughBehavior",Z,[]);t.prototype.dispose=function(){this.gridView.ha.f7(this.Dp);this.gridView.ha.$W(this.Kg);this.gridView.ha.DJd(this.Kg)};t.prototype.Wza=function(){this.p5a=0;this.Ogc=!1;this.P5=Number.NaN};t.prototype.C8e=function(T){this.GBc(T.Lb,1);return!0};t.prototype.D8e=function(T){this.GBc(T.Lb,-1);return!0};t.prototype.sJe=function(T){this.Ogc=!0;this.GBc(T,1)};t.prototype.tJe=function(T){this.Ogc=!1;this.GBc(T,-1)};t.prototype.GBc=
function(T,ra){if(T)if(T.parentNode)if(this.Xod)isNaN(this.P5)||(this.VBc(this.P5,!1),this.P5=Number.NaN);else if(T=parseInt(T.parentNode.getAttribute(re.a.Wxb),10),isNaN(T))fc.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.P5)&&T!==this.P5){if(this.Ogc)return;this.VBc(this.P5,!1)}if(isNaN(this.P5)||T!==this.P5)this.P5=T,this.p5a=0;!this.p5a&&0<ra&&this.VBc(T,!0);this.p5a=Math.max(this.p5a+ra,0);!this.p5a&&
0>ra&&(this.VBc(T,!1),this.P5=Number.NaN)}else fc.ULS.shipAssertTag(537159367,0,!!T.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else fc.ULS.shipAssertTag(537159368,0,!!T,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")};t.prototype.VBc=function(T,ra){for(var hb=1;4>=hb;hb++){var Eb=this.gridView.Cb.Hw(3,hb,T).Nf;se.DOMElementExtensions.toggleCssClass(Eb,aa.ivh,ra);for(Eb=Eb.firstChild;Eb;Eb=Eb.nextSibling)tg.a.contains(Eb.className,"resizemarqueehandle",
!0)&&se.DOMElementExtensions.toggleCssClass(Eb,aa.mvh,ra)}};Object(je.a)(t,"MarqueeHoveringManager",null,[]);var $e=b(1030),Kh=b(1315);Am(u,Z);u.prototype.dispose=function(){Oe.a.instance.za(Df.a.JW,this.jK,this.oAf);Oe.a.instance.za(Df.a.Fy,this.jK,this.yca);Oe.a.instance.za(Df.a.pointerDown,this.jK,this.onPointerDown);ee.a.instance.za(Df.a.click,this.jK,this.EEb);ee.a.instance.za(Df.a.kk,this.jK,this.onDoubleClick);se.DOMElementExtensions.Af(this.MH);this.MH=null;se.DOMElementExtensions.Af(this.jK);
this.rv=this.jK=null;Z.prototype.dispose.call(this)};u.prototype.VYa=function(T){this.rv=Object(ug.a)(Kh.a,T.metadata)};Object(je.a)(u,"RangeCatchUpActivityHighlightBehavior",Z,[]);Am(v,J);v.prototype.aSa=function(){return(this.gridView.inRangePicker||this.gridView.Mi)&&J.prototype.aSa.call(this)};Ek.Object.defineProperties(v.prototype,{a5:{configurable:!0,enumerable:!0,get:function(){return 16}},ocb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.rangePicker.Ocd(!1)}}});Object(je.a)(v,
"RangePickerTouchGrippiesBehavior",J,[]);Am(n,Z);Object(je.a)(n,"RearrangeHighlightBehavior",Z,[]);var Ph;(function(T){T[T.topLeft=0]="topLeft";T[T.topRight=1]="topRight";T[T.bottomLeft=2]="bottomLeft";T[T.bottomRight=3]="bottomRight";T[T.error=4]="error"})(Ph||(Ph={}));Object(je.b)("Corner",Ph);Am(w,Z);w.prototype.dispose=function(){var T=this;this.iL.forEach(function(ra){Oe.a.instance.za(Df.a.pointerDown,ra,T.onPointerDown)});Array.clear(this.iL);Z.prototype.dispose.call(this)};w.prototype.VYa=
function(T){this.gba=T;this.Eoe(T);this.ro.IKb(T,this.iL,this.pRd());this.vy.Wza()};w.prototype.Sh=function(T){T=Sf.a(this.$).je(T);T=this.J_e(T,!1);if(!T)return!0;T=this.YDe(T);if(!T)return fc.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.V9b(!0),!1;if(this.Jb.equals(T))return!0;this.Jb=T;T=this.LD();T||(fc.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.V9b(!0));return T};w.prototype.Of=
function(T){var ra=this;T=Sf.a(this.$).je(T);T=this.qL();fc.ULS.shipAssertTag(537159325,0,T,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");Da.a.uB&&(this.ha.zec(!0),window.setTimeout(function(){ra.ha.zec(!1)},100));this.V9b(!T);return T};w.prototype.J_e=function(T,ra){var hb=T.Lb;T=T.clientPoint;if(!hb||!T)return fc.ULS.shipAssertTag(537159324,0,!!hb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),fc.ULS.shipAssertTag(537159323,0,!!T,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),
null;ra&&(T=this.mqf(T));ra=this.ha.Vn(T,hb,0,!0,!1,!0);ra||(T=this.mqf(T),ra=this.ha.Vn(T,hb,0,!0,!1,!0));return ra};w.prototype.mqf=function(T){T.y+=0===this.C3||1===this.C3?2:-2;T.x+=0===this.C3||2===this.C3?2:-2;return T};w.prototype.YDe=function(T){if(!T||!this.sourceRange)return fc.ULS.shipAssertTag(537159322,0,!!T,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),fc.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),
null;if(0===this.C3)return new Se.Range(T.top,T.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.C3)return new Se.Range(T.top,this.sourceRange.left,this.sourceRange.bottom,T.right,!0,!1);if(2===this.C3)return new Se.Range(this.sourceRange.top,T.left,T.bottom,this.sourceRange.right,!0,!1);if(3===this.C3)return new Se.Range(this.sourceRange.top,this.sourceRange.left,T.bottom,T.right,!0,!1);fc.ULS.shipAssertTag(537159320,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",
Ph[this.C3]);return null};w.prototype.qL=function(){return this.coloredReferencesManager.lqf(this.Ya,this.mL,this.Jb)};w.prototype.LD=function(){return this.qL()};w.prototype.V9b=function(T){T&&fc.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.vy.tJe(this.iL[0]);this.ro.oKf(!1,this.gba.E$);this.Ya.textBox.setCaretPositionToEnd();this.Ya.Tsc(this.w5e);this.nbg();this.ISa=this.gridView.zLa=
!1;qh.b(this.$,!1);this.ro.dMf()};Object(je.a)(w,"ResizeMarqueeBehaviorBase",Z,[]);Am(h,w);h.prototype.KSf=function(){return[aa.$vh,aa.awh,aa.Yvh,aa.Zvh]};h.prototype.voe=function(){return[aa.Xvh]};h.prototype.ZYe=function(T){T=T.Lb;if(T===this.iL[0])return 0;if(T===this.iL[1])return 1;if(T===this.iL[2])return 2;if(T===this.iL[3])return 3;fc.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};h.prototype.FNf=function(){this.ro.Iy(Object(pf.a)(this,
this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"),!0)};h.prototype.nbg=function(){this.ro.PXd(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"),!0)};h.prototype.z1f=function(T){return 2===(ce.a.Ub=T.yb)&&T.Tn===Sys.UI.MouseButton.leftButton};h.prototype.pRd=function(){return!0};h.prototype.omf=function(){fc.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")};h.prototype.Eoe=
function(T){for(var ra=El(this.iL),hb=ra.next();!hb.done;hb=ra.next())hb.value.style.backgroundColor=T.Nf.style.borderColor};Object(je.a)(h,"ResizeMarqueeMouseBehavior",w,[]);Am(r,w);r.prototype.dispose=function(){ce.a.UPf(this.zEb);w.prototype.dispose.call(this)};r.prototype.KSf=function(){return[ff.a.avh,ff.a.$uh]};r.prototype.voe=function(){var T=df.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),ra=Da.a.xf;T=!T||ra;return[T?ff.a.xQe:ff.a.wQe,ff.a.S8b,T?ff.a.Zuh:ff.a.R8b]};r.prototype.ZYe=
function(T){T=T.Lb;if(T===this.iL[0])return 0;if(T===this.iL[1])return 3;fc.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};r.prototype.FNf=function(){Da.a.uv?this.ro.Iy(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"),!1):this.ro.I7i(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"))};r.prototype.nbg=function(){Da.a.uv?this.ro.PXd(Object(pf.a)(this,
this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"),!1):this.ro.wOj(Object(pf.a)(this,this.Sh,"onPointerMove"),Object(pf.a)(this,this.Of,"onPointerUp"))};r.prototype.z1f=function(T){return 3===(ce.a.Ub=T.yb)};r.prototype.pRd=function(){return 3===ce.a.Ub};r.prototype.omf=function(){fc.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")};r.prototype.Eoe=function(){};Object(je.a)(r,"ResizeMarqueeTouchBehavior",
w,[]);Am(m,Z);m.hrb=function(T,ra){var hb=document.createElement("div");hb.className=ra;T.appendChild(hb)};Object(je.a)(m,"SelectionCutCopyBehavior",Z,[]);Am(l,Z);Object(je.a)(l,"SelectionPasteBehavior",Z,[]);Am(f,Z);f.xrb=function(T,ra){var hb=document.createElement("div");hb.className=ra;T.appendChild(hb)};Object(je.a)(f,"SelectionRangePickerBehavior",Z,[]);Am(e,J);e.prototype.aSa=function(){var T=this.gridView.Mi||this.gridView.isEditing;return this.gridView.ha.sa.Ig&&!T&&J.prototype.aSa.call(this)};
Ek.Object.defineProperties(e.prototype,{a5:{configurable:!0,enumerable:!0,get:function(){return 0}},ocb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.sa.qd}}});Object(je.a)(e,"SelectionTouchGrippiesBehavior",J,[]);var Tf=ig.a;Am(c,Tf);c.prototype.dispose=function(){this.gridView.Cb.Maj(this.Aob);this.vy&&(this.vy.dispose(),this.vy=null);Tf.prototype.dispose.call(this)};Object(je.a)(c,"GridHighlightsBehaviorManager",ig.a,[]);var Qi=ac.a;Am(a,Qi);a.prototype.create=function(){var T=
this;Rc.TaskExtensions.Ba(cc.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ub),function(ra){T.Eb(T.$.da.Aa(64)||new c(T.$,ra.result))},this.la,3)};a.ka=function(T){T.da.Ga(149,new a(T))};Object(je.a)(a,"GridHighlightsBehaviorManagerFactory",ac.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");
Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.AccessibilitySettings");Be.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.NewAndOpen.Core");le.a.instance.hj(new Hd);Me.a.Ki('.ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ms-core-needIEFilter .ewr-selection-resizemarqueehandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}');
Me.a.Ki('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:-webkit-focus-ring-color auto 1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text{margin:1px}.tab-anchor-text:focus-visible{outline:-webkit-focus-ring-color auto 1px;margin:1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none;-ms-overflow-style:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-locked-sheet-svg{margin-right:4px !important;height:15px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
Me.a.Ki(".ewa-svg-icon{height:100%;width:100%}");Me.a.Ki(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}");
Dg.a.Fa(ae.ka);td.a.tl.Ga(141,new vd);Dg.a.Fa(pd.ka);(function(){Dg.a.Fa(function(T){ed.ka(T);df.EwaSettings.Fb()?Xc.ka(T):ne.ka(T);we.ka(T);Ud.ka(T)})})();Dg.a.Fa(Vb.ka);Dg.a.Fa(kd.ka);(function(){Dg.a.Fa(function(T){T.da.Ga(134,new Zb(T));T.da.Ga(330,new qb(T))})})();Dg.a.Fa(Cd.ka);(function(){Dg.a.Fa(function(T){Ha.ka(T);Qb.ka(T)})})();Type.registerNamespace("Common.App.SessionExpiration");Dg.a.Fa(xa.ka);Dg.a.Fa(a.ka);Dg.a.Fa(ma.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.acc.js.map/7a2627220300d00607fd3487e6539472/EwaDS.acc.js.map