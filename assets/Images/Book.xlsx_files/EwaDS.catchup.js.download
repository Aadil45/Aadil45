(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[24],{1187:function(x,C,b){function a(l,m){l=f.call(this,l,m)||this;m!==e.a.X9&&l.zFa(m);l.Iga(a.iterateNext);l.Iga(a.kxa);l.jUc(c.a.gUa);l.jUc(c.a.hUa);return l}b.d(C,"a",function(){return a});x=b(0);var c=b(168);C=b(1317);var e=b(971),f=C.a;Am(a,f);a.iterateNext="IterateNext";a.kxa="IteratePrevious";a.vNb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.$Oa=
"OnVHDiffReady";Object(x.a)(a,"VersionHistoryMessenger",C.a,[])},1320:function(x,C,b){function a(J,R,Z,W){var ka=this;this.authorColor=this.t2=this.Aea=null;this.l7a=!1;this.N9f=0;this.W0a=-1;this.V4c=0;this.nIa=100;this.Ska=-1;this.RZd=null;this.Oob=h.a.gVj;this.lGe=h.a.hVj;this.Th=function(ma){(ma=E.a(ma)?null:ma.Result)?ma.OperationWaitingForFileDownload?20>ka.V4c?(ka.nIa*=2,D.Task.delay(ka.nIa).continueWith(function(){ka.hXd()})):(ka.RBc(),e.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
ma.ActivityList?(ka.initialize(ma.ActivityList,ma.VersionAuthors),B.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?ka.$Oa():ka.Wxc(!0),ka.RZd.stop(),e.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",ka.RZd.Bc.toString())):(ka.RBc(),e.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(ka.nIa*=2,D.Task.delay(ka.nIa).continueWith(function(){ka.hXd()}),
e.ULS.sendTraceTag(537150408,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.Oya=function(){ka.RBc();e.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.Srd=function(ma){e.ULS.sendTraceTag(537150400,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",ma.MessageId);switch(ma.MessageId){case U.a.iterateNext:ka.iterateNext();ka.Ska=(ka.Ska+1)%ka.GS.length;ka.WJb(U.a.setCurrentChangeCount,
ka.Ska+1);break;case U.a.kxa:ka.kxa();ka.Ska=0>ka.Ska?0:ka.Ska;ka.Ska=(ka.Ska+ka.GS.length-1)%ka.GS.length;ka.WJb(U.a.setCurrentChangeCount,ka.Ska+1);break;case U.a.vNb:ka.Wxc(ma.Values.ToggleValue)}};this.e0g=function(ma,pa){return ka.p3b(ma.Im,pa.Im)};this.d0g=function(ma,pa){return ka.p3b(ma.Im,pa)};this.kd=function(){ka.o6b()};this.Bp=function(){ka.o6b()};this.gj=function(){ka.o6b()};e.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=J;this.ariaLiveNotifier=
W;this.gridView=L.g(this.$);this.gridView.ha.SG(this.kd);this.gridView.nE(this.Bp);this.gridView.rc.ml(this.gj);this.dRj();R&&(this.RZd=J.Ob.Gc("UserAction","VersionHistoryDiffManagerStopWatch"),this.hXd());if(this.ls=Z)J=f.a.Uaa(this.$.ya.VersionHistoryActionUrl)||F.a.X9,J!==F.a.X9&&this.ls.zFa(J),this.ls.io(U.a.iterateNext),this.ls.io(U.a.kxa),this.ls.io(U.a.vNb),this.ls.Rl(U.a.iterateNext,this.Srd),this.ls.Rl(U.a.kxa,this.Srd),this.ls.Rl(U.a.vNb,this.Srd)}function c(J,R,Z){this.wFa=J;this.Im=R;
this.zCc=Z}x=b(0);var e=b(14),f=b(80),l=b(1029),m=b(83),r=b(202),h=b(9),w=b(215),n=b(63),v=b(46),u=b(562),t=b(175),y=b(110),E=b(292),B=b(1),z=b(10),M=b(99),Q=b(15),P=b(291);b(105);var L=b(22),ca=b(354);Object(x.a)(c,"UserActivityLocation",null,[]);var U=b(1187),aa=b(84),F=b(971),D=b(55);b.d(C,"a",function(){return a});a.prototype.dispose=function(){this.Iza();this.Aea=this.t2=null;this.gridView&&(this.gridView.ha&&this.gridView.ha.WF(this.kd),this.gridView.UF(this.Bp),this.gridView.rc&&this.gridView.rc.fl(this.gj),
this.ls&&(this.ls.Aoa(U.a.kxa),this.ls.Aoa(U.a.iterateNext),this.ls.Aoa(U.a.vNb)))};a.prototype.initialize=function(J,R){J?(this.Iza(),this.W0a=-1,this.Aea=[],this.l7a=!1,this.t2={},this.authorColor={},this.Qxi(R),this.B4c(J)):e.ULS.shipAssertTag(537150410,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.hXd=function(){function J(Z,W,ka){var ma=R.$.na.ua;Z=P.b(Z,R.Th);W=P.a(W,R.Oya);var pa=ma.Na(1,null);return aa.i(ma,"GetVersionHistoryHighlightActivitiesData",
pa,Z,W,ka,null,4)}var R=this;e.ULS.sendTraceTag(537150409,0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.V4c.toString(),this.nIa.toString());this.V4c++;B.EwaSettings.qc()?this.$.userOperationManager.ic(new t.a(537,0,J,80),null):this.$.userOperationManager.ic(new u.a(537,0,J,16),null)};a.prototype.Wxc=function(J){var R=this.t2,Z;for(Z in R){var W=Z,ka=R[Z];ka?ka.LLb(J):e.ULS.shipAssertTag(537150404,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+
W+"view was Null")}};a.prototype.Iza=function(){var J=this.t2,R;for(R in J){var Z=R,W=J[R];W?W.R9i():e.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+Z+"view was Null")}this.Aea=this.t2=null};a.prototype.tWf=function(J){var R=this.VSh(J,this.W0a);var Z=R.E9e;J=R.keg;R.returnValue&&(e.ULS.shipAssertTag(537150402,0,!!J,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.o6b(),J.wFa.toString()in this.t2?(this.t2[J.wFa.toString()].llj(J.Im),
R=v.D(J.Im),this.ariaLiveNotifier.setEnabled(!1),this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(Q.a.instance.Ab(158),Z+1,this.GS.length,R.pB(!1),J.zCc.DisplayName)),this.W0a=Z):e.ULS.shipAssertTag(537150401,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",J.wFa.toString())))};a.prototype.WJb=function(J,R){if(B.EwaSettings.ma(320))if(this.ls){var Z={};Z.count=R;J=new l.a(J);J.Values=Z;this.ls.send(J)}else e.ULS.sendTraceTag(537150370,
0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");else e.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.VSh=function(J,R){var Z=!1;var W=null;for(var ka=0;!Z&&ka<this.GS.length;){R=J?this.MSh(R):this.yUh(R);W=this.GS[R];var ma=Object(m.a)(M.a,this.$.xa.getItemByName(W.Im.SheetName));if(!ma)return e.ULS.shipAssertTag(537150369,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),
{returnValue:!1,E9e:R,keg:W};ma.visible&&(Z=!0);ka++}return{returnValue:Z,E9e:R,keg:W}};a.prototype.MSh=function(J){return-1===J?this.V_e():(J+1)%this.GS.length};a.prototype.yUh=function(J){-1===J&&(J=this.V_e());return J=(J+this.GS.length-1)%this.GS.length};a.prototype.B4c=function(J){this.E$g(J);this.h4c()};a.prototype.$Zh=function(J,R){var Z=[];if(!J.RangeList)return e.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),
Z;J=El(J.RangeList);for(var W=J.next();!W.done;W=J.next())(W=W.value)&&this.$.xa.rj(W.SheetName)?(W=new c(0,W,R),Z.push(W)):e.ULS.shipAssertTag(537150367,0,!1," Inavlid sheet name"+W.SheetName);return Z};a.prototype.E$g=function(J){J=El(J);for(var R=J.next();!R.done;R=J.next())if(R=R.value,!R||y.e(R.LocationList))e.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(var Z=El(R.LocationList),W=Z.next();!W.done;W=Z.next())if(W=W.value)switch(W.Type){case 0:this.Aea.push.apply(this.Aea,Fl(this.$Zh(W,
R.Person)));break;default:e.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else e.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};a.prototype.h4c=function(){for(var J={},R=new r.a,Z=[],W=El(this.Aea),ka=W.next();!ka.done;ka=W.next())if(ka=ka.value,R.contains(ka.zCc)||R.add(ka.zCc),0===ka.wFa){var ma=new ca.a(v.D(ka.Im),n.d(this.$.xa.getItemByName(ka.Im.SheetName))),
pa=a.Wwc(ma);pa in J||Z.push(ma);J[pa]=this.PKh(ka.zCc)}e.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",this.Aea.length,Z.length,R.count,this.N9f);this.RBc();0<Z.length&&(J=new (b(1409).RangeVersionHistoryHighlightView)(this.$,Z,J,this.Oob),this.t2["0"]=J)};a.prototype.RBc=function(){var J=this.Aea?this.GS.length:0;this.WJb(U.a.setCurrentChangeCount,
0);this.WJb(U.a.setTotalChangesCount,J)};a.prototype.$Oa=function(){this.WJb(U.a.$Oa,0)};a.prototype.Qxi=function(J){if(J){this.N9f=J.length;for(var R=0;R<J.length;++R)if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&!J[R].InitialsColor)e.ULS.sendTraceTag(537150362,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var Z=J[R].EmailAddress;var W=J[R].UserName;var ka=null;if(J[R].LoginName){var ma=J[R].LoginName.split("|");
3===ma.length&&(ka=ma[2])}ka?this.authorColor[ka]=J[R].InitialsColor:Z?(e.ULS.sendTraceTag(537150361,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.authorColor[Z]=J[R].InitialsColor):W?(e.ULS.sendTraceTag(537150360,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),this.authorColor[W]=J[R].InitialsColor):e.ULS.sendTraceTag(537150359,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}}else e.ULS.sendTraceTag(537150363,
0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.dRj=function(){if(this.$.ya.VersionHistoryHighlightsSettings)for(var J=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):null,R=0;R<J.length;R++){var Z=J[R],W=Z.key?Z.key:Z.Key?Z.Key:"";Z=Z.value?Z.value:Z.Value?Z.Value:"";"DefaultColor"===W?this.lGe=
Z:"InitialTint"===W?this.Oob=Z:e.ULS.sendTraceTag(537150357,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}else e.ULS.sendTraceTag(537150358,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"))};a.prototype.PKh=function(J){if(J.Email in this.authorColor)return this.authorColor[J.Email];if(J.DisplayName in this.authorColor)return this.authorColor[J.DisplayName];e.ULS.sendTraceTag(537150356,
0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary"));return this.lGe};a.prototype.p3b=function(J,R){var Z=Object(m.a)(M.a,this.$.xa.getItemByName(J.SheetName)),W=Object(m.a)(M.a,this.$.xa.getItemByName(R.SheetName));return Z&&W?(Z=(Z=z.HelperMethods.cD(Z.index,W.index))||z.HelperMethods.cD(J.FirstRow,R.FirstRow))||z.HelperMethods.cD(J.FirstColumn,R.FirstColumn):(e.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),
0)};a.prototype.V_e=function(){var J=v.m(this.gridView.ha.sa.activeRange,this.$.xa.qa);if(!J)return e.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;J=z.HelperMethods.Jx(new w.a(this.GS),0,this.GS.length,J,this.d0g);0>J&&(J=~J);return J%this.GS.length};a.prototype.o6b=function(){if(this.QJb){if(!(this.QJb.wFa.toString()in this.t2)){e.ULS.shipAssertTag(537150353,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",
this.QJb.wFa.toString()));return}this.t2[this.QJb.wFa.toString()].mdh(this.QJb.Im)}this.W0a=-1};a.prototype.iterateNext=function(){this.tWf(!0)};a.prototype.kxa=function(){this.tWf(!1)};a.Wwc=function(J){return String.format("{0}{1}",J.range,J.sheetId)};Ek.Object.defineProperties(a.prototype,{Hfb:{configurable:!0,enumerable:!0,get:function(){return this.t2}},QJb:{configurable:!0,enumerable:!0,get:function(){return-1===this.W0a?null:this.GS[this.W0a]}},GS:{configurable:!0,enumerable:!0,get:function(){this.l7a||
(this.Aea.sort(this.e0g),this.l7a=!0);return this.Aea}}});Object(x.a)(a,"VersionHistoryHighlightManager",null,[543,3])},1409:function(x,C,b){function a(u,t,y,E){this.Rib=null;this.$=u;this.yvg=t;this.URa=y;this.VRa={};this.Oob=E;this.Iai()}function c(){}b.r(C);x=b(0);var e=b(14),f=b(9);c.nsh="ewa-vhr-rectinnerborder";Object(x.a)(c,"CssClassNames",null,[]);var l=b(63),m=b(46),r=b(229),h=b(105),w=b(22),n=b(354),v=b(1320);b.d(C,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.LLb=
function(u){u?this.Cb.Fn(this.NH):this.Cb.Nh(this.NH)};a.prototype.R9i=function(){this.LLb(!1);this.Cb.FKb(new n.a(null,l.d(this.$.qa)),this.NH)};a.prototype.llj=function(u){if(this.URa){var t=new n.a(m.D(u),l.d(this.$.xa.getItemByName(u.SheetName))),y=v.a.Wwc(t);if(y in this.URa)if(y in this.VRa){t=r.a.fp(this.URa[y]);y=this.VRa[y];for(var E in y)y[E].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",t.r,t.g,t.b,f.a.iVj);w.g(this.$).ha.Oa.jH(null);w.g(this.$).s4e(u,60,!0,h.a.a4i)}else e.ULS.sendTraceTag(537150426,
0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+y);else e.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+y)}else e.ULS.sendTraceTag(537150428,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};a.prototype.mdh=function(u){u=new n.a(m.D(u),l.d(this.$.xa.getItemByName(u.SheetName)));var t=v.a.Wwc(u);if(t in this.VRa)if(t in this.URa){u=r.a.fp(this.URa[t]);
t=this.VRa[t];for(var y in t)t[y].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",u.r,u.g,u.b,this.Oob)}else e.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+t);else e.ULS.sendTraceTag(537150425,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+t)};a.prototype.Iai=function(){var u=this;this.Cb.jx(this.yvg,[a.a5],!1,function(t,y){if(t&&t.range&&t.sheetId&&y){var E=
new n.a(t.range,t.sheetId);E=v.a.Wwc(E);E in u.VRa||(u.VRa[E]={});u.VRa[E][t.paneType.toString()]=y;E in u.URa?(t=u.URa[E],E=r.a.fp(t),y.style.borderColor=t,y.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",E.r,E.g,E.b,u.Oob),t=document.createElement("div"),t.className=c.nsh,y.appendChild(t)):e.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+E)}else e.ULS.shipAssertTag(537150423,0,!!t,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),
e.ULS.shipAssertTag(537150422,0,!t||!!t.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),e.ULS.shipAssertTag(537150421,0,!t||!!t.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),e.ULS.shipAssertTag(537150420,0,!!y,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};Ek.Object.defineProperties(a.prototype,{NH:{configurable:!0,enumerable:!0,get:function(){return[a.a5]}},Cb:{configurable:!0,enumerable:!0,get:function(){return this.Rib||
(this.Rib=w.g(this.$).Cb)}}});a.a5=23;Object(x.a)(a,"RangeVersionHistoryHighlightView",null,[558])},1447:function(x,C,b){function a(Fc){var jd=pg.call(this)||this;jd.$=Fc;jd.Tb();return jd}function c(Fc,jd,td,ue){var He=this;td=void 0===td?null:td;ue=void 0===ue?null:ue;this.UGa=null;this.n6e=!1;this.cEf=function(bf){He.B_a.Gnj();He.B_a.Wxc(!0);nf.a.Fh(bf.wywaActivities)||2===bf.wywaActivities[0].type||He.B_a.y6h(bf.wywaActivities[0])};this.$=Fc;this.B_a=new P(this.$);this.c3d=new Z(qb.AFrameworkApplication.Ib,
nd.EwaSettings.ma(457));Fc=Ee.a.CJj(Ye.a.instance.lc("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.dkf=ue;this.Pwe=new w(this.$,Fc,this.B6a());this.Owe=new Q(this.$,qb.AFrameworkApplication.Ib);this.emptyCatchUpBehaviorManager=new h(this.$);this.$ri(function(bf){He.xGi(bf)},jd);this.Xti();jd=null;td||(jd=Ye.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=td||new l(jd);this.flyoutFocus=new m(this.$,this.flyoutRibbonButton)}function e(){this.emptyCatchUpBehaviorManager=
this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}function f(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=
this.featuredActivityGroupsEnabled=null}function l(Fc){this.buttonClickedCallback=null;this.njb=this.dzb=!1;this.PCh=new Date;this.$Te=Fc}function m(Fc,jd){this.$=Fc;this.flyoutRibbonButton=void 0===jd?null:jd;jc.a(this.$).$h(this);this.hasFocus=!1}function r(Fc){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+Fc)}function h(Fc){this.$=Fc}function w(Fc,jd,td){td=void 0===td?!1:td;this.$=Fc;this.S1b=jd;this.ZFb=Ye.a.instance.resolve("Common.App.People.IPeopleColorUtils");
this.Rqc=Ye.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.B6a=td}function n(Fc,jd,td,ue,He,bf,Rf){Rf=Fc.Na(1,void 0===Rf?null:Rf);Rf.getRelevantActivitiesDataRequest=jd;return xd.i(Fc,"GetRelevantActivitiesData",Rf,td,ue,He,bf,0)}function v(Fc,jd,td,ue,He,bf){bf=Fc.Na(1,void 0===bf?null:bf);return xd.i(Fc,"GetLineageWywaAuthors",bf,jd,td,ue,He,4)}function u(){var Fc=z.call(this)||this;Fc.relationship=0;return Fc}function t(){this.color=this.imageUrl=this.email=this.givenName=
this.displayName=this.provider=this.id=null}function y(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function E(){this.activityFeedItems=null}function B(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}function z(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=
this.location=this.actors=null}function M(){}function Q(Fc,jd){this.$=Fc;this.Di=jd}function P(Fc){var jd=this;this.gRa=this.a4b=this.Vea=null;this.Z4={};this.nDa=null;this.kkd=!1;this.xEb=function(td,ue){switch(ue.state){case 0:case 1:3===ue.jFd&&(jd.Q5h(),jd.gRa=null);break;case 2:break;case 3:jd.i6c();jd.gRa=ue.activityId;jd.Cyj();break;default:ib.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+ue.state)}};this.xl=
function(){jd.gsb()};this.kd=function(){jd.gsb()};this.Bp=function(){jd.gsb()};this.gj=function(){jd.gsb()};this.t2f=function(td,ue){jd.Vea&&ue.MH!==jd.Xja&&(ue.isSticky&&jd.J6b(!0),(td=jd.vMj(ue.MH))?(jd.Vea.createActivityIndicatorTooltip(Object(Ob.a)(new U,{target:ue.MH,container:td,activityIds:[ue.activityId],isSticky:ue.isSticky,dirHint:jd.gridView.rtl?12:9})),ue.isSticky?(jd.Xja=ue.MH,ib.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):
(jd.gec=ue.MH,ib.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),jd.Bgc||(jd.gridView.view.Vs(jd.sBc),jd.gridView.Nt(jd.sBc),jd.Bgc=!0)):ib.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};this.eIe=function(td,ue){jd.J6b(ue.vfh)};this.sBc=function(){jd.Vea?(jd.Xja&&jd.Vea.updateActivityIndicatorTooltip(Object(Ob.a)(new L,{target:jd.Xja,
isSticky:!0})),jd.gec&&jd.Vea.updateActivityIndicatorTooltip(Object(Ob.a)(new L,{target:jd.Xja,isSticky:!1}))):ib.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};this.$=Fc;this.gridView=le.g(this.$);this.ha=this.gridView.ha;this.Ya=this.gridView.rc;this.ha.oZb(this.xl);this.ha.SG(this.kd);this.gridView.nE(this.Bp);this.Ya.ml(this.gj);this.Xja=this.gec=null;this.Bgc=!1;this.ebd={}}function L(){this.target=null;this.isSticky=
!1}function ca(){this.clearSticky=!1}function U(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function aa(){this.a2c=[];this.aLb={};this.wke={}}function F(Fc,jd,td,ue,He){Fc=D.call(this,Fc,jd,td,ue)||this;Fc.ranges=He;Fc.l7a=!1;return Fc}function D(Fc,jd,td,ue){var He=of.call(this)||this;He.$=Fc;He.s1d=jd;He.Pjg=td;He.jC=ue;He.state=0;return He}function J(Fc,jd,td){td=ze.call(this,Fc,jd,td)||this;td.gridView=le.g(Fc);td.Ema=jd;return td}function R(Fc){var jd=this;
this.xEb=function(){switch(jd.rv.model.state){case 1:jd.v3f(!0);break;case 0:jd.LLb(!1);break;case 2:case 3:jd.LLb(!0);break;default:ib.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+jd.rv.model.state)}};this.Dpg=Fc;this.rv.Lme(this.xEb);this.Cz=[]}function Z(Fc){this.Di=Fc}function W(Fc){return ge.call(this,Fc)||this}function ka(Fc,jd){this.$=Fc;this.catchUpActivityManager=jd}function ma(){this.tb=null}function pa(Fc){this.Ru=
Fc}function xa(Fc){this.qtg=Fc}function va(Fc){this.lga=Fc;this.zae=new Lc.a}function ta(Fc,jd,td){this.Mbe=Fc;this.ACa=jd;this.QCa=td}function fa(Fc,jd,td,ue,He,bf){Fc=Of.call(this,Fc,jd)||this;Fc.ItemIds=null;Fc.ActivityStatesToSet=0;Fc.ActivityStatesToReset=0;Fc.ResetUnseenCount=!1;Fc.ItemIds=td;Fc.ActivityStatesToSet=ue;Fc.ActivityStatesToReset=He;Fc.ResetUnseenCount=bf;return Fc}function Ca(Fc,jd){return Me.call(this,Fc,jd)||this}function Sa(Fc,jd){this.Mg=Fc;this.Ru=jd}function Gb(Fc){var jd=
rg.call(this)||this;jd.$=Fc;jd.Tb();return jd}function kb(Fc,jd){var td=this;this.iqd=!1;this.Hf=function(){td.r$f()};this.$=Fc;nd.EwaSettings.ma(618)&&this.$.ea.f8a&&!kb.axb&&(jd&&!jd.Ddb||this.ZUj(),kb.p6e?ib.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):jd&&!jd.Ddb||this.eVj());ib.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}function lb(Fc){var jd=Cf.call(this)||
this;jd.vi=null;jd.jh=null;jd.$=Fc;jd.Tb();return jd}function Nb(Fc,jd,td){var ue=Gg.call(this,Fc)||this;ue.te=null;ue.oze=null;ue.BEb=null;ue.Jpd=!0;ue.Cu=0;ue.Mp=!1;ue.Yc=function(He,bf){bf.Hg||ue.c1c()};ue.dk=function(){ue.c1c();return!0};ue.$=jd;ue.taskPaneManager=td;ue.$.Zk(ue.Yc);jc.a(ue.$).$h(ue);ud.a.Ld(ue.$)&&(ue.isVisible=!1);return ue}function Aa(Fc){var jd=oa.call(this)||this;jd.lineageTaskPane=null;jd.C7=null;jd.$=Fc;jd.Tb();return jd}function qa(Fc,jd,td,ue){var He=this;this.Otb=this.zF=
null;this.jE=this.ttd=0;this.BEb=function(){He.C7&&(He.C7.stop(),He.C7=null);He.BLb.start();He.zF.createLineagePane(He.otd,He.Otb)};this.lineageOpenPaneOrChangeFilterRequest=function(bf,Rf){function ig(hg,re,se){var wg=He.$.na.ua,Mf=df;hg=Nc.b(hg,He.kfd("LineageOpenPaneOrChangeFilter"));re=Nc.a(re,Vf);var zh=wg.Na(1,null);zh.clientParams=Qf;zh.lineageFilter=Mf;return xd.i(wg,"LineageOpenPaneOrChangeFilter",zh,hg,re,se,null,0)}function Vf(hg){hg=Mg.a.pg(hg.data);ib.ULS.sendTraceTag(537155481,0,50,
"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",ed.a.Wc(hg))}He.BLb.stop();ke.b(He.$).Vd(je.a.sNi,{});He.QAj();var Qf=Object(Ob.a)(new pb,{ClientViewCapacity:bf.clientViewCapacity}),df=null;Rf&&(df=Object(Ob.a)(new Tb,{FilterSheetMultiRange:He.kLj(Rf.filterSheetMultiRange)}));nd.EwaSettings.qc()?He.$.userOperationManager.ic(new Gf.a(1010,0,ig,80),null):He.$.userOperationManager.ic(new qg.a(1010,0,ig,16),null)};this.lineageLoadMoreRequest=function(bf){function Rf(Vf,
Qf,df){var hg=He.$.na.ua;Vf=Nc.b(Vf,He.kfd("LineageLoadMore"));Qf=Nc.a(Qf,ig);var re=hg.Na(1,null);re.fetchFromBelow=bf;return xd.i(hg,"LineageLoadMore",re,Vf,Qf,df,null,0)}function ig(Vf){Vf=Mg.a.pg(Vf.data);ib.ULS.sendTraceTag(537155480,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",ed.a.Wc(Vf))}ke.b(He.$).Vd(je.a.rNi,{});nd.EwaSettings.qc()?He.$.userOperationManager.ic(new Gf.a(1011,0,Rf,80),null):He.$.userOperationManager.ic(new qg.a(1011,0,Rf,16),null)};this.lineageRefreshViewRequest=
function(){function bf(ig,Vf,Qf){var df=He.$.na.ua;ig=Nc.b(ig,He.kfd("LineageRefreshView"));Vf=Nc.a(Vf,Rf);var hg=df.Na(1,null);return xd.i(df,"LineageRefreshView",hg,ig,Vf,Qf,null,0)}function Rf(ig){ig=Mg.a.pg(ig.data);ib.ULS.sendTraceTag(537155479,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",ed.a.Wc(ig))}ke.b(He.$).Vd(je.a.tNi,{});nd.EwaSettings.qc()?He.$.userOperationManager.ic(new Gf.a(1012,0,bf,80),null):He.$.userOperationManager.ic(new qg.a(1012,0,bf,16),null)};
this.lineageUpdateViewRequest=function(){tc(He.$.na.ua,function(bf){if(bf=lc.a(bf)?null:bf.Result){var Rf={};Rf=(Rf.CountOfUpdatedActivities=bf.LineageActivitiesResponse.ActivityList.length,Rf);ke.b(He.$).Vd(je.a.uNi,Rf);bf=Object(Ob.a)(new gb,{activityList:He.CFd(bf.LineageActivitiesResponse.ActivityList),latestActivityId:bf.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:bf.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:bf.LineageActivitiesResponse.LineageResponseCode,
lastSearchedActivityTimestamp:new Date(bf.LineageActivitiesResponse.EcmaLastSearchedDate),hasNewActivities:bf.HasNewActivities,filterSheetMultiRange:He.aLj(bf.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:bf.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:bf.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:bf.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:bf.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(bf.LineageActivitiesResponse.EolDateHideHistory),
eolPersonHideHistory:He.Xvb(bf.LineageActivitiesResponse.EolPersonHideHistory)});He.zF.onLineageActivitiesUpdateResponse(bf)}else ib.ULS.shipAssertTag(537155475,0,!!bf,"LineageManager.LineageUpdateView returned null response.")},function(bf){bf=Mg.a.pg(bf.data);ib.ULS.sendTraceTag(537155474,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",ed.a.Wc(bf))},null,null)};this.onCardSelected=function(bf,Rf){if(bf=bf.rangeHighlightLocation){if(Rf){var ig=pf.Z(Rf,null);var Vf=ig.range;
if(ig.returnValue){He.X7e(bf.sheetName,He.dwb([pf.j(Vf)]));return}ib.ULS.shipAssertTag(537155472,0,!1,"The produced subCellLocation string "+Rf+" is not valid.")}bf.rangeList.length?He.X7e(bf.sheetName,bf.rangeList):He.z6h(bf.sheetName)}};this.onLearnMoreLinkClicked=function(){if(nd.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var bf=new ne.a(-859308420,jg.a.Ub,He.$.ed,12,null),Rf={};Rf=(Rf[jg.a.Cg]="HelpID=XLO_LineageTS",Rf.InputMethod=jg.a.Ub,Rf[jg.a.ld]=de.a.NV,
Rf.ShouldCanvasTakeFocus=!0,Rf);He.$.Ka.Xb(bf,Rf)}};this.onVersionHistoryButtonClicked=function(bf){He.$.Ka.Xb(new ne.a(-1112508866,bf,He.$.ed,12,null))};this.isFeatureEnabled=function(){return!1};this.Hf=function(){var bf=He.$.ea.Qm.LineageVersion;bf!==He.ttd&&(ib.ULS.sendTraceTag(537155470,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",bf,He.ttd),He.ttd=bf,He.K6i())};this.od=function(bf,Rf){He.zF&&!He.lineageTaskPane.Ygc&&Rf.SH&&(ib.ULS.sendTraceTag(587220563,
0,15,"LineageManager::SessionIdChanged detected."),He.onStaleActivitiesDetected())};this.Io=function(){He.zF&&!He.lineageTaskPane.Ygc&&(ib.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),He.onStaleActivitiesDetected())};this.hD=function(){var bf=He.s4a();He.zF.onFilterableSheetListChange(bf)};this.Kya=function(){var bf=He.s4a();He.zF.onFilterableSheetListChange(bf)};this.Aoc=function(){var bf=He.s4a();He.zF.onFilterableSheetListChange(bf)};this.onPaneClosed=function(){He.zF.onPaneClosed();
wc(He.$.na.ua,null,function(bf){bf=Mg.a.pg(bf.data);ib.ULS.sendTraceTag(537155469,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",ed.a.Wc(bf))},null,null)};this.onRangeFilterInputEnabled=function(bf){bf?He.gridView.ha.OP(He.kd):He.gridView.ha.aX(He.kd)};this.kd=function(){var bf=pf.q(He.gridView.ha.sa.activeRange,He.$);bf=Object(Ob.a)(new Ra,{rangeList:He.dwb(bf.Ranges),sheetName:bf.SheetName});He.zF.onSelectedRangeUpdated(bf)};this.tryParseRangeInfo=function(bf){var Rf=
pf.Z(bf,He.$.xa);var ig=Rf.sheetName;bf=Rf.range;return Rf.returnValue?(ig||(ig=He.$.xa.qa.sheetName),Rf=[],Rf.push(bf),bf=pf.u(ig,null,Rf),Object(Ob.a)(new Ra,{rangeList:He.dwb(bf.Ranges),sheetName:bf.SheetName})):null};this.Rz=function(){var bf=He.jE!==He.$.ea.rf;He.zF&&He.lineageTaskPane.isVisible&&bf&&(He.jE=He.$.ea.rf,He.zF.onRefreshRequired())};this.$=Fc;jd.Ga(366,this);this.gridView=le.g(this.$);this.lineageTaskPane=td;this.otd=this.lineageTaskPane.DM();this.batchSize=50;this.C7=ue;this.BLb=
this.$.Ob.$g("UserAction","LineagePaneLoadingShimmerStopWatch");this.Rqc=Ye.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.fai();this.HAg()}function Xa(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}function Ha(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=
null;this.degradedCardTypeBits=0}function Ra(){this.sheetName=this.rangeList=null}function mb(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function La(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}function ha(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}function Ia(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=
this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}function gb(){var Fc=Sb.call(this)||this;Fc.hasNewActivities=!1;Fc.filterSheetMultiRange=null;return Fc}function Sb(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;
this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function wc(Fc,jd,td,ue,He,bf){bf=Fc.Na(1,void 0===bf?null:bf);return xd.i(Fc,"LineageClosePane",bf,jd,td,ue,He,0)}function tc(Fc,jd,td,ue,He,bf){bf=Fc.Na(1,void 0===bf?null:bf);return xd.i(Fc,"LineageUpdateView",bf,jd,td,ue,He,0)}function Tb(){}function pb(){}function cb(Fc){var jd=Yd.call(this)||this;jd.$=Fc;jd.Tb();return jd}function ob(Fc){this.Ddb=!0;ob.sbf()?ob.Abf()?(ib.ULS.sendTraceTag(526434368,0,50,"LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: {0}",
!Fc),this.Ddb=Fc):this.Ddb=!1:this.Ddb=!0}function rc(Fc){return Jc.call(this,Fc)||this}function Db(Fc,jd){this.$=Fc;this.lineageManager=jd;Fc=[new Be.a(Za.a.qtd,1038647878,0,0,2189),new Be.a(Za.a.idle,1038647878,0,1)];Hd.a(this.$).LHd(new eg.a(Za.a.ptd,Za.a.idle,Fc),new Ja(Za.a.qtd,Za.a.idle,jd))}function Ja(Fc,jd,td){Fc=Lf.call(this,Fc,jd)||this;Fc.lineageManager=td;return Fc}function Qb(Fc){var jd=Pe.call(this)||this;jd.$=Fc;jd.Tb();return jd}function yc(Fc){return Kf.call(this,Fc)||this}function Cd(Fc){var jd=
this;this.baseVersionInfo=this.G3=this.Noa=this.wm=this.ewaAccessibilityManager=this.PNb=null;this.gId=this.wrf=!1;this.wFe=!0;this.dialog=this.TB=this.QTe=this.BD=this.UZd=this.SZd=this.TZd=null;this.iBf=function(td){ib.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(jd.Lxj()){var ue=function(bf){Jb.c(2138207060,!1);jd.wm.setRestoreFailedAtServer(bf)};jd.BD&&jd.BD.startTimer(Cd.$8f);var He=function(){jd.BD.endTimer(Cd.$8f);jd.Iwe(jd.BD)};
jd.wm.setRestoreInProgress();Ub.a(jd.$).wt(new Hc.a(Za.a.wz,5,function(){var bf=Hd.a(jd.$).ud.activityState;bf[Bc.a.hr]=Za.a.yze;bf[$d.a.EY]=!0;bf[$d.a.aU]=0;bf[ba.gfg]=td;bf[ba.Zqc]=qb.AFrameworkApplication.oj;bf[ba.Jud]=He;bf[$a.O3f]=ue}))}else Jb.c(2138207060,!1)};this.KDf=function(td){jd.PNb.then(function(ue){ue.enterFocusTrapZone();return null});ib.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");jd.BD.endTimer(Cd.FVd);jd.BD.incrementCounter(Cd.C3g);ib.ULS.sendTraceTag(537150348,
0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",jd.BD.getTimerDuration(Cd.FVd));jd.efj(td.containerDiv);td.versions&&0<td.versions.length&&(jd.QTe=Cd.jF(td.versions[td.versions.length-1]));jd.G3&&jd.Noa&&jd.nNd(jd.G3);ib.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};this.onVersionSelected=function(td){ib.ULS.sendTraceTag(537150345,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",
Cd.jF(td.currentVersion),Cd.jF(jd.G3));jd.BD.incrementCounter(Cd.B3g);jd.G3=td.currentVersion;jd.baseVersionInfo=td.baseVersion;jd.wrf=td.noBaseToCompareTo;jd.Noa&&jd.DUj()&&(jd.nNd(td.currentVersion),ib.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.Pvf=function(td){ib.ULS.sendTraceTag(537150337,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",(null===td||void 0===td?0:td.versionSelected)?
Cd.jF(td.versionSelected.currentVersion):null,(null===td||void 0===td?0:td.updatedVersions)?td.updatedVersions.length:0,Cd.jF(jd.G3));jd.BD.incrementCounter(Cd.A3g);if(jd.baseVersionInfo){if((null===td||void 0===td?0:td.updatedVersions)&&2<=td.updatedVersions.length){var ue=null,He=null,bf=Cd.jF(jd.G3),Rf=Cd.jF(jd.baseVersionInfo);td=El(td.updatedVersions);for(var ig=td.next();!ig.done;ig=td.next()){ig=ig.value;var Vf=Cd.jF(ig);bf===Vf?ue=ig:Rf===Vf&&(He=ig);if(ue&&He)break}ue&&He?(jd.G3=ue,jd.baseVersionInfo=
He,ib.ULS.sendTraceTag(537150307,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Cd.jF(jd.G3),Cd.jF(jd.baseVersionInfo)),jd.nNd(jd.G3)):ib.ULS.sendTraceTag(537150306,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",bf,Rf)}else ib.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
ib.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else ib.ULS.sendTraceTag(537150336,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};this.Puf=function(){ib.ULS.sendTraceTag(537150303,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");jd.mZg();var td=new ne.a(1470556788,0,jd.$.ed,0,null);jd.$.Ka.Xb(td)};this.zBf=function(td){ib.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");
var ue=new ne.a(-1244760097,0,jd.$.ed,0,null);jd.$.Yf.get(51)&&(ib.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),ue=new ne.a(-309686558,0,jd.$.ed,0,null));Jb.c(1604651619,!0);var He={};jd.$.Ka.Xb(ue,(He.FileDownloadUrl=td,He))};this.Qvf=function(td){ib.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");td=new Ad.QueryStringBuilder(td);td.Xi("fn",qb.AFrameworkApplication.fileName);ib.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+
td.toString().length);8===jd.$.frame.Z8a(td.toString(),!0)?(ib.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),Jb.c(1316171850,!1)):Jb.c(1316171850,!0)};this.ttf=function(td){jd.wm.setFullAppErrorCode(td)};this.Zwf=function(td){switch(td){case 101:td="VHFailedToGetDownloadToken";break;case 100:td="VHFailedToLoadVersionList";break;case 104:td="VHVersioningNotEnabled";break;case 105:td="VHFileNotFound";break;case 106:td="VHVersionTooOld";break;default:td="None"}jd.BD.addEvent("OnFullAppError",
td);ib.ULS.sendTraceTag(537150291,0,10,"FullApp Error Event: {0}",td)};this.UBd=function(td){jd.wFe=td;ib.ULS.sendTraceTag(537150290,0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",td.toString());var ue={};jd.MNd(pd.a.vNb,(ue.ToggleValue=td,ue))};this.ryf=function(td){ib.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",td);Jb.c(1488635506,!0);var ue={};td?jd.MNd(pd.a.iterateNext,ue):jd.MNd(pd.a.kxa,ue)};this.jHb=function(td){switch(td.MessageId){case we.a.gUa:ib.ULS.sendTraceTag(537150289,
0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");nd.EwaSettings.ma(425)&&jd.wm.setVersionLoadComplete();break;case we.a.hUa:ib.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case pd.a.setCurrentChangeCount:td=td.Values.count;ib.ULS.sendTraceTag(537150288,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",td);jd.wm.setCurrentChangeCount(td);break;case pd.a.setTotalChangesCount:td=
td.Values.count;ib.ULS.sendTraceTag(537150287,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",td);jd.wm.setTotalChangesCount(td);break;case pd.a.$Oa:jd.UBd(jd.wFe);break;default:ib.ULS.sendTraceTag(537150286,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",td.MessageId)}};this.$=Fc;this.X8b=this.$.Mb+Cd.Wwh;this.fId=!1;nd.EwaSettings.ma(389)&&this.I$g();this.pBb="";this.Jsd=0;this.perfTelemetryInfos=[]}function bc(){this.perfTelemetryInfos=
this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function Kb(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=
this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}function ic(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=null}function wb(){this.rootDiv=this.appBootSettings=null}function Wa(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}function Xb(Fc){this.Vw=Fc}function Gc(Fc){this.Vw=Fc}function zb(Fc){this.Vw=Fc}function hc(){}function Uc(Fc,jd){this.$=Fc;this.lVj=jd}function jb(Fc,jd){var td=
kd.call(this)||this;td.activityName=Fc;td.EM=jd;td.Tb();return td}function $a(Fc,jd){return zc.call(this,Fc,jd)||this}function I(Fc,jd,td){var ue=vc.call(this)||this;ue.activityName=Fc;ue.EM=jd;ue.VJ=td;ue.Tb();return ue}function ba(Fc,jd,td,ue,He){var bf=ub.call(this,Fc,jd)||this;bf.xi=null;bf.retryCount=0;bf.bQi=function(Rf){var ig=bf.xMj(Rf);Rf=ig.wLd;ig.returnValue?Rf.Success?(Jb.c(2138207060,!0),ib.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):
(Jb.c(2138207060,!1),ib.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",Rf.Output),bf.zh(bf.VJ)):(Jb.c(2138207060,!1),bf.zh(bf.VJ));(Rf=bf.xi.activityState[ba.Jud])&&Rf();bf.Ap();bf.xi.IJ()};bf.aQi=function(){if(0<bf.retryCount)ib.ULS.sendTraceTag(537150418,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",bf.retryCount),bf.retryCount--,bf.jTf();else{ib.ULS.sendTraceTag(42287320,
0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");Jb.c(2138207060,!1);bf.zh(bf.VJ);var Rf=bf.xi.activityState[ba.Jud];Rf&&Rf();bf.Ap();bf.xi.IJ()}};bf.VJ=td;bf.l3=ue;bf.baseUrl=He;return bf}b.r(C);var sa=b(11),Oa=b(0),qb=b(4),Qa=b(228),ib=b(14),Mb=b(113),Jb=b(187),Zb=b(41),ub=Mb.a;Am(ba,ub);ba.prototype.execute=function(Fc){this.xi=Fc;this.retryCount=3;this.jTf();return 1};ba.prototype.jTf=function(){var Fc=this.xi.activityState[ba.Zqc],jd=this.xi.activityState[ba.gfg],
td=String.format("{0}{1}",this.baseUrl,"restoreversion.ashx");Fc=Zb.c({VersionId:jd,QuerySignature:Fc});this.l3.El(td,2,Fc,{"Content-Type":"application/json; charset=utf-8"},!1,2,this.bQi,this.aQi,null)};ba.prototype.xMj=function(Fc){var jd=null;Fc=Fc?Fc.data?Fc.data.ke:null:null;if(!Fc||!Fc.length)return ib.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,wLd:jd};Fc=Zb.d(Fc);jd=Fc.dv;return Fc.returnValue?
{returnValue:!0,wLd:jd}:(ib.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),{returnValue:!1,wLd:jd})};ba.gfg="RVAvi";ba.Zqc="RVAqs";ba.Jud="RVlvrt";Object(Oa.a)(ba,"RestoreVersionActivity",Mb.a,[]);var Za=b(6),vc=Qa.a;Am(I,vc);I.prototype.create=function(){this.Eb(new ba(this.activityName,this.EM,this.VJ,qb.AFrameworkApplication.Jd,qb.AFrameworkApplication.ta.Qa.sW))};I.ka=function(Fc){Fc.da.Ga(320,new I(Za.a.zLd,
Za.a.vj,Za.a.ALd))};Object(Oa.a)(I,"RestoreVersionActivityFactory",Qa.a,[]);var zc=Mb.a;Am($a,zc);$a.prototype.execute=function(Fc){var jd=this;(0,Fc.activityState[$a.O3f])(function(){jd.Ap();Fc.IJ()});return 1};$a.O3f="RVEAssea";Object(Oa.a)($a,"RestoreVersionErrorActivity",Mb.a,[]);var kd=Qa.a;Am(jb,kd);jb.prototype.create=function(){this.Eb(new $a(this.activityName,this.EM))};jb.ka=function(Fc){Fc.da.Ga(321,new jb(Za.a.ALd,Za.a.vj))};Object(Oa.a)(jb,"RestoreVersionErrorActivityFactory",Qa.a,[]);
var wa=b(80),Na=b(906),Vb=b(51),pc=b(36),hd=b(186),Ud=b(389),Zc=b(55);Uc.prototype.Zc=function(){return qb.AFrameworkApplication.ga.ra("IsAnonymousUser")?(ib.ULS.sendTraceTag(537150415,0,15,"Verison History Command Handler: Anonymous user."),!0):!1};Uc.prototype.executeCommand=function(Fc,jd){ib.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");Fc=!1;switch(jd.command){case -1112508866:Ud.a(this.$)&&this.$.da.Aa(423).Xxc(!1),Fc=this.lVj.aBj()}ib.ULS.sendTraceTag(537150413,
0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",Fc);return Fc?Zc.Task.Sa(Fc):hd.a(jd.command)};Uc.prototype.Lc=function(Fc,jd){return-1112508866===jd.command&&this.$.isVersionHistoryEnabled()};Uc.prototype.jd=function(){return!1};Object(Oa.a)(Uc,"VersionHistoryCommandHandler",null,[429]);var Ob=b(7),Ad=b(260),we=b(168),Wd=b(409),qc=b(24);hc.addAppPLTEventToLog=function(Fc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Fc)}catch(jd){}};hc.setIsPageLoadForFirstTime=
function(Fc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Fc)}catch(jd){}};Object(Oa.a)(hc,"VersionHistoryLogConnector",null,[]);var md=b(1029),bd=b(1317),Xc=b(158),ne=b(95),ed=b(30),nd=b(1),Ub=b(43),Hc=b(258),pd=b(1187),jc=b(271),vd=b(254),ae=b(12);zb.prototype.$h=function(){jc.a(this.Vw.$).YM(this.we)||jc.a(this.Vw.$).$h(this)};zb.prototype.f8=function(){jc.a(this.Vw.$).YM(this.we)&&jc.a(this.Vw.$).Vz(this)};zb.prototype.ph=function(Fc){return ae.DOMElementExtensions.Ff(this.uc,
Fc)};zb.prototype.Cj=function(){this.Vw.$.frame.Re.fk(this.Vw.$.frame.Re.WE)};zb.prototype.Rj=function(){};zb.prototype.Wf=function(Fc,jd){jd||this.Vw.PNb.then(function(td){td.enterHeaderFocusTrapZone();return null});return!jd};Ek.Object.defineProperties(zb.prototype,{we:{configurable:!0,enumerable:!0,get:function(){return vd.a.dfg}},uc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});
Object(Oa.a)(zb,"VersionHistoryHeader",null,[444]);Gc.prototype.$h=function(){jc.a(this.Vw.$).YM(this.we)||jc.a(this.Vw.$).$h(this)};Gc.prototype.f8=function(){jc.a(this.Vw.$).YM(this.we)&&jc.a(this.Vw.$).Vz(this)};Gc.prototype.ph=function(Fc){return ae.DOMElementExtensions.Ff(this.uc,Fc)};Gc.prototype.Cj=function(){this.Vw.$.frame.Re.fk(this.Vw.$.frame.Re.WE)};Gc.prototype.Rj=function(){};Gc.prototype.Wf=function(Fc,jd){jd||this.Vw.PNb.then(function(td){td.enterFocusTrapZone();return null});return!jd};
Ek.Object.defineProperties(Gc.prototype,{we:{configurable:!0,enumerable:!0,get:function(){return vd.a.efg}},uc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Oa.a)(Gc,"VersionHistoryPane",null,[444]);Xb.prototype.$h=function(){jc.a(this.Vw.$).YM(this.we)||jc.a(this.Vw.$).$h(this)};Xb.prototype.f8=function(){jc.a(this.Vw.$).YM(this.we)&&jc.a(this.Vw.$).Vz(this)};
Xb.prototype.ph=function(Fc){return ae.DOMElementExtensions.Ff(this.uc,Fc)};Xb.prototype.Cj=function(){this.Vw.$.frame.Re.fk(this.Vw.$.frame.Re.WE)};Xb.prototype.Rj=function(){};Xb.prototype.Wf=function(Fc,jd){jd||this.Vw.PNb.then(function(td){td.enterViewerFocusTrapZone();return null});return!jd};Ek.Object.defineProperties(Xb.prototype,{we:{configurable:!0,enumerable:!0,get:function(){return vd.a.ffg}},uc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Oa.a)(Xb,"VersionHistoryViewer",null,[444]);var $d=b(145),Bc=b(261),Hd=b(66),xb=b(443),rd=b(971);Object(Oa.a)(Wa,"AppBootSettings",null,[]);Object(Oa.a)(wb,"AppVersionControllerFactoryParameters",null,[]);Object(Oa.a)(ic,"OnVersionSelectedParams",null,[]);Object(Oa.a)(Kb,"AppSettings",null,[]);Object(Oa.a)(bc,"ControllerFactoryParameters",null,[]);Cd.prototype.dispose=function(){this.mye()};Cd.prototype.VYi=function(){var Fc=
this;this.$.da.$a(15,function(jd){Fc.ewaAccessibilityManager=jd;Fc.ewaAccessibilityManager.mode=2})};Cd.prototype.I$g=function(){this.TZd=new Gc(this);this.SZd=new zb(this);this.UZd=new Xb(this)};Cd.prototype.aBj=function(){var Fc=this;ib.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");qb.AFrameworkApplication.tN("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");qb.AFrameworkApplication.tN("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");
qb.AFrameworkApplication.tN("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");this.BD=excelVersionHistory.FactoryGlobal.getTelemetryCollector();this.perfTelemetryInfos=[];this.BD.startTimer(Cd.Z8f);if(!this.wm&&(xb.a(function(){Fc.wm=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object(Ob.a)(new bc,{ulsLogger:new Wd.a,docId:qb.AFrameworkApplication.oj,appSettings:Object(Ob.a)(new Kb,{appName:120,userSessionId:qb.AFrameworkApplication.userSessionId,
wdEnableSaveACopy:nd.EwaSettings.ma(357),wdEnableDownloadTokens:nd.EwaSettings.ma(352),wacCluster:qb.AFrameworkApplication.Jd.aT,uiLocale:qb.AFrameworkApplication.uiCulture||"en-us",wdEnableRestore:nd.EwaSettings.ma(322)&&Fc.$.isEditMode,wdEnableIterator:nd.EwaSettings.ma(319)&&nd.EwaSettings.ma(320),useXhr:qc.a.m_,wdEnableHiddenButtonsUntilVersionLoadComplete:nd.EwaSettings.ma(425),disableSaveACopy:Fc.p1f(),wdEnableShowVersionChanges:nd.EwaSettings.ma(319)&&nd.EwaSettings.ma(321),disabledChangeGates:Fc.$.ya.VHSDisabledChangeGates,
wdEnableSaveACopyOverFlowMenu:nd.EwaSettings.ma(550),isRtl:qb.AFrameworkApplication.isRtl}),perfTelemetryInfos:Fc.perfTelemetryInfos}))}),!this.wm))return ib.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),Jb.c(429638140,!1),!1;this.bBj();this.BD.endTimer(Cd.Z8f);this.BD.startTimer(Cd.b9f);ib.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");Jb.c(429638140,
!0);return!0};Cd.prototype.bBj=function(){this.Ck();if(!document.getElementById(this.X8b)){var Fc=document.createElement("div");Fc.id=this.X8b;Fc.style.width="100%";Fc.style.zIndex="998";Fc.style.display="block";Fc.style.position="absolute";qb.AFrameworkApplication.ta.Qa.Wg?(Fc.style.top=document.getElementById("HeaderRegion").offsetHeight+"px",Fc.style.bottom="0px"):Fc.style.height="100%";this.$.kr.insertBefore(Fc,this.$.kr.firstChild);this.PNb=this.wm.createVersionHistoryDialog(Fc)}document.getElementById(this.X8b).style.display=
"block";this.XHd();this.BD.startTimer(Cd.FVd);this.wm.getVersions("")};Cd.prototype.XHd=function(){nd.EwaSettings.ma(389)&&(this.TZd.$h(),this.SZd.$h(),this.UZd.$h(),this.VYi())};Cd.prototype.QXd=function(){nd.EwaSettings.ma(389)&&(this.TZd.f8(),this.SZd.f8(),this.UZd.f8(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};Cd.prototype.Ck=function(){this.wm.getVersionsReadyEvent().addListener(this.KDf);this.wm.getVersionSelectedEvent().addListener(this.onVersionSelected);this.wm.getCloseSelectedEvent().addListener(this.Puf);
this.wm.getFullAppErrorEvent().addListener(this.Zwf);this.wm.getIteratorSelectedEvent().addListener(this.ryf);this.wm.getShowVersionChangesToggledEvent().addListener(this.UBd);nd.EwaSettings.ma(352)&&(this.wm.getDownloadTokenReadyEvent().addListener(this.Pvf),this.fId=!0);nd.EwaSettings.ma(357)&&(this.wm.getSaveACopySelectedEvent().addListener(this.zBf),this.wm.getDownloadVersionSelectedEvent().addListener(this.Qvf));nd.EwaSettings.ma(322)&&this.$.isEditMode&&(this.wm.getRestoreVersionSelectedEvent().addListener(this.iBf),
this.gId=!0);this.Noa&&this.Noa.getAppErrorEvent().addListener(this.ttf)};Cd.prototype.vm=function(){this.wm.getVersionsReadyEvent().removeListener(this.KDf);this.wm.getVersionSelectedEvent().removeListener(this.onVersionSelected);this.wm.getCloseSelectedEvent().removeListener(this.Puf);this.wm.getFullAppErrorEvent().removeListener(this.Zwf);this.wm.getIteratorSelectedEvent().removeListener(this.ryf);this.wm.getShowVersionChangesToggledEvent().removeListener(this.UBd);nd.EwaSettings.ma(357)&&(this.wm.getSaveACopySelectedEvent().removeListener(this.zBf),
this.wm.getDownloadVersionSelectedEvent().removeListener(this.Qvf));this.fId&&(this.wm.getDownloadTokenReadyEvent().removeListener(this.Pvf),this.fId=!1);this.gId&&(this.wm.getRestoreVersionSelectedEvent().removeListener(this.iBf),this.gId=!1);this.Noa&&this.Noa.getAppErrorEvent().removeListener(this.ttf)};Cd.prototype.Lxj=function(){var Fc=!0;if(nd.EwaSettings.ma(612)&&!this.$.kR)return ib.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+
this.$.ea.amIAlone.toString()),!0;if(!this.$.ea.amIAlone&&!nd.EwaSettings.ma(318)){this.uti();this.wm.setCoauthRestoreError();Fc=!1;var jd=new ne.a(-729359593,0,this.$.ed,0,null);this.$.Ka.Xb(jd)}this.$.kR&&(ib.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),Fc&&(Fc=!1,this.$Aj()));return Fc};Cd.prototype.$Aj=function(){var Fc=ed.a.gd(1,0,1864,1863,0,-1603358883,"RestoreVersionUnsavedChangesError");Fc=this.dialog||new Xc.ErrorDialog(this.$,
Fc);Fc.initialize();Fc.kf()};Cd.prototype.DUj=function(){ib.ULS.sendTraceTag(537150343,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.baseVersionInfo?Cd.jF(this.baseVersionInfo):"");if(Cd.jF(this.G3)===this.QTe)return ib.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(nd.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.wrf)return ib.ULS.sendTraceTag(537150341,
0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),!0;if(!this.baseVersionInfo)return ib.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;var Fc=Cd.nNh(this.baseVersionInfo);ib.ULS.sendTraceTag(537150339,0,50,"downloadURL length {0}",Fc?Fc.length:0);return Fc?!0:(ib.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)};Cd.prototype.p1f=function(){return!this.$.uka};
Cd.prototype.mZg=function(){document.getElementById(this.X8b).style.display="none";var Fc=new ne.a(-1423792966,0,this.$.ed,0,null);this.$.Ka.Xb(Fc);this.mye()};Cd.prototype.mye=function(){this.BD&&(this.BD.endTimer(Cd.b9f),this.Iwe(this.BD),this.BD=null);this.vm();this.QXd();this.perfTelemetryInfos&&(ib.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.TB&&(this.TB.Aoa(we.a.gUa),this.TB.Aoa(we.a.hUa),this.TB.Aoa(pd.a.setCurrentChangeCount),this.TB.Aoa(pd.a.setTotalChangesCount),
nd.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.TB.Aoa(pd.a.$Oa),this.TB.dispose(),this.TB=null)};Cd.prototype.efj=function(Fc){var jd=this;try{this.Noa?hc.setIsPageLoadForFirstTime(!1):(hc.setIsPageLoadForFirstTime(!0),xb.a(function(){var td=new Wa;td.ulsLogger=new Wd.a;td.actionUrl=jd.$.ya.VersionHistoryActionUrl;td.hideEmbedFooter=!0;td.useFetch=nd.EwaSettings.ma(420)&&!qc.a.uv;jd.Noa=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object(Ob.a)(new wb,
{appBootSettings:td,rootDiv:Fc}))}))}catch(td){ib.ULS.sendTraceTag(41239239,0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",td)}};Cd.prototype.nNd=function(Fc){ib.ULS.sendTraceTag(537150298,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",Cd.jF(Fc),this.pBb);if(Fc)if(Cd.jF(Fc).length){var jd=(new Date).getTime();if(Cd.jF(Fc)===this.pBb&&1E3>jd-this.Jsd)ib.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");
else{Cd.jF(Fc)!==this.pBb&&(ib.ULS.sendTraceTag(537150294,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.wm.setTotalChangesCount(-1),this.wm.setCurrentChangeCount(-1));var td=excelVersionHistory.FactoryGlobal.getTelemetryCollector();td.addEvent("SelectVersion",Cd.jF(Fc));try{this.hXj(td);this.Jsd=jd;this.pBb=Cd.jF(Fc);var ue=new ic;ue.selectedVersionInfo=this.G3;ue.baseVersionInfo=this.baseVersionInfo;ue.telemetryCollector=td;this.Noa.onVersionSelectedWithParams(ue);
this.wm&&nd.EwaSettings.ma(357)&&this.wm.setDisableSaveACopy(this.p1f());var He=document.getElementById(Cd.Vwh);He&&!this.TB&&(ib.ULS.sendTraceTag(537150293,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.TB=new pd.a(He.contentWindow,wa.a.Uaa(this.$.ya.VersionHistoryActionUrl)||rd.a.X9),this.TB.Rl(we.a.gUa,this.jHb),this.TB.Rl(we.a.hUa,this.jHb),this.TB.io(pd.a.setCurrentChangeCount),this.TB.io(pd.a.setTotalChangesCount),nd.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.TB.io(pd.a.$Oa),this.TB.Rl(pd.a.setCurrentChangeCount,this.jHb),this.TB.Rl(pd.a.setTotalChangesCount,this.jHb),nd.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.TB.Rl(pd.a.$Oa,this.jHb))}catch(bf){this.Jsd=0,this.pBb="",td.addEvent("Exception",bf.toString()),ib.ULS.sendTraceTag(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",bf)}finally{ib.ULS.sendTraceTag(537150292,0,50,td?td.getJsonForLogging():"")}}}else ib.ULS.sendTraceTag(537150296,
0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else ib.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};Cd.prototype.hXj=function(Fc){for(var jd=El(this.perfTelemetryInfos),td=jd.next();!td.done;td=jd.next()){var ue=td.value;td=ue.TelemetryEventKey?ue.TelemetryEventKey:ue.telemetryEventKey?ue.telemetryEventKey:"";ue=ue.TelemetryEventData?ue.TelemetryEventData:ue.telemetryEventData?ue.telemetryEventData:"";td&&ue&&Fc.addEvent(td,
ue)}Array.clear(this.perfTelemetryInfos)};Cd.prototype.Iwe=function(Fc){ib.ULS.sendTraceTag(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",Fc?Fc.getJsonForLogging():"")};Cd.prototype.uti=function(){for(var Fc=this.$.ea.Pm,jd={},td=null,ue=El(Fc),He=ue.next();!He.done;He=ue.next())He=He.value,He.UserEmail&&(jd[He.UserEmail]=He.UserEmail in jd?jd[He.UserEmail]+1:1),He.User.UserID===this.$.ea.clientId&&(td=He.UserEmail);ib.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",
Fc.length,td?jd[td]:-1)};Cd.prototype.MNd=function(Fc,jd){ib.ULS.sendTraceTag(537150285,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",Fc);if(this.TB){Fc=new md.a(Fc);Fc.Values[bd.a.R4c]=this.$.ya.UserSessionId;if(jd)for(var td in jd)Fc.Values[td]=jd[td];this.TB.send(Fc)}else ib.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};Cd.jF=function(Fc){return Fc?Fc.RevisionID?Fc.RevisionID:Fc.revisionID?
Fc.revisionID:"":""};Cd.nNh=function(Fc){return Fc?Fc.DownloadUrl?Fc.DownloadUrl:Fc.downloadUrl?Fc.downloadUrl:"":""};Cd.Wwh="_excelVersionHistoryOverlay";Cd.Vwh="vhs_frame";Cd.Z8f="TimeTakenShowVersionHistoryDialogAction";Cd.b9f="TimeTillVersionHistoryDialogWasOpenMs";Cd.FVd="TimeTakenGetVersionsToOnVersionsReady";Cd.B3g="CountOnVersionSelectedCalledinOneVHSession";Cd.C3g="CountOnVersionsReadyCalledinOneVHSession";Cd.A3g="CountOnDownloadTokenReadyCalledinOneVHSession";Cd.$8f="TimeTakenVersionRestore";
Object(Oa.a)(Cd,"VersionHistoryPaneActor",null,[3]);var tf=b(256),Kf=Na.a;Am(yc,Kf);yc.prototype.Nd=function(){var Fc=this,jd=this.Gsi(),td=Vb.GetServiceTaskFactory.Va(this.$.da,21,137,this.ub);pc.TaskExtensions.Ba(pc.TaskExtensions.ye([jd,td],this.la,3),function(){var ue=td.result,He=wa.a.Uaa(Fc.$.ya.VersionHistoryActionUrl);He!==rd.a.X9&&ue.zFa(He);ue=new Cd(Fc.$);Fc.Cd([new Uc(Fc.$,ue)])},this.la,3)};yc.prototype.Gsi=function(){var Fc=Vb.GetServiceTaskFactory.Vvb(this.$.da,283,284,this.ub).then(function(jd){return jd.Jn.loadScript("excelVersionHistory")},
function(jd){ib.ULS.sendTraceTag(537150412,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",jd);return Promise.reject(jd)});return tf.c(Fc)};yc.ka=function(Fc){Na.a.fe(304,new yc(Fc))};Object(Oa.a)(yc,"VersionHistoryCommandHandlerFactory",Na.a,[]);var Ff=b(1320),Pe=Qa.a;Am(Qb,Pe);Qb.prototype.create=function(){var Fc=this,jd=Vb.GetServiceTaskFactory.Va(this.$.da,211,212,this.ub),td=Vb.GetServiceTaskFactory.Va(this.$.da,21,137,this.ub);pc.TaskExtensions.Ba(pc.TaskExtensions.ye([jd,
td],this.$.la),function(){Fc.Eb(Fc.$.da.Aa(305)||new Ff.a(Fc.$,!0,td.result,jd.result))},this.$.la,3)};Qb.ka=function(Fc){Fc.da.Ga(306,new Qb(Fc))};Object(Oa.a)(Qb,"VersionHistoryHighlightManagerFactory",Qa.a,[]);var Xe=b(557),de=b(5),Kd=b(166),pe=b(15),Lf=Mb.a;Am(Ja,Lf);Ja.prototype.execute=function(Fc){this.lineageManager.lineageHidePreviousHistory();return Lf.prototype.execute.call(this,Fc)};Object(Oa.a)(Ja,"LineageClearHistoryConfirmedActivity",Mb.a,[]);var Be=b(16),eg=b(142);Db.prototype.Zc=
function(){return!1};Db.prototype.executeCommand=function(Fc,jd,td){Fc=!1;switch(jd.command){case 1834994092:9===jd.Ye&&this.vGj();this.zyj(jd,td);Fc=!0;break;case -409942531:this.Byj(),Fc=!0}return Fc?Zc.Task.Sa(!0):hd.a(jd.command)};Db.prototype.Lc=function(Fc,jd){return 1834994092===jd.command||-409942531===jd.command};Db.prototype.jd=function(){return!1};Db.prototype.zyj=function(Fc,jd){ib.ULS.sendTraceTag(537155483,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",jd.MenuItemId||
Fc.Ye);this.lineageManager.k3f(19===Fc.Ye&&!!jd.MenuItemId,jd.MenuItemId,Fc.Ye)};Db.prototype.vGj=function(){var Fc=de.a.rrc;Fc!==Kd.a(this.$).Vm.Gp&&Kd.a(this.$).Vm.activateRibbonTab(Fc)};Db.prototype.Byj=function(){var Fc=this;Ub.a(this.$).wt(new Hc.a(Za.a.ptd,5,function(){var jd=Hd.a(Fc.$).ud,td=ed.a.gd(3,1,2186,2187,2188,1038647878,"LineageConfirmClearHistory");td.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";td.HelpDescription=pe.a.instance.fa(1289);jd.Lt([td])}))};Object(Oa.a)(Db,"LineageActivityCommandHandler",
null,[429]);var Jc=Na.a;Am(rc,Jc);rc.prototype.Nd=function(){var Fc=this;pc.TaskExtensions.Ba(Vb.GetServiceTaskFactory.Va(this.$.da,366,367,this.ub),function(jd){Fc.Cd([new Db(Fc.$,jd.result)])},this.la,3)};rc.ka=function(Fc){Na.a.fe(363,new rc(Fc))};Object(Oa.a)(rc,"LineageActivityCommandHandlerFactory",Na.a,[]);ob.prototype.B6a=function(){return!this.Ddb};ob.Abf=function(){return ob.sbf()&&nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)};ob.sbf=function(){return nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)};Object(Oa.a)(ob,"LineageCatchUpExperimentManager",null,[683]);var Yd=Qa.a;Am(cb,Yd);cb.prototype.create=function(){var Fc=this;ob.Abf()?pc.TaskExtensions.Ba(Vb.GetServiceTaskFactory.Va(this.$.da,456,457,this.ub),function(jd){pc.TaskExtensions.Ba(jd.result.axj(),function(td){Fc.sDe(td.result)},Fc.$.la,3)},this.$.la,3):this.sDe(!0)};cb.prototype.sDe=function(Fc){this.Eb(this.$.da.Aa(458)||
this.$.da.Ga(458,new ob(Fc)))};cb.ka=function(Fc){Fc.da.Ga(459,new cb(Fc))};Object(Oa.a)(cb,"LineageCatchUpExperimentManagerFactory",Qa.a,[]);var Ge=b(439),ud=b(37),Ye=b(85),mf=b(152),xe=b(123);Object(Oa.a)(pb,"LineageClientParams",null,[]);Object(Oa.a)(Tb,"LineageFilter",null,[]);var Qe=b(63),jg=b(79),je=b(131),pf=b(46),qg=b(562),Gf=b(175),Mg=b(119),dg=b(110),lc=b(292),Nc=b(291),Nd=b(105),le=b(22),ke=b(132),xd=b(84),fc=b(49),fe=b(355);Object(Oa.a)(Sb,"LineageActivitiesResponseDTO",null,[]);Am(gb,
Sb);Object(Oa.a)(gb,"LineageActivitiesUpdateResponseDTO",Sb,[]);Object(Oa.a)(Ia,"LineageAppCallbacks",null,[]);Object(Oa.a)(ha,"LineageAuthorDTO",null,[]);Object(Oa.a)(La,"LineageControllerFactoryParams",null,[]);Object(Oa.a)(mb,"LineageSharedRangeDTO",null,[]);Object(Oa.a)(Ra,"LineageSheetMultiRangeDTO",null,[]);Object(Oa.a)(Ha,"LineageUserActivityDTO",null,[]);Object(Oa.a)(Xa,"LineageValueChangeDTO",null,[]);qa.prototype.dispose=function(){this.G9i();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.mO(this.onPaneClosed),
this.lineageTaskPane.XF(this.Rz),this.lineageTaskPane=null);this.BLb=this.Rqc=this.Otb=this.otd=this.zF=null};qa.prototype.k3f=function(Fc,jd,td){if(this.lineageTaskPane.isVisible){if(9===td){ib.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!Fc&&16!==td&&18!==td){this.lineageTaskPane.c1c();return}}ud.a.Ld(this.$)||(this.BLb.start(),this.C7&&(fc.b().OA(this.BLb.id,this.C7.id,"actions","actions"),this.C7.stop(),this.C7=
null));this.lineageTaskPane.Ygc||ib.ULS.sendTraceTag(537155482,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",Fc?jd:td);this.jE=this.$.ea.rf;this.Otb=null;Fc&&(Fc=pf.r(this.gridView.ha.sa.selectedRanges,this.$),this.Otb=Object(Ob.a)(new Ra,{rangeList:jd.toString()===de.a.D2f?this.dwb(Fc.Ranges):null,sheetName:Fc.SheetName}));ud.a.Ld(this.$)&&this.lineageTaskPane.Ygc?this.lineageTaskPane.sqj(this.BEb):this.zF.createLineagePane(this.otd,this.Otb);this.lineageTaskPane.jg(!0);
this.$.Xd(-71295319,-1,0,null)};qa.prototype.lineageHidePreviousHistory=function(){function Fc(ue,He,bf){var Rf=jd.$.na.ua,ig=Rf.Na(1,null);return xd.i(Rf,"LineageHidePreviousHistory",ig,ue,He,bf,null,0)}var jd=this,td={};td=(td.paneVisible=this.lineageTaskPane.isVisible,td);mf.a.sendTelemetryEvent(Object(Ob.a)(new fe.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:xe.a.Il(td)}));nd.EwaSettings.qc()?this.$.userOperationManager.ic(new Gf.a(1018,0,Fc,64),null):this.$.userOperationManager.ic(new qg.a(1018,
0,Fc,0),null);this.lineageTaskPane.isVisible||this.k3f(!1,null,4)};qa.prototype.fai=function(){var Fc=this,jd=Object(Ob.a)(new Ia,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,
lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest});xb.a(function(){Fc.zF=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object(Ob.a)(new La,{clientBatchSize:Fc.batchSize,filterableSheetList:Fc.s4a(),uiCulture:Fc.$.ya.UICultureTag,dataCulture:Fc.$.ya.DataCultureTag,logger:new Wd.a,lineageAppCallbacks:jd}))})};qa.prototype.kfd=function(Fc){var jd=this;return function(td){if(td=lc.a(td)?null:td.Result){var ue=
{};ue=(ue.CountOfActivities=td.ActivityList.length,ue);ue.WebRequestName=Fc;ke.b(jd.$).Vd(je.a.XKi,ue);td=Object(Ob.a)(new Sb,{activityList:jd.CFd(td.ActivityList),latestActivityId:td.LastSearchedActivityId,oldestActivityId:td.FirstSearchedActivityId,serverMessageCode:td.LineageResponseCode,lastSearchedActivityTimestamp:new Date(td.EcmaLastSearchedDate),serverFirstActivityId:td.ServerFirstActivityId,serverLastActivityId:td.ServerLastActivityId,showLoadPrevious:td.ShowLoadPrevious,eolCorrelationId:td.EolCorrelationId,
eolDateHideHistory:new Date(td.EolDateHideHistory),eolPersonHideHistory:jd.Xvb(td.EolPersonHideHistory)});jd.zF.onLineageActivitiesResponse(td)}else ib.ULS.shipAssertTag(537155477,0,!!td,"LineageManager."+Fc+" returned null response.")}};qa.prototype.aLj=function(Fc){return dg.e(Fc.Ranges)&&!Fc.SheetName?null:Object(Ob.a)(new Ra,{rangeList:this.dwb(Fc.Ranges),sheetName:Fc.SheetName})};qa.prototype.dwb=function(Fc){var jd=[];Fc=El(Fc);for(var td=Fc.next();!td.done;td=Fc.next())td=td.value,td=Object(Ob.a)(new mb,
{firstCol:td.FirstColumn,firstRow:td.FirstRow,lastRow:td.LastRow,lastCol:td.LastColumn}),jd.push(td);return jd};qa.prototype.kLj=function(Fc){if(!Fc)return null;var jd={};jd.Ranges=this.lgd(Fc.rangeList);jd.SheetName=Fc.sheetName;return jd};qa.prototype.lgd=function(Fc){var jd=[];if(dg.e(Fc))return jd;Fc=El(Fc);for(var td=Fc.next();!td.done;td=Fc.next()){td=td.value;var ue={};ue.FirstColumn=td.firstCol;ue.FirstRow=td.firstRow;ue.LastRow=td.lastRow;ue.LastColumn=td.lastCol;jd.push(ue)}return jd};qa.prototype.z6h=
function(Fc){(Fc=this.$.xa.getItemByName(Fc))&&Fc.visible&&Fc.activate(!0)};qa.prototype.X7e=function(Fc,jd){var td=[];jd=El(jd);for(var ue=jd.next();!ue.done;ue=jd.next()){ue=ue.value;var He={};He.FirstColumn=ue.firstCol;He.FirstRow=ue.firstRow;He.LastRow=ue.lastRow;He.LastColumn=ue.lastCol;td.push(pf.D(He))}jd=td.length-1;ue=td[jd].topLeft;le.g(this.$).IV(td,jd,Fc,null,ue,null,null,3,Nd.a.Hri,void 0,void 0,void 0,!0)};qa.prototype.K6i=function(){this.zF&&this.lineageTaskPane.isVisible&&(this.jE=
this.$.ea.rf,this.zF.onRefreshRequired())};qa.prototype.HAg=function(){this.lineageTaskPane.nM(this.onPaneClosed);this.lineageTaskPane.pE(this.Rz);this.$.ea.Ot(this.Hf);this.$.ea.hk(this.od);this.$.ea.mM(this.Io);var Fc=this.$.xa;Fc.GY(this.hD);Fc.Oga(this.Aoc);Fc.JFa(this.Kya);Fc.KYa(this.Aoc)};qa.prototype.G9i=function(){this.$.ea.Ev(this.Hf);this.gridView.ha.aX(this.kd);this.$.ea.Dk(this.od);this.$.ea.iS(this.Io);var Fc=this.$.xa;Fc.e7(this.hD);Fc.Pma(this.Aoc);Fc.sQa(this.Kya);Fc.hIb(this.Aoc)};
qa.prototype.onStaleActivitiesDetected=function(){this.zF.onStaleActivitiesDetected()};qa.prototype.s4a=function(){for(var Fc=[],jd=El(this.$.xa.items),td=jd.next();!td.done;td=jd.next())td=td.value,td.visible&&!Qe.e(td)&&Fc.push(td.sheetName);return Fc};qa.prototype.QAj=function(){if(nd.EwaSettings.ma(618)){var Fc=this.$.da.Aa(403);Fc&&Fc.disable();Fc=new ne.a(-847286761,jg.a.Ub,this.$.ed,0,de.a.r0);var jd={};jd=(jd.InputMethod=jg.a.Ub,jd);jd.CalloutName=5;this.$.Ka.Xb(Fc,jd)}};qa.prototype.CFd=
function(Fc){var jd=[];Fc=El(Fc);for(var td=Fc.next();!td.done;td=Fc.next())td=td.value,td=Object(Ob.a)(new Ha,{activityId:Number.parseLocale(td.UserActivity.Id),activityGuid:td.Uid,activityType:td.UserActivity.Type,author:this.Xvb(td.UserActivity.Person),sheetName:td.SheetName,displayTimestamp:new Date(td.UserActivity.DisplayTimestamp),gridLocation:td.DisplayLocation,valueChanges:this.d1i(td.LineageValueChangeList),isBulkEditOverflow:td.IsBulkEditOverFlow,rangeHighlightLocation:this.T0i(td.UserActivity.LocationList,
td.UserActivity.Type),nestedActivityList:this.M0i(td.NestedActivityList),degradedCardTypeBits:td.DegradedCardTypeBits}),jd.push(td);return jd};qa.prototype.T0i=function(Fc,jd){if(!Fc)return ib.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!Fc.length)return ib.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var td=[],ue=[],He="";21===jd?ue.push(Fc[0]):ue=Fc;Fc=El(ue);for(ue=
Fc.next();!ue.done;ue=Fc.next())switch(ue=ue.value,ue.Type){case 1:break;case 2:He=ue.SheetName;break;case 0:if(!ue.RangeList){ib.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}He=ue.RangeList[0].SheetName;var bf=[];21===jd?bf.push(ue.RangeList[0]):bf=ue.RangeList;ue=El(bf);for(bf=ue.next();!bf.done;bf=ue.next())bf=bf.value,bf=Object(Ob.a)(new mb,{firstCol:bf.FirstColumn,firstRow:bf.FirstRow,lastRow:bf.LastRow,lastCol:bf.LastColumn}),
td.push(bf);break;default:ib.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",ue.Type)}return Object(Ob.a)(new Ra,{sheetName:He,rangeList:td})};qa.prototype.d1i=function(Fc){var jd=[];Fc=El(Fc);for(var td=Fc.next();!td.done;td=Fc.next())td=td.value,td=Object(Ob.a)(new Xa,{hasNewValue:td.HasNewValue,hasOldValue:td.HasOldValue,newValue:td.HasNewValue?td.NewValue:null,oldValue:td.HasOldValue?td.OldValue:null,cellLocation:td.CellLocation}),jd.push(td);
return jd};qa.prototype.M0i=function(Fc){return Fc?this.CFd(Fc):null};qa.prototype.Xvb=function(Fc){if(!Fc)return null;var jd=null;nd.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&qb.AFrameworkApplication.ga.ra("IsUserProfilePictureResolutionEnabled")&&(jd=this.Rqc.QHa(Fc.Email,Fc.Provider,qb.AFrameworkApplication.oj,0));return Object(Ob.a)(new ha,{id:Fc.Id,provider:Fc.Provider,displayName:Fc.DisplayName,email:Fc.Email,imageUrl:jd})};Object(Oa.a)(qa,
"LineageManager",null,[681,3]);var oa=Qa.a;Am(Aa,oa);Aa.prototype.nsi=function(Fc){var jd=this;pc.TaskExtensions.Ba(Fc,function(){jd.Eb(jd.$.da.Aa(366)||new qa(jd.$,jd.$.da,jd.lineageTaskPane,jd.C7))},this.$.la,3)};Aa.prototype.create=function(){var Fc=this;this.C7=this.$.Ob.Gc("UserAction","LineagePaneSeenStopwatch");this.C7.start();var jd=Vb.GetServiceTaskFactory.Va(this.$.da,365,364,this.ub),td=Ge.a(this.$),ue=Vb.GetServiceTaskFactory.Va(this.$.da,283,284,this.ub);pc.TaskExtensions.Ba(pc.TaskExtensions.ye([jd,
td,ue],this.$.la),function(){Fc.lineageTaskPane=jd.result;ud.a.Ld(Fc.$)||td.result.hR(Fc.lineageTaskPane);Fc.nsi(tf.c(ue.result.Jn.loadScript("cellLineage")))},this.$.la,3)};Aa.ka=function(Fc){Fc.da.Ga(367,new Aa(Fc))};Object(Oa.a)(Aa,"LineageManagerFactory",Qa.a,[]);var fb=b(999),Rb=b(230),dc=b(13),uc=b(109),Bd=b(257),Od=b(86),Td=b(242),Ze=b(19),vf=b(914),wf=b(67),Wf=de.a.Mzc+"LineageActivityPaneTitle",ug=de.a.ceb+"LineageActivityCloseButton",Gg=Td.a;Am(Nb,Gg);Nb.prototype.NP=function(Fc){this.get_events().addHandler("LineageTaskPaneRemove",
Fc)};Nb.prototype.jS=function(Fc){this.get_events().removeHandler("LineageTaskPaneRemove",Fc)};Nb.prototype.pE=function(Fc){this.addHandler("LineageTaskPaneVisibilityChanged",Fc)};Nb.prototype.XF=function(Fc){this.removeHandler("LineageTaskPaneVisibilityChanged",Fc)};Nb.prototype.nM=function(Fc){this.get_events().addHandler("LineageTaskPaneClose",Fc)};Nb.prototype.mO=function(Fc){this.get_events().removeHandler("LineageTaskPaneClose",Fc)};Nb.prototype.PH=function(){};Nb.prototype.qp=function(){return this.Mp};
Nb.prototype.ms=function(){return this.Mp};Nb.prototype.YR=function(){};Nb.prototype.dR=function(){return!1};Nb.prototype.Cj=function(){};Nb.prototype.Rj=function(){};Nb.prototype.dispose=function(){this.$&&(this.$.rm(this.Yc),jc.a(this.$).Vz(this));this.te&&(Rb.a.instance.za(dc.a.click,this.te,this.dk),uc.KeyInputManager.instance.Sv(this.te,this.oze));this.te=this.taskPaneManager=this.$=null;Gg.prototype.dispose.call(this)};Nb.prototype.Wf=function(Fc,jd){if(!jd){Fc=ae.DOMElementExtensions.getElementById(this.domElement,
"LineagePaneFilterButton");if(!Fc)return!1;ae.DOMElementExtensions.setFocus(Fc)}return!jd};Nb.prototype.ph=function(Fc){return ae.DOMElementExtensions.Ff(this.uc,Fc)};Nb.prototype.jg=function(Fc){this.Mp=Fc;var jd=this.taskPaneManager;if(this.isVisible=Fc)this.$.frame.Re.Vj("LineagePane"),this.Jpd=!1;if(ud.a.Ld(this.$))Fc?jd.G6("LineageTaskPane",this.kG):jd.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.nx();var td=!!this.taskPaneManager.Ng&&15===this.taskPaneManager.Ng.taskPane.dh;Fc&&
0<jd.eA.length&&(!td||jd.isCollapsed)&&jd.bG(this,!0)}this.$.Bf()};Nb.prototype.DM=function(){var Fc=this.$.Mb;Fc=ud.a.Ld(this.$)?this.domElement:document.getElementById(Fc+de.a.std);var jd=this.eH();Fc.appendChild(jd);jd=vf.b("div","LineagePaneBodyId","LineageActivityBody");Fc.appendChild(jd);this.tqj();return jd};Nb.prototype.c1c=function(){this.$.frame.Re.Vj(this.$.frame.Re.WE||Bd.AFrame.mU);this.Jpd=!0;this.jg(!1);this.raiseEvent("LineageTaskPaneClose")};Nb.prototype.sqj=function(Fc){this.BEb=
Fc};Nb.prototype.tqj=function(){this.$.frame.Re.fk("LineagePane");var Fc=this.$.frame.Re.zi("LineagePane");Fc.parent=Bd.AFrame.mU;Fc.xR=!0};Nb.prototype.eH=function(){var Fc=vf.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),jd=vf.b("h1","LineagePaneTitleId",Wf);jd.innerText=this.titleText;this.te=fb.a.Bb("LineagePaneCloseButtonId",ug,pe.a.instance.fa(10),"ClosePaneGlyph_16x16x32",!1);this.te.classList.add(qb.AFrameworkApplication.isRtl?de.a.Caa:de.a.Daa);Rb.a.instance.pa(dc.a.click,this.te,
this.dk);this.oze=uc.KeyInputManager.instance.xs(this.te,this.dk,Od.a.di);Fc.appendChild(jd);Fc.appendChild(this.te);return Fc};Nb.ka=function(Fc,jd){var td=Fc.Mb,ue=document.getElementById(td+de.a.std);ue||(ue=document.createElement("div"),ue.id=Fc.Mb+de.a.std,ue.classList.add("LineageActivityPane"),ud.a.Ld(Fc)||document.getElementById(td+de.a.NR).appendChild(ue));return Fc.da.Aa(365)||Fc.da.Ga(365,new Nb(ue,Fc,jd))};Ek.Object.defineProperties(Nb.prototype,{isVisible:{configurable:!0,enumerable:!0,
get:function(){return Object(wf.a)(Nb.prototype,this,"isVisible")},set:function(Fc){Object(wf.a)(Nb.prototype,this,"isVisible")!==Fc&&(Object(wf.b)(Nb.prototype,this,"isVisible",Fc),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},Ygc:{configurable:!0,enumerable:!0,get:function(){return this.Jpd}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},dh:{configurable:!0,enumerable:!0,get:function(){return 15}},we:{configurable:!0,enumerable:!0,get:function(){return vd.a.Iri}},
Qk:{configurable:!0,enumerable:!0,get:function(){return Ze.a.auh}},eN:{configurable:!0,enumerable:!0,get:function(){return pe.a.instance.fa(1043)}},Do:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},uc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.TO.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return pe.a.instance.fa(1264)}},
kG:{configurable:!0,enumerable:!0,get:function(){var Fc=this;return this.taskPaneManager.Rua(this.uc,this.titleText,this.Do,this.isResizable,function(){Fc.isVisible=!0;Fc.BEb?Fc.BEb():ib.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set.")},function(){Fc.isVisible=!1},function(){Fc.isVisible=!0},function(){Fc.isVisible=!1},this.Do)}}});Object(Oa.a)(Nb,"LineageTaskPane",Td.a,[680,3,513,444]);var Cf=Qa.a;Am(lb,Cf);lb.prototype.create=function(){var Fc=this,jd=Vb.GetServiceTaskFactory.create(this.$.da,
203,this.la,this.ub),td=Vb.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub);pc.TaskExtensions.Ba(pc.TaskExtensions.ts(pc.TaskExtensions.ye([jd,td],this.la),function(){return Fc.mD},this.la),function(){Fc.Eb(Fc.jh)},this.la,3)};lb.prototype.dispose=function(){this.jh=this.vi=this.$=null;Cf.prototype.dispose.call(this)};lb.ka=function(Fc){Fc.da.Ga(364,new lb(Fc))};Ek.Object.defineProperties(lb.prototype,{mD:{configurable:!0,enumerable:!0,get:function(){var Fc=this;this.vi||(this.vi=pc.TaskExtensions.Ba(Ge.a(this.$),
function(jd){Fc.jh=Nb.ka(Fc.$,jd.result)},this.la,3));return this.vi}}});Object(Oa.a)(lb,"LineageTaskPaneFactory",Qa.a,[]);kb.prototype.dispose=function(){this.HId();this.$=null;ib.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};kb.prototype.disable=function(){kb.axb||(kb.axb=!0,ib.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.HId()};kb.prototype.eVj=function(){var Fc=this;nd.EwaSettings.ma(614)&&
!this.$.isAnonymousUser()&&xd.l(this.$.na.ua,function(jd){Fc.$?(jd=jd.Result,ib.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",jd),kb.p6e=!0,jd&&Fc.g$f(0)):ib.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){ib.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)};kb.prototype.ZUj=function(){nd.EwaSettings.ma(613)&&
!this.r$f()&&(this.$.ea.Ot(this.Hf),this.iqd=!0)};kb.prototype.r$f=function(){return this.$.ea&&this.$.ea.Qm&&this.$.ea.Qm.ShouldTriggerLineageCalloutOnMerge?(ib.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.g$f(1),!0):!1};kb.prototype.g$f=function(Fc){if(kb.axb)ib.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(kb.axb=!0,ib.ULS.sendTraceTag(578557776,
0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",Fc),this.HId(),nd.EwaSettings.ma(486)){Fc=new ne.a(-847286761,jg.a.Ub,this.$.ed,0,de.a.r0);var jd={};jd=(jd.CalloutName=4,jd);this.$.Ka.Xb(Fc,jd)}};kb.prototype.HId=function(){this.iqd&&(this.iqd=!1,this.$.ea.Ev(this.Hf))};kb.axb=!1;kb.p6e=!1;Object(Oa.a)(kb,"LineageTeachingCalloutTriggerManager",null,[679,3]);var rg=Qa.a;Am(Gb,rg);Gb.prototype.create=function(){var Fc=this;pc.TaskExtensions.Ba(Vb.GetServiceTaskFactory.Va(this.$.da,
458,459,this.ub),function(jd){jd=new kb(Fc.$,jd.result);Fc.Eb(jd)},this.$.la,3)};Gb.ka=function(Fc){Fc.da.Ga(402,new Gb(Fc))};Object(Oa.a)(Gb,"LineageTeachingCalloutTriggerManagerFactory",Qa.a,[]);var dh=b(1084),fh=b(74);Sa.prototype.wS=function(Fc,jd,td,ue){var He=this;return this.Lgh(Fc,void 0===ue?null:ue,function(bf){return He.Mg.gZb(bf,2,td,jd,void 0,void 0,void 0,void 0,void 0,"2")})};Sa.prototype.Lgh=function(Fc,jd,td){var ue=this,He=!!jd&&""!==jd,bf=Fc;He&&(bf=wa.a.eU(Fc,"perfTag",jd));var Rf=
new Date;return dh.a.then(td(bf),function(ig){var Vf=+new Date-+Rf;if(!ig||!ig.fh||!ig.fh.data)return ig;He&&ig.fh.data.request&&ue.wmj(ig.fh.data.request.getResolvedUrl(),jd,Vf);return ig})};Sa.prototype.wmj=function(Fc,jd,td){Fc=this.Ru.YVh(Fc);if(Fc.count&&(Fc=fh.last(Fc))){var ue={Message:"Request durations for activities calls."};ue.PerfTag=jd;ue.CustomDuration=td;ue.PerformanceDuration=Fc.duration;ib.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(ue))}};Object(Oa.a)(Sa,"CatchUpNetworkingWrapper",
null,[162]);var vg=b(251),Me=vg.a;Am(Ca,Me);Ca.prototype.Laa=function(){return 6};Object(Oa.a)(Ca,"GetActivityFeedRequest",vg.a,[]);var Of=vg.a;Am(fa,Of);fa.prototype.Laa=function(){return 7};Object(Oa.a)(fa,"UpdateActivityFeedStateRequest",vg.a,[]);var ac=b(410);ta.prototype.getActivityFeed=function(Fc){var jd=this;return dh.a.then(this.QCa.execute(new Ca(this.ACa(),null),function(td,ue,He){return jd.Mbe.wS(td,ue,He,"ActivityFeed")},Fc),function(td){if(!td)return ib.ULS.sendTraceTag(572846937,3012,
10,"GetActivityFeed: Response is null"),null;if(!td.fh)return ib.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;if(!td.fh.data)return ib.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!td.fh.data.ke)return ib.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;td=ac.a.pIa(td.fh.data.ke);return td?td:(ib.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),
null)})};ta.prototype.kPj=function(Fc,jd,td,ue){var He=this;return dh.a.then(this.QCa.execute(new fa(this.ACa(),null,Fc,jd,td,ue),function(bf,Rf,ig){return He.Mbe.wS(bf,Rf,ig,"UpdateActivityFeedState")},null),function(bf){try{return bf.succeeded}catch(Rf){return ib.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception: "+Rf.message),!1}})};Object(Oa.a)(ta,"CatchUpRequestHandler",null,[176]);var Lc=b(518);va.prototype.sti=function(){this.dui()};va.prototype.dui=function(){var Fc=this;this.lga?
this.lga.execute(function(jd){window.setTimeout(function(){Fc.zae.contains("CatchUpChangesFeedback")||(Fc.zae.add("CatchUpChangesFeedback"),jd.logActivity("CatchUpChangesFeedback",null))},2E4)}):ib.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};Object(Oa.a)(va,"FloodgateEventLogger",null,[]);var wd=b(202);Ek.Object.defineProperties(xa.prototype,{duration:{configurable:!0,enumerable:!0,get:function(){return this.qtg.duration}}});Object(Oa.a)(xa,
"PerformanceResourceTimingWrapper",null,[]);pa.prototype.YVh=function(Fc){var jd=new wd.a;if(!this.Ru)return jd;Fc=this.Ru.getEntriesByName(Fc,"resource");if(!Fc)return jd;Fc=El(Fc);for(var td=Fc.next();!td.done;td=Fc.next())jd.add(new xa(td.value));return jd};Object(Oa.a)(pa,"PerformanceWrapper",null,[]);var Mc=b(255);ma.prototype.ei=function(Fc){var jd=this;this.tb=Fc;this.tb.register(Sa,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").Hc().Oc(function(){return new Sa(qb.AFrameworkApplication.Jd,
new pa(window.performance))});this.tb.register(ta,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").Hc().Oc(function(){return new ta(jd.tb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),function(){return qb.AFrameworkApplication.oj},new ac.a)});this.tb.register(va,"Common.App.CatchUpActivity.FloodgateEventLogger").Hc().Oc(function(){return new va(jd.tb.lc("Common.ISystemInitiatedFeedback"))})};ma.prototype.init=function(){this.tb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");
this.tb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};ma.prototype.dispose=function(){};ma.main=function(){Mc.a.instance.hj(new ma)};Ek.Object.defineProperties(ma.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});Object(Oa.a)(ma,"CatchUpActivityPackage",null,[4,5]);ka.prototype.Zc=function(Fc,jd){return this.catchUpActivityManager?-876699925===jd?!this.catchUpActivityManager.rbf:!1:!0};ka.prototype.executeCommand=function(Fc,jd){Fc=
!1;switch(jd.command){case -876699925:Fc=this.catchUpActivityManager.MSi()}return Fc?Zc.Task.Sa(!0):hd.a(jd.command)};ka.prototype.Lc=function(Fc,jd){return nd.EwaSettings.ma(440)&&-876699925===jd.command?!0:!1};ka.prototype.jd=function(){return!1};Object(Oa.a)(ka,"CatchUpActivityCommandHandler",null,[429]);var ge=Na.a;Am(W,ge);W.prototype.Nd=function(){var Fc=this;this.$.da.$a(286,function(jd){Fc.Cd([new ka(Fc.$,jd)])})};W.ka=function(Fc){Na.a.fe(285,new W(Fc))};Object(Oa.a)(W,"CatchUpActivityCommandHandlerFactory",
Na.a,[]);var nf=b(275),Ee=b(566),ya=b(90),Cb=b(83),cc=b(27);Z.prototype.doesContentExist=function(Fc){if(!Fc)return ib.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(Fc.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!Fc.navigationId)return ib.ULS.sendTraceTag(537168065,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var jd={};jd.NavigationId=atob(Fc.navigationId);return 32===this.Di.ve(cc.a.CIa,2,
jd);default:return!1}};Object(Oa.a)(Z,"CatchUpActivityContentManager",null,[688]);var Rc=b(1030),yd=b(1315);R.prototype.dispose=function(){this.rv.qPf(this.xEb);this.Cz=null};R.prototype.Spj=function(Fc){this.Cz.push(Fc)};R.prototype.lYg=function(){Array.clear(this.Cz)};R.prototype.v3f=function(Fc){for(var jd=El(this.Cz),td=jd.next();!td.done;td=jd.next())td=td.value,td.className=Rc.a.UUg,td=document.getElementById(String.format("{0}-{1}",td.id,de.a.Nwe)),ae.DOMElementExtensions.setVisible(td,Fc)};
R.prototype.LLb=function(Fc){for(var jd=El(this.Cz),td=jd.next();!td.done;td=jd.next())if(td=td.value)Fc?td.className=2===this.rv.model.state?Rc.a.R3i:Rc.a.S3i:this.v3f(!1)};Ek.Object.defineProperties(R.prototype,{rv:{configurable:!0,enumerable:!0,get:function(){return this.Dpg}}});Object(Oa.a)(R,"RangeCatchUpActivityView",null,[748,3]);var od=b(21),ze=yd.a;Am(J,ze);J.prototype.dispose=function(){this.gridView=null;ze.prototype.dispose.call(this)};J.prototype.eDg=function(Fc){var jd=this.Hfb[0];jd?
jd.Spj(Fc):ib.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.Ema.activityId)};J.prototype.Qfj=function(){var Fc=this.Hfb[0];Fc&&Fc.lYg()};J.prototype.rBg=function(Fc){this.Ema.addRange(Fc)};J.prototype.eLh=function(){if(3!==this.Ema.activityType)return null;ib.ULS.shipAssertTag(537168003,0,1===this.Ema.kMb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");
return pf.D(this.Ema.kMb[0])};J.prototype.MJb=function(Fc){if(Fc){if(!this.Ema)return;this.vxd(this.Ugj())}ze.prototype.MJb.call(this,Fc)};J.prototype.B4c=function(){var Fc=this.h4c();this.Hfb.push(Fc)};J.prototype.h4c=function(){return new R(this)};J.prototype.vxd=function(Fc){Fc?Fc.SheetName?(this.gridView.ha.Oa.jH(null),this.gridView.focus(),this.gridView.s4e(Fc,3,!1,Nd.a.Q3i)):ib.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):
ib.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};J.prototype.Ugj=function(){if(dg.e(this.Ema.kMb))return ib.ULS.shipAssertTag(537167971,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null;var Fc=this.$.xa.qa;ib.ULS.shipAssertTag(537167970,0,!!Fc,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");
Fc=this.iMj(Fc.sheetName,this.Ema.kMb);if(!Fc&&(Fc=this.E_h(this.Ema.kMb),!Fc))return null;var jd={};jd.SheetName=Fc.SheetName;jd.FirstColumn=Fc.FirstColumn;jd.FirstRow=Fc.FirstRow;jd.LastColumn=Fc.FirstColumn;jd.LastRow=Fc.FirstRow;return jd};J.prototype.E_h=function(Fc){if(dg.e(Fc))return null;for(var jd=null,td=0;td<Fc.length;td++){var ue=Fc[td].SheetName;if(!od.a.equals(ue,jd,!1)&&(jd=ue,ue=this.$.xa.getItemByName(ue),null===ue||void 0===ue?0:ue.visible))return Fc[td]}return null};J.prototype.iMj=
function(Fc,jd){if(jd){jd=El(jd);for(var td=jd.next();!td.done;td=jd.next())if(td=td.value,od.a.equals(td.SheetName,Fc,!1))return td}return null};Object(Oa.a)(J,"RangeCatchUpActivityHighlightController",yd.a,[]);var gf=b(76),of=gf.a;Am(D,of);D.prototype.dispose=function(){this.s1d=null;of.prototype.dispose.call(this)};Ek.Object.defineProperties(D.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.jC}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.s1d}},
activityType:{configurable:!0,enumerable:!0,get:function(){return this.Pjg}}});Object(Oa.a)(D,"CatchUpActivityHighlightModelBase",gf.a,[]);Am(F,D);F.prototype.addRange=function(Fc){Fc=El(Fc);for(var jd=Fc.next();!jd.done;jd=Fc.next())this.ranges.push(jd.value)};F.prototype.dispose=function(){this.ranges=null;D.prototype.dispose.call(this)};F.p3b=function(Fc,jd){if(!Fc.SheetName||!jd.SheetName)return ib.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),
0;var td=Fc.SheetName.localeCompare(jd.SheetName);return td?td:Fc.FirstColumn<jd.FirstColumn||Fc.FirstColumn===jd.FirstColumn&&Fc.FirstRow<jd.FirstRow?-1:Fc.FirstColumn===jd.FirstColumn&&Fc.FirstRow===jd.FirstRow?0:1};Ek.Object.defineProperties(F.prototype,{kMb:{configurable:!0,enumerable:!0,get:function(){this.l7a||(this.ranges.sort(F.p3b),this.l7a=!0);return this.ranges}}});Object(Oa.a)(F,"RangeCatchUpActivityHighlightModel",D,[]);var tg=b(354);aa.prototype.dispose=function(){this.wke=this.aLb=
this.a2c=null};aa.prototype.Rcj=function(Fc){le.g(Fc).Cb.Fn([24])};aa.prototype.k5g=function(Fc,jd,td){var ue={};jd=El(jd);for(var He=jd.next();!He.done;He=jd.next())if((He=He.value)&&!dg.e(He.LocationList)){for(var bf=[],Rf={},ig=[],Vf=El(He.LocationList),Qf=Vf.next();!Qf.done;Qf=Vf.next()){Qf=Qf.value;if(!Qf){ib.ULS.shipAssertTag(537168013,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+He.Id);break}switch(Qf.Type){case 0:var df=Qf;
"0"in Rf?(Qf=Rf["0"],Qf.rBg(df.RangeList)):(Qf=new J(Fc,new F(Fc,He.Id,He.Type,0,df.RangeList),td),bf.push(Qf),Rf["0"]=Qf);df=El(df.RangeList);for(var hg=df.next();!hg.done;hg=df.next()){hg=hg.value;hg=new tg.a(pf.D(hg),Qe.d(Fc.xa.getItemByName(hg.SheetName)));if(this.Vwc(hg)in this.aLb)this.aLb[this.Vwc(hg)].push(Qf);else{var re=[];re.push(Qf);this.aLb[this.Vwc(hg)]=re}ig.push(hg);this.a2c.push(hg)}break;default:ib.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}ib.ULS.shipAssertTag(537168011,
0,!(He.Id in ue),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+He.Id);this.wke[He.Id]=ig;ue[He.Id]=bf}this.F6g(Fc,this.a2c,this.aLb);return ue};aa.prototype.dYg=function(Fc){for(var jd in Fc)for(var td=El(Fc[jd]),ue=td.next();!ue.done;ue=td.next())ue.value.Qfj()};aa.prototype.Vwc=function(Fc){return String.format("{0}-{1}",Fc.range,Fc.sheetId)};aa.prototype.F6g=function(Fc,jd,td){var ue=this;this.dYg(td);le.g(Fc).Cb.jx(jd,[24],!0,function(He,
bf){var Rf=new tg.a(He.range,He.sheetId);Rf=ue.Vwc(Rf);var ig=td[Rf];if(ig)for(Rf=El(ig),ig=Rf.next();!ig.done;ig=Rf.next())ig=ig.value,ig.eDg(bf),He.metadata=ig;else ib.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+Rf)})};Object(Oa.a)(aa,"CatchUpHighlightControllersCreator",null,[]);Object(Oa.a)(U,"CreateIndicatorTooltipParameters",null,[]);Object(Oa.a)(ca,"DismissIndicatorTooltipParameters",null,
[]);Object(Oa.a)(L,"UpdateIndicatorTooltipParameters",null,[]);P.prototype.dispose=function(){this.ha.Hsc(this.xl);this.ha.WF(this.kd);this.gridView.UF(this.Bp);this.Ya.fl(this.gj);this.mHe();this.ebd=this.Xja=this.gec=this.gRa=this.Ya=this.ha=this.gridView=null};P.prototype.Gnj=function(){var Fc=[];this.mHe();if(!dg.e(Fc)){ib.ULS.sendTraceTag(537168035,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.Z4=this.$3b.k5g(this.$,Fc,this)){Fc=this.Z4;for(var jd in Fc)for(var td=
El(Fc[jd]),ue=td.next();!ue.done;ue=td.next())this.BLg(ue.value)}this.$3b.Rcj(this.$)}};P.prototype.Wxc=function(Fc){if(Fc&&this.kkd)ib.ULS.shipAssertTag(537168034,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(Fc||this.gsb(),this.Z4){var jd=this.Z4,td;for(td in jd)for(var ue=El(jd[td]),He=ue.next();!He.done;He=ue.next())He.value.Xzj(Fc)}};P.prototype.y6h=function(Fc){this.Xja&&this.J6b(!0);this.i6c();if(Fc=this.Z4[Fc.activityId]){Fc=
El(Fc);for(var jd=Fc.next();!jd.done;jd=Fc.next())jd.value.MJb(!0)}else ib.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};P.prototype.mHe=function(){if(this.Z4){var Fc=this.Z4,jd;for(jd in Fc)for(var td=El(Fc[jd]),ue=td.next();!ue.done;ue=td.next())ue=ue.value,this.H9i(ue),ue.dispose()}this.Z4={};this.$3b.dispose();this.$3b=null};P.prototype.Cyj=function(){if(this.excelCommentManager){var Fc=this.Z4[this.gRa];Fc&&0<Fc.length&&
3===Fc[0].model.activityType&&((Fc=Fc[0])?this.excelCommentManager.ezj(Fc.eLh()):ib.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};P.prototype.Q5h=function(){this.excelCommentManager&&this.excelCommentManager.btb()};P.prototype.i6c=function(){if(this.gRa){var Fc=this.Z4[this.gRa];if(Fc){Fc=El(Fc);for(var jd=Fc.next();!jd.done;jd=Fc.next())jd.value.MJb(!1);this.gRa=null}else ib.ULS.sendTraceTag(537168028,
0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};P.prototype.gsb=function(){this.i6c();this.J6b(!0)};P.prototype.vMj=function(Fc){if(!Fc)return ib.ULS.shipAssertTag(537168026,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;Fc=String.format("{0}-{1}",Fc.id,de.a.SUg);var jd=this.ebd[Fc];if(!jd){if(!this.gridView.domElement)return ib.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),
null;jd=document.createElement("Div");jd.className=Rc.a.TUg;jd.id=Fc;this.gridView.domElement.appendChild(jd);this.ebd[Fc]=jd}return jd};P.prototype.J6b=function(Fc){this.Vea&&(this.Vea.dismissActivityIndicatorTooltips(Object(Ob.a)(new ca,{clearSticky:Fc})),this.gec=null,Fc&&(this.Xja=null),this.Bgc&&!this.Xja&&(this.gridView.view.Xq(this.sBc),this.gridView.cx(this.sBc),this.Bgc=!1))};P.prototype.BLg=function(Fc){Fc.Lme(this.xEb);Fc.KDg(this.t2f);Fc.JDg(this.eIe)};P.prototype.H9i=function(Fc){Fc.qPf(this.xEb);
Fc.P$i(this.t2f);Fc.O$i(this.eIe)};Ek.Object.defineProperties(P.prototype,{zzg:{configurable:!0,enumerable:!0,get:function(){return this.Vea},set:function(Fc){this.Vea=Fc}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.nDa||(this.nDa=this.$.da.Aa(65));return this.nDa}},$3b:{configurable:!0,enumerable:!0,get:function(){this.a4b||(this.a4b=new aa);return this.a4b},set:function(Fc){this.a4b=Fc}}});Object(Oa.a)(P,"CatchUpActivityHighlightManager",null,[739,3]);Q.prototype.navigateToActivity=
function(Fc){if(Fc.fromSummaryString){var jd=new ne.a(1834994092,jg.a.Ub,this.$.ed,18,null);this.$.Ka.Xb(jd);return this.oUa(1)}Fc=Fc.activity;if(!this.Rdi(Fc))return this.oUa(4);if(!this.Mmi(Fc))return this.oUa(7);var td={};try{jd=window.self.atob(Fc.navigationId);if(!jd)return this.oUa(5);td.NavigationId=jd}catch(ue){return ib.ULS.sendTraceTag(537168023,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",ue),this.oUa(5)}if(8===this.Di.ve(cc.a.CIa,2,td))return this.Di.processAction(cc.a.j9a,
2),this.oUa(2);jd=32===this.Di.ve(cc.a.j0a,2,td)?1:6;return this.oUa(jd)};Q.prototype.Rdi=function(Fc){return Fc&&Fc.navigationId?!0:!1};Q.prototype.Mmi=function(Fc){switch(Fc.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};Q.prototype.oUa=function(Fc){return Promise.resolve(Fc)};Object(Oa.a)(Q,"CatchUpActivityNavigationManager",null,[689]);var Fe=b(474);Object(Oa.a)(M,"GetRelevantActivitiesDataRequest",null,[]);Object(Oa.a)(z,"Activity",null,[]);Object(Oa.a)(B,"ActivityFeedItem",
null,[]);Object(Oa.a)(E,"ActivityFeedPayload",null,[]);Object(Oa.a)(y,"ActivityRequestPayload",null,[]);Object(Oa.a)(t,"Person",null,[]);Am(u,z);Object(Oa.a)(u,"TaskActivity",z,[]);w.prototype.requestWYWAActivities=function(){var Fc=this;return this.B6a?new Promise(function(jd,td){v(Fc.$.na.ua,function(ue){ue=lc.a(ue)?null:ue.Result;ue=Object(Ob.a)(new y,{activities:[],actors:ue?Fc.Xfd(ue.WywaAuthors):null,hasMore:!1,highWaterline:w.f1a,lowWaterline:w.f1a,wywaWaterline:w.f1a});jd(ue)},function(){ib.ULS.sendTraceTag(537168022,
0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");td(null)},null,null)}):Promise.resolve(w.b6b)};w.prototype.requestActivities=function(){return Promise.resolve(w.b6b)};w.prototype.requestRelevantActivities=function(){var Fc=this;if(!this.$.ea.sc||this.$.ea.$4a)return ib.ULS.sendTraceTag(537168021,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.$.ea.sc,this.$.ea.$4a),
Promise.resolve(w.b6b);var jd=Object(Ob.a)(new M,{SetDaysBack:qb.AFrameworkApplication.ga.Dd("AppWaterlineOverrideDaysValue",0),SetTimestamp:qb.AFrameworkApplication.ga.Dd("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(td,ue){n(Fc.$.na.ua,jd,function(He){var bf=w.b6b;He?lc.a(He)?ib.ULS.sendTraceTag(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",ed.a.Wc(He.Errors)):bf=Fc.EVh(He.Result):ib.ULS.sendTraceTag(537168020,
3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");td(bf)},function(He){He=Mg.a.pg(He.data);ib.ULS.sendTraceTag(537168019,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",ed.a.Wc(He));ue(null)},null,null)})};w.prototype.requestActivityFeed=function(){var Fc=this;return tf.b(this.getActivityFeed()).then(function(jd){return Object(Ob.a)(new E,{activityFeedItems:Fc.ZKj(jd)})})};w.prototype.updateActivityState=
function(Fc){return nd.EwaSettings.ma(457)?Promise.resolve(!0):this.S1b?tf.b(this.S1b).then(function(jd){var td,ue;return tf.b(jd.kPj(Fc.itemIds,null!==(td=Fc.activityStatesToSet)&&void 0!==td?td:0,null!==(ue=Fc.activityStatesToReset)&&void 0!==ue?ue:0,Fc.resetUnseenCount))}):Promise.resolve(!1)};w.prototype.getActivityFeed=function(){return this.S1b?dh.a.AVd(this.S1b,function(Fc){return Fc.getActivityFeed(null)}):Zc.Task.Sa([])};w.prototype.EVh=function(Fc){if(!Fc)return ib.ULS.sendTraceTag(537168018,
3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object(Ob.a)(new y,{activities:[]});var jd=this.a$f(Fc.NewActivities,2);Fc=this.a$f(Fc.OutstandingActivities,3);Fc=El(Fc);for(var td=Fc.next();!td.done;td=Fc.next())jd.push(td.value);return Object(Ob.a)(new y,{activities:jd})};w.prototype.a$f=function(Fc,jd){jd=void 0===jd?1:jd;var td=[];if(!Fc||!Fc.length)return td;Fc=El(Fc);for(var ue=Fc.next();!ue.done;ue=Fc.next())if(ue=ue.value){var He=w.fLj(ue.Type);
6===He||7===He||9===He||8===He?td.push(Object(Ob.a)(new u,{activityId:ue.Id,type:He,displayTimestamp:new Date(ue.DisplayTimestamp),navigationId:ue.NavigationId,actors:this.Xfd(ue.People),relevancy:jd,relationship:this.eLj(ue.Relationship)})):td.push(Object(Ob.a)(new z,{activityId:ue.Id,type:He,displayTimestamp:new Date(ue.DisplayTimestamp),navigationId:ue.NavigationId,actors:this.Xfd(ue.People),relevancy:jd}))}else ib.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");
return td};w.prototype.eLj=function(Fc){switch(Fc){case 1:return 1;case 2:return 2;case 3:return 3}ib.ULS.sendTraceTag(537168016,0,10,"Unexpected Relationship.");return 1};w.prototype.ZKj=function(Fc){var jd=[];Fc=El(Fc);for(var td=Fc.next();!td.done;td=Fc.next())td=td.value,td=Object(Ob.a)(new B,{id:td.id,type:td.type,collectionId:td.collectionId,activityState:td.activityState,activityFeedItemPayload:td.activityFeedItemPayload,timestamp:td.timestamp}),jd.push(td);return jd};w.prototype.Xfd=function(Fc){var jd=
[];if(!Fc||!Fc.length)return jd;Fc=El(Fc);for(var td=Fc.next();!td.done;td=Fc.next())(td=td.value)&&jd.push(this.Xvb(td));return jd};w.prototype.Xvb=function(Fc){return Object(Ob.a)(new t,{id:Fc.Id,provider:Fc.Provider,displayName:Fc.DisplayName,email:Fc.Email,imageUrl:this.Rqc.QHa(Fc.Email,Fc.Provider,qb.AFrameworkApplication.oj,0),color:this.ZFb.rhd(new Fe.a(null,void 0,Fc.DisplayName),6)})};w.fLj=function(Fc){switch(Fc){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;
case 5:return 9;case 7:return 10;default:return ib.ULS.shipAssertTag(537168015,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}};w.f1a="<WywaWaterline>DefaultWaterline</WywaWaterline>";w.b6b=Object(Ob.a)(new y,{activities:[],actors:[],hasMore:!1,highWaterline:w.f1a,lowWaterline:w.f1a,wywaWaterline:w.f1a});Object(Oa.a)(w,"CatchUpActivityRequestManager",null,[690]);h.prototype.shouldShowEmptyExperienceButton=function(){if(!this.$.ea.f8a)return!1;
if(!nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5892442_CatchupEmptyExperienceNewContract")){var Fc=this.$.da.Aa(365);return!Fc||!Fc.isVisible}return!0};h.prototype.onButtonClick=function(){var Fc={};Fc=(Fc.InputMethod=jg.a.Ub,Fc);this.$.Ka.Xb(new ne.a(1834994092,jg.a.Ub,this.$.ed,16,null),Fc)};h.prototype.getExplanationText=function(){var Fc=this.$.da.Aa(365);return pe.a.instance.Wa(Fc&&Fc.isVisible?646:645)};h.prototype.getCommandName=function(){return pe.a.instance.fa(445)};Object(Oa.a)(h,"CatchUpEmptyExperienceBehaviorManager",
null,[691]);m.prototype.dispose=function(){jc.a(this.$).Vz(this)};m.prototype.Wf=function(Fc,jd){if(jd)return!1;Fc=document.getElementById("flyoutItem0");if(!Fc)return ib.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),!1;Fc.focus();this.Afh(Fc);return!0};m.prototype.ph=function(Fc){return this.uc?ae.DOMElementExtensions.Ff(this.uc,Fc):!1};m.prototype.Cj=function(){this.hasFocus=!0};m.prototype.Rj=function(){this.hasFocus=!1};m.prototype.Afh=function(Fc){if(Sys.Browser.agent===
Sys.Browser.Firefox){var jd=document.createEvent("KeyboardEvent");jd.initKeyEvent(dc.a.Yb,!0,!0,window.self,!1,!1,!1,!1,Od.a.HCc,0);Fc.dispatchEvent(jd)}else jd=document.createEvent("Events"),jd.initEvent(dc.a.Yb,!0,!0),jd.keyCode=Od.a.HCc,jd.which=Od.a.HCc,Fc.dispatchEvent(jd)};Ek.Object.defineProperties(m.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.$cf&&
!this.hasFocus}},we:{configurable:!0,enumerable:!0,get:function(){return vd.a.z_c}}});Object(Oa.a)(m,"FlyoutFocus",null,[444,3]);var hh=b(393);l.prototype.dispose=function(){this.njb=this.dzb=!1};l.prototype.registerButtonClickedEvent=function(Fc){this.buttonClickedCallback&&ib.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=Fc.buttonClickedCallback};l.prototype.onFlyoutInitialized=function(){this.dzb&&
ib.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");var Fc=(new Date).getTime()-this.PCh.getTime();ib.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",Fc);Jb.c(cc.a.WUg,!0,Jb.e,0,0,Fc);this.dzb=!0;hh.a.az&&hh.a.az.updateCommandUI(!0)};l.prototype.logFlightTriggers=function(){};l.prototype.toggleCatchUpFlyout=function(){this.dzb?this.buttonClickedCallback?this.buttonClickedCallback():ib.ULS.sendTraceTag(537168005,
3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):ib.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};l.prototype.onFlyoutVisibilityChanged=function(Fc){this.njb!==Fc.flyoutIsVisible&&(this.njb=Fc.flyoutIsVisible,hh.a.az&&hh.a.az.updateCommandUI(!0),this.njb||this.$Te&&this.$Te.sti())};Ek.Object.defineProperties(l.prototype,{$cf:{configurable:!0,enumerable:!0,get:function(){return this.njb}}});
Object(Oa.a)(l,"FlyoutRibbonButton",null,[714]);var Dg=b(572);Object(Oa.a)(f,"CatchUpConfiguration",null,[]);Object(Oa.a)(e,"SharedControllerFactoryParameters",null,[]);c.prototype.dispose=function(){this.UGa&&this.UGa.getWywaEvent().removeListener(this.cEf);this.UGa=this.$=null;ya.a.Ha(this.B_a);this.flyoutRibbonButton=this.flyoutFocus=this.c3d=this.Owe=this.Pwe=this.B_a=null};c.prototype.MSi=function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};c.prototype.Xti=function(){ib.ULS.sendTraceTag(589608192,
3012,50,"Catch Up script is loaded and Flyout is enabled.");this.Saf()&&ib.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")};c.prototype.$ri=function(Fc,jd){r("ScriptDownload");pc.TaskExtensions.Ba(Vb.GetServiceTaskFactory.Va(this.$.da,283,284,jd),function(td){Fc(tf.c(td.result.Jn.loadScript("catchUpActivity")))},this.$.da.la,3)};c.prototype.B6a=function(){return!!this.dkf&&this.dkf.B6a()&&this.$.ea.f8a};c.prototype.Saf=function(){return nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)};c.prototype.xGi=function(Fc){var jd=this;pc.TaskExtensions.Ba(Fc,function(){xb.a(function(){jd.UGa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object(Ob.a)(new e,{activityContentManager:Object(Cb.a)(688,jd.c3d),activityNavigationManager:Object(Cb.a)(689,jd.Owe),activityRequestManager:Object(Cb.a)(690,jd.Pwe),dataCulture:jd.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(Cb.a)(l,jd.flyoutRibbonButton),uiCulture:jd.$.ya.UICultureTag,ulsLogger:new Wd.a,emptyCatchUpBehaviorManager:Object(Cb.a)(691,
jd.emptyCatchUpBehaviorManager)}))});jd.B_a.zzg=jd.UGa.getActivityIndicatorTooltipManager();Dg.a(jd.$);jd.UGa.getWywaEvent().addListener(jd.cEf);r("InitializeCatchUpApp");jd.UGa.initialize(Object(Ob.a)(new f,{featuredActivityGroupsEnabled:!1,summaryStringEnabled:jd.B6a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel"),activityFeedDataEnabled:jd.Saf()}))},this.$.la,3)};Ek.Object.defineProperties(c.prototype,
{rbf:{configurable:!0,enumerable:!0,get:function(){var Fc=this.flyoutRibbonButton.dzb;Fc&&!this.n6e&&(ib.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),this.n6e=!0);return Fc}},Yei:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.$cf}}});Object(Oa.a)(c,"CatchUpActivityManager",null,[692,3]);var pg=Qa.a;Am(a,pg);a.prototype.create=function(){var Fc=this;pc.TaskExtensions.Ba(Vb.GetServiceTaskFactory.Va(this.$.da,458,459,this.ub),function(jd){jd=
jd.result;Fc.Eb(Fc.$.da.Aa(286)||new c(Fc.$,Fc.ub,null,jd))},this.$.la,3)};a.ka=function(Fc){Fc.da.Ga(287,new a(Fc))};Object(Oa.a)(a,"CatchUpActivityManagerFactory",Qa.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");sa.a.Fa(yc.ka);sa.a.Fa(Qb.ka);sa.a.Fa(jb.ka);sa.a.Fa(I.ka);Xe.a.Ki('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){sa.a.Fa(function(Fc){lb.ka(Fc);Aa.ka(Fc);cb.ka(Fc);Gb.ka(Fc);rc.ka(Fc)})})();Type.registerNamespace("Common.App.CatchUpActivity");ma.main();(function(){sa.a.Fa(function(Fc){r("Begin");a.ka(Fc);W.ka(Fc)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.catchup.js.map/f27b6e0854a8f02d2ba68f1ab50bc496/EwaDS.catchup.js.map