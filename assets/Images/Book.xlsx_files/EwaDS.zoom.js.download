(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[39],{1467:function(x,C,b){function a(Aa){var qa=Nb.call(this)||this;qa.$=Aa;qa.Tb();return qa}function c(Aa){var qa=lb.call(this,Aa)||this;qa.nBb=null;qa.rxa=null;qa.zoomEventManager=null;qa.sBb=-1;qa.Tcf=!1;qa.kd=function(){qa.sBb=-1};n.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");qa.Qfb=new e(Aa);qa.BXi()&&(n.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),qa.HLg());
qa.R8i();return qa}function e(Aa){var qa=kb.call(this)||this;qa.statusBarManager=null;qa.WUe=!1;qa.$=Aa;qa.$.da.$a(29,function(Xa){qa.statusBarManager=Xa;Xa.yJ(qa)});return qa}function f(){return Sa.call(this)||this}function l(Aa){this.G5a=this.Zec=0;this.c2b=null;this.Wcf=!1;this.$=Aa;this.Wcf=Aa.Mic}function m(Aa){return M.call(this,Aa)||this}function r(Aa){this.$=Aa}b.r(C);var h=b(11);x=b(0);var w=b(906),n=b(14),v=b(1032),u=b(9),t=b(79),y=b(186),E=b(389),B=b(33),z=b(55);r.prototype.Zc=function(){return!1};
r.prototype.executeCommand=function(Aa,qa,Xa){var Ha=!1;Aa=qa.command;var Ra=B.a(this.$);11!==qa.Ye&&7!==qa.Ye&&6!==qa.Ye&&2!==qa.Ye&&14!==qa.Ye&&15!==qa.Ye&&16!==qa.Ye&&n.ULS.sendTraceTag(537149787,0,15,"ZoomCommandHandler.ExecuteCommand - unsupported zoom origin {0}",qa.Ye);var mb=6===qa.Ye;switch(qa.command){case -1365094462:case -1441674458:Ra.HDc(Math.floor(10*Ra.zoom)/10+.1,mb);Ha=!0;break;case 1056010365:case 1664364901:Ra.HDc(Math.ceil(10*Ra.zoom)/10-.1,mb);Ha=!0;break;case 346087880:Ra.HDc(u.a.V_,
mb);Ha=!0;break;case -1918142559:case 1517993347:t.a.ld in Xa?(Xa=parseFloat(Xa[t.a.ld]),Xa!==Ra.zoom&&Ra.GDc(Xa,1517993347===qa.command),Ha=!0):n.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:qa=parseFloat(Xa[v.a.Value]);isNaN(qa)||Ra.GDc(qa/100,!0);Ha=!0;break;case 1409187195:Ra.zoomFitToScreen();Ha=!0;break;case -1836771825:Ra.zoomFitToScreenUndo(),Ha=!0}return Ha?z.Task.Sa(!0):y.a(Aa)};r.prototype.Lc=function(Aa,
qa){switch(qa.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return B.a(this.$).RX();case -1365094462:case 1056010365:case -2096586688:return E.a(this.$);default:return!1}};r.prototype.jd=function(){return!1};Object(x.a)(r,"ZoomCommandHandler",null,[429]);var M=w.a;Am(m,M);m.prototype.Nd=function(){this.Cd([new r(this.$)])};m.ka=function(Aa){w.a.fe(370,new m(Aa))};Object(x.a)(m,"ZoomCommandHandlerFactory",
w.a,[]);C=b(228);var Q=b(90),P=b(24),L=b(85),ca=b(607),U=b(48),aa=b(5),F=b(166),D=b(63),J=b(303),R=b(131),Z=b(46),W=b(37),ka=b(12),ma=b(10),pa=b(104),xa=b(105),va=b(22),ta=b(318),fa=b(132);l.prototype.Thi=function(){return va.g(this.$).isEditing?(n.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.zb.Kz?(n.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),
!1):!0};l.prototype.jKi=function(Aa){this.c2b=new Sys.UI.Point(Math.round(Aa.Sua.center.x),Math.round(Aa.Sua.center.y));this.Zec=B.a(this.$).zoom;this.G5a=Aa.Sua.scale;var qa={};qa=(qa.InitialZoom=this.Zec,qa.Location="canvas",qa.InputMethod=Aa.yb,qa);fa.b(this.$).Vd(R.a.AXi,qa);n.ULS.sendTraceTag(537149793,0,50,"PinchToZoomAdapter.OnGestureStart starting gesture. center ({0},{1}), initial zoom {2}, initial scale {3}",this.c2b.x,this.c2b.y,this.Zec,this.G5a);this.G8a(Aa,"onGestureStart");return!0};
l.prototype.iKi=function(Aa){if(!this.G5a)return n.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.G8a(Aa,"OnGestureEvent"),!0;if(!isFinite(this.G5a))return n.ULS.sendTraceTag(537149791,0,15,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale={0}",this.G5a),this.G8a(Aa,"OnGestureEvent"),!0;var qa=Aa.Sua.scale/this.G5a*this.Zec;B.a(this.$).Fgg(qa,this.c2b);n.ULS.sendTraceTag(537149790,0,50,"PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom {0}. Current scale {1}",
qa,Aa.Sua.scale);this.G8a(Aa,"OnGestureEvent");return!0};l.prototype.hKi=function(Aa){B.a(this.$).Ggg();n.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.G8a(Aa,"OnGestureEnd")};l.prototype.gKi=function(Aa){n.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.G8a(Aa,"OnGestureCancel")};l.prototype.G8a=function(Aa,qa){var Xa,Ha,Ra;this.Wcf&&(n.ULS.sendTraceTag(536990857,0,50,"PinchToZoomAdapter.markGestureEventAsHandled - Invoked from {0},        eventArgs non-null: {1}, gestureData non-null: {2},        srcEvent non-null: {3}",
qa,isNullOrUndefined(Aa),isNullOrUndefined(null===Aa||void 0===Aa?void 0:Aa.Sua),isNullOrUndefined(null===(Xa=null===Aa||void 0===Aa?void 0:Aa.Sua)||void 0===Xa?void 0:Xa.srcEvent)),null===(Ra=null===(Ha=null===Aa||void 0===Aa?void 0:Aa.Sua)||void 0===Ha?void 0:Ha.srcEvent)||void 0===Ra?void 0:Ra.preventDefault())};Object(x.a)(l,"PinchToZoomAdapter",null,[597]);var Ca=b(38),Sa=Ca.a;Am(f,Sa);f.prototype.noe=function(Aa){this.addHandler("ZCIEK",Aa)};f.prototype.uQf=function(Aa){this.removeHandler("ZCIEK",
Aa)};f.prototype.moe=function(Aa){this.addHandler("ZCUIK",Aa)};f.prototype.tQf=function(Aa){this.removeHandler("ZCUIK",Aa)};f.prototype.kHg=function(Aa){this.addHandler("ZCEK",Aa)};f.prototype.Jcj=function(Aa){this.removeHandler("ZCEK",Aa)};f.prototype.L3i=function(){this.raiseEvent("ZCIEK")};f.prototype.K3i=function(){this.raiseEvent("ZCUIK")};f.prototype.M3i=function(){this.raiseEvent("ZCEK")};Object(x.a)(f,"ZoomEventManager",Ca.a,[596]);var Gb=b(21),kb=Ca.a;Am(e,kb);e.prototype.Aq=function(Aa){this.addHandler("Zoom",
Aa)};e.prototype.Wq=function(Aa){this.removeHandler("Zoom",Aa)};e.prototype.Oz=function(){this.vn("QueryZoomStatus")&&this.raiseEvent("Zoom")};e.prototype.es=function(Aa,qa){return"QueryZoomStatus"!==Aa?!1:this.t3h(qa)};e.prototype.vn=function(){return B.a(this.$).RX()};e.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.SF(this),this.statusBarManager=null);this.$=null;kb.prototype.dispose.call(this)};e.prototype.M3e=function(Aa){Aa=this.U_h(Aa);if(!Aa)return null;Aa=Aa.getElementsByClassName("cui-ctl-mediumlabel");
return 1!==Aa.length?(n.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):Aa[0]};e.prototype.t3h=function(Aa){if(!this.$)return!1;var qa=B.a(this.$).tPb,Xa=this.M3e("HandleQueryZoomStatusCommand");Xa?Gb.a.equals(Aa.LabelText.toString(),qa,!1)||(Xa.innerText="",this.CZf(Aa,qa)):this.CZf(Aa,qa);return!0};e.prototype.CZf=function(Aa,qa){Aa.LabelText=qa};e.prototype.U_h=function(Aa){var qa=ka.DOMElementExtensions.getElementById(this.$.domElement,
"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!qa)return qa=(qa=this.$.ea.xc)?qa.inEmbedView:!1,P.a.rp||qa||n.ULS.sendTraceTag(537149763,0,15,"ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from {0}",Aa),null;this.WUe||(this.WUe=!0,n.ULS.sendTraceTag(537149762,0,50,"ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from {0}",Aa));return qa};Object(x.a)(e,"ZoomStatusBarManager",Ca.a,[3,483,271]);var lb=ca.a;Am(c,lb);c.prototype.dispose=function(){this.Qfb&&
(Q.a.Ha(this.Qfb),this.Qfb=null);this.zoomEventManager&&(this.$.da.ZU(419),this.zoomEventManager=null);this.Tcf&&this.geh();lb.prototype.dispose.call(this)};c.prototype.RX=function(){return!0};c.prototype.Fgg=function(Aa,qa){Aa=this.Gua(Aa);if(va.g(this.$).rtl){var Xa=Math.round(ka.DOMElementExtensions.getBounds(this.$.Lf).width*B.a(this.$).zoom);this.nBb=new Sys.UI.Point(Xa-qa.x,qa.y)}else this.nBb=qa;this.zAa(Aa,!1,"ZoomWithPinch")};c.prototype.FDc=function(){return!0};c.prototype.EDc=function(Aa,
qa){var Xa=P.a.isMac?.07:.15;Aa=this.zoom+(Aa?Xa:-Xa);Aa=this.Gua(Aa);va.g(this.$).rtl?(Xa=Math.round(ka.DOMElementExtensions.getBounds(this.$.Lf).width*B.a(this.$).zoom),this.rxa=new Sys.UI.Point(Xa-qa.x,qa.y)):this.rxa=qa;qa=this.zoom;this.zAa(Aa,!0,"ZoomWithMouse");Xa={};qa=(Xa.InitialZoom=qa,Xa.FinalZoom=Aa,Xa.Location="canvas",Xa);fa.b(this.$).Vd(R.a.CXj,qa)};c.prototype.Ggg=function(){this.nBb=null};c.prototype.GDc=function(Aa,qa){this.zAa(this.Gua(Aa),!1,qa?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")};
c.prototype.Hgg=function(Aa){isNaN(Aa)?n.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.zAa(this.Gua(Aa),!1,"ZoomToLevelInExcelLive")};c.prototype.Igg=function(Aa){this.zAa(this.Gua(Aa),!1,"ZoomWithActionPen")};c.prototype.HDc=function(Aa,qa){this.zAa(this.Gua(Aa),!0,qa?"ZoomWithShortcuts":"ZoomWithButtons")};c.prototype.K1e=function(Aa,qa){var Xa=va.g(this.$).rtl,Ha=El(this.Sfd(Xa));Xa=Ha.next().value;Ha=Ha.next().value;
var Ra=El(this.Bhd(Aa,Ha)),mb=Ra.next().value;Ra=Ra.next().value;return this.rxa?(Aa=this.yfd(this.rxa,Aa,qa,Ha,Xa,"ZoomWithMouse"),this.rxa=null,Aa):this.nBb?this.yfd(this.nBb,Aa,qa,Ha,Xa,"ZoomWithPinch"):va.g(this.$).ha.Oa.m5?this.BXj(Aa,qa,Ha,Xa,mb,Ra,va.g(this.$).rtl):this.DXj(Aa,qa,Ha,Xa,mb,Ra,va.g(this.$).rtl)};c.prototype.bWf=function(Aa,qa,Xa){Aa?(n.ULS.sendTraceTag(537149782,0,50,"Zoom To: ({0} {1}) (new top-left) from zoom:{2} to zoom:{3}",Aa.x,Aa.y,qa,Xa),Aa=new U.a(Aa.x,Aa.y),Xa=va.g(this.$).rtl,
Xa=El(this.Sfd(Xa)),Xa.next(),Xa=Xa.next().value,Xa=El(this.Bhd(qa,Xa)),qa=Xa.next().value,Xa=Xa.next().value,va.g(this.$).Ooe(Aa,qa,Xa,xa.a.are)):n.ULS.sendTraceTag(537149781,0,50,"Zooming top-left: from zoom:{0} to zoom:{1}",qa,Xa)};c.prototype.zoomFitToScreen=function(){var Aa=this.zoom,qa=va.g(this.$).rtl,Xa=El(this.Sfd(qa)),Ha=Xa.next().value,Ra=Xa.next().value,mb=El(this.Bhd(Aa,Ra));Xa=mb.next().value;var La=mb.next().value;(qa=(mb=va.g(this.$).ha.Oa.m5)?this.cZe(this.r$a,Xa,La,!1):this.R1e(this.r$a,
Ra,Ha,Xa,La,qa,!1))?(qa=Math.min(Xa/(qa.width+100),La/(qa.height+100)),qa=this.XBh(qa),this.zAa(qa,!0,"ZoomWithFitToScreen"),mb?va.g(this.$).ha.Oa.Isa(va.g(this.$).ha.Oa.oc,!1):(qa=Z.v(va.g(this.$).ha.sa.activeRange,this.$),va.g(this.$).Gg(qa,null,null,null,3,xa.a.Bgg)),this.sBb=Aa,this.Tcf||this.ELg()):n.ULS.sendTraceTag(537149780,0,15,"ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: {0}",mb)};c.prototype.zoomFitToScreenUndo=function(){this.zAa(this.sBb,!1,"ZoomWithFitToScreen")};
c.prototype.vRd=function(){return-1!==this.sBb};c.prototype.ELg=function(){var Aa=va.g(this.$);Aa&&(Aa.ha.SG(this.kd),Aa.nE(this.kd))};c.prototype.geh=function(){var Aa=va.g(this.$);Aa&&(Aa.ha.WF(this.kd),Aa.UF(this.kd))};c.prototype.XBh=function(Aa){Aa=Math.min(Aa,u.a.dzi);Aa=Math.max(Aa,u.a.Xzi);return Math.round(100*Aa)/100};c.prototype.zAa=function(Aa,qa,Xa){if(this.CDc()){var Ha=va.g(this.$).view.visibleArea.toString();Aa=this.Gua(Aa);var Ra=D.d(this.$.xa.qa);Ra||(Ra=ca.a.zrf);va.g(this.$).Ji.K7(5,
ta.a.BDc,Xa);va.g(this.$).Ji.ola(ta.a.BDc,this.$.ea.rf);n.ULS.sendTraceTag(537149779,0,50,"ZoomManager.SetNewZoomLevel Setting zoom {0} to sheet {1} origin {2} prevZoom {3}",Aa,Ra,Xa,this.zoom);this.dtj(Ra,Aa);this.zoomEventManager.M3i();this.xLj(Xa);this.GLj(qa);this.sBb=-1;E.b(this.$,Xa);n.ULS.sendTraceTag(537149778,0,50,"ZoomManager.SetNewZoomLevel OldGridVisibleArea: {0}, NewGridVisibleArea: {1}, IsShyRibbonActive: {2}",Ha,va.g(this.$).view.visibleArea.toString(),this.$.Kka)}};c.prototype.oLh=
function(Aa){return(Aa=ma.HelperMethods.QC(this.$.Lf,this.$.domElement,Aa))?Aa:new Sys.UI.Point(0,0)};c.prototype.Sfd=function(Aa){var qa=this.oLh(Aa);Aa=this.aQh(qa,Aa);return[qa,Aa]};c.prototype.Bhd=function(Aa,qa){var Xa=ka.DOMElementExtensions.getBounds(this.$.Lf);return[Math.round((Xa.width-qa.x)*Aa),Math.round((Xa.height-qa.y)*Aa)]};c.prototype.aQh=function(Aa,qa){qa=ma.HelperMethods.QC(va.g(this.$).domElement,this.$.domElement,qa);return qa?(Aa=new Sys.UI.Point(Math.round(qa.x-Aa.x),Math.round(qa.y-
Aa.y)),Aa):new Sys.UI.Point(0,0)};c.prototype.DXj=function(Aa,qa,Xa,Ha,Ra,mb,La){return(La=this.R1e(Aa,Xa,Ha,Ra,mb,La))?this.R0e(La,Aa,qa,Xa,Ha,Ra,mb):null};c.prototype.R1e=function(Aa,qa,Xa,Ha,Ra,mb,La){La=void 0===La?!0:La;var ha=Z.F(va.g(this.$).ha.sa.selectedRanges);if(La&&(ha=ha.Me(Z.F(va.g(this.$).Fcc())),!ha))return n.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;var Ia=va.g(this.$).kc(ha.topLeft);ha=va.g(this.$).kc(ha.bottomRight);
if(!Ia||!ha)return n.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;Aa=Ia.cell.mK===ha.cell.mK&&Ia.cell.lK===ha.cell.lK?this.gKh(Aa,ha,qa,Xa,Ha,mb):this.JZh(Aa,Ia,ha,qa,Xa,Ha,mb);return Aa?La?this.STe(Aa,Ha,Ra):Aa:(n.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)};c.prototype.STe=function(Aa,qa,Xa){if(0>Aa.x||Aa.x>qa)Aa.x=0;if(0>Aa.y||Aa.y>
Xa)Aa.y=0;Aa.x+Aa.width>qa&&(Aa.width=qa-Aa.x);Aa.y+Aa.height>Xa&&(Aa.height=Xa-Aa.y);return Aa};c.prototype.JZh=function(Aa,qa,Xa,Ha,Ra,mb,La){qa=va.g(this.$).getCellBounds(qa.cell);if(!qa)return null;var ha=va.g(this.$).getCellBounds(Xa.cell);if(!ha)return null;var Ia=Ra.x;La&&(Ia=0,qa.x=Math.round(mb/Aa)-qa.x-Math.round(qa.width),ha.x=Math.round(mb/Aa)-ha.x-Math.round(ha.width));Aa=new Sys.UI.Bounds(Math.round((qa.x-Ha.x)*Aa)-Ia,Math.round((qa.y-Ha.y)*Aa-Ra.y),Math.round((ha.x+ha.width-qa.x)*Aa),
Math.round((ha.y+ha.height-qa.y)*Aa));n.ULS.sendTraceTag(537149774,0,50,"ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:{0}, b:{1}, r:{2}, l:{3}) in bounds ({4}, {5}, {6}, {7})",Xa.cell.getRange().top,Xa.cell.getRange().bottom,Xa.cell.getRange().right,Xa.cell.getRange().left,Aa.x,Aa.y,Aa.width,Aa.height);return Aa};c.prototype.gKh=function(Aa,qa,Xa,Ha,Ra,mb){var La=va.g(this.$).getCellBounds(qa.cell);if(!La)return null;var ha=Ha.x;mb&&(ha=
0,La.x=Math.round(Ra/Aa)-La.x-Math.round(La.width));Aa=new Sys.UI.Bounds(Math.round((La.x-Xa.x)*Aa)-ha,Math.round((La.y-Xa.y)*Aa-Ha.y),Math.round(La.width*Aa),Math.round(La.height*Aa));n.ULS.sendTraceTag(537149773,0,50,"ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:{0}, l:{1}) in bounds ({2}, {3}, {4}, {5})",qa.cell.getRange().top,qa.cell.getRange().left,Aa.x,Aa.y,Aa.width,Aa.height);return Aa};c.prototype.BXj=function(Aa,qa,Xa,Ha,Ra,mb){var La=this.cZe(Aa,Ra,
mb);return La?this.R0e(La,Aa,qa,Xa,Ha,Ra,mb):null};c.prototype.R0e=function(Aa,qa,Xa,Ha,Ra,mb,La){Aa=new Sys.UI.Point(this.p1e(mb,Aa.x,Aa.width),this.p1e(La,Aa.y,Aa.height));return this.yfd(Aa,qa,Xa,Ha,Ra)};c.prototype.p1e=function(Aa,qa,Xa){return Aa===Xa?(n.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),Aa/2):Aa*qa/(Aa-Xa)};c.prototype.cZe=function(Aa,qa,Xa,Ha){Ha=void 0===Ha?!0:Ha;var Ra=va.g(this.$).ha.Oa.oc.domElement,
mb=ma.HelperMethods.QC(Ra,va.g(this.$).domElement,va.g(this.$).rtl);if(!mb)return n.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;var La=va.g(this.$).uwb();mb=new Sys.UI.Point(Math.round((mb.x-La.topLeft.x)*Aa),Math.round((mb.y-La.topLeft.y)*Aa));Aa=new Sys.UI.Bounds(mb.x,mb.y,Math.round(Ra.offsetWidth*Aa),Math.round(Ra.offsetHeight*Aa));return Ha?this.STe(Aa,qa,Xa):Aa};c.prototype.Wrf=function(){this.Qfb.Oz()};c.prototype.JDi=function(Aa){"ZoomToLevelInExcelLive"===
Aa?this.zoomEventManager.L3i():this.zoomEventManager.K3i()};c.prototype.R8i=function(){this.zoomEventManager=this.$.da.Ga(419,new f)};c.prototype.yfd=function(Aa,qa,Xa,Ha,Ra,mb){mb=void 0===mb?"":mb;var La=va.g(this.$).rtl?0:Ra.x;Ra="ZoomWithPinch"===mb||"ZoomWithMouse"===mb?new Sys.UI.Point(Aa.x-La-Math.round(Ha.x*qa),Aa.y-Ra.y-Math.round(Ha.y*qa)):Aa;Ra=new Sys.UI.Point(Math.round(Ra.x/qa),Math.round(Ra.y/qa));n.ULS.shipAssertTag(537149770,0,!!qa,"Original zoom level must be different than 0");
La=Xa/qa;Ra=new Sys.UI.Point(Math.round(Ra.x*(1-1/La)),Math.round(Ra.y*(1-1/La)));"ZoomWithMouse"===mb||"ZoomWithPinch"===mb?(Ra.x+=Math.round((Ha.x-va.g(this.$).AI)*(La-1)),Ra.y+=Math.round((Ha.y-va.g(this.$).KJ)*(La-1))):(La=Math.round(Ha.x*(Xa-qa)),0<La&&Ra.x>La&&(Ra.x+=La),qa=Math.round(Ha.y*(Xa-qa)),0<qa&&Ra.y>qa&&(Ra.y+=qa));"ZoomWithMouse"===mb&&(Aa.x||(Ra.x=0),Aa.y||(Ra.y=0));Aa=va.g(this.$).uwb();return new Sys.UI.Point(Ra.x+Aa.topLeft.x,Ra.y+Aa.topLeft.y)};c.prototype.HLg=function(){var Aa=
this,qa=[];L.a.instance.lc("Common.IGestureInputManager").execute(function(Xa){0===Xa.BPh()&&Xa.C7i(document.body,new l(Aa.$),qa)})};c.prototype.BXi=function(){return this.CDc()&&(P.a.pp&&P.a.bMa(67)||this.$.Mic)};c.prototype.dtj=function(Aa,qa){E.a(this.$)?this.setZoomLevel(Aa,qa,this.W_d,u.a.LHf):this.setZoomLevel(Aa,qa,this.zoomPerSheetId,this.r$a)};c.prototype.setZoomLevel=function(Aa,qa,Xa,Ha){Xa.remove(Aa);qa!==Ha&&Xa.add(Aa,qa)};c.prototype.xLj=function(Aa){this.t_f();this.$.vza(J.a.PZ("TriggerImmediateZoomOperations"));
this.jTj();this.JDi(Aa)};c.prototype.jTj=function(){this.sli()?this.$.Bf():this.Qfb.Oz();var Aa=this.Qfb.M3e("UpdateZoomStatusBar");Aa&&(Aa.innerText=this.tPb)};c.prototype.sli=function(){var Aa=F.a(this.$);return Aa?Aa.Vm.Gp===(W.a.Wwa(this.$)?aa.a.trc:this.$.Mb+aa.a.DTf):!1};c.prototype.GLj=function(Aa){va.g(this.$).AXj(Aa);this.UHg()};c.prototype.UHg=function(){var Aa=pa.a(this.$);if(Aa)for(var qa=El(va.g(this.$).Ea.hF()),Xa=qa.next();!Xa.done;Xa=qa.next())if(Xa=Xa.value,!Xa)n.ULS.sendTraceTag(537149768,
0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");else{if(Xa.mk&&(Xa=Xa.aj))for(var Ha=0;Ha<Xa.count;Ha++)if(2===Xa.hg(Ha).type){var Ra=Aa.Hq(Xa.hg(Ha).Vg());Ra?(Ra.uea(!1),n.ULS.sendTraceTag(537149766,0,50,"ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom {0}",this.zoom)):n.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else n.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")};
Object(x.a)(c,"ZoomManager",ca.a,[]);var Nb=C.a;Am(a,Nb);a.prototype.create=function(){var Aa=new c(this.$);this.lTj(Aa);this.Eb(Aa)};a.prototype.lTj=function(Aa){var qa=B.a(this.$);if(qa){var Xa=qa.Ihd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");Aa.IPd(Xa);Aa.Ouc(qa.qBc)}else n.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")};
a.ka=function(Aa){Aa.da.Ga(369,new a(Aa))};Object(x.a)(a,"ZoomManagerFactory",C.a,[]);b=b(557);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(function(){h.a.Fa(function(Aa){a.ka(Aa);m.ka(Aa)})})();b.a.Ki(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.zoom.js.map/db749d67c9b82fac74c7b97fd5358474/EwaDS.zoom.js.map