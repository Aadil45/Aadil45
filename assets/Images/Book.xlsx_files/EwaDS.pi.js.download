(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[18],{1061:function(x,C,b){function a(u){var t=this;this.businessBar=this.R7a=null;this.fGi=function(y,E){E.O6c?t.hGi(E):t.gGi(E)};this.Th=function(y,E){y=E.context.methodName;t.R7a&&y===t.R7a&&(l.ULS.sendTraceTag(537155230,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "{0}" has now succeeded. Querying local storage for BB showings.',t.R7a),t.m8a(a.eKb,!0),t.R7a=null);t.Wlf(!1);t.E3b=!1};this.Un=function(y,
E){r.a.nh(E.errors,[-1387426400])&&!t.E3b&&(t.E3b=!0,t.H1f()&&window.performance.mark(a.Rsf),(new c(t)).pqi())};this.Jg=function(){t.Wlf(!0);t.m8a(a.gDb,!1);t.m8a(a.eKb,!1)};this.Bya=function(){l.ULS.sendTraceTag(537155225,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");t.m8a(a.gDb,!0)};this.$=u;this.na=this.$.na;this.localStorage=new w.a;this.E3b=!1;this.$.ea.Fl(this.Jg);this.na.qf.znb(this.Bya);this.na.Bq(this.Th);this.$.da.$a(5,
function(y){t.businessBar=y;y.FDg(t.fGi)});this.na.dz(this.Un)}function c(u){var t=this;this.Bkd=[n.a.ihg,n.a.cEc];this.ko=function(y,E){t.oO[E]=y;t.$4h()&&t.sej("OnNetworkDownImmediatePing"===y.caller)};this.Ala=u;this.$=u.$;this.oO={}}function e(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}b.r(C);x=b(0);var f=b(7),l=b(14),m=b(332),r=b(30),h=b(10),w=b(322);Object(x.a)(e,"ConnectionErrorLogInfo",null,[]);var n=b(1280),v=b(1324);c.prototype.pqi=function(){var u=v.a.ycd(this.ko,
"OnNetworkDownImmediatePing",this.$,this.Bkd);u=El(u);for(var t=u.next();!t.done;t=u.next())t.value.runTest()};c.prototype.$4h=function(){for(var u=El(this.Bkd),t=u.next();!t.done;t=u.next())if(t=t.value,void 0===this.oO[t]||null===this.oO[t])return!1;return!0};c.prototype.sej=function(u){var t=this.$.qf.$V;u&&this.jFj(t);u=El(this.Bkd);for(var y=u.next();!y.done;y=u.next())y=y.value,this.oO[y]=Sys.Serialization.JavaScriptSerializer.serialize(this.oO[y]);u=Date.now();y=this.Ala.hhd(b(1061).NetworkConnectionHealthChecker.gDb).returnValue;
var E=this.Ala.hhd(b(1061).NetworkConnectionHealthChecker.eKb).returnValue;this.oO.isOfflineMode=t;this.oO.networkDownBBAge=-1===y?y:u-y;this.oO.transientServerCommunicationFailuresBBAge=-1===E?E:u-E;this.Ala.businessBar?(this.oO.isNetworkDownBBShown=this.Ala.businessBar.sC(54).toString(),this.oO.isServerErrorBBShown=this.Ala.businessBar.sC(21).toString()):(this.oO.isNetworkDownBBShown="unknown",this.oO.isServerErrorBBShown="unknown");l.ULS.sendTraceTag(537155224,0,50,"ConnectionHealthTestsRunner.ReportPingResults: {0}",
Sys.Serialization.JavaScriptSerializer.serialize(this.oO))};c.prototype.jFj=function(u){for(var t=b(1061).NetworkConnectionHealthChecker,y={},E=El(Object.keys(this.oO)),B=E.next();!B.done;B=E.next())B=this.oO[B.value],y[B.testName]=B.isSuccess;y.isOfflineMode=u;this.Ala.fUd(t.j2c,Sys.Serialization.JavaScriptSerializer.serialize(y))};Object(x.a)(c,"ConnectionHealthTestsRunner",null,[]);b.d(C,"NetworkConnectionHealthChecker",function(){return a});a.prototype.dispose=function(){this.$&&(this.$.ea&&this.$.ea.Wn(this.Jg),
this.na&&(this.na.qf.kIb(this.Bya),this.na.Wz(this.Un),this.na.Dr(this.Th)))};a.prototype.hGi=function(u){var t={};t.Timestamp=Date.now().toString();switch(u.FGa){case 21:this.R7a=u.data.FailedMethod;t.FailedMethod=this.R7a;this.fUd(a.eKb,JSON.stringify(t));break;case 54:this.fUd(a.gDb,JSON.stringify(t))}};a.prototype.gGi=function(u){switch(u.FGa){case 21:this.m8a(a.eKb,!0);break;case 54:this.m8a(a.gDb,!0)}};a.prototype.fUd=function(u,t){try{this.localStorage.tg()&&this.localStorage.setItem(u,t)}catch(y){l.ULS.sendTraceTag(537155231,
0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: {0}",y.message||"Unknown")}};a.prototype.hhd=function(u){if(this.localStorage.tg()&&(u=this.localStorage.Hvb(u))&&"null"!==u){var t=JSON.parse(u);u=parseInt(t.Timestamp,10);t=Sys.Serialization.JavaScriptSerializer.serialize(t);return{returnValue:u,rawData:t}}return{returnValue:-1,rawData:null}};a.prototype.Wlf=function(u){if(this.localStorage.tg()){var t=this.localStorage.Hvb(a.j2c);if(t&&"null"!==
t){var y=-1;this.E3b&&(y=this.tNh(a.Rsf,a.TEi));l.ULS.sendTraceTag(537155229,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: {0}, Period offline: {1}, New session: {2}",Sys.Serialization.JavaScriptSerializer.serialize(t),y,u);this.localStorage.removeItem(a.j2c)}}};a.prototype.tNh=function(u,t){if(!this.H1f())return-1;window.performance.measure(t,u);u=window.performance.getEntriesByName(t);return u.length&&u[u.length-1]?u[u.length-1].duration:(l.ULS.sendTraceTag(537155228,
0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name {0} returned no measures.",t),-1)};a.prototype.m8a=function(u,t){try{var y=this.hhd(u);var E=y.rawData;var B=y.returnValue;if(-1!==B){var z=Object(f.a)(new e,{timeElapsed:Date.now()-B,scenario:u,isNewSession:!t,rawData:E});l.ULS.sendTraceTag(537155227,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: {0}",JSON.stringify(z))}this.localStorage.removeItem(u)}catch(M){l.ULS.sendTraceTag(537155226,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: {0}",
M.message||"Unknown")}};a.prototype.H1f=function(){return h.HelperMethods.OYc&&m.a.cpb};a.gDb="NetworkDownBBShown";a.eKb="ServerCommunicationFailureBBShown";a.j2c="ConnectionHealthPingRsults";a.Rsf="offMoStMa";a.TEi="offMoDuMea";Object(x.a)(a,"NetworkConnectionHealthChecker",null,[3])},1280:function(x,C,b){function a(){}b.d(C,"a",function(){return a});x=b(0);a.cEc="b-ring_Apc_Trans";a.ihg="cdn_static_resource_ewa_image";Object(x.a)(a,"ResourceHosts",null,[])},1324:function(x,C,b){function a(){}function c(h,
w,n,v,u){this.url="";this.E5a=!1;this.X7=-1;this.testIteration=0;this.baseUrl=n;this.avf=v;this.tkd=w;this.result=new e(w,u)}function e(h,w){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=h;this.caller=w;this.reset()}x=b(0);var f=b(56),l=b(14),m=b(260);e.prototype.reset=function(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage=
"";this.reqTotalDurationMs=-1;this.browserResourceTiming=null};Object(x.a)(e,"NetworkTestResult",null,[]);var r=b(642);c.prototype.runTest=function(){try{if(this.E5a)return l.ULS.sendTraceTag(537155206,0,50,"NetworkTestReq.RunTest: a test for the host {0} is already mid way, not starting a new one.",this.tkd),!1;this.reset();this.E5a=!0;this.result.startTimeMs=Date.now();var h=new m.QueryStringBuilder(this.baseUrl);h.J9("tid",this.result.startTimeMs.toString());this.url=h.toString();this.Qlj();this.testIteration++;
this.result.testIteration=this.testIteration;return!0}catch(w){return this.Stb("Exeption: "+w.message),!1}};c.prototype.reset=function(){this.url="";this.result.reset();this.E5a=!1;this.X7=-1};c.prototype.clearTimeout=function(){-1!==this.X7&&(window.clearTimeout(this.X7),this.X7=-1)};c.prototype.Qlj=function(){var h=this;try{var w=new XMLHttpRequest;w.onreadystatechange=function(){4===w.readyState&&(200===w.status?h.sBh():h.Stb(String.format("Error when downloading resource. status code: {0}, status text: {1}",
w.status,w.statusText),w.status.toString()))};w.onerror=function(){h.Stb(String.format("Client error when attempting to download resource. status code: {0}, response: {1}",w.status,w.statusText))};this.X7=window.setTimeout(function(){h.X7=-1;h.Stb("Request timeout")},1E4);w.open("GET",this.url,!0);w.send(null)}catch(n){this.Stb("Exeption: "+n.message)}};c.prototype.sBh=function(){this.E5a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=
r.a(this.url),this.result.isSuccess=!0,this.r3b())};c.prototype.Stb=function(h,w){w=void 0===w?null:w;this.E5a&&(this.clearTimeout(),this.result.errorMessage=h,this.result.isSuccess=!1,this.result.errorStatusCode=w,this.r3b())};c.prototype.r3b=function(){this.E5a=!1;this.avf&&this.avf(this.result,this.tkd)};Object(x.a)(c,"NetworkTestReq",null,[]);b.d(C,"a",function(){return a});a.ycd=function(h,w,n,v){v=void 0===v?null:v;a.Vlc||(a.Vlc=Array.isArray(f.a.mi(n.ya.NetworkMeasurementUrlList))?f.a.mi(n.ya.NetworkMeasurementUrlList):
null);for(var u=[],t=0;t<a.Vlc.length;t++){var y=a.Vlc[t],E=y.key;E||(E=y.Key);if(!v||Array.contains(v,E)){var B=y.value;B||(B=y.Value);E&&B&&u.push(new c(n,E,B,h,w))}}return u};a.Vlc=null;Object(x.a)(a,"NetworkConnectionHelpers",null,[])},1440:function(x,C,b){function a(V){var Ga=be.call(this)||this;Ga.$=V;Ga.Tb();return Ga}function c(){}function e(V,Ga,Bb,gc,dd,sd,ie){V=l.call(this,V,Ga,Bb,gc,dd,!1)||this;V.kZd=!1;V.Z0=ie;V.Eec=e.DFh(sd);sd=V.IZd(V.Eec.name,V.Eec.size);if(0!==sd)return V.aSd(sd),
V.Z0.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),V.dispose(),V;V.Jj=new n(V.$.domElement,Object(fb.a)(V,V.mFb,"onUploadFrameInitialized"),Object(fb.a)(V,V.Ioa,"uploadResponseReceived"),gc,!1,V.$);return V}function f(V,Ga){this.filename=V;this.blob=Ga}function l(V,Ga,Bb,gc,dd,sd){sd=void 0===sd?!0:sd;V=h.call(this,V,Bb,gc,dd,!1)||this;V.Rd=Ga;sd&&V.showDialog();return V}function m(V,Ga){this.dataUri=this.sheetName=null;this.sheetName=V;this.dataUri=Ga}function r(V,Ga,Bb,gc,
dd,sd){sd=void 0===sd?!0:sd;Ga=h.call(this,V,Ga,Bb,gc,!1)||this;Ga.zzh=dd;Ga.F9b=V.Ob.$g("LoadResource","FileReaderUploaderLoadResource");sd&&Ga.showDialog();return Ga}function h(V,Ga,Bb,gc,dd){dd=void 0===dd?!0:dd;var sd=Db.call(this,null,Ga,Bb)||this;sd.At=null;sd.saa=null;sd.q7a=!1;sd.IDd=null;sd.Ioa=function(ie){sd.y_d.stop();sd.l0b.cancel();if(n.dhi(ie))sd.mAc?sd.Z4e(4):(ie=new Sj.a(0,2,null,null,!1,null,null,null),ie.status=8,sd.SWd(new oh.a(ie),null,"InsertPictureWebMethod")),fc.ULS.sendTraceTag(526399121,
0,50,"Http Error occurred, isTimeoutError: {0}",sd.mAc);else{var Ce=h.JUj(ie);0!==Ce?(fc.ULS.sendTraceTag(526399122,0,50,"Server returned error, response: {0}",ie),sd.Z4e(Ce)):sd.Y3h(ie)}sd.Poc();sd.dispose()};sd.yJi=function(ie){sd.UBa(ie,sd.Jj)&&sd.finalizeUpload(sd.Jj,null)};sd.mFb=function(ie){fc.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");sd.Jj=ie;if(!sd.s1a){if(sd.kZd){if(sd.Sve()||sd.X8a&&Gg.a.wF){ie.b7b(sd.yJi);return}var Ce=ie.b7b(null);if(!sd.UBa(Ce,ie))return}sd.finalizeUpload(ie,
null)}};sd.FSi=function(){sd.mAc=!0};sd.wb=V;sd.y_d=V.Ob.$g("WebServiceCall","InsertPictureOperation");sd.l0b=Ch.a.instance.create(sd.FSi,1E5,Gh.a.kNg,!1);sd.mAc=!1;sd.Xkc=sd.$.ya.InsertPictureMaxFileSizeBytes;gc&&(sd.q7a="TestOnly"in gc);dd&&sd.showDialog();return sd}function w(V,Ga,Bb){var gc=t.call(this,V,!1)||this;gc.kV=null;gc.aBa=!1;gc.bnc=function(){gc.oYd("");gc.mBc();return!1};gc.$=Ga;gc.sCc=V;gc.gR=ki.a.instance;gc.ga=Bb;gc.R_f();gc.Vld();gc.$.zb.Kz=!0;return gc}function n(V,Ga,Bb,gc,dd,
sd,ie){V=v.call(this,V,Ga,Bb,gc,dd,"UploadFrame",sd.ea.sessionId,"image/*",!1,null,void 0===ie?!1:ie)||this;V.$=sd;V.beg=!0;td.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?V.B$e():V.oqe();return V}function v(V,Ga,Bb,gc,dd,sd,ie,Ce,af,ff,fg){af=void 0===af?!0:af;fg=void 0===fg?!1:fg;this.ASe="FileUpload.ashx";this.co=null;this._initialized=!1;this.Rg=this.wib=this.zIc=this.xga=this.CSb=this.er=this.Ks=null;this.Am=!1;this.WD=this.DSb=this.NSc=null;this._parent=
V;this.aqg=Ga;this.Fug=Bb;this.Z6d=dd;this.RQc=ie;this.d1d=Ce;this.b3d=void 0===ff?null:ff;this.MSc=!1;this.uqg=gc.ra("CanaryRenewalForFileUploadIsEnabled");this.beg=!1;(this.Iqa=fg)||this.a4g(sd);af&&this.B$e()}function u(V,Ga,Bb){if(V){var gc=0;do{try{V();break}catch(dd){if(fc.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",gc,Bb,dd.message,dd.stack),gc>=Ga)break}gc++}while(1)}}function t(V,Ga){return E.call(this,V,void 0===Ga?
!0:Ga)||this}function y(){}function E(V,Ga){Ga=void 0===Ga?!0:Ga;var Bb=Ri.call(this,!1,!1,E.Fu)||this;Bb.hXa=null;Bb.v6d=!1;Bb.en=[];Bb.Jj=null;Bb.IXb=V;Bb.tvg=Ga;Bb.Khe=!1;Bb.$v=!1;Bb.xga=null;Bb.AIc=!1;Bb.gg=Bb.weh;Bb.Pe="InsertFileDialog";Bb.Dc(1,Bb.eYb);if(E.Fu){V={};Ga={};var gc={};Bb.hXa=(gc.id=Bb.Pe,gc.bodyControls=(Ga.uploadButtonProps=(V.label=CommonUIStrings.l_DialogChooseFile,V.onExecute=Object(fb.a)(Bb,Bb.gTi,"onUploadButtonClick"),V),Ga),gc.uploadStatusLabel=CommonUIStrings.l_DialogNoFileChosen,
gc.onFrameReady=Object(fb.a)(Bb,Bb.$Ji,"onFrameReady"),gc);Bb.initializeAndShow(Bb.titleText,Object(fb.a)(Bb,Bb.hfc,"insertDialogHandler"),Bb.hXa);Bb.eSb=!0}else Bb.showDialog(Bb.titleText,Object(fb.a)(Bb,Bb.hfc,"insertDialogHandler")),Ga&&Bb.R_f(),(V=Bb.xV(1))&&Bb.en.push(V),(V=Bb.xV(0))&&Bb.en.push(V),Bb.Ocg(),Bb.eSb=!1;return Bb}function B(V){var Ga=Zi.call(this)||this;Ga.$=V;Ga.Tb();return Ga}function z(V,Ga,Bb,gc){var dd=this;this.aL=null;this.edg=function(){dd.aL&&(dd.l_d=la.a.Ta.oe.m,dd.hide(),
Ch.a.instance.create(function(){dd.$Rj()},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",void 0,!0))};this.kIe=function(sd){10===sd&&dd.wIa()};this.tfh=function(){if(dd.aL){var sd=document.getElementById("PasteRecoveryUI");sd&&oc.a.Mj===sd.getAttribute(oc.a.OY)&&sd.click();dd.documentHidden=!0;dd.wIa()}};this.lIe=function(){dd.wIa()};this.mIe=function(){dd.wIa()};this.onKeyUp=function(sd){if(dd.aL){if(dd.x_)return!1;if(17===sd.Ca.keyCode&&dd.h9b){sd=document.getElementById("PasteRecoveryUI");
if(!sd)return fc.ULS.shipAssertTag(537154070,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;var ie=sd.getAttribute(oc.a.OY)||"";if(oc.a.Tp===ie)return sd.click(),!0}}return!1};this.onKeyDown=function(sd){if(dd.aL){dd.h9b=!1;dd.x_=sd.ctrlKey;sd=sd.Ca.keyCode;if(27===sd)return dd.wIa(),!0;if(17===sd)return dd.h9b=!0}return!1};this.JN=function(sd,ie){sd=ie.Rd;dd.VAb=sd;-1027730316!==sd.command&&-1059615499!==sd.command?dd.wIa():(ie=ie.properties)&&ie.launcherId!==dd.mRh()&&dd.wIa()};
this.$=V;this.prc=Ga;this.xr=Bb;this.Al=gc;this.Csd=this.VAb=this.rsd=null;this.x_=this.h9b=this.K6b=this.Vdc=!1;this.l_d=0;this.documentHidden=!1;td.EwaSettings.em()||this.$.da.Ga(406,this)}function M(V){var Ga=Vh.call(this)||this;Ga.$=V;Ga.Tb();return Ga}function Q(V,Ga,Bb){Bb=void 0===Bb?!0:Bb;var gc=Tg.call(this)||this;gc.qSa=null;gc.Sna=null;gc.BOa=null;gc.F3b=null;gc.S0=null;gc.arf=0;gc.$ab=!1;gc.Zab=!1;gc.csc=!1;gc.documentVisibilityObserver=null;gc.brf=null;gc.jBj=null;gc.Efa=!1;gc.V7=0;gc.pld=
0;gc.Wzb=!1;gc.o4f=0;gc.XQd=!1;gc.c1=null;gc.JEb=function(){fc.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");gc.wlc(1,!1)};gc.qya=function(){gc.vka||gc.dCb?window.setTimeout(function(){gc.bWd()},gc.arf):gc.bWd();gc.documentVisibilityObserver.bIb(gc.qya);gc.Wzb=!1};gc.ug=function(){fc.ULS.sendTraceTag(537155218,0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:{0}, IsInDuringWorkSilentReopenMode:{1}",gc.dCb&&gc.jxc,gc.xkc&&
!gc.Efa&&gc.lLb);gc.dCb&&gc.jxc&&gc.$je();gc.xkc&&!gc.Efa&&gc.lLb&&gc.Xje();re.g(gc.$).wc.Dn(gc.ug);gc.Zab=!1;gc.$ab=!1};gc.Gzf=function(){fc.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");gc.wlc(1,!0);gc.Zab&&!gc.$ab&&re.g(gc.$).wc.Dn(gc.ug);gc.Zab=!1};gc.Aca=function(dd,sd){gc.pld=gc.V7;gc.V7=sd.hAc};gc.GCf=function(){gc.$&&(gc.csc||(lf.a(gc.$).TQ(ye.a.dPa).uEg(gc.Qzf),gc.$.nl(gc.zd),gc.csc=!0),gc.Efa=gc.tei(),gc.wlc(2,!1))};gc.Qzf=function(){var dd=
lf.a(gc.$).wi,sd=dd.yKg();dd=Jh.f(dd.Is.ud.errors,function(ie){return ie.MessageIdName});fc.ULS.sendTraceTag(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:{0}, IsB2W:{1}, Errors: {2}",sd,gc.Efa,Uh.a.Kc(dd));sd&&(gc.qSa?(gc.Efa=!1,gc.bGe(),gc.jBc()):gc.Sna&&(gc.cGe(),gc.jBc()))};gc.zd=function(){gc.$?(fc.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),gc.Efa=!1,td.EwaSettings.isChangeGateEnabled("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&
gc.S0&&gc.S0.vp&&($h.a.Ha(gc.S0),gc.S0=null),td.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&gc.c1&&gc.c1.vp&&($h.a.Ha(gc.c1),gc.c1=null),gc.wlc(2,!0),gc.jBc()):fc.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};gc.ivf=function(){gc.Ypf(!0)};gc.jvf=function(){gc.Ypf(!1)};gc.wWb=ka.Tri;gc.k2c=ka.connected;gc.$=V;gc.qf=V.na.qf;gc.u1f=td.EwaSettings.isChangeGateEnabled("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");
gc.lLb=td.EwaSettings.isChangeGateEnabled("OfficeVSO:5798300_SilentReopenDuringWorkUIEnabled");gc.jxc=td.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");Bb&&(gc.brf=new ca(V,Ga));td.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&gc.$.da.$a(291,function(dd){gc.documentVisibilityObserver=dd});gc.jxc&&(td.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||gc.$.da.$a(291,function(dd){gc.documentVisibilityObserver=
dd}),gc.arf=gc.$.ya.ExcelNetworkCheckAfterTabActivationDelayMs,gc.qf.yFg(gc.JEb),gc.qf.znb(gc.Gzf),gc.qf.Rme(gc.ivf),gc.qf.aEg(gc.jvf));if(gc.u1f||gc.lLb)gc.jBj=new P(gc.$,gc);gc.Hmf=gc.$.ya.LongInactivityTimePeriodSeconds;gc.$.ea.MVc(gc.GCf);gc.$.ea.sf.Qra(gc.Aca);gc.lLb&&(gc.o4f=gc.$.ya.SilentReopenDuringWorkDelayMs);return gc}function P(V){var Ga=this;this.I7=null;this.HCf=function(Bb,gc){Ga.ECf(gc,3)};this.$yf=function(Bb,gc){Ga.ECf(gc,2)};this.$=V;this.vg=mg.a(this.$).vg;this.vg.xne(this.$yf);
this.vg.MGg(this.HCf)}function L(V,Ga,Bb,gc){V=W.call(this,V,Ga,Bb)||this;V.wasInteruptedByOfflineMode=!1;V.type=gc;V.wasInteruptedByOfflineMode=!1;return V}function ca(V,Ga){this.Ala=this.Kxd=this.Ssf=null;this.$=V;!td.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||td.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Gg.a.Gf||(this.Ssf=new U(V,Ga));td.EwaSettings.ma(213)&&(this.Kxd=new D(this.$),this.Kxd.f9h());!td.EwaSettings.ma(568)||
td.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Gg.a.Gf||(this.Ala=new $g.NetworkConnectionHealthChecker(this.$));this.f1g=new J(this.$)}function U(V,Ga){var Bb=this;this.AOa=this.SU=null;this.eFd=-1;this.eub=null;this.njf=cc.Task.delay(0);this.W9a=function(gc,dd){dd.gM?Bb.JOi(dd.foa):Bb.KOi()};this.Bca=function(gc,dd){5===dd.wFf&&Bb.Q2a()};this.TUf=function(gc,dd){Bb.SU.jpj(dd.jV)};this.Q2a=function(){Bb.AOa.hQj();Bb.rjj(U.iDd,Sys.Serialization.JavaScriptSerializer.serialize(Bb.AOa))};
this.nej=function(gc){if(gc=gc.result)Bb.Ifg=!0,fc.ULS.sendTraceTag(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: {0}",gc)};this.z9i=function(){Bb.Ifg&&(Bb.$?Sd.TaskExtensions.Ba(Bb.indexedDB.e6c(U.iDd),function(){fc.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},Bb.$.la):fc.ULS.sendTraceTag(537155203,
0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.FOa=function(){if(Bb.AOa&&0<Bb.AOa.count){var gc=Sys.Serialization.JavaScriptSerializer.serialize(Bb.AOa);fc.ULS.sendTraceTag(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: {0}",gc)}};this.$=V;this.indexedDB=Ga;this.Ifg=!1;this.indexedDB.tg()&&(this.indexedDB.initialize(U.wld,U.xld),this.Hdj(),this.AOa=
new F(this.$.ya.UserSessionId),mg.a(this.$).vg.tVc(this.W9a));this.Al=lh.a.instance.KE();this.Al.ka("beforeunload",this.FOa)}function aa(V,Ga,Bb){V=W.call(this,V,Ga,Bb)||this;V.timeFromLastOffline=0;V._errorDataDuringOfflineMode=null;V.timeFromLastOffline=-1;V.type=5;return V}function F(V){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=V}function D(V){var Ga=this;this.UTf=null;this.ysd=this.Kwd=
this.CDb=this.DDb=0;this.dRd=!1;this.b2c=this.uSa=this.vyc=this.b9a=null;this.p2c=0;this.Tlj=function(){if(12E4>Ga.$.ea.sf.oeb)for(var Bb=El(Ga.vyc),gc=Bb.next();!gc.done;gc=Bb.next())gc.value.runTest();else Ga.XTd("UserInactive")};this.xej=function(Bb){Bb=Sys.Serialization.JavaScriptSerializer.serialize(Bb);fc.ULS.sendTraceTag(388821830,0,50,Bb)};this.Mdj=function(Bb){if(Bb){var gc=Ga.b2c[Bb.testIteration.toString()];gc?gc.push(Bb):(gc=[Bb],Ga.b2c[Bb.testIteration.toString()]=gc);if(gc.length===
Ga.UTf.length){gc=Sys.Serialization.JavaScriptSerializer.serialize(gc);if(Ga.$&&Ga.$.qf){if(Bb.EstimatedLatency=Ga.$.qf.Wse,Ga.$.qf.Wse>Ga.$.Xu.ExcelRountripThresholdMs){fc.ULS.sendTraceTag(570712144,0,50,"Periodic ping tests results when network is slow: {0}, consequtive slow ping iteration #: {1}",gc,Ga.p2c++);return}}else fc.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");fc.ULS.sendTraceTag(570712142,0,50,"Periodic ping tests results: {0}",
gc);Ga.p2c=1}}};this.Th=function(Bb,gc){Bb=gc.context.methodName;if(Bb===He.a.bwb||Bb===He.a.tKa)Ga.CDb++,Bb=Date.now(),Ga.qwj(Bb)&&(Ga.CDb=0,Ga.ysd=Bb,Ga.nEj())};this.Aca=function(){Ga.ETd("OnThrottledUserActivity")};this.vW=function(){Ga.XTd("OnDocumentHidden")};this.qya=function(){Ga.ETd("OnDocumentUnhidden")};this.$=V;if(this.eRd=td.EwaSettings.isChangeGateEnabled("OfficeVSO:5186511_SendSlowNetworkPingTests")&&this.CWg())this.UTf=[Hh.a.cEc],this.p2c=1,this.b2c={},this.$.ea.sf.Qra(this.Aca),this.$.da.$a(291,
function(Bb){Bb.IFa(Ga.vW);Bb.snb(Ga.qya)})}function J(V){var Ga=this;this.jjc=this.data=null;this.P$c=0;this.lBe=null;this.kvf=function(Bb,gc){gc.gM?(Ga.data=new Z(la.a.Ta.Wb,Ga.$,5===gc.foa,0!==gc.foa,Ga.$.qf.disconnectionSource,Ga.lBe),Ga.jjc=Ga.$.qf.tjf,Ga.P$c=1,Ga.$.na.qf.iHg(Ga.Un),Sg.a(Ga.$).iVc(Ga.SUf)):(Ga.data.EHi(Ga.$,5===gc.foa),Ga.$.na.qf.rQf(Ga.Un),Ga.data.lastFailedRequestToOnlineTimeGapSec=hf.getElapsedSeconds(Ga.jjc,la.a.Ta.Wb),td.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?
Vf.b().aKb(557682689,0,50,R.connectivityIssues,Ga.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Uh.a.Kc(Ga.data)):fc.ULS.sendTraceTag(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Uh.a.Kc(Ga.data)),td.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&Ga.data&&Ga.data.isToastShown&&uc.Health.instance.recordQosError(ad.a.sYg,[Rd.a.Mjc],
!0,!1,!1,!1,null),Sg.a(Ga.$).hJd(Ga.SUf),Ga.data=null)};this.SUf=function(Bb,gc){Ga.data.ipj(gc.jV)};this.Un=function(Bb,gc){Ga.data.U5i(gc.context.methodName);Bb=la.a.Ta.Wb;gc=hf.getElapsedSeconds(Ga.jjc,Bb);Ga.jjc=Bb;gc>Ga.data.longestDurationBetweenFailedRequestsSec&&(Ga.data.longestDurationBetweenFailedRequestsSec=gc);Ga.P$c++;Ga.data.averageDurationBetweenFailedRequestsSec=Ga.USg(gc)};this.hvf=function(Bb,gc){Ga.lBe=gc.RLj};this.$=V;mg.a(this.$).vg.Sme(this.kvf);this.$.qf.Rme(this.hvf)}function R(){}
function Z(V,Ga,Bb,gc,dd,sd){V=W.call(this,V,Ga,gc)||this;V.swappedByOffline=!1;V.swappedOffline=!1;V.averageDurationBetweenFailedRequestsSec=0;V.longestDurationBetweenFailedRequestsSec=0;V.lastFailedRequestToOnlineTimeGapSec=0;V.disconnectionSource=null;V.errorDataDuringConnectivityIssuesMode=null;V.failedRequests=[];V.triggeringRequest=null;V.type=4;V.swappedOffline=Bb;V.disconnectionSource=Enum.toString(cg.a,dd);V.triggeringRequest=sd;return V}function W(V,Ga,Bb){var gc=this,dd;this.type=0;this.startTime=
null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.Ytf=function(sd,ie){gc.blockedOperationsCount++;sd=String.format("{0}_{1}_{2})",ie.componentName,ie.actionName,ie.details);gc.blockedActions[sd]=
gc.blockedActions[sd]?gc.blockedActions[sd]+1:1;gc.isToastShown&&gc.blockedUserOperationsWhileToastShown++};this.jCd=function(sd){gc.durationUntilUserInactive=hf.getElapsedSeconds(gc.startTime,la.a.Ta.Wb);sd.OJd(gc.jCd)};this.vW=function(){gc.hasTabbedOut=!0};this.Bca=function(sd,ie){ie.wFf!==gc.type||gc.isToastShown||(gc.durationUntilToastShownMs=Yf.a(la.a.Ta,gc.startTime),gc.toastRaiser=ie.toastRaiser,gc.isToastShown=!0)};this.startTime=V;this.durationUntilToastShownMs=0;this.blockedActions={};
this.isToastShown=Bb;if(null===(dd=Ga.ea)||void 0===dd?0:dd.sf)this.wasUserActiveOnPIStart=Ga.ea.sf.vr;this.Ck(Ga);td.EwaSettings.isChangeGateEnabled("OfficeVSO:5340853_ImprovePIData")?(this.isDialogShown=0<Ga.zb.ZR,V=Ga.da.Aa(183),this.isTaskPaneShown=!!V&&V.isVisible&&!V.isCollapsed,this.isTaskPaneCollapsed=!!V&&V.isVisible&&V.isCollapsed):this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1}function ka(){}function ma(V){var Ga=te.call(this)||this;Ga.Tc=V;Ga.Tb();return Ga}function pa(V,
Ga,Bb){Bb=void 0===Bb?null:Bb;var gc=Fd.call(this)||this;gc.D_a=null;gc.v5a=null;gc.Oec=null;gc.NCa=null;fc.ULS.sendTraceTag(537155417,0,50,"MergeSuspensionManager.ctor started");gc.$=V;gc.$Wa=new kb(V);td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjust",!1)&&(gc.mAa=new xa(gc.$));gc.z1a=new fa(gc.$.na.ua,gc.$,void 0,void 0,gc.mAa);gc.B9h(V,Bb);gc.Nfa=new lb(gc.NCa,gc.$Wa);gc.FKd=new Ca(V,gc.Nfa,Ga,gc.z1a);td.EwaSettings.ma(255)&&(gc.Oec=new Ha(V,gc));fc.ULS.sendTraceTag(588276810,
0,50,"MergeSuspensionManager created");return gc}function xa(V){var Ga=this;this.Syc=0;this.lC=this.Dz=null;this.C1d=new ta;this.D1d=new ta(!0);this.$C=0;this.HHj=!1;this.Spf=1E4;this.Pi=function(){Ga.DXc(!0,!1)};this.w9a=function(){Ga.DXc(!1,!1)};this.$=V;this.gridView=re.g(this.$);this.gridView.Ea.Gx(this.Pi);this.gridView.Ea.Us(this.w9a);this.gridView.Ea.Kme(this.w9a);this.gridView.Ea.Nga(this.w9a);this.yej=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportSelections",!1);this.$.da.$a(276,
function(){ec.a(Ga.$).L2(Ga.C1d);ec.a(Ga.$).L2(Ga.D1d)});this.WCb=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjustMultiRangeSupport",!1);this.Rdj=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6354017_reportEditRaceCondition");this.kRf=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6367531_reportDivergenceOnResponse")}function va(V,Ga,Bb,gc,dd){var sd=this;this.wb=V;this.xG=Ga;this.x9=Bb;this.FWb=gc;this.Njg=dd;this.NNc=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjustMultiRangeSupport",
!1);this.Jee=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6327871_RemoveNoBLocksErrorLog");this.NNc?this.p2d=this.selectedRanges.map(function(ie){return sd.Jee?sd.L$f(ie,dd):re.g(V).Ea.Zua(ie,dd)}):this.DUa&&(this.p2d=[this.Jee?this.L$f(this.selectedRanges[0],dd):re.g(V).Ea.Zua(this.selectedRanges[0],dd)])}function ta(V){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=
this.adjusted=this.adjustedDidntChange=0;this.c8h=void 0===V?!1:V}function fa(V,Ga,Bb,gc,dd){Bb=void 0===Bb?null:Bb;gc=void 0===gc?null:gc;dd=void 0===dd?null:dd;var sd=ab.call(this)||this;sd.iBb=null;sd.nCd=0;sd.documentVisibilityObserver=null;sd.Dif=!1;sd.ua=V;sd.Ntc=Ga.ya.MergeSuspensionRequestThrottlingTimeInMs;var ie=Ga.ya.GetRangeContentPrefetchDelayForMergeInMs;sd.Ky=function(){Ga.EVf(ie)};sd.qh=Bb||la.a.Ta;sd.zZd=0;sd.UO=gc;sd.mAa=dd;sd.Xdg=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6248201_useDoPendingMergeSuccessCallback");
sd.xTg=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6237816_CallDoPendingMergeRequest");Ga.da.$a(291,function(Ce){sd.documentVisibilityObserver=Ce});return sd}function Ca(V,Ga,Bb,gc){var dd=Te.call(this)||this;dd.z1a=null;dd.KAb=0;dd.H7a=null;dd.LAb=null;dd.QAf=function(sd,ie){dd.z1a.gMg(ie.ica,ie.IIg)};dd.iFb=function(sd,ie){ie.Uwa?dd.VDj():dd.Xyc()};dd.ezf=function(){dd.KAb=0};dd.VWf=function(){var sd=dd.c6.sfd();Sa(dd.ua,null!=sd.SuspensionStartTimestamp?sd.SuspensionStartTimestamp:0,null,function(){dd.$Mi(sd)},
null,null,dd.ua.hc())};dd.o8=function(sd,ie){if(ie){ie.cGa.MergeCount=dd.c6.sfd();var Ce=re.g(dd.$).Tzi();sd=Ce.min;Ce=Ce.max;td.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?ie.cGa.ClientRevisions=Object(hh.a)(new Gb,{Min:sd,Max:Ce,MaxFromBlockCache:re.g(dd.$).Ea.Zof}):ie.cGa.ClientRevisions=Object(hh.a)(new Gb,{Min:sd,Max:Ce})}};dd.$=V;dd.yZa=Bb;dd.c6=Ga;dd.c6.jGg(dd.QAf);dd.c6.RZb(dd.iFb);dd.c6.rFg(dd.ezf);dd.$.na.P9(dd.o8);dd.ua=dd.$.na.ua;dd.Ntc=dd.$.ya.MergeSuspensionRequestThrottlingTimeInMs;
dd.tpi=dd.$.ya.KeepBlockingPendingMergesRequestIntervalMs;dd.z1a=gc;fc.ULS.sendTraceTag(588276807,0,50,"RequestController initialized");return dd}function Sa(V,Ga,Bb,gc,dd,sd,ie){ie=V.Na(1,void 0===ie?null:ie);ie.suspensionStartTimestamp=Ga;return nc.i(V,"KeepBlockingPendingMerges",ie,Bb,gc,dd,sd,0)}function Gb(){}function kb(V){var Ga=qe.call(this)||this;Ga.c2=null;Ga.ojc=0;Ga.n8=function(Bb,gc){var dd;if(null===(dd=null===gc||void 0===gc?void 0:gc.rd)||void 0===dd?0:dd.MergeCount)Yb.a.equals(gc.rd.SessionId,
Ga.$.ea.sessionId,!1)?Ga.xya(gc.rd.MergeCount,kb.Jsb):fc.ULS.sendTraceTag(579737049,0,50,"Stale merge counter ({0}/{1})",gc.rd.MergeCount.Current,gc.rd.MergeCount.Pending)};Ga.GCb=function(Bb,gc){(null===gc||void 0===gc?0:gc.ica)&&Ga.xya(gc.ica,kb.A_d)};Ga.Mvc=function(){Ga.CSf();Ga.pKf(Ga.c2,kb.wfj)};Ga.D9a=function(Bb,gc){gc.zAe&&Ga.c2.SuspensionStartTimestamp&&fc.ULS.sendTraceTag(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter {0}",gb(Ga.c2))};Ga.CSf();Ga.$=V;Ga.$.ea.hk(Ga.Mvc);
Ga.$.ea.mM(Ga.Mvc);re.g(Ga.$).rc.mo(Ga.D9a);td.EwaSettings.isChangeGateEnabled("OfficeVSO:6329027_UpdateMergeCountWhenWebMethodReturnsWithErrors")||Ga.$.na.Bq(Ga.n8);Ga.$.da.$a(292,function(Bb){Bb.LYa(Ga.GCb);fc.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")});return Ga}function lb(V,Ga){var Bb=zd.call(this)||this;Bb.yya=function(gc,dd){gc=Bb.getState();var sd=Bb.tla;Bb.tla=dd.ica;dd=Bb.getState();Bb.Vui(gc,dd,sd);Bb.raiseEvent(lb.wwd);Bb.wTe(gc,dd)};Bb.UOa=function(gc,dd){gc=
Bb.getState();Bb.kI=dd.kI;dd=Bb.getState();Bb.wTe(gc,dd)};Bb.Qyb=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);Bb.Kha=V;Bb.Kha.MZb(Bb.UOa);Bb.oma=Ga;Bb.oma.LYa(Bb.yya);Bb.tla=Object(hh.a)(new d.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});Bb.kI=Bb.g9h();return Bb}function Nb(V,Ga){V=$c.call(this,V)||this;V.IIg=Ga;return V}function Aa(V){this.jpe=!1;this.jpe=V;return this}function qa(){}function Xa(V){var Ga=A.call(this)||this;Ga.Uwa=V;return Ga}
function Ha(V,Ga){var Bb=rb.call(this)||this;Bb.statusBarManager=null;Bb.Xxd=!1;Bb.yya=function(gc,dd){gc=String.format("{0}{1}",dd.ica.Current===dd.ica.Pending?"\u26ad":"\u26ae",dd.ica.Current);Yb.a.equals(Bb.Ylc,gc,!1)||(Bb.Ylc=gc,Bb.Oz())};Bb.UOa=function(gc,dd){gc=0==dd.kI;Bb.Xxd!==gc&&(Bb.Xxd=gc,Bb.Oz())};Bb.mergeSuspensionManager=Ga;Bb.mergeSuspensionManager.oma.LYa(Bb.yya);Bb.Ylc="";O.a.C2(1905775613,da.a.Mc,0,1);Bb.Ka=V.Ka;Bb.uNb=new Ra;V.da.$a(29,function(gc){Bb.mergeSuspensionManager&&(Bb.statusBarManager=
gc,gc.yJ(Bb),Bb.mergeSuspensionManager.Kha.MZb(Bb.UOa))});Bb.Ka.D2(Bb.uNb);return Bb}function Ra(){return Pa.call(this)||this}function mb(V,Ga){Ga=void 0===Ga?null:Ga;var Bb=Ef.call(this,1)||this;Bb.Gfa=!1;Bb.PN=function(){Bb.refresh()};Bb.uvf=function(){Bb.refresh()};Bb.$=V;Bb.W7d=Ga||lf.a(V).TQ(ye.a.idle);lf.a(V).hVc(Bb.uvf);Bb.u5a.Aq(Bb.PN);Bb.refresh();return Bb}function La(V,Ga){var Bb=ee.call(this)||this;Bb.ljf=null;Bb.pjc=!1;Bb.WQa=new Of.a;Bb.Jje=V;Bb.oma=Ga;Bb.Qyb=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",
!1);Bb.Qyb&&(Bb.Jje.sFg(Bb.fzf.bind(Bb)),Bb.oma.LYa(Bb.yya.bind(Bb)));return Bb}function ha(V){return(null===V||void 0===V?void 0:V.SuspensionStartTimestamp)&&V.Pending>V.Current}function Ia(V,Ga){return V||Ga?V&&Ga?V.Current===Ga.Current&&V.Pending===Ga.Pending&&V.SuspensionStartTimestamp===Ga.SuspensionStartTimestamp:!1:!0}function gb(V){return V?String.format("{0} / {1} @{2}",V.Current,V.Pending,V.SuspensionStartTimestamp):null}function Sb(V,Ga){this.handler=null;this.publisher=V;this.kI=Ga}function wc(V){var Ga=
nb.call(this,1)||this;Ga.Gfa=!1;Ga.puf=function(){Ga.refresh()};Ga.quf=function(){Ga.refresh()};Ga.gridView=re.g(V);Ga.gridView.rc.ml(Ga.quf);Ga.gridView.rc.mo(Ga.puf);Ga.refresh();return Ga}function tc(V){return ph.call(this,V)||this}function Tb(V,Ga){this.$=V;this.uploaderCreator=Ga}function pb(V,Ga,Bb,gc,dd,sd){var ie=Db.call(this,null,Bb,gc)||this;ie.Pmf=0;ie.cPi=function(Ce){Ab.a(Ce)?fc.ULS.sendTraceTag(537155799,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: {0}",
Se.a.Wc(Ce.Errors)):(fc.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),Ce.Result?ji.a(ie.$).jna(1,Ce.Result):fc.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};ie.bPi=function(){fc.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};ie.$=V;ie.Rd=Ga;ie.Z0=sd;ie.Tpe=fh.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");
ie.showDialog();return ie}function cb(V,Ga,Bb,gc,dd,sd){var ie=Ih.call(this)||this;ie.Qgc=!1;ie.jwa=null;ie.cS=null;ie.CNa=null;ie.tGi=function(){ie.xua(ie.dpb)};ie.lsd=function(Ce){Ce.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==Ce.target.id||Ce.shiftKey?"KeepFocusStartDiv"===Ce.target.id&&Ce.shiftKey&&(Ce.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(Ce.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};ie.oNi=function(){ie.Xnb&&(ie.Xnb.launchUpsellExperience("stockimages"),
fc.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};ie.Hm=sd;ie.$=V;ie.N$e=Ga;ie.Xnb=Bb;ie.lAa=[];ie.opf=gc;ie.xeh=dd;ie.lpe=ie.$.ya.InsertOnlinePictureMaxCountOfImagesToInsert;ie.gg=ie.R6g();return ie}function ob(){}function rc(V,Ga){return vh.call(this,V,Xg.a.Uaa(Ga))||this}function Db(V,Ga,Bb){V=Ja.call(this,V,Ga,Bb)||this;V.wra=null;V.oVb=null;return V}function Ja(V,Ga,Bb){this.Jj=this.gCd=null;this.KEa=this.$qa=0;this.ESb=null;this.mT=V;this.se=Ga;this.vb=Bb;
this.s1a=!1;this.kZd=!0;this.Dfj();this.X8a=this.ga.ra("NativeFileOpenDialogIsEnabled")}function Qb(V){var Ga=Ng.call(this)||this;Ga.nld=null;Ga.$=V;Ga.Tb();return Ga}function yc(V){var Ga=Fg.call(this)||this;Ga.$=V;Ga.Tb();return Ga}function Cd(V,Ga){this.LTe=V;this.NBh=Ga}function bc(V){this.$=V}function Kb(V){var Ga=kg.call(this)||this;Ga.$=V;Ga.Tb();return Ga}function ic(V,Ga,Bb){var gc=Hi.call(this)||this;gc.statusBarManager=null;gc.WHe=function(){gc.G6b()};gc.bfh=function(){gc.G6b()};gc.VHe=
function(dd){10===dd&&gc.G6b()};gc.onKeyDown=function(dd){if(13===dd.Ca.keyCode){dd=new Qg.a(237279923,1,2,6,null);var sd={};gc.$.Ka.Xb(dd,(sd[oc.a.skipClipboardAccess]=!0,sd[oc.a.QLe]=!0,sd));return!0}return!1};gc.$=V;gc.xr=Ga;gc.Al=Bb;gc.G8c=!1;gc.i2f=td.EwaSettings.getBooleanFeatureGate(Mf.a.IPa,!1);gc.Ogf=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6082903_PasteToEnterKeyDownEventForGrid");gc.i2f&&gc.$.da.$a(29,function(dd){gc.statusBarManager=dd;dd.yJ(gc)});return gc}function wb(V){var Ga=
nh.call(this)||this;Ga.$=V;Ga.Ym=Rf.a.instance;Ga.Tb();return Ga}function Wa(V){var Ga=this;this.v5b="";this.y2=this.Xs=null;this.uqc=!1;this.A7e=function(Bb,gc){Ga.hide(void 0===Bb?null:Bb,void 0===gc?null:gc)};this.gridView=re.g(V);this.gridView.ha.SG(this.A7e)}function Xb(){}function Gc(V,Ga){var Bb=Og.call(this,V)||this;Bb.Zo=null;Bb.ybi=function(gc,dd){1===gc?(gc=Gc.Teh[dd[Gc.Seh]],fc.ULS.sendTraceTag(537167683,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = {0}",
0===gc?"Horizontal":"Vertical"),Bb.Zo.setResult(gc)):(fc.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),Bb.Zo.Au())};Bb.hh(Ga);return Bb}function zb(V){this.rFc=this.xPc=null;this.$=V}function hc(){}function Uc(){}function jb(){}function $a(){}function I(V){this.T2c=this.fta=null;this.F$a=15;this.$=V}function ba(V,Ga){this.$=V;this.qob=Ga}function sa(V,Ga,Bb,gc){V=Ud.call(this,V)||this;V.isFromCurrentSession=!1;V.top=0;V.left=
0;V.isFromCurrentSession=Ga;V.top=Bb;V.left=gc;return V}function Oa(V,Ga,Bb,gc,dd){dd=void 0===dd?null:dd;var sd=vc.call(this,V,"ArtCopyPasteHandler")||this;sd.MYg="XLO";sd.NYg="3";sd.YU=new Zb(V);sd.A$=Ga;sd.vZa=Bb;sd.ha=re.g(V).ha;sd.V2c=dd||new Za(sd.A$);sd.JWi=new qb(Bb,V);sd.qob=gc;return sd}function qb(V,Ga){this.GIb=new Ue.a;this.vZa=V;this.$=Ga;this.r1i=function(Bb){return Promise.resolve(Bb)};this.PEb=function(Bb){return Promise.reject(Bb)}}function Qa(V,Ga,Bb,gc,dd,sd,ie,Ce,af){this.promise=
null;this.ribbonCommandInfo=V;this.destination=Ga;this.iHe=Bb;this.GOb=dd;this.O0=sd;this.item=ie;this.pasteContext=Ce;this.UNa=Bb||Ga.FirstRow+"_"+Ga.FirstColumn;this.Rdf=!0;this.Uye=af}function ib(V,Ga,Bb,gc,dd,sd,ie){this.floatingObjectId=V;this.commandParameters=Ga;this.At=Bb;this.Cah=gc;this.taa=void 0===sd?null:sd;this.GOb=void 0===ie?null:ie;this.e3g=dd}function Mb(V,Ga,Bb,gc){Ga=ub.call(this,V,Ga,Bb,"AcrossSessionRangeCopyPasteHandler",void 0===gc?null:gc)||this;Ga.YU=new Zb(V);return Ga}
function Jb(V,Ga){Ga=void 0===Ga?null:Ga;var Bb=Xi.call(this,Df[V])||this;Bb.copyErrorName=0;Bb.ewaErrors=null;Bb.copyErrorName=V;Bb.ewaErrors=Ga;if(null===Ga||void 0===Ga?0:Ga.length)Bb.innerError=new qh.a(Ga,null);return Bb}function Zb(V){this.YU=new Oe.a(!0);this.$=V}function ub(V,Ga,Bb,gc,dd){dd=void 0===dd?null:dd;gc=vc.call(this,V,gc)||this;gc.o3g=Ga;gc.A$=Bb;gc.W2c=dd||new Za(gc.A$);gc.gridView=re.g(V);gc.ha=gc.gridView.ha;gc.clipboardRangeFactory=V.da.Aa(169);return gc}function Za(V){this.clipboardItems=
this.key=null;this.A$=V}function vc(V,Ga){this._name=Ga;this.$=V;this.Ym=Rf.a.instance;this.Wr=new Vb(V,re.g(V))}function zc(V){return V.shadowWorkbookSizeExceedsLimit?!0:kd(V)>He.a.$kc}function kd(V){return V?V.shadowWorkbookSizeExceedsLimit&&void 0!==V.shadowWorkbookBlockedSize&&null!==V.shadowWorkbookBlockedSize?V.shadowWorkbookBlockedSize:V.shadowWorkbookBase64?V.shadowWorkbookBase64.length:0:0}function wa(){}function Na(V){var Ga={};this.y6f=(Ga["SourceItemType.Range"]=0,Ga["SourceItemType.Art"]=
1,Ga);this.lMb={};Ga={};this.u6f=(Ga["FloatingObjectType.Unknown"]=99,Ga["FloatingObjectType.CardView"]=6,Ga["FloatingObjectType.Chart"]=0,Ga["FloatingObjectType.Group"]=7,Ga["FloatingObjectType.Image"]=1,Ga["FloatingObjectType.Ink"]=8,Ga["FloatingObjectType.InteractiveReport"]=4,Ga["FloatingObjectType.ModernOfficeExtension"]=3,Ga["FloatingObjectType.Shape"]=5,Ga["FloatingObjectType.Slicer"]=2,Ga["FloatingObjectType.Unsupported"]=100,Ga);Ga={};this.lXc=(Ga["99"]="FloatingObjectType.Unknown",Ga["6"]=
"FloatingObjectType.CardView",Ga["0"]="FloatingObjectType.Chart",Ga["7"]="FloatingObjectType.Group",Ga["1"]="FloatingObjectType.Image",Ga["8"]="FloatingObjectType.Ink",Ga["4"]="FloatingObjectType.InteractiveReport",Ga["3"]="FloatingObjectType.ModernOfficeExtension",Ga["5"]="FloatingObjectType.Shape",Ga["2"]="FloatingObjectType.Slicer",Ga["100"]="FloatingObjectType.Unsupported",Ga);Ga={};this.x6f=(Ga["RibbonCommand.Copy"]=-911352779,Ga["RibbonCommand.Cut"]=-1985798686,Ga);Ga={};this.NLd=(Ga["-911352779"]=
"RibbonCommand.Copy",Ga["-1985798686"]="RibbonCommand.Cut",Ga);Ga={};this.w6f=(Ga["InputManager.InputMethod.NotDefined"]=-1,Ga["InputManager.InputMethod.Unknown"]=0,Ga["InputManager.InputMethod.Keyboard"]=1,Ga["InputManager.InputMethod.Mouse"]=2,Ga["InputManager.InputMethod.Touch"]=3,Ga["InputManager.InputMethod.CrossSlide"]=9,Ga);this.hka={};Ga={};this.v6f=(Ga["FrameMode.None"]=0,Ga["FrameMode.Reading"]=1,Ga["FrameMode.Edit"]=2,Ga);this.d3a={};Ga={};this.z6f=(Ga["UILocation.Unknown"]=0,Ga["UILocation.UpperRibbon"]=
1,Ga["UILocation.Ribbon"]=2,Ga["UILocation.QAT"]=3,Ga["UILocation.Jewel"]=4,Ga["UILocation.NavigationPane"]=5,Ga["UILocation.KeyboardShortcut"]=6,Ga["UILocation.StatusBar"]=7,Ga["UILocation.Dialog"]=8,Ga["UILocation.Floatie"]=9,Ga["UILocation.NotificationBar"]=10,Ga["UILocation.StandaloneCuiRoot"]=11,Ga["UILocation.TaskPane"]=12,Ga["UILocation.HeroDock"]=13,Ga["UILocation.SingleLineRibbon"]=14,Ga["UILocation.MultilineRibbon"]=15,Ga["UILocation.Overflow"]=16,Ga["UILocation.TellMe"]=17,Ga["UILocation.FarPeripheralControls"]=
18,Ga["UILocation.ContextMenu"]=19,Ga["UILocation.DialogMenu"]=20,Ga["UILocation.Header"]=21,Ga["UILocation.FileMenu"]=22,Ga["UILocation.Toolbar"]=26,Ga["UILocation.Canvas"]=30,Ga);this.Jr={};this.$=V;this.hka.notDefined="InputManager.InputMethod.NotDefined";this.hka.unknown="InputManager.InputMethod.Unknown";this.hka.keyboard="InputManager.InputMethod.Keyboard";this.hka.mouse="InputManager.InputMethod.Mouse";this.hka.touch="InputManager.InputMethod.Touch";this.hka.crossSlide="InputManager.InputMethod.CrossSlide";
this.d3a.none="FrameMode.None";this.d3a.reading="FrameMode.Reading";this.d3a.edit="FrameMode.Edit";this.Jr.unknown="UILocation.Unknown";this.Jr.upperRibbon="UILocation.UpperRibbon";this.Jr.ribbon="UILocation.Ribbon";this.Jr.QAT="UILocation.QAT";this.Jr.jewel="UILocation.Jewel";this.Jr.navigationPane="UILocation.NavigationPane";this.Jr.keyboardShortcut="UILocation.KeyboardShortcut";this.Jr.statusBar="UILocation.StatusBar";this.Jr.dialog="UILocation.Dialog";this.Jr.floatie="UILocation.Floatie";this.Jr.notificationBar=
"UILocation.NotificationBar";this.Jr.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.Jr.taskPane="UILocation.TaskPane";this.Jr.heroDock="UILocation.HeroDock";this.Jr.singleLineRibbon="UILocation.SingleLineRibbon";this.Jr.multilineRibbon="UILocation.MultilineRibbon";this.Jr.overflow="UILocation.Overflow";this.Jr.tellMe="UILocation.TellMe";this.Jr.farPeripheralControls="UILocation.FarPeripheralControls";this.Jr.header="UILocation.Header";this.Jr.fileMenu="UILocation.FileMenu";this.Jr.contextMenu=
"UILocation.ContextMenu";this.Jr.dialogMenu="UILocation.DialogMenu";this.Jr.toolbar="UILocation.Toolbar";this.Jr.canvas="UILocation.Canvas";this.lMb.range="SourceItemType.Range";this.lMb.art="SourceItemType.Art"}function Vb(V,Ga){this.gjc=this.lNa=null;this.E$a=Mf.a.E$a;this.cgc=td.EwaSettings.getBooleanFeatureGate(Mf.a.d5b,!1);this.Pmd=!1;this.Kwa=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);this.$=V;this.gridView=Ga;this.Pmd&&(this.$.userOperationManager.Vu(Object(fb.a)(this,
this.JF,"onQueueChanged")),this.zv=new Of.a)}function pc(V,Ga,Bb,gc,dd,sd,ie,Ce,af){this.destinationRange=V;this.Yqb=Bb;this.HFf=gc;this.Rd=dd;this.GOb=sd;this.pasteContext=ie;this.aqb=Ce;this.vWd=af}function hd(V){this.parameters=null;this.parameters=V}function Ud(V){this.pasteParameters=null;this.pasteParameters=V}function Zc(V,Ga){this.content=this.destinationRange=null;this.destinationRange=V;this.content=Ga}function Ob(V,Ga,Bb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=
V;this.destinationRange=Ga;this.pasteFlags=Bb}function Ad(V,Ga,Bb,gc,dd,sd,ie,Ce){Ce=void 0===Ce?null:Ce;ie=V.Na(1,void 0===ie?null:ie);ie.pasteParameters=Ga;return nc.i(V,"Paste",ie,Bb,gc,dd,sd,64,Ce)}function we(V,Ga,Bb,gc,dd,sd,ie,Ce){Ce=void 0===Ce?null:Ce;ie=V.Na(1,void 0===ie?null:ie);ie.copyParameters=Ga;return nc.i(V,"Copy",ie,Bb,gc,dd,sd,0,Ce)}function Wd(V,Ga,Bb,gc,dd,sd,ie,Ce,af){af=void 0===af?null:af;Ce=V.Na(9,Ce);Ce.destinationRange=Ga;Ce.source=Bb;return nc.i(V,"PasteString",Ce,gc,
dd,sd,ie,64,af)}function qc(V,Ga,Bb,gc,dd,sd,ie,Ce){Ce=void 0===Ce?null:Ce;ie=V.Na(1,ie);ie.pasteHtmlParameters=Ga;return nc.i(V,"PasteHtmlContent",ie,Bb,gc,dd,sd,64,Ce)}function md(){this.T_a=this.Zye=null}function bd(V,Ga,Bb,gc,dd,sd,ie,Ce,af){af=void 0===af?null:af;var ff=Hf.call(this)||this;ff.pasteShortcutManager=null;ff.Dbf=td.EwaSettings.Fb();ff.Kwa=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);ff.K8f=null;ff.f7a=!1;ff.nef=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6004791_MergedCellOverlapTelemetry");
ff.aBd=function(fg){ff.pvj(fg)&&(ff.Wr.rxb(),fc.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};ff.Dvi=function(fg,Ig){fc.ULS.sendTraceTag(537167768,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",fg,Ig);ff.gridView.focus()};ff.zd=function(fg,Ig){Ig.nN||Ig.Hg||ff.Vr("OnWorkbookOpened",
!1).catch(function(){})};ff.gi=function(fg,Ig){fg=jc(ff.DK);var ah=ff.Wr.fwb(fg);ah&&(Ig.qa&&Ig.qa.sheetName===ah.sheetName&&ah.isFromCurrentSession(ff.$)?ff.Wr.W7e(ah.ranges,fg.commandParameters.commandType):ff.Wr.rxb())};ff.Anc=function(fg,Ig){fg=jc(ff.DK);(fg=ff.Wr.fwb(fg))&&Ig.item&&Ig.item.sheetName===fg.sheetName&&fg.isFromCurrentSession(ff.$)&&ff.Vr("OnItemDeleting",!1).catch(function(){})};ff.cFb=function(fg,Ig){ff.Dbf?ff.K8f(fg,Ig):ff.RCf()};ff.WR=function(fg,Ig){1===Ig.su&&Ig.Lg.operation.flags&
2&&ff.Vr("OnQueueItemChanged/ItemRemoved",!1).catch(function(){})};ff.$=V;ff.Ug=Bb;ff.gridView=re.g(V);ff.Wr=dd;ff.xbi=sd;ff.DK=Ga;ff.e4b=gc;ff.getStringifiedError=af||copyPasteInfra.getStringifiedError;ff.g2f=1===Ce;ff.Ck();ff.copyPasteShortcutDialogFactory=ff.$.da.Aa(85);fc.ULS.shipAssertTag(537167825,0,!!ff.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");ie||(fc.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),
ie=bd.rch);ff.userHash=Cb.a.mw(ie);ff.Ezi="CultureTag: "+Rf.a.instance.csb+" HASH: ";ff.DK.addMetadataChangeListener(bd.Ipf,ff.aBd);ff.Zvd=ff.$.ya.MaxCopyPasteLength;ff.fOa=ff.Kwa?td.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",ff.$.ya.CopyPasteMaxPayloadLength):He.a.fOa;ff.Ao=td.EwaSettings.getBooleanFeatureGate(Mf.a.IPa,!1);ff.Ao&&V.da.$a(478,function(fg){ff.pasteShortcutManager=fg});ff.Dbf&&(ff.K8f=Ka.a(function(){ff.RCf()},1,ff.$.la,"CopyPasteInfrastructure.OnStartEditInternal",
!0));return ff}function Xc(V){if(!V)return"null";var Ga=[];V=El(V.get());for(var Bb=V.next();!Bb.done;Bb=V.next())Bb=Bb.value,Bb=String.format("{0}({1})",Bb.clipboardDataFormat,Bb.data.length),Ga.push(Bb);Ga.sort();return Ga.join(",")}function ne(V){switch(V){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}}function ed(V,Ga){return V?Ga&&Ga.ya?V.sessionId!==Ga.ya.UserSessionId:(fc.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(fc.ULS.shipAssertTag(537166210,
0,!1,"copyContext shouldn't be null"),!1)}function nd(){}function Ub(){}function Hc(){}function pd(V,Ga,Bb,gc){this.$=V;this.originalDestinations=Ga;this.g9b=Bb;this.$jg=gc;this.jug=this.originalDestinations;this.Sng=this.g9b;this.zrg="PasteRecoveryUI"}function jc(V){return V&&(V=V.getCachedMetadata(),null===V||void 0===V?0:V.lastCopy)?V.lastCopy:null}function vd(V){return V.clipboardItems&&(V=V.clipboardItems.getItem(Bc.qfi))&&"1"===V?!0:!1}function ae(V){return $d(V)&&!(void 0===V.clipboardItems||
null===V.clipboardItems)&&!!V.clipboardItems.getItem(Bc.png)&&!V.clipboardItems.getItem(Bc.IW)}function $d(V){return V.clipboardItems&&(V=V.clipboardItems.getItem(Bc.Wii))&&"1"===V?!0:!1}function Bc(){}function Hd(){}function xb(V){return!!V&&Object.getType(V)===rd}function rd(V,Ga,Bb,gc,dd){gc=Kf.call(this,gc,dd)||this;fc.ULS.shipAssertTag(537167645,0,!!Ga&&0<Ga.length,"RangeSourceItem.ctor: ranges should not be null or empty");gc.$=V;gc.ranges=Ga;gc.sheetName=Bb;return gc}function tf(V,Ga,Bb,gc,
dd){Bb=Kf.call(this,Bb,gc)||this;Bb.activeFloatingObjectControlId=V;Bb.sheetName=Ga;Bb.type=dd;return Bb}function Kf(V,Ga){var Bb=this;this.rFh=function(){var gc={};gc.SourceItem=Bb.toString();return gc};this.sessionStateId=V;this.sessionId=Ga;this.toJSON=this.rFh}function Ff(V,Ga,Bb,gc,dd){var sd=V.Stopwatch,ie={};ie.a=dd;ie.e=sd.id;ie.c="RearrangeRowColumn";ie.b="mouse";ie.d=V.OperationId.toString();ie.f=Bb.toString();ie.g=gc.toString();ie.h=Ga.toString();ie.i=V.DragDropIsShiftKeyDown;ie.j=!0;ie.o=
sd.Bc;ie.q=!1;ie.r=V.CopyPasteTargetType.toString();ie.s=V.EncounteredDeploymentErrors;return ie}function Pe(V){V=ig.call(this,V)||this;V.LYg=function(){fc.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};fc.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");V.jc=0;V.Dc(1,Rf.a.instance.fa(2205));var Ga=Rf.a.instance.fa(2203),Bb=V.GV();V.initializeAndShow(Ga,V.LYg,Bb);return V}function Xe(){this.tb=null}function de(){this.Cib=
this.KSb=this.dw=null}function Kd(V,Ga,Bb,gc,dd){this.dw=V;this.Pib=Ga;this.Lib=Bb;this.Mde=void 0===gc?null:gc;this.Ukb=void 0===dd?null:dd}function pe(){this.tb=null}function Lf(V){this.pc=V}function Be(){this.rie=0;this.HWa=Array(5);this.HWa[0]=10;this.HWa[1]=15;this.HWa[2]=50;this.HWa[3]=100;this.HWa[4]=200}function eg(V,Ga,Bb,gc,dd){this.H$b=!1;this.lsb=null;this.La=V;this.YXa=Ga;this.WVb=Bb;this.x1=gc;this.jFc=dd}function Jc(){this.XNf=this.PSf=this.X7f=this.Ejc=this.instance=null}function Yd(V,
Ga,Bb){this.La=V;this.df=Ga;this.mTb=Bb}function Ge(){this.completed=this.b9i=!1}function ud(){this.Sge=this.tbe=this.c2d=!0;this.Bdj=this.ZXi=null;this.mBi=!1;this.locale=null;this.Bag={}}function Ye(){}function mf(){this.uVb=this.JSb=null}function xe(V){return ya.call(this,V)||this}function Qe(){this.tb=null}function jg(V,Ga){if(void 0===V||null===V||void 0===Ga||null===Ga)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.vb=V;this.Mg=Ga;this.UQc=this.ze=null}function je(){this.eJe=
this.meg=this.Vt=0;this.fJe=this.oeg=this.CHa="";this.CRc=this.Cea=2}function pf(V,Ga){this.rGc=0;this.V2b=null;this.Zib=new le(V,Ga);this.vb=V;Ga=V.Ua("HostAuthType");this.pEa=V.ra("OcpsIsEnabled")&&V.ra("IsO365CommercialHost")&&!(void 0===Ga||null===Ga)&&"aad"===Ga.toLowerCase();this.nce=vf.b(V.Ua("OcpsDefaultSettings")||"{}");this.Pjb=this.Abc();Ga=this.vb.mz("ServicesControlsMicrosoftControllerServicesList")?this.vb.Iw("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.ERb=new wf.a;
for(var Bb=0;Bb<Ga.length;Bb++)this.ERb.add(Ga[Bb]);this.pEa&&!V.ra("IsAnonymousUser")&&V.ra("SideCarIsEnabled")?this.V2b=this.IMj():this.V2b=this.woa(this.pEa,this.iva("/afhs/CloudPolicySettings.ashx"),Object(fb.a)(this,this.cWi,"parseCloudPolicySettingsResponse"));this.V2b.then(function(){return null}).catch(function(gc){fc.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(gc))})}function qg(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}function Gf(){}function Mg(V,Ga){this.PolicySettings=
null;this.ExpirationTime=0;this.PolicySettings=V.PolicySettings;V=new Date;V.setMinutes(V.getMinutes()+Ga);this.ExpirationTime=V.getTime()}function dg(V,Ga,Bb,gc,dd){var sd=this;Bb=void 0===Bb?null:Bb;gc=void 0===gc?null:gc;dd=void 0===dd?null:dd;this.zua=this.ZVb=this.Ree=this.sqa=this.bXb=null;this.Zib=new le(V,Ga);this.vb=V;this.Erg=V.Dd("LicensingMaxRetryAttempts",0);this.wLc=V.ra("IsO365ConsumerHost");this.vLc=V.ra("IsO365CommercialHost");this.GTb=V.ra("PremiumUpsellIsEnabled");this.z3d=Bb;this.Yie=
gc;this.La=dd;this.rqa=V.ra("LicensingIsEnabled");this.pEa=V.ra("OcpsIsEnabled")&&this.vLc;this.RSc=V.ra("ShowPrivacyDialog")&&!!gc;this.G8d=V.ra("IsAnonymousUser");this.S$c=new Promise(function(ie){ie(!1)});this.zBa=new Promise(function(ie){ie(!0)});this.yua=new fe.a(oa.a.Pk());this.PXb=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1);this.hae=this.wRh();this.Apd()&&!this.G8d?(void 0!==Od.AFrameworkApplication.ta&&null!==Od.AFrameworkApplication.ta&&
(this.bXb=Od.AFrameworkApplication.ta.JD,void 0!==this.bXb&&null!==this.bXb&&(this.sqa=this.bXb.$g("WebServiceCall","ApplicationFeatureHelperService"))),this.zua=this.nXd()):this.zua=new Promise(function(ie){ie({})});this.zua.catch(function(ie){fc.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(ie))});this.PXb&&(this.GTb=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(function(ie){sd.GTb=sd.vb.ra("PremiumUpsellIsEnabled")&&ie;return null}))}function lc(V,Ga,Bb){this.featureName=null;this.isEnabled=
!1;this.tierName=0;this.featureName=V;this.isEnabled=Ga;this.tierName=Bb}function Nc(V,Ga){this.VJj=3E5;if(void 0===V||null===V||void 0===Ga||null===Ga)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.vb=V;this.CQb=new fe.a(oa.a.Pk());this.Zib=new le(V,Ga);void 0!==Ze.a.Qud&&null!==Ze.a.Qud&&void 0!==Ze.a.wkc&&null!==Ze.a.wkc&&0<Ze.a.wkc&&(V=new Nd,V.Token=Ze.a.Qud,V.ExpirationTime=Ze.a.wkc,this.CQb.ia("loki",V))}function Nd(){this.Token=null;this.ExpirationTime=0}function le(V,
Ga){this.vb=V;this.Mg=Ga}function ke(){this.message=null;this.uec=0}b.r(C);var xd=b(0),fc=b(14),fe=b(895),oa=b(616),fb=b(82),Rb=b(83),dc;(function(V){V[V.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";V[V.cloudPolicySettings=1]="cloudPolicySettings";V[V.alternateAuthToken=2]="alternateAuthToken"})(dc||(dc={}));Object(xd.b)("ApplicationFeatureHelperRequestType",dc);Object(xd.a)(ke,"HttpRequstToPromiseRejectData",null,[]);var uc=b(100),Bd=b(243);le.prototype.O3c=function(V,Ga,
Bb,gc,dd,sd,ie,Ce){var af=this;gc=void 0===gc?null:gc;dd=void 0===dd?null:dd;sd=void 0===sd?null:sd;ie=void 0===ie?null:ie;Ce=void 0===Ce?null:Ce;var ff=dc[Bb],fg=ff+"RequestFailure";uc.Health.instance.recordKpiUsage(fg,0,"jpittsdirects",null);return new Promise(function(Ig,ah){fc.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",ff);var bh=null!=ie?ie:af.vb.Dd("ApplicationFeatureHelperRequestQueueTimeout",15E3),me=null!=Ce?Ce:
af.vb.Dd("ApplicationFeatureHelperRequestSentTimeout",3E4);af.Mg.K9(V,1,null,af.$Ph(Bb,gc),sd,!1,1,function($e){fc.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",ff);try{if(void 0===$e||null===$e||void 0===$e.data||null===$e.data||void 0===$e.data.ke||null===$e.data.ke){uc.Health.instance.recordKpiFailure(fg,"Invalid RequestSucceededEventArgs",!1,!0,null);var Kh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
ff);ah(af.gwb(Kh,$e))}else if($e.data.httpStatus!==Bd.a.kP){uc.Health.instance.recordKpiFailure(fg,"HttpStatusCode_"+$e.data.httpStatus.toString(),!1,!0,null);var Ph=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",$e.data.httpStatus,ff);ah(af.gwb(Ph,$e))}else{void 0!==dd&&null!==dd&&void 0!==$e.data.responseHeaders&&null!==$e.data.responseHeaders&&dd($e.data.responseHeaders);
var Tf=Ga($e.data.ke);if(Tf)fc.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",ff),Ig(Tf);else{uc.Health.instance.recordKpiFailure(fg,"Parse Failure",!1,!0,null);var Qi=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",ff);ah(af.gwb(Qi,$e))}}}catch(T){uc.Health.instance.recordKpiFailure(fg,"Unexpected Failure",!1,!0,null),Kh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
T,ff),ah(af.gwb(Kh,$e))}},function($e){fc.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",ff);if($e.data){uc.Health.instance.recordKpiFailure(fg,"HttpStatusCode_"+$e.data.httpStatus.toString(),!1,!0,null);var Kh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",$e.data.httpStatus,$e.data.ke||"No Data",ff)}else uc.Health.instance.recordKpiFailure(fg,
"Invalid RequestFailedEventArgs",!1,!0,null),Kh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",ff);ah(af.gwb(Kh,$e))},null,void 0,void 0,bh,me)})};le.prototype.gwb=function(V,Ga){var Bb=new ke;Bb.message=V;Bb.uec=Ga&&Ga.data?Ga.data.httpStatus:-1;return Bb};le.prototype.$Ph=function(V,Ga){var Bb={};Bb["x-UserDataSignature"]=this.vb.Ua("UserDataSignature");Bb["x-LicensingIsEnabled"]=this.vb.ra("LicensingIsEnabled").toString();
Bb["x-CacheIsEnabled"]=this.vb.ra("LicensingRedisIsEnabled").toString();Bb["x-OcpsIsEnabled"]=this.vb.ra("OcpsIsEnabled").toString();Bb["x-LicensingAADIdIsEnabled"]=this.vb.ra("LicensingAadIdIsEnabled").toString();0===V&&(Bb["x-LicenseCheckOnTenantEnabled"]=this.vb.ra("LicensingForSafeLinksIsEnabled").toString(),Bb["x-SupportUserConsentDependentFeatures"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1).toString(),Bb["x-AFHUserConsentGroupValue"]=
this.vb.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),Bb["x-UseShellServiceForUserConsentGroup"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),Bb["x-UseSALForLicensing"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),Bb["x-SMBUserLicensingEnabled"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",!1).toString());
if(Ga){V=El(Ga.keys);for(var gc=V.next();!gc.done;gc=V.next())gc=gc.value,Bb[gc]=Ga.oa(gc)}return Bb};Object(xd.a)(le,"HttpRequestToPromiseUtility",null,[]);var Od=b(4),Td;(function(V){V[V.loki=0]="loki";V[V.augloopACLP=1]="augloopACLP"})(Td||(Td={}));Object(xd.b)("AlternateAuthSupportApp",Td);var Ze=b(942),vf=b(41);Object(xd.a)(Nd,"WacAlternateAuthToken",null,[]);Nc.prototype.lIh=function(){var V=null;this.CQb.xb(Td[0])&&(V=this.CQb.oa(Td[0]));return void 0===V||null===V||this.mrd(V)?this.Qyh():
Promise.resolve(V.Token)};Nc.prototype.mrd=function(V){return V.ExpirationTime-Date.now()<this.VJj};Nc.prototype.Qyh=function(){var V=this,Ga=new fe.a(oa.a.Pk());Ga.ia("X-AlternateAuthApp",Td[0]);return this.Zib.O3c(this.iva("/afhs/AlternateAuthHelperHandler.ashx"),Object(fb.a)(this,this.ZVi,"parseAlternateAuthTokenResponse"),2,Ga).then(function(Bb){fc.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",Td[0]);V.CQb.ia(Td[0],
Bb);return Bb.Token},function(Bb){Bb=Object(Rb.a)(ke,Bb);fc.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",Bb.message,Bb.uec);return null})};Nc.prototype.ZVi=function(V){var Ga=vf.d(V).dv;fc.ULS.sendTraceTag(545821457,3004,Ga?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",V);return Ga};Nc.prototype.iva=function(V){return String.format("{0}{1}?{2}",this.vb.Ua("WebServiceBase"),V,Od.AFrameworkApplication.oj)};
Object(xd.a)(Nc,"AlternateAuthHelper",null,[502]);var wf=b(490);Object(xd.a)(lc,"FeatureStateChangeArgs",null,[]);var Wf=b(134),ug=b(260),Gg=b(24),Cf=b(112),rg=b(176),dh;(function(V){V[V.Enabled=0]="Enabled";V[V.Disabled=1]="Disabled"})(dh||(dh={}));Object(xd.b)("FeatureState",dh);var fh=b(85),vg=b(27),Me=b(356);dg.prototype.wRh=function(){for(var V=this.vb.mz("AllLicensedFeatures")?this.vb.Iw("AllLicensedFeatures"):[],Ga=new wf.a,Bb=0;Bb<V.length;Bb++)Ga.add(V[Bb]);return Ga};dg.prototype.Apd=function(){return this.vLc||
this.wLc};dg.prototype.nXd=function(V,Ga){var Bb=this;V=void 0===V?0:V;Ga=void 0===Ga?!1:Ga;fc.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Ga);var gc=Wf.a.Xr();gc&&(gc.set("retryAttempt",V.toString()),gc.set("forceRefresh",Ga.toString()),gc.set("isO365ConsumerHost",this.wLc.toString()),gc.set("isO365CommercialHost",this.vLc.toString()),gc.set("isFreemiumUpsellEnabled",this.GTb.toString()));uc.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",gc);uc.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",gc);void 0!==this.sqa&&null!==this.sqa&&this.sqa.start();var dd=null;Ga&&(dd=new fe.a(oa.a.Pk()),dd.ia("x-LicensingForceRefresh","true"));this.Ree=new Date;return(this.rqa?this.Zib.O3c(this.iva("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(fb.a)(this,this.bWi,"parseApplicationFeatureHelperResponse"),0,dd,Object(fb.a)(this,this.u0i,"processApplicationFeatureHelperResponseHeaders"),["Date"]):
Promise.resolve({})).then(function(sd){var ie=Object.assign(new Me.a,{durationMs:Bb.T5f()});ie.extendedProperties=gc;ie.extendedProperties&&sd&&(ie.extendedProperties.set("featureCount",Cf.a.count(sd).toString()),ie.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in sd).toString()),ie.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in sd).toString()),Bb.ZVb&&ie.extendedProperties.set("fromCache",(Bb.ZVb<Bb.Ree).toString()));uc.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
ie);return sd},function(sd){var ie=Object.assign(new Me.a,{durationMs:Bb.T5f()}),Ce=Object(Rb.a)(ke,sd);if(!Ce)return fc.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),uc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ie),new Promise(function(af,ff){ff(sd)});ie.extendedProperties=gc;ie.extendedProperties&&ie.extendedProperties.set("status",Ce.uec.toString());
uc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ie);return 408===Ce.uec&&++V<=Bb.Erg?Bb.nXd(V):new Promise(function(af,ff){ff(Ce)})})};dg.prototype.bWi=function(V){(V=vf.b(V))?(fc.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),fc.ULS.sendTraceTag(50938594,3004,50,"{0}",V)):fc.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return V.Features};dg.prototype.iva=function(V){var Ga=String.format("{0}{1}",this.vb.Ua("WebServiceBase"),V);this.vb.mz("ApplicationFeatureHelperHttpCachingEnabled")&&this.vb.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(V=dg.Abc(this.vb))&&0<V.length&&(this.PXb&&(V+="ucbf"),Ga=new ug.QueryStringBuilder(Ga),Ga.Xi("afhskey",V),Ga=Ga.toString());return Ga};dg.prototype.isFeatureEnabled=function(V,Ga){var Bb=this;if(!this.pEa&&!this.RSc&&!this.rqa)return this.zBa;fc.ULS.sendTraceTag(42513091,3004,
50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",V);if("ConnectedServices"===V){var gc=this.pEa?this.z3d.ZJ("ControllerConnectedServicesEnabled"):this.zBa,dd=this.RSc?this.Yie.getSettings().then(function(Ce){return 2!==Ce.Vt},function(){return Ga}):this.zBa;return gc.then(function(Ce){return Ce?dd:Bb.S$c})}gc=null;gc=this.pEa?this.z3d.isFeatureEnabled(V):this.zBa;var sd=null;sd=this.rqa?this.fhi(V,Ga):this.zBa;var ie=null;ie=this.RSc?this.Yie.isFeatureEnabled(V):
this.zBa;return gc.then(function(Ce){return Ce?ie.then(function(af){return af?sd:Bb.S$c}):Bb.S$c}).then(function(Ce){Bb.ylf(V,Ce,!0);return Ce},function(){Bb.ylf(V,Ga,!1);return Ga})};dg.prototype.ylf=function(V,Ga,Bb){fc.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",V,Ga,Bb)};dg.prototype.getFeatureTier=function(V,Ga){var Bb=this;if(!this.rqa)return new Promise(function(gc){gc(2)});fc.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",
V);return this.zua.then(function(gc){return Bb.ycc(V,gc,Ga)},function(){return Ga})};dg.prototype.isFreemiumUpsellEnabled=function(){return this.GTb&&this.wLc&&!this.G8d};dg.prototype.launchUpsellExperience=function(V,Ga){Ga=void 0===Ga?null:Ga;fc.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",V));var Bb=Wf.a.Xr();Bb&&(Bb.set("experienceId",V),Ga&&Bb.set("campaignId",Ga));uc.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",Bb);if(Bb=fh.a.instance.Kh("Common.IInProductMessagingUIManager")){var gc=Object(fb.a)(this,this.X1h,"handleDimeTaskComplete");Bb.Fjf(V,gc,Ga)}else fc.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),uc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),Ga={},this.La.ve(vg.a.I$b,2,(Ga.experience=V,Ga))};dg.prototype.Ima=function(V,Ga){if(!this.rqa)return null;if(!V||!Ga)return fc.ULS.sendTraceTag(594564813,
3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;var Bb=rg.a.create().toString();this.yua.xb(V)||this.yua.ia(V,new fe.a(oa.a.Pk()));this.yua.oa(V).add(Bb,Ga);fc.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Bb,V));return Bb};dg.prototype.xId=function(V,Ga){this.rqa&&(V&&this.yua.xb(V)?Ga&&rg.a.isValid(Ga)?this.yua.oa(V).xb(Ga)?(fc.ULS.sendTraceTag(594564808,
3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",Ga,V)),this.yua.oa(V).remove(Ga)):fc.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Ga,V)):fc.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Ga,V)):fc.ULS.sendTraceTag(594564811,
3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",V)))};dg.prototype.ycc=function(V,Ga,Bb){return this.PXb?V in Ga?Ga[V].LicenseTier:Bb:V in Ga?this.zWi(Ga[V],Bb):Bb};dg.prototype.zWi=function(V,Ga){switch(V.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Ga}};dg.prototype.X1h=function(){var V=this;fc.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");
this.zua.then(function(Ga){V.$Mf(Ga)}).catch(function(){V.$Mf({})})};dg.prototype.$Mf=function(V){var Ga=this;fc.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var Bb=this.nXd(0,!0);Bb.then(function(gc){Ga.zua=Bb;Cf.a.count(gc)>Cf.a.count(V)?uc.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):uc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(var dd=El(Ga.yua.keys),sd=dd.next();!sd.done;sd=
dd.next())if(sd=sd.value,sd in gc){var ie=Ga.ycc(sd,gc,0);sd in V?Ga.ycc(sd,V,0)!==ie&&Ga.yyd(sd,!0,ie):Ga.yyd(sd,!0,ie)}else sd in V&&Ga.yyd(sd,!1,Ga.ycc(sd,V,0))}).catch(function(gc){uc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);fc.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(gc))})};dg.prototype.yyd=function(V,Ga,Bb){fc.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
V,Ga,Bb);Ga=new lc(V,Ga,Bb);Bb=this.yua.oa(V);Bb=El(Bb);for(var gc=Bb.next();!gc.done;gc=Bb.next()){gc=gc.value;try{gc.value(Ga)}catch(dd){fc.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",V,gc.key,dd.message))}}};dg.prototype.me=function(V,Ga){var Bb=this;if(this.rqa){var gc=this.hae.contains(V),dd=!0,sd="",ie=!1;return this.zua.then(function(Ce){V in Ce?
(Ce=Ce[V],sd=dh[Ce.FeatureState],dd=1!==Ce.FeatureState):dd=!gc;Bb.Klf(V,gc,sd,ie,Ga,dd);return dd},function(){ie=!0;gc&&(dd=Ga);Bb.Klf(V,gc,sd,ie,Ga,dd);return dd})}return this.zBa};dg.prototype.Klf=function(V,Ga,Bb,gc,dd,sd){fc.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",V,Ga,gc,Bb,dd,sd)};dg.prototype.fhi=function(V,Ga){if(this.PXb)return this.me(V,Ga);if(this.rqa){if(this.hae.contains(V))return this.zua.then(function(Bb){return V in
Bb},function(){return Ga});fc.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",V)}return this.zBa};dg.prototype.u0i=function(V){try{V&&"Date"in V&&(this.ZVb=new Date(V.Date),fc.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.ZVb.toString()))}catch(Ga){fc.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
Ga)}};dg.prototype.T5f=function(){if(void 0!==this.sqa&&null!==this.sqa){var V=this.sqa.Bc;this.sqa.stop();return V}return null};dg.Abc=function(V){try{if(Gg.a.iGj){var Ga=V.Ua("UserDataSignature").split(".");if(1<Ga.length){var Bb=window.self.atob(Ga[1]),gc=JSON.parse(Bb).LocalStorageKey;if(void 0!==gc&&null!==gc&&0<gc.length)return gc}}}catch(dd){fc.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",dd.toString())}return null};Object(xd.a)(dg,"ApplicationFeatureHelper",null,
[503]);var Of=b(202);Object(xd.a)(Mg,"CloudPolicySettingsCacheData",null,[]);var ac=b(1026),Lc=b(391),wd=b(232);Gf.f4f=function(){return Od.AFrameworkApplication.ga.ra("SideCarIsEnabled")?Gf.Vuc&&Gf.$nd?new Promise(function(V){V(!0)}):new Promise(function(V,Ga){Gf.Vuc=wd.a.create(Od.AFrameworkApplication.ga.Ua("SideCarUrl"));Lc.a.xia(Gf.Vuc);Gf.Vuc.O9(function(Bb,gc){(Gf.$nd=gc.succeeded)?V(gc.succeeded):Ga(gc.succeeded)})}):new Promise(function(V){V(!1)})};Gf.$nd=!1;Gf.Vuc=null;Object(xd.a)(Gf,"SideCarLoader",
null,[]);Object(xd.a)(qg,"CloudPolicySettingsData",null,[]);pf.prototype.ZJ=function(V,Ga){Ga=void 0===Ga?!0:Ga;if(!this.pEa){var Bb=this;return new Promise(function(ie){ie(Bb.Svb(V))})}var gc=this,dd=this,sd=this.V2b.then(function(ie){try{var Ce=null;ie.PolicySettings&&"unknown"in ie.PolicySettings&&(Ce=ie.PolicySettings.unknown);if(Ce){if(V in Ce&&void 0!==Ce[V]&&null!==Ce[V])return new Promise(function(ff){ff("0"!==Ce[V])});var af=V.toLowerCase();if(af in Ce&&void 0!==Ce[af]&&null!==Ce[af])return new Promise(function(ff){ff("0"!==
Ce[af])});fc.ULS.sendTraceTag(51512667,3004,50,"Policy"+V+" not found, using default");return new Promise(function(ff){ff(gc.Svb(V))})}return new Promise(function(ff){ff(gc.Svb(V))})}catch(ff){return fc.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+V+" policy value. Error Message: {0}",ff.message),gc.handleError(ff.toString(),Ga,gc.Svb(V))}},function(ie){return dd.handleError(ie,Ga,dd.Svb(V))});sd.then(function(ie){fc.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",
V,ie);return null});return sd};pf.prototype.isFeatureEnabled=function(V,Ga){Ga=void 0===Ga?!0:Ga;if(this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.hhi(V,Ga);var Bb=new Promise(function(dd){dd(!0)}),gc="";this.ERb.contains(V)&&(gc="ControllerConnectedServicesEnabled",Bb=this.ZJ(gc,Ga));Bb.then(function(dd){fc.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
V,dd,gc);return null});return Bb};pf.prototype.hhi=function(V,Ga){Ga=void 0===Ga?!0:Ga;var Bb=new Promise(function(dd){dd(!0)}),gc="";"mso_sendASmile"===V?gc="Enabled":"Survey"===V||"FloodgateSurvey"===V?gc="SurveyEnabled":this.ERb.contains(V)&&(gc="ControllerConnectedServicesEnabled");""!==gc&&(Bb=this.ZJ(gc,Ga));Bb.then(function(dd){fc.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",V,dd,gc);return null});return Bb};
pf.prototype.handleError=function(V,Ga,Bb){return Ga?new Promise(function(gc){gc(Bb)}):new Promise(function(gc,dd){dd(V)})};pf.prototype.woa=function(V,Ga,Bb){var gc=this;if(!V)return Promise.resolve(new qg);var dd=!1,sd=null;uc.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var ie=this.k3c("GetCloudPolicySettings");return(new Promise(function(Ce,af){if(void 0!==gc.Pjb&&null!==gc.Pjb&&0<gc.Pjb.length){var ff=gc.sMj();if(void 0!==ff&&null!==ff){dd=!0;Ce(ff);return}}gc.Zib.O3c(Ga,
Bb,1,null,Object(fb.a)(gc,gc.y0i,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],gc.vb.Dd("CloudPolicySettingsRequestQueueTimeout",15E3),gc.vb.Dd("CloudPolicySettingsRequestSentTimeout",3E4)).then(function(fg){fc.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");gc.hNj(fg);Ce(fg);return fg},function(fg){af(fg);return null})})).then(function(Ce){var af=gc.Uyc(ie);ie=af.stopwatch;sd=af.returnValue;(af=Wf.a.Xr())&&af.set("FromCache",dd.toString());af=
Object.assign(new Me.a,{durationMs:sd,extendedProperties:af});uc.Health.instance.recordKpiSuccess("GetCloudPolicySettings",af);return Ce})};pf.prototype.IMj=function(){return Gf.f4f().then(function(){fc.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})};pf.prototype.iva=function(V){return String.format("{0}{1}",this.vb.Ua("WebServiceBase"),V)};pf.prototype.cWi=function(V){var Ga=
vf.d(V).dv;fc.ULS.sendTraceTag(50622687,3004,Ga?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",V);return Ga};pf.prototype.y0i=function(V){try{if(void 0!==V&&null!==V&&"CheckIn-Interval"in V){var Ga=parseInt(V["CheckIn-Interval"]);void 0!==Ga&&null!==Ga&&0<Ga&&(this.rGc=Ga)}}catch(Bb){fc.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",Bb)}};pf.prototype.Svb=function(V){return V in this.nce?"0"!==this.nce[V]:!0};pf.prototype.sMj=
function(){try{var V=ac.a.instance.getItem(this.Pjb);if(void 0===V||null===V)return fc.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;fc.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",V);var Ga=JSON.parse(V);if(void 0===Ga||null===Ga)return fc.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===
Ga.ExpirationTime||null===Ga.ExpirationTime)return fc.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(Ga.ExpirationTime)).getTime()<Date.now())return fc.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var Bb=new qg;Bb.PolicySettings=Ga.PolicySettings;Bb.ControllerConnectedServicesFeatureNames=new Of.a;this.vb.mz("ServicesControlsMicrosoftControllerServicesList")&&
this.vb.Iw("ServicesControlsMicrosoftControllerServicesList");for(var gc=El(this.ERb),dd=gc.next();!dd.done;dd=gc.next())Bb.ControllerConnectedServicesFeatureNames.add(dd.value);fc.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Bb}catch(sd){return fc.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",sd.toString()),null}};pf.prototype.hNj=function(V){try{if(void 0===V||null===V||void 0===V.PolicySettings||
null===V.PolicySettings)fc.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.rGc)fc.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var Ga=new Mg(V,this.rGc),Bb=JSON.stringify(Ga);fc.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Bb);ac.a.instance.setItem(this.Pjb,Bb);fc.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(gc){fc.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",gc.toString())}};pf.prototype.Abc=function(){var V=dg.Abc(this.vb);return V&&0<V.length?"OCPS"+V:null};pf.prototype.k3c=function(V){var Ga=fh.a.instance.Kh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==Ga&&null!==Ga?Ga.Gc("WebServiceCall",V):null};pf.prototype.Uyc=function(V){if(void 0!==V&&null!==V){var Ga=V.Bc;V.stop();return{returnValue:Ga,stopwatch:null}}return{returnValue:null,stopwatch:V}};Object(xd.a)(pf,
"CloudPolicySettingsHelper",null,[500]);je.prototype.clone=function(){var V=new je;V.Vt=this.Vt;V.meg=this.meg;V.eJe=this.eJe;V.CHa=this.CHa;V.oeg=this.oeg;V.fJe=this.fJe;V.Cea=this.Cea;V.CRc=this.src;return V};je.prototype.serialize=function(V){V=void 0===V?null:V;var Ga={};if(!V||V.contains(je.zOa))Ga[je.zOa]=this.Vt;if(!V||V.contains(je.HDb))Ga[je.HDb]=this.CHa;if(!V||V.contains(je.IDb))Ga[je.IDb]=this.Cea;return JSON.stringify(Ga)};je.create=function(V,Ga){Ga=void 0===Ga?null:Ga;var Bb=new je;
Bb.CRc=V;void 0!==Ga&&null!==Ga&&(je.zOa in Ga&&(Bb.Vt=Ga[je.zOa]),je.HDb in Ga&&(Bb.CHa=Ga[je.HDb]),je.IDb in Ga&&(Bb.Cea=Ga[je.IDb]));return Bb};je.deserialize=function(V,Ga){try{var Bb=JSON.parse(V);if(void 0!==Bb&&null!==Bb)return je.create(Ga,Bb);fc.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",V);throw Error.argument("settingsData");}catch(gc){throw fc.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",gc.toString()),
gc;}};Ek.Object.defineProperties(je.prototype,{src:{configurable:!0,enumerable:!0,get:function(){return this.CRc}}});je.zOa="CCS";je.HDb="CCSTime";je.IDb="OfficePrivacyRoamedNoticeShown";Object(xd.a)(je,"UserPrivacySettings",null,[]);var Mc=b(126);jg.prototype.iva=function(V){var Ga=String.format("{0}RoamingServiceHandler.ashx?action=",this.vb.appSettings.RoamingServiceHandlerWebServiceBase||"");Ga=new Sys.StringBuilder(Ga);Ga.append(V);Ga.append("&");Ga.append(Od.AFrameworkApplication.oj);return Ga.toString()};
jg.prototype.executeRequest=function(V,Ga,Bb,gc){return this.Mg.gZb(V,Ga,void 0===gc?null:gc,null,Bb,"33",!1,null,6E4)};jg.prototype.saveSettings=function(V){var Ga=this;return new Promise(function(Bb,gc){try{if(void 0===Ga.ze||null===Ga.ze||void 0===V||null===V)fc.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),gc("Can't determine setting changes to save");else{var dd=Ga.ze.Vt!==V.Vt;if(2===Ga.ze.src&&dd)Ga.ljj(V),Bb(!0);else{var sd=Ga.enj(V);
if(void 0===sd||null===sd||!sd.length)fc.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),gc("No changes to save");else if(1===Ga.ze.src)Bb(Ga.jag(sd));else if(0===Ga.ze.src){fc.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",sd);var ie=Ga.executeRequest(Ga.iva("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",sd);ie.continueWith(function(){if(ie.Oh||ie.ig)fc.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
Bb(!1);else{var Ce=ie.result;void 0!==Ce.fh&&null!==Ce.fh&&void 0!==Ce.fh.data&&null!==Ce.fh.data&&Ce.fh.data.httpStatus===Bd.a.kP?(fc.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),Bb(!0)):(fc.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),Bb(!1))}})}}}}catch(Ce){fc.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",Ce.toString()),Bb(!1)}})};jg.prototype.enj=function(V){if(void 0===this.ze||null===
this.ze||void 0===V||null===V)throw Error.invalidOperation("User Privacy settings have not been initialized");var Ga=new Of.a;0===V.src?(this.ze.Vt!==V.Vt&&(Ga.add(je.zOa),Ga.add(je.HDb)),this.ze.Cea!==V.Cea&&Ga.add(je.IDb)):1===V.src&&this.ze.Vt!==V.Vt&&Ga.add(je.zOa);return Ga.count?V.serialize(Ga):(fc.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)};jg.prototype.getSettings=function(){if(!this.UQc){var V=this;this.UQc=new Promise(function(Ga){try{V.ze?
Ga(V.ze.clone()):V.AMj().then(function(Bb){V.ze=Bb;Ga(V.ze.clone());return null},function(){V.yMj().then(function(Bb){V.ze=Bb;Ga(V.ze.clone());return null},function(){V.zMj().then(function(Bb){V.ze=Bb;Ga(V.ze.clone());return null},function(){fc.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");V.ze=new je;Ga(V.ze.clone());return null});return null});return null})}catch(Bb){fc.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
Bb.toString()),V.ze=new je,Ga(V.ze.clone())}})}return this.UQc};jg.prototype.AMj=function(){var V=this;return new Promise(function(Ga,Bb){try{var gc=-1!==window.location.href.indexOf("&wd_pn=2");if(V.vb.ra("PrivacyDialogShouldCheckRoaming")||gc){var dd=V.executeRequest(V.iva("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");dd.continueWith(function(){try{if(dd.Oh||dd.ig)fc.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{var sd=dd.result;
if(sd&&sd.fh&&sd.fh.data)if(sd.fh.data.httpStatus!==Bd.a.kP)fc.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",sd.fh.data.httpStatus);else{if(sd.fh.data.ke){Ga(jg.parse(sd.fh.data.ke,0));fc.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",sd.fh.data.ke);return}fc.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else fc.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");Bb("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(ie){fc.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",ie.toString()),Bb("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else fc.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),Bb("Roaming should not be used")}catch(sd){fc.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",sd.toString()),Bb("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})};jg.prototype.yMj=function(){var V=this;return new Promise(function(Ga,Bb){try{var gc=Mc.a.get("WacUPToggleState"),dd=null;void 0!==gc&&null!==gc&&0<gc.length&&(dd=decodeURIComponent(gc));if(void 0!==dd&&null!==dd&&0<dd.length){var sd=jg.parse(dd,1);fc.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",sd.toString());
Ga(sd)}else{var ie=je.create(1),Ce=new Of.a;Ce.add(je.zOa);var af=ie.serialize(Ce);V.jag(af)?(fc.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",af),Ga(ie)):(fc.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",af),Bb("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(ff){fc.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
ff.toString()),Bb("UserPrivacySettings TryGetSettingsFromCookie Eception")}})};jg.prototype.zMj=function(){return new Promise(function(V){try{var Ga=-1!==window.location.href.indexOf("&wdccsoff=1"),Bb=je.create(2);Ga?(Bb.Vt=2,Od.AFrameworkApplication.PHe(),fc.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Bb.toString())):(Bb.Vt=1,fc.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
Bb.toString()));V(Bb)}catch(gc){fc.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",gc.toString()),Ga=je.create(2),Ga.Vt=1,V(Ga)}})};jg.prototype.ljj=function(V){fc.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===V.Vt?Od.AFrameworkApplication.PHe():Od.AFrameworkApplication.Wjh();fc.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",V)};jg.prototype.jag=function(V){try{fc.ULS.sendTraceTag(51258455,
3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",V);var Ga=this.vb.Ua("PrivacyCookieDomain")||"";if(!Ga||!Ga.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");fc.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",V);return Mc.a.HPd("WacUPToggleState",V,Mc.a.rW,"/",Ga)}catch(Bb){return fc.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",Bb.toString()),!1}};jg.prototype.isFeatureEnabled=
function(V){var Ga=this;return this.getSettings().then(function(Bb){for(var gc=Ga.vb.mz("ServicesControlsMicrosoftControllerServicesList")?Ga.vb.Iw("ServicesControlsMicrosoftControllerServicesList"):[],dd=new wf.a,sd=0;sd<gc.length;sd++)dd.add(gc[sd]);return dd.contains(V)?2!==Bb.Vt:!0},function(){fc.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",V);return!0})};jg.parse=function(V,Ga){try{return fc.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
V,Ga),je.deserialize(V,Ga)}catch(Bb){throw fc.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Bb.toString()),Bb;}};Object(xd.a)(jg,"UserPrivacySettingsHelper",null,[501]);var ge=b(255);Qe.prototype.ei=function(V){var Ga=this;this.tb=V;this.tb.register(500,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").Hc().Oc(function(){return new pf(Od.AFrameworkApplication.ga,Od.AFrameworkApplication.Jd)});this.tb.register(501,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").Hc().Oc(function(){return new jg(Od.AFrameworkApplication.ga,
Od.AFrameworkApplication.Jd)});this.tb.register(502,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").Hc().Oc(function(){return new Nc(Od.AFrameworkApplication.ga,Od.AFrameworkApplication.Jd)});this.tb.register(503,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").Hc().Oc(function(){return new dg(Od.AFrameworkApplication.ga,Od.AFrameworkApplication.Jd,Ga.tb.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),Ga.tb.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
Od.AFrameworkApplication.Ib)})};Qe.prototype.init=function(){var V=this;Od.AFrameworkApplication.ga.sv(function(){var Ga=V.tb.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Od.AFrameworkApplication.ga.ra("LicensingIsEnabled")&&(Ga.isFeatureEnabled("LicensingTestFeature",!1).then(function(Bb){fc.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",Bb,Od.AFrameworkApplication.ga.Ua("IsAnonymousUser"));
return null}),Ga.getFeatureTier("LicensingTestFeature",0).then(function(Bb){fc.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",Bb,Od.AFrameworkApplication.ga.Ua("IsAnonymousUser"));return null}));V.tb.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");V.DHj()})};Qe.prototype.dispose=function(){};Qe.prototype.DHj=function(){try{Od.AFrameworkApplication.ga.ra("SideCarIsEnabled")&&Gf.f4f().then(function(V){fc.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",V);return V})}catch(V){}};Qe.main=function(){ge.a.instance.hj(new Qe)};Ek.Object.defineProperties(Qe.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}}});Object(xd.a)(Qe,"ApplicationFeatureHelperPackage",null,[4,5]);var nf=b(118),Ee=b(420),ya=Ee.a;Am(xe,ya);xe.prototype.createElement=function(){var V=document.createElement("link");V.setAttribute("rel",
"stylesheet");V.setAttribute("type","text/css");V.setAttribute("href",this.uu);return V};xe.prototype.M3c=function(){return null};xe.prototype.isc=function(){this.element.setAttribute("href","");this.element.setAttribute("href",this.vI.uu)};Ek.Object.defineProperties(xe.prototype,{j4b:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(xd.a)(xe,"CssResource",Ee.a,[]);var Cb=b(29),cc=b(55);mf.prototype.gsi=function(){this.JSb||(fc.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),
this.JSb=cc.Task.WAA(mf.lsi(),mf.dsi()),this.JSb.continueWith(function(V){fc.ULS.sendTraceTag(21030599,324,10,"{0}",Cb.a.ded(V.exception))},5));return this.JSb};mf.prototype.isi=function(){if(!this.uVb)try{fc.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.uVb=cc.Task.WAA(mf.n8c(wd.a.create(Od.AFrameworkApplication.ga.Ua("DimeUrl"),null,null))),this.uVb.continueWith(function(V){fc.ULS.sendTraceTag(39978391,324,10,"{0}",Cb.a.ded(V.exception))},5)}catch(V){fc.ULS.sendTraceTag(594874951,
324,10,"{0}",Cb.a.ded(V))}return this.uVb};mf.lsi=function(){var V=mf.Acc("inproductmessaging.js");V=wd.a.create(V,null,null);return mf.n8c(V)};mf.dsi=function(){var V=mf.Acc("inproductmessaging.css");V=new xe(V);return mf.n8c(V)};mf.Acc=function(V){return nf.a.o3b(String.format("ipm/{0}",V))};mf.n8c=function(V){Lc.a.xia(V);return V.i8a};Object(xd.a)(mf,"DependencyDownloader",null,[984]);Ye.lVi="inProductMessagingOverlayDiv";Ye.YXi="PlayButtonImage";Ye.Adj="ReplayButtonImage";Object(xd.a)(Ye,"Constants",
null,[]);ud.prototype.grj=function(){this.zme(Ye.YXi,this.ZXi);this.zme(Ye.Adj,this.Bdj)};ud.prototype.zme=function(V,Ga){Ga&&(this.Bag[V]=Ga)};Ek.Object.defineProperties(ud.prototype,{HMg:{configurable:!0,enumerable:!0,get:function(){return this.c2d},set:function(V){this.c2d=V}},rAi:{configurable:!0,enumerable:!0,get:function(){return this.tbe},set:function(V){this.tbe=V}},Czj:{configurable:!0,enumerable:!0,get:function(){return this.Sge},set:function(V){(this.Sge=V)&&this.grj()}}});Object(xd.a)(ud,
"FirstRunExperienceUISettings",null,[983]);Object(xd.a)(Ge,"FirstRunExperienceViewData",null,[923]);var Rc=b(180),yd=b(107);Yd.prototype.Qg=function(){this.La.Te(vg.a.OBh,yd.a.frame,Object(fb.a)(this,this.MBh,"firstRunExperienceHandler"),64);this.La.fc(vg.a.KTe,yd.a.frame,Object(fb.a)(this,this.f8h,"inProductMessagingTabHandler"));this.La.fc(vg.a.JTe,yd.a.frame,Object(fb.a)(this,this.e8h,"inProductMessagingShiftTabHandler"));this.La.fc(vg.a.Oeh,yd.a.frame,Object(fb.a)(this,this.Peh,"dimeLaunchHandler"));
this.La.fc(vg.a.pRf,yd.a.frame,Rc.ActionManager.og);this.La.fc(vg.a.Zdj,yd.a.frame,Rc.ActionManager.og);this.La.fc(vg.a.$dj,yd.a.frame,Rc.ActionManager.og);this.df&&this.df.updateCommandUI()};Yd.prototype.MBh=function(V,Ga,Bb,gc,dd){2===Bb&&this.mTb.Fqi(dd);return 32};Yd.prototype.Peh=function(V,Ga,Bb,gc,dd){2===Bb&&this.mTb.Cqi(dd);return 32};Yd.prototype.f8h=function(V,Ga,Bb){return 2===Bb?this.mTb.Wwd():32};Yd.prototype.e8h=function(V,Ga,Bb){return 2===Bb?this.mTb.Uwd():32};Object(xd.a)(Yd,"InProductMessagingActor",
null,[]);Object(xd.a)(Jc,"DimeExperienceUISettings",null,[]);var od=b(165),ze=b(498);eg.prototype.S$h=function(V){od.b("getHeaderApi")?V.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Ga){var Bb=V.isFreemiumUpsellEnabled();Bb&&(appChrome.getHeaderApi().then(function(gc){gc.updatePremiumStatus(Ga,Bb);return null}),V.Ima("MsoPremiumBadge",function(gc){appChrome.getHeaderApi().then(function(dd){dd.updatePremiumStatus(gc.isEnabled,Bb);return null})}));return null}):fc.ULS.sendTraceTag(593859840,
324,10,"getHeaderApi not available")};eg.prototype.Fqi=function(V){var Ga=this;this.WVb.gsi().continueWith(function(){Ga.YXa.YAj(V)})};eg.prototype.Cqi=function(V){function Ga(){}var Bb="gopremium",gc=null;V?(V.experience&&""!==Object(Rb.a)(String,V.experience)&&(Bb=Object(Rb.a)(String,V.experience)),V.onTaskComplete&&(Ga=V.onTaskComplete),V.campaignId&&""!==Object(Rb.a)(String,V.campaignId)&&(gc=Object(Rb.a)(String,V.campaignId))):fc.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");
this.Fjf(Bb,Ga,gc)};eg.prototype.Fjf=function(V,Ga,Bb){var gc=this;Bb=void 0===Bb?null:Bb;if(this.H$b&&this.lsb){var dd={};dd.experience=V||"gopremium";dd.campaignId=Bb||ze.b(this.x1,this.jFc,Object(Rb.a)(String,dd.experience),!0);this.La.processAction(vg.a.pRf,2);fc.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+dd.experience);try{var sd=Object.assign(new Jc,{instance:this.lsb,Ejc:dd,X7f:Ga||function(){},PSf:function(ie){fc.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+
ie.status)},XNf:function(){fc.ULS.sendTraceTag(51675406,324,10,"Dime launch error");gc.H$b=!1;gc.lsb=null}});this.YXa.jzj(sd)}catch(ie){fc.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+ie.message),this.H$b=!1,this.lsb=null,V={},this.La.ve(vg.a.I$b,2,(V.experience=dd.experience,V))}}else fc.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),dd={},this.La.ve(vg.a.I$b,2,(dd.experience=V,dd))};eg.prototype.wkf=function(){var V=this;this.WVb.isi().continueWith(function(){try{var Ga=
Cb.a.Ul(Od.AFrameworkApplication.uiCulture),Bb=ze.c(V.x1);if(Bb){Ga={partnerId:Bb,language:Ga};Ga.sessionId=Od.AFrameworkApplication.userSessionId;Ga.authHint=Od.AFrameworkApplication.ga.Ua("UserPrincipalName");var gc=Od.AFrameworkApplication.ga.Ua("Puid")||"";""!==gc&&(Ga.userInfo={puid:gc});V.lsb=new Dime(Ga);V.H$b=!0;fc.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else fc.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(dd){fc.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+
dd.message)}},3)};eg.prototype.Wwd=function(){return this.YXa.Wwd()};eg.prototype.Uwd=function(){return this.YXa.Uwd()};Object(xd.a)(eg,"InProductMessagingUIManager",null,[903]);Be.prototype.Init=function(V){this.rie=V};Be.prototype.SendTrace=function(V,Ga){fc.ULS.sendTraceTag(34182235,this.rie,this.HWa[V],"{0}",Ga)};Object(xd.a)(Be,"DefaultNetworkingManager",null,[928]);var gf=b(257),of=b(325),tg=b(96);Lf.prototype.YAj=function(V){V&&(InProductMessaging.Networking.NetworkingMgr=new Be,InProductMessaging.Networking.NetworkingMgr.Init(387),
InProductMessaging.Init(V.Czj,V.rAi,V.HMg,V.mBi,V.locale,Object(fb.a)(this,this.EIi,"onDismissFirstRunExperience"),V.Bag),this.DRa(Ye.lVi,!0))};Lf.prototype.jzj=function(V){var Ga=this;if(V&&V.instance&&V.Ejc){var Bb=document.getElementById("wacDimeContainer");Bb||(Bb=document.createElement("div"),Bb.id="wacDimeContainer",document.body.appendChild(Bb));Od.AFrameworkApplication.ga.ra("DimeFocusManagerIsEnabled")&&this.DRa("wacDimeContainer",!1);V.Ejc.parentElementId="wacDimeContainer";V.instance.launch(V.Ejc,
V.X7f).then(function(gc){Ga.KHb();document.body.removeChild(Bb);V.PSf(gc)}).catch(function(gc){Ga.KHb();document.body.removeChild(Bb);V.XNf(gc)})}else throw Error.argument("DimeExperienceUISettings");};Lf.prototype.DRa=function(V,Ga){if(this.pc&&V&&(V=document.getElementById(V),this.J$h(V),V=this.pc.WM("InProductMessagingFocusId"))){var Bb=this.pc.Hi;Bb&&"InProductMessagingFocusId"===Bb.name||this.pc.dS("InProductMessagingFocusId",!1);Ga&&this.bMf(V.scope)}};Lf.prototype.J$h=function(V){var Ga=!1;
Ga=void 0===Ga?!0:Ga;var Bb=this.pc.zi("InProductMessagingFocusId");Bb.parent=gf.AFrame.mU;var gc=new of.DOMFocusListing(function(){return V});gc.cbb=Ga;gc.lo(3);gc.lo(2);gc.lo(4);Ga=this.pc.vsa(function(){return V},Bb,gc);Ga.EHb();Ga.I_=!0;Ga.uHa=!0};Lf.prototype.bMf=function(V){V.Yk(tg.FocusManager.instance().p2);V.Yk(tg.FocusManager.instance().q2);V.bindAction(tg.FocusManager.instance().p2,vg.a.KTe);V.bindAction(tg.FocusManager.instance().q2,vg.a.JTe)};Lf.prototype.KHb=function(){this.pc&&(this.pc.Oca("InProductMessagingFocusId"),
this.pc.qQa("InProductMessagingFocusId"))};Lf.prototype.EIi=function(V,Ga){this.KHb();V=Object.assign(new Ge,{completed:V,b9i:Ga});Od.AFrameworkApplication.Ib.ve(vg.a.LBh,2,V)};Lf.prototype.Wwd=function(){var V=document.activeElement,Ga=this.pc.VQ();return V&&Ga&&Ga.ff&&V===Ga.ff.Ow?(Ga.ff.zl(V),Ga.Yxa()?32:8):4};Lf.prototype.Uwd=function(){var V=document.activeElement,Ga=this.pc.VQ();return V&&Ga&&Ga.ff&&V===Ga.ff.firstElement?(Ga.ff.zl(V),Ga.pOa()?32:8):4};Object(xd.a)(Lf,"InProductMessagingUIWrapper",
null,[902]);var Fe=b(139);pe.prototype.ei=function(V){V.register(mf,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").Hc().Oc(function(){return new mf});V.register(Lf,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").Hc().Oc(function(){return new Lf(tg.FocusManager.instance())});V.register(eg,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").Hc().Oc(function(){return new eg(Od.AFrameworkApplication.Ib,
V.resolve("Common.IInProductMessagingUIWrapper"),V.resolve("Common.App.InProductMessaging.IDependencyDownloader"),Od.AFrameworkApplication.ta.Qa.Sj,Od.AFrameworkApplication.ta.Qa.qca)});V.register(Yd,"Common.App.InProductMessaging.InProductMessagingActor").Hc().Oc(function(){return new Yd(Od.AFrameworkApplication.Ib,Od.AFrameworkApplication.ta,V.resolve("Common.IInProductMessagingUIManager"))});V.register(ud,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").Hc().Oc(function(){return new ud});
V.register(Ge,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").Hc().Oc(function(){return new Ge});this.tb=V};pe.prototype.init=function(){var V=this;this.tb.resolve("Common.App.InProductMessaging.InProductMessagingActor").Qg();Od.AFrameworkApplication.ga.sv(function(){Od.AFrameworkApplication.ta.Qa.isReactSharedHeaderUxEnabled&&Fe.a.get_instance().Mk(15,function(){V.tb.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ga){V.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").S$h(Ga)})});
Od.AFrameworkApplication.ga.ra("FreemiumUpsellShowDialogIsEnabled")&&ze.a()&&!Gg.a.uB&&1!==Od.AFrameworkApplication.ta.Qa.Sj&&V.tb.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ga){Ga.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Bb){!Bb&&Ga.isFreemiumUpsellEnabled()&&V.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").wkf();return null})})})};pe.prototype.dispose=function(){};pe.main=function(){ge.a.instance.hj(new pe)};Ek.Object.defineProperties(pe.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.InProductMessaging"}}});Object(xd.a)(pe,"InProductMessagingPackage",null,[4,5]);Kd.prototype.q$c=function(V){var Ga=new Sys.StringBuilder(this.dw.aJb);Ga.append("RoamingServiceHandler.ashx?action=");Ga.append("getFirstRunExperienceSettings");Ga.append("&");Ga.append(this.fgd(V));Ga.append("&");Ga.append(Od.AFrameworkApplication.oj);Od.AFrameworkApplication.Jd.El(Ga.toString(),1,null,null,!0,2,Object(fb.a)(this,this.xKa,"getRequestSuccessCallback"),
Object(fb.a)(this,this.Cja,"getRequestFailureCallback"),null)};Kd.prototype.Dtb=function(V){var Ga=new Sys.StringBuilder(this.dw.aJb);Ga.append("RoamingServiceHandler.ashx?action=");Ga.append("saveFirstRunExperienceSettings");Ga.append("&");Ga.append(Od.AFrameworkApplication.oj);Ga=Ga.toString();V=vf.c(V);Od.AFrameworkApplication.Jd.El(Ga,2,V,null,!0,4,Object(fb.a)(this,this.uZi,"postRequestSuccessCallback"),Object(fb.a)(this,this.L6,"postRequestFailureCallback"),null)};Kd.prototype.xKa=function(V){var Ga=
!1,Bb=null;try{if(0<V.data.ke.length){var gc=Object(Rb.a)(Object,vf.a(V.data.ke)),dd=gc?gc[this.dw.BWc]:null;dd&&(Bb=Object(Rb.a)(Object,vf.a(dd.toString())))}Ga=!0}catch(sd){this.Cja(null)}Ga&&this.Pib&&this.Pib(V.data,Bb)};Kd.prototype.Cja=function(V){this.Lib&&this.Lib(V?V.data:null)};Kd.prototype.uZi=function(V){this.Mde&&this.Mde(V?V.data:null)};Kd.prototype.L6=function(V){this.Ukb&&this.Ukb(V?V.data:null)};Kd.prototype.fgd=function(V){for(var Ga=new Sys.StringBuilder("requestedsettings="),Bb=
0;Bb<V.count;Bb++)Ga.append(V.oa(Bb)),Bb<V.count-1&&Ga.append(";");return Ga.toString()};Object(xd.a)(Kd,"FirstRunExperienceRequestHandler",null,[]);de.prototype.WRd=function(V){V?(this.dw=V,this.nji()&&(fc.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),V=new Of.a,V.add(this.dw.BWc),this.KSb=new Kd(this.dw,Object(fb.a)(this,this.xKa,"getRequestSuccessCallback"),Object(fb.a)(this,this.Cja,"getRequestFailureCallback"),null,Object(fb.a)(this,
this.L6,"postRequestFailureCallback")),this.KSb.q$c(V)),(this.dw.q7a||Od.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.XRd()):fc.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")};de.prototype.nji=function(){try{if(this.dw.q7a)return!0;if(!Od.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||Od.AFrameworkApplication.ga.ra("IsAnonymousUser"))return!1;if(this.dw.fgi||
this.dw.t7a||Od.AFrameworkApplication.ga.ra("IsO365ConsumerHost"))return!0;var V=Od.AFrameworkApplication.ga.Ua("FlightId");return-1!==(V?V.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Ga){fc.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Ga?Ga.toString():null)}return!1};de.prototype.UUf=function(V){var Ga={},Bb={};Bb.FREDisplayedDate=(new Date).toUTCString();Bb.VersionDisplayed=V;Bb.RemindMeLater=!1;Ga[this.dw.BWc]=vf.c(Bb);fc.ULS.sendTraceTag(51675533,306,50,
"Initiating call to save FRE data for current user from Roaming Settings Service");this.KSb&&this.KSb.Dtb(Ga)};de.prototype.xKa=function(V,Ga){V=V?+V.s3-+V.pF:-1;V>this.dw.JTf?fc.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",V,this.dw.JTf):Ga?this.Zxj(Ga)?(fc.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.dw.Qpf),this.XRd()):fc.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(fc.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.XRd())};de.prototype.Cja=function(V){fc.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",V?V.httpStatus:-1)};de.prototype.L6=function(V){fc.ULS.sendTraceTag(51675542,306,10,
"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",V?V.httpStatus:-1)};de.prototype.XRd=function(){var V=this,Ga=fh.a.instance.Kh("Common.ISystemInitiatedFeedback");Ga?this.V2f(Ga):(fc.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),Od.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Ga=fh.a.instance.lc("Common.ISystemInitiatedFeedback"))?Ga.execute(function(Bb){V.V2f(Bb)}):
fc.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))};de.prototype.V2f=function(V){if(V){var Ga=this.dw.$Bh;Ga&&(Od.AFrameworkApplication.dla(Ga),Od.AFrameworkApplication.j8a(Ga));fc.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Ga);V.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.Cib=Object(fb.a)(this,this.DJi,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",
this.Cib,!0),window.addEventListener("FRELaunchedEvent",this.Cib,!0)):(fc.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.UUf(this.dw.currentVersion))}else fc.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")};de.prototype.DJi=function(V){if(V){var Ga=V.detail;V=V.type;var Bb=this.dw&&this.dw.campaignId?this.dw.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===V||Bb&&Ga&&Ga.id&&-1!==Ga.id.indexOf(Bb))Ga.success&&(fc.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.UUf(this.dw.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.Cib,!0),window.removeEventListener("FRELaunchedEvent",this.Cib,!0))}};de.prototype.Zxj=function(V){if("RemindMeLater"in V&&"FREDisplayedDate"in V){if("true"===V.RemindMeLater.toString()&&(+new Date-+new Date(V.FREDisplayedDate.toString()))/36E5>this.dw.Qpf)return!0}else if(Od.AFrameworkApplication.ga.ra("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in V&&V.VersionDisplayed<this.dw.currentVersion)return fc.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1};Object(xd.a)(de,"FirstRunExperienceLauncher",null,[882]);Xe.prototype.ei=function(V){this.tb=V;this.tb.register(882,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").Hc().Oc(function(){return new de})};Xe.prototype.init=function(){};Xe.prototype.dispose=function(){};Xe.main=function(){ge.a.instance.hj(new Xe)};
Ek.Object.defineProperties(Xe.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.FirstRunExperienceLauncher"}}});Object(xd.a)(Xe,"FirstRunExperienceLauncherPackage",null,[4,5]);var hh=b(7),Dg=b(228),pg=b(368),Fc=b(275),jd=b(372),td=b(1),ue=b(38),He=b(9),bf=b(388),Rf=b(15),ig=bf.a;Am(Pe,ig);Pe.prototype.GV=function(){var V={};V.id=this.Cc;var Ga=Rf.a.instance.fa(2204);V.DialogMessage=Ga;return V};Ek.Object.defineProperties(Pe.prototype,{Cc:{configurable:!0,enumerable:!0,
get:function(){return"ClipboardReadPermissionAskDialog"}}});Object(xd.a)(Pe,"ClipboardReadPermissionAskDialog",bf.a,[]);var Vf=b(49);Kf.prototype.ycf=function(V){return V?this.sessionStateId===V.sessionStateId&&this.sessionId===V.sessionId:!1};Kf.prototype.isFromCurrentSession=function(V){return this.sessionId===V.ya.UserSessionId};Object(xd.a)(Kf,"SourceItem",null,[]);Am(tf,Kf);tf.prototype.isEqual=function(V){return V&&Object.getType(V)===tf?this.ycf(V)&&this.activeFloatingObjectControlId===V.activeFloatingObjectControlId&&
this.sheetName===V.sheetName:!1};tf.prototype.toString=function(){return this.type.toString()};Object(xd.a)(tf,"ArtSourceItem",Kf,[]);var Qf;(function(V){V[V.valid=0]="valid";V[V.notPairwiseDisjoint=1]="notPairwiseDisjoint";V[V.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";V[V.notValidForm=3]="notValidForm";V[V.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(Qf||(Qf={}));Object(xd.b)("CopySourceValidationOptions",Qf);var df=b(46);Am(rd,Kf);rd.prototype.isEqual=
function(V){return V&&Object.getType(V)===rd?this.ycf(V)&&df.Q(this.ranges,V.ranges)&&this.sheetName===V.sheetName:!1};rd.prototype.toString=function(){return df.i(this.ranges,",",this.$,!1)};Object(xd.a)(rd,"RangeSourceItem",Kf,[]);Hd.RTj="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(xd.a)(Hd,"ExpectedErrorNames",null,[]);Bc.IW="text/plain";Bc.html="text/html";Bc.png="image/png";Bc.EO="data/shadow-workbook";Bc.Wii="metadata/is-last-copy-was-external";Bc.qfi="metadata/is-last-copy-was-external-XLO-source";
Bc.fXg="metadata/chrome-extension-id";Bc.Yqb="copyId";Bc.CHg="metadata/additional-signature-data-attributes";Object(xd.a)(Bc,"ClipboardDataFormat",null,[]);var hg=b(48),re=b(22),se=b(33);pd.prototype.bKa=function(){return pd.RWi};pd.prototype.cNh=function(){return this.g9b&&1===this.g9b.length?this.dNh(this.g9b[0]):null};pd.prototype.dNh=function(V){var Ga=re.g(this.$),Bb=Ga.rb.sj(V),gc=Ga.qg(V,Bb);Ga=Ga.rtl;if(!gc)return null;V=re.g(this.$).Tf(Bb);var dd=V.zn;if(!dd.Hd(gc))return null;gc=dd.Me(gc);
var sd=gc.topLeft.y,ie=gc.bottomRight.y,Ce=Ga?gc.bottomRight.x:gc.topLeft.x;gc=Ga?gc.topLeft.x:gc.bottomRight.x;var af=new hg.a(gc+(Ga?-81:81),ie+38+6);if(dd.xHa(af))return this.g4a(V,dd,Bb,gc,ie,Ga?12:-3,66);af=new hg.a(gc+(Ga?-81:81),ie);if(dd.xHa(af))return this.g4a(V,dd,Bb,gc,ie,Ga?20:3,22);af=new hg.a(gc,ie+38+6);if(dd.xHa(af))return this.g4a(V,dd,Bb,gc,ie,-81+(Ga?18:0),66);gc=new hg.a(Ce+(Ga?81:-81),ie);if(dd.xHa(gc))return this.g4a(V,dd,Bb,Ce,ie,-81+(Ga?12:-6),22);ie=new hg.a(Ce,sd-38-6);return dd.xHa(ie)?
this.g4a(V,dd,Bb,Ce,sd,Ga?15:0,16):this.g4a(V,dd,Bb,Ga?dd.topLeft.x:dd.bottomRight.x,dd.bottomRight.y,-81+(Ga?15:-6),22)};pd.prototype.g4a=function(V,Ga,Bb,gc,dd,sd,ie){var Ce=re.g(this.$),af=Ce.rtl;V=Sys.UI.DomElement.getLocation(V.domElement);gc=new Sys.UI.Point(gc+(af?0:V.x)-Ga.topLeft.x,dd+V.y-Ga.topLeft.y);af&&(Ce=Ce.view.visibleArea,gc.x=Ce.bottomRight.x-Ce.topLeft.x-gc.x,2===Bb||4===Bb)&&(gc.x+=Ga.bottomRight.x);gc=se.a(this.$).Aja(gc);return new Sys.UI.Point(gc.x+sd,gc.y+ie)};Ek.Object.defineProperties(pd.prototype,
{BHg:{configurable:!0,enumerable:!0,get:function(){return this.$jg}},Zqi:{configurable:!0,enumerable:!0,get:function(){return this.zrg}},n6i:{configurable:!0,enumerable:!0,get:function(){return this.jug}},Exh:{configurable:!0,enumerable:!0,get:function(){return this.Sng}}});pd.RWi=["PasteRecoveryUI"];Object(xd.a)(pd,"PasteRecoveryUI",null,[973]);var wg=b(79),Mf=b(326);Hc.uzg="ActiveSelection";Hc.EO="ShadowWorkbook";Hc.kig="GVML";Hc.IW="PlainText";Hc.html="Html";Hc.MNg="Bitmap";Object(xd.a)(Hc,"PayloadType",
null,[]);Ub.GBj="Slice4";Ub.HBj="Slice5";Ub.IBj="Slice6";Object(xd.a)(Ub,"SliceName",null,[]);nd.$Ci="NotCalled";nd.success="Success";nd.failed="Failed";Object(xd.a)(nd,"SucceededPopulatingSystemClipboardOptions",null,[]);var zh=b(374),Da;(function(V){V[V.valid=0]="valid";V[V.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";V[V.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";V[V.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";
V[V.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";V[V.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";V[V.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";V[V.copySourceNotValid=7]="copySourceNotValid";V[V.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";V[V.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";
V[V.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";V[V.unknown=100]="unknown"})(Da||(Da={}));Object(xd.b)("PasteValidationOptions",Da);var Ib=b(51),Ic=b(37),Gd=b(150),Sd=b(36),We=b(158),Ne=b(357),Se=b(30),Ka=b(328),bb=b(10),Yb=b(21),Ec=b(105),ad=b(169),Rd=b(144),ce=b(628),Ue=b(98),jf=b(256),Hf=ue.a;Am(bd,Hf);bd.prototype.SFg=function(V){this.addHandler(bd.ZBd,V)};bd.prototype.Dbj=function(V){this.removeHandler(bd.ZBd,V)};bd.prototype.copy=function(V){var Ga=this;V.stopwatch=this.$.Ob.Gc("UserAction",
Vf.b().ri(V.ribbonCommandInfo.command)+"ClientSide");if(this.Ao){var Bb=Ib.GetServiceTaskFactory.Va(this.$.da,478,479,0);Sd.TaskExtensions.Ba(Bb,function(){Ga.pasteShortcutManager=Bb.result},this.la,3)}var gc=!!jc(this.DK);td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Gg.a.XC&&(this.f7a=!1);this.Vr("Copy/before/"+pg.a[V.ribbonCommandInfo.method],!1,void 0,!0,V.copyPasteTargetType).catch(function(){});var dd=-1985798686===V.ribbonCommandInfo.command;
if(1===this.gridView.Ue&&(dd=this.Wr.Qbf(this.gridView.ha.sa.selectedRanges,dd),0!==dd)){var sd=bd.u2g(dd);this.gza(sd,Qf[dd],!1);return Promise.reject(!1)}V.userHash=this.userHash;V.id=rg.a.create().toString();var ie=this,Ce=this;return this.e4b.onCopy(V).then(function(af){af.isAsyncCopy||V.stopwatch.stop();ie.pasteIndicationManager.kJe();fc.ULS.sendTraceTag(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",zh.d(V));ie.Fti(af,gc);!V.isFormatPainter&&ie.Ao&&
(ie.pasteShortcutManager?ie.pasteShortcutManager.akh():fc.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},function(af){var ff=!1,fg="none",Ig=bd.$rb,ah=!0,bh=-1,me=bd.copyErrorName+bd.TIa,$e=!1,Kh=null;if(af){Kh=af.copyContext;bh=af.reason;me+=bd.iKa(af);af.message&&(Ig=af.message);var Ph=bd.t2g(af);if(Ph)if(3===Ph.copyErrorName)ff=!0,Ig=fg="Async Copy canceled by the user.",ah=!1;else if(Se.a.lr(Ph.ewaErrors))if(Ig=Ce.gbc(Ph.ewaErrors),Se.a.nh(Ph.ewaErrors,
bd.operationSucceededWithAlert))$e=ff=!0;else if(Se.a.nh(Ph.ewaErrors,bd.pasteDataLimitHit)||Se.a.nh(Ph.ewaErrors,bd.copyThrottlingError))ff=!0;13===af.reason?(ff=!0,ah=!1):11===af.reason&&(ah=!1)}ff?fc.ULS.sendTraceTag(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",ah,fg,af?Ce.getStringifiedError(af):"null",zh.d(V)):fc.ULS.sendTraceTag(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",
ah,af?Ce.getStringifiedError(af):"null",zh.d(V));ah&&Ce.Vr("Copy/fail/"+pg.a[V.ribbonCommandInfo.method],!0,void 0,void 0,V.copyPasteTargetType).catch(function(){});Ce.Eti(V,ff,Ig,me,bh,$e,Kh);return Promise.reject(af)})};bd.prototype.paste=function(V){var Ga=this;V.stopwatch=this.$.Ob.Gc("UserAction",Vf.b().ri(V.ribbonCommandInfo.command)+"ClientSide");td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Gg.a.XC&&(fc.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),
this.f7a=!1,V.clipboardPicklingApiDataFormatsToRead=[Bc.EO]);re.g(this.$).Ji&&re.g(this.$).Ji.K7(this.Kfd(V.ribbonCommandInfo.command),V.stopwatch.id);if(V.isPasteCommandFromRecoveryUI){var Bb=this.$.da.Aa(406);var gc=Fc.a.clone(Bb.Csd);Bb=Bb.rsd;V.pasteRecoveryCachedClipboardItems=Bb?Bb[bd.JFf]:null}else gc=Fc.a.clone(this.gridView.ha.sa.selectedRanges);V.originalDestinations=gc;V.expandDestinations=this.DZc(V.originalDestinations,V.commandType);if(this.PZc(V.commandType,V.expandDestinations)||this.$Tg())return V.userHash=
this.userHash,V.id=rg.a.create().toString(),td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!Gg.a.XC&&(V.clipboardReadPermissionPromptShown=!1,V.clipboardAsyncApiDataFormatsToRead=[Bc.IW+"Async"],this.e4b.shouldShowClipboardReadPermissionDialog().then(function(dd){dd&&(V.clipboardReadPermissionPromptShown=!0,new Pe(Ga.$));return Promise.resolve(!0)},function(){return Promise.resolve(!0)})),this.e4b.onPaste(V).then(function(dd){return Ga.$nc(dd,V)},
function(dd){return Ga.PEb(V,dd)});this.$.Xd(927125067,wg.a.Ub,30,null);fc.ULS.sendTraceTag(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',df.i(V.expandDestinations,",",this.$,!1),V.commandType,V.copyPasteTargetType);return Promise.resolve(!0)};bd.prototype.Kfd=function(V){if(td.EwaSettings.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(V){case 1804571062:return 6;
case -185374993:return 7;case 1766348718:return 8}return 3};bd.prototype.$Tg=function(){return!!re.g(this.$).ha.Oa.activeFloatingObjectControlId&&this.$.Cq(null,!1,470)};bd.prototype.kBb=function(){var V=jc(this.DK);return V&&V.commandParameters?V.commandParameters.copyPasteTargetType:0};bd.prototype.Vii=function(){return!!jc(this.DK)&&ed(jc(this.DK),this.$)};bd.prototype.Vr=function(V,Ga,Bb,gc,dd){var sd=this;Bb=void 0===Bb?!1:Bb;gc=void 0===gc?!1:gc;dd=void 0===dd?0:dd;try{this.Ao&&this.pasteShortcutManager&&
this.pasteShortcutManager.G6b();var ie=dd,Ce=this.Rpi();if(!gc&&2===Ce)return fc.ULS.sendTraceTag(537167821,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ga,Bb,gc,dd,Ce),Promise.reject(null);0===ie&&(ie=Ce);var af=this.$.Ob.Gc("UserAction","ClearCopyState"),ff=af.id;fc.ULS.sendTraceTag(537167820,
0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ga,Bb,gc,dd,Ce);this.Wr.rxb();this.A3i();return this.e4b.onCancelCopy(Ga).then(function(){Ga&&td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Gg.a.XC&&(sd.f7a=!1);af.stop();sd.nlf(V,ff,!0,Bb,Ga,"","",af.Bc,ie);return Promise.resolve(!0)},
function(fg){fc.ULS.sendTraceTag(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",fg?sd.getStringifiedError(fg):"null");af.stop();var Ig=bd.oUg+bd.TIa,ah=bd.$rb;fg&&(Ig+=bd.iKa(fg),fg.message&&(ah=fg.message));sd.nlf(V,ff,!1,Bb,Ga,ah,Ig,af.Bc,ie);return Promise.reject(fg)})}catch(fg){return Promise.reject(null)}};bd.prototype.F2b=function(V,Ga,Bb,gc,dd){Bb=void 0===Bb?!1:Bb;gc=void 0===gc?!1:gc;dd=void 0===dd?0:dd;return gc||!td.EwaSettings.ma(661)||
this.Xgh()?this.Vr(V,Ga,Bb,gc,dd):(fc.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))};bd.prototype.gza=function(V,Ga,Bb){fc.ULS.sendTraceTag(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",Ga);var gc=new Ue.a;gc.ia("reason",Ga);ce.a(ad.a.discontinuousSelectionBlocking,
[Bb?Rd.a.LWi:Rd.a.k3g],!0,!0,!1,!1,gc);V=Se.a.gd(1,1,751,V,0,371863010,"DiscontinuousSelectionBlocking");td.EwaSettings.Iz()?new Ne.a(this.$,V):(V=new We.ErrorDialog(this.$,V),V.initialize(),V.kf())};bd.prototype.Rpi=function(){var V=jc(this.DK);return V&&V.sourceItem?Object.getType(V.sourceItem)===tf?2:1:0};bd.prototype.dragDropCells=function(V,Ga,Bb,gc,dd){var sd=this;dd=void 0===dd?!1:dd;V.stopwatch=this.$.Ob.Gc("UserAction","DragDropClientSide");this.Vr("DragDrop/before/"+pg.a[V.ribbonCommandInfo.method],
!1,void 0,void 0,V.copyPasteTargetType).catch(function(){});var ie=dd?2:1,Ce=0;Ce=dd?4:gc?256:128;var af={encounteredDeploymentErrors:!1};af.commandParameters=V;V.userHash=this.userHash;V.id=rg.a.create().toString();return this.Wr.pasteRange(V.ribbonCommandInfo,df.q(Ga,this.$),df.q(Bb,this.$),ie,Ce,[V.stopwatch],af,!1).then(function(){fc.ULS.sendTraceTag(537167818,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',V.copyPasteTargetType);sd.gridView.ha.selectionType=-1;
sd.aud(V,ie,Ga,Bb,af);return Promise.resolve(!0)},function(ff){fc.ULS.sendTraceTag(537167817,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',ff?sd.getStringifiedError(ff):"null",V.copyPasteTargetType);return sd.gAd(ff,V,ie,Ga,Bb,af)})};bd.prototype.shh=function(V,Ga,Bb,gc,dd){var sd=this;dd=void 0===dd?!1:dd;V.stopwatch=this.$.Ob.Gc("UserAction","DragDropReplaceClientSide");this.F2b("DragDropReplace/before/"+pg.a[V.ribbonCommandInfo.method],!1,void 0,void 0,V.copyPasteTargetType).catch(function(){});
var ie=dd?2:1,Ce=0;Ce=dd?4:gc?256:128;var af={encounteredDeploymentErrors:!1};af.commandParameters=V;td.EwaSettings.getBooleanFeatureGate(Mf.a.q7b,!1)&&(V.isDragInsert=!1);V.userHash=this.userHash;V.id=rg.a.create().toString();return this.Wr.pasteRange(V.ribbonCommandInfo,df.q(Ga,this.$),df.q(Bb,this.$),ie,Ce,[V.stopwatch],af,!1).then(function(){fc.ULS.sendTraceTag(537167816,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',V.copyPasteTargetType);sd.gridView.ha.selectionType=
-1;sd.aud(V,ie,Ga,Bb,af);return Promise.resolve(!0)},function(ff){fc.ULS.sendTraceTag(537167815,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',ff?sd.getStringifiedError(ff):"null",V.copyPasteTargetType);return sd.gAd(ff,V,ie,Ga,Bb,af)})};bd.prototype.rhh=function(V,Ga,Bb,gc,dd){var sd=this;dd=void 0===dd?!1:dd;V.stopwatch=this.$.Ob.Gc("UserAction","DragDropInsertClientSide");this.F2b("DragDropInsert/before/"+pg.a[V.ribbonCommandInfo.method],!1,void 0,void 0,V.copyPasteTargetType).catch(function(){});
var ie=dd?2:1,Ce=df.K(this.DZc([Bb],ie)),af=this.$.ea.qa.sheetName,ff=this.$.ea.qa.sheetName,fg=df.v(Ga,this.$);fg.SheetName=af;af=df.v(Ce,this.$);af.SheetName=ff;gc=Ce.isRow||Ga.isRow||gc?1:0;var Ig={encounteredDeploymentErrors:!1};V.isDragInsert=!0;Ig.commandParameters=V;V.userHash=this.userHash;V.id=rg.a.create().toString();dd=this.Wr.uhh(Ig,fg,af,dd,gc,V.ribbonCommandInfo);var ah=this;return jf.c(dd.then(function(){fc.ULS.sendTraceTag(537167814,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',
V.copyPasteTargetType);sd.gridView.ha.selectionType=-1;sd.aud(V,ie,Ga,Bb,Ig);return Promise.resolve(!0)},function(bh){fc.ULS.sendTraceTag(537167813,0,10,'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',bh?ah.getStringifiedError(bh):"null",V.copyPasteTargetType);return ah.gAd(bh,V,ie,Ga,Bb,Ig)})).CWR(function(){return!0})};bd.prototype.wbi=function(V,Ga){var Bb=this,gc=jc(this.DK);if(!gc)return fc.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),
cc.Task.Sa(!1);if(!xb(gc.sourceItem))return fc.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),cc.Task.Sa(!1);var dd=gc.sourceItem;if(!dd)return fc.ULS.shipAssertTag(537167810,0,!!dd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),cc.Task.Sa(!1);if(!dd.isFromCurrentSession(this.$))return fc.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),cc.Task.Sa(!1);if(1<dd.ranges.length)return fc.ULS.sendTraceTag(537167808,
0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.gza(2142,"InsertCopiedCutCells",!0),cc.Task.Sa(!1);gc=df.K(dd.ranges);var sd=this.gridView.ha.sa.qd.clone();V=df.K(this.DZc([sd],V));var ie=this.djf();dd=dd.sheetName;sd=this.$.ea.qa.sheetName;var Ce=df.v(gc,this.$);Ce.SheetName=dd;var af=df.v(V,this.$);af.SheetName=sd;return(V.ef||gc.ef?cc.Task.Sa(0):V.isRow||gc.isRow?cc.Task.Sa(1):this.xbi.u4b(this.$,re.g(this.$).rtl)).CWR(function(ff){return Bb.Wr.executeInsertCopiedCutCellsOperation(Ce,
af,ie,ff.result,Ga)}).continueWith(function(){ie?Bb.Wr.rxb():Bb.Vr("InsertCopiedCutCells/success/"+pg.a[Ga.method],!0)})};bd.prototype.Yod=function(){var V=jc(this.DK),Ga=this.gridView.ha.sa.Ig;return!!V&&xb(V.sourceItem)&&Ga&&1===V.sourceItem.ranges.length};bd.prototype.djf=function(){return this.ejf(-911352779)};bd.prototype.sjc=function(){return this.ejf(-1985798686)};bd.prototype.PZc=function(V,Ga){var Bb=new Gd.a(this.$.xa),gc=36===V,dd=Bb.me(4);V=2===this.kBb()&&Bb.me(1);gc=gc&&dd;Bb=!Bb.uj||
!this.sjc()||!Gd.a.d7b(Ga,re.g(this.$));return gc||V||this.$.Cq(Ga,!0)&&Bb};bd.prototype.Egc=function(V,Ga){return this.Wr.Egc(V,Ga)};bd.prototype.dispose=function(){Hf.prototype.dispose.call(this);this.vm();this.DK.removeMetadataChangeListener(bd.Ipf)};bd.prototype.W6c=function(V,Ga,Bb,gc,dd,sd){if(!this.uYg(V.commandParameters.ribbonCommandInfo.command))return V.cseStatus=2,!1;if(sd&&Ga.Hd(gc))return V.cseStatus=4,!1;if(Bb!==dd)return V.cseStatus=6,!1;if(td.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&
(gc.width%Ga.width||gc.height%Ga.height))return V.cseStatus=16,!1;if(td.EwaSettings.getBooleanFeatureGate(Mf.a.gFe,!1)){if(Bb=Ga,gc=gc.Me(this.gridView.Gh),Ga=null===Ga.Me(this.gridView.Gh),dd=V.commandParameters.ribbonCommandInfo.command,Ga&&1804571062!==dd&&-185374993!==dd||!gc)return V.cseStatus=7,!1}else if(Bb=Ga.Me(this.gridView.Gh),gc=gc.Me(this.gridView.Gh),!Bb||!gc)return V.cseStatus=7,!1;Ga=df.v(Bb,this.$);Ga=this.Ug.PWi(this.gridView,Ga,df.v(gc,this.$),V.commandParameters.ribbonCommandInfo.command,
V.commandParameters.stopwatch);1===Ga&&(sd&&(this.Ug.B0c(Bb,!1),this.Ug.B0c(Bb,!0)),-185374993===V.commandParameters.ribbonCommandInfo.command&&re.g(this.$).l3i(),this.pasteIndicationManager.Sjd(V.commandParameters.id),this.ivc(V.commandParameters.expandDestinations,V.commandParameters.isPasteCommandFromRecoveryUI),this.Kye("DoPasteClientEstimation/"+pg.a[V.commandParameters.ribbonCommandInfo.method],V));V.cseStatus=Ga;return 1===Ga};bd.prototype.UGf=function(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,
!1,!1,this.Dvi)};bd.prototype.Zlf=function(V,Ga,Bb,gc){V=Ff(V,Ga,Bb,gc,this.$.ya.UserSessionId);V.k=!0;Vf.b().Qe(45,V,!0)};bd.prototype.RAf=function(V,Ga,Bb,gc,dd){var sd=!1,ie=!1,Ce=bd.$rb,af=bd.oJe+bd.TIa;V&&(af+=bd.iKa(V),Se.a.lr(V.ewaErrors)?(Ce=this.gbc(V.ewaErrors),Se.a.nh(V.ewaErrors,[-103190598])&&(sd=!0)):V.message&&(Ce=V.message));ie||(ie=this.sod(V));Ga=Ff(Ga,Bb,gc,dd,this.$.ya.UserSessionId);Ga.k=!1;Ga.l=ie;Ga.n=Ce;Ga.p=af;Ga.q=sd;Vf.b().Qe(45,Ga,!0);return Promise.reject(V)};bd.prototype.uYg=
function(V){switch(V){case 237279923:case 808159687:return Mf.a.bki;case -185374993:return!0;case 1804571062:return!0;default:return!1}};bd.prototype.ejf=function(V){var Ga=jc(this.DK);if(!Ga)return!1;var Bb=Ga.sourceItem;return Bb&&!Bb.isFromCurrentSession(this.$)?(fc.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):Ga.commandParameters.ribbonCommandInfo.command===V};bd.prototype.Xgh=function(){var V=jc(this.DK);
return V?(V=V.sourceItem)&&!V.isFromCurrentSession(this.$)?(fc.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1};bd.prototype.pvj=function(V){return V&&V.lastCopy?ed(V.lastCopy,this.$):!0};bd.prototype.uYe=function(V,Ga,Bb,gc,dd){var sd={};sd.a=this.$.ya.UserSessionId;sd.e=V.stopwatch.id;sd.c=Vf.b().ri(V.ribbonCommandInfo.command);sd.b=pg.a[V.ribbonCommandInfo.method];sd.d=V.id;sd.f=Bb.toString();
sd.g=gc.toString();sd.h=Ga.toString();sd.o=V.stopwatch.Bc;sd.q=!1;sd.r=V.copyPasteTargetType.toString();sd.s=dd.encounteredDeploymentErrors;td.EwaSettings.getBooleanFeatureGate(Mf.a.q7b,!1)&&(sd.i=dd.commandParameters.dragDropIsShiftKeyDown,sd.j=dd.commandParameters.isDragInsert);return sd};bd.prototype.aud=function(V,Ga,Bb,gc,dd){V=this.uYe(V,Ga,Bb,gc,dd);V.k=!0;Vf.b().Qe(45,V,!0)};bd.prototype.Mti=function(V,Ga,Bb,gc,dd,sd,ie,Ce,af){V=this.uYe(V,Ga,Bb,gc,af);V.k=!1;V.l=dd;V.n=sd;V.p=ie;V.q=Ce;Vf.b().Qe(45,
V,!0)};bd.prototype.nlf=function(V,Ga,Bb,gc,dd,sd,ie,Ce,af){var ff={};ff.a=this.$.ya.UserSessionId;ff.b=Ga;ff.c=V;ff.f=Bb;ff.e=gc;ff.d=dd;ff.g=sd;ff.h=ie;ff.i=Ce;ff.j=af.toString();Vf.b().Qe(46,ff,!0)};bd.prototype.Fti=function(V,Ga){V=this.TXe(V.commandParameters,V);V.l=!0;V.j=Ga;Vf.b().Qe(43,V,!0)};bd.prototype.Eti=function(V,Ga,Bb,gc,dd,sd,ie){V=this.TXe(V,ie);V.l=!1;V.m=Ga;V.o=Bb;V.y=gc;V.x=dd;V.z=sd;Vf.b().Qe(43,V,!0);fc.ULS.sendTraceTag(537167776,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",
V.y,V.x,V.m,V.z,V.o)};bd.prototype.TXe=function(V,Ga){var Bb={};Bb.a=this.$.ya.UserSessionId;Bb.f=V.stopwatch.id;Bb.g=V.id;Bb.c=Vf.b().ri(V.ribbonCommandInfo.command);Bb.b=pg.a[V.ribbonCommandInfo.method];Bb.q=V.stopwatch.Bc;Bb.bd=bd.oac();Bb.bg=V.copyPasteHandlerName;Bb.bj=void 0===V.ribbonCommandInfo.Ye||null===V.ribbonCommandInfo.Ye?null:jd.a[V.ribbonCommandInfo.Ye];Bb.bq=V.uploadToClipService;Bb.br=V.floatingObjectType;Bb.s=V.copyPasteTargetType.toString();Bb.bc=ne(V.copyPasteTargetType);Bb.z=
!1;if(Ga){Bb.bk=Ga.id;Bb.bl=Ga.serverRequestTimeInMs;Ga.requestTelemetryData&&(Bb.bm=Ga.requestTelemetryData.EcsOperationDuration,Bb.bn=Ga.requestTelemetryData.EcsRequestDuration,Bb.bo=Ga.requestTelemetryData.WfeRequestDuration);Bb.d=Ga.sourceItem?Ga.sourceItem.toString():null;Bb.e=-1;if(xb(Ga.sourceItem)){Bb.e=0;V=El(Ga.sourceItem.ranges);for(var gc=V.next();!gc.done;gc=V.next())Bb.e+=gc.value.uM}Bb.h=Ga.isAsyncCopy;Bb.i=Ga.isFromCache;Bb.k=Ga.isSelectionAllowed;Bb.r=Ga.plainTextPayloadSize;Bb.u=
Ga.htmlPayloadSize;Bb.v=Ga.htmlSizeExceedsLimit;Bb.w=Ga.copyTotalSizeExceedsLimit;Bb.t=Ga.shadowWorkbookPayloadSize;Bb.p=Ga.clientSideCopyTime;Bb.ba=Ga.encounteredDeploymentErrors;Bb.bb=Ga.shadowWorkbookSizeExceedsLimit;Bb.be=Ga.syncClipboardItemsKeys;Bb.bf=Ga.asyncClipboardItemsKeys;Bb.bh=this.aCe(Ga.succeededPopulatingSystemClipboardSync);Bb.bi=this.aCe(Ga.succeededPopulatingSystemClipboardAsync)}return Bb};bd.prototype.ivc=function(V,Ga){Ga=void 0===Ga?!1:Ga;if(!this.gridView.isEditing&&!this.gridView.Mi){var Bb=
this.gridView.ha.sa,gc=!Ga&&1===V.length&&df.Q(V,Bb.selectedRanges),dd=gc?Bb.activeCell:V[0].topLeft;V[0].contains(dd)||(fc.ULS.shipAssertTag(537167775,0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges {0}, IndexOfActiveRange {1}, ActiveCell {2}, calculatedDestinationRanges {3}, keepThePreviousActiveCell {4}, newActiveCell {5}, isPasteCommandFromRecoveryUI {6}",Bb.selectedRanges,Bb.rB,Bb.activeCell,V,gc,dd,Ga),dd=V[0].topLeft);this.gridView.ha.ED(V,0,dd,0,void 0,Ec.a.p3g)}};bd.prototype.H0e=
function(V,Ga){var Bb={};Bb.a=this.$.ya.UserSessionId;Bb.g=V.stopwatch.id;Bb.t=V.stopwatch.Bc;Bb.bz=!1;Ga&&(Bb.bv=Ga.id,Bb.bw=Ga.serverRequestTimeInMs,Bb.n=Ga.commandParameters.clipboardFormatReadTimes,Bb.o=Ga.commandParameters.clipboardFormatReadStatus,Bb.p=Ga.commandParameters.clipboardReadPermissionPromptShown,Bb.q=Ga.commandParameters.asyncApiReadTimedOut,Ga.requestTelemetryData&&(Bb.cb=Ga.requestTelemetryData.EcsOperationDuration,Bb.cc=Ga.requestTelemetryData.EcsRequestDuration,Bb.cd=Ga.requestTelemetryData.WfeRequestDuration));
Bb.x=V.copyPasteTargetType.toString();Bb.bl=ne(V.copyPasteTargetType);Bb.br=V.copyPasteHandlerName;Bb.i=df.i(V.expandDestinations,",",this.$,!1);Bb.h=df.i(V.originalDestinations,",",this.$,!1);Bb.e=V.id;Bb.d=V.commandType;Bb.c=Vf.b().ri(V.ribbonCommandInfo.command);Bb.b=pg.a[V.ribbonCommandInfo.method];Bb.bf=!1;Bb.bg=!1;Bb.bp=bd.oac();Bb.bt=void 0===V.ribbonCommandInfo.Ye||null===V.ribbonCommandInfo.Ye?null:jd.a[V.ribbonCommandInfo.Ye];Bb.cj=V.isPasteCommandFromEnterShortcut;if(Bb.ca=V.isPasteCommandFromRecoveryUI)Bb.cf=
V.pasteRecoveryUndoStopwatch.id,Bb.cg=V.pasteRecoveryUndoStopwatch.Bc;if(Ga){if((V=Ga.copyContextSnapshot)&&!Ga.wasLastCopyExternal){Bb.f=V.commandParameters.id;Bb.j=V.sourceItem.toString();Bb.k=-1;if(xb(V.sourceItem)){Bb.k=0;for(var gc=El(V.sourceItem.ranges),dd=gc.next();!dd.done;dd=gc.next())Bb.k+=dd.value.uM}Bb.bg=1===V.commandParameters.commandType}else Ga.clipboardItems?Bb.f=Ga.clipboardItems.getItem(Bc.Yqb):fc.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");
Bb.bz=Ga.pasteRecoveryUIDisplayed;Bb.ci=Ga.cseStatus}else fc.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return Bb};bd.prototype.Tui=function(V,Ga,Bb,gc,dd,sd,ie,Ce,af){V=this.H0e(V,Ce);V.l=!1;V.m=Ga;V.s=Bb;V.bc=gc;V.be=dd;V.bd=sd;V.bf=ie;Ce?(V.y=$d(Ce)||!Ce.copyContextSnapshot,V.bi=!V.y&&ed(Ce.copyContextSnapshot,this.$),V.bj=Ce.shadowWorkbookSizeExceedsLimit,V.v=Ce.shadowWorkbookPayloadSize,V.w=Ce.htmlPayloadSize,V.bq=Xc(Ce.clipboardItems),
V.bb=Ce.activeSelectionType,V.bs=Ce.isSameSession,V.bn=Ce.payloadOrigin,V.bo=Ce.payloadType,V.bu=Ce.externalAppSource,V.bx=Ce.indicationDisplayScheduled,V.by=Ce.pasteIndicationDisplayStatus,V.ck=Ce.pasteDestinationHasMergedCells):V.bi=ed(af,this.$);Vf.b().Qe(44,V,!0);fc.ULS.sendTraceTag(537167772,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",V.be,V.bd,V.m,V.bf,V.s)};bd.prototype.Uui=function(V){var Ga=
this.H0e(V.commandParameters,V);Ga.y=V.wasLastCopyExternal;Ga.l=!0;Ga.u=V.plainTextPayloadSize;Ga.v=V.shadowWorkbookPayloadSize;Ga.w=V.htmlPayloadSize;Ga.z=V.isClipboardDataContainShadowWorkbook;Ga.ba=V.isShadowWorkbookParsedSuccessfully;Ga.bb=V.activeSelectionType;Ga.bc=V.pasteResult;Ga.bh=V.encounteredDeploymentErrors;Ga.bj=V.shadowWorkbookSizeExceedsLimit;Ga.bk=vd(V);Ga.bq=Xc(V.clipboardItems);Ga.bs=V.isSameSession;Ga.bn=V.payloadOrigin;Ga.bo=V.payloadType;Ga.bu=V.externalAppSource;Ga.bx=V.indicationDisplayScheduled;
Ga.by=V.pasteIndicationDisplayStatus;Ga.ck=V.pasteDestinationHasMergedCells;Ga.bm=V.clipboardItems?V.clipboardItems.getItem(Bc.fXg):null;Ga.bi=!V.isSameSession&&!V.wasLastCopyExternal;Vf.b().Qe(44,Ga,!0)};bd.prototype.Ck=function(){this.$.xa.Bg(this.gi);this.$.xa.nne(this.Anc);this.$.userOperationManager.Vu(this.WR);this.$.nl(this.zd);re.g(this.$).rc.ml(this.cFb)};bd.prototype.vm=function(){this.$&&this.$.xa&&(this.$.xa.Xg(this.gi),this.$.xa.OPf(this.Anc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.Cr(this.WR);
this.gridView&&this.gridView.rc&&this.gridView.rc.fl(this.cFb)};bd.prototype.PEb=function(V,Ga){var Bb=null,gc=!1,dd=null,sd="UnknownFailure",ie=-1,Ce=bd.$rb,af=bd.pasteErrorName+bd.TIa,ff=!1;this.pasteIndicationManager.Sjd(V.id);this.nef&&this.pasteDestinationHasMergedCells(V.expandDestinations)&&(Ga.pasteContext.pasteDestinationHasMergedCells=!0);var fg=jc(this.DK);(V.clearStateOnFinish||V.clearSystemClipboard)&&this.Vr("Paste/fail/"+pg.a[V.ribbonCommandInfo.method],!0,void 0,void 0,V.copyPasteTargetType).catch(function(){});
if(Ga){ie=Ga.reason;af+=bd.iKa(Ga);Ga.message&&(Ce=Ga.message);if(Bb=bd.G2g(Ga))if(1===Bb.pasteErrorName)gc=!0,sd="CopyPasteLengthTooLongPopup",Ce=dd="The pasted content is too long. Popup a dialog to the user.",fc.ULS.sendTraceTag(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',dd,V.copyPasteTargetType),Bb=Se.a.gd(1,0,26,690,0,1306609195,"CopyPasteOversizeError"),td.EwaSettings.Iz()?new Ne.a(this.$,Bb):(Bb=new We.ErrorDialog(this.$,Bb),Bb.initialize(),Bb.kf());
else if(7===Bb.pasteErrorName)gc=!0,sd="No-Op",Ce=dd="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",fc.ULS.sendTraceTag(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',dd,V.copyPasteTargetType);else if(8===Bb.pasteErrorName)gc=!0,sd="UseShortcutsPopup",Ce=dd="Unable to paste content from the system clipboard. Popup dialog to the user.",fc.ULS.sendTraceTag(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',
dd,V.copyPasteTargetType),this.UGf();else if(18===Bb.pasteErrorName){gc=!0;sd="PasteExternalNotSupportMultipleSelectionPopup";Ce="Paste external not support multiple selection.";dd="Unknown";var Ig=2142;100!==Bb.validationFailureReason&&(dd=Da[Bb.validationFailureReason],Ig=bd.UBe(Bb.validationFailureReason));this.gza(Ig,dd,!0)}else 20===Bb.pasteErrorName||19===Bb.pasteErrorName?(gc=!0,20===Bb.pasteErrorName?(sd="PasteAcrossSessionNotSupportMultipleSelectionPopup",Ce="Paste across session does not support multiple selection."):
(sd="PasteInSameSessionNotSupportMultipleSelectionPopup",Ce="This kind of multiple selection is not supported for same session paste."),dd="Unknown",Ig=2142,100!==Bb.validationFailureReason&&(dd=Da[Bb.validationFailureReason],Ig=bd.UBe(Bb.validationFailureReason)),Bb=6===Bb.validationFailureReason,this.PZc(V.commandType,V.expandDestinations)&&Bb&&this.ivc(V.expandDestinations),this.gza(Ig,dd,!0)):6===Bb.pasteErrorName?(gc=!0,sd="No-Op",Ce=dd="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",
fc.ULS.sendTraceTag(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',dd,V.copyPasteTargetType)):17===Bb.pasteErrorName?(gc=!0,sd="No-Op",Ce=dd="Paste text on Art is not yet a supported operation",fc.ULS.sendTraceTag(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',dd,V.copyPasteTargetType)):16===Bb.pasteErrorName?(gc=!0,sd="No-Op",Ce=dd="Paste has failed because the previous copy has failed",fc.ULS.sendTraceTag(537167771,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',
dd,V.copyPasteTargetType,this.getStringifiedError(Bb))):Se.a.lr(Bb.ewaErrors)?(Se.a.c$(Bb.ewaErrors)||Se.a.nh(Bb.ewaErrors,Se.a.Ncc())?(gc=!0,sd="CommunicationError",dd=Se.a.Wc(Bb.ewaErrors),fc.ULS.sendTraceTag(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',Ce,V.copyPasteTargetType)):Se.a.nh(Bb.ewaErrors,bd.xjj)?(gc=!0,sd="SavingWorkbookError",dd=Se.a.Wc(Bb.ewaErrors),fc.ULS.sendTraceTag(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',
Ce,V.copyPasteTargetType)):Se.a.nh(Bb.ewaErrors,bd.operationSucceededWithAlert)&&(ff=gc=!0,sd="OperationSucceededWithAlert",dd=Se.a.Wc(Bb.ewaErrors),fc.ULS.sendTraceTag(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',Ce,V.copyPasteTargetType)),gc||(Ce=this.gbc(Bb.ewaErrors),gc=this.sod(Ga))):11===Bb.pasteErrorName&&(gc=!0,sd="No-Op",Ce="Paste has failed because user try copy cross-session oart object");15===Ga.reason&&(gc=!0,sd="No-Op",Ce="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
Yb.a.equals(af,Hd.RTj,!1)&&(gc=!0,sd="No-Op",Ce="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}gc||fc.ULS.sendTraceTag(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Ga?this.getStringifiedError(Ga):"null",V.copyPasteTargetType);this.Tui(V,gc,Ce,sd,af,ie,ff,Ga.pasteContext,fg);return Promise.reject(Ga)};bd.prototype.$nc=function(V,Ga){var Bb;fc.ULS.sendTraceTag(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',
Ga.copyPasteTargetType);this.pasteIndicationManager.Sjd(Ga.id);if(this.UWi(Ga.copyPasteTargetType,V)){td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Gg.a.XC&&V.wasLastCopyExternal&&V.payloadType===Hc.EO&&(this.f7a=!0);var gc=null;(null===(Bb=V.pastedRange)||void 0===Bb?0:Bb.Ranges)&&0<V.pastedRange.Ranges.length?gc=df.g(V.pastedRange.Ranges):V.wasLastCopyExternal||(gc=Ga.expandDestinations);this.hlj(V,gc);if(this.mxj(V,gc)){Bb=Fc.a.clone(Ga.originalDestinations);
gc=1028===Ga.commandType?Fc.a.clone(Ga.expandDestinations):Fc.a.clone(gc);var dd=null;V.wasLastCopyExternal&&(Ga.isKeyboardEvent||Ga.isPasteCommandFromRecoveryUI)&&(dd={},dd=(dd[bd.JFf]=V.clipboardItems,dd));this.nef&&this.pasteDestinationHasMergedCells(Ga.expandDestinations)&&(V.pasteDestinationHasMergedCells=!0);V.pasteRecoveryUIDisplayed=!0;var sd=new pd(this.$,Bb,gc,dd),ie=Ib.GetServiceTaskFactory.Va(this.$.da,406,405,0);Sd.TaskExtensions.Ba(ie,function(){var Ce=ie.result;Ce.LNg(sd);Ce.vAj(Ga.ribbonCommandInfo.method)},
this.la,8)}}this.Kye("Paste/success/"+pg.a[Ga.ribbonCommandInfo.method],V);this.Uui(V);this.g2f&&(!Ga.isKeyboardEvent||vd(V))&&this.$.ea.Zg.get(66)&&(fc.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.g2f=!1,this.g4g());return Promise.resolve(!0)};bd.prototype.mxj=function(V,Ga){return!Ga||1!==Ga.length||V.commandParameters.clearSystemClipboard||V.commandParameters.clearStateOnFinish||V.commandParameters.skipClipboardAccess?!1:
$d(V)&&(Ga=V.clipboardItems.getItem(Bc.IW),V=V.clipboardItems.getItem(Bc.html),void 0===Ga||null===Ga||Ga.length>this.Zvd||void 0===V||null===V||V.length>this.fOa)?(fc.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0};bd.prototype.UWi=function(V,Ga){return 1===V||Ga.payloadType===Hc.IW||td.EwaSettings.ma(162)&&Ga.payloadType===Hc.html||td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!Gg.a.XC&&Ga.payloadType===Hc.EO};bd.prototype.pasteDestinationHasMergedCells=function(V){var Ga=re.g(this.$).Ea.hF();if(!Ga||!Ga.length)return!1;Ga=El(Ga);for(var Bb=Ga.next();!Bb.done;Bb=Ga.next())if(Bb.value.Jw(V[0]))return!0;return!1};bd.prototype.Kye=function(V,Ga){var Bb=this,gc;(function(){var dd=Bb.pfi(Ga);gc=dd.ZGa;return dd})().returnValue&&this.Vr(V,gc,void 0,void 0,Ga.commandParameters.copyPasteTargetType).catch(function(){})};bd.prototype.gAd=function(V,Ga,Bb,gc,dd,sd){fc.ULS.sendTraceTag(24150918,
0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",V?this.getStringifiedError(V):"null");var ie=!1,Ce=!1,af=!1,ff=bd.$rb,fg=bd.oJe+bd.TIa;V&&(fg+=bd.iKa(V),Se.a.lr(V.ewaErrors)?(ff=this.gbc(V.ewaErrors),Se.a.nh(V.ewaErrors,bd.operationSucceededWithAlert)&&(ie=!0),Se.a.nh(V.ewaErrors,bd.dragDropNonEmptyRange)&&(Ce=af=!0)):V.message&&(ff=V.message));af||(af=this.sod(V));Ce?this.gridView.ha.selectionType=-1:this.Wr.q6i(dd);this.Mti(Ga,Bb,gc,dd,af,ff,fg,ie,sd);return Promise.reject(V)};bd.prototype.DZc=
function(V,Ga){var Bb=V,gc=this.iRh();if(null===gc||void 0===gc?0:gc.ranges)Bb=this.Wr.mTg(Ga,gc.ranges,V);return Bb};bd.prototype.iRh=function(){var V=jc(this.DK);return V&&xb(V.sourceItem)?V.sourceItem:null};bd.prototype.A3i=function(){this.raiseEvent(bd.ZBd,null)};bd.prototype.hlj=function(V,Ga){var Bb=V.commandParameters.originalDestinations;Ga&&(df.Q(this.gridView.ha.sa.selectedRanges,Bb)?(this.ivc(Ga),fc.ULS.sendTraceTag(537167767,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",
bb.HelperMethods.oob(Ga))):V.commandParameters.isPasteCommandFromRecoveryUI?(this.ivc(Ga,!0),fc.ULS.sendTraceTag(537167766,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: {0}, active cell: {1}",Ga,Ga[0].topLeft)):fc.ULS.sendTraceTag(537167765,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}",bb.HelperMethods.oob(Bb)))};
bd.prototype.pfi=function(V){if(V.isPlainTextPaste||V.isHtmlPaste||ae(V)||V.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,ZGa:!1};var Ga=V.copyContextSnapshot;if(V.commandParameters.clearStateOnFinish)return{returnValue:!0,ZGa:!0};if(Ga&&xb(Ga.sourceItem)){var Bb=Ga.sourceItem;if(!Bb.isFromCurrentSession(this.$))return{returnValue:!1,ZGa:!0};Ga=-1985798686===Ga.commandParameters.ribbonCommandInfo.command;if(!(1<Bb.ranges.length||1<V.commandParameters.expandDestinations.length)){var gc=
df.K(Bb.ranges);V=df.K(V.commandParameters.expandDestinations);var dd=this.$.ea.qa.sheetName;Bb=Bb.sheetName;if(Bb===dd&&V.equals(gc))return{returnValue:!1,ZGa:!0};if(Bb===dd&&V.Me(gc))return{returnValue:!0,ZGa:!1}}return{returnValue:Ga,ZGa:!0}}return{returnValue:!1,ZGa:!0}};bd.prototype.RCf=function(){var V=jc(this.DK);(V=this.Wr.fwb(V))&&V.isFromCurrentSession(this.$)&&this.Vr("OnStartEdit",!1).catch(function(){})};bd.prototype.gbc=function(V){V=Se.a.UNh(V,bd.TIa);return this.Ezi+Cb.a.mw(V).toString()};
bd.prototype.sod=function(V){V=bd.iKa(V);return!!V&&Yb.a.X1a(V,bd.Dzi)};bd.prototype.g4g=function(){var V=Se.a.gd(1,2,331,332,Gg.a.pp?333:Gg.a.XH?334:335,530046625,"ActivateLocalStorage"),Ga=Ib.GetServiceTaskFactory.Va(this.$.da,5,4,0);Sd.TaskExtensions.Ba(Ga,function(){Ga.result.eg(41,V)},this.la,3)};bd.prototype.aCe=function(V){return void 0===V||null===V?nd.$Ci:V?nd.success:nd.failed};bd.G2g=function(V){var Ga=V.innerError;return Ga&&0!==Ga.pasteErrorName?V.innerError:null};bd.t2g=function(V){var Ga=
V.innerError;return Ga&&0!==Ga.copyErrorName?V.innerError:null};bd.iKa=function(V){var Ga="";if(!V)return bd.sGe;V.errorName&&(Ga=V.errorName,V.innerError&&(Ga+=bd.TIa+bd.iKa(V.innerError)));Ga||(Ga=V&&V.name?V.name:bd.sGe);return Ga};bd.oac=function(){bd.cMb||(Ic.a.Eef()?bd.cMb=Ub.IBj:Ic.a.wpd()?bd.cMb=Ub.HBj:bd.cMb=Ub.GBj);return bd.cMb};bd.UBe=function(V){switch(V){case 7:case 1:return 2149;case 5:return 2146;case 6:return 2145;case 8:case 3:case 2:case 4:case 9:case 10:return 2142;default:return fc.ULS.shipAssertTag(537167764,
0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",V),2149}};bd.u2g=function(V){switch(V){case 3:return 2143;case 1:return 2144;case 2:case 4:return 2142;default:return fc.ULS.shipAssertTag(537167763,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",V),2149}};Ek.Object.defineProperties(bd.prototype,{pasteIndicationManager:{configurable:!0,enumerable:!0,get:function(){return this.$.da.Aa(373)}}});
bd.Ipf="EwaJsMetadataChangeListenerId";bd.ZBd="cpiOSC";bd.rch="cpiDID";bd.$rb="Unknown";bd.sGe="UnknownError";bd.TIa="_";bd.oJe="DragAndDropError";bd.pasteErrorName="PasteError";bd.oUg="CancelError";bd.copyErrorName="CopyError";bd.Dzi="MergedCellOverlap";bd.JFf="PasteRecoveryCachedClipboardItems";bd.xjj=[1352631530,1679665408];bd.operationSucceededWithAlert=[-103190598];bd.pasteDataLimitHit=[1306609195];bd.copyThrottlingError=[-386183710];bd.dragDropNonEmptyRange=[563945982];bd.cMb=null;Object(xd.a)(bd,
"CopyPasteInfrastructure",ue.a,[896,897,3]);Object(xd.a)(md,"ClipboardPlatformInitializationResult",null,[]);var bg=b(738),Dd=b(125),oc=b(5),nc=b(84);Object(xd.a)(Ob,"MacroRecorderPasteRangePayload",null,[445]);Zc.prototype.getContent=function(){return this.content};Object(xd.a)(Zc,"MacroRecorderPasteStringPayload",null,[445]);var cf=b(63);Object(xd.a)(Ud,"MacroRecorderPastePayload",null,[445]);var Jg=b(647),Re=b(973),ve=b(562),zf=b(175),zg=b(212),Ed=b(119),rf=b(291),Uf=b(354);hd.prototype.getParameters=
function(){return this.parameters};Object(xd.a)(hd,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[445]);var lg=b(387);Object(xd.a)(pc,"PasteHtmlRequestParams",null,[]);Vb.prototype.copy=function(V,Ga,Bb,gc,dd){function sd(ff,fg,Ig){var ah={CopyPasteTargetType:1};ah.SourceRanges=V;ah.CopyOperationId=Ga.id;fc.ULS.sendTraceTag(537167756,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : {0}, CopyOperationId : {1}",ie.Kwa,ah.CopyOperationId);ie.lNa=ie.Kwa?we(ie.$.na.vw,ah,rf.b(ff,
Bb),gc?rf.a(fg,gc):fg,Ig,Ga.ribbonCommandInfo,Ce,dd):we(ie.$.na.ua,ah,rf.b(ff,Bb),gc?rf.a(fg,gc):fg,Ig,Ga.ribbonCommandInfo,Ce,dd);return ie.lNa}var ie=this;gc=void 0===gc?null:gc;dd=void 0===dd?null:dd;var Ce=this.$.na.ua.hc();this.Pmd&&this.zY();this.gjc=Ce.ClientRequestId;var af=td.EwaSettings.qc()?new zf.a(505,0,sd,80):new ve.a(505,0,sd,16);af=this.$.userOperationManager.ic(af,Ga.ribbonCommandInfo);this.Pmd&&this.zv.add(af)};Vb.prototype.IFf=function(V,Ga,Bb,gc,dd,sd){var ie=this;return new Promise(function(Ce,
af){var ff,fg=sd.commandParameters.stopwatch.Bc,Ig=2;20===sd.commandParameters.commandType&&(Ig=16);36===sd.commandParameters.commandType&&(Ig=32);Ic.a.wpd()&&68===sd.commandParameters.commandType&&(Ig=64);Ic.a.Ird(ie.$)&&1028===sd.commandParameters.commandType&&(Ig=1024);var ah=null;if(null===(ff=sd.copyContextSnapshot)||void 0===ff?0:ff.commandParameters)ah=sd.copyContextSnapshot.commandParameters.id;Vb.KNd(ie.$,V,gc,Ga,Bb,null,function(bh){Vb.ldc(bh,sd,Ce,af,fg,ie.$)},function(bh){sd.serverRequestTimeInMs=
sd.commandParameters.stopwatch.Bc-fg;bh=Ed.a.pg(bh.data);af(new Re.a(5,bh))},dd,Ig,ah,sd.commandParameters.id)})};Vb.prototype.pasteRange=function(V,Ga,Bb,gc,dd,sd,ie,Ce){var af=this;return new Promise(function(ff,fg){var Ig=ie.commandParameters.stopwatch.Bc;Vb.umj(af.$,V,Ga,Bb,gc|-5&dd,function(ah){Vb.ldc(ah,ie,ff,fg,Ig,af.$)},function(ah){ie.serverRequestTimeInMs=ie.commandParameters.stopwatch.Bc-Ig;ah=Ed.a.pg(ah.data);fg(new Re.a(5,ah))},sd,Ce)})};Vb.prototype.R0i=function(V,Ga,Bb,gc,dd,sd,ie){var Ce=
this;return(new Promise(function(af,ff){if(Ga)if(Ga.length>Ce.fOa){var fg=ie.clipboardItems.getItem(Bc.IW),Ig=-1;void 0!==fg&&null!==fg&&(Ig=fg.length);fc.ULS.sendTraceTag(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}, PlainTextLength: {2}",Ga.length,Ce.fOa,Ig);ff(new Re.a(1))}else fg=function(ah,bh,me){Ce.$.Ky();var $e=ie.commandParameters.stopwatch.Bc;ah=rf.b(ah,function(Qi){Vb.ldc(Qi,ie,af,ff,$e,Ce.$,Ga)});
bh=rf.a(bh,function(Qi){ie.serverRequestTimeInMs=ie.commandParameters.stopwatch.Bc-$e;Qi=Ed.a.pg(Qi.data);ff(new Re.a(3,Qi))});var Kh=Ce.$.na.ua.hc(),Ph=df.v(V,Ce.$),Tf={};Tf.SourceHtml=Ga;Tf.DestinationRanges=Ph?df.s(Ph):null;Tf.CopyOperationId=Bb;Tf.PasteId=gc;fc.ULS.sendTraceTag(537167755,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",Ce.Kwa,Tf.PasteId);return Ce.Kwa?qc(Ce.$.na.vw,Tf,ah,bh,me,null,Kh,sd):qc(Ce.$.na.ua,Tf,ah,bh,me,null,Kh,sd)},fg=
td.EwaSettings.qc()?new zf.a(204,0,fg,65):new ve.a(204,0,fg,1),Ce.$.userOperationManager.ic(fg,dd);else af("")})).then(function(){Mf.a.chi&&Ga.length>Ce.E$a&&(Ce.KYi(Ga),Ce.bO=new pc(V,Ga,Bb,gc,dd,sd,ie,0,Ce.lDd.length),window.requestIdleCallback&&window.requestIdleCallback(Ce.VFf))})};Vb.prototype.KYi=function(V){var Ga=this.$.Ob.Gc("Task","pasteHtmlChunkOperation"),Bb=Math.floor(V.length/this.E$a)+1;this.lDd=Array(Bb);for(var gc=0;gc<Bb;)this.lDd[gc]=V.substring(gc*this.E$a,(gc+1)*this.E$a),gc++;
fc.ULS.sendTraceTag(523257954,0,50,"CopyPasteUtils.populatePasteChunks Time taken for chunking: "+Ga.Bc)};Vb.prototype.VFf=function(){var V=this.lDd[this.bO.aqb],Ga=this.$.Ob.Gc("Task","pasteHtmlServerCall");this.NWi(this.bO.destinationRange,V,this.bO.Yqb,this.bO.HFf,this.bO.Rd,this.bO.GOb,this.bO.pasteContext,this.bO.aqb,this.bO.vWd);this.bO.aqb++;fc.ULS.sendTraceTag(523257953,0,15,"CopyPasteUtils.performChunkedPasteHtml server call time: "+Ga.Bc+",\n       pasteid:"+this.bO.HFf+",\n       chunkIndex:"+
this.bO.aqb+",\n       totalChunks:"+this.bO.vWd);this.bO.aqb<this.bO.vWd&&window.requestIdleCallback(this.VFf)};Vb.prototype.NWi=function(V,Ga,Bb,gc,dd,sd,ie,Ce,af){function ff(ah,bh,me){var $e=ie.commandParameters.stopwatch.Bc;ah=rf.b(ah);bh=rf.a(bh,function(){ie.serverRequestTimeInMs=ie.commandParameters.stopwatch.Bc-$e});var Kh=fg.$.na.ua.hc(),Ph=df.v(V,fg.$);Ph={SourceHtml:Ga,DestinationRanges:Ph?df.s(Ph):null,CopyOperationId:Bb,PasteId:gc+"_chunk_"+Ce,ChunkIndex:Ce,TotalChunks:af};fc.ULS.sendTraceTag(523257952,
0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",fg.Kwa,Ph.PasteId);return qc(fg.$.na.vw,Ph,ah,bh,me,null,Kh,sd)}var fg=this,Ig=td.EwaSettings.qc()?new zf.a(204,0,ff,65):new ve.a(204,0,ff,1);this.$.userOperationManager.ic(Ig,dd)};Vb.prototype.S0i=function(V,Ga,Bb,gc,dd){var sd=this;return new Promise(function(ie,Ce){fc.ULS.sendTraceTag(537167754,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",dd.id);
Ga&&(Ga=Yb.a.trimEnd(Ga,"\n","\r"));fc.ULS.sendTraceTag(537167753,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",dd.id);if(Ga){var af=sd.Zvd;if(Ga.length>af)fc.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Ga.length,af),Ce(new Re.a(1));else{var ff=df.v(V,sd.$);fc.ULS.sendTraceTag(537167752,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",
dd.id);af=!sd.$.ea.isNamedObjectViewMode&&!Ga.includes("\n")&&!Ga.includes("\t");fc.ULS.sendTraceTag(537167751,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",dd.id,af);af=af&&Yb.a.bef(Ga);fc.ULS.sendTraceTag(537167750,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",dd.id,af);var fg=sd.$.na.ua.hc();if(af){var Ig=526;fc.ULS.sendTraceTag(537167749,
0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",dd.id);var ah=zg.a.Xad(Ga);fc.ULS.sendTraceTag(537167748,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",dd.id);var bh=df.s(ff);af=function($e,Kh,Ph){var Tf=dd.commandParameters.stopwatch.Bc;$e=rf.b($e,function(Qi){fc.ULS.sendTraceTag(537167747,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",
dd.id);dd.requestTelemetryData=Qi.RequestTelemetryData;dd.serverRequestTimeInMs=dd.commandParameters.stopwatch.Bc-Tf;Qi.Errors&&0<Qi.Errors.length?Ce(new Re.a(2,Qi.Errors)):ie(Ga)});Kh=rf.a(Kh,function(Qi){dd.serverRequestTimeInMs=dd.commandParameters.stopwatch.Bc-Tf;Qi=Ed.a.pg(Qi.data);Ce(new Re.a(2,Qi))});sd.$.Ky();fc.ULS.sendTraceTag(537167746,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",dd.id);return nc.c(sd.$.na.ua,bh,Ga,ah,!1,!1,
63,$e,Kh,Ph,V,fg,gc)};var me=function(){return new Jg.a(bh,Ga,ah)}}else Ig=180,af=function($e,Kh,Ph){sd.$.Ky();var Tf=dd.commandParameters.stopwatch.Bc;$e=rf.b($e,function(Qi){fc.ULS.sendTraceTag(537167745,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",dd.id);Vb.ldc(Qi,dd,ie,Ce,Tf,sd.$,Ga)});Kh=rf.a(Kh,function(Qi){dd.serverRequestTimeInMs=dd.commandParameters.stopwatch.Bc-Tf;Qi=Ed.a.pg(Qi.data);Ce(new Re.a(4,Qi))});fc.ULS.sendTraceTag(537167744,
0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",dd.id);return Wd(sd.$.na.ua,ff,Ga,$e,Kh,Ph,null,fg,gc)},me=function(){return new Zc(ff,Ga)};fc.ULS.sendTraceTag(537167715,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",dd.id);af=td.EwaSettings.qc()?new zf.a(Ig,0,af,65,me):new ve.a(Ig,0,af,1,me);fc.ULS.sendTraceTag(537167714,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",
dd.id);sd.$.userOperationManager.ic(af,Bb)}}else ie("")})};Vb.prototype.W7e=function(V,Ga){Ga=[1===Ga?4:5];this.gridView.Cb.jx(Uf.a.Y7(cf.d(this.$.qa),V),Ga,!0);this.gridView.Cb.Fn(Ga);this.gridView.Cb.update(!0)};Vb.prototype.rxb=function(){var V=[4,5];this.gridView.Cb.Nh(V,!1,!1);this.gridView.Cb.wj(null,V,!1);1===this.gridView.ha.Ue&&this.gridView.Fn(!1,!1);this.gridView.Cb.update(!1,!1)};Vb.prototype.mTg=function(V,Ga,Bb){var gc=[];Bb=El(Bb);for(var dd=Bb.next();!dd.done;dd=Bb.next())gc.push(this.pTg(V,
Ga,dd.value));return gc};Vb.prototype.zY=function(){if(this.zv)for(var V=El(this.zv),Ga=V.next();!Ga.done;Ga=V.next())Ga=Ga.value,this.$&&this.$.userOperationManager&&(Ga.operation&&fc.ULS.sendTraceTag(526758675,0,50,"CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",Dd.a(Ga.operation.operationName)),this.mUg(),this.$.userOperationManager.oIa(Ga))};Vb.prototype.mUg=function(){if(this.lNa){var V=this.lNa.Qt;fc.ULS.sendTraceTag(526758674,0,15,"Cancelling pending copy request with Id={0}",
V);Ed.a.Du(V);!td.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&this.gjc&&nc.j(this.$.na.ua,this.gjc,null,null,null);this.gjc=this.lNa=null}};Vb.prototype.JF=function(V,Ga){2===Ga.su?(this.zv.clear(),this.lNa=null):1===Ga.su&&this.zv&&this.zv.contains(Ga.Lg)&&(fc.ULS.sendTraceTag(526758673,0,50,"CopyPasteUtils.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",Dd.a(Ga.Lg.operation.operationName),Ga.Lg.dequeueUtcTime.getTime()-Ga.Lg.enqueueUtcTime.getTime()),
this.zv.remove(Ga.Lg),this.lNa=null)};Vb.prototype.pTg=function(V,Ga,Bb){fc.ULS.shipAssertTag(537167713,0,!!Ga,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");fc.ULS.shipAssertTag(537167712,0,0<Ga.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");var gc=0,dd=0,sd=new Set,ie=new Set;Ga=El(Ga);for(var Ce=Ga.next();!Ce.done;Ce=Ga.next()){Ce=Ce.value;var af=String.format("{0}_{1}",Ce.left,Ce.right),ff=String.format("{0}_{1}",Ce.top,
Ce.bottom);ie.has(af)||(ie.add(af),dd+=Ce.width);sd.has(ff)||(sd.add(ff),gc+=Ce.height)}if(36===V)return Bb.isSingle?Vb.BRe(dd,gc,Bb):Bb.clone();516===V&&(V=gc,gc=dd,dd=V);V=!(Bb.width%dd)&&!(Bb.height%gc);sd=Bb.s_&&!(Bb.height%gc);Bb.G5&&!(Bb.width%dd)||sd?Bb=Vb.BRe(dd,gc,Bb):V?Bb=Bb.clone():(Bb=Bb.clone(),Bb.bottom=Math.min(He.a.Hh,Bb.top+gc-1),Bb.right=Math.min(He.a.Qh,Bb.left+dd-1));return Bb};Vb.prototype.MKg=function(V,Ga,Bb,gc,dd,sd,ie,Ce,af,ff,fg){if(!gc||!gc.length)return 1;if(1<gc.length){if(!this.cgc&&
sd)return 3;if(ff)return 0;if(Ce)return 9;if(af)return 8;if(fg)return 2;if(1<Ga.length)return 4;var Ig=Ga[0];if(!ie&&!Fc.a.all(gc,function(ah){return ah.isSingle||!(ah.width%Ig.width)&&!(ah.height%Ig.height)}))return 5;if((!this.cgc||!sd)&&Yb.a.equals(V,Bb,!0))for(dd=El(dd),V=dd.next();!V.done;V=dd.next())if(V=V.value,V.Hd(Ig)&&!V.equals(Ig))return 6}else if(Ga&&0<Ga.length){if(0!==this.Qbf(Ga,af))return 7;if(1<Ga.length){if(!this.cgc&&sd)return 3;if((!this.cgc||!sd)&&Yb.a.equals(V,Bb,!0))for(V=El(Ga),
Ga=V.next();!Ga.done;Ga=V.next())if(Ga=Ga.value,Bb=dd[0],Ga.Hd(Bb)&&!Ga.equals(Bb))return 6}}return 0};Vb.prototype.Qbf=function(V,Ga){if(!V||1>=V.length)return 0;if(Ga)return 2;if(!df.S(V))return 1;Ga=new bg.a(oa.a.Pk());for(var Bb=El(V),gc=Bb.next();!gc.done;gc=Bb.next()){gc=gc.value;for(var dd=El(V),sd=dd.next();!sd.done;sd=dd.next()){sd=sd.value;var ie=gc.top===sd.top&&gc.bottom===sd.bottom,Ce=gc.left===sd.left&&gc.right===sd.right,af=Math.max(gc.left,sd.left)<Math.min(gc.right,sd.right);if(Math.max(gc.top,
sd.top)<Math.min(gc.bottom,sd.bottom)&&!ie||af&&!Ce)return 3;Ga.add(String.format("{0}-{1}-{2}-{3}",gc.top,gc.bottom,sd.left,sd.right));Ga.add(String.format("{0}-{1}-{2}-{3}",sd.top,sd.bottom,gc.left,gc.right))}}V=El(V);for(Bb=V.next();!Bb.done;Bb=V.next())Bb=Bb.value,Ga.remove(String.format("{0}-{1}-{2}-{3}",Bb.top,Bb.bottom,Bb.left,Bb.right));return 0<Ga.count?3:0};Vb.prototype.q6i=function(V){var Ga=this.gridView.ha;Ga.updateSelection(V,V.topLeft,0);Ga.selectionType=-1};Vb.prototype.fwb=function(V){if(null===
V||void 0===V?0:V.sourceItem){if(!xb(V.sourceItem))return null;if((V=V.sourceItem)&&df.cb(V.ranges,!0))return V}return null};Vb.prototype.Egc=function(V,Ga){fc.ULS.shipAssertTag(537167711,0,!!V,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Ga&&oc.a.LI in Ga||V.tabName?!1:1===V.method};Vb.umj=function(V,Ga,Bb,gc,dd,sd,ie,Ce,af){function ff(){return new Ob(Bb,gc,dd)}function fg(ah,bh,me){V.Ky();var $e=V.na.ua;ah=rf.b(ah,sd);bh=rf.a(bh,ie);var Kh=Ce;Kh=void 0===Kh?null:
Kh;var Ph=$e.Na(9,Ig);Ph.sourceRanges=Bb;Ph.destinationRanges=gc;Ph.flags=dd;return nc.i($e,"PasteRange",Ph,ah,bh,me,null,64,Kh)}var Ig=V.na.ua.hc(af?{lla:!0,kka:1}:{lla:!1,kka:0});af=td.EwaSettings.qc()?new zf.a(506,0,fg,65,ff):new ve.a(506,0,fg,1,ff);V.userOperationManager.ic(af,Ga)};Vb.ldc=function(V,Ga,Bb,gc,dd,sd,ie){ie=void 0===ie?null:ie;fc.ULS.sendTraceTag(537167710,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",Ga.id);Ga.requestTelemetryData=
V.RequestTelemetryData;Ga.serverRequestTimeInMs=Ga.commandParameters.stopwatch.Bc-dd;Se.a.oh(V.Errors)?Se.a.Zga(V.Errors)?(Ga&&(Ga.encounteredDeploymentErrors=!0),fc.ULS.sendTraceTag(537167707,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",Se.a.Wc(V.Errors))):gc(new Re.a(5,V.Errors)):V.Result?(gc=!!V&&!!V.RequestTelemetryData,re.g(sd).Ji.ola(Ga.commandParameters.stopwatch.id,V.StateId,gc?V.RequestTelemetryData.EcsOperationDuration:
0,gc?V.RequestTelemetryData.EcsRequestDuration:0,gc?V.RequestTelemetryData.WfeRequestDuration:0),Ga.pastedRange=V.Result.SheetMultiRange,fc.ULS.sendTraceTag(537167708,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",Ga.id),Bb(!0)):(fc.ULS.sendTraceTag(537167709,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",Ga.id),Bb(ie||!0))};
Vb.KNd=function(V,Ga,Bb,gc,dd,sd,ie,Ce,af,ff,fg,Ig){function ah(){return new Ud($e)}function bh(Kh,Ph,Tf){V.Ky();return Ad(V.na.ua,$e,rf.b(Kh,ie),rf.a(Ph,Ce),Tf,sd,me,af)}var me=V.na.ua.hc(),$e=Vb.g8g(Bb,gc,dd,ff,fg,Ig);Bb=td.EwaSettings.qc()?new zf.a(503,0,bh,65,ah):new ve.a(503,0,bh,1,ah);V.userOperationManager.ic(Bb,Ga)};Vb.g8g=function(V,Ga,Bb,gc,dd,sd){var ie={};ie.ShadowWorkbookBase64=V.shadowWorkbookBase64;ie.SourceRanges={};ie.SourceRanges.Ranges=Array(1);ie.SourceRanges.Ranges[0]={};ie.SourceRanges.Ranges[0].FirstRow=
V.rangeRowStart;ie.SourceRanges.Ranges[0].LastRow=V.rangeRowEnd;ie.SourceRanges.Ranges[0].FirstColumn=V.rangeColumnStart;ie.SourceRanges.Ranges[0].LastColumn=V.rangeColumnEnd;td.EwaSettings.getBooleanFeatureGate(Mf.a.d5b,!1)?Bb?ie.DestinationRanges=df.u(Bb.SheetName,Bb.NamedObjectName,df.g(Bb.Ranges)):(fc.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),ie.DestinationRanges=null):ie.DestinationRanges=Ga?df.s(Ga):null;ie.CopyPasteTargetType=
1;ie.PasteType=gc;ie.CopyOperationId=dd;ie.PasteId=sd;ie.SourceClientPath=V.sourceClientPath;ie.SourceSheetName=V.sourceSheetName;ie.SourceWorkbookName=V.sourceWorkbookName;if(!V.originalSourceRangesCountExceedsLimit&&V.originalSourceRanges&&0<V.originalSourceRanges.length&&1024===gc){ie.OriginalSourceMultiRange={};Ga=Array(V.originalSourceRanges.length);for(Bb=0;Bb<Ga.length;++Bb)Ga[Bb]={},Ga[Bb].FirstRow=V.originalSourceRanges[Bb][0],Ga[Bb].FirstColumn=V.originalSourceRanges[Bb][1],Ga[Bb].LastRow=
V.originalSourceRanges[Bb][2],Ga[Bb].LastColumn=V.originalSourceRanges[Bb][3];ie.OriginalSourceMultiRange.Ranges=Ga}return ie};Vb.BRe=function(V,Ga,Bb){Bb=Bb.clone();Bb.height<Ga&&(Bb.bottom=Math.min(He.a.Hh,Bb.top+Ga-1));Bb.width<V&&(Bb.right=Math.min(He.a.Qh,Bb.left+V-1));return Bb};Vb.prototype.executeInsertCopiedCutCellsOperation=function(V,Ga,Bb,gc,dd,sd,ie){function Ce(){return new hd(af)}sd=void 0===sd?null:sd;ie=void 0===ie?null:ie;var af={};af.InsertDirection=gc;af.SourceRange=V;af.DestRange=
Ga;af.CopyCutOperation=Bb?0:1;var ff=this.$.na.ua;return lg.a(this.$.userOperationManager,function(fg,Ig,ah){fg=sd?rf.b(fg,sd):fg;Ig=ie?rf.a(Ig,ie):Ig;var bh=ff.Na(41,null);bh.insertCopiedCutCellsParameters=af;return nc.i(ff,"InsertCopiedCutCells",bh,fg,Ig,ah,null,4)},function(fg){return new zf.a(104,0,fg,void 0,Ce)},dd)};Vb.prototype.uhh=function(V,Ga,Bb,gc,dd,sd){var ie=this;return new Promise(function(Ce,af){function ff(Ig){Ig=Ed.a.pg(Ig.data);af(new Re.a(21,Ig))}function fg(Ig){V.requestTelemetryData=
Ig.RequestTelemetryData;Ig.Errors&&0<Ig.Errors.length?af(new Re.a(21,Ig.Errors)):Ce(!0)}td.EwaSettings.isChangeGateEnabled("OfficeVSO:6126613_RemoveClearingRunningAntsICCCForDragInsert")?ie.executeInsertCopiedCutCellsOperation(Ga,Bb,gc,dd,sd,fg,ff):ie.executeInsertCopiedCutCellsOperation(Ga,Bb,gc,dd,sd,fg,ff).continueWith(function(){if(gc)ie.rxb();else{var Ig=ie.$.da.Aa(254);Ig&&Ig.F2b("DragDropInsert/success/"+pg.a[sd.method],!0)}})})};Ek.Object.defineProperties(Vb.prototype,{Zvd:{configurable:!0,
enumerable:!0,get:function(){fc.ULS.sendTraceTag(537167757,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.$.ya.MaxCopyPasteLength);return this.$.ya.MaxCopyPasteLength}},fOa:{configurable:!0,enumerable:!0,get:function(){return this.Kwa?td.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.ya.CopyPasteMaxPayloadLength):He.a.fOa}}});Object(xd.a)(Vb,"CopyPasteUtils",null,[898]);var ni=b(541),he;
(function(V){V[V.range=0]="range";V[V.art=1]="art"})(he||(he={}));Object(xd.b)("SourceItemType",he);var Ke=b(25),Qg=b(95);Na.prototype.serializeSourceItem=function(V){var Ga={};if(V&&Object.getType(V)===rd)Ga.sheetName=V.sheetName,Ga.topArray=Fc.a.map(V.ranges,function(Bb){return Bb.top}),Ga.leftArray=Fc.a.map(V.ranges,function(Bb){return Bb.left}),Ga.bottomArray=Fc.a.map(V.ranges,function(Bb){return Bb.bottom}),Ga.rightArray=Fc.a.map(V.ranges,function(Bb){return Bb.right}),Ga.sessionStateId=V.sessionStateId,
Ga.sessionId=V.sessionId,Ga.sourceItemType=this.kXf(0);else if(V&&Object.getType(V)===tf)Ga.activeFloatingObjectControlId=V.activeFloatingObjectControlId,Ga.sheetName=V.sheetName,Ga.sessionStateId=V.sessionStateId,Ga.sessionId=V.sessionId,Ga.floatingObjectType=this.Wmj(V.type),Ga.sourceItemType=this.kXf(1);else return fc.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(Ga)};Na.prototype.serializeCommandParameters=
function(V){if(!V)return fc.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var Ga={};Ga.id=V.id;Ga.commandType=V.commandType;Ga.copyPasteTargetType=V.copyPasteTargetType;V.ribbonCommandInfo&&(Ga.ribbonCommandName=this.dnj(V.ribbonCommandInfo.command),Ga.inputMethodName=this.Ymj(V.ribbonCommandInfo.method),Ga.frameModeName=this.Xmj(V.ribbonCommandInfo.mode),Ga.uiLocationName=this.gnj(V.ribbonCommandInfo.Ye),Ga.tabName=V.ribbonCommandInfo.tabName);
return JSON.stringify(Ga)};Na.prototype.deserializeSourceItem=function(V){if(!V)return null;try{var Ga=JSON.parse(V);if(!Ga)return fc.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;var Bb=null;switch(this.tdh(Ga.sourceItemType)){case 0:Bb=new rd(this.$,this.qdh(Ga),Ga.sheetName,Ga.sessionStateId,Ga.sessionId);break;case 1:Bb=new tf(Ga.activeFloatingObjectControlId,Ga.sheetName,Ga.sessionStateId,Ga.sessionId,this.ndh(Ga.floatingObjectType))}return Bb}catch(gc){return fc.ULS.sendTraceTag(537167702,
0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",V?V.length:0,gc),null}};Na.prototype.deserializeCommandParameters=function(V){if(!V)return null;try{var Ga=JSON.parse(V);if(!Ga)return fc.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;var Bb=zh.a();Bb.id=Ga.id;Bb.ribbonCommandInfo=this.sdh(Ga);Bb.commandType=Ga.commandType;Bb.copyPasteTargetType=
Ga.copyPasteTargetType;return Bb}catch(gc){return fc.ULS.sendTraceTag(537167700,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",V?V.length:0,gc),null}};Na.prototype.qdh=function(V){var Ga=[];fc.ULS.shipAssertTag(537167699,0,!!V.topArray&&0<V.topArray.length,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",V.topArray?"empty":"null");fc.ULS.shipAssertTag(537167698,0,!!V.leftArray&&
0<V.leftArray.length,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",V.leftArray?"empty":"null");fc.ULS.shipAssertTag(537167697,0,!!V.bottomArray&&0<V.bottomArray.length,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",V.bottomArray?"empty":"null");fc.ULS.shipAssertTag(537167696,0,!!V.rightArray&&0<V.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",V.rightArray?"empty":"null");if(!(V.topArray&&
V.leftArray&&V.bottomArray&&V.rightArray))return Ga;fc.ULS.shipAssertTag(537167695,0,V.topArray.length===V.bottomArray.length&&V.topArray.length===V.leftArray.length&&V.topArray.length===V.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",V.topArray.length,V.bottomArray.length,V.leftArray.length,V.rightArray.length);for(var Bb=Math.min(V.topArray.length,V.bottomArray.length,V.leftArray.length,
V.rightArray.length),gc=0;gc<Bb;gc++)Ga.push(new Ke.Range(V.topArray[gc],V.leftArray[gc],V.bottomArray[gc],V.rightArray[gc],!1,!1));return Ga};Na.prototype.sdh=function(V){return new Qg.a(this.rdh(V.ribbonCommandName),this.pdh(V.inputMethodName),this.odh(V.frameModeName),this.udh(V.uiLocationName),V.tabName)};Na.prototype.dnj=function(V){return void 0!==V&&null!==V&&V.toString()in this.NLd?this.NLd[V.toString()]:(fc.ULS.shipAssertTag(537167694,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",
-911352779,-1985798686,V),this.NLd["-911352779"])};Na.prototype.rdh=function(V){return V&&V in this.x6f?this.x6f[V]:(fc.ULS.shipAssertTag(537167693,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,V),-911352779)};Na.prototype.Ymj=function(V){return void 0!==V&&null!==V&&pg.a[V]in this.hka?this.hka[pg.a[V]]:(fc.ULS.shipAssertTag(537167692,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",
V),this.hka.unknown)};Na.prototype.pdh=function(V){return V&&V in this.w6f?this.w6f[V]:(fc.ULS.shipAssertTag(537167691,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",V),0)};Na.prototype.Xmj=function(V){return void 0!==V&&null!==V&&ni.a[V]in this.d3a?this.d3a[ni.a[V]]:(fc.ULS.shipAssertTag(537167690,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",V),this.d3a.edit)};Na.prototype.odh=function(V){return V&&V in this.v6f?this.v6f[V]:
(fc.ULS.shipAssertTag(537167689,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",V),2)};Na.prototype.kXf=function(V){return void 0!==V&&null!==V&&he[V]in this.lMb?this.lMb[he[V]]:(fc.ULS.shipAssertTag(537167688,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",V),this.lMb.range)};Na.prototype.tdh=function(V){return V&&V in this.y6f?this.y6f[V]:(fc.ULS.shipAssertTag(537167687,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",
V),0)};Na.prototype.Wmj=function(V){return void 0!==V&&null!==V&&V.toString()in this.lXc?this.lXc[V.toString()]:(fc.ULS.shipAssertTag(537167686,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",V),this.lXc["99"])};Na.prototype.ndh=function(V){return V&&V in this.u6f?this.u6f[V]:(fc.ULS.shipAssertTag(537167685,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",V),99)};Na.prototype.gnj=function(V){return void 0!==V&&
null!==V&&jd.a[V]in this.Jr?this.Jr[jd.a[V]]:(fc.ULS.shipAssertTag(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",V),this.Jr.ribbon)};Na.prototype.udh=function(V){return V&&V in this.z6f?this.z6f[V]:(fc.ULS.shipAssertTag(537167684,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",V),2)};Object(xd.a)(Na,"EnvironmentSerializationHelper",null,[]);wa.CUf="SameSession";wa.hFe="CrossSession";wa.Qjf="LegacyCrossSession";wa.external=
"External";Object(xd.a)(wa,"PayloadOrigin",null,[]);vc.prototype.shouldWaitForCopyToComplete=function(){return!1};vc.prototype.onDeferredPasteStarted=function(){};vc.prototype.onDeferredPasteCompleted=function(){};vc.prototype.beforePaste=function(){};vc.prototype.SMj=function(V){var Ga=null;try{var Bb=V.getItem(Bc.EO);if(!Bb)return{returnValue:!1,O0:Ga};Ga=JSON.parse(Bb);return{returnValue:this.Yni(Ga),O0:Ga}}catch(gc){return fc.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+
gc),{returnValue:!1,O0:Ga}}};vc.prototype.Yni=function(V){return!!V&&(!!V.shadowWorkbookBase64||V.shadowWorkbookSizeExceedsLimit)&&void 0!==V.rangeRowStart&&void 0!==V.rangeRowEnd&&void 0!==V.rangeColumnStart&&void 0!==V.rangeColumnEnd};vc.prototype.Gpc=function(V){V.wasLastCopyExternal=!0;if(td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Gg.a.XC&&516!==V.commandParameters.commandType&&1028!==V.commandParameters.commandType){var Ga=this.SMj(V.clipboardItems);
var Bb=Ga.O0;if(Ga.returnValue)return V.isShadowWorkbookParsedSuccessfully=!0,this.MWi(V,Bb)}return 516!==V.commandParameters.commandType&&36!==V.commandParameters.commandType?td.EwaSettings.ma(162)&&20!==V.commandParameters.commandType&&(null===this.$.shortcutKeyManager||this.$.shortcutKeyManager.ggc)&&(Bb=V.clipboardItems.getItem(Bc.html),void 0!==Bb&&null!==Bb&&Bb&&Bb.trim()!==this.pXc&&(Bb.startsWith("<")||Gg.a.Gf&&Bb.startsWith("\n<")))?(Ga=V.clipboardItems.getItem(Bc.Yqb),this.KWi(V,Bb,void 0===
Ga?null:Ga)):this.DFf(V):Promise.reject(new Re.a(6))};vc.prototype.MWi=function(V,Ga){fc.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");V.pasteResult="SystemClipboardShadowWorkbookPaste";V.payloadType=Hc.EO;V.payloadOrigin=wa.external;V.shadowWorkbookPayloadSize=kd(Ga);V.shadowWorkbookSizeExceedsLimit=zc(Ga);var Bb=null,gc=null,dd=V.commandParameters.originalDestinations;td.EwaSettings.getBooleanFeatureGate(Mf.a.d5b,
!1)?Bb=df.r(dd,this.$):gc=df.v(df.K(dd),this.$);Ga.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(V.originalSourceRangesCountExceedsLimit=Ga.originalSourceRangesCountExceedsLimit);if(V.shadowWorkbookSizeExceedsLimit)return fc.ULS.sendTraceTag(537167833,0,15,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",V.shadowWorkbookPayloadSize,He.a.$kc,Ga.shadowWorkbookSizeExceedsLimit),
Promise.reject(new Re.a(1));fc.ULS.sendTraceTag(537167832,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId={0}",V.commandParameters.id);return this.Wr.IFf(V.commandParameters.ribbonCommandInfo,gc,Bb,Ga,[V.commandParameters.stopwatch],V)};vc.prototype.DFf=function(V){var Ga=V.clipboardItems.getItem(Bc.IW);if(void 0!==Ga&&null!==Ga&&Ga.trim()===this.pXc)return Promise.reject(new Re.a(7));void 0!==Ga&&null!==Ga&&(V.plainTextPayloadSize=Ga.length);
V.isPlainTextPaste=!0;V.pasteResult="SystemClipboardPaste";V.payloadOrigin=vd(V)?wa.Qjf:wa.external;V.payloadType=Hc.IW;fc.ULS.sendTraceTag(537167831,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}, PasteOperationId={1}",V.id,V.commandParameters.id);Ga=this.Wr.S0i(df.K(V.commandParameters.originalDestinations),Ga,V.commandParameters.ribbonCommandInfo,[V.commandParameters.stopwatch],V);fc.ULS.sendTraceTag(537167830,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",
V.id);return Ga};vc.prototype.KWi=function(V,Ga,Bb){V.htmlPayloadSize=Ga.length;V.isHtmlPaste=!0;V.pasteResult="SystemClipboardHtmlPaste";V.payloadType=Hc.html;V.payloadOrigin=vd(V)?wa.Qjf:wa.external;fc.ULS.sendTraceTag(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId={0}",V.commandParameters.id);return this.Wr.R0i(df.K(V.commandParameters.originalDestinations),Ga,Bb,V.commandParameters.id,V.commandParameters.ribbonCommandInfo,[V.commandParameters.stopwatch],
V)};vc.prototype.FEe=function(V){var Ga={};V&&(Ga.shadowWorkbookBase64=V.ShadowWorkbookBase64,Ga.shadowWorkbookSizeExceedsLimit=V.ShadowWorkbookSizeExceedsLimit,Ga.originalSourceRangesCountExceedsLimit=V.OriginalSourceRangesCountExceedsLimit,Ga.originalSourceRangesCount=V.OriginalSourceRangesCount,Ga.shadowWorkbookBlockedSize=V.ShadowWorkbookBlockedSize);return Ga};vc.prototype.Neg=function(V,Ga){var Bb=$d(V),gc=32===(V.commandParameters.commandType&32),dd=1024===(V.commandParameters.commandType&
1024),sd=!1,ie=null,Ce=null,af=!1;if(!Bb){sd=-1985798686===V.commandParameters.ribbonCommandInfo.command;var ff=V.copyContextSnapshot;if(Ga)af=!ff.sourceItem.isFromCurrentSession(this.$);else if(ff=this.Wr.fwb(ff))ie=ff.ranges,Ce=ff.sheetName,af=!V.isSameSession}return this.Wr.MKg(Ce,ie,this.$.qa.sheetName,V.commandParameters.originalDestinations,V.commandParameters.expandDestinations,af,gc,dd,sd,Ga,Bb)};Ek.Object.defineProperties(vc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
pXc:{configurable:!0,enumerable:!0,get:function(){return this.Ym.Wa(5)}}});Object(xd.a)(vc,"BaseCopyPasteHandler",null,[992,993,994]);Za.prototype.getValue=function(V){return this.key&&this.key.isEqual(V)?this.createClipboardItems(this.clipboardItems):null};Za.prototype.setValue=function(V,Ga){this.key=V;this.clipboardItems=this.createClipboardItems(Ga)};Za.prototype.createClipboardItems=function(V){var Ga=this.A$.create(),Bb=V.getItem(Bc.IW);Bb&&Ga.setItem(Bc.IW,Bb);(Bb=V.getItem(Bc.EO))&&Ga.setItem(Bc.EO,
Bb);(V=V.getItem(Bc.html))&&Ga.setItem(Bc.html,V);return Ga};Object(xd.a)(Za,"CopyCache",null,[]);var Rg=b(70);Am(ub,vc);ub.prototype.getSourceItem=function(){var V=Fc.a.clone(this.gridView.ha.sa.selectedRanges);return new rd(this.$,V,this.$.ea.qa.sheetName,this.$.ea.rf,this.$.ya.UserSessionId)};ub.prototype.beforeSerialize=function(V){var Ga=this;V.isSelectionAllowed=!1;V.isAsyncCopy=!1;V.isFromCache=!1;V.encounteredDeploymentErrors=!1;V.plainTextPayloadSize=0;V.shadowWorkbookPayloadSize=0;V.htmlPayloadSize=
0;V.clientSideCopyTime=0;var Bb=new Gd.a(this.$.xa),gc=V.sourceItem;V.isSelectionAllowed=Fc.a.all(gc.ranges,function(dd){return Ga.isSelectionAllowed(Bb,dd)});V.isSelectionAllowed&&this.Wr.W7e(gc.ranges,V.commandParameters.commandType)};ub.prototype.KMa=function(V){return this.gridView.Ea.g_()&&re.i(this.gridView,V)};ub.prototype.gXi=function(V,Ga,Bb,gc){var dd=!1,sd=1===Ga.commandParameters.commandType,ie=gc[0].uM;1===Bb.ranges.length&&1===gc.length?td.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&
sd&&1!==ie&&ie!==Bb.ranges[0].uM?V.cseStatus=17:dd=this.o3g.W6c(V,df.K(Bb.ranges),Bb.sheetName,df.K(V.commandParameters.expandDestinations),this.$.ea.qa.sheetName,sd):V.cseStatus=5;dd&&re.g(this.$).Ji.U0(V.commandParameters.stopwatch.id,Rg.BasicTelemetryCalculator.iR);return this.SWi(V,Bb,df.u(this.$.qa.sheetName,null,gc),Ga.commandParameters.commandType,dd)};ub.prototype.isSelectionAllowed=function(V,Ga){return V.jAb(Ga,this.gridView)};ub.prototype.SWi=function(V,Ga,Bb,gc,dd){Ga=df.u(Ga.sheetName,
null,Ga.ranges);V.pasteResult="SameSessionPaste";V.payloadOrigin=wa.CUf;V.payloadType=Hc.uzg;fc.ULS.sendTraceTag(537167829,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId={0}",V.commandParameters.id);return this.Wr.pasteRange(V.commandParameters.ribbonCommandInfo,Ga,Bb,gc,V.commandParameters.commandType,[V.commandParameters.stopwatch],V,dd)};Object(xd.a)(ub,"BaseRangeCopyPasteHandler",vc,[]);var Oe=b(35);Zb.prototype.onDeferredPasteStarted=function(V){this.YU.xb(V.id)||
this.YU.add(V.id,!0);if(0<this.YU.count){var Ga=Ib.GetServiceTaskFactory.Va(this.$.da,5,4,0);Sd.TaskExtensions.Ba(Ga,function(){Ga.result.eg(28,null)},this.$.la,3)}};Zb.prototype.onDeferredPasteCompleted=function(V){var Ga=0<this.YU.count;this.YU.xb(V.id)&&this.YU.remove(V.id);if(Ga&&!this.YU.count){var Bb=Ib.GetServiceTaskFactory.Va(this.$.da,5,4,0);Sd.TaskExtensions.Ba(Bb,function(){Bb.result.removeEntry(28)},this.$.la,3)}};Object(xd.a)(Zb,"DeferredPasteTracker",null,[]);var Df;(function(V){V[V.none=
0]="none";V[V.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";V[V.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";V[V.asyncCopyCanceled=3]="asyncCopyCanceled";V[V.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(Df||(Df={}));Object(xd.b)("CopyErrorType",Df);var Zg=b(1129),qh=b(1279),Xi=Zg.a;Am(Jb,Xi);Object(xd.a)(Jb,"CopyInnerError",Zg.a,[]);Am(Mb,ub);Mb.prototype.serialize=function(V){var Ga=V.sourceItem,Bb={},gc=this.W2c.getValue(Ga);
if(gc)Bb.synchronousResult=gc,V.isFromCache=!0,V.clientSideCopyTime=V.commandParameters.stopwatch.Bc;else{var dd=null,sd=df.F(Ga.ranges);if(!Ic.a.Cdf()&&this.KMa(sd)){fc.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");sd=this.clipboardRangeFactory.create(sd);try{dd=sd.toString(),gc=this.A$.create(),gc.setItem(Bc.IW,dd),this.W2c.setValue(Ga,gc),Bb.synchronousResult=gc,V.clientSideCopyTime=V.commandParameters.stopwatch.Bc}finally{sd&&
sd.dispose()}}else V.isAsyncCopy=!0,Bb.synchronousResult=this.A$.create(),Bb.synchronousResult.setItem(Bc.IW,this.pXc);Bb.asynchronousResult=this.Idd(V,Ga,dd)}V.syncClipboardItemsKeys=Xc(Bb.synchronousResult);return Bb};Mb.prototype.shouldWaitForCopyToComplete=function(V){if(!V||!V.copyContextSnapshot)return fc.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;fc.ULS.shipAssertTag(537167906,
0,!!this.$.ya,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(V.copyContextSnapshot.sessionId===this.$.ya.UserSessionId)return fc.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;fc.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};Mb.prototype.onDeferredPasteStarted=
function(V){this.YU.onDeferredPasteStarted(V)};Mb.prototype.onDeferredPasteCompleted=function(V){this.YU.onDeferredPasteCompleted(V)};Mb.prototype.deserialize=function(V){V.isClipboardDataContainShadowWorkbook=!(void 0===V.clipboardItems.getItem(Bc.EO)||null===V.clipboardItems.getItem(Bc.EO));if(re.g(this.$).ha.Ue&326)return $d(V)&&(V.wasLastCopyExternal=!0),Promise.reject(new Re.a(17));var Ga=this.Neg(V,!1);if(0!==Ga)return Promise.reject(new Re.a($d(V)?18:V.isSameSession?19:20,void 0,void 0,void 0,
Ga));var Bb=V.copyContextSnapshot,gc=this.Wr.fwb(Bb);if($d(V))return this.Gpc(V);Ga=V.commandParameters.originalDestinations;if(gc&&V.isSameSession)return this.gXi(V,Bb,gc,Ga);if(516!==V.commandParameters.commandType){gc=this.RMj(V.clipboardItems);Bb=gc.O0;if(gc.returnValue){V.isShadowWorkbookParsedSuccessfully=!0;var dd=gc=null;td.EwaSettings.getBooleanFeatureGate(Mf.a.d5b,!1)?gc=df.r(Ga,this.$):dd=df.v(df.K(Ga),this.$);return this.IWi(V,dd,gc,Bb)}if(V.isClipboardInaccessible)return Promise.reject(new Re.a(8));
if(36!==V.commandParameters.commandType)return this.DFf(V)}return Promise.reject(new Re.a(6))};Mb.prototype.beforePaste=function(V){this.$.da.Aa(373).Rjj(V);V.indicationDisplayScheduled=!0};Mb.prototype.mMj=function(V){if(!(V&&V.SourceRanges&&V.SourceRanges.Ranges&&V.SourceRanges.Ranges.length&&(V.OriginalSourceRangesCountExceedsLimit||V.OriginalSourceMultiRange&&V.OriginalSourceMultiRange.Ranges&&V.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,O0:null};var Ga=V.SourceRanges.Ranges[0];
if(!V.ShadowWorkbookBase64&&!V.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,O0:null};var Bb=this.FEe(V);Bb.rangeRowStart=Ga.FirstRow;Bb.rangeRowEnd=Ga.LastRow;Bb.rangeColumnStart=Ga.FirstColumn;Bb.rangeColumnEnd=Ga.LastColumn;Bb.sourceClientPath=V.SourceClientPath;Bb.sourceSheetName=V.SourceSheetName;Bb.sourceWorkbookName=V.SourceWorkbookName;if(!V.OriginalSourceRangesCountExceedsLimit)for(V=V.OriginalSourceMultiRange.Ranges,Bb.originalSourceRanges=Array(V.length),Ga=0;Ga<V.length;++Ga)Bb.originalSourceRanges[Ga]=
[V[Ga].FirstRow,V[Ga].FirstColumn,V[Ga].LastRow,V[Ga].LastColumn];return{returnValue:!0,O0:Bb}};Mb.prototype.RMj=function(V){var Ga=null;V=V.getItem(Bc.EO);if(!V)return{returnValue:!1,O0:Ga};Ga=JSON.parse(V);return{returnValue:this.Xni(Ga),O0:Ga}};Mb.prototype.Xni=function(V){return!!V&&(!!V.shadowWorkbookBase64||V.shadowWorkbookSizeExceedsLimit)&&void 0!==V.rangeRowStart&&void 0!==V.rangeRowEnd&&void 0!==V.rangeColumnStart&&void 0!==V.rangeColumnEnd};Mb.prototype.IWi=function(V,Ga,Bb,gc){fc.ULS.shipAssertTag(537167903,
0,!!gc,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");Od.AFrameworkApplication.tN("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");V.pasteResult="CrossSessionPaste";V.payloadOrigin=wa.hFe;V.payloadType=Hc.EO;V.shadowWorkbookPayloadSize=kd(gc);V.shadowWorkbookSizeExceedsLimit=zc(gc);gc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(V.originalSourceRangesCountExceedsLimit=gc.originalSourceRangesCountExceedsLimit);
if(V.shadowWorkbookSizeExceedsLimit)return fc.ULS.sendTraceTag(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",V.shadowWorkbookPayloadSize,He.a.$kc,gc.shadowWorkbookSizeExceedsLimit),Promise.reject(new Re.a(1));if(1028===V.commandParameters.commandType&&V.originalSourceRangesCountExceedsLimit)return fc.ULS.sendTraceTag(572617859,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count({0}) is over the limit({1}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: {2}",
gc.originalSourceRangesCount,He.a.uyi,gc.originalSourceRangesCountExceedsLimit),Promise.reject(new Re.a(1));fc.ULS.sendTraceTag(537167902,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId={0}",V.commandParameters.id);return this.Wr.IFf(V.commandParameters.ribbonCommandInfo,Ga,Bb,gc,[V.commandParameters.stopwatch],V)};Mb.prototype.Idd=function(V,Ga,Bb){var gc=this;fc.ULS.shipAssertTag(537167901,0,!!V,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");
var dd=V.commandParameters.stopwatch.Bc;return new Promise(function(sd,ie){fc.ULS.sendTraceTag(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",V.id);var Ce=df.u(Ga.sheetName,null,Ga.ranges);gc.Wr.copy(Ce,V.commandParameters,function(af){V.requestTelemetryData=af.RequestTelemetryData;V.serverRequestTimeInMs=V.commandParameters.stopwatch.Bc-dd;if(Se.a.oh(af.Errors))Se.a.Zga(af.Errors)?(V.encounteredDeploymentErrors=
!0,fc.ULS.sendTraceTag(537167898,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",Se.a.Wc(af.Errors),V.id)):(fc.ULS.sendTraceTag(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",Se.a.Wc(af.Errors),V.id),ie(new Jb(2,af.Errors)));else if(fc.ULS.sendTraceTag(537167900,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",
V.id),V.markForCancellation)ie(new Jb(3,af.Errors));else{af=af.Result;var ff=af.PlainTextResult;void 0!==Bb&&null!==Bb&&(ff=Bb);void 0!==ff&&null!==ff&&(V.plainTextPayloadSize=ff.length);var fg=gc.A$.create(),Ig=gc.mMj(af);var ah=Ig.O0;Ig.returnValue&&(V.shadowWorkbookPayloadSize=kd(ah),V.shadowWorkbookSizeExceedsLimit=zc(ah),V.originalSourceRangesCountExceedsLimit=af.OriginalSourceRangesCountExceedsLimit,ah=JSON.stringify(ah),fg.setItem(Bc.EO,ah));fg.setItem(Bc.IW,ff);Ic.a.Cdf()&&(ff=af.HtmlResult,
V.htmlSizeExceedsLimit=af.HtmlSizeExceedsLimit,void 0!==ff&&null!==ff&&(V.htmlPayloadSize=ff.length),fg.setItem(Bc.html,ff));V.copyTotalSizeExceedsLimit=af.CopyTotalSizeExceedsLimit;fg.setItem(Bc.Yqb,V.commandParameters.id);gc.W2c.setValue(Ga,fg);V.asyncClipboardItemsKeys=Xc(fg);sd(fg)}},function(af){V.serverRequestTimeInMs=V.commandParameters.stopwatch.Bc-dd;af=Ed.a.pg(af.data);fc.ULS.sendTraceTag(537167897,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",
Se.a.Wc(af),V.id);ie(new Jb(2,af))},[V.commandParameters.stopwatch])})};Object(xd.a)(Mb,"AcrossSessionRangeCopyPasteHandler",ub,[]);Object(xd.a)(ib,"CopyArtRequest",null,[]);Object(xd.a)(Qa,"PasteArtRequest",null,[]);qb.prototype.E3h=function(V){if(this.cki(V.UNa)){fc.ULS.sendTraceTag(537167681,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",V.UNa);var Ga=this.GIb.oa(V.UNa);this.GIb.ia(V.UNa,V);var Bb=Ga.promise;Ga.Rdf=!1;return this.zkh(V,
Bb)}this.GIb.ia(V.UNa,V);return this.Qqi(V)};qb.prototype.cki=function(V){return this.GIb.xb(V)};qb.prototype.Qqi=function(V){var Ga=this;return new Promise(function(Bb,gc){V.promise=Ga.vZa.CFf(V).then(function(dd){Bb(null);return Ga.$nc(V,dd)},function(dd){gc(null);return Ga.PEb(dd)})})};qb.prototype.zkh=function(V,Ga){var Bb=this;return new Promise(function(gc,dd){V.promise=Ga.then(function(sd){Bb.TRj(V,sd);return Bb.vZa.CFf(V).then(function(ie){gc(null);return Bb.$nc(V,ie)},function(ie){dd(null);
return Bb.PEb(ie)})},function(sd){return Bb.PEb(sd)})})};qb.prototype.$nc=function(V,Ga){V.Rdf&&(this.RXg(V.UNa),this.lNd(V,Ga));return this.r1i(Ga)};qb.prototype.RXg=function(V){this.GIb.remove(V)};qb.prototype.lNd=function(V,Ga){var Bb=this.NWh();V.UNa===Bb&&this.vZa.lNd(V.destination,Ga,V.item.type)};qb.prototype.NWh=function(){var V=re.g(this.$).ha.Oa.activeFloatingObjectControlId;V||(V=df.v(re.g(this.$).ha.sa.activeCell,this.$),V=V.FirstRow+"_"+V.FirstColumn);return V};qb.prototype.TRj=function(V,
Ga){V.destination=null;V.iHe=Ga};Object(xd.a)(qb,"PasteArtRequestManager",null,[]);var uh=b(191),Sf=b(120),ji=b(104);Am(Oa,vc);Oa.prototype.getSourceItem=function(){fc.ULS.shipAssertTag(537167896,0,!!this.ha.Oa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");fc.ULS.sendTraceTag(537167895,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.ha.Oa.activeFloatingObjectControlId);return new tf(this.ha.Oa.activeFloatingObjectControlId,
this.$.ea.qa.sheetName,this.$.ea.rf,this.$.ya.UserSessionId,this.ha.Oa.oc.floatingObject.type)};Oa.prototype.beforeSerialize=function(V){V&&V.commandParameters?(V?(V.isAsyncCopy=!1,V.isSelectionAllowed=!1,V.isFromCache=!1,V.plainTextPayloadSize=0,V.shadowWorkbookPayloadSize=0,V.htmlPayloadSize=0,V.htmlSizeExceedsLimit=!1,V.clientSideCopyTime=0,V.encounteredDeploymentErrors=!1,V.shadowWorkbookSizeExceedsLimit=!1,V.originalSourceRangesCountExceedsLimit=!1,V.copyTotalSizeExceedsLimit=!1):fc.ULS.sendTraceTag(537167826,
0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),V.commandParameters.copyPasteTargetType=2):fc.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")};Oa.prototype.serialize=function(V){var Ga=V.sourceItem,Bb={};if(!Ga)return fc.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Bb;if(!this.Nmi())return fc.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),
Bb;fc.ULS.sendTraceTag(537167892,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",Ga.activeFloatingObjectControlId);this.vEd();var gc=this.V2c.getValue(Ga);if(gc)Bb.synchronousResult=gc,V.isFromCache=!0,V.isAsyncCopy=!1,V.clientSideCopyTime=V.commandParameters.stopwatch.Bc,1===V.commandParameters.commandType&&this.$.Xd(2045211913,V.commandParameters.ribbonCommandInfo.method,V.commandParameters.ribbonCommandInfo.Ye,null);else{V.isFromCache=!1;V.isAsyncCopy=
!0;gc=this.A$.create();if(V.commandParameters.uploadToClipService){var dd={};dd["data-clipservice-ccpid"]=V.commandParameters.id;dd["data-pkey"]=V.commandParameters.pKey;dd["data-clipservice-type"]=V.commandParameters.clipServiceDataType;dd["data-clipservice-count"]=V.commandParameters.objectCount.toString();dd["data-clipservice-dc"]=V.commandParameters.clipServiceDataCenter;dd["data-clipservice-client"]=this.MYg;dd["data-TimeStamp"]=(new Date).toUTCString();dd["data-clipservice-version"]=this.NYg;
gc.setItem(Bc.CHg,JSON.stringify(dd))}Bb.synchronousResult=this.$Ag(gc);Bb.asynchronousResult=this.Idd(V,Ga,gc)}V.syncClipboardItemsKeys=Xc(Bb.synchronousResult);return Bb};Oa.prototype.$Ag=function(V){fc.ULS.shipAssertTag(537167891,0,!!this.ha.Oa.oc,"Expecting a floating object to be currently selected for copy");V||(V=this.A$.create());var Ga=this.ha.Oa.oc.Fub();Ga&&(Ga=String.format("<img src='{0}'>",Ga),V.setItem(Bc.html,Ga));return V};Oa.prototype.vEd=function(){var V=this.ha.Oa.oc;this.qob.vEd(Sf.a.pqb(V.floatingObject),
Sf.a.PYg(V.Xt))};Oa.prototype.shouldWaitForCopyToComplete=function(){fc.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};Oa.prototype.onDeferredPasteStarted=function(V){this.YU.onDeferredPasteStarted(V)};Oa.prototype.onDeferredPasteCompleted=function(V){this.YU.onDeferredPasteCompleted(V)};Oa.prototype.deserialize=function(V){var Ga=$d(V),Bb=null,gc=null,dd=!1;if(!Ga){Bb=V.copyContextSnapshot;gc=Bb.sourceItem;if(!gc)return Promise.reject(new Re.a(10));
dd=gc.isFromCurrentSession(this.$)}var sd=this.Neg(V,!0);if(0!==sd)return Promise.reject(new Re.a(Ga?18:dd?19:20,void 0,void 0,void 0,sd));if(Ga)return this.Gpc(V);if(!dd&&!Oa.Tfi(gc))return V=String.format("User attempted to paste art of type [{0}] between sessions.",gc.type),fc.ULS.sendTraceTag(537167889,0,50,V),Promise.reject(new Re.a(11,void 0,void 0,V));if(Bb.isAsyncSerializeFailed)return Promise.reject(new Re.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));
try{var ie=V.clipboardItems.getItem(Bc.EO);var Ce=JSON.parse(ie)}catch(af){return fc.ULS.sendTraceTag(537167888,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(af)),Promise.reject(new Re.a(12,void 0,af))}Ce.floatingObjectId!==gc.activeFloatingObjectControlId?fc.ULS.sendTraceTag(537167887,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",
gc.activeFloatingObjectControlId,Ce.floatingObjectId):fc.ULS.sendTraceTag(537167886,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",gc.activeFloatingObjectControlId,Ce.floatingObjectId);if(!Ce||!Ce.shadowWorkbookBase64)return Promise.reject(new Re.a(13,void 0,void 0,String.format("shadowWorkbookPayload is null = {0}",!Ce)));V.isShadowWorkbookParsedSuccessfully=!0;V.shadowWorkbookPayloadSize=
kd(Ce);V.shadowWorkbookSizeExceedsLimit=zc(Ce);V.payloadOrigin=dd?wa.CUf:wa.hFe;V.payloadType=Hc.kig;if(zc(Ce))return V=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",V.shadowWorkbookPayloadSize,He.a.$kc,Ce.shadowWorkbookSizeExceedsLimit),fc.ULS.sendTraceTag(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",V),Promise.reject(new Re.a(1,void 0,void 0,V));Bb=Ga=null;re.g(this.$).ha.Ue&326?Bb=re.g(this.$).ha.Oa.activeFloatingObjectControlId:
Ga=this.$.qa&&this.$.qa.activeCell?df.v(this.$.qa.activeCell,this.$):df.v(df.K(V.commandParameters.originalDestinations),this.$);dd=null;if(this.qob.K1f(gc))try{dd=this.qob.W6c()}catch(af){fc.ULS.sendTraceTag(537167885,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(af))}return this.JWi.E3h(new Qa(V.commandParameters.ribbonCommandInfo,Ga,Bb,V.commandParameters.commandType,[V.commandParameters.stopwatch],
Ce,gc,V,dd))};Oa.prototype.Gpc=function(V){V.wasLastCopyExternal=!0;if(V.clipboardItems.getItem("image/png")){var Ga=V.commandParameters.stopwatch.Bc;V.payloadType=Hc.MNg;var Bb={};return jf.b(this.$.Xd(1403967063,V.commandParameters.ribbonCommandInfo.method,V.commandParameters.ribbonCommandInfo.Ye,(Bb.dataUrl=V.clipboardItems.getItem("image/png"),Bb))).then(function(gc){V.serverRequestTimeInMs=V.commandParameters.stopwatch.Bc-Ga;return gc?Promise.resolve(null):Promise.reject(new Re.a(15))},function(){V.serverRequestTimeInMs=
V.commandParameters.stopwatch.Bc-Ga;return Promise.reject(new Re.a(15))})}fc.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return vc.prototype.Gpc.call(this,V)};Oa.prototype.Nmi=function(){var V=re.g(this.$).ha;return V.Oa.activeFloatingObjectControlId&&V.Oa.oc&&V.Oa.oc.floatingObject?V.Oa.oc.floatingObject.zUd():!1};Oa.prototype.Idd=function(V,Ga,Bb){var gc=this;return new Promise(function(dd,sd){var ie=V.commandParameters.stopwatch.Bc;
fc.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");gc.vZa.g3g(new ib(Ga.activeFloatingObjectControlId,V.commandParameters,function(Ce){V.requestTelemetryData=Ce.RequestTelemetryData;V.serverRequestTimeInMs=V.commandParameters.stopwatch.Bc-ie;if(Se.a.oh(Ce.Errors))Se.a.Zga(Ce.Errors)?(V.encounteredDeploymentErrors=!0,fc.ULS.sendTraceTag(537167879,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",
Se.a.Wc(Ce.Errors))):(fc.ULS.sendTraceTag(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Se.a.Wc(Ce.Errors)),sd(new Jb(4,Ce.Errors)));else if(fc.ULS.sendTraceTag(537167883,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",Ga.activeFloatingObjectControlId),V.markForCancellation)sd(new Jb(3,Ce.Errors));else{Se.a.lr(Ce.Errors)&&fc.ULS.sendTraceTag(537167882,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",
Se.a.Wc(Ce.Errors));var af=Ce.Result;if(af){af=gc.FEe(af);af.floatingObjectId=Ga.activeFloatingObjectControlId;V.shadowWorkbookPayloadSize=kd(af);V.shadowWorkbookSizeExceedsLimit=zc(af);try{var ff=JSON.stringify(af)}catch(fg){sd(new Re.a(14,void 0,fg,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",V.shadowWorkbookPayloadSize,af.floatingObjectId)));return}fc.ULS.shipAssertTag(537167881,0,!!Bb,"Expecting syncClipboardItems to be defined");
Bb.setItem(Bc.EO,ff);1===V.commandParameters.commandType&&(gc.XZi(Ga.type,Ga.activeFloatingObjectControlId,Ce.StateId),gc.deleteFloatingObject(Ga.activeFloatingObjectControlId,Ga.type));gc.V2c.setValue(Ga,Bb);V.asyncClipboardItemsKeys=Xc(Bb);dd(Bb)}else fc.ULS.sendTraceTag(537167880,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",Ga.activeFloatingObjectControlId),dd(gc.V2c.getValue(Ga))}},V.commandParameters.commandType,Ga.type,function(Ce){V.serverRequestTimeInMs=
V.commandParameters.stopwatch.Bc-ie;Ce=Ed.a.pg(Ce.data);1===V.commandParameters.commandType&&gc.vZa.PNj(Ga.type,Ga.activeFloatingObjectControlId);fc.ULS.sendTraceTag(537167878,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Se.a.Wc(Ce));sd(new Jb(4,Ce))},[V.commandParameters.stopwatch]))})};Oa.prototype.deleteFloatingObject=function(V,Ga){V=uh.a.rz(Ga,V);if(V=ji.a(this.$).Hq(V))ji.a(this.$).deleteFloatingObject(V,14,!0),re.g(this.$).ha.Oa.FC=null};Oa.prototype.XZi=
function(V,Ga,Bb){var gc=this.$.da.Aa(277);if(gc){var dd=null;V=uh.a.rz(V,Ga);V=ji.a(this.$).Hq(V);if(null===V||void 0===V?0:V.Yi)dd=V.Yi.block;if(dd){var sd=V.floatingObject.Vg();gc.VYb(function(){return!dd.aj.xb(sd)},Bb,"CutArt")}}};Oa.Tfi=function(V){return 1===V.type||5===V.type};Object(xd.a)(Oa,"ArtCopyPasteHandler",vc,[]);var Uh=b(56);Am(sa,Ud);Object(xd.a)(sa,"MacroRecorderPasteArtPayload",Ud,[]);ba.prototype.S8h=function(V,Ga,Bb,gc,dd,sd,ie){var Ce=this;sd=void 0===sd?null:sd;ie=void 0===
ie?null:ie;var af=this.$.na.ua.hc(),ff=null,fg={CopyPasteTargetType:2};fg.FloatingObjectId=V;fg.CopyOperationId=Bb.id;Bb.floatingObjectType=Ga;fg.UploadToClipService=Bb.uploadToClipService;fg.PKey=Bb.pKey;fg.ClipServiceDataCenter=Bb.clipServiceDataCenter;var Ig=0;2===dd?(dd=505,Ig=16,ff=function(ah,bh,me){return we(Ce.$.na.ua,fg,rf.b(ah,gc),sd?rf.a(bh,sd):bh,me,Bb.ribbonCommandInfo,af,ie)}):(dd=179,ff=function(ah,bh,me){Ce.wgh(Ga,V);Ce.$.Ky();var $e=Ce.$.na.ua;ah=rf.b(ah,gc);bh=sd?rf.a(bh,sd):bh;
var Kh=Bb.ribbonCommandInfo,Ph=ie;Ph=void 0===Ph?null:Ph;var Tf=$e.Na(1,void 0===af?null:af);Tf.copyParameters=fg;return nc.i($e,"Cut",Tf,ah,bh,me,Kh,0,Ph)});td.EwaSettings.qc()?this.$.userOperationManager.ic(new zf.a(dd,0,ff,Ig|64),Bb.ribbonCommandInfo):this.$.userOperationManager.ic(new ve.a(dd,0,ff,Ig),Bb.ribbonCommandInfo)};ba.prototype.wgh=function(V,Ga){var Bb=uh.a.rz(V,Ga);(Bb=ji.a(this.$).Hq(Bb))?(re.g(this.$).ha.Oa.jH(Bb),Bb.isVisible=!1):fc.ULS.sendTraceTag(537167876,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",
V,Ga)};ba.prototype.PNj=function(V,Ga){V=uh.a.rz(V,Ga);if(V=ji.a(this.$).Hq(V))V.isVisible=!0};ba.prototype.g3g=function(V){this.S8h(V.floatingObjectId,V.e3g,V.commandParameters,V.At,V.Cah,V.taa,V.GOb)};ba.prototype.r9h=function(V,Ga,Bb,gc,dd,sd,ie,Ce,af){var ff=this;Ce=void 0===Ce?null:Ce;af=void 0===af?!0:af;return new Promise(function(fg,Ig){var ah=sd.commandParameters.stopwatch.Bc;ff.KNd(V,dd,Ga,Bb,function(bh){sd.requestTelemetryData=bh.RequestTelemetryData;sd.serverRequestTimeInMs=sd.commandParameters.stopwatch.Bc-
ah;if(Se.a.Zga(bh.Errors))sd&&(sd.encounteredDeploymentErrors=!0),fc.ULS.sendTraceTag(537167875,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",Se.a.Wc(bh.Errors));else if(Se.a.oh(bh.Errors))fc.ULS.sendTraceTag(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",Se.a.Wc(bh.Errors)),Ig(new Re.a(9,bh.Errors));else if(bh.Result){var me=bh.Result;fc.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");
ff.l_i(ie,me.FloatingObjectId,bh.StateId);fg(ba.eld(me.FloatingObjectId))}else fc.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),Ig(new Re.a(9,bh.Errors))},function(bh){sd.serverRequestTimeInMs=sd.commandParameters.stopwatch.Bc-ah;bh=Ed.a.pg(bh.data);fc.ULS.sendTraceTag(537167872,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",Se.a.Wc(bh));Ig(new Re.a(9,bh))},gc,Ce,af)})};ba.prototype.l_i=function(V,Ga,Bb){var gc=
this,dd=this.$.da.Aa(277);if(dd){var sd=uh.a.rz(V,ba.eld(Ga));dd.VYb(function(){return!!ji.a(gc.$).Hq(sd)},Bb,"PasteArt")}};ba.prototype.FXd=function(V,Ga){Ga&&this.qob.FXd(V,uh.a.rz(V.type,Ga))};ba.prototype.CFf=function(V){var Ga=this;return this.r9h(V.ribbonCommandInfo,V.destination,V.iHe,V.GOb,V.O0,V.pasteContext,V.item.type,V.Uye,V.item.isFromCurrentSession(this.$)).then(function(Bb){return Bb},function(Bb){Ga.FXd(V.item,V.Uye);return Promise.reject(Bb)})};ba.prototype.lNd=function(V,Ga,Bb){V||
(V=df.v(re.g(this.$).ha.sa.activeCell,this.$));re.g(this.$).Ohc(df.D(V),1)?ji.a(this.$).jna(Bb,Ga,!0):re.g(this.$).ha.Oa.Jsa(V,Ga,Bb).continueWith(function(gc){gc.result?fc.ULS.sendTraceTag(537167843,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",Ga):fc.ULS.sendTraceTag(537167842,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",Ga)})};ba.prototype.KNd=function(V,Ga,Bb,gc,dd,sd,ie,Ce,af){function ff(){if(af){var me=
Uh.a.mi(Uh.a.Kc(bh));me.FloatingObjectId=Ga.floatingObjectId;bh.DestinationRanges||(me.DestinationRanges=df.p(Ig.$.xa.qa.sheetName,"",0,0,0,0));return new sa(me,af,0,0)}return new sa(bh,af,0,0)}function fg(me,$e,Kh){Ce||Ig.$.Ky();return Ad(Ig.$.na.ua,bh,rf.b(me,dd),rf.a($e,sd),Kh,null,ah,ie)}var Ig=this;af=void 0===af?!0:af;var ah=this.$.na.ua.hc(),bh={};bh.ShadowWorkbookBase64=Ga.shadowWorkbookBase64;bh.FloatingObjectId=gc;bh.DestinationRanges=Bb?df.s(Bb):null;bh.CopyPasteTargetType=2;bh.ClientEstimationFloatingObjectId=
Ce;Bb=td.EwaSettings.qc()?new zf.a(503,0,fg,void 0,ff):new ve.a(503,0,fg,void 0,ff);Bb.flags=td.EwaSettings.qc()?65:1;this.$.userOperationManager.ic(Bb,V)};ba.eld=function(V){return String.format("{0}.{{{1}}}",V.length+2,V.toUpperCase())};Object(xd.a)(ba,"ArtCopyPasteUtils",null,[976]);var sh=b(248);I.prototype.vEd=function(V,Ga){this.fta=V;this.T2c=Ga};I.prototype.W6c=function(){if(!this.fta||!this.T2c)return fc.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),
"";var V=Sf.a.pqb(new uh.a(this.fta));V.Id=ba.eld(rg.a.create().toString());V.Version=-1;V.Name="";V.IsClientEstimation=!0;var Ga=this.F$h(V);if(!Ga)return null;var Bb=new uh.a(V);Ga.block.aj.add(Bb);Bb.LIb();var gc=ji.a(this.$);gc.s4b(Bb,Ga);Ga=gc.Hq(uh.a.QPh(V));!Ga||Ga.floatingObject.sMa||Ga.floatingObject.RMa||Ga.yRa(this.T2c);gc.jna(V.Type,V.Id,!0);return V.Id};I.prototype.K1f=function(V){return td.EwaSettings.ma(223)&&V.isFromCurrentSession(this.$)&&!re.g(this.$).rtl&&!re.g(this.$).rb.dj};I.prototype.FXd=
function(V,Ga){this.K1f(V)&&(V=ji.a(this.$).Hq(Ga))&&(fc.ULS.sendTraceTag(537167840,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",Ga,V.floatingObject.type),ji.a(this.$).deleteFloatingObject(V,15,!0),V.Yi&&V.dbb(V.Yi,!1))};I.prototype.F$h=function(V){if(!V)return fc.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;
if(re.g(this.$).ha.Oa.activeFloatingObjectControlId){var Ga=re.g(this.$).ha.Oa.FC.floatingObject;V.OriginDeltaX=Ga.offsetX+this.F$a;V.OriginDeltaY=Ga.offsetY+this.F$a;V.AbsoluteLeft+=this.F$a;V.AbsoluteTop+=this.F$a;V.AbsoluteRight+=this.F$a;V.AbsoluteBottom+=this.F$a;V.ZOrder=Ga.Ty+1;return re.g(this.$).ha.Oa.FC.Yi}if(!this.$.qa||!this.$.qa.activeCell)return fc.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),
null;var Bb=this.$.qa.activeCell;Ga=re.g(this.$).o1(Bb);if(!Ga)return fc.ULS.sendTraceTag(537167837,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",Bb.toString()),null;var gc=bb.HelperMethods.rKa(Ga.domElement,Ga.zj.domElement);Bb=Ga.gridView.qg(Bb,2);if(!gc||!Bb)return fc.ULS.sendTraceTag(537167836,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",
!gc,!Bb),null;V.OriginDeltaX=Bb.topLeft.x-gc.x;V.OriginDeltaY=Bb.topLeft.y-gc.y;V.AbsoluteLeft=Bb.topLeft.x;V.AbsoluteTop=Bb.topLeft.y;V.AbsoluteRight=V.AbsoluteLeft+Math.abs(this.fta.AbsoluteRight-this.fta.AbsoluteLeft);V.AbsoluteBottom=V.AbsoluteTop+Math.abs(this.fta.AbsoluteBottom-this.fta.AbsoluteTop);V.ZOrder=this.fta.ZOrder+100;return new sh.a(Ga.gridView.Ea.sl(Ga.hashCode),Ga.hashCode)};Object(xd.a)(I,"ArtPasteClientEstimation",null,[975]);$a.prototype.create=function(){var V=window.clipboardPlatform;
return V?V.createClipboardItems():null};Object(xd.a)($a,"ClipboardItemsFactory",null,[974]);jb.undefined="Undefined";Object(xd.a)(jb,"CCPTelemetryConsts",null,[]);Uc.cells="Cells";Uc.floatingObject="FloatingObject";Uc.unknown="Unknown";Object(xd.a)(Uc,"ActiveSelection",null,[]);hc.Jfh="DisplayNotInvoked";hc.O6c="Displayed";hc.w_i="PrerequisitesNotReady";Object(xd.a)(hc,"PasteIndicationDisplayStatus",null,[]);var Jh=b(110);zb.prototype.getCopyFlowHandler=function(V){var Ga=this.JLh(re.g(this.$).Ue);
V.commandParameters.copyPasteHandlerName=Ga.name;return Ga};zb.prototype.getPasteFlowHandler=function(V){var Ga=V.copyContextSnapshot;Ga=ae(V)?this.kXc:$d(V)?this.wGd:(null===Ga||void 0===Ga?0:Ga.sourceItem)&&Object.getType(Ga.sourceItem)===tf?this.kXc:this.wGd;V.commandParameters.copyPasteHandlerName=Ga.name;return Ga};zb.prototype.initializePasteContext=function(V){if(V&&(V.isSameSession=!1,V.isShadowWorkbookParsedSuccessfully=!1,V.pasteResult=jb.undefined,V.payloadOrigin=jb.undefined,V.payloadType=
jb.undefined,V.encounteredDeploymentErrors=!1,V.shadowWorkbookSizeExceedsLimit=!1,V.originalSourceRangesCountExceedsLimit=!1,V.activeSelectionType=this.CHh(),V.indicationDisplayScheduled=!1,V.pasteDestinationHasMergedCells=!1,V.pasteIndicationDisplayStatus=hc.Jfh,V.copyContextSnapshot)){var Ga=V.copyContextSnapshot,Bb=xb(Ga.sourceItem),gc=Ga.sourceItem;var dd=!!gc&&Object.getType(gc)===tf;gc=0;var sd=!1;Bb?(sd=Ga.sourceItem,V.isSameSession=sd.isFromCurrentSession(this.$),gc=1,sd=this.dki(sd,V)):dd&&
(V.isSameSession=Ga.sourceItem.isFromCurrentSession(this.$),gc=2);if(V.copyContextSnapshot.commandParameters){dd=-1985798686===Ga.commandParameters.ribbonCommandInfo.command;var ie=V.commandParameters;var Ce=this.$;Ga?Ce&&Ce.ya?Ga=Ga.sessionId===Ce.ya.UserSessionId:(fc.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Ga=!1):(fc.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Ga=!1);ie.clearSystemClipboard=Ga&&dd&&Bb&&!sd;V.commandParameters.copyPasteTargetType=gc}}};
zb.prototype.getSessionId=function(){return this.$.ya.UserSessionId};zb.prototype.dki=function(V,Ga){var Bb=Jh.b(V.ranges,function(gc){return gc.ef})&&Jh.b(Ga.commandParameters.originalDestinations,function(gc){return 1!==gc.top});return Jh.b(V.ranges,function(gc){return gc.isRow})&&Jh.b(Ga.commandParameters.originalDestinations,function(gc){return 1!==gc.left})||Bb};zb.prototype.JLh=function(V){switch(V){case 1:return this.wGd;case 64:case 4:case 2:case 256:return this.kXc;default:throw Error.invalidOperation("Unsupported selection");
}};zb.prototype.CHh=function(){return re.g(this.$).ha.Ue&470?Uc.floatingObject:1===re.g(this.$).ha.Ue?Uc.cells:Uc.unknown};zb.prototype.getDialogResponse=function(){};Ek.Object.defineProperties(zb.prototype,{wGd:{configurable:!0,enumerable:!0,get:function(){if(!this.xPc){var V=this.$.da.Aa(254,!0);V&&(this.xPc=new Mb(this.$,V,new $a))}return this.xPc}},kXc:{configurable:!0,enumerable:!0,get:function(){if(!this.rFc&&this.$.da.Aa(254,!0)){var V=new I(this.$);this.rFc=new Oa(this.$,new $a,new ba(this.$,
V),V)}return this.rFc}}});Object(xd.a)(zb,"ExcelCopyPasteApplicationHost",null,[895]);var Dh=b(161),Og=bf.a;Am(Gc,Og);Gc.prototype.hh=function(V){this.Zo=new Dh.a;var Ga=Rf.a.instance.fa(16);V=this.GV(V);this.initializeAndShow(Ga,this.ybi,V)};Gc.prototype.GV=function(V){var Ga={};return Ga[Gc.Yx]=this.Cc,Ga[Gc.Dli]=V,Ga};Ek.Object.defineProperties(Gc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"InsertCopiedCutCellsDialog"}}});Gc.Seh="direction";Gc.Dli="isRtl";var oi={};Gc.Teh=
(oi.Vertical=1,oi.Horizontal=0,oi);Object(xd.a)(Gc,"InsertCopiedCutCellsDialog",bf.a,[]);Xb.prototype.u4b=function(V,Ga){return(new Gc(V,Ga)).Zo.task};Object(xd.a)(Xb,"InsertCopiedCutCellsDialogFactory",null,[892]);var $h=b(90),Ch=b(47),Gh=b(44);Wa.prototype.kJe=function(){var V=this;this.uqc||(fc.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.RC(function(Ga){Ga.Wua(0).then(function(){V.uqc=!0})}))};Wa.prototype.Rjj=
function(V){var Ga=this,Bb=V.commandParameters.id;fc.ULS.sendTraceTag(537167651,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",Bb,!this.Xs,this.uqc);this.kJe();this.v5b=Bb;Bb=!this.lrf();if(!this.Xs||Bb)this.hwe(),this.Xs=Ch.a.instance.create(function(){Ga.Ifh(V)},void 0===V.timeoutToShowSpinnerInMs||null===V.timeoutToShowSpinnerInMs?100:V.timeoutToShowSpinnerInMs,Gh.a.OWi);this.y2=V.commandParameters.originalDestinations};
Wa.prototype.Ifh=function(V){this.uqc?(this.display(V.commandParameters.originalDestinations),V.pasteIndicationDisplayStatus=hc.O6c):(fc.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),V.pasteIndicationDisplayStatus=hc.w_i)};Wa.prototype.display=function(V){fc.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.Cb.jx(Uf.a.Y7(cf.d(this.gridView.$.qa),V),Wa.Hpc,!0);this.gridView.Cb.Fn(Wa.Hpc)};
Wa.prototype.Sjd=function(V){fc.ULS.sendTraceTag(537167648,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",V,this.v5b);V&&Yb.a.equals(V,this.v5b,!1)&&this.hide()};Wa.prototype.hide=function(V){this.y2&&(void 0===V?0:V)&&this.lrf()&&fc.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.v5b="";this.hwe();this.y2=null;this.gridView.Cb.Nh(Wa.Hpc);
this.gridView.Cb.wj(null,Wa.Hpc)};Wa.prototype.lrf=function(){return df.Q(this.gridView.ha.sa.selectedRanges,this.y2)};Wa.prototype.hwe=function(){this.Xs&&($h.a.Ha(this.Xs),this.Xs=null)};Wa.prototype.dispose=function(){this.hide();this.gridView.ha.WF(this.A7e)};Wa.Hpc=[30];Object(xd.a)(Wa,"PasteIndicationManager",null,[894,3]);var Oi=b(1182),Di=b(54),nh=Dg.a;Am(wb,nh);wb.prototype.create=function(){var V=this,Ga=Di.a.E_([51,52],4,this.ub,void 0,void 0,void 0,wb.rAa),Bb=Ib.GetServiceTaskFactory.create(this.$.da,
18,this.$.la,this.ub);Sd.TaskExtensions.Ba(Sd.TaskExtensions.ye([Bb,Ga],this.la),function(){var gc=new Oi.a,dd=null;V.K0g(gc).then(function(sd){dd=sd.Zye;var ie=copyPasteInfra.createCopyPasteInfra(dd,new zb(V.$),gc,V.$);fc.ULS.shipAssertTag(537167762,0,!!V.$.ya,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");fc.ULS.shipAssertTag(537167761,0,!!V.$.ya&&!!V.$.ya.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");
var Ce=dd.getMetadataManager();V.Eb(new bd(V.$,Ce,Bb.result,ie,new Vb(V.$,re.g(V.$)),new Xb,V.$.ya.DocumentHostInfo.UserId,dd.getInitializationError()));sd.T_a?fc.ULS.sendTraceTag(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}",bd.oac(),sd.T_a.dataClipboardStrategyType,JSON.stringify(sd.T_a.dataClipboardCapabilities),sd.T_a.clipboardStrategiesToInitialize[0].clipboardStrategyType===
sd.T_a.dataClipboardStrategyType,void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString()):fc.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(sd){fc.ULS.shipAssertTag(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",
bd.oac(),sd?copyPasteInfra.getStringifiedError(sd):"null")})},this.la,3)};wb.prototype.dispose=function(){nh.prototype.dispose.call(this)};wb.prototype.K0g=function(V){var Ga=null,Bb=window.clipboardPlatform;Bb&&(Ga=Bb.getClipboardPlatformEnvironment());if(!Ga)return fc.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);Bb=this.$.ya;var gc=[Bb.OfficeOnlineChromeExtensionId,
Bb.ChromeClipboardAccessExtensionId],dd=this.Ym.Wa(5),sd=this.$.Yf.get(57),ie=!sd&&this.$.Yf.get(5),Ce=this.$.ea.xc;Ce&&(Ce.inWebPart||Ce.inViewerFromWebPart||Ce.isDivSyndicated)&&(ie=!1);sd=this.GKh(ie,!sd);fc.ULS.shipAssertTag(537167758,0,!!Bb.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Ga.init(this.$,V,gc,Bb.SharedClipboardHostingApp,Bb.SharedClipboardHostingApps,Bb.SharedClipboardHostingEnvironments,
Bb.SharedClipboardOverrideOrigin,Bb.SharedClipboardSchemaVersion,Bb.SharedClipboardExpirationInMinutes,Bb.ClipboardPromiseTimeoutInMinutes,dd,Bb.MachineCluster,new Na(this.$),sd,Bb.DocumentHostInfo.UserId,Bb.ClipboardTtlInMS,td.EwaSettings.ma(311),Bb.UserSessionId).then(function(af){return Object(hh.a)(new md,{Zye:Ga,T_a:af})},function(af){return Promise.reject(af)})};wb.prototype.GKh=function(V,Ga){var Bb=[];V&&Ga&&Bb.push(this.e$g());Ga&&(Bb.push(this.x4c(7)),Bb.push(this.x4c(0)));V&&Bb.push(this.ODe());
Bb.push({clipboardStrategyType:4});fc.ULS.sendTraceTag(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",V,Ga,Bb?Bb.join(","):"[]");return Bb};wb.prototype.ODe=function(){var V=this.$.ya,Ga={clipboardStrategyType:5};Ga.sessionId=V.UserSessionId;Ga.useSharedClipboardIframe=!0;Ga.sharedClipboardHostingApp=V.SharedClipboardHostingApp;Ga.sharedClipboardHostingApps=
V.SharedClipboardHostingApps;Ga.sharedClipboardHostingEnvironments=V.SharedClipboardHostingEnvironments;Ga.sharedClipboardOverrideOrigin=V.SharedClipboardOverrideOrigin;Ga.sharedClipboardSchemaVersion=V.SharedClipboardSchemaVersion;Ga.sharedClipboardExpirationInMinutes=V.SharedClipboardExpirationInMinutes;Ga.wacCluster=V.MachineCluster;return Ga};wb.prototype.e$g=function(){var V={clipboardStrategyType:6};V.localStorageStrategyParameters=this.ODe();V.systemClipboardStrategyParameters=this.x4c(0);
return V};wb.prototype.x4c=function(V){var Ga={};Ga.clipboardStrategyType=V;Ga.skipFilesIfPlainTextExists=!0;return Ga};wb.ka=function(V){V.da.Ga(373,new Wa(V));V.da.Ga(wb.rAa,new wb(V))};wb.rAa=255;Object(xd.a)(wb,"CopyPasteInfrastructureFactory",Dg.a,[]);var Vg=b(11),li=b(109),wh=b(13),Hi=ue.a;Am(ic,Hi);ic.prototype.dispose=function(){this.vm();this.Al=this.xr=this.$=null;this.statusBarManager&&(this.statusBarManager.SF(this),this.statusBarManager=null)};ic.prototype.vn=function(){return this.i2f};
ic.prototype.es=function(V,Ga){if("QueryPasteShortcutEnabledLabel"!==V&&!Array.contains(ic.IEj,V))return!1;var Bb=this.Ao();"QueryPasteShortcutEnabledLabel"===V?(Ga.Visible=Bb,fc.ULS.sendTraceTag(537167636,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",Bb,V)):(Ga.Visible=!Bb,fc.ULS.sendTraceTag(537167635,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",!Bb,V));return!0};ic.prototype.akh=function(){this.Ck();this.raiseEvent("pasteShortcutStatusChanged")};
ic.prototype.G6b=function(){this.vm();this.raiseEvent("pasteShortcutStatusChanged")};ic.prototype.Ao=function(){return this.G8c};ic.prototype.Aq=function(V){this.addHandler("pasteShortcutStatusChanged",V)};ic.prototype.Wq=function(V){this.removeHandler("pasteShortcutStatusChanged",V)};ic.prototype.Ck=function(){if(!this.Ao()){this.G8c=!0;re.g(this.$).lk.ml(this.WHe);this.Al.ka("blur",this.bfh);var V=this.$.da.Aa(65);V&&V.q3&&V.q3.registerForCommentEvents(this.VHe);this.xr.zt(wh.a.Yb,this.Ogf?this.$.uw:
this.$.domElement,this.onKeyDown,!0)}};ic.prototype.vm=function(){if(this.Ao()){this.G8c=!1;re.g(this.$).lk.fl(this.WHe);this.Al.detach("blur");var V=this.$.da.Aa(65);V&&V.q3&&V.q3.unregisterForCommentEvents(this.VHe);this.xr.Ft(wh.a.Yb,this.Ogf?this.$.uw:this.$.domElement,this.onKeyDown,!0)}};ic.IEj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(xd.a)(ic,"PasteShortcutManager",ue.a,[891,483,271,3]);var lh=b(128),kg=Dg.a;Am(Kb,kg);Kb.prototype.create=function(){var V=this.$;this.Eb(V.da.Aa(478)||
this.$.da.Ga(478,new ic(V,li.KeyInputManager.instance,lh.a.instance.KE())))};Kb.ka=function(V){V.da.Ga(479,new Kb(V))};Object(xd.a)(Kb,"PasteShortcutManagerFactory",Dg.a,[]);bc.prototype.isEnabled=function(){if(Od.AFrameworkApplication.ga?Od.AFrameworkApplication.ga.ra("IsAnonymousUser"):1)return!1;var V=Od.AFrameworkApplication.dc?Object(Rb.a)(String,Od.AFrameworkApplication.dc.AudienceGroup):"";return"Unknown"!==V&&"Automation"!==V};Ek.Object.defineProperties(bc.prototype,{BWc:{configurable:!0,
enumerable:!0,get:function(){return"Excel"}},campaignId:{configurable:!0,enumerable:!0,get:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}},version:{configurable:!0,enumerable:!0,get:function(){return 1}},currentVersion:{configurable:!0,enumerable:!0,get:function(){return 0}},fgi:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(338)}},t7a:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(340)}},q7a:{configurable:!0,enumerable:!0,
get:function(){return this.$.ma(339)}},$Bh:{configurable:!0,enumerable:!0,get:function(){return null}},Qpf:{configurable:!0,enumerable:!0,get:function(){return 24}},JTf:{configurable:!0,enumerable:!0,get:function(){return 4E3}},aJb:{configurable:!0,enumerable:!0,get:function(){return this.$.ya.WebServiceBase||""}}});Object(xd.a)(bc,"FirstRunExperienceLauncherSettings",null,[900]);Cd.prototype.WRd=function(){this.LTe&&this.LTe.WRd(this.NBh)};Object(xd.a)(Cd,"FirstRunExperienceManager",null,[893]);
var Fg=Dg.a;Am(yc,Fg);yc.prototype.create=function(){this.Eb(this.$.da.Aa(311)||this.c6g())};yc.prototype.c6g=function(){var V=new bc(this.$);V=new Cd(fh.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),V);V.WRd();return V};yc.ka=function(V){V.da.Ga(312,new yc(V))};Object(xd.a)(yc,"FirstRunExperienceManagerFactory",Dg.a,[]);var xi=b(59),Ng=Dg.a;Am(Qb,Ng);Qb.prototype.create=function(){this.Eb(this.$.da.Aa(361)||this.O6g())};Qb.prototype.O6g=function(){var V=
this;this.nld=fh.a.instance.Kh("Common.IInProductMessagingUIManager");xi.a.Fg.isReactSharedHeaderUxEnabled?Fe.a.get_instance().Mk(16,function(){V.E$e()}):this.E$e();return this.nld};Qb.prototype.E$e=function(){var V=this;fh.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ga){Ga.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Bb){!Bb&&Ga.isFreemiumUpsellEnabled()&&V.nld.wkf();return null})})};Qb.ka=function(V){V.da.Ga(362,new Qb(V))};Object(xd.a)(Qb,
"InProductMessagingManagerFactory",Dg.a,[]);var Sh=b(906),Gi=b(103),ag=b(186),pi=b(108);Ja.prototype.mFb=function(V){this.Jj=V;if(!this.s1a){if(this.kZd){if(this.X8a&&Gg.a.wF){this.ESb=V.b7b(Object(fb.a)(this,this.pAd,"onFileChosen"));return}this.ESb=V.b7b(null);if(!this.UBa(this.ESb,V))return}this.finalizeUpload(V,null)}};Ja.prototype.pAd=function(V){if(this.UBa(V,this.Jj)){if(Gg.a.wF||Gg.a.Gf)this.ESb=V;this.finalizeUpload(this.Jj,null)}};Ja.prototype.Poc=function(){this.gCd&&this.gCd()};Ja.prototype.Dfj=
function(){this.$qa=0;this.KEa=this.ga.Dd("Box4UploadRetryDelayStart",200);this.Jj&&(this.Jj.dispose(),this.Jj=null)};Ek.Object.defineProperties(Ja.prototype,{context:{configurable:!0,enumerable:!0,get:function(){return this.mT}},ga:{configurable:!0,enumerable:!0,get:function(){return this.vb}},retryCount:{configurable:!0,enumerable:!0,get:function(){return this.$qa}},HLd:{configurable:!0,enumerable:!0,get:function(){return this.KEa}}});Object(xd.a)(Ja,"FileUploader",null,[]);var Th=b(330),xh=b(992),
Ea=b(133);Am(Db,Ja);Db.prototype.JYe=function(V){switch(V){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}};Db.prototype.Leg=function(V){return Db.UBa(V,this.p_h())};Db.prototype.p_h=function(){return Db.bje};Db.prototype.UBa=function(V,Ga){Ga=void 0===Ga?null:Ga;V=this.Leg(V);return 0!==V?(Ga&&Ga.lle(),2===V&&this.si(0,this.JYe(V)),!1):!0};Db.prototype.finalizeUpload=function(V,Ga){fc.ULS.sendTraceTag(36783360,
322,50,"PictureUploader.FinalizeUpload");this.gCd=Ga;this.Gzj();Th.a.mark(5576);this.oVb=this.OO.Gc("LoadResource","PictureUploadTime")};Db.prototype.si=function(V,Ga){var Bb=new Ea.StandardDialog;Bb.jc=0;Bb.bA(V,CommonUIStrings.l_ImageUploadFailedTitle,Ga,null)};Db.prototype.Poc=function(){fc.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");Ja.prototype.Poc.call(this);this.oVb&&(this.oVb.stop(),this.oVb=null);this.aZg()};Db.prototype.Gzj=function(){this.wra=(new xh.a).create();
this.wra.message=CommonUIStrings.l_ImageUploadWait;this.wra.jc=5;this.wra.qv=!1;this.wra.PAa(null,null,null)};Db.prototype.aZg=function(){this.wra&&(this.wra.close(),this.wra=null)};Db.k5h=function(V,Ga){V=Cb.a.Ul(V);for(var Bb=0;Bb<Ga.length;++Bb)if(V.endsWith(Ga[Bb]))return!0;return!1};Db.UBa=function(V,Ga){Ga=void 0===Ga?null:Ga;Ga||(Ga=Db.bje);return V?Db.k5h(V,Ga)?0:2:1};Ek.Object.defineProperties(Db.prototype,{OO:{configurable:!0,enumerable:!0,get:function(){return Od.AFrameworkApplication.ta.JD}}});
Db.bje=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(xd.a)(Db,"PictureUploader",Ja,[]);var ua=b(620),Ab=b(292),Xd=b(149),oe=b(91),yf=b(168),Pg=b(182),Af=b(87),ch=b(1317),Xg=b(80),vh=ch.a;Am(rc,vh);rc.prototype.Wrc=function(V,Ga){this.isEnabled()&&this.zFa(this.targetOrigin)&&(this.io(V),this.Rl(V,Ga))};Object(xd.a)(rc,"InsertMediaCrossDocumentMessenger",ch.a,[954,317,3]);Object(xd.a)(ob,"OnlineMediaSearchResult",null,[]);var ci=b(324),Ih=Xd.a;Am(cb,Ih);cb.prototype.yzj=function(V){var Ga=
this;this.Qgc=!1;this.showDialog(this.Hm,null);this.jwa=document.getElementById(this.ni("InsertMediaFrame"));if(!this.jwa)throw this.xua(this.dpb),Error.invalidOperation("Couldn't get InsertMediaIframe.");var Bb=document.getElementById(this.ni("WACDialogPanel"));Bb&&Bb.setAttribute(oe.a.Td,oe.a.pZa);Bb=document.createElement("div");Bb.id="KeepFocusStartDiv";Bb.tabIndex=0;Bb.className="keep-focus-start";this.jwa.parentNode.insertBefore(Bb,this.jwa.parentNode.firstChild);Bb=document.createElement("div");
Bb.id="KeepFocusDiv";Bb.tabIndex=0;Bb.className="keep-focus";this.jwa.parentNode.appendChild(Bb);$addHandler(this.sIa,"keydown",this.lsd);this.jwa.src=this.N$e;this.jwa.frameBorder="0";Bb=document.getElementById(this.ni("WACDialogButtonPanel"));if(!Bb)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");Bb.className="display-none";Bb=document.getElementById(this.ni("WACDialogTitleText"));if(!Bb)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");Bb.className="display-none";
2===this.opf&&(document.getElementById(this.ni("WACDialogTitlePanel")).className="display-none",document.getElementById(this.ni("WACDialogBodyPanel")).className="padding-zero");tg.FocusManager.instance().VQ().scope.xR=!0;this.cS=new rc(this.jwa.contentWindow,this.N$e);this.cS.Wrc(yf.a.fBg,function(gc){Ga.nFi(gc,Object(fb.a)(V,V.Ioa,"uploadResponseReceived"))});this.cS.Wrc(yf.a.insert,function(){Ga.DMi(Object(fb.a)(V,V.Ioa,"uploadResponseReceived"))});this.cS.Wrc(yf.a.XZc,this.tGi);2===this.opf&&0===
this.xeh&&(this.cS.Wrc(yf.a.Hqi,this.oNi),this.CNa=this.Xnb.Ima("MsoPremiumStockImages",function(gc){fc.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");if(gc.isEnabled){var dd={};Ga.cS.Hj(yf.a.oTj,(dd.LicenseTier=gc.toString(),dd))}else fc.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))};cb.prototype.dispose=function(){this.lAa=null;this.Xnb&&this.CNa&&this.Xnb.xId("MsoPremiumStockImages",this.CNa);
this.cS&&(this.cS.dispose(),this.cS=null);Ih.prototype.dispose.call(this)};cb.prototype.hide=function(){Ih.prototype.hide.call(this);Af.a.kwc(this.$)};cb.prototype.nFi=function(V,Ga){V=V&&V.Values?(V=V.Values)?Object(hh.a)(new ob,{Action:V.action||"",Caption:V.caption||"",ContentType:V.contentType||"",FileExtension:V.extension||"",PageUrl:V.pageUrl||"",SourceUrl:V.sourceUrl||"",ThumbnailUrl:V.thumbnailUrl||"",LicenseUrl:V.licenseUrl||"",LicenseDisplayName:V.licenseDisplayName||"",Height:V.height||
0,Width:V.width||0}):null:null;V&&(this.lAa.push(V),this.Qgc&&(fc.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),Ga(this.lAa),this.Qgc=!1,this.xua(this.dpb)))};cb.prototype.DMi=function(V){this.lAa&&0<this.lAa.length?this.lAa.length<=this.lpe?(V(this.lAa),this.xua(this.dpb)):(this.bA(),fc.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),Array.clear(this.lAa)):this.Qgc=!0};cb.prototype.R6g=function(){var V=
document.createElement("div");V.id="InsertMediaDialog";V.className=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";var Ga=document.createElement("div");Ga.id="InsertMediaPanel";Ga.className=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";var Bb=document.createElement("iframe");Bb.id=
"InsertMediaFrame";Bb.className="insert-media-frame";V.appendChild(Ga);Ga.appendChild(Bb);return ci.b(V)};cb.prototype.bA=function(){var V=Se.a.gd(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");V.Description=String.format(Rf.a.instance.Ab(197),this.lpe.toLocaleString());td.EwaSettings.Iz()?new Ne.a(this.$,V):(new We.ErrorDialog(this.$,V)).kf()};Ek.Object.defineProperties(cb.prototype,{y4:{configurable:!0,enumerable:!0,get:function(){return Pg.a.x6b+"/InsertMediaDialog"}},canBePreempted:{configurable:!0,
enumerable:!0,get:function(){return!1}}});Object(xd.a)(cb,"InsertMediaDialog",Xd.a,[]);var Ae=b(492),zi=b(395);Am(pb,Db);pb.prototype.Ioa=function(V){var Ga=this;if(V){for(var Bb=Array(V.length),gc=0;gc<V.length;gc++){var dd=V[gc];Bb[gc]={};Bb[gc].SourceUrl=dd.SourceUrl;Cb.a.Nwa(dd.LicenseUrl)&&Cb.a.Nwa(dd.PageUrl)&&(Bb[gc].LicenseUrl=dd.LicenseUrl,Bb[gc].LicenseDisplayName=dd.LicenseDisplayName,Bb[gc].PageUrl=dd.PageUrl);Bb[gc].AltText=-2053056795===this.Rd.command?dd.Caption:""}var sd=-2009825598===
this.Rd.command?"bing":"M365";gc=re.g(this.$);var ie=df.o(gc.ha.sa.activeCell,this.$);lg.a(this.$.userOperationManager,function(Ce,af,ff){return nc.M(Ga.$.na.ua,ie,Bb,sd,rf.b(Ce,Ga.cPi),rf.a(af,Ga.bPi),ff,null)},function(Ce){return new zf.a(595,0,Ce)},this.Rd);bb.HelperMethods.n_?(gc=new Map,gc.set("MediaProvider",sd),gc.set("ImagesCount",V.length.toString()),gc.set("TimeTakenToOpenDialog",this.Pmf.toString()),uc.Health.instance.recordKpiUsage(zi.a.Gbi,1,Ae.a.l8f,gc)):fc.ULS.sendTraceTag(537155805,
0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.Poc()}else fc.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};pb.prototype.dispose=function(){this.$=null};pb.prototype.showDialog=function(){var V=this,Ga=null;Ga=this.$.Ob.Gc("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Rd.command){case -2009825598:this.Kyj();break;case -2053056795:this.Tpe.execute(function(Bb){Bb.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(function(gc){return fc.ULS.sendTraceTag(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: {0}",gc)}).then(function(gc){V.Lyj(gc);return null})})}Ga.stop();this.Pmf=Ga.Bc};pb.prototype.Kyj=function(){var V=this.$.ya.BingPictureEndpoint,Ga=ua.a.wH(Od.AFrameworkApplication.lcid),Bb=rg.a.create();V?(V=0<V.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(V,1,1):String.format(V,1,Od.AFrameworkApplication.lcid,
Ga?Ga.name:"en-us",Od.AFrameworkApplication.buildVersion,Bb.toString(),1,this.$.ya.DocumentHostInfo.LoggableUserId),this.u4b(V,1,-1,Rf.a.instance.fa(1727))):(fc.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.Z0.setException(Error.create("Failed to access the Bing service endpoint")))};pb.prototype.Lyj=function(V){var Ga=this.$.ya.M365PictureEndpoint,Bb=rg.a.create();if(Ga){var gc=this.$.ya.DocumentHostInfo.UserId;
gc=gc?Cb.a.mw(gc).toString():"0";var dd=this.Tpe.instance.isFreemiumUpsellEnabled();V=V?1:dd?0:-1;Bb=Bb.toString();dd=ua.a.wH(Od.AFrameworkApplication.lcid).name;Ga=String.format(Ga,Od.AFrameworkApplication.lcid,dd,Od.AFrameworkApplication.buildVersion,Bb,1,gc,V,1);this.u4b(Ga,2,V,Rf.a.instance.fa(1726))}else fc.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.Z0.setException(Error.create("Failed to access the M365 service endpoint"))};
pb.prototype.u4b=function(V,Ga,Bb,gc){try{(new cb(this.$,V,fh.a.instance.Kh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ga,Bb,gc)).yzj(this),this.Z0.setResult(!0)}catch(dd){fc.ULS.sendTraceTag(537155802,0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : {0}] [MediaProvider : {1}] [DialogLicenseTier : {2}]",dd,Ga,Bb),this.Z0.setException(dd)}};Object(xd.a)(pb,"OnlinePictureUploaderWrapper",Db,[3]);Tb.prototype.executeCommand=function(V,Ga,Bb){V=Ga.command;
switch(V){case 1403967063:if(Bb&&"dataUrl"in Bb)return Ga=new Dh.a,this.uploaderCreator&&this.uploaderCreator.q$h(this.$,Gi.a.instance,Od.AFrameworkApplication.ga,Bb,Bb.dataUrl,Ga),Ga.task;this.uploaderCreator&&this.uploaderCreator.rai(this.$,Ga,Gi.a.instance,Od.AFrameworkApplication.ga,Bb);return cc.Task.Sa(!0);case -2053056795:case -2009825598:return V=new Dh.a,new pb(this.$,Ga,Gi.a.instance,Od.AFrameworkApplication.ga,Bb,V),V.task;default:return ag.a(V)}};Tb.prototype.Lc=function(V,Ga){if(V=this.$.isEditMode)switch(Ga.command){case 1403967063:V=
!0;break;case -2053056795:V=!0;break;case -2009825598:V=td.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures");break;default:V=!1}return V};Tb.prototype.jd=function(){return!1};Tb.prototype.Zc=function(){return!1};Object(xd.a)(Tb,"PictureCommandHandler",null,[429]);var ph=Sh.a;Am(tc,ph);tc.prototype.Nd=function(){var V=this;Sd.TaskExtensions.Ba(Ib.GetServiceTaskFactory.Va(this.$.da,484,485,1),function(Ga){V.Cd([new Tb(V.$,Ga.result)])},this.$.la,3)};tc.ka=function(V){Sh.a.fe(90,
new tc(V))};Object(xd.a)(tc,"PictureCommandHandlerFactory",Sh.a,[]);var yg=b(557),na=b(438),sb=b(76),Wb=b(594),Dc=b(639),nb=Wb.a;Am(wc,nb);wc.prototype.MPd=function(V){this.Gfa!==V&&(this.Gfa=V,this.VGb())};wc.prototype.dispose=function(){this.gridView.rc.fl(this.quf);this.gridView.rc.Dn(this.puf);this.gridView=null;nb.prototype.dispose.call(this)};wc.prototype.VGb=function(){this.sGd(this.Gfa)};wc.prototype.refresh=function(){this.MPd(!this.gridView.isEditing)};Ek.Object.defineProperties(wc.prototype,
{kI:{configurable:!0,enumerable:!0,get:function(){return this.olc(this.Gfa)}},name:{configurable:!0,enumerable:!0,get:function(){return Dc.a.cellEdit}}});Object(xd.a)(wc,"CellEditSafeStatePublisher",Wb.a,[]);Object(xd.a)(Sb,"SafeStatePublisherState",null,[]);var Yc=b(708),ee=ue.a;Am(La,ee);La.prototype.MZb=function(V){this.addHandler(La.VQa,V)};La.prototype.ctc=function(V){this.removeHandler(La.VQa,V)};La.prototype.Gza=function(V,Ga){function Bb(sd,ie){dd.kI=ie.kI;gc.XGb()}var gc=this,dd=new Sb(V,
Ga);this.WQa.add(dd);V.MZb(Bb);dd.handler=Bb;this.XGb()};La.prototype.SXd=function(V){for(var Ga=null,Bb=El(this.WQa),gc=Bb.next();!gc.done;gc=Bb.next())if(gc=gc.value,gc.publisher===V){this.zbg(gc);Ga=gc;break}Ga&&(this.WQa.remove(Ga),this.XGb())};La.prototype.dispose=function(){for(var V=El(this.WQa),Ga=V.next();!Ga.done;Ga=V.next())this.zbg(Ga.value);this.WQa.clear();this.Qyb&&(this.Jje.mbj(this.fzf.bind(this)),this.oma.pbb(this.yya.bind(this)));ee.prototype.dispose.call(this)};La.prototype.fac=
function(){var V=pa.fac(this.WQa.toArray().map(function(Ga){return Ga.kI}));return this.pjc&&1===V?2:V};La.prototype.zbg=function(V){V.publisher.ctc(V.handler)};La.prototype.XGb=function(){var V=this.fac();V!==this.ljf&&(this.raiseEvent(La.VQa,new Yc.a(V)),this.ljf=V)};La.prototype.fzf=function(){this.pjc&&fc.ULS.sendTraceTag(523317957,0,15,"ClientStateMonitor.onMergeWasAborted: Aborted merge occurred after another aborted merge.");this.pjc=!0;this.XGb()};La.prototype.yya=function(V,Ga){V=Ga.ica;
(Ga=!ha(V))||(Ga=this.Wpi,Ga=(null===V||void 0===V?void 0:V.SuspensionStartTimestamp)!==(null===Ga||void 0===Ga?void 0:Ga.SuspensionStartTimestamp));Ga&&(this.pjc=!1);this.Wpi=V;this.XGb()};Ek.Object.defineProperties(La.prototype,{ROj:{configurable:!0,enumerable:!0,get:function(){return Jh.f(Jh.c(this.WQa.toArray(),function(V){return 0!=V.kI}),function(V){return V.publisher.name})}}});La.VQa="SSC";Object(xd.a)(La,"ClientStateMonitor",ue.a,[]);var ye=b(6),lf=b(66),Ef=Wb.a;Am(mb,Ef);mb.prototype.MPd=
function(V){V!==this.Gfa&&(this.Gfa=V,this.VGb())};mb.prototype.dispose=function(){lf.a(this.$).Isc(this.uvf);this.u5a.Wq(this.PN);this.W7d=null;Ef.prototype.dispose.call(this)};mb.prototype.VGb=function(){this.sGd(this.Gfa)};mb.prototype.refresh=function(){this.MPd(1===this.u5a.au||lf.a(this.$).wi===this.u5a)};Ek.Object.defineProperties(mb.prototype,{kI:{configurable:!0,enumerable:!0,get:function(){return this.olc(this.Gfa)}},name:{configurable:!0,enumerable:!0,get:function(){return Dc.a.u5a}},u5a:{configurable:!0,
enumerable:!0,get:function(){return this.W7d}}});Object(xd.a)(mb,"IdleActivitySafeStatePublisher",Wb.a,[]);var O=b(327),da=b(3),Pa=sb.a;Am(Ra,Pa);Ra.prototype.Zc=function(){return!1};Ra.prototype.executeCommand=function(){return cc.Task.Sa(!0)};Ra.prototype.Lc=function(V,Ga){return 1905775613===Ga.command};Ra.prototype.jd=function(){return!1};Object(xd.a)(Ra,"ToggleMergeSuspensionSafeState",sb.a,[429]);var rb=ue.a;Am(Ha,rb);Ha.prototype.Aq=function(V){this.addHandler(Ha.Bwd,V)};Ha.prototype.Wq=function(V){this.removeHandler(Ha.Bwd,
V)};Ha.prototype.Oz=function(){this.raiseEvent(Ha.Bwd)};Ha.prototype.vn=function(V){return V===Ha.S1i&&!!this.mergeSuspensionManager};Ha.prototype.es=function(V,Ga){if(!this.vn(V))return!1;this.mergeSuspensionManager&&(Ga.LabelText=this.Ylc,Ga.On=this.Xxd);return!0};Ha.prototype.dispose=function(){this.uNb&&(this.Ka.ebb(this.uNb),this.uNb.dispose(),this.uNb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.oma.pbb(this.yya),this.mergeSuspensionManager.Kha.ctc(this.UOa),this.mergeSuspensionManager=
null);this.statusBarManager&&(this.statusBarManager.SF(this),this.statusBarManager=null);this.Ylc=null;rb.prototype.dispose.call(this)};Ha.Bwd="MSMSC";Ha.S1i="QueryMergeSuspensionStatus";Object(xd.a)(Ha,"MergeSuspensionIndicatorManager",ue.a,[483,271,3]);var d=b(1086),A=Sys.EventArgs;Am(Xa,A);Object(xd.a)(Xa,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);Object(xd.a)(qa,"SuspensionState",null,[]);Am(Aa,qa);Object(xd.a)(Aa,"ReadyForPendingMergeState",qa,[]);var S=new qa,ja=new qa,Ua=
new Aa(!1),kc=new Aa(!0),tb=b(1087),$c=tb.a;Am(Nb,$c);Object(xd.a)(Nb,"ReadyForPendingMergesUpdatedEventArgs",tb.a,[]);var zd=ue.a;Am(lb,zd);lb.prototype.g9h=function(){return Object(na.a)(La,this.Kha)?Object(Rb.a)(La,this.Kha).fac():1};lb.prototype.RZb=function(V){this.addHandler(lb.cWd,V)};lb.prototype.etc=function(V){this.removeHandler(lb.cWd,V)};lb.prototype.jGg=function(V){this.addHandler(lb.$Gd,V)};lb.prototype.Sbj=function(V){this.removeHandler(lb.$Gd,V)};lb.prototype.rFg=function(V){this.addHandler(lb.wwd,
V)};lb.prototype.lbj=function(V){this.removeHandler(lb.wwd,V)};lb.prototype.B3i=function(){this.qGd(this.getState()===ja)};lb.prototype.dispose=function(){this.Kha.ctc(this.UOa);this.Kha=null;this.oma.pbb(this.yya);this.oma=null;zd.prototype.dispose.call(this)};lb.prototype.sfd=function(){return Object(hh.a)(new d.a,{Current:this.tla.Current,Pending:this.tla.Pending,SuspensionStartTimestamp:this.tla.SuspensionStartTimestamp})};lb.prototype.getState=function(){return ha(this.tla)?0==this.kI?kc:this.Qyb&&
1==this.kI?Ua:ja:S};lb.prototype.wTe=function(V,Ga){V!==Ga&&(Ga===ja?this.qGd(!0):V===ja&&this.qGd(!1));Ga instanceof Aa&&this.raiseEvent(lb.$Gd,new Nb(this.tla,Ga.jpe||!this.Qyb))};lb.prototype.Vui=function(V,Ga,Bb){V===S&&Ga!==S?(V=Ga===ja,Ga=Ga===Ua,fc.ULS.sendTraceTag(252760283,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: {0} publisher: {1} counter: {2} isBlockingAllMerges: {3}",Ga,Ga||V?this.Kha.ROj.join(","):"",gb(this.tla),V)):V!==S&&Ga===
S&&fc.ULS.sendTraceTag(252760284,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: {0}",gb(Bb))};lb.prototype.qGd=function(V){this.raiseEvent(lb.cWd,new Xa(V))};lb.cWd="TPMBBC";lb.$Gd="RFPMU";lb.wwd="MCC";Object(xd.a)(lb,"MergeSuspensionStateHandler",ue.a,[]);var qe=ue.a;Am(kb,qe);kb.prototype.LYa=function(V){this.addHandler("MCU",V)};kb.prototype.pbb=function(V){this.removeHandler("MCU",V)};kb.prototype.xya=function(V,Ga){Ga=void 0===Ga?"":Ga;var Bb=this.c2.Current<
V.Current||this.c2.Pending<V.Pending;if(V.SuspensionStartTimestamp&&this.ojc!==V.SuspensionStartTimestamp){if(this.ojc>V.SuspensionStartTimestamp){Bb&&fc.ULS.sendTraceTag(553736149,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via {0}. S: {1}, C: {2}",Ga,kb.FCb(V),kb.FCb(this.c2));return}Bb||fc.ULS.sendTraceTag(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: {0}, C: {1}",kb.FCb(V),
kb.FCb(this.c2))}else if(!Bb)return;this.c2=V;this.pKf(V,Ga)};kb.prototype.dispose=function(){this.$.ea.Dk(this.Mvc);this.$.ea.iS(this.Mvc);re.g(this.$).rc.Dn(this.D9a);td.EwaSettings.isChangeGateEnabled("OfficeVSO:6329027_UpdateMergeCountWhenWebMethodReturnsWithErrors")||this.$.na.Dr(this.n8);var V=this.$.da.Aa(292);V&&V.pbb(this.GCb);qe.prototype.dispose.call(this)};kb.prototype.pKf=function(V,Ga){Ga=void 0===Ga?"":Ga;ha(V)&&V.SuspensionStartTimestamp>this.ojc&&(fc.ULS.sendTraceTag(537155416,0,
50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: {0}, Origin: {1}",gb(V),Ga),this.ojc=V.SuspensionStartTimestamp);this.raiseEvent("MCU",new tb.a(V))};kb.prototype.CSf=function(){fc.ULS.sendTraceTag(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was {0}",kb.FCb(this.c2));this.c2=Object(hh.a)(new d.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})};kb.FCb=function(V){return V?String.format("({0}/{1} @{2})",V.Current,V.Pending,V.SuspensionStartTimestamp):
"null"};Ek.Object.defineProperties(kb.prototype,{tla:{configurable:!0,enumerable:!0,get:function(){return this.c2}}});kb.A_d="PMM.RTC";kb.Jsb="PMM.EwaResult";kb.wfj="PMM.resetMergeCounter";Object(xd.a)(kb,"PendingMergeMonitor",ue.a,[]);Object(xd.a)(Gb,"ClientRevisions",null,[]);var Te=ue.a;Am(Ca,Te);Ca.prototype.dispose=function(){this.$.na.qda(this.o8);this.Xyc();this.c6.Sbj(this.QAf);this.c6.etc(this.iFb);this.c6.lbj(this.ezf);this.c6=null;Te.prototype.dispose.call(this)};Ca.prototype.VDj=function(){this.Xyc();
if(this.JHe()){var V=this.c6.sfd();fc.ULS.sendTraceTag(537155414,0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter {0} fail count: {1}",gb(V),this.KAb)}else this.LAb=this.yZa.create(this.VWf,this.Ntc,Gh.a.LAb),this.H7a=this.yZa.BC(this.VWf,this.tpi,Gh.a.H7a)};Ca.prototype.Xyc=function(){this.H7a&&(this.LAb.cancel(),this.H7a.cancel(),this.H7a=this.LAb=null)};Ca.prototype.$Mi=function(V){var Ga=
" fail count: "+this.KAb;this.KAb++;this.JHe()&&this.Xyc();fc.ULS.sendTraceTag(542229773,0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed {0}{1}",gb(V),Ga)};Ca.prototype.JHe=function(){return this.KAb>Ca.Byi};Ca.Byi=5;Object(xd.a)(Ca,"RequestController",ue.a,[]);var qf=b(211),la=b(28),ab=ue.a;Am(fa,ab);fa.prototype.sFg=function(V){this.addHandler(fa.Cwd,V)};fa.prototype.mbj=function(V){this.removeHandler(fa.Cwd,V)};fa.prototype.gMg=function(V,Ga){var Bb=this;this.zLb(V,
Ga)?(new Dh.a).setResult(!0):(Ga=this.eXi(V,Ga),this.iBb=V,this.nCd++,Ga.CWCT(function(){Bb.IIi()},qf.a.none,0,this.UO))};fa.prototype.eXi=function(V,Ga){this.zZd=this.qh.Dea;this.Dif=Ga;fc.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge {0} / {1} @{2}. allowSelectionAdjustment: {3}",V.Current,V.Pending,V.SuspensionStartTimestamp,Ga);this.isDocumentHidden||this.Ky();return this.Ylj(Ga,V)};fa.prototype.zLb=function(V,Ga){if(this.mAa&&!Ga&&
!this.mAa.Cmi())return fc.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0;if(!this.iBb||V.SuspensionStartTimestamp>this.iBb.SuspensionStartTimestamp)return this.NLa&&fc.ULS.sendTraceTag(523551556,0,50,"DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: {0} / {1} @{2}",V.Current,V.Pending,V.SuspensionStartTimestamp),!1;if(this.NLa)return!0;if(this.Xdg){V=
Ia(V,this.iBb);var Bb=this.qh.Dea-this.zZd<this.Ntc;Ga=this.Dif===Ga;return V&&Bb&&Ga}return Ia(V,this.iBb)&&this.qh.Dea-this.zZd<this.Ntc};fa.prototype.Ylj=function(V,Ga){function Bb(){fc.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeSender.sendDoPendingMergeRequest: request failed {0} / {1} @{2}",Ga.Current,Ga.Pending,Ga.SuspensionStartTimestamp)}var gc=this.ua.hc();return this.mAa?this.mAa.yij(this.fNh(V,Bb,gc)):this.Hve(null,!0,void 0,Bb,gc)};fa.prototype.fNh=function(V,Ga,Bb){var gc=this;return function(dd,
sd,ie){var Ce=void 0;gc.Xdg&&(fc.ULS.shipAssertTag(523317955,0,null!=dd||V,"!allowSelectionAdjustment requires a non-null initialViewportState."),Ce=gc.JIi.bind(gc));sd&&(Ce=rf.b.call(null,function(af){var ff=af.Result,fg=null===ff||void 0===ff?void 0:ff.AdjustedViewportState;3===(null===ff||void 0===ff?void 0:ff.MergeResultState)&&(fg=void 0);sd(fg,af.StateId)},Ce));ie&&(Ga=rf.a.call(null,ie,Ga));return gc.Hve(dd,V,Ce,Ga,Bb)}};fa.prototype.Hve=function(V,Ga,Bb,gc,dd){if(this.xTg){var sd=this.ua;
dd=sd.Na(1,void 0===dd?null:dd);dd.viewportState=V;dd.allowViewAdjustment=Ga;V=nc.i(sd,"DoPendingMerge",dd,Bb,gc,null,null,0)}else sd=this.ua,dd=sd.Na(1,void 0===dd?null:dd),dd.viewportState=V,dd.allowViewAdjustment=Ga,V=nc.i(sd,"DoPendingMergeNew",dd,Bb,gc,null,null,0);return V};fa.prototype.JIi=function(V){V=V.Result;void 0!=V&&3===V.MergeResultState&&(fc.ULS.sendTraceTag(523317954,0,50,"DoPendingMergeSender.onDoPendingMergeSucceeded: Aborted merge."),this.e3i())};fa.prototype.e3i=function(){this.raiseEvent(fa.Cwd,
new Sys.EventArgs)};fa.prototype.IIi=function(){this.nCd--};Ek.Object.defineProperties(fa.prototype,{NLa:{configurable:!0,enumerable:!0,get:function(){return 0<this.nCd}},isDocumentHidden:{configurable:!0,enumerable:!0,get:function(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.Ai}}});fa.Cwd="MWA";Object(xd.a)(fa,"DoPendingMergeSender",ue.a,[842,843]);Ek.Object.defineProperties(ta.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return this.c8h?"SelectionAdjustInHiddenDocument":
"SelectionAdjust"}}});Object(xd.a)(ta,"SelectionAdjustSessionEndsReport",null,[472]);va.prototype.qfg=function(V){for(var Ga=El(this.p2d),Bb=Ga.next();!Bb.done;Bb=Ga.next()){Bb=Bb.value;if(!Bb)return!1;Bb=El(Bb);for(var gc=Bb.next();!gc.done;gc=Bb.next())if(gc=gc.value,gc.mk&&gc.qe.Revision<V)return!1}return!0};va.prototype.zJj=function(){var V;if(this.DUa||this.NNc){var Ga={SheetName:this.sheetName,ActiveCell:null===(V=this.activeCell)||void 0===V?void 0:V.toString(),SelectedRange:this.selectedRanges[0].toString(),
TopLeft:void 0,SelectedRanges:void 0};this.NNc&&(Ga.SelectedRange=void 0,Ga.SelectedRanges=df.r(this.selectedRanges,this.wb));return Ga}};va.prototype.toString=function(){var V,Ga;return String.format("active cell: {0} selection: {1}",null!==(Ga=null===(V=this.activeCell)||void 0===V?void 0:V.toString())&&void 0!==Ga?Ga:"null",Jh.f(this.selectedRanges,function(Bb){var gc;return null!==(gc=null===Bb||void 0===Bb?void 0:Bb.toString())&&void 0!==gc?gc:"null"}).join(","))};va.prototype.equals=function(V){return V?
this.activeCell.equals(V.activeCell)&&df.Q(this.selectedRanges,V.selectedRanges)&&this.sheetName===V.sheetName:!1};va.prototype.tQh=function(){for(var V=El(this.selectedRanges.entries()),Ga=V.next();!Ga.done;Ga=V.next()){var Bb=El(Ga.value);Ga=Bb.next().value;Bb=Bb.next().value;if(null===Bb||void 0===Bb?0:Bb.contains(this.activeCell))return Ga}return-1};va.prototype.L$f=function(V,Ga){var Bb,gc=re.g(this.wb).Ea.Zua(V,Ga);gc||fc.ULS.sendTraceTag(522803340,0,15,"SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: {0} ; activeItemNameIsDefined: {1}",
null!==(Bb=null===V||void 0===V?void 0:V.toString())&&void 0!==Bb?Bb:"null",!!Ga);return gc};Ek.Object.defineProperties(va.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return this.xG}},selectedRanges:{configurable:!0,enumerable:!0,get:function(){return this.x9}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.FWb}},activeItemName:{configurable:!0,enumerable:!0,get:function(){return this.Njg}},DUa:{configurable:!0,enumerable:!0,get:function(){return 1===this.selectedRanges.length}}});
Object(xd.a)(va,"SelectionState",null,[]);var ec=b(219),Vc;(function(V){V[V.none=0]="none";V[V.waitingForAdjusted=1]="waitingForAdjusted";V[V.invalid=2]="invalid";V[V.nonContinuous=3]="nonContinuous";V[V.noAdjustRequired=4]="noAdjustRequired";V[V.noAdjustRequiredWithDivergence=5]="noAdjustRequiredWithDivergence";V[V.divergenceOnResponse=6]="divergenceOnResponse";V[V.waitingForViewport=7]="waitingForViewport";V[V.adjusted=8]="adjusted";V[V.divergenceOnViewportReady=9]="divergenceOnViewportReady";V[V.differentSheetAdjust=
10]="differentSheetAdjust";V[V.editBoxDivergence=11]="editBoxDivergence";V[V.exception=12]="exception"})(Vc||(Vc={}));Object(xd.b)("SelectionAdjustState",Vc);var Kc=b(948);xa.prototype.yij=function(V){function Ga(){Bb.pFi()}var Bb=this,gc=null,dd=null;this.Vaf()?(this.pM.parallel++,fc.ULS.sendTraceTag(526390086,0,15,"SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : {0}",!!this.lC)):(gc=function(sd,ie){Bb.qFi(sd,ie)},dd=this.krj());
return null===V||void 0===V?void 0:V(dd,gc,Ga)};xa.prototype.Cmi=function(){return!this.Vaf()&&this.Naa().DUa};xa.prototype.krj=function(){var V;fc.ULS.shipAssertTag(525135961,0,0===this.$C,"SelectionAdjustManager.setPreRequestState: unexpected state");this.lC&&(this.pM.errors++,fc.ULS.sendTraceTag(526960090,0,10,"SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: {0}",this.lC.toString()));this.lC=null;this.Dz=this.Naa();var Ga=null,Bb=null===(V=this.Dz)||void 0===
V?void 0:V.zJj();Bb&&(Ga={ActiveSheetName:this.Dz.sheetName,SheetViewportStateChanges:[Bb]});this.$C=1;return Ga};xa.prototype.pFi=function(){fc.ULS.shipAssertTag(525135960,0,1===this.$C,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.pM.errors++;this.$C=2;this.Vr()};xa.prototype.qFi=function(V,Ga){try{fc.ULS.shipAssertTag(525135959,0,1===this.$C,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.Syc=Ga,Ga=2,this.Dz?V?(this.lC=this.Ouj(V))?(Ga=7,this.WCb||
this.Dz.DUa)?this.Dz.equals(this.lC)?this.kRf&&!this.Dz.equals(this.Naa())?(this.pM.adjustedDidntChangeWithDivergence++,Ga=5):(this.pM.adjustedDidntChange++,Ga=4):this.Dz.sheetName!=this.lC.sheetName?(this.pM.differentSheetAdjust++,Ga=10):this.kRf&&!this.Dz.equals(this.Naa())&&(this.pM.divergenceOnResponse++,Ga=6,this.jRf()):(this.pM.nonContinuous++,Ga=3):this.pM.errors++:(this.pM.errors++,fc.ULS.sendTraceTag(537155412,0,15,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: {0}",
this.Dz.toString())):(this.pM.errors++,fc.ULS.sendTraceTag(537155413,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: {0}, SelectedRange: {1}",null===V||void 0===V?void 0:V.ActiveCell,null===V||void 0===V?void 0:V.SelectedRange)),this.$C=Ga}catch(Bb){this.$C=12,fc.ULS.sendTraceTag(525135958,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception {0}",Bb)}finally{7!=this.$C?this.Vr():this.DXc(!1,
!0)}};xa.prototype.dispose=function(){this.gridView.Ea.Dv(this.Pi);this.gridView.Ea.Vq(this.w9a);this.gridView.Ea.oPf(this.w9a);this.gridView.Ea.ibb(this.w9a)};xa.prototype.Vaf=function(){return 1===this.$C||7===this.$C};xa.prototype.Ouj=function(V){var Ga=this,Bb,gc;if(!function(){var sd=df.Z(V.ActiveCell,Ga.$.xa);Bb=sd.range;return sd}().returnValue)return fc.ULS.sendTraceTag(537155411,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell {0}",V.ActiveCell),
null;var dd=[];if(this.WCb)if(V.SelectedRanges)dd=df.g(V.SelectedRanges.Ranges);else return fc.ULS.sendTraceTag(522826913,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null"),null;else{if(!function(){var sd=df.Z(V.SelectedRange,Ga.$.xa);gc=sd.range;return sd}().returnValue)return fc.ULS.sendTraceTag(537155410,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract selected range {0}",V.SelectedRange),null;dd.push(gc)}return new this.FWf(this.$,
Bb,dd,V.SheetName,this.Dz.activeItemName)};xa.prototype.Naa=function(){var V=this.$.qa;if((null===V||void 0===V?0:V.activeCell)&&V.selectedRanges&&V.sheetName)return new this.FWf(this.$,V.activeCell,V.selectedRanges,V.sheetName,this.$.activeItemName);fc.ULS.sendTraceTag(525135957,0,10,"SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: {0}, activeCell null: {1}, selectedRanges null: {2}, sheetName null: {3}",!V,!(null===V||void 0===V?0:V.activeCell),!(null===V||void 0===
V?0:V.selectedRanges),!(null===V||void 0===V?0:V.sheetName));return null};xa.prototype.DXc=function(V,Ga){var Bb;if(this.Vki(V))if(td.EwaSettings.isChangeGateEnabled("OfficeVSO:6280340_preventRecursionOfAttemptAdjustSelection")&&8===this.$C)fc.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{Ga&&fc.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{if(fc.ULS.shipAssertTag(525135956,
0,7===this.$C,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.Dz.equals(this.Naa()))if(this.Rdj&&(null===(Bb=this.gridView)||void 0===Bb?0:Bb.isEditing))this.pM.editBoxDivergence++,this.$C=11;else{V=0;if(this.WCb&&(V=this.lC.tQh(),-1==V)){this.pM.errors++;fc.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange");return}this.pM.adjusted++;this.$C=8;this.gridView.IV(this.lC.selectedRanges,V,this.lC.sheetName,null,this.lC.activeCell,
null,null,0,Ec.a.rlj)}else this.pM.divergenceOnViewportReady++,this.jRf(),this.$C=9}catch(gc){this.$C=12,fc.ULS.sendTraceTag(525135955,0,10,"SelectionAdjustManager.attemptAdjustSelection: caught Exception {0}",gc)}finally{this.Vr()}}};xa.prototype.Vki=function(V){if(!this.lC)return!1;if(!this.Dz)return fc.ULS.sendTraceTag(537155409,0,10,"SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: {0}",this.lC.toString()),!1;if(V||
this.HHj){if(re.g(this.$).Ea.Zof<this.Syc)return!1;(this.WCb||this.Dz.DUa)&&fc.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust")}else if(!this.Dz.DUa&&!this.WCb||!this.Dz.qfg(this.Syc)||!this.lC.qfg(this.Syc))return!1;return!0};xa.prototype.Vr=function(){var V,Ga,Bb,gc;this.yej&&2!=this.$C&&fc.ULS.sendTraceTag(526792898,0,50,"SelectionAdjustManager.clearState: initial: {0}, adjusted: {1}, state: {2}, hidden: {3}",
null!==(Ga=null===(V=this.Dz)||void 0===V?void 0:V.toString())&&void 0!==Ga?Ga:"null",null!==(gc=null===(Bb=this.lC)||void 0===Bb?void 0:Bb.toString())&&void 0!==gc?gc:"null",Vc[this.$C],Kc.a.sB(this.Spf));this.Dz=this.lC=null;this.$C=0};xa.prototype.jRf=function(){var V=this.Naa();fc.ULS.sendTraceTag(537155408,0,50,"SelectionAdjustManager.ReportDivergence: initial: {0} current: {1} adjusted: {2} sheetSameBetweenInitialAndAdjusted: {3} sheetSameBetweenInitialAndCurrent: {4}",this.Dz.toString(),V?
V.toString():"",this.lC.toString(),this.Dz.sheetName===this.lC.sheetName,this.Dz.sheetName===(V?V.sheetName:null))};Ek.Object.defineProperties(xa.prototype,{FWf:{configurable:!0,enumerable:!0,get:function(){return va}},pM:{configurable:!0,enumerable:!0,get:function(){return Kc.a.sB(this.Spf)?this.D1d:this.C1d}}});Object(xd.a)(xa,"SelectionAdjustManager",null,[839,3]);var Fd=sb.a;Am(pa,Fd);pa.prototype.RZb=function(V){this.Nfa.RZb(V)};pa.prototype.etc=function(V){this.Nfa&&this.Nfa.etc(V)};pa.prototype.Gza=
function(V,Ga){this.NCa.Gza(V,Ga)};pa.prototype.SXd=function(V){this.NCa.SXd(V)};pa.prototype.xya=function(V,Ga){this.$Wa.xya(V,void 0===Ga?"":Ga)};pa.prototype.dispose=function(){this.Oec&&(this.Oec.dispose(),this.Oec=null);this.mAa&&this.mAa.dispose();this.z1a.dispose();this.FKd&&(this.FKd.dispose(),this.FKd=null);this.Nfa&&(this.Nfa.dispose(),this.Nfa=null);this.$Wa.dispose();this.$Wa=null;this.NCa.dispose();this.NCa=null;this.D_a&&(this.D_a.dispose(),this.D_a=null);this.v5a&&(this.v5a.dispose(),
this.v5a=null);this.$=null;Fd.prototype.dispose.call(this)};pa.prototype.VGb=function(){this.Nfa.B3i()};pa.fac=function(V){var Ga=0;V=El(V);for(var Bb=V.next();!Bb.done;Bb=V.next()){Bb=Bb.value;if(2==Bb)return 2;1==Bb&&(Ga=1)}return Ga};pa.prototype.B9h=function(V,Ga){this.NCa=new La(this.z1a,this.$Wa);Ga?Object(na.a)(mb,Ga)?this.Gza(Ga,Object(Rb.a)(mb,Ga).kI):Object(na.a)(wc,Ga)?this.Gza(Ga,Object(Rb.a)(wc,Ga).kI):this.Gza(Ga,0):(this.D_a=new wc(V),this.v5a=new mb(V),this.Gza(this.D_a,this.D_a.kI),
this.Gza(this.v5a,this.v5a.kI))};Ek.Object.defineProperties(pa.prototype,{Kha:{configurable:!0,enumerable:!0,get:function(){return this.NCa}},oma:{configurable:!0,enumerable:!0,get:function(){return this.$Wa}},c6:{configurable:!0,enumerable:!0,get:function(){return this.Nfa}}});Object(xd.a)(pa,"MergeSuspensionManager",sb.a,[822,3]);var te=Dg.a;Am(ma,te);ma.prototype.create=function(){fc.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.Eb(this.Tc.da.Aa(343)||this.Tc.da.Ga(343,
new pa(this.Tc,Ch.a.instance)))};ma.ka=function(V){fc.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");V.da.Ga(344,new ma(V))};Object(xd.a)(ma,"MergeSuspensionFactory",Dg.a,[]);ka.Tri=3;ka.connected=0;Object(xd.a)(ka,"ConnectionStateConstants",null,[]);var hf=b(111),Yf=b(117),mg=b(43);W.prototype.FYf=function(){this.durationMs=Yf.a(la.a.Ta,this.startTime)};W.prototype.oBd=function(V){var Ga=this,Bb;this.FYf();mg.a(V).atc(this.Ytf);mg.a(V).vg.btc(this.Bca);V.da.$a(291,function(gc){gc.kbb(Ga.vW)});
if(null===(Bb=V.ea)||void 0===Bb?0:Bb.sf)V.ea.sf.OJd(this.jCd),this.wasUserActiveOnPIEnd=V.ea.sf.vr};W.prototype.Ck=function(V){var Ga=this;mg.a(V).IZb(this.Ytf);this.isToastShown?this.toastRaiser="Immediate":mg.a(V).vg.BVc(this.Bca);V.da.$a(291,function(Bb){Ga.hasTabbedOut=Bb.Ai;Bb.IFa(Ga.vW)});this.wasUserActiveOnPIStart&&V.ea.sf.koe(this.jCd)};Object(xd.a)(W,"PartialInteractivityData",null,[]);var cg=b(1281);Am(Z,W);Z.prototype.EHi=function(V,Ga){this.swappedByOffline=Ga;this.oBd(V)};Z.prototype.ipj=
function(V){this.errorDataDuringConnectivityIssuesMode=V};Z.prototype.U5i=function(V){10>this.failedRequests.length&&(V=V+"_"+hf.getElapsedSeconds(this.startTime,la.a.Ta.Wb).toString(),this.failedRequests.push(V))};Object(xd.a)(Z,"ConnectivityIssuesData",W,[]);var Sg=b(177);R.bih="DuringWork";R.connectivityIssues="ConnectivityIssues";R.offline="Offline";Object(xd.a)(R,"UnavailabilityTypes",null,[]);J.prototype.dispose=function(){this.$&&(mg.a(this.$).vg.xPf(this.kvf),this.$.qf&&this.$.qf.wPf(this.hvf));
this.data&&this.$.na.qf.rQf(this.Un);this.$=null};J.prototype.USg=function(V){var Ga=this.P$c-1;return(this.data.averageDurationBetweenFailedRequestsSec*(Ga-1)+V)/Ga};Object(xd.a)(J,"ConnectivityIssuesTelemetryManager",null,[3]);var $g=b(1061),ti=b(1324),Hh=b(1280);D.prototype.dispose=function(){this.$&&(this.dRd&&this.$.na&&0<this.b9a.count&&this.$.na.Dr(this.Th),this.eRd&&(this.XTd("Dispose"),this.$.ea.sf.Pza(this.Aca)))};D.prototype.f9h=function(){td.EwaSettings.ma(213)&&this.OZi();this.eRd&&this.PZi()};
D.prototype.C9h=function(){this.CDb=this.DDb;this.ysd=0;var V={};if(!this.b9a){this.b9a=new Of.a;var Ga=ti.a.ycd(this.xej,"InitSampleMeasurement",this.$);Ga=El(Ga);for(var Bb=Ga.next();!Bb.done;Bb=Ga.next())Bb=Bb.value,V[Bb.tkd]=Bb.baseUrl,this.b9a.add(Bb)}V=Sys.Serialization.JavaScriptSerializer.serialize(V);fc.ULS.sendTraceTag(537155210,0,50,"Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: {0}, numberOfRequestFromTheLastNetworkMeasurement: {1}, testParams: {2} ",this.DDb,this.CDb,
V);0<this.b9a.count&&this.$.na.Bq(this.Th)};D.prototype.nEj=function(){for(var V=El(this.b9a),Ga=V.next();!Ga.done;Ga=V.next())Ga.value.runTest()};D.prototype.ETd=function(V){this.uSa&&this.uSa.vp||(fc.ULS.sendTraceTag(537155208,0,50,"NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: {0}",V),this.uSa=Ch.a.instance.BC(this.Tlj,5E3,Gh.a.gCj),this.uSa.qka())};D.prototype.XTd=function(V){this.uSa&&this.uSa.vp&&(fc.ULS.sendTraceTag(537155207,0,50,"NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: {0}",
V),this.uSa.cancel())};D.prototype.qwj=function(V){return this.CDb>=this.DDb&&V-this.ysd>this.Kwd};D.prototype.CWg=function(){return D.KTf(this.$.ya.SlowNetworkMeasurementsSamplePercentage)};D.prototype.OZi=function(){this.DDb=this.$.ya.NumberOfRequestToWaitPerNetworkMeasurement;this.Kwd=1E3*this.$.ya.MinTimeBetweenNetworkMeasurementInSec;var V=this.$.ya.NetworkMeasurementsSamplePercentage;0<this.DDb&&0<this.Kwd&&(this.dRd=D.KTf(V))&&this.C9h()};D.prototype.PZi=function(){if(!this.vyc){this.vyc=new Of.a;
var V=ti.a.ycd(this.Mdj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[Hh.a.cEc]);V=El(V);for(var Ga=V.next();!Ga.done;Ga=V.next())this.vyc.add(Ga.value);this.$.ea.sf.vr&&this.ETd("PrepareAndInitSlowNetworkTests")}};D.KTf=function(V){return 100*Math.random()<V};Object(xd.a)(D,"NetworkMeasurement",null,[3]);var Lg=b(995);F.prototype.hQj=function(){this.SU&&this.SU.FYf()};F.prototype.KBg=function(V){this.allOfflinePartialInteractivitiesDataInSession.push(V);this._count++};Ek.Object.defineProperties(F.prototype,
{count:{configurable:!0,enumerable:!0,get:function(){return this._count}},SU:{configurable:!0,enumerable:!0,get:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}}});Object(xd.a)(F,"OfflinePartialInteractivitiesDataForLog",null,[]);Am(aa,W);aa.prototype.Isj=function(V){this.timeFromLastOffline=V};aa.prototype.jpj=function(V){this._errorDataDuringOfflineMode=V};Object(xd.a)(aa,"OfflinePartialInteractivityData",W,[]);U.prototype.dispose=
function(){this.$&&mg.a(this.$)&&mg.a(this.$).vg.tJd(this.W9a);$h.a.Ha(this.eub);this.$=this.eub=null};U.prototype.JOi=function(V){this.SU=new aa(la.a.Ta.Wb,this.$,0!==V);this.SU.Isj(-1!==this.eFd?window.performance.now()-this.eFd:-1);this.AOa.KBg(this.SU);mg.a(this.$).vg.BVc(this.Bca);this.Q2a();this.eub=Ch.a.instance.BC(this.Q2a,U.BCh,Gh.a.Q2a);Sg.a(this.$).iVc(this.TUf)};U.prototype.KOi=function(){this.SU.oBd(this.$);this.Q2a();$h.a.Ha(this.eub);this.eub=null;this.eFd=window.performance.now();
mg.a(this.$).vg.btc(this.Bca);Sg.a(this.$).hJd(this.TUf);this.Ndj()};U.prototype.rjj=function(V,Ga){var Bb=this;this.$?this.njf=Sd.TaskExtensions.Ba(this.njf,function(){Bb.indexedDB.hcb(new Lg.a(V,Ga))},this.$.la):fc.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")};U.prototype.Hdj=function(){var V=this.$.la;Sd.TaskExtensions.Ba(Sd.TaskExtensions.Ba(this.indexedDB.S3a(U.iDd),this.nej,V),this.z9i,V)};U.prototype.Ndj=
function(){if(this.SU){var V=Sys.Serialization.JavaScriptSerializer.serialize(this.SU);td.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?Vf.b().aKb(560791645,0,50,R.offline,this.SU.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",V):fc.ULS.sendTraceTag(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",
V)}td.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&this.SU&&this.SU.isToastShown&&uc.Health.instance.recordQosError(ad.a.UTj,[Rd.a.Mjc],!0,!1,!1,!1,null)};U.wld="NetworkAvailability";U.xld="NetworkAvailabilityData";U.iDd="partialInteractivityData";U.BCh=3E3;Object(xd.a)(U,"OfflineModeTelemetryManager",null,[3]);ca.prototype.dispose=function(){$h.a.Ha(this.Ssf);$h.a.Ha(this.Kxd);$h.a.Ha(this.Ala);$h.a.Ha(this.f1g);this.$=null};Object(xd.a)(ca,"NetworkConnectionTelemetryManager",
null,[3]);Am(L,W);L.prototype.W9a=function(){this.wasInteruptedByOfflineMode=!0};Object(xd.a)(L,"SilentReopenData",W,[]);P.prototype.dispose=function(){this.vg.VPf(this.$yf);this.vg.rcj(this.HCf);this.I7=this.vg=this.$=null};P.prototype.ECf=function(V,Ga){V.gM?this.I7=new L(la.a.Ta.Wb,this.$,0!==V.foa,Ga):(5===V.foa&&(this.I7.wasInteruptedByOfflineMode=!0),3!==V.foa&&2!==V.foa||fc.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),
this.I7.oBd(this.$),2===Ga?td.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?Vf.b().bKb(571289604,0,50,R.offline,this.I7.durationMs,this.I7):fc.ULS.sendTraceTag(571289604,0,50,Uh.a.Kc(this.I7)):td.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?Vf.b().bKb(542782150,0,50,R.bih,this.I7.durationMs,this.I7):fc.ULS.sendTraceTag(542782150,0,50,Uh.a.Kc(this.I7)),this.I7=null)};Object(xd.a)(P,"SilentReopenPartialInteractivityTelemetryManager",
null,[3]);var Tg=ue.a;Am(Q,Tg);Q.prototype.dispose=function(){this.qf&&(this.jxc&&(this.qf.rbj(this.JEb),this.qf.kIb(this.Gzf)),this.qf.wPf(this.ivf),this.qf.daj(this.jvf));this.Wzb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.bIb(this.qya),this.Wzb=!1);this.$&&(this.csc&&this.jBc(),this.$.ea&&(this.$.ea.jQf(this.GCf),this.$.ea.sf&&this.$.ea.sf.Pza(this.Aca)));td.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.c1&&(this.c1.dispose(),
this.c1=null);$h.a.Ha(this.brf);this.$=null;Tg.prototype.dispose.call(this)};Q.prototype.byi=function(){this.XQd=!0};Q.prototype.Xje=function(){this.Sna||(this.Sna=mg.a(this.$).vg.mYa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))};Q.prototype.tei=function(){if(this.XQd)return this.XQd=!1,!0;var V=this.V7>this.Hmf||this.pld>this.Hmf&&10>this.V7;fc.ULS.sendTraceTag(537155223,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:{0}, Time gap between last two activities: {1}. return value:{2}",
this.V7,this.pld,V);return V};Q.prototype.Aej=function(){td.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&(this.c1=Ch.a.instance.create(function(){uc.Health.instance.recordQosError(ad.a.lCj,[Rd.a.Mjc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0))};Q.prototype.ozg=function(){var V=this;this.Sna||this.S0?fc.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):
this.S0=Ch.a.instance.create(function(){V.$?V.Sna?fc.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):re.g(V.$).isEditing?(V.Zab||(re.g(V.$).wc.mo(V.ug),fc.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),V.$ab=
!0,fc.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):V.Xje():fc.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.o4f,Gh.a.iBj,void 0,!0)};Q.prototype.Ypf=function(V){this.k2c=this.nve(2,V,!0);this.Hoe()};Q.prototype.wlc=function(V,
Ga){this.wWb=this.nve(V,Ga,!1);this.Hoe()};Q.prototype.nve=function(V,Ga,Bb){Bb=Bb?this.k2c:this.wWb;return Ga?Bb|V:Bb&~V};Q.prototype.bWd=function(){var V=!!this.BOa,Ga=!!this.qSa,Bb=!!this.Sna,gc=!!this.F3b;this.dCb&&!V?this.nzg():!this.dCb&&V&&this.zbh();!this.xkc||Ga||Bb?this.xkc||(Ga?this.bGe():(Bb||this.S0&&this.S0.vp)&&this.cGe()):this.u1f&&this.Efa?this.lzg():!this.lLb||this.Efa||td.EwaSettings.isChangeGateEnabled("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&this.S0||
this.ozg();this.vka&&!gc?this.v9f(!0):!this.vka&&gc&&this.v9f(!1)};Q.prototype.nzg=function(){this.$?this.BOa?fc.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):re.g(this.$).isEditing?(this.$ab||(re.g(this.$).wc.mo(this.ug),fc.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.Zab=!0,fc.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.$je():fc.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")};Q.prototype.$je=function(){this.BOa||(this.BOa=mg.a(this.$).vg.mYa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))};Q.prototype.zbh=function(){this.BOa&&
($h.a.Ha(this.BOa),this.BOa=null)};Q.prototype.bGe=function(){this.qSa&&($h.a.Ha(this.qSa),this.qSa=null);td.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.c1&&this.c1.vp&&this.c1.cancel();this.c1=null};Q.prototype.cGe=function(){this.Sna&&($h.a.Ha(this.Sna),this.Sna=null);this.S0&&($h.a.Ha(this.S0),this.S0=null);this.$ab&&!this.Zab&&re.g(this.$).wc.Dn(this.ug);this.$ab=!1};Q.prototype.lzg=function(){this.qSa||(this.qSa=mg.a(this.$).vg.mYa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,Rf.a.instance.fa(2140)));this.Aej()};Q.prototype.v9f=function(V){V?(this.F3b=mg.a(this.$).vg.mYa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.T1i()):($h.a.Ha(this.F3b),this.F3b=null)};Q.prototype.T1i=function(){if(this.$&&this.$.na){var V=this.$.na.ua.hc();nc.jb(this.$.na.ua,null,null,null,V)}};Q.prototype.jBc=function(){lf.a(this.$).TQ(ye.a.dPa).Wq(this.Qzf);this.$.Sl(this.zd);this.csc=!1};Q.prototype.Hoe=function(){this.documentVisibilityObserver||fc.ULS.sendTraceTag(537155211,
0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.Ai?this.Wzb||(this.documentVisibilityObserver.snb(this.qya),this.Wzb=!0,fc.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.bWd()};Ek.Object.defineProperties(Q.prototype,
{vgi:{configurable:!0,enumerable:!0,get:function(){return this.Efa}},dCb:{configurable:!0,enumerable:!0,get:function(){return!(this.wWb&1)}},xkc:{configurable:!0,enumerable:!0,get:function(){return!(this.wWb&2)}},vka:{configurable:!0,enumerable:!0,get:function(){return!!(this.k2c&2)}}});Object(xd.a)(Q,"NetworkConnectionStateManager",ue.a,[829,3]);var Vh=Dg.a;Am(M,Vh);M.prototype.create=function(){var V=this;Sd.TaskExtensions.Ba(Ib.GetServiceTaskFactory.Va(this.$.da,395,396,this.ub),function(Ga){V.Eb(V.$.da.Aa(400)||
new Q(V.$,Ga.result))},this.$.la,3)};M.ka=function(V){V.da.Ga(401,new M(V))};Object(xd.a)(M,"NetworkConnectionStateManagerFactory",Dg.a,[]);var fi=b(1435),Gj=b(1236);z.prototype.dispose=function(){this.cbg();this.kbg();this.Csd=this.rsd=this.aL=this.Al=this.xr=this.prc=this.$=null;this.l_d=0};z.prototype.LNg=function(V){this.aL=V;this.rsd=V.BHg;this.Csd=V.n6i};z.prototype.wIa=function(){if(this.aL){var V=df.K(this.aL.Exh);this.vCj(V);this.hide();this.cbg();this.aL=null}};z.prototype.vCj=function(V){var Ga=
[1868184698,-1985798686,753331043,2137617149,237279923,1804571062,1766348718,42074747,-875588320,-958589048,-185374993,-111689794,-1502853784];td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",!1)&&V&&(fc.ULS.sendTraceTag(523622037,0,50,"RecoveryUIController.SmartViewOnPaste: RecoveryUI is being dismissed."),null!=this.VAb&&Ga.includes(this.VAb.command)?(fc.ULS.sendTraceTag(526758984,306,50,"RecoveryUIController:dismissRecoveryUI Table hand raise is not triggered. Last command was {0}",
Gj.a[this.VAb.command]),this.VAb=null):this.documentHidden?(fc.ULS.sendTraceTag(523833603,306,50,"RecoveryUIController:dismissRecoveryUI Table hand raise is not triggered. User clicked outside of document."),this.documentHidden=!1):re.g(this.$).Rb.x5(V)?fc.ULS.sendTraceTag(526758983,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a table. Table hand raise is not triggered."):re.g(this.$).Rb.Gka(V)?fc.ULS.sendTraceTag(526758982,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a pivot table. Table hand raise is not triggered."):
(Ga=cf.d(this.$.xa.qa),V=new Uf.a(V,Ga),this.OLj(V)))};z.prototype.ali=function(){return!!this.aL&&this.prc.rhi};z.prototype.vAj=function(V){this.aL?this.show(V):fc.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")};z.prototype.mRh=function(){return this.aL?this.aL.Zqi:null};z.prototype.show=function(V){var Ga=this.aL.cNh();Ga?(this.prc.showFloatie(Object(hh.a)(new fi.a,{x:Ga.x,y:Ga.y}),this.aL.bKa(),V),this.Ck()):fc.ULS.sendTraceTag(537154071,0,100,"RecoveryUIController.Show: point is null.")};
z.prototype.hide=function(){this.ali()&&this.prc.IC();this.kbg()};z.prototype.Ck=function(){if(!this.K6b){var V=re.g(this.$);V.view.Vs(this.edg);V.lk.ml(this.lIe);this.Al.ka("blur",this.tfh);this.$.Ka.Ora(this.JN);this.$.xa.Bg(this.mIe);(V=this.$.da.Aa(65))&&V.q3&&V.q3.registerForCommentEvents(this.kIe);this.K6b=!0}this.Vdc||(this.xr.zt(wh.a.Yb,this.$.domElement,this.onKeyDown,!0),this.xr.zt(wh.a.Ud,this.$.domElement,this.onKeyUp,!0),this.Vdc=!0)};z.prototype.cbg=function(){if(this.K6b){var V=re.g(this.$);
V.view.Xq(this.edg);V.lk.fl(this.lIe);this.Al.detach("blur");this.$.Ka.Mza(this.JN);this.$.xa.Xg(this.mIe);(V=this.$.da.Aa(65))&&V.q3&&V.q3.unregisterForCommentEvents(this.kIe);this.K6b=!1}};z.prototype.kbg=function(){this.Vdc&&(this.xr.Ft(wh.a.Yb,this.$.domElement,this.onKeyDown,!0),this.xr.Ft(wh.a.Ud,this.$.domElement,this.onKeyUp,!0),this.Vdc=this.x_=this.h9b=!1)};z.prototype.$Rj=function(){this.aL&&250<=la.a.Ta.oe.m-this.l_d&&this.show(-1)};z.prototype.OLj=function(V){Sd.TaskExtensions.Ba(Ib.GetServiceTaskFactory.Va(this.$.da,
426,427,1),function(Ga){Ga.result.qea(V,"Paste");fc.ULS.sendTraceTag(523622036,0,50,"RecoveryUIController.triggerTableInvitationHandRaise: IntelligentMetadataOverlayManager is triggered.")},this.$.la,3)};Object(xd.a)(z,"RecoveryUIController",null,[528,3]);var Zi=Dg.a;Am(B,Zi);B.prototype.create=function(){var V=this;if(td.EwaSettings.em())this.mCi();else{var Ga=this.$;Ga.RC(function(Bb){Bb.Rec().then(function(gc){V.Eb(V.$.da.Aa(406)||new z(Ga,gc,li.KeyInputManager.instance,lh.a.instance.KE()))})})}};
B.prototype.mCi=function(){var V=this,Ga=this.$,Bb=this.$.da.Aa(406);Bb?this.Eb(Bb):Ga.RC(function(gc){gc.Rec().then(function(dd){Bb=new z(Ga,dd,li.KeyInputManager.instance,lh.a.instance.KE());V.$.da.Ga(406,Bb);V.Eb(Bb)})})};B.ka=function(V){V.da.Ga(405,new B(V))};Object(xd.a)(B,"RecoveryUIControllerFactory",Dg.a,[]);var Sj=b(734),oh=b(612),Li=b(42),Ai=b(1254),Ri=Xd.a;Am(E,Ri);E.prototype.validate=function(){this.Jj.aF||fc.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Jj.aF.value?
!0:(E.bA(CommonUIStrings.l_FileUploadNoFileSpecified),!1)};E.prototype.$Ji=function(V){this.tvg&&(this.Jj=this.Q_f(V,this.IXb))};E.prototype.gTi=function(){this.Jj&&this.Jj.aF&&(this.v6d||(this.Jj.b8i(Object(fb.a)(this,this.pAd,"onFileChosen")),this.v6d=!0),this.Jj.uSe())};E.prototype.pAd=function(V){this.hXa.uploadStatusLabel=V;this.bfb(this.titleText,Object(fb.a)(this,this.hfc,"insertDialogHandler"),this.hXa)};E.prototype.hfc=function(V){1===V&&this.isEnabled()?E.Fu&&this.Jj.aF&&!this.Jj.aF.value?
(this.hXa.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.bfb(this.titleText,Object(fb.a)(this,this.hfc,"insertDialogHandler"),this.hXa)):(this.wxb(),this.IXb.finalizeUpload(this.Jj,Object(fb.a)(this,this.dispose,"dispose"))):0===V&&this.hide()};E.prototype.R_f=function(){this.AIc=!1;this.Jj=this.Q_f(document.getElementById("uploadFrameContainer"),this.IXb);Od.AFrameworkApplication.ga.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.xga=Object(fb.a)(this,this.hCd,"onUploadFrameLoad"),
Li.a.addHandler(this.Jj.iFrame,"load",this.xga));this.Jj.aF||fc.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.SIf()};E.prototype.hCd=function(){this.SIf()};E.prototype.SIf=function(){if(this.Jj&&!this.AIc){var V=this.Jj.aF;V&&(Li.a.addHandler(V,wh.a.Yb,Object(fb.a)(this,this.onKeyDown,"onKeyDown")),V=[V],this.en=V.concat.apply(V,this.en),this.Ocg(),this.AIc=!0)}};E.prototype.dispose=function(){if(this.Jj&&!E.Fu){var V=this.Jj.aF;V&&Li.a.removeHandler(V,wh.a.Yb,Object(fb.a)(this,
this.onKeyDown,"onKeyDown"));this.xga&&Li.a.removeHandler(this.Jj.iFrame,"load",this.xga)}this.Jj=null;Ri.prototype.dispose.call(this)};E.prototype.Ocg=function(){if(0<this.en.length){var V=new Ai.a(this.en),Ga=tg.FocusManager.instance().VQ();Ga&&(this.en[0].focus(),Ga.ff=V,Ga.I_=!0)}};E.prototype.onKeyDown=function(V){4!==tg.FocusManager.instance().UIf(V)&&V.preventDefault()};E.bA=function(V){var Ga=document.getElementById("errorText");Ga.innerText=V;Ga.style.display="inline-block"};Ek.Object.defineProperties(E.prototype,
{uTj:{configurable:!0,enumerable:!0,get:function(){return this.IXb}}});Ek.Object.defineProperties(E,{Fu:{configurable:!0,enumerable:!0,get:function(){return Od.AFrameworkApplication.ta.Qa.vv&&Od.AFrameworkApplication.ta.Qa.Dff}}});Object(xd.a)(E,"InsertFileDialog",Xd.a,[]);Ek.Object.defineProperties(y,{gg:{configurable:!0,enumerable:!0,get:function(){return Xd.a.cp(y.xk,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}});y.xk="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(xd.a)(y,"InsertImageDialogHtml",null,[]);Am(t,E);t.prototype.validate=function(){this.Jj.aF||fc.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var V=Object(Rb.a)(Db,this.uTj),Ga=V.Leg(this.Jj.aF.value);return 0!==Ga?(E.bA(V.JYe(Ga)),!1):!0};Ek.Object.defineProperties(t.prototype,{eYb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadButtonText}},titleText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadingTitle}},
weh:{configurable:!0,enumerable:!0,get:function(){return y.gg}}});Object(xd.a)(t,"InsertImageDialog",E,[]);var ki=b(618),Pi=b(204),Ni=b(497);v.prototype.B$e=function(){this.WD=rg.a.create().toString();this.Iqa?this.u8c():this.oqe()};v.prototype.a4g=function(V){this.co=document.createElement("iframe");this.co.className=V;this.co.id=V;this.Z6d&&(this.co.style.visibility="visible",this.co.style.height="30px",this.co.setAttribute("frameborder","0"));this.xga=Object(fb.a)(this,this.hCd,"onUploadFrameLoad");
Li.a.addHandler(this.co,"load",this.xga)};v.prototype.b7b=function(V){var Ga=this;V=void 0===V?null:V;Od.AFrameworkApplication.ta.sqc();if(!this.er)return fc.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";Li.a.addHandler(this.er,"change",function(){Ga.tzh(V)});u(Object(fb.a)(this,this.uSe,"fileInputClick"),1,"DoFileOpenDialog");return this.er.value};v.prototype.tzh=function(V){V&&V(this.er.value)};v.prototype.uzh=function(){this.CSb&&(this.CSb.innerText=this.UZe())};v.prototype.b8i=function(V){var Ga=
this;Li.a.addHandler(this.er,"change",function(){V(Ga.UZe())})};v.prototype.UZe=function(){var V=null;if(this.er.value){var Ga=this.er.value,Bb=Ga.lastIndexOf("\\");0<Bb&&(V=Ga.substring(Bb+1,Ga.length))}return V?V:""};v.prototype.uSe=function(){try{fc.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.er.click()}catch(V){throw fc.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",V.message),V;}};v.prototype.wFj=function(){this.Yli()?
this.K6f():(this.bZd(),this.Ks.submit())};v.prototype.Yli=function(){return(this.uqg||this.Iqa)&&!(void 0===window.self.FormData||null===window.self.FormData)};v.prototype.dXf=function(V){if(V){var Ga=this.CCe();this.Rg=new XMLHttpRequest;this.Rg.open("POST",Ga);this.Rg.setRequestHeader("X-CorrelationId",this.WD);this.$ti(V);this.Rg.onreadystatechange=Object(fb.a)(this,this.Ioa,"uploadResponseReceived");this.Rg.send(V)}};v.prototype.$ti=function(V){if(!Gg.a.uB&&V.get){var Ga=V.get("ImageId");V=window.self.navigator;
var Bb={};Ga=(Bb.CorrelationId=this.WD,Bb.Canary=Od.AFrameworkApplication.canary,Bb.ImageNodeId=Ga,Bb);V&&(V=V.connection?V.connection:V.mozConnection?V.mozConnection:V.webkitConnection?V.webkitConnection:null)&&(Ga.effectiveType=V.effectiveType,Ga.downlink=V.downlink,Ga.type=V.type,Ga.rtt=V.rtt);fc.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Ga)}};v.prototype.K6f=function(){try{this.bZd();fc.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");
var V=new (Type.parse("FormData"))(this.Ks);this.dXf(V)}catch(Ga){fc.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Ga.message),this.h$a(null)}};v.prototype.J6f=function(V){try{if(this.bZd(),fc.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.FUj(V)){this.DSb=V;this.Ks.contains(this.er)&&this.Ks.removeChild(this.er);var Ga=new (Type.parse("FormData"))(this.Ks);Ga.append("applicationfileInput",
V.blob,V.filename);this.dXf(Ga)}else this.h$a(null)}catch(Bb){fc.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+Bb.message),this.h$a(null)}};v.prototype.FUj=function(V){return V&&void 0!==V.blob&&null!==V.blob&&void 0!==V.filename&&null!==V.filename&&""!==V.filename?void 0===window.self.FormData||null===window.self.FormData?(fc.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(V=V?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",
void 0===V.blob||null===V.blob,void 0===V.filename||null===V.filename||""===V.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",fc.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",V)),!1)};v.prototype.Ioa=function(){if(4===this.Rg.readyState)if(200===this.Rg.status){fc.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.WD);var V=this.Rg.getResponseHeader("X-NewKey"),
Ga=this.Xei(this.Rg),Bb=!1;if(void 0!==V&&null!==V&&Ga&&(Bb=this.vUj(V),!this.MSc&&Bb)){fc.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.WD);this.MSc=!0;void 0!==this.DSb&&null!==this.DSb?this.J6f(this.DSb):this.K6f();return}fc.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.MSc,
Ga,!(void 0===V||null===V),Bb,this.WD);this.h$a(this.Rg.responseText)}else fc.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Rg.status,this.Rg.responseText?!1:!0,this.WD),this.h$a(null)};v.prototype.Xei=function(V){try{var Ga=vf.a(V.responseText).Responses;if(void 0!==Ga&&null!==Ga&&1===Ga.length){var Bb=Ga[0];if(void 0!==Bb&&null!==Bb&&2===Bb.length&&28===Bb[1].StatusCode)return!0}}catch(gc){}return!1};v.prototype.vUj=function(V){Ni.a.Ubg(V);
return Od.AFrameworkApplication.canary!==V?!1:!0};v.prototype.bZd=function(){this.NSc||(this.NSc=new Date)};v.prototype.dispose=function(){this.Am||(this.Iqa?this._parent.removeChild(this.Ks):(this._parent.removeChild(this.co),Li.a.removeHandler(this.co,"load",this.xga),this.xga=null),this.zIc&&(Li.a.removeHandler(this.er,"change",this.zIc),this.zIc=null),this.vSe&&(this.wib&&(Li.a.removeHandler(this.er,"change",this.wib),this.wib=null),this.CSb=null),this.er=this.Ks=this._parent=this.co=null,this.Am=
!0,this.NSc=null,fc.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))};v.prototype.delayedDispose=function(){this.dispose()};v.prototype.C6g=function(V){if(this.Ks){var Ga;(Ga=this.Ks.querySelector("input[name=__REQUESTDIGEST]"))?Ga.value=V:(Ga=this.S3c(),Ga.type="hidden",Ga.id="__REQUESTDIGEST",Ga.name="__REQUESTDIGEST",Ga.value=V,this.Ks.appendChild(Ga))}};v.prototype.S3c=function(){return this.Iqa?document.createElement("input"):this.co.contentWindow.document.createElement("input")};v.prototype.hCd=
function(){try{if(!this.co.contentWindow.document.body)return}catch(gc){this.j4h();return}if(!(this._initialized||this.X8a&&Gg.a.wF))this.u8c();else if(!this.X8a||!Gg.a.wF||this.$ii){var V=Gg.a.xf?this.co.contentWindow.document.body.innerText:this.beg?this.co.contentWindow.document.body.firstChild.innerText:this.co.contentWindow.document.body.firstChild.innerHTML;var Ga=this.co.contentWindow.document.body.innerText.toLowerCase(),Bb=0<=Ga.indexOf("responses")||0<=Ga.indexOf("wopisrc");Ga=0<=Ga.indexOf("http error");
!Bb&&Ga&&fc.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.co.contentWindow.document.body.innerText);this.h$a(V)}};v.prototype.u8c=function(){if(!this._initialized){var V=this.fa("uploadForm"),Ga=this.fa("fileInput"),Bb=this.CCe();this.i6g();this.Ks.id=V;this.Ks.method="post";this.Ks.encoding="multipart/form-data";this.Ks.action=Bb;this.er.type="file";this.d1d&&(this.er.accept=this.d1d,this.b3d&&(this.er.capture=this.b3d));this.er.id=Ga;this.er.name=
Ga;this.HIg&&(this.er.multiple=!0);!this.vSe||Gg.a.xf||Gg.a.XH||(this.wib=Object(fb.a)(this,this.uzh,"fileInputChangedHandleAccessibility"),Li.a.addHandler(this.er,"change",this.wib),this.CSb=oe.a.kqe(this.Ks,this.er,"InputFileDescription"));this.Z6d&&(this.Iqa||(V=this.co.contentWindow.document.body,V.style.margin="0",V.style.overflow="hidden"),V=Od.AFrameworkApplication.ta,this.er.style.fontFamily=V.f1,this.er.style.fontSize=V.ZAc,this.er.style.margin="0");(V=document.getElementById("__REQUESTDIGEST"))&&
this.C6g(V.value);this.Ks.appendChild(this.er);this._initialized=!0;this.aqg(this)}};v.prototype.i6g=function(){if(this.Iqa)this.Ks=document.createElement("form"),this._parent.appendChild(this.Ks),this.er=document.createElement("input");else{this.Ks=this.co.contentWindow.document.createElement("form");var V=this.co.contentWindow.document;V.body.appendChild(this.Ks);this.er=V.createElement("input")}};v.prototype.oqe=function(){this._parent.appendChild(this.co);this.X8a&&Gg.a.wF&&this.u8c()};v.prototype.CCe=
function(){var V=new ug.QueryStringBuilder(this.ASe);Od.AFrameworkApplication.vYa(V);this.Rnj(V);V=V.toString();if(Gg.a.Gf||Gg.a.wF||Gg.a.XH)V=Xg.a.cWe(V);return V};v.prototype.lle=function(){var V=new pi.a(2,1,0,Object(fb.a)(this,this.delayedDispose,"delayedDispose"),4);Od.AFrameworkApplication.Qi.Sg(V)};Ek.Object.defineProperties(v.prototype,{YSf:{configurable:!0,enumerable:!0,get:function(){return this.Fug}},sessionId:{configurable:!0,enumerable:!0,get:function(){return this.RQc}},iFrame:{configurable:!0,
enumerable:!0,get:function(){return this.co}},aF:{configurable:!0,enumerable:!0,get:function(){return this.er}},X8a:{configurable:!0,enumerable:!0,get:function(){return Od.AFrameworkApplication.ga?Od.AFrameworkApplication.ga.ra("NativeFileOpenDialogIsEnabled"):!1}},vSe:{configurable:!0,enumerable:!0,get:function(){return Od.AFrameworkApplication.ga?Od.AFrameworkApplication.ga.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}},$ii:{configurable:!0,enumerable:!0,get:function(){return this.Iqa?!1:
Pi.a(this.co.contentWindow.location.pathname,this.ASe,0)}},HIg:{configurable:!0,enumerable:!0,get:function(){return!Gg.a.uB&&Od.AFrameworkApplication.ga.ra("AllowMultipleImageInsertFromLocalDevice")}}});Object(xd.a)(v,"UploadFrame",null,[3]);Am(n,v);n.prototype.fa=function(V){return V};n.prototype.Rnj=function(V){fc.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");Ed.a.GWc(V,this.$.ya);V.J9(He.a.sessionId,this.sessionId);var Ga=re.g(this.$).ha;Ga=df.o(Ga.sa.x4,this.$);
V.J9(He.a.M1i,this.$.xa.qa.name);V.J9(He.a.L1i,Ga.FirstRow.toString());V.J9(He.a.K1i,Ga.FirstColumn.toString())};n.prototype.j4h=function(){this.YSf("ServerUploadError")};n.prototype.h$a=function(V){this.YSf(V)};n.dhi=function(V){return!V||Yb.a.equals(V,"ServerUploadError",!1)};Object(xd.a)(n,"UploadFrameWrapper",v,[]);Am(w,t);w.prototype.Q_f=function(V,Ga){return new n(V,Object(fb.a)(Ga,Ga.mFb,"onUploadFrameInitialized"),Object(fb.a)(Ga,Ga.Ioa,"uploadResponseReceived"),this.ga,!0,this.$)};w.prototype.dispose=
function(){this.mBc();this.gR=this.sCc=null;t.prototype.dispose.call(this)};w.prototype.hide=function(){t.prototype.hide.call(this);this.$.zb.Kz=!1};w.prototype.validate=function(){var V=this.sCc.IZd(this.Jj.aF.value,this.sCc.P$f(this.Jj));return 0!==V?(V=this.sCc.ced(V).Description,this.oYd(V),this.nUd(),!1):!0};w.prototype.isEnabled=function(){return!0};w.prototype.oYd=function(V){this.kV.innerHTML=V};w.prototype.Vld=function(){this.kV=document.getElementById("errorText");this.kV.style.display=
"inline-block";this.aBa=!1;this.oYd("");this.sIa.style.maxWidth=this.sIa.currentStyle.minWidth};w.prototype.nUd=function(){this.gR.pa(wh.a.click,this.Jj.aF,this.bnc);this.gR.pa(wh.a.Yb,this.Jj.aF,this.bnc);this.aBa=!0};w.prototype.mBc=function(){this.aBa&&(this.gR.za(wh.a.click,this.Jj.aF,this.bnc),this.gR.za(wh.a.Yb,this.Jj.aF,this.bnc),this.aBa=!1)};Object(xd.a)(w,"InsertImageDialogWrapper",t,[]);Am(h,Db);h.prototype.dispose=function(){$h.a.Ha(this.l0b);this.Jj&&this.Jj.lle();this.Jj=this.l0b=this.wb=
null};h.prototype.g5i=function(V){function Ga(){gc.mx(!0)}var Bb=this;if(!this.$)return fc.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),cc.Task.Sa(!0);if(!this.$.Aba)return cc.Task.Sa(!0);var gc=new Dh.a,dd=new FileReader;V=V.aF.files[0];dd.onload=function(){Bb.IDd=dd.result;gc.mx(!0)};dd.onerror=Ga;dd.onabort=Ga;dd.readAsDataURL(V);return gc.task};h.prototype.P$f=function(V){var Ga=-1;V=V.aF;(null===V||void 0===V?0:V.files)&&0<V.files.length&&(Ga=V.files[0].size);
return Ga};h.prototype.IZd=function(V,Ga){var Bb=h.Y2g(Db.UBa(V));0===Bb?-1!==Ga&&(fc.ULS.sendTraceTag(526399118,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",Ga,this.Xkc,this.$.ea.jjf),Ga>this.Xkc?Bb=3:Ga>this.$.ea.jjf&&(Bb=7)):6===Bb&&this.$vi(V);fc.ULS.sendTraceTag(526399117,0,50,"Validated file on client, validation result: {0}",Bb);return Bb};h.prototype.UBa=function(V,Ga){V=this.IZd(V,this.P$f(Ga));return 0!==V?(this.s1a||1===V||this.aSd(V),!1):
!0};h.prototype.k$f=function(V){V.wFj()};h.prototype.ced=function(V){var Ga=0,Bb=1,gc=-1100324317,dd="InsertPictureUnknownError",sd=null;switch(V){case 1:Ga=1721;Bb=0;gc=940870981;dd="InsertPictureNoFileSelected";break;case 3:Bb=0;gc=1250467391;dd="InsertPicturePictureTooBig";sd=String.format(Rf.a.instance.Ab(172),this.myi.toLocaleString());break;case 6:Ga=1725;Bb=0;gc=1380041209;dd="InsertPictureUnsupportedFormat";break;case 7:Ga=1722;Bb=0;gc=-903115058;dd="InsertPictureExceedWorkbookSize";break;
case 4:Ga=1723;Bb=0;gc=1218352119;dd="InsertPictureUploadTimeout";break;case 5:Ga=1724,Bb=0,gc=1979899005,dd="InsertPictureServiceNonDeterministicError"}V=h.gd(Ga,Bb,gc,dd);sd&&(V.Description=sd);return V};h.prototype.showDialog=function(){this.Sve()?(this.s1a=!1,this.Jj=new n(this.$.domElement,this.mFb,this.Ioa,this.ga,!1,this.$,!0)):(fc.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.q7a&&(Gg.a.uv||Gg.a.wF&&72>Gg.a.cye)?(this.s1a=!1,this.Jj=new n(this.$.domElement,this.mFb,
this.Ioa,this.ga,!1,this.$)):(this.s1a=!0,this.Jj=(new w(this,this.$,this.ga)).Jj))};h.prototype.Y3h=function(V){var Ga={};try{if(Ga=Uh.a.mi(V),Vf.b().OA(this.y_d.id,Ga.ServerCorrelationId,"actions","ServerActions"),!Se.a.oh(Ga.Errors)&&Ga.Result){this.$.ea.KX(Ga.StateId,"BasePictureUploaderWrapper.UploadResponseReceived");var Bb=Ga.Result;ji.a(this.$).jna(1,Bb);var gc=this.$.da.Aa(277);gc&&gc.AUc(this.$,1,Ga.Result,Ga,"InsertPicture");fc.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(dd){fc.ULS.sendTraceTag(526399113,
0,50,"BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",V?V.length:-1,dd)}this.OAc(Ga,null,"InsertPictureWebMethod")};h.prototype.Z4e=function(V){V={Errors:[this.ced(V)]};this.OAc(V,null,"InsertPictureWebMethod")};h.prototype.OAc=function(V,Ga,Bb){this.At(V,Ga,Bb)};h.prototype.SWd=function(V,Ga,Bb){this.saa(V,Ga,Bb)};h.prototype.aSd=function(V){V=this.ced(V);td.EwaSettings.Iz()?new Ne.a(this.$,V):(new We.ErrorDialog(this.$,V)).kf()};
h.prototype.$vi=function(V){var Ga=this.$.ya.InsertPicturUnsupportedExtensionsForLogging;V=Cb.a.Ul(V);for(var Bb=0;Bb<Ga.length;++Bb)if(V.endsWith(Ga[Bb])){fc.ULS.sendTraceTag(526399112,0,50,"Insert picture blocked invalid extension: {0}",Ga[Bb]);break}};h.JUj=function(V){return!V||Yb.a.equals(V,He.a.insertPictureUnknownError,!0)?2:Yb.a.equals(V,He.a.insertPictureNoFileSelectedError,!0)?1:Yb.a.equals(V,He.a.Jbi,!0)?3:Yb.a.equals(V,He.a.Kbi,!0)?5:0};h.gd=function(V,Ga,Bb,gc){return Se.a.gd(1,0,0,V,
Ga,Bb,gc)};h.Y2g=function(V){switch(V){case 1:return 1;case 2:return 6}return 0};h.prototype.Sve=function(){return td.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&!this.q7a&&void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1};Ek.Object.defineProperties(h.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},myi:{configurable:!0,enumerable:!0,get:function(){return this.Xkc/1024/1024}}});Object(xd.a)(h,"BasePictureUploaderWrapper",
Db,[3]);Am(r,h);r.prototype.Zyj=function(){this.Xkc=28E5;this.aSd(3)};r.prototype.vad=function(V){var Ga=this;fc.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");var Bb=new FileReader;V=V.aF.files;if(0==V.length)fc.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var gc=V[0];Bb.onload=function(){Ga.F9b.stop();Ga.zzh.$Ri(Bb.result,Ga);fc.ULS.sendTraceTag(526399109,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:{0}, Size:{1}",
gc.type,gc.size.toString())};Bb.onerror=function(){Ga.F9b.stop();fc.ULS.sendTraceTag(526399108,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:{0}, Size:{1}",gc.type,gc.size.toString())};Bb.onabort=function(){Ga.F9b.stop();fc.ULS.sendTraceTag(526399107,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:{0}, Size:{1}",gc.type,gc.size.toString())};this.F9b.start();Bb.readAsDataURL(gc)}};r.prototype.finalizeUpload=function(V,Ga){this.vad(V,Ga)};
Object(xd.a)(r,"FileReaderUploaderWrapper",h,[591]);m.prototype.getSheetName=function(){return this.sheetName};Object(xd.a)(m,"MacroRecorderPictureInsertedPayload",null,[445]);Am(l,h);l.prototype.vad=function(V,Ga){var Bb=this;h.prototype.finalizeUpload.call(this,V,Ga);lg.a(this.$.userOperationManager,function(gc,dd){Bb.At=gc;Bb.saa=dd;Bb.y_d.start();Bb.l0b.Zq();Bb.mAc=!1;Bb.k$f(V);return Bb.g5i(V)},function(gc){function dd(){return new m(ie,Bb.IDd?Bb.IDd:"")}var sd={};Bb.$.Bj(sd);var ie=sd.SheetName;
gc=td.EwaSettings.qc()?new zf.a(510,0,gc,72,dd):new ve.a(510,0,gc,8,dd);gc.Ana(function(){return!0});gc.Rd=Bb.Rd;return gc},this.Rd)};l.prototype.finalizeUpload=function(V,Ga){this.vad(V,Ga)};Object(xd.a)(l,"PictureUploaderWrapper",h,[]);Object(xd.a)(f,"UploadBlobParameters",null,[]);Am(e,l);e.prototype.SWd=function(V,Ga,Bb){l.prototype.SWd.call(this,V,Ga,Bb);this.Z0.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))};e.prototype.OAc=function(V,
Ga,Bb){l.prototype.OAc.call(this,V,Ga,Bb);Se.a.oh(V.Errors)?this.Z0.setException(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",Se.a.Wc(V.Errors)))):this.Z0.setResult(!0)};e.prototype.k$f=function(V){var Ga=new f(this.Eec.name,this.Eec);V.J6f(Ga)};e.DFh=function(V){var Ga=V.split(",");V=Ga[0].includes("base64")?window.self.atob(Ga[1]):window.self.decodeURI(Ga[1]);Ga=Ga[0].split(":")[1].split(";")[0];for(var Bb=new Uint8Array(V.length),
gc=0;gc<V.length;gc++)Bb[gc]=V.charCodeAt(gc);V=new Blob([Bb],{type:Ga});V.name="Image.png";return V};Object(xd.a)(e,"DataUrlUploaderWrapper",l,[]);c.prototype.rai=function(V,Ga,Bb,gc,dd){new l(V,Ga,Bb,gc,dd,!0)};c.prototype.q$h=function(V,Ga,Bb,gc,dd,sd){new e(V,null,Ga,Bb,gc,dd,sd)};c.prototype.C$h=function(V,Ga,Bb,gc,dd){new r(V,Ga,Bb,gc,dd,!0)};Object(xd.a)(c,"UploaderCreator",null,[526]);var be=Dg.a;Am(a,be);a.ka=function(V){V.da.Ga(485,new a(V))};a.prototype.create=function(){var V;this.Eb(null!==
(V=this.$.da.Aa(484))&&void 0!==V?V:this.$.da.Ga(484,new c))};Object(xd.a)(a,"UploaderCreatorFactory",Dg.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPicture");Type.registerNamespace("_Ewa");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Qe.main();Type.registerNamespace("Common.App.InProductMessaging");pe.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Xe.main();Type.registerNamespace("Common.App.InsertFile");
Type.registerNamespace("Common.App.InsertPicture");(function(){Vg.a.Fa(function(V){wb.ka(V)})})();(function(){Vg.a.Fa(function(V){Kb.ka(V)})})();(function(){Vg.a.Fa(function(){Vg.a.Fa(yc.ka)})})();(function(){Vg.a.Fa(function(){Vg.a.Fa(Qb.ka)})})();(function(){Vg.a.Fa(function(V){tc.ka(V)})})();yg.a.Ki(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
Vg.a.Fa(ma.ka);Vg.a.Fa(M.ka);(function(){Vg.a.Fa(function(V){B.ka(V)})})();(function(){Vg.a.Fa(function(V){a.ka(V)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.pi.js.map/3cfce10a0d82c7c66f34a6ca82cf5cb4/EwaDS.pi.js.map