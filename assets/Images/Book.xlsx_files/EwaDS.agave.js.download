/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1019:function(x,C,b){function a(e,f,l){this.uQb=e;this.Qjg=f;this.Rjg=l}function c(){this.title=this.id=this.tabs=null}x=b(0);Object(x.a)(c,"AddInDataTransferObject",null,[]);b.d(C,"a",function(){return a});a.Eub=function(e){return(e=e.yW)?Object.assign(new c,{tabs:e.Ts.toArray(),id:e.aBg,title:e.bBg}):null};Ek.Object.defineProperties(a.prototype,{Ts:{configurable:!0,enumerable:!0,get:function(){return this.uQb}},aBg:{configurable:!0,
enumerable:!0,get:function(){return this.Qjg}},bBg:{configurable:!0,enumerable:!0,get:function(){return this.Rjg}}});Object(x.a)(a,"OneLineRibbonExtensibility",null,[])},1057:function(x,C,b){function a(L,ca,U){U=void 0===U?null:U;this.NEc=new n.a;var aa=new h.a;ca&&aa.add(ca.Zwi);U&&aa.addRange(U);this.Hn=L;this.zxg=aa}function c(L,ca,U,aa){this.KT=new h.a;this.EG=new h.a;this.qpa=null;this.glb=new h.a;this.R$d=Promise.resolve(null);this.Tge=!1;this.VVb=ca;this.Dmg=L;this.uhe=U;this.Vjg=aa}function e(){var L=
f.call(this)||this;L.errorCode=0;return L}function f(){this.ZQb=new h.a;this.W9=this.V9=!1;this.poa=this.authChallenge=null;this.startTime=this.retryCount=0;this.uoe=null}function l(){this.token=null;this.expiresOn=0;this.gha=this.authChallenge=null}function m(){this.accessToken=null}function r(){this.startTime=0;this.callback=null}b.r(C);x=b(0);var h=b(202),w=b(14),n=b(98);Object(x.a)(r,"SSOCallbackInfo",null,[]);Object(x.a)(m,"AccessTokenInformation",null,[205]);var v=b(1169);Object(x.a)(l,"CachedTokenInfo",
null,[]);Ek.Object.defineProperties(f.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.ZQb}}});Object(x.a)(f,"SSORequestInfo",null,[]);Am(e,f);Object(x.a)(e,"SSOFailedRequestInfo",f,[]);var u=b(4);c.prototype.Swj=function(L){if(this.qpa&&this.qpa.authChallenge===L.authChallenge){if(Date.now()/1E3+c.wyi>this.qpa.expiresOn)return this.qpa=null,!1;L=new v.a;L.token=this.qpa.token;L.expiresOn=this.qpa.expiresOn;L.gha=this.qpa.gha;L.jTa=!0;L.swb=0;this.Kwb(L);return!0}return!1};
c.prototype.uvj=function(L){for(var ca=0;ca<this.EG.count;ca++)if(this.EG.oa(ca).authChallenge===L.authChallenge&&this.EG.oa(ca).poa===L.poa){var U=void 0;(U=this.EG.oa(ca)).retryCount=U.retryCount+1;L.retryCount=this.EG.oa(ca).retryCount;if(this.EG.oa(ca).retryCount<c.Uyi||!this.EG.oa(ca).V9&&L.V9||!this.EG.oa(ca).W9&&L.W9){if(!this.EG.oa(ca).V9&&L.V9||!this.EG.oa(ca).W9&&L.W9)L.retryCount=0;this.EG.removeAt(ca);break}L=new v.a;L.errorCode=this.EG.oa(ca).errorCode;this.Kwb(L);return!0}return!1};
c.prototype.RCg=function(L,ca){for(var U=0;U<this.EG.count;U++)if(this.EG.oa(U).poa===L.poa&&this.EG.oa(U).authChallenge===L.authChallenge)return;this.EG.add(Object.assign(new e,{V9:L.V9,W9:L.W9,authChallenge:L.authChallenge,poa:L.poa,errorCode:ca,retryCount:L.retryCount}))};c.prototype.Gcd=function(L,ca,U,aa,F,D){var J=this,R=b(1057).AppsForOfficeSingleSignOnManager;""===U&&(U=null);if(this.Tge)R.V5(D,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var Z=null,W=El(this.KT),
ka=W.next();!ka.done;ka=W.next())if(ka=ka.value,ka.V9===L&&ka.W9===ca&&ka.authChallenge===U&&ka.poa===F){Z=ka;break}Z||(Z=Object.assign(new f,{V9:L,W9:ca,authChallenge:U,uoe:aa,poa:F,retryCount:0,startTime:R.Gw()}),this.KT.add(Z));Z.retryCount=0;Z.callbacks.add(D);this.R$d=this.R$d.then(function(){var ma=b(1057).AppsForOfficeSingleSignOnManager;if(0<J.KT.count){var pa=J.KT.oa(0);if(J.Swj(pa)||J.uvj(pa))return null;for(var xa=0;xa<J.glb.count;)J.glb.oa(xa)+c.jIj<ma.Gw()?J.glb.removeAt(xa):xa++;if(J.glb.count>=
c.Pyi||J.KT.count>=c.tyi)return pa=new v.a,pa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,J.Kwb(pa),null;var va=null;u.AFrameworkApplication.ta&&(ma=u.AFrameworkApplication.ta.JD)&&(va=ma.Gc("ComponentAttach",J.Dmg+c.wwg));return pa.poa.Wyg(J.resource,pa.V9,pa.W9,pa.authChallenge,J.Vjg,pa.uoe).then(function(ta){va&&va.stop();J.Kwb(ta)},function(){va&&va.stop();var ta=new v.a;ta.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;J.Kwb(ta)})}return null})}};c.prototype.Kwb=
function(L){var ca=b(1057).AppsForOfficeSingleSignOnManager;try{if(this.KT.count){var U=this.KT.oa(0);this.KT.removeAt(0);var aa=null;L.errorCode||(aa=new m,aa.accessToken=L.token);L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.RCg(U,L.errorCode);var F={};null!=
L.swb&&(F.getTokenSilentTime=L.swb.toString());null!=L.ihd&&(F.getTokenPopupTime=L.ihd.toString());null!=L.Ted&&(F.getIDTokenTime=L.Ted.toString());null!=L.jTa&&(F.tokenCached=L.jTa.toString());L.mVd&&(F.detailedError=L.mVd);L.gha&&(F.authLibrary=L.gha);U.retryCount&&(F.retryCount=U.retryCount);for(var D=El(U.callbacks),J=D.next();!J.done;J=D.next())ca.V5(J.value,L.errorCode,aa,F);null!=L.jTa&&L.jTa||this.glb.add(U.startTime);if(!L.errorCode)for(null!=L.expiresOn&&(this.qpa=Object.assign(new l,{token:L.token,
expiresOn:L.expiresOn,authChallenge:U.authChallenge,gha:L.gha})),this.EG.clear(),D=0;D<this.KT.count;)if(this.KT.oa(D).authChallenge===U.authChallenge){var R=El(this.KT.oa(D).callbacks);for(J=R.next();!J.done;J=R.next())ca.V5(J.value,L.errorCode,aa,F);this.KT.removeAt(D)}else D++}}catch(Z){w.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",Z.message)}};c.prototype.shutdown=function(){this.Tge=!0;this.KT.clear()};Ek.Object.defineProperties(c.prototype,{resource:{configurable:!0,
enumerable:!0,get:function(){return this.VVb}}});c.jIj=6E4;c.Pyi=6;c.tyi=6;c.Uyi=3;c.wyi=300;c.wwg="GetAccessToken";Object(x.a)(c,"SSOCallbackManager",null,[]);var t=b(935),y=b(942),E=b(123),B=b(80),z=b(24),M=b(29),Q=b(152),P=b(355);b.d(C,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.Hcd=function(L,ca,U,aa,F,D,J,R,Z,W){W=Object.assign(new r,{startTime:a.Gw(),callback:W});try{var ka=!!U&&""!==U,ma=W.startTime,pa=this.getOsfControl(L),xa=pa.getStoreType()||"",va=pa.getOwnerAddinStoreType()||
"",ta=pa.getSolutionId()||"",fa=pa.getVersion()||"";xa=xa.toLowerCase();va=va.toLowerCase();ta=ta.toLowerCase();var Ca=B.a.Sed(ca)||"",Sa=B.a.Sed(pa.getIframeUrl())||"",Gb=Ca.toLowerCase()===Sa.toLowerCase();Ca=xa;"inmemory"===xa&&(Ca=va);var kb=Telemetry.PrivacyRules.GetPrivacyCompliantId(ta,Ca,pa.getAssetId(),null,null,pa.getStoreId());pa={};var lb=(pa.callInstanceId=ma.toString(),pa.controlAssetId=kb,pa.controlVersion=fa,pa.storeType=xa,pa.ownerStoreType=va,pa.allowConsentPrompt=aa.toString(),
pa.forMSGraphAccess=F.toString(),pa.allowSignInPrompt=D.toString(),pa.hasAddinAuthChallenge=ka.toString(),pa.securityOriginEqualsSourceLocation=Gb.toString(),pa.singleSignOnEnabled=J.toString(),pa.accountTypeFilter=R||"",pa);w.ULS.sendTraceTag(51401115,344,50,"{0}",lb);Q.a.sendTelemetryEvent(Object.assign(new P.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:E.a.Il(lb)}));ma=!0;var Nb=u.AFrameworkApplication.ga.Ua("HostAuthType");switch(R){case "aad":ma="aad"===Nb;break;
case "msa":ma="msa"===Nb;break;default:ma=!R||"noFilter"===R}if(ma){R=null;if(J)for(var Aa=El(this.zxg),qa=Aa.next();!qa.done;qa=Aa.next()){var Xa=qa.value;if(Xa.Ngi(ta)){R=Xa;break}}R?this.isSSOAddin(L)?(J=!0,"omex"===Ca&&(J=!1),"spapp"===Ca||"spcatalog"===Ca?(w.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.V5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):F&&!J?(w.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),
a.V5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(F&&"exchange"===Ca&&(aa=!1),this.Gcd(L,ca,U,Ca,aa,D,Z,R,W))):(w.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.V5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.V5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else a.V5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Ha){this.gkc(),w.ULS.sendTraceTag(22402397,
344,10,"GetAccessToken: action failed. Exception message: {0}",Ha.message),a.V5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(L,ca,U,aa){this.Hcd(L,U[t.a.TVc]||null,U[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,U[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,U[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,U[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||
!1,ca,U[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,U[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,aa)};a.prototype.Gcd=function(L,ca,U,aa,F,D,J,R,Z){this.NEc.xb(L)?aa=this.NEc.oa(L):(aa=new c(L,this.getWebApplicationResource(L).split(",")[0],aa,this.getDefaultDisplayName(L)),this.NEc.add(L,aa));var W=aa.resource;L=a.ZVh(W,this.getWebApplicationId(L));var ka=OfficeExt.WACUtils.getHostSecure(ca);L&&ka?L.toLowerCase()===ka.toLowerCase()?aa.Gcd(F,
D,U,J,R,Z):(a.SNa('SSO Resource "'+W+'" cannot be used from "'+ca+'" origin due to domain mismatch.'),w.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.V5(Z,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(L||w.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),ka||w.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.V5(Z,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,
null,null))};a.prototype.gkc=function(){var L={};w.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",(L.UserAgent=window.navigator.userAgent,L))};a.prototype.getOsfControl=function(L){return this.Hn.getOsfControl(L)};a.prototype.isSSOAddin=function(L){return this.getOsfControl(L).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=function(L){return this.getOsfControl(L).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=function(L){return this.getOsfControl(L).getManifest().getWebApplicationResource()};
a.prototype.getDefaultDisplayName=function(L){return this.getOsfControl(L).getManifest().getDefaultDisplayName()};a.HXh=function(){try{var L={};z.a.Nka&&y.a.Axb&&(L.UiHostSupportsAuthTokenAddinList=a.GTe);L.UiHostSupportsAuthToken=y.a.Axb;return L}catch(ca){w.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",ca.message)}return null};a.getInstance=function(L,ca,U){a.Ma||(a.Ma=new a(L,void 0===U?null:U));return a.Ma};a.SNa=function(L){window.console.warn&&window.console.warn(L)};
a.ZVh=function(L,ca){if(!L)return"";ca||(ca="");var U=L.toLowerCase(),aa=ca.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(aa)||(a.SNa('SSO App Id "'+ca+'" is not a valid format. It will be rejected from store submission.'),w.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));U.endsWith(aa)||(a.SNa('SSO Resource "'+L+'" does not end with App Id "'+ca+'". It will be rejected from store submission.'),w.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));
if(!U.startsWith("https://")&&!U.startsWith("api://"))return a.SNa('SSO Resource "'+L+'" must be https:// or api:// protocol.'),w.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(ca=0;ca<L.length;ca++){aa=L.charAt(ca);var F=M.a.charCodeAt(L,ca);if(33>F||126<F||"&"===aa||"?"===aa||"#"===aa||"%"===aa||"\\"===aa)return a.SNa('SSO Resource "'+L+'" contains an invalid character "'+aa+'".'),w.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+aa+"' in resource URI."),
""}if(0<=L.indexOf("::"))return a.SNa('SSO Resource "'+L+'" contains an invalid string "::".'),w.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<L.length)return a.SNa('SSO Resource "'+L+'" is '+L.length+" characters and exceeds the max length of 120 characters."),w.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+L.length+"."),"";U.startsWith("api://")&&(U="https://"+U.substring(6,U.length));return 8===U.length?"":OfficeExt.WACUtils.getHostSecure(U)||""};a.V5=function(L,
ca,U,aa){var F=L.startTime,D=0;0<F&&(D=a.Gw()-F);var J={};F=(J.callInstanceId=F.toString(),J.callDuration=D.toString(),J.errorCode=ca.toString(),J);if(aa)for(var R in aa)F[R]=aa[R];w.ULS.sendTraceTag(51401116,344,50,"{0}",F);Q.a.sendTelemetryEvent(Object.assign(new P.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:E.a.Il(F)}));L.callback(ca,U)};a.Gw=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(L){}return Date.now()};a.GTe=
"wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");a.Ma=null;Object(x.a)(a,"AppsForOfficeSingleSignOnManager",null,[182])},1071:function(x,C,b){function a(){var e={};this.ZQe=(e.tabhome="Ribbon.Home",e.tabinsert="Ribbon.Insert",e.tabdata="Ribbon.Data",e.tabreview="Ribbon.Review",e.tabview="Ribbon.View",e);e={};this.YQe=(e.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",c.a.instance.fa(1601),c.a.instance.fa(1605)],
e.tabformulas=["Ribbon.Formulas",c.a.instance.fa(1602),c.a.instance.fa(1606)],e.tabdeveloper=["Ribbon.Developer",c.a.instance.fa(1603),c.a.instance.fa(1607)],e.tabaddins=["Ribbon.AddIns",c.a.instance.fa(1604),c.a.instance.fa(1608)],e);this.W8b=null}b.d(C,"a",function(){return a});x=b(0);var c=b(15);a.prototype.$Rh=function(){if(!this.W8b){this.W8b={};for(var e=El(Object.keys(this.ZQe)),f=e.next();!f.done;f=e.next())f=f.value,this.W8b[f]=this.ZQe[f];e=El(Object.keys(this.YQe));for(f=e.next();!f.done;f=
e.next())f=f.value,this.W8b[f]=this.YQe[f][0]}};Ek.Object.defineProperties(a.prototype,{Xha:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},dN:{configurable:!0,enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}}});Object(x.a)(a,"AddinCommandsStringProvider",null,[572])},1073:function(x,C,b){function a(){this.BLa=0;this.vha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=
0;this.eec=!1;this.Z8e=this.mia=null}b.d(C,"a",function(){return a});x=b(0);Object(x.a)(a,"AddInCommandsNotificationParameters",null,[])},1140:function(x,C,b){function a(){}function c(){}function e(F,D,J,R,Z,W){F=f.call(this,F,D,J,R,Z,void 0===W?null:W)||this;F.JUb=null;return F}function f(F,D,J,R,Z,W){F=l.call(this,F,J,Z.DX,void 0===W?null:W)||this;F.qbe=0;F.q1=F.eSh(R);F.VXa=D;F.df=Z;F.kJj=7;F.kl=F.VXa.ownerDocument.createElement("div");F.kl.className="ModalCalloutControlOverlay";F.kl.tabIndex=
0;F.VXa.insertBefore(F.kl,F.VXa.firstChild);return F}function l(F,D,J,R){var Z=v.call(this,document.createElement("div"))||this;Z.Lqa=null;Z.npa=null;Z.GG=null;Z.AG=null;Z.qx=null;Z.kT=null;Z.lT=null;Z.$pa=!1;Z.Tib=!1;Z.Sp=null;Z.content=null;Z.q1=0;Z.dte=null;Z.qU=0;Z.zCf=null;Z.Qhe=F;Z.hde=D;Z.AP=J;Z.dHa=R;Z.Ag=D.ownerDocument;Z.jjb=!1;Z.qv=!1;Z.Ajd=!1;return Z}x=b(0);var m=b(14),r=b(82),h=b(156),w=b(13),n=b(91),v=Sys.UI.Control;Am(l,v);l.prototype.show=function(){this.jjb||(this.J5g(),this.qo(),
this.hde.appendChild(this.AW),this.AW.style.display="Block",this.psj(),this.jjb=!0,this.zCf&&this.zCf())};l.prototype.dismiss=function(){this.jjb&&(this.n1a(),this.hde.removeChild(this.AW),this.jjb=!1,this.dHa&&this.dHa())};l.prototype.dispose=function(){this.dismiss();this.kT=this.qx=this.AG=this.npa=this.GG=this.Lqa=null;Sys.Component.prototype.dispose.call(this)};l.prototype.ni=function(F){return this.get_element().id+F};l.prototype.J5g=function(){this.GG=this.Ag.createElement("div");this.GG.id=
this.ni("WACCalloutHeader");this.GG.className="WACCalloutHeader";this.qv&&this.dle();this.Ajd&&this.rme();this.AG=this.Ag.createElement("div");this.AG.id=this.ni("WACCalloutContent");this.AG.className="WACCalloutContent";this.AG.style.width=190<this.q1?this.q1-26+"px":"164px";this.AG.appendChild(this.content);this.AW.appendChild(this.G0b);this.AW.appendChild(this.GG);this.AW.appendChild(this.AG)};l.prototype.dle=function(){this.qx=this.Ag.createElement("a");this.qx.className="WACCalloutCloseAnchor";
this.qx.id=this.ni("WACCalloutCloseAnchor");this.qx.href="#";this.GG.appendChild(this.qx);var F=h.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.qx.appendChild(F)};l.prototype.rme=function(){this.kT=this.Ag.createElement("div");this.kT.className="WACCalloutTitle UIFontBold";this.kT.style.width=190<this.q1?this.q1-30+"px":"160px";this.kT.id=this.ni("WACCalloutTitle");this.kT.innerText=this.title;this.GG.contains(this.qx)?this.GG.insertBefore(this.kT,
this.qx):this.GG.appendChild(this.kT)};l.prototype.psj=function(){var F=this.Qhe;if(1===this.qU){var D=this.dte.y+16;var J=-16}else 2===this.qU||3===this.qU||0===this.qU?(D=F.y+F.height+15,J=-15):(D=F.y-this.AW.clientHeight-15-2,J=this.AW.clientHeight-1);this.AW.style.top=D+"px";this.G0b.style.top=J+"px";1===this.qU?(F=this.dte.x-16,this.AW.style.left="50%",this.AW.style.marginLeft=-this.q1/2+"px",D=Sys.UI.DomElement.getBounds(this.AW),this.G0b.style.left=F-D.x+"px"):(D=F.x+this.Qhe.width/2,2===this.qU||
5===this.qU?(F=20,D-=36):0===this.qU||4===this.qU?(F=this.q1/2-16,D-=this.q1/2):(F=this.q1-20-32,D=D-this.q1+36),this.AW.style.left=D+"px",this.G0b.style.left=F+"px")};l.prototype.qo=function(){this.qv&&!this.lT&&(this.lT=Object(r.a)(this,this.B$,"closeHandler"),this.AP.pa(w.a.click,this.qx,this.lT,null))};l.prototype.n1a=function(){this.qv&&this.lT&&(this.AP.za(w.a.click,this.qx,this.lT),this.lT=null)};l.prototype.B$=function(){this.dismiss();return!0};Ek.Object.defineProperties(l.prototype,{AW:{configurable:!0,
enumerable:!0,get:function(){this.Lqa||(this.Lqa=this.Ag.createElement("div"),this.Lqa.id=this.ni("WACCalloutOuter"),this.Lqa.className="WACCalloutOuter",this.Lqa.setAttribute(n.a.Td,n.a.pZa),this.Lqa.style.width=this.q1+"px");return this.Lqa}},G0b:{configurable:!0,enumerable:!0,get:function(){if(!this.npa){this.npa=this.Ag.createElement("div");this.npa.id=this.ni("WACCalloutBeakContainer");this.npa.className="WACCalloutBeakContainer";var F="CalloutBeakTopFilled_32x16x32";if(5===this.qU||6===this.qU||
4===this.qU)F="CalloutBeakBottomFilled_32x16x32";F=h.createClusteredImage(32,16,F,"WACCalloutBeak",!0,"");this.npa.appendChild(F)}return this.npa},set:function(F){this.npa=F}},hMa:{configurable:!0,enumerable:!0,get:function(){return this.jjb}},title:{configurable:!0,enumerable:!0,get:function(){return this.Sp},set:function(F){this.Sp!==F&&(this.Sp=F,this.kT&&(this.kT.innerText=this.Sp))}},qv:{configurable:!0,enumerable:!0,get:function(){return this.$pa},set:function(F){this.$pa!==F&&(this.$pa=F,this.GG&&
(this.GG.contains(this.qx)&&!this.$pa?this.GG.removeChild(this.qx):!this.GG.contains(this.qx)&&this.$pa&&this.dle()))}},Ajd:{configurable:!0,enumerable:!0,get:function(){return this.Tib},set:function(F){this.Tib!==F&&(this.Tib=F,this.GG&&(this.GG.contains(this.kT)&&!this.Tib?this.GG.removeChild(this.kT):!this.GG.contains(this.kT)&&this.Tib&&this.rme()))}}});Object(x.a)(l,"Callout",Sys.UI.Control,[90]);Am(f,l);f.prototype.show=function(){this.hMa||(this.df.sqc(),this.df.WP(!1),this.kl.style.zIndex=
String(this.df.x2),l.prototype.show.call(this),this.Ck(),this.qbe=window.setTimeout(Object(r.a)(this,this.dismiss,"dismiss"),1E3*this.kJj))};f.prototype.dismiss=function(){this.hMa&&(this.df.KM(!1),this.vm(),this.VXa&&this.VXa.contains(this.kl)&&this.VXa.removeChild(this.kl),l.prototype.dismiss.call(this),window.clearTimeout(this.qbe))};f.prototype.Ck=function(){this.df.Pra(Object(r.a)(this,this.dismiss,"dismiss"));this.df.Qy.pa(w.a.click,this.kl,Object(r.a)(this,this.vd,"onClick"))};f.prototype.vm=
function(){this.df.rbb(Object(r.a)(this,this.dismiss,"dismiss"));this.df.Qy.za(w.a.click,this.kl,Object(r.a)(this,this.vd,"onClick"))};f.prototype.vd=function(){this.dismiss();return!0};f.prototype.eSh=function(F){var D=0;switch(F){case 0:D=190;break;case 1:D=250;break;case 2:D=300;break;case 3:D=360}return D};Object(x.a)(f,"ModalCallout",l,[]);var u=b(629),t=b(203);Am(e,f);e.prototype.show=function(){var F=this;if(!this.hMa){var D=Object.assign(new u.a,{onShow:function(){f.prototype.show.call(F)}});
t.UISurfaces.$Q().then(function(J){var R=J.externalNotification();F.JUb=J.addNotification(R,D);return null},function(J){m.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",J);return null})}};e.prototype.dismiss=function(){var F=this;this.hMa&&this.JUb&&(t.UISurfaces.$Q().then(function(D){D.removeNotification(F.JUb);return F.JUb=null},function(D){m.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",D);return null}),f.prototype.dismiss.call(this))};
Object(x.a)(e,"ReactManagedModalCallout",f,[]);var y=b(4);c.s7g=function(F,D,J){var R=void 0===R?null:R;return y.AFrameworkApplication.ta.Qa.tR?new e(F,D,J,3,y.AFrameworkApplication.ta,R):new f(F,D,J,3,y.AFrameworkApplication.ta,R)};Object(x.a)(c,"ModalCalloutControlFactory",null,[]);var E=b(52),B=b(1069),z=b(643),M=b(1070),Q=b(133),P=b(57),L=b(39),ca=b(85),U=b(1019),aa=b(907);b.d(C,"a",function(){return a});a.MCe=function(F,D,J,R){a.mJ&&a.mJ.hMa&&a.mJ.dismiss();a.mJ=c.s7g(D,F,F);a.mJ.content=J;aa.b(R)||
(a.mJ.title=R,a.mJ.Ajd=!0);F=new Sys.UI.Bounds(0,0,P.a.Dcc(),P.a.Ccc());a.mJ.qU=a.XJh(F,D,a.mJ.q1);a.mJ.show();a.b0b&&a.b0b.sendNotification(J.innerText,!0)};a.j3c=function(F,D,J,R){R=void 0===R?null:R;t.UISurfaces.$Q().then(function(Z){var W=null;a.dlb&&(Z.removeNotification(a.dlb),a.dlb=null);var ka=Z.callout(Object.assign(new B.a,{target:F,title:D,content:J,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new M.a,{onDismiss:function(){Z.removeNotification(W)},
directionalHint:null!=R?R:null})})),ma=Object.assign(new u.a,{expirationOptions:Object.assign(new z.a,{displayTimeoutSeconds:7,onExpire:function(){Z.removeNotification(a.dlb)}})});W=a.dlb=Z.addNotification(ka,ma);return null},function(Z){m.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",Z);return null})};a.DRd=function(F,D){D=void 0===D?null:D;a.mJ&&a.mJ.hMa&&a.mJ.dismiss();var J=new Q.StandardDialog;J.mSa=!1;J.jc=0;J.bA(E.a.iqi,CommonUIStrings.l_DialogError,aa.b(F)?a.mYe():
F,D)};a.FRd=function(F){a.mJ&&a.mJ.hMa&&a.mJ.dismiss();m.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",F.errorCode));var D=aa.b(F.description)?a.mYe():F.description,J=new Q.StandardDialog,R=null;F.vha?(J.jc=1,J.Dc(1,F.buttonText),J.u7(1)):J.jc=0;R=function(Z){1===Z?F.vha():F.mia&&F.mia()};J.mSa=!1;0===F.BLa?J.bA(F.errorCode,F.title?F.title:CommonUIStrings.l_DialogError,D,R):1===F.BLa?J.xX(F.title?F.title:CommonUIStrings.l_DialogWarning,D,R):J.MAa(F.title?
F.title:CommonUIStrings.l_DialogInfo,D,R)};a.XJh=function(F,D,J){var R=4,Z=F.x+F.width-D.x-D.width;D.x-F.x+D.width/2<=J/2?R=5:Z+D.width/2<=J/2&&(R=6);return R};a.tyj=function(F,D,J,R){R=void 0===R?!1:R;var Z=y.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1),W=y.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SkipTeachingCalloutEnabled",!1);(D=U.a.Eub(D))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&
appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(D,function(ka){ka&&(Z&&W&&R||a.j3c(ka,J,F,5))})};a.uyj=function(F,D,J){J=void 0===J?!1:J;a.tyj(D.startedNode?D.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,F),D,D.startedNode?D.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,F),J)};a.syj=function(F,D,J,R){if(a.eeg)F=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,
J,R,CommonUIStrings.l_InsertionDialogRefresh)),a.j3c(D,F,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{D=L.a.hp(D);var Z=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),W=document.createElement("span");W.innerText=Z[0];var ka=document.createElement("span");ka.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,J,R,CommonUIStrings.l_InsertionDialogRefresh);ka.className="UIFontBold";J=document.createElement("span");J.innerText=Z[1];R=document.createElement("div");
Sys.UI.DomElement.addCssClass(R,"ModalCalloutControl");R.appendChild(W);R.appendChild(ka);R.appendChild(J);a.MCe(F,D,R,CommonUIStrings.l_ErrorLoadingAddInsTitle)}};a.Kzj=function(F,D){var J=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,R=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.eeg?a.j3c(D,J,R):(D=L.a.hp(D),a.MCe(F,D,a.ARg(R),J))};a.ARg=function(F){var D=document.createElement("div");Sys.UI.DomElement.addCssClass(D,"ModalCalloutControl");D.innerText=F;return D};
a.mYe=function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};Ek.Object.defineProperties(a,{b0b:{configurable:!0,enumerable:!0,get:function(){return a.Zea||(a.Zea=ca.a.instance.Kh("Common.Utils.IAriaNotifier"))}},eeg:{configurable:!0,enumerable:!0,get:function(){return y.AFrameworkApplication.ta.Qa.Ni&&y.AFrameworkApplication.ta.Qa.tR}}});a.mJ=null;a.dlb=null;a.Zea=null;Object(x.a)(a,"AddInCommandsNotificationFactory",null,[])},1150:function(x,C,b){function a(t,
y,E,B,z){this.Ps=t;this.fJ=E;this.L1=B;this.de=z;this.zhb=this.fJ.Fi;this.Xy=this.zhb.getOsfControl(y);this.$rg=this.Xy.getManifest()}function c(t,y,E,B){this._id=t;this.Ps=y;this.L1=E;this.de=B}function e(t,y,E,B){this.rA=!1;this._id=t;this.Ps=y;this.L1=E;this.de=B}b.r(C);x=b(0);var f=b(14),l=b(1479),m=b(152),r=b(123),h=b(935),w=b(944),n=b(355);e.prototype.setEnabled=function(){};e.prototype._OnAccess=function(){};e.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonButton"};e.prototype.invokePropertyGet=
function(t){switch(t){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};e.prototype.invokePropertyGetAsync=function(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};e.prototype.invokePropertySet=function(t,y){switch(t){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);
};e.prototype.invokePropertySetAsync=function(t,y){this.invokePropertySet(t,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};e.prototype.invokeMethod=function(t,y){switch(t){case 5:return this.dpj(y);case 1:return this.rCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};e.prototype.invokeMethodAsync=function(t,y){t=this.invokeMethod(t,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};e.prototype.dpj=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"boolean");this.setEnabled(t);return null};e.prototype.rCa=function(){this._OnAccess();return null};Ek.Object.defineProperties(e.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.rA},set:function(t){var y=b(1150).DynamicRibbon,E=this.de.OwnerAddinStoreType,B=this.de.PrimaryMarketplace.MarketplaceRef,z={};z=(z.addinAssetId=Telemetry.PrivacyRules.GetAssetId(E,B,this.Ps),z.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(E,B,this.de.OwnerAddinAssetId),z.ownerAddinStoreType=
E,z.ribbonControlType="Button",z.toggle=t,z);m.a.sendTelemetryEvent(Object.assign(new n.a,{name:y.Szc+"ControlUpdate",dataFields:r.a.Il(z)}));this.rA=t;t={};E=(t.DynamicAddinCommandsMethodDispatchId=1,t.SolutionId=this.Ps,t.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(E,B,this.Ps),t.SourceControlId=this.id,t.MethodData=this.rA,t);this.L1.iK(-1014260128,E)}},id:{configurable:!0,enumerable:!0,get:function(){return this._id}},label:{configurable:!0,enumerable:!0,get:function(){return null}}});
Object(x.a)(e,"RibbonButton",null,[]);c.prototype.setVisibility=function(t){var y=b(1150).DynamicRibbon,E=this.de.OwnerAddinStoreType,B=this.de.PrimaryMarketplace.MarketplaceRef,z={};z=(z.addinAssetId=Telemetry.PrivacyRules.GetAssetId(E,B,this.Ps),z.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(E,B,this.de.OwnerAddinAssetId),z.ownerAddinStoreType=E,z.ribbonControlType="Tab",z.toggle=t,z);m.a.sendTelemetryEvent(Object.assign(new n.a,{name:y.Szc+"ControlUpdate",dataFields:r.a.Il(z)}));y={};t=
(y.DynamicAddinCommandsMethodDispatchId=2,y.SolutionId=this.Ps,y.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(E,B,this.Ps),y.StoreType=E,y.SourceControlId=this.id,y.MethodData=t,y);this.L1.iK(-1014260128,t)};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};c.prototype.invokePropertyGet=function(t){switch(t){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};c.prototype.invokePropertyGetAsync=
function(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};c.prototype.invokePropertySet=function(t){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};c.prototype.invokePropertySetAsync=function(t,y){this.invokePropertySet(t,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};c.prototype.invokeMethod=function(t,y){switch(t){case 3:return this.Usj(y);case 1:return this.rCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);
};c.prototype.invokeMethodAsync=function(t,y){t=this.invokeMethod(t,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};c.prototype.Usj=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");this.setVisibility(t);return null};c.prototype.rCa=function(){this._OnAccess();return null};Ek.Object.defineProperties(c.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(x.a)(c,"RibbonTab",null,[]);var v=b(1170),u=b(179);
b.d(C,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=function(t){try{var y={},E=(y.addinAssetId=Telemetry.PrivacyRules.GetAssetId(this.de.OwnerAddinStoreType,this.de.PrimaryMarketplace.MarketplaceRef,this.Ps),y.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(this.de.OwnerAddinStoreType,this.de.PrimaryMarketplace.MarketplaceRef,this.de.OwnerAddinAssetId),y.ownerAddinStoreType=this.de.OwnerAddinStoreType,y.ribbonControlType="Ribbon",y);m.a.sendTelemetryEvent(Object.assign(new n.a,
{name:a.Szc+"ExecuteRequestCreate",dataFields:r.a.Il(E)}));var B=u.a.mi(t);t={};y={};y[h.a.HIa]=this.Xy;y[h.a.IIa]=B;y[h.a.y7c]=this.de;t[h.a.Lsb]=3;t[h.a.c4]=this.Ps;t[h.a.B7b]=Telemetry.PrivacyRules.GetAssetId(this.de.OwnerAddinStoreType,this.de.PrimaryMarketplace.MarketplaceRef,this.Ps);t[h.a.b4]=y;this.L1.iK(-1014260128,t);var z=a.Y$b("ExecuteRequestCreate",!0,"");f.ULS.sendTraceTag(538572826,0,50,z)}catch(M){B=a.Y$b("ExecuteRequestCreate",!1,M.toString()),f.ULS.sendTraceTag(538572825,0,50,B)}return null};
a.prototype.executeRequestUpdate=function(t){try{var y=null,E=null;y=this.de.OwnerAddinStoreType;E=this.de.PrimaryMarketplace.MarketplaceRef;var B={},z=(B.addinAssetId=Telemetry.PrivacyRules.GetAssetId(y,E,this.Ps),B.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(y,E,this.de.OwnerAddinAssetId),B.ownerAddinStoreType=this.de.OwnerAddinStoreType,B.ribbonControlType="Ribbon",B);m.a.sendTelemetryEvent(Object.assign(new n.a,{name:a.Szc+"ExecuteRequestUpdate",dataFields:r.a.Il(z)}));var M=u.a.mi(t);
t={};B={};B[h.a.HIa]=this.Xy;B[h.a.IIa]=M;B[h.a.y7c]=this.de;t[h.a.Lsb]=3;t[h.a.c4]=this.Ps;t[h.a.B7b]=Telemetry.PrivacyRules.GetAssetId(y,E,this.Ps);t[h.a.b4]=B;this.L1.iK(-1014260128,t);var Q=a.Y$b("ExecuteRequestUpdate",!0,"");f.ULS.sendTraceTag(538572824,0,50,Q)}catch(P){y=a.Y$b("ExecuteRequestUpdate",!1,P.toString()),f.ULS.sendTraceTag(538572823,0,50,y)}return null};a.prototype.getButton=function(t){var y=null;if(!this.qcf())return this.OCe();if(t&&0<t.length){if(!this.Uxe(t))return this.gDe(t);
y=new e(t,this.Ps,this.L1,this.de)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)};a.prototype.getTab=function(t){var y=null;if(!this.qcf())return this.OCe();if(this.Xy.getOwnerAddinControlRecreated())return this.H6g();if(t&&0<t.length){if(!this.Uxe(t))return this.gDe(t);y=new c(t,this.Ps,this.L1,this.de)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)};a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};
a.prototype.invokePropertyGet=function(t){switch(t){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};a.prototype.invokePropertyGetAsync=function(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};a.prototype.invokePropertySet=function(t){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};a.prototype.invokePropertySetAsync=function(t,y){this.invokePropertySet(t,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
a.prototype.invokeMethod=function(t){switch(t){case 1:return this.rCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};a.prototype.invokeMethodAsync=function(t,y){switch(t){case 7:return this.oxh(y);case 6:return this.pxh(y);case 3:return this.DJh(y);case 5:return this.DYh(y)}t=this.invokeMethod(t,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};a.prototype.oxh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.executeRequestCreate(t)};
a.prototype.pxh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.executeRequestUpdate(t)};a.prototype.DJh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.getButton(t)};a.prototype.DYh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.getTab(t)};a.prototype.rCa=function(){this._OnAccess();return null};a.prototype.gDe=function(t){return v.a(w.a.o2g,u.a.fa(1734)+
t)};a.prototype.OCe=function(){return v.a(w.a.fhj,u.a.fa(1730))};a.prototype.H6g=function(){return v.a(w.a.hostRestartNeeded,u.a.fa(1735))};a.prototype.qcf=function(){var t=this.Xy.getSharedRuntimeId();t=!!t&&0<t.length;f.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",t));return t};a.prototype.Uxe=function(t){var y=this.$rg.getRibbonExtensionControlMap();return t in y||this.uWg(t)};a.prototype.uWg=function(t){var y=this.gBh();if(y){y=El(y.NJe.tabs);
for(var E=y.next();!E.done;E=y.next()){E=E.value;if(E.id===t)return!0;E=El(E.groups);for(var B=E.next();!B.done;B=E.next()){B=El(B.value.controls);for(var z=B.next();!z.done;z=B.next()){z=z.value;if(z.id===t)return!0;if("Menu"===z.type){z=El(z.items);for(var M=z.next();!M.done;M=z.next())if(M.value.id===t)return!0}}}}}return!1};a.prototype.gBh=function(){return l.a.getInstance().Pia(this.de.PrimaryMarketplace.MarketplaceType,this.de.PrimaryMarketplace.SolutionId,1)};a.Y$b=function(t,y,E){var B={};
B.methodName="DynamicRibbon."+t;B.result=y?"Succeeded":"Failed";B.message=E;return u.a.Kc(B)};Ek.Object.defineProperties(a.prototype,{buttons:{configurable:!0,enumerable:!0,get:function(){return null}}});a.Szc="Office.Online.Extensibility.Ribbon.";Object(x.a)(a,"DynamicRibbon",null,[])},1165:function(x,C,b){function a(){}b.d(C,"a",function(){return a});x=b(0);a.i9b="extId";a.QAe="ComponentType";a.qHa="ComponentId";a.ykd="HostProps";a.Sya="OptionalProps";Object(x.a)(a,"ActionPropertyNames",null,[])},
1167:function(x,C,b){function a(c,e){var f=!1;c&&(c=e.osfControl,(e=c.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!c.getIsUpgrading()&&(f=!0));return f}b.d(C,"a",function(){return a})},1169:function(x,C,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.gha=this.jTa=this.Ted=this.ihd=this.swb=this.mVd=null}b.d(C,"a",function(){return a});x=b(0);Object(x.a)(a,"AppsForOfficeOauthResult",null,[])},1170:function(x,C,b){function a(c,e){return OfficeExtension.WacRuntime.Utility.createPromise(function(f,
l){l(OfficeExtension.WacRuntime.Utility.createRichApiException(c,e))})}b.d(C,"a",function(){return a})},1302:function(x,C,b){function a(qa,Xa,Ha){this.Lwa=!1;this.oF={};this.$=qa;this.xj=Xa;this.rmd().cna();this.indexedDB=Ha;this.indexedDB.tg()&&(this.Lwa=!0,this.indexedDB.initialize(a.wld,a.xld))}function c(qa,Xa){this.WQc=qa;this._message=Xa}function e(){}function f(){}function l(qa){switch(qa){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function m(qa,
Xa){u(b(1302).CustomFunctionsInstaller.q_e("CustomFunctionsRuntimeLogging"),function(Ha){if(Ha.result&&window.console)switch(Ha=l(qa.severity)+" "+qa.message+Xa,qa.severity){case 2:window.console.log&&window.console.log(Ha);break;case 0:window.console.info&&window.console.info(Ha);break;case 1:window.console.error&&window.console.error(Ha)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}function r(qa,Xa,Ha,Ra,mb){Ha=qa.CWCT(function(){Xa(qa)},
Ha,3,Ra);Ha.continueWith(function(){P.ULS.sendTraceTag(537163459,0,10,mb)},4);return Ha}function h(qa,Xa,Ha){return r(qa,Xa,pa.a.none,xa.a.current,Ha)}function w(qa,Xa,Ha,Ra,mb){Ha=qa.CWRCT(function(){return Xa(qa)},Ha,3,Ra);Ha.continueWith(function(){P.ULS.sendTraceTag(537163460,0,10,mb)},4);return Z.TaskExtensions.rBc(Ha)}function n(qa,Xa,Ha){return w(qa,Xa,pa.a.none,xa.a.current,Ha)}function v(qa,Xa,Ha,Ra,mb){Ha=qa.CWRCT(function(){return Xa(qa)},Ha,3,Ra);Ha.continueWith(function(){P.ULS.sendTraceTag(537163461,
0,10,mb)},4);return Ha}function u(qa,Xa,Ha){return v(qa,Xa,pa.a.none,xa.a.current,Ha)}function t(qa,Xa,Ha,Ra,mb){Ha=qa.CWRCT(function(){return Xa(qa)},Ha,3,Ra);Ha.continueWith(function(){P.ULS.sendTraceTag(537163462,0,10,mb)},4);return Z.TaskExtensions.rBc(Ha)}function y(qa,Xa,Ha){return t(qa,Xa,pa.a.none,xa.a.current,Ha)}function E(qa,Xa,Ha,Ra,mb){Ha=qa.CWCT(function(){Xa(qa)},Ha,3,Ra);Ha.continueWith(function(){P.ULS.sendTraceTag(537163463,0,10,mb)},4);return Ha}function B(qa,Xa,Ha){return E(qa,
Xa,pa.a.none,xa.a.current,Ha)}function z(){}function M(qa){qa=qa.split("|");this.Ps=qa[1];this.yRc=qa[2];this.hUd=qa[3]}b.r(C);x=b(0);var Q=b(7),P=b(14),L=b(4),ca=b(161),U=b(202),aa=b(83),F=b(562),D=b(175),J=b(84),R=b(51),Z=b(36),W=b(220),ka=b(119),ma=b(593);Ek.Object.defineProperties(M.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Ps}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.yRc}},needToRestoreManifest:{configurable:!0,enumerable:!0,
get:function(){return this.hUd===OSF.StoreTypeEnum.Registry.toString()}}});Object(x.a)(M,"AddinStoreInfo",null,[]);Object(x.a)(z,"CustomFunctionRegistrationInfos",null,[]);var pa=b(211),xa=b(62),va=b(1167);Object(x.a)(f,"InstallationInfo",null,[]);Object(x.a)(e,"UninstallationInfo",null,[]);var ta=b(28),fa=b(95),Ca=b(35),Sa=b(30),Gb=b(1),kb=b(21),lb=b(291),Nb=b(995),Aa=b(55);Ek.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.WQc}},message:{configurable:!0,
enumerable:!0,get:function(){return this._message}}});Object(x.a)(c,"CustomFunctionLog",null,[]);b.d(C,"CustomFunctionsInstaller",function(){return a});a.prototype.V$e=function(qa,Xa,Ha,Ra){var mb=this;if(Ra.invariantNamespace)for(var La=0;La<Ra.invariantNamespace.length;++La){var ha=Ra.invariantNamespace.charAt(La);if("."!==ha&&"_"!==ha&&"a">ha&&"z"<ha&&"A">ha&&"Z"<ha&&"0">ha&&"9"<ha)throw P.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
ha,La),Error.create("InvariantNamespace validation failed");}return y(this.JSg(Ha,Ra.manifest),function(){return y(mb.SGd(qa),function(Ia){var gb=Ia.result;return(null===gb||void 0===gb?0:gb.isDynamicMetadata)?mb.SHd(qa,Xa,gb,!1,!1,!1):y(mb.kXj(qa,Xa,Ra),function(Sb){var wc;gb=(wc=new f,wc.addinId=Ha,wc.locale=Ra.locale,wc.addinInvariantNamespace=Ra.invariantNamespace,wc.addinNamespace=Ra.namespace,wc.addinTitle=Ra.title,wc.isXllCompatible=Ra.isXllCompatible,wc.metadataContent=JSON.stringify(JSON.parse(Sb.result)),
wc);return mb.SHd(qa,Xa,gb,!1,a.qyh(Ra.osfControl.getStoreType()),va.a(mb.$,Ra))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.X$e=function(qa,Xa,Ha,Ra){var mb=this;if(!a.wrd(Ha))throw P.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),
Error.create("Invalid Metadata JSON");return y(this.SGd(qa),function(La){La=La.result;if(!La&&(La=Ca.a.Nc(mb.UV,qa),!La))throw P.ULS.sendTraceTag(537163550,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetPrivacyCompliantId(qa,Xa,null))),Error.create("Customfunctions dynamic registration failed");La.metadataContent=JSON.stringify(JSON.parse(Ha));La.isDynamicMetadata=!0;
return mb.SHd(qa,Xa,La,!0,!0,Ra)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};a.prototype.Qag=function(qa,Xa){var Ha=this;this.xj.yia();var Ra=Object(Q.a)(new e,{solutionId:qa}),mb=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(qa,Xa,null));return y(this.CId(qa),function(){return y(Ha.JId(qa),function(){return Ha.NXd(Ha.xj,qa,
Xa,Ra)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},mb)};a.prototype.kXj=function(qa,Xa,Ha){var Ra=new ca.a;OSF.OUtil.xhrGet(Ha.metadataUrl,function(mb){mb?Ra.setResult(mb):Ra.setException(Error.create("Invalid manifest"))},function(mb){P.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(qa,Xa,null),mb);Ra.setException(Error.create("Failed to download manifest"))});
return Ra.task};a.prototype.rmd=function(){var qa=this;return y(this.vrc(),function(Xa){var Ha=Xa.result;if(!Ha.length)return Aa.Task.Sa(!0);P.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Xa=new U.a;for(var Ra=[],mb={},La=0;La<Ha.length;mb={ZPb:mb.ZPb},La++)mb.ZPb=Object(aa.a)(String,Ha[La]),Xa.add(u(qa.SGd(mb.ZPb),function(ha){return function(Ia){if(Ia=Ia.result){var gb=Ca.a.Nc(qa.oF,Ia.addinId);gb&&gb===Ia.metadataContent||
(qa.oF[Ia.addinId]=Ia.metadataContent,qa.UV[ha.ZPb]=Ia,Ra.push(Ia))}return!0}}(mb),"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));return n(Aa.Task.WAE(Xa),function(){if(Ra.length){var ha,Ia=(ha=new z,ha.registrationInfos=Ra,ha);return qa.F0b(qa.xj,Ha,Ia)}P.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return Aa.Task.Sa(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},
"CustomFunctionsInstaller::InstallFromCacheAsync failed")};a.prototype.Y$e=function(){var qa=this,Xa=new ca.a;new U.a;var Ha=[],Ra=[];Object.keys(this.UV).forEach(function(mb){mb=Object(aa.a)(String,mb);var La=Ca.a.Nc(qa.UV,mb);Ha.push(La);Ra.push(mb)});if(!Ra.length)return Xa.setResult(!0),Xa.task;Xa=Object(Q.a)(new z,{registrationInfos:Ha});return this.F0b(this.xj,Ra,Xa)};a.prototype.vrc=function(){return u(this.mfd(ma.a.TYa),function(qa){qa=qa.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(qa||
"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(qa||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.wgg=function(qa){return this.ZOd(ma.a.TYa,Sys.Serialization.JavaScriptSerializer.serialize(qa))};a.prototype.SGd=function(qa){return y(this.mfd(ma.a.Z3a(qa)),function(Xa){Xa=Xa.result||"";return 0<Xa.length?Aa.Task.Sa(Sys.Serialization.JavaScriptSerializer.deserialize(Xa,!0)):Aa.Task.Sa(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};
a.prototype.dXj=function(qa,Xa){var Ha=this;return y(this.tLe(qa),function(){return y(Ha.ZOd(ma.a.Z3a(qa),Sys.Serialization.JavaScriptSerializer.serialize(Xa)),function(){return a.$Od(ma.a.jjd,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.CId=function(qa){var Xa=this;return y(this.nOf(qa),function(){return y(Xa.GOf(ma.a.Z3a(qa)),
function(){return y(Xa.vrc(),function(Ha){return Ha.result.length?Aa.Task.Sa(!0):a.$Od(ma.a.jjd,"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.DLf=function(qa){return this.mfd(ma.a.Y3a(qa))};
a.prototype.tgg=function(qa,Xa){var Ha=this;return y(this.tLe(qa),function(){return Ha.ZOd(ma.a.Y3a(qa),Xa)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.JId=function(qa){var Xa=this;return y(this.nOf(qa),function(){return Xa.GOf(ma.a.Y3a(qa))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.tLe=function(qa){var Xa=this;return y(this.vrc(),function(Ha){Ha=Ha.result;
var Ra=qa.toLowerCase();if(Array.contains(Ha,Ra))return Aa.Task.Sa(!0);Ha.push(Ra);return Xa.wgg(Ha)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.nOf=function(qa){var Xa=this;return y(this.vrc(),function(Ha){Ha=Ha.result;var Ra=qa.toLowerCase();return Array.contains(Ha,Ra)?(Ha.splice(Array.indexOf(Ha,Ra),1),Xa.wgg(Ha)):Aa.Task.Sa(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};
a.prototype.JSg=function(qa,Xa){if(Gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return qa=new OSF.AddinIdInfo(qa),qa.needToRestoreManifest()?this.tgg(qa.getSolutionId(),Xa):Aa.Task.Sa(!0);qa=new M(qa);return qa.needToRestoreManifest?this.tgg(qa.solutionId,Xa):Aa.Task.Sa(!0)};a.prototype.Hgj=function(qa){var Xa=this;if(Gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var Ha=new OSF.AddinIdInfo(qa);return Ha.needToRestoreManifest()?
u(this.DLf(Ha.getSolutionId()),function(mb){(mb=mb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Ha.getSolutionId(),Ha.getSolutionVersion(),mb,Xa.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Aa.Task.Sa(!0)}var Ra=new M(qa);return Ra.needToRestoreManifest?u(this.DLf(Ra.solutionId),function(mb){(mb=mb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Ra.solutionId,Ra.solutionVersion,mb,Xa.$.ya.UICultureTag);return!0},
"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Aa.Task.Sa(!0)};a.prototype.GOf=function(qa){return this.Lwa?this.indexedDB.e6c(qa):a.X9i(qa)};a.prototype.ZOd=function(qa,Xa){return this.Lwa?this.indexedDB.hcb(new Nb.a(qa,Xa)):a.$Od(qa,Xa)};a.prototype.mfd=function(qa){return this.Lwa?this.indexedDB.S3a(qa):a.q_e(qa)};a.prototype.SHd=function(qa,Xa,Ha,Ra,mb,La){var ha=this,Ia=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",
Telemetry.PrivacyRules.GetPrivacyCompliantId(qa,Xa,null));return Z.TaskExtensions.rBc(u(this.THd(this.xj,qa,Xa,Ha,!1,Ra,La),function(){return mb?ha.dXj(qa,Ha):Aa.Task.Sa(!0)},Ia))};a.prototype.THd=function(qa,Xa,Ha,Ra,mb,La,ha){var Ia=this;if(!La&&(La=Ca.a.Nc(this.oF,Ra.addinId))&&La===Ra.metadataContent)return Aa.Task.Sa(!0);this.oF[Ra.addinId]=Ra.metadataContent;this.UV[Xa]=Ra;ha||qa.JHb(Xa);qa.yia();return y(this.A7i(Xa,Ha,Ra),function(){return Ia.FFd(Ra.addinId,mb)},"Failed to register functions for customfunction addin")};
a.prototype.A7i=function(qa,Xa,Ha){var Ra=this,mb=new ca.a,La=this.lpb(Ha);return this.Gia(function(ha){Gb.EwaSettings.ma(257)&&m(a.Srb,qa);(ha=ha.Result)&&204===ha.ResponseStatusCode?mb.setResult(!0):(delete Ra.oF[Ha.addinId],delete Ra.UV[qa],B(Ra.CId(qa),function(){B(Ra.JId(qa),function(){Ra.M2f()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",qa,ha?ha.ResponseStatusCode.toString():
"Unknown")),mb.setResult(!1))},function(ha){ha=ka.a.pg(ha.data);P.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(qa,Xa,null),Sa.a.Wc(ha));Gb.EwaSettings.ma(257)&&m(a.Rrb,qa);delete Ra.oF[Ha.addinId];delete Ra.UV[qa];mb.setResult(!1)},La,mb,!0)};a.prototype.F0b=function(qa,Xa,Ha){var Ra=this,mb=new ca.a,La=ta.a.Ta.oe.m;Xa.forEach(function(Ia){Ia=
Object(aa.a)(String,Ia);qa.Axe(Ia)});qa.yia();var ha=this.TYc(Ha);return this.Gia(function(Ia){Gb.EwaSettings.ma(257)&&m(a.Srb,Sys.Serialization.JavaScriptSerializer.serialize(Xa));Ia=Ia.Result;var gb=!0,Sb=Sys.Serialization.JavaScriptSerializer.deserialize(Ia.ResponseBody.toString());Sb=Array.isArray(Sb.value)?Sb.value:null;for(var wc=new U.a,tc={Rea:0};tc.Rea<Sb.length;tc={Rea:tc.Rea},tc.Rea++)if(!Sb[tc.Rea]){gb=!1;var Tb=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",
Ia.ResponseStatusCode);wc.add(y(Ra.CId(Xa[tc.Rea]),function(pb){return function(){delete Ra.oF[Ha.registrationInfos[pb.Rea].addinId];delete Ra.UV[Xa[pb.Rea]];return Ra.JId(Xa[pb.Rea])}}(tc),Tb))}h(Aa.Task.WAE(wc),function(){B(Ra.FFd("",!1),function(){P.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",ta.a.Ta.oe.m-La);gb?mb.setResult(gb):h(Ra.M2f(),function(){mb.setResult(gb)},"Failed to show customfunctions installation error info")},
String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(Ia){Ia=ka.a.pg(Ia.data);P.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",Sa.a.Wc(Ia));Gb.EwaSettings.ma(257)&&m(a.Rrb,Sys.Serialization.JavaScriptSerializer.serialize(Xa));
for(Ia=0;Ia<Ha.registrationInfos.length;Ia++)delete Ra.oF[Ha.registrationInfos[Ia].addinId],delete Ra.UV[Xa[Ia]];mb.setResult(!1)},ha,mb,!0)};a.prototype.NXd=function(qa,Xa,Ha,Ra){var mb=this;return y(this.tOj(qa,Xa,Ha,Ra),function(){return mb.FFd(Ra.solutionId,!1)},"Failed to unregister functions for customfunction addin")};a.prototype.tOj=function(qa,Xa,Ha,Ra){var mb=new ca.a;qa.JHb(Xa);(qa=Ca.a.Nc(this.UV,Xa))&&delete this.oF[qa.addinId];delete this.UV[Xa];Ra=this.dZc(Ra);return this.Gia(function(){Gb.EwaSettings.ma(257)&&
m(a.c5c,Xa);mb.setResult(!0)},function(La){La=ka.a.pg(La.data);P.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(Xa,Ha,null),Sa.a.Wc(La));Gb.EwaSettings.ma(257)&&m(a.b5c,Xa);mb.setResult(!1)},Ra,mb,!1)};a.prototype.Gia=function(qa,Xa,Ha,Ra,mb){function La(){function tc(cb,ob,rc){Gb.EwaSettings.ma(257)&&m(mb?a.a5c:a.d5c,Tb.RequestBody);return J.i(Ia.ua,
"ExecuteRichApiRequest",Ha,lb.b(cb,qa),lb.a(ob,Xa),rc,null,0)}if(ha.wHa()||0<Ia.ua.l4||0<Ia.Lk.l4)return!1;gb&&ha.Cr(gb);Sb&&Ia.Dr(Sb);wc&&Ia.Wz(wc);var Tb=Ha.request,pb=0;Gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Tb.RequestFlags&1&&256!==(Tb.RequestFlags&256)||(pb=16):pb=Tb.RequestFlags&1?0:16;Gb.EwaSettings.qc()?ha.Zt(new D.a(507,0,tc,pb|64)):ha.Zt(new F.a(507,0,tc,pb));return!0}var ha=this.$.userOperationManager,Ia=this.$.na,gb=null,Sb=null,wc=null;
La()||(gb=function(){La()},Sb=function(){La()},wc=function(){La()},ha.Vu(gb),Ia.Bq(Sb),Ia.dz(wc));return Ra.task};a.prototype.lpb=function(qa){var Xa={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Xa.RequestBody=JSON.stringify(qa);Xa.RequestFlags=1;Gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Xa.RequestFlags|=256);qa=this.$.na.ua.Na(1);qa.request=Xa;return qa};a.prototype.TYc=function(qa){var Xa={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",
RequestHeaders:null};Xa.RequestBody=JSON.stringify(qa);Xa.RequestFlags=1;Gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Xa.RequestFlags|=256);qa=this.$.na.ua.Na(1);qa.request=Xa;return qa};a.prototype.dZc=function(qa){var Xa={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Xa.RequestBody=JSON.stringify(qa);Xa.RequestFlags=1;Gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Xa.RequestFlags|=
256);qa=this.$.na.ua.Na(1);qa.request=Xa;return qa};a.prototype.FFd=function(qa,Xa){var Ha=this,Ra=R.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return t(Ra,function(){Ra.result.QKd();return qa&&Xa?Ha.Hgj(qa):Aa.Task.Sa(!0)},this.$.la,W.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.M2f=function(){var qa=new fa.a(1949669462,0,this.$.ed,0,null);return this.$.Ka.Xb(qa)};a.q_e=function(qa){try{return Aa.Task.Sa(localStorage.getItem(qa))}catch(Xa){return P.ULS.sendTraceTag(537163537,
0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",Xa.message||"Unknown"),Aa.Task.Sa(null)}};a.$Od=function(qa,Xa){try{return localStorage.setItem(qa,Xa),Aa.Task.Sa(!0)}catch(Ha){return P.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",Ha.message||"Unknown"),Aa.Task.Sa(!1)}};a.X9i=function(qa){try{return localStorage.removeItem(qa),Aa.Task.Sa(!0)}catch(Xa){return P.ULS.sendTraceTag(537163535,
0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",Xa.message||"Unknown"),Aa.Task.Sa(!1)}};a.qyh=function(qa){return kb.a.equals(qa,"registry",!0)||kb.a.equals(qa,"uploadfiledevcatalog",!0)||L.AFrameworkApplication.userNameUnknown||L.AFrameworkApplication.limitedEdit};a.wrd=function(qa){if(!qa)return!1;try{JSON.parse(qa)}catch(Xa){return!1}return!0};Ek.Object.defineProperties(a.prototype,{UV:{configurable:!0,enumerable:!0,get:function(){return this.xj.UV}}});
a.wld="CustomFunctionCache";a.xld="CustomFunction";a.a5c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Srb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Rrb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.d5c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.c5c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.b5c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(x.a)(a,
"CustomFunctionsInstaller",null,[555])},1304:function(x,C,b){function a(W){this.oF={};this.$=W;this.rmd().cna()}function c(W,ka){this.WQc=W;this._message=ka}function e(){}function f(){}function l(W){switch(W){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function m(W,ka){if(b(1304).CustomFunctionsLegacyInstaller.Lvb("CustomFunctionsRuntimeLogging")&&window.console)switch(ka=l(W.severity)+" "+W.message+ka,W.severity){case 2:window.console.log&&window.console.log(ka);
break;case 0:window.console.info&&window.console.info(ka);break;case 1:window.console.error&&window.console.error(ka)}}function r(){}function h(W){W=W.split("|");this.Ps=W[1];this.yRc=W[2];this.hUd=W[3]}b.r(C);x=b(0);var w=b(7),n=b(14),v=b(1140),u=b(161),t=b(83),y=b(562),E=b(175),B=b(84),z=b(51),M=b(36),Q=b(119),P=b(593),L=b(1167);Ek.Object.defineProperties(h.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Ps}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.yRc}},
needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.hUd===OSF.StoreTypeEnum.Registry.toString()}}});Object(x.a)(h,"AddinStoreInfo",null,[]);Object(x.a)(r,"CustomFunctionRegistrationInfos",null,[]);Object(x.a)(f,"InstallationInfo",null,[]);Object(x.a)(e,"UninstallationInfo",null,[]);var ca=b(157),U=b(35),aa=b(30),F=b(1),D=b(15),J=b(291),R=b(1073),Z=b(55);Ek.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.WQc}},message:{configurable:!0,
enumerable:!0,get:function(){return this._message}}});Object(x.a)(c,"CustomFunctionLog",null,[]);b.d(C,"CustomFunctionsLegacyInstaller",function(){return a});a.prototype.V$e=function(W,ka,ma,pa){var xa=this,va=new u.a;if(pa.invariantNamespace)for(ka=0;ka<pa.invariantNamespace.length;++ka){var ta=pa.invariantNamespace.charAt(ka);if("."!==ta&&"_"!==ta&&"a">ta&&"z"<ta&&"A">ta&&"Z"<ta&&"0">ta&&"9"<ta)return n.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
ta,ka),va.setResult(!1),va.task}a.cacheManifest(ma,pa.manifest);var fa=a.TGd(W);(null===fa||void 0===fa?0:fa.isDynamicMetadata)?this.RHd(W,fa,va,!1,!1):OSF.OUtil.xhrGet(pa.metadataUrl,function(Ca){fa=Object(w.a)(new f,{addinId:ma,locale:pa.locale,addinInvariantNamespace:pa.invariantNamespace,addinNamespace:pa.namespace,addinTitle:pa.title,isXllCompatible:pa.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(Ca))});xa.RHd(W,fa,va,!1,L.a(xa.$,pa))},function(Ca){n.ULS.sendTraceTag(537163528,0,
10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",W,Ca);va.setResult(!1)});return va.task};a.prototype.X$e=function(W,ka,ma,pa){ka=new u.a;if(!a.wrd(ma))return n.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),ka.setResult(!1),ka.task;var xa=a.TGd(W);if(!xa)return n.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),
ka.setResult(!1),ka.task;xa.metadataContent=JSON.stringify(JSON.parse(ma));xa.isDynamicMetadata=!0;this.RHd(W,xa,ka,!0,pa);return ka.task};a.prototype.Qag=function(W){var ka=this,ma=new u.a,pa=z.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);M.TaskExtensions.Ba(pa,function(){var xa=pa.result;xa.yia();var va=Object(w.a)(new e,{solutionId:W});a.DId(W);a.KId(W);M.TaskExtensions.Ba(ka.NXd(xa,W,va),function(ta){ca.b(ta)?ma.setResult(ta.result):(ta.ig?n.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",
W):ta.Oh&&n.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",W),ma.setResult(!1))},ka.$.la,0)},this.$.la,3);return ma.task};a.prototype.rmd=function(){var W=this,ka=new u.a,ma=a.XGd();0<ma.length&&n.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var pa=[];ma.forEach(function(va){va=Object(t.a)(String,va);if(va=a.TGd(va)){var ta=
U.a.Nc(W.oF,va.addinId);ta&&ta===va.metadataContent||(W.oF[va.addinId]=va.metadataContent,pa.push(va))}});if(!pa.length)return ka.setResult(!0),n.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),ka.task;var xa=z.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);M.TaskExtensions.Ba(xa,function(){var va=xa.result,ta=Object(w.a)(new r,{registrationInfos:pa});M.TaskExtensions.Ba(W.F0b(va,ma,ta),function(fa){ca.b(fa)?
ka.setResult(fa.result):(fa.ig?n.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):fa.Oh&&n.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),ka.setResult(!1))},W.$.la,0)},this.$.la,3);return ka.task};a.prototype.Ggj=function(W){W=new h(W);if(W.needToRestoreManifest){var ka=a.a5i(W.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(W.solutionId,
W.solutionVersion,ka,this.$.ya.UICultureTag)}};a.prototype.RHd=function(W,ka,ma,pa,xa){var va=this,ta=z.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);M.TaskExtensions.Ba(ta,function(){M.TaskExtensions.Ba(va.THd(ta.result,W,ka,!1,pa,xa),function(fa){ca.b(fa)?((fa=fa.result)&&a.eXj(W,ka),ma.setResult(fa)):(fa.ig?n.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",W):fa.Oh&&n.ULS.sendTraceTag(537163487,0,10,
"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",W),ma.setResult(!1))},va.$.la,0)},this.$.la,3)};a.prototype.THd=function(W,ka,ma,pa,xa,va){var ta=this;if(!xa&&(xa=U.a.Nc(this.oF,ma.addinId))&&xa===ma.metadataContent)return Z.Task.Sa(!0);this.oF[ma.addinId]=ma.metadataContent;var fa=new u.a;va||W.JHb(ka);W.yia();W=this.lpb(ma);return this.Gia(function(Ca){F.EwaSettings.ma(257)&&m(a.Srb,ka);var Sa=Ca.Result;204===Sa.ResponseStatusCode?M.TaskExtensions.Ba(ta.EFd(fa,
ma.addinId,pa),function(Gb){Gb.ig?ka?n.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",ka):n.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",ma.addinId):Gb.Oh&&(ka?n.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",
ka):n.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",ma.addinId));fa.setResult(!1)},ta.$.la,4):(Ca=function(){delete ta.oF[ma.addinId];a.DId(ka);a.KId(ka);n.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",ka,Sa.ResponseStatusCode);fa.setResult(!1)},Ca=Object(w.a)(new R.a,{BLa:OSF.InfoType.Error,
title:ma.addinTitle,description:String.format(D.a.instance.Ab(153),D.a.instance.fa(1853)),buttonText:D.a.instance.fa(4),vha:Ca,eec:!1,mia:Ca,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),v.a.FRd(Ca))},function(Ca){Ca=Q.a.pg(Ca.data);n.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",ka,aa.a.Wc(Ca));F.EwaSettings.ma(257)&&m(a.Rrb,ka);delete ta.oF[ma.addinId];fa.setResult(!1)},
W,fa,!0)};a.prototype.F0b=function(W,ka,ma){var pa=this,xa=new u.a;ka.forEach(function(ta){ta=Object(t.a)(String,ta);W.Axe(ta)});W.yia();var va=this.TYc(ma);return this.Gia(function(ta){F.EwaSettings.ma(257)&&m(a.Srb,Sys.Serialization.JavaScriptSerializer.serialize(ka));ta=ta.Result;var fa=!0,Ca=Sys.Serialization.JavaScriptSerializer.deserialize(ta.ResponseBody.toString());Ca=Array.isArray(Ca.value)?Ca.value:null;for(var Sa=0;Sa<Ca.length;Sa++)Ca[Sa]||(fa=!1,delete pa.oF[ma.registrationInfos[Sa].addinId],
a.DId(ka[Sa]),a.KId(ka[Sa]),n.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",ka[Sa],ta.ResponseStatusCode));M.TaskExtensions.Ba(pa.EFd(xa,"",!1),function(Gb){Gb.ig?n.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):Gb.Oh&&n.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");
xa.setResult(!1)},pa.$.la,4);xa.setResult(fa)},function(ta){ta=Q.a.pg(ta.data);n.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",Sys.Serialization.JavaScriptSerializer.serialize(ka),aa.a.Wc(ta));F.EwaSettings.ma(257)&&m(a.Rrb,Sys.Serialization.JavaScriptSerializer.serialize(ka));ta=El(ma.registrationInfos);for(var fa=ta.next();!fa.done;fa=ta.next())delete pa.oF[fa.value.addinId];
xa.setResult(!1)},va,xa,!0)};a.prototype.NXd=function(W,ka,ma){var pa=this,xa=new u.a;W.JHb(ka);W=this.dZc(ma);return this.Gia(function(){F.EwaSettings.ma(257)&&m(a.c5c,ka);M.TaskExtensions.Ba(pa.EFd(xa,ma.solutionId,!1),function(va){va.ig?ka&&n.ULS.sendTraceTag(537163473,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",ka):va.Oh&&ka&&n.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",
ka);xa.setResult(!1)},pa.$.la,4)},function(va){va=Q.a.pg(va.data);n.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",ka,aa.a.Wc(va));F.EwaSettings.ma(257)&&m(a.b5c,ka);xa.setResult(!1)},W,xa,!1)};a.prototype.Gia=function(W,ka,ma,pa,xa){function va(){function kb(Aa,qa,Xa){F.EwaSettings.ma(257)&&m(xa?a.a5c:a.d5c,lb.RequestBody);return B.i(fa.ua,"ExecuteRichApiRequest",ma,J.b(Aa,W),
J.a(qa,ka),Xa,null,0)}if(ta.wHa()||0<fa.ua.l4||0<fa.Lk.l4)return!1;Ca&&ta.Cr(Ca);Sa&&fa.Dr(Sa);Gb&&fa.Wz(Gb);var lb=ma.request,Nb=lb.RequestFlags&1?0:16;F.EwaSettings.qc()?ta.Zt(new E.a(507,0,kb,Nb|64)):ta.Zt(new y.a(507,0,kb,Nb));return!0}var ta=this.$.userOperationManager,fa=this.$.na,Ca=null,Sa=null,Gb=null;va()||(Ca=function(){va()},Sa=function(){va()},Gb=function(){va()},ta.Vu(Ca),fa.Bq(Sa),fa.dz(Gb));return pa.task};a.prototype.lpb=function(W){var ka={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",
RequestHeaders:null};ka.RequestBody=JSON.stringify(W);ka.RequestFlags=1;W=this.$.na.ua.Na(1);W.request=ka;return W};a.prototype.TYc=function(W){var ka={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};ka.RequestBody=JSON.stringify(W);ka.RequestFlags=1;W=this.$.na.ua.Na(1);W.request=ka;return W};a.prototype.dZc=function(W){var ka={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ka.RequestBody=JSON.stringify(W);ka.RequestFlags=1;W=this.$.na.ua.Na(1);
W.request=ka;return W};a.prototype.EFd=function(W,ka,ma){var pa=this,xa=z.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);M.TaskExtensions.Ba(xa,function(){xa.result.QKd();ka&&ma&&pa.Ggj(ka);W.setResult(!0)},this.$.la,3);return xa};a.prototype.Y$e=function(){return Z.Task.Sa(!0)};a.XGd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.Lvb(P.a.TYa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.Lvb(P.a.TYa)||"[]"):null)||[]};a.xgg=function(W){a.aPd(P.a.TYa,
Sys.Serialization.JavaScriptSerializer.serialize(W))};a.TGd=function(W){W=a.Lvb(P.a.Z3a(W))||"";return 0<W.length?Sys.Serialization.JavaScriptSerializer.deserialize(W,!0):null};a.eXj=function(W,ka){a.sLe(W);a.aPd(P.a.Z3a(W),Sys.Serialization.JavaScriptSerializer.serialize(ka))};a.DId=function(W){a.mOf(W);a.HOf(P.a.Z3a(W))};a.a5i=function(W){return a.Lvb(P.a.Y3a(W))};a.fXj=function(W,ka){a.sLe(W);a.aPd(P.a.Y3a(W),ka)};a.KId=function(W){a.mOf(W);a.HOf(P.a.Y3a(W))};a.sLe=function(W){var ka=a.XGd();W=
W.toLowerCase();Array.contains(ka,W)||(ka.push(W),a.xgg(ka))};a.mOf=function(W){var ka=a.XGd();W=W.toLowerCase();Array.contains(ka,W)&&(ka.splice(Array.indexOf(ka,W),1),a.xgg(ka))};a.cacheManifest=function(W,ka){W=new h(W);W.needToRestoreManifest&&a.fXj(W.solutionId,ka)};a.Lvb=function(W){try{return localStorage.getItem(W)}catch(ka){return n.ULS.sendTraceTag(537163469,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",ka.message||"Unknown"),
null}};a.aPd=function(W,ka){try{localStorage.setItem(W,ka)}catch(ma){n.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",ma.message||"Unknown")}};a.HOf=function(W){try{localStorage.removeItem(W)}catch(ka){n.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",ka.message||"Unknown")}};a.wrd=function(W){if(!W)return!1;
try{JSON.parse(W)}catch(ka){return!1}return!0};a.a5c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Srb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Rrb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.d5c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.c5c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.b5c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(x.a)(a,
"CustomFunctionsLegacyInstaller",null,[555])},1313:function(x,C,b){function a(L,ca,U,aa,F){this.$=L;this.Je=ca;this.ownerAddinInfo=U;this.Rd=void 0===F?null:F;this.MQa=(void 0===aa?null:aa)||Q.Task.Sa(!0);return this}function c(L){var ca=M.call(this)||this;ca.$Ca="AddInCommandsDialog";ca.Pe=ca.$Ca;ca.jc=5;ca.dialogWidth=695;ca.dialogHeight=438;ca.B1g="100%";ca.y1g="408px";ca.z1g="15px";ca.A1g="0";ca.Osg=L;return ca}function e(L,ca,U,aa,F,D){var J=L.Na(9);J.sharedInfo=ca;return n.i(L,"InsertAgaveTaskpane",
J,U,aa,F,D,0)}function f(){}x=b(0);var l=b(211),m=b(14);Object(x.a)(f,"AddinCommandsHost",null,[]);var r=b(1366),h=b(1431),w=b(1071),n=b(84),v=b(562),u=b(387),t=b(175),y=b(36),E=b(1),B=b(291),z=b(149),M=z.a;Am(c,M);c.prototype.qD=function(){M.prototype.qD.call(this);this.Np.style.width=this.B1g;this.Np.style.height=this.y1g;this.Np.style.marginTop=this.z1g;this.Np.style.padding=this.A1g};c.prototype.IO=function(){M.prototype.IO.call(this);this.Nb.style.width=String.format("{0}px",this.dialogWidth);
this.Nb.style.height=String.format("{0}px",this.dialogHeight)};c.prototype.dispose=function(){M.prototype.dispose.call(this);this.Osg()};Ek.Object.defineProperties(c.prototype,{containerDiv:{configurable:!0,enumerable:!0,get:function(){return this.Np}}});Object(x.a)(c,"AddInCommandsDialog",z.a,[]);var Q=b(55),P=b(62);z=b(98);b.d(C,"a",function(){return a});Am(a,f);a.prototype.t1g=function(){var L=this.MQa;this.MQa=Q.Task.Sa(!0);return L};a.prototype.disposeHost=function(L){this.Je.pQa(L)};a.prototype.setOwnerAddinEToken=
function(L){this.ownerAddinInfo.eToken=L};a.prototype.showTaskpane=function(L,ca,U){var aa=this;m.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var F=null,D=!1,J=(new r.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new w.a,!0)).FFe(L.solutionId.substr(this.ownerAddinInfo.solutionId.length));F=ca.getSharedRuntimeForTaskpane("Workbook",J);D=!!F&&1===F.LifeTime;this.Je.Dxe(D?this.ownerAddinInfo.solutionId:L.solutionId,D?F:null,null)||(this.lmf(D,!0),this.MQa=this.pmd(L,
F,function(R,Z){R?(D&&(R.PrimaryMarketplace.SolutionId=aa.ownerAddinInfo.solutionId,R.SharedRuntime=F),R.WebExtensionOsfControlType=3,aa.Je.H0a(R),U(R.InstanceId,Z),aa.lmf(D,!1),E.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&m.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(m.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),U(null,Z))}))};a.prototype.getSettings=function(L,ca){var U=this.Je.Aaa(L.solutionId);
U?ca(this.Je.FZ(U).OsfPropertyBag):this.MQa=this.pmd(L,null,function(aa){aa?ca(aa.OsfPropertyBag):m.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(L,ca,U){function aa(Z,W,ka){return e(J,R,B.b(Z,F),W,ka,null)}function F(Z){var W=Z.Result,ka=W?W.AgaveData:null;ka?(D.Je.AEe(ka,function(){var ma=new c(function(){D.disposeHost(ka.InstanceId)});ma.initializeAndShow("",null,null);return ma.containerDiv}),U(ka.InstanceId,0)):(m.ULS.sendTraceTag(537170638,
220,10,"ShowDialog: instance id is null."),U(null,Z.Errors?Z.Errors[0].ErrorCause:5001))}var D=this;m.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var J=this.$.na.ua,R=a.Arb(L,this.ownerAddinInfo);E.EwaSettings.qc()?this.MQa=u.a(this.$.userOperationManager,aa,function(Z){return new t.a(500,0,Z,64)},this.Rd):this.MQa=u.a(this.$.userOperationManager,aa,function(Z){return new v.a(500,0,Z)},this.Rd)};a.prototype.createUILessSandbox=function(L,ca,U){var aa=this;m.ULS.sendTraceTag(537170637,
220,50,"UILess action called.");var F=ca.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),D=!!F&&1===F.LifeTime;(ca=this.Je.kBh(D?this.ownerAddinInfo.solutionId:L.solutionId,D?F:null))?U(ca,0):this.MQa=this.pmd(L,F,function(J,R){J?(D?(J.PrimaryMarketplace.SolutionId=aa.ownerAddinInfo.solutionId,J.SharedRuntime=F,J.TaskpaneVisible=!1,J.WebExtensionOsfControlType=3,aa.Je.H0a(J)):(J.WebExtensionOsfControlType=4,aa.Je.AEe(J,function(){a.Seb.ia(J.InstanceId,new h.a);return a.Seb.oa(J.InstanceId).q1a})),
U(J.InstanceId,R)):(m.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),U(null,R))})};a.prototype.pmd=function(L,ca,U){function aa(pa,xa,va){return e(R,Z,B.b(pa,F),xa,va,null)}function F(pa){var xa=pa.Result;(J=xa?xa.AgaveData:null)||U(null,pa.Errors?pa.Errors[0].ErrorCause:5001)}var D=this,J=null,R=this.$.na.ua,Z=a.Arb(L,this.ownerAddinInfo);ca&&(m.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),Z.SharedRuntimeId=ca.Resid);var W=500,ka=0;void 0===Z.IsToBePersisted||
null===Z.IsToBePersisted||Z.IsToBePersisted||(W=538,aa=function(pa,xa,va){m.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(D.ownerAddinInfo.solutionId,D.ownerAddinInfo.storeType,D.ownerAddinInfo.assetId,null,null,D.ownerAddinInfo.storeId));pa=B.b(pa,F);var ta=R.Na(9,null);ta.sharedInfo=Z;return n.i(R,"ShowAgaveTaskpane",ta,pa,xa,va,null,0)},ka=16);if(E.EwaSettings.qc()){ka|=64;var ma=
u.a(this.$.userOperationManager,aa,function(pa){return new t.a(W,0,pa,ka)},this.Rd)}else ma=u.a(this.$.userOperationManager,aa,function(pa){return new v.a(W,0,pa,ka)},this.Rd);return y.TaskExtensions.ts(ma,function(){return J?D.Jtd(R,J.InstanceId,function(pa,xa){if(pa){ca||(J.PrimaryMarketplace.MarketplaceType=L.storeType);J.OwnerAddinSolutionId=D.ownerAddinInfo.solutionId;J.OwnerAddinStoreType=D.ownerAddinInfo.storeType;J.OsfPropertyBag=[];for(xa=0;xa<pa.Settings.length;xa++){var va=[];va[0]=pa.Settings[xa].Name;
va[1]=pa.Settings[xa].Value;J.OsfPropertyBag[xa]=va}U(J,0)}else U(null,xa.Errors?xa.Errors[0].ErrorCause:5001)}):Q.Task.Sa(!1)},l.a.none,3,P.a.current)};a.prototype.Jtd=function(L,ca,U){function aa(D,J,R){D=B.b(D,F);var Z=L.Na(1);Z.controlId=ca;return n.i(L,"DdaLoadSettings",Z,D,J,R,null,0)}function F(D){U(D.Result,D)}return E.EwaSettings.qc()?u.a(this.$.userOperationManager,aa,function(D){return new t.a(501,0,D,80)},this.Rd):u.a(this.$.userOperationManager,aa,function(D){return new v.a(501,0,D,16)},
this.Rd)};a.prototype.lmf=function(L,ca){var U;L&&(null===(U=window.performance)||void 0===U?0:U.memory)&&m.ULS.sendTraceTag(537170630,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",ca,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)};a.showUILessDialog=function(L){a.Seb.xb(L)&&a.Seb.oa(L).initializeAndShowWithTitle()};a.hideUILessDialog=function(L){a.Seb.xb(L)&&
a.Seb.oa(L).hide()};a.Arb=function(L,ca){var U={};U.SolutionId=L.solutionId;U.Version=L.version;U.StoreType=ca.storeType;U.StoreId=L.storeId;U.AssetId=L.solutionId;U.AssetStoreId="omex";U.TargetType=1;U.Width=350;U.OwnerAddinSolutionId=ca.solutionId;U.OwnerAddinStoreType=ca.storeType;U.SharedRuntimeId=null;U.Preload=!1;return U};a.Seb=new z.a;Object(x.a)(a,"WACExcelAddinCommandsHost",f,[])},1352:function(x,C,b){function a(c,e,f,l){this._id=c;this.xwg=e;this.uhe=f;this.QUa=l}b.d(C,"a",function(){return a});
x=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.xwg};a.prototype.getStoreType=function(){return this.uhe};Object(x.a)(a,"ExtensionIdentity",null,[352])},1353:function(x,C,b){function a(c,e,f){this.tae=f}b.d(C,"a",function(){return a});x=b(0);Object(x.a)(a,"HostProperties",null,[])},1354:function(x,C,b){function a(){this.oi={};this.pr={}}b.d(C,"a",function(){return a});x=b(0);Object(x.a)(a,"ExtensionLaunchProperties",null,[])},1355:function(x,C,b){function a(){this.La=
r.AFrameworkApplication.Ib}b.d(C,"a",function(){return a});x=b(0);var c=b(1352),e=b(1354),f=b(1165),l=b(1357),m=b(1353),r=b(4),h=b(636),w=b(27);a.prototype.yNa=function(n,v,u,t,y){this.zqi(n,v,u,t,y)};a.prototype.zqi=function(n,v,u,t,y){var E=b(1356).ExtensionComponentInstance,B={};B[f.a.i9b]=n;B[f.a.QAe]=v;B[f.a.qHa]=u;B[f.a.ykd]=t;B[f.a.Sya]=y;t=8;if(r.AFrameworkApplication.Rli(n.getId()))switch(v){case l.a.action:t=this.La.ve(w.a.dRe,2,B);break;case l.a.taskpane:t=this.La.ve(w.a.U2f,2,B);break;
case l.a.qkj:t=this.La.ve(w.a.Sqi,2,B);break;default:t=16}32===t?(t=h.a.create().toString(),y.oi.InstanceToken&&(t=y.oi.InstanceToken),n=new E(n,v,u,t),a.cw[t]=n):n=new E(n,v,u,null);n.Enj(B)};a.prototype.yqi=function(n){var v=n.ExtId,u=n.ComponentType,t=n.ComponentId,y=n.HostProps;n=n.OptionalProps;v=new c.a(v.Id,v.StoreId,v.StoreType,v.AppVersion);y=new m.a(y.HostType,y.FormFactor,y.Locale);var E=new e.a;E.oi=n.OptionalProperties;E.pr=n.DevProperties;a.instance.yNa(v,u,t,y,E)};a.prototype.getInstance=
function(n){return a.cw[n]};a.prototype.T9i=function(n){delete a.cw[n]};Ek.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.pIc||(a.pIc=new a);return a.pIc}}});a.pIc=null;a.cw={};Object(x.a)(a,"ExtensionLifeCycleManager",null,[353])},1356:function(x,C,b){function a(l,m,r,h){this.QUa=this.wG=null;this._id=l;this.mmg=r;this.hqg=h;this.La=e.AFrameworkApplication.Ib?e.AFrameworkApplication.Ib:null}b.r(C);b.d(C,"ExtensionComponentInstance",function(){return a});x=b(0);
var c=b(1355),e=b(4),f=b(27);a.prototype.Bdd=function(){return this.mmg};a.prototype.Enj=function(l){this.wG=l};a.prototype.stop=function(){var l=this.La.ve(f.a.ZYg,2,this.wG);c.a.instance.T9i(this.hqg);return 32===l};a.prototype.Ytc=function(){this.La.ve(f.a.aTf,2,this.wG)};Ek.Object.defineProperties(a.prototype,{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.QUa}}});Object(x.a)(a,"ExtensionComponentInstance",null,[376])},1357:function(x,C,b){function a(){}b.d(C,"a",function(){return a});
x=b(0);a.taskpane="Taskpane";a.action="Action";a.qkj="SDXDialog";Object(x.a)(a,"ComponentTypeNames",null,[])},1358:function(x,C,b){(function(a){function c(P,L,ca){var U=Q.call(this)||this;U.i9e=r.a.getTypeName();U.Rd=null;U.DU=null;U.Lxb=null;U.imageWidth=0;U.imageHeight=0;U.tableData=null;U.errorMessage=null;U.yLa=null;U.Fkd=0;U.xTc=!1;U.OFe=function(aa){if(aa){var F={};if(function(){var ka=z.d(U.Kbh(aa.data));F=ka.dv;return ka}().returnValue){var D=Object(m.a)(Object,F);if("."===D.DataFromPictureWildcard)if(D.SessionId!==
U.yLa)f.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(f.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),D.CmdType){case "ACK":U.xTc=!0;U.b8f.stop();f.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");U.lmj();
0<U.errorMessage.length?U.RWf():0<U.tableData.length&&U.hXf();break;case "insert_html":var J=U.$.na.ua,R={},Z=B.g(U.$).ha.sa.qd.clone();R.PasteId=l.a.create().toString();R.DestinationRanges=n.s(n.v(Z,U.$));Z=D.Parameters.split("|",3);f.ULS.sendTraceTag(523805136,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:{0}|{1}|{2}.",Z[0],Z[1],Z[2]);Z=D.Parameters.indexOf("|");Z=D.Parameters.indexOf("|",Z+1);Z=D.Parameters.indexOf("|",Z+1);R.SourceHtml=D.Parameters.substring(Z+
1);R.CopyOperationId=null;var W=J.Na(1,J.hc());W.pasteHtmlParameters=R;v.a(U.$.userOperationManager,function(ka,ma,pa){return t.i(J,"pasteHtmlContent",W,ka,ma,pa,null,64)},function(ka){return new u.a(204,0,ka,1)},null);U.Fkd++;f.ULS.sendTraceTag(523805135,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:{0}",U.Fkd.toString())}}}};U.W7h=function(aa,F){if(aa=F.UG)if(!F.parentPath||1>=F.parentPath.length||F.parentPath[1]!==U.yLa)f.ULS.sendTraceTag(523805124,
0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{f.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");F=aa.errorCode;switch(F){case null:case -1:U.errorMessage=E.a.instance.fa(2217);break;case 1:U.errorMessage=E.a.instance.fa(2218);break;case 2:U.errorMessage=E.a.instance.fa(2219)}0<U.errorMessage.length&&f.ULS.sendTraceTag(523805122,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:{0}.",
F?F.toString():"null");U.Fpe.stop();U.tableData=aa.html;U.xTc&&(0<U.errorMessage.length?U.RWf():0<U.tableData.length&&U.hXf())}else f.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};U.$=P;U.augmentationLoopManager=L;U.uploaderCreator=ca;U.initialize();return U}b.d(C,"a",function(){return c});var e=b(0),f=b(14),l=b(176),m=b(83),r=b(1363),h=b(38),w=b(244),n=b(46),v=b(387),u=b(175),t=b(84),y=b(95),E=b(15),B=b(22),z=b(41),M=b(1364),
Q=h.a;Am(c,Q);c.prototype.dispose=function(){window.removeEventListener("message",this.OFe,!1);Q.prototype.dispose.call(this)};c.prototype.$Ri=function(P,L){var ca=this;f.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");var U=new Image;U.onload=function(){var aa=document.createElement("canvas");aa.width=U.width;aa.height=U.height;var F=aa.getContext("2d");try{F.drawImage(U,0,0,U.width,U.height)}catch(R){f.ULS.sendTraceTag(523805145,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: {0}",
R.message);return}try{var D=aa.toDataURL("image/jpeg")}catch(R){f.ULS.sendTraceTag(523805144,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: {0}",R.message);return}aa=D.split(",");if(2>aa.length)f.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{aa=aa[1];try{var J=window.self.atob(aa)}catch(R){f.ULS.sendTraceTag(523805142,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: {0}",
R.message);return}28E5<J.length?(f.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),L.Zyj()):(ca.rij(ca.Rd,ca.DU,aa,U.width,U.height),URL.revokeObjectURL(U.src),U=null,f.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};U.src=P};c.prototype.g_i=function(P,L,ca,U){this.Rd=P;this.DU=U;this.uploaderCreator.C$h(this.$,L,ca,U,this)};c.prototype.rij=function(P,L,ca,U,aa){this.yLa=l.a.create().toString();
this.Fkd=0;this.Lxb=ca;this.imageWidth=U;this.imageHeight=aa;this.errorMessage=this.tableData="";this.xTc=!1;this.b8f=this.$.Ob.$g("LoadResource","DataFromPictureTaskpaneLaunch");this.b8f.start();this.CUi(P,L);this.Fpe=this.$.Ob.$g("LoadResource","DataFromPictureAnnotation");this.Fpe.start();this.rTj()};c.prototype.rTj=function(){if(this.Lxb.length){var P=window.self.atob(this.Lxb);for(var L=new Uint8Array(P.length),ca=0;ca<P.length;ca++)L[ca]=P.charCodeAt(ca);this.augmentationLoopManager.qTj(L,this.yLa,
this.imageWidth,this.imageHeight)}else f.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")};c.prototype.CUi=function(P,L){L.SessionID=this.yLa;L.DataFromPictureAssetId="FA000000050";L.LoadDataFromPictureTaskpane=!0;P=new y.a(-859308420,P.method,P.mode,P.Ye,P.tabName);this.$.Ka.Xb(P,L)};c.prototype.a8c=function(P){try{var L=a.from(P,"utf16le").toString("base64");return M.a.DHa(this.yLa,L)}catch(ca){return f.ULS.sendTraceTag(523805133,
0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message.",ca.message),""}};c.prototype.Kbh=function(P){try{var L=M.a.DHa(this.yLa,P);return a.from(L,"base64").toString("utf16le")}catch(ca){return f.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message.",ca.message),""}};c.prototype.lmj=function(){if(this.Lxb.length){var P=w.a(this.$).Aaa("FA000000050"),L={};L=(L.DataFromPictureWildcard=".",L);L.imageData=this.a8c(this.Lxb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(P,
"onCustomMessage",L,function(ca){ca&&f.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else f.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};c.prototype.hXf=function(){if(this.tableData.length){var P=w.a(this.$).Aaa("FA000000050"),L={};L=(L.DataFromPictureWildcard=".",L);L.tableHtml=this.a8c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(P,
"onCustomMessage",L,function(ca){ca&&f.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else f.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};c.prototype.RWf=function(){if(this.errorMessage.length){var P=w.a(this.$).Aaa("FA000000050"),L={};L=(L.DataFromPictureWildcard=".",L);L.errorMessage=this.a8c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(P,
"onCustomMessage",L,function(ca){ca&&f.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else f.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};c.prototype.initialize=function(){window.addEventListener("message",this.OFe,!1);this.augmentationLoopManager.activateAnnotation(this.i9e);this.augmentationLoopManager.jM(this.i9e,
this.W7h)};Object(e.a)(c,"DataFromPictureManager",h.a,[598])}).call(this,b(1359).hhg)},1359:function(x,C,b){(function(a){function c(){try{var aa=new Uint8Array(1);aa.__proto__={__proto__:Uint8Array.prototype,ybd:function(){return 42}};return 42===aa.ybd()&&"function"===typeof aa.subarray&&0===aa.subarray(1,1).byteLength}catch(F){return!1}}function e(aa,F){if((f.lP?2147483647:1073741823)<F)throw new RangeError("Invalid typed array length");f.lP?(aa=new Uint8Array(F),aa.__proto__=f.prototype):(null===
aa&&(aa=new f(F)),aa.length=F);return aa}function f(aa,F,D){if(!(f.lP||this instanceof f))return new f(aa,F,D);if("number"===typeof aa){if("string"===typeof F)throw Error("If encoding is specified then the first argument must be a string");return r(this,aa)}return l(this,aa,F,D)}function l(aa,F,D,J){if("number"===typeof F)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&F instanceof ArrayBuffer){F.byteLength;if(0>D||F.byteLength<D)throw new RangeError("'offset' is out of bounds");
if(F.byteLength<D+(J||0))throw new RangeError("'length' is out of bounds");F=void 0===D&&void 0===J?new Uint8Array(F):void 0===J?new Uint8Array(F,D):new Uint8Array(F,D,J);f.lP?(aa=F,aa.__proto__=f.prototype):aa=h(aa,F);F=aa}else if("string"===typeof F){J=aa;aa=D;if("string"!==typeof aa||""===aa)aa="utf8";if(!f.vcf(aa))throw new TypeError('"encoding" must be a valid string encoding');D=v(F,aa)|0;J=e(J,D);F=J.write(F,aa);F!==D&&(J=J.slice(0,F));F=J}else F=w(aa,F);return F}function m(aa){if("number"!==
typeof aa)throw new TypeError('"size" argument must be a number');if(0>aa)throw new RangeError('"size" argument must not be negative');}function r(aa,F){m(F);aa=e(aa,0>F?0:n(F)|0);if(!f.lP)for(var D=0;D<F;++D)aa[D]=0;return aa}function h(aa,F){var D=0>F.length?0:n(F.length)|0;aa=e(aa,D);for(var J=0;J<D;J+=1)aa[J]=F[J]&255;return aa}function w(aa,F){if(f.isBuffer(F)){var D=n(F.length)|0;aa=e(aa,D);if(0===aa.length)return aa;F.copy(aa,0,0,D);return aa}if(F){if("undefined"!==typeof ArrayBuffer&&F.buffer instanceof
ArrayBuffer||"length"in F)return(D="number"!==typeof F.length)||(D=F.length,D=D!==D),D?e(aa,0):h(aa,F);if("Buffer"===F.type&&L(F.data))return h(aa,F.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function n(aa){if(aa>=(f.lP?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.lP?2147483647:1073741823).toString(16)+" bytes");return aa|0}function v(aa,F){if(f.isBuffer(aa))return aa.length;
if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(aa)||aa instanceof ArrayBuffer))return aa.byteLength;"string"!==typeof aa&&(aa=""+aa);var D=aa.length;if(0===D)return 0;for(var J=!1;;)switch(F){case "ascii":case "latin1":case "binary":return D;case "utf8":case "utf-8":case void 0:return B(aa).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*D;case "hex":return D>>>1;case "base64":return M(aa).length;default:if(J)return B(aa).length;
F=(""+F).toLowerCase();J=!0}}function u(aa,F,D){var J=!1;if(void 0===F||0>F)F=0;if(F>this.length)return"";if(void 0===D||D>this.length)D=this.length;if(0>=D)return"";D>>>=0;F>>>=0;if(D<=F)return"";for(aa||(aa="utf8");;)switch(aa){case "hex":aa=F;F=D;D=this.length;if(!aa||0>aa)aa=0;if(!F||0>F||F>D)F=D;J="";for(D=aa;D<F;++D)aa=J,J=this[D],J=16>J?"0"+J.toString(16):J.toString(16),J=aa+J;return J;case "utf8":case "utf-8":return E(this,F,D);case "ascii":aa="";for(D=Math.min(this.length,D);F<D;++F)aa+=
String.fromCharCode(this[F]&127);return aa;case "latin1":case "binary":aa="";for(D=Math.min(this.length,D);F<D;++F)aa+=String.fromCharCode(this[F]);return aa;case "base64":return 0===F&&D===this.length?P.aVe(this):P.aVe(this.slice(F,D));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":F=this.slice(F,D);D="";for(aa=0;aa<F.length;aa+=2)D+=String.fromCharCode(F[aa]+256*F[aa+1]);return D;default:if(J)throw new TypeError("Unknown encoding: "+aa);aa=(aa+"").toLowerCase();J=!0}}function t(aa,F,D,
J,R){if(0===aa.length)return-1;"string"===typeof D?(J=D,D=0):2147483647<D?D=2147483647:-2147483648>D&&(D=-2147483648);D=+D;isNaN(D)&&(D=R?0:aa.length-1);0>D&&(D=aa.length+D);if(D>=aa.length){if(R)return-1;D=aa.length-1}else if(0>D)if(R)D=0;else return-1;"string"===typeof F&&(F=f.from(F,J));if(f.isBuffer(F))return 0===F.length?-1:y(aa,F,D,J,R);if("number"===typeof F)return F&=255,f.lP&&"function"===typeof Uint8Array.prototype.indexOf?R?Uint8Array.prototype.indexOf.call(aa,F,D):Uint8Array.prototype.lastIndexOf.call(aa,
F,D):y(aa,[F],D,J,R);throw new TypeError("val must be string, number or Buffer");}function y(aa,F,D,J,R){function Z(pa,xa){return 1===W?pa[xa]:pa.n5i(xa*W)}var W=1,ka=aa.length,ma=F.length;if(void 0!==J&&(J=String(J).toLowerCase(),"ucs2"===J||"ucs-2"===J||"utf16le"===J||"utf-16le"===J)){if(2>aa.length||2>F.length)return-1;W=2;ka/=2;ma/=2;D/=2}if(R)for(J=-1;D<ka;D++)if(Z(aa,D)===Z(F,-1===J?0:D-J)){if(-1===J&&(J=D),D-J+1===ma)return J*W}else-1!==J&&(D-=D-J),J=-1;else for(D+ma>ka&&(D=ka-ma);0<=D;D--){ka=
!0;for(J=0;J<ma;J++)if(Z(aa,D+J)!==Z(F,J)){ka=!1;break}if(ka)return D}return-1}function E(aa,F,D){D=Math.min(aa.length,D);for(var J=[];F<D;){var R=aa[F],Z=null,W=239<R?4:223<R?3:191<R?2:1;if(F+W<=D)switch(W){case 1:128>R&&(Z=R);break;case 2:var ka=aa[F+1];128===(ka&192)&&(R=(R&31)<<6|ka&63,127<R&&(Z=R));break;case 3:ka=aa[F+1];var ma=aa[F+2];128===(ka&192)&&128===(ma&192)&&(R=(R&15)<<12|(ka&63)<<6|ma&63,2047<R&&(55296>R||57343<R)&&(Z=R));break;case 4:ka=aa[F+1];ma=aa[F+2];var pa=aa[F+3];128===(ka&
192)&&128===(ma&192)&&128===(pa&192)&&(R=(R&15)<<18|(ka&63)<<12|(ma&63)<<6|pa&63,65535<R&&1114112>R&&(Z=R))}null===Z?(Z=65533,W=1):65535<Z&&(Z-=65536,J.push(Z>>>10&1023|55296),Z=56320|Z&1023);J.push(Z);F+=W}aa=J.length;if(aa<=ca)J=String.fromCharCode.apply(String,J);else{D="";for(F=0;F<aa;)D+=String.fromCharCode.apply(String,J.slice(F,F+=ca));J=D}return J}function B(aa,F){F=F||Infinity;for(var D,J=aa.length,R=null,Z=[],W=0;W<J;++W){D=aa.charCodeAt(W);if(55295<D&&57344>D){if(!R){if(56319<D){-1<(F-=
3)&&Z.push(239,191,189);continue}else if(W+1===J){-1<(F-=3)&&Z.push(239,191,189);continue}R=D;continue}if(56320>D){-1<(F-=3)&&Z.push(239,191,189);R=D;continue}D=(R-55296<<10|D-56320)+65536}else R&&-1<(F-=3)&&Z.push(239,191,189);R=null;if(128>D){if(0>--F)break;Z.push(D)}else if(2048>D){if(0>(F-=2))break;Z.push(D>>6|192,D&63|128)}else if(65536>D){if(0>(F-=3))break;Z.push(D>>12|224,D>>6&63|128,D&63|128)}else if(1114112>D){if(0>(F-=4))break;Z.push(D>>18|240,D>>12&63|128,D>>6&63|128,D&63|128)}else throw Error("Invalid code point");
}return Z}function z(aa){for(var F=[],D=0;D<aa.length;++D)F.push(aa.charCodeAt(D)&255);return F}function M(aa){var F=P,D=F.vJj;aa=(aa.trim?aa.trim():aa.replace(/^\s+|\s+$/g,"")).replace(U,"");if(2>aa.length)aa="";else for(;0!==aa.length%4;)aa+="=";return D.call(F,aa)}function Q(aa,F,D,J){for(var R=0;R<J&&!(R+D>=F.length||R>=aa.length);++R)F[R+D]=aa[R];return R}var P=b(1360);b(1361);var L=b(1362);C.hhg=f;C.kYj=function(aa){+aa!=aa&&(aa=0);return f.cpe(+aa)};C.RXj=50;f.lP=void 0!==a.lP?a.lP:c();C.JZj=
f.lP?2147483647:1073741823;f.from=function(aa,F,D){return l(null,aa,F,D)};f.lP&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.cpe=function(aa){m(aa);return e(null,aa)};f.zIg=function(aa){return r(null,aa)};f.isBuffer=function(aa){return!(null==aa||!aa.sqg)};f.compare=function(aa,F){if(!f.isBuffer(aa)||!f.isBuffer(F))throw new TypeError("Arguments must be Buffers");
if(aa===F)return 0;for(var D=aa.length,J=F.length,R=0,Z=Math.min(D,J);R<Z;++R)if(aa[R]!==F[R]){D=aa[R];J=F[R];break}return D<J?-1:J<D?1:0};f.vcf=function(aa){switch(String(aa).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};f.concat=function(aa,F){if(!L(aa))throw new TypeError('"list" argument must be an Array of Buffers');if(0===aa.length)return f.cpe(0);var D;
if(void 0===F)for(D=F=0;D<aa.length;++D)F+=aa[D].length;F=f.zIg(F);var J=0;for(D=0;D<aa.length;++D){var R=aa[D];if(!f.isBuffer(R))throw new TypeError('"list" argument must be an Array of Buffers');R.copy(F,J);J+=R.length}return F};f.byteLength=v;f.prototype.sqg=!0;f.prototype.toString=function(){var aa=this.length|0;return 0===aa?"":0===arguments.length?E(this,0,aa):u.apply(this,arguments)};f.prototype.equals=function(aa){if(!f.isBuffer(aa))throw new TypeError("Argument must be a Buffer");return this===
aa?!0:0===f.compare(this,aa)};f.prototype.compare=function(aa,F,D,J,R){if(!f.isBuffer(aa))throw new TypeError("Argument must be a Buffer");void 0===F&&(F=0);void 0===D&&(D=aa?aa.length:0);void 0===J&&(J=0);void 0===R&&(R=this.length);if(0>F||D>aa.length||0>J||R>this.length)throw new RangeError("out of range index");if(J>=R&&F>=D)return 0;if(J>=R)return-1;if(F>=D)return 1;F>>>=0;D>>>=0;J>>>=0;R>>>=0;if(this===aa)return 0;var Z=R-J,W=D-F,ka=Math.min(Z,W);J=this.slice(J,R);aa=aa.slice(F,D);for(F=0;F<
ka;++F)if(J[F]!==aa[F]){Z=J[F];W=aa[F];break}return Z<W?-1:W<Z?1:0};f.prototype.includes=function(aa,F,D){return-1!==this.indexOf(aa,F,D)};f.prototype.indexOf=function(aa,F,D){return t(this,aa,F,D,!0)};f.prototype.lastIndexOf=function(aa,F,D){return t(this,aa,F,D,!1)};f.prototype.write=function(aa,F,D,J){if(void 0===F)J="utf8",D=this.length,F=0;else if(void 0===D&&"string"===typeof F)J=F,D=this.length,F=0;else if(isFinite(F))F|=0,isFinite(D)?(D|=0,void 0===J&&(J="utf8")):(J=D,D=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var R=this.length-F;if(void 0===D||D>R)D=R;if(0<aa.length&&(0>D||0>F)||F>this.length)throw new RangeError("Attempt to write outside buffer bounds");J||(J="utf8");for(R=!1;;)switch(J){case "hex":F=Number(F)||0;J=this.length-F;D?(D=Number(D),D>J&&(D=J)):D=J;J=aa.length;if(0!==J%2)throw new TypeError("Invalid hex string");D>J/2&&(D=J/2);for(J=0;J<D;++J){R=parseInt(aa.substr(2*J,2),16);if(isNaN(R))break;this[F+J]=R}return J;case "utf8":case "utf-8":return Q(B(aa,this.length-F),this,F,D);case "ascii":return Q(z(aa),
this,F,D);case "latin1":case "binary":return Q(z(aa),this,F,D);case "base64":return Q(M(aa),this,F,D);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":J=aa;R=this.length-F;for(var Z=[],W=0;W<J.length&&!(0>(R-=2));++W){var ka=J.charCodeAt(W);aa=ka>>8;ka%=256;Z.push(ka);Z.push(aa)}return Q(Z,this,F,D);default:if(R)throw new TypeError("Unknown encoding: "+J);J=(""+J).toLowerCase();R=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.oYj||this,0)}};var ca=
4096;f.prototype.slice=function(aa,F){var D=this.length;aa=~~aa;F=void 0===F?D:~~F;0>aa?(aa+=D,0>aa&&(aa=0)):aa>D&&(aa=D);0>F?(F+=D,0>F&&(F=0)):F>D&&(F=D);F<aa&&(F=aa);if(f.lP)F=this.subarray(aa,F),F.__proto__=f.prototype;else{D=F-aa;F=new f(D,void 0);for(var J=0;J<D;++J)F[J]=this[J+aa]}return F};f.prototype.n5i=function(aa){if(0!==aa%1||0>aa)throw new RangeError("offset is not uint");if(aa+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[aa]<<8|this[aa+1]};
f.prototype.copy=function(aa,F,D,J){D||(D=0);J||0===J||(J=this.length);F>=aa.length&&(F=aa.length);F||(F=0);0<J&&J<D&&(J=D);if(J===D||0===aa.length||0===this.length)return 0;if(0>F)throw new RangeError("targetStart out of bounds");if(0>D||D>=this.length)throw new RangeError("sourceStart out of bounds");if(0>J)throw new RangeError("sourceEnd out of bounds");J>this.length&&(J=this.length);aa.length-F<J-D&&(J=aa.length-F+D);var R=J-D;if(this===aa&&D<F&&F<J)for(J=R-1;0<=J;--J)aa[J+F]=this[J+D];else if(1E3>
R||!f.lP)for(J=0;J<R;++J)aa[J+F]=this[J+D];else Uint8Array.prototype.set.call(aa,this.subarray(D,D+R),F);return R};f.prototype.fill=function(aa,F,D,J){if("string"===typeof aa){"string"===typeof F?(J=F,F=0,D=this.length):"string"===typeof D&&(J=D,D=this.length);if(1===aa.length){var R=aa.charCodeAt(0);256>R&&(aa=R)}if(void 0!==J&&"string"!==typeof J)throw new TypeError("encoding must be a string");if("string"===typeof J&&!f.vcf(J))throw new TypeError("Unknown encoding: "+J);}else"number"===typeof aa&&
(aa&=255);if(0>F||this.length<F||this.length<D)throw new RangeError("Out of range index");if(D<=F)return this;F>>>=0;D=void 0===D?this.length:D>>>0;aa||(aa=0);if("number"===typeof aa)for(J=F;J<D;++J)this[J]=aa;else for(aa=f.isBuffer(aa)?aa:B((new f(aa,J)).toString()),R=aa.length,J=0;J<D-F;++J)this[J+F]=aa[J%R];return this};var U=/[^+\/0-9A-Za-z-_]/g}).call(this,b(744))},1360:function(x,C){function b(f){var l=f.length;if(0<l%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");
-1===f&&(f=l);return[f,f===l?0:4-f%4]}C.byteLength=function(f){f=b(f);var l=f[1];return 3*(f[0]+l)/4-l};C.vJj=function(f){var l=b(f);var m=l[0];l=l[1];var r=new e(3*(m+l)/4-l),h=0,w=0<l?m-4:m,n;for(n=0;n<w;n+=4)m=c[f.charCodeAt(n)]<<18|c[f.charCodeAt(n+1)]<<12|c[f.charCodeAt(n+2)]<<6|c[f.charCodeAt(n+3)],r[h++]=m>>16&255,r[h++]=m>>8&255,r[h++]=m&255;2===l&&(m=c[f.charCodeAt(n)]<<2|c[f.charCodeAt(n+1)]>>4,r[h++]=m&255);1===l&&(m=c[f.charCodeAt(n)]<<10|c[f.charCodeAt(n+1)]<<4|c[f.charCodeAt(n+2)]>>
2,r[h++]=m>>8&255,r[h++]=m&255);return r};C.aVe=function(f){for(var l=f.length,m=l%3,r=[],h=0,w=l-m;h<w;h+=16383){for(var n=r,v=n.push,u,t=f,y=h+16383>w?w:h+16383,E=[],B=h;B<y;B+=3)u=(t[B]<<16&16711680)+(t[B+1]<<8&65280)+(t[B+2]&255),E.push(a[u>>18&63]+a[u>>12&63]+a[u>>6&63]+a[u&63]);u=E.join("");v.call(n,u)}1===m?(f=f[l-1],r.push(a[f>>2]+a[f<<4&63]+"==")):2===m&&(f=(f[l-2]<<8)+f[l-1],r.push(a[f>>10]+a[f>>4&63]+a[f<<2&63]+"="));return r.join("")};var a=[],c=[],e="undefined"!==typeof Uint8Array?Uint8Array:
Array;for(x=0;64>x;++x)a[x]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[x],c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(x)]=x;c[45]=62;c[95]=63},1361:function(x,C){C.read=function(b,a,c,e,f){var l=8*f-e-1;var m=(1<<l)-1,r=m>>1,h=-7;f=c?f-1:0;var w=c?-1:1,n=b[a+f];f+=w;c=n&(1<<-h)-1;n>>=-h;for(h+=l;0<h;c=256*c+b[a+f],f+=w,h-=8);l=c&(1<<-h)-1;c>>=-h;for(h+=e;0<h;l=256*l+b[a+f],f+=w,h-=8);if(0===c)c=1-r;else{if(c===m)return l?NaN:Infinity*(n?
-1:1);l+=Math.pow(2,e);c-=r}return(n?-1:1)*l*Math.pow(2,c-e)};C.write=function(b,a,c,e,f,l){var m,r=8*l-f-1,h=(1<<r)-1,w=h>>1,n=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;l=e?0:l-1;var v=e?1:-1,u=0>a||0===a&&0>1/a?1:0;a=Math.abs(a);isNaN(a)||Infinity===a?(a=isNaN(a)?1:0,e=h):(e=Math.floor(Math.log(a)/Math.LN2),1>a*(m=Math.pow(2,-e))&&(e--,m*=2),a=1<=e+w?a+n/m:a+n*Math.pow(2,1-w),2<=a*m&&(e++,m/=2),e+w>=h?(a=0,e=h):1<=e+w?(a=(a*m-1)*Math.pow(2,f),e+=w):(a=a*Math.pow(2,w-1)*Math.pow(2,f),e=0));for(;8<=
f;b[c+l]=a&255,l+=v,a/=256,f-=8);e=e<<f|a;for(r+=f;0<r;b[c+l]=e&255,l+=v,e/=256,r-=8);b[c+l-v]|=128*u}},1362:function(x){var C={}.toString;x.exports=Array.isArray||function(b){return"[object Array]"==C.call(b)}},1363:function(x,C,b){function a(){var f=e.call(this)||this;f.errorCode=null;f.errorDescription=null;f.html=null;f.H_=Object.assign(new c.a,{T_:a.getTypeName(),B_:a.Ae()});return f}b.d(C,"a",function(){return a});x=b(0);C=b(932);var c=b(910),e=C.a;Am(a,e);a.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};
a.Ae=function(){return["AugLoop_Core_Annotation"]};Object(x.a)(a,"DetectedHtmlTableAnnotation",C.a,[])},1364:function(x,C,b){function a(){}b.d(C,"a",function(){return a});x=b(0);a.DHa=function(c,e){if(!(c&&e&&c.length&&e.length)||256<c.length)return"";var f=Array(256),l=Array(256),m,r=0,h=0,w="";for(m=0;256>m;m++)f[m]=m;for(m=0;256>m;m++){var n=c.charCodeAt(m%c.length);if(256<=n)return"";r=(r+f[m]+n)%256;n=f[m];f[m]=f[r];f[r]=n}for(m=0;256>m;m++)l[m]=f[256-m-1];for(c=r=m=0;c<e.length;c++){m=(m+1)%
256;r=(r+f[m])%256;n=f[m];f[m]=f[r];f[r]=n;n=e.charCodeAt(c);if(256<=n)return"";var v=n^f[(f[m]+f[r])%256];h=(h+l[m])%256;n=l[m];l[m]=l[h];l[h]=n;w+=String.fromCharCode(v^f[(l[m]+l[h])%256])}return w};Object(x.a)(a,"RC4A",null,[])},1366:function(x,C,b){function a(e,f,l,m){this.okb=e;c.AFrameworkApplication.ga.ra("AddInCommandsMissingTabIsEnabled")&&l.$Rh();this.Hkg=this.Ps=f;this.Fvg=m}b.d(C,"a",function(){return a});x=b(0);b(14);var c=b(4);a.prototype.aKa=function(e){e=this.dDb+this.solutionId+e;
return this.cRd?(e in a.b_b||(a.b_b[e]="AddinControl"+a.nHg++),a.b_b[e]):e};a.prototype.FFe=function(e){if(this.cRd){var f=a.b_b,l;for(l in f){var m=l;if(e===f[l])return m.substr(this.dDb.length+this.solutionId.length)}}return e};a.prototype.J2e=function(e){e=this.dDb+this.solutionId+e;return this.cRd?(e in a.VVc||(a.VVc[e]="AddinTab"+a.xHg++),a.VVc[e]):e};Ek.Object.defineProperties(a.prototype,{dDb:{configurable:!0,enumerable:!0,get:function(){return this.okb}},solutionId:{configurable:!0,enumerable:!0,
get:function(){return this.Ps}},assetId:{configurable:!0,enumerable:!0,get:function(){return this.Hkg}},cRd:{configurable:!0,enumerable:!0,get:function(){return this.Fvg}}});a.b_b={};a.VVc={};a.xHg=0;a.nHg=0;Object(x.a)(a,"DefaultRibbonNamingProvider",null,[336])},1408:function(x,C,b){function a(u){var t=this;this.eB=null;this.O9f={};this.Q9f={};this.Mad={};this.oyd={};this.Qid=function(y,E){y=t.$.Ob.Gc("Task","DdaEventDispatch.HandleServerEvent");E=E.nXf;for(var B=0;B<E.length;B++)switch(E[B].EventType){case 2:var z=
E[B],M={};M.Name=z.Name;M.BindingType=z.BindingType;M.ColCount=z.ColCount;M.RowCount=z.RowCount;t.Kva(z.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,M,null);break;case 4:t.Kva(E[B].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(z=E[B],z.InstanceId){M=Array(z.Entries.length);for(var Q=0;Q<z.Entries.length;Q++)M[Q]=a.fcc(z.Entries[Q],z.IsRemoteOverride);0<z.Entries.length&&1===z.Entries[0].Category?t.C0i(z.InstanceId,M):z.InstanceId&&t.Kva(z.InstanceId,
OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,M)}else{t.Mad={};t.oyd={};for(M=0;M<z.Entries.length;M++)t.pIe(z.Entries[M],z.IsRemoteOverride);c.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",t.Mad,t.oyd,t.O9f,t.Q9f)}}y.stop()};this.SJb=function(y,E){t.Kva(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,E)};this.$=u;this.Fvc=this.Qid}b.r(C);x=b(0);var c=b(14),e=b(83),f;(function(u){u[u.none=
0]="none";u[u.testEvent=1]="testEvent";u[u.test1Event=2]="test1Event";u[u.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";u[u.worksheetActivatedEvent=11]="worksheetActivatedEvent";u[u.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";u[u.worksheetAddedEvent=13]="worksheetAddedEvent";u[u.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";u[u.worksheetDeletedEvent=15]="worksheetDeletedEvent";u[u.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";u[u.worksheetFilteredEvent=
17]="worksheetFilteredEvent";u[u.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";u[u.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";u[u.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";u[u.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";u[u.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";u[u.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";u[u.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";u[u.worksheetNameChangedEvent=
25]="worksheetNameChangedEvent";u[u.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";u[u.worksheetMovedEvent=27]="worksheetMovedEvent";u[u.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";u[u.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";u[u.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";u[u.chartAddedEvent=50]="chartAddedEvent";u[u.chartActivatedEvent=51]="chartActivatedEvent";u[u.chartDeactivatedEvent=
52]="chartDeactivatedEvent";u[u.chartDeletedEvent=53]="chartDeletedEvent";u[u.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";u[u.tableDataChangedEvent=101]="tableDataChangedEvent";u[u.tableAddedEvent=102]="tableAddedEvent";u[u.tableDeletedEvent=103]="tableDeletedEvent";u[u.tableFilteredEvent=104]="tableFilteredEvent";u[u.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";u[u.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";u[u.customFunctionExecutionEndEvent=
201]="customFunctionExecutionEndEvent";u[u.commentAddedEvent=250]="commentAddedEvent";u[u.commentDeletedEvent=251]="commentDeletedEvent";u[u.commentChangedEvent=252]="commentChangedEvent";u[u.invocationMessage=1E3]="invocationMessage";u[u.cancellationMessage=1001]="cancellationMessage";u[u.metadataMessage=1002]="metadataMessage";u[u.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";u[u.visualChangeEvent=2001]="visualChangeEvent";u[u.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";
u[u.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";u[u.shapeActivatedEvent=2101]="shapeActivatedEvent";u[u.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";u[u.shapeAddedEvent=2103]="shapeAddedEvent";u[u.shapeDeletedEvent=2104]="shapeDeletedEvent";u[u.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";u[u.wacOperationEvent=2201]="wacOperationEvent";u[u.recordingStateChangedEvent=2202]="recordingStateChangedEvent";u[u.workbookActivatedEvent=2203]="workbookActivatedEvent";
u[u.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";u[u.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";u[u.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";u[u.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";u[u.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";u[u.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";
u[u.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";u[u.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";u[u.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";u[u.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";u[u.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";u[u.pivotTableAddedEvent=2900]="pivotTableAddedEvent";u[u.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";
u[u.namedItemAddedEvent=3E3]="namedItemAddedEvent";u[u.namedItemDeletedEvent=3001]="namedItemDeletedEvent";u[u.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";u[u.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";u[u.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(f||(f={}));Object(x.b)("MessageType",f);var l=b(975),m=b(244),r=b(946),h=b(56),w=b(36),n=b(157),v=b(1);b.d(C,"DdaEventDispatch",function(){return a});
a.prototype.DZb=function(u){u&&(this.yia(),this.eB.push(u))};a.prototype.Vsc=function(u){this.eB&&(Array.remove(this.eB,u),this.eB.length||(this.$.wantServerEvents=!1,this.$.lcj(this.Fvc),this.eB=null))};a.prototype.C0i=function(u,t){var y=this,E=Object(e.a)(r.DdaFacade,m.a(this.$));w.TaskExtensions.Ba(E.uTh(u),function(B){if(n.b(B)){var z=B.result;B=E.pn(z);if(z)if(B.Fpd)y.Kva(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t);else if(B.$4c)for(z=0;z<t.length;z++)B.$4c.push(t[z]);else B.$4c=
t}else B.ig?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):B.Oh&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)};a.prototype.X0i=function(u,t){var y=Object(e.a)(r.DdaFacade,m.a(this.$)),E=y.JHh(u);E?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(E,t,this.SJb):y.M3g(u,t)};a.prototype.pIe=function(u,t){var y=
!1,E=parseInt(u.Type,10),B=u.Target,z=Object(e.a)(r.DdaFacade,m.a(this.$));if((B=z.ij.ATh(E,B))&&0<Object.keys(B).length){y=!0;for(var M in B)if(B=M,z.ij.U_b(B)){var Q=Array(1);Q[0]=a.fcc(u,t);if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var P=Q[0][3];if(void 0!==P&&null!==P&&(P=Object(e.a)(Object,h.a.mi(P)))&&void 0!==P.triggerControlId&&null!==P.triggerControlId&&void 0!==P.triggerSource&&null!==P.triggerSource){var L=!1;t?(P.triggerSource="Unknown",L=!0):
z.vgh(P.triggerControlId,B)&&(P.triggerSource="ThisLocalAddin",L=!0);L&&(Q[0][3]=h.a.Kc(P))}}this.Kva(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,Q)}}y?(this.Nec(f[E],this.Mad),this.Nec(f[E],this.O9f)):(this.Nec(f[E],this.oyd),this.Nec(f[E],this.Q9f))};a.prototype.yia=function(){this.eB||(this.eB=[],this.$.$ne(this.Fvc),this.$.wantServerEvents=!0)};a.prototype.Nec=function(u,t){u in t||(t[u]=0);t[u]+=1};a.prototype.NM=function(u,t,y){var E={};E.Target=t;E.Category=65536;E.Type=u;E.Message=
y;E.Id=-1;this.pIe(E,!1)};a.prototype.zBh=function(u,t){var y={Target:"",Category:2,Type:1E3};y.Message=t;y.Id=0;t=Array(1);t[0]=a.fcc(y,!1);this.X0i(u,t)};a.prototype.Z9b=function(u,t,y,E){var B={};B.Target=y;B.Category=65536;B.Type=t;B.Message=E;B.Id=-1;t=Array(1);t[0]=a.fcc(B,!1);this.Kva(u,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t)};a.prototype.yBh=function(u,t){this.Kva(u,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t)};a.prototype.Kva=function(u,t,y,E){if(this.eB){var B=Object(e.a)(r.DdaFacade,
m.a(this.$));if(!B||t!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&t!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||B.ij.U_b(u))for(u=new l.a(t,u,y,E),t=0,y=this.eB.length;t<y;t++)(E=this.eB[t])&&E(u)}};a.fcc=function(u,t){var y=Array(6);y[0]=u.Category;y[1]=u.Type;y[2]=u.Target;y[3]=u.Message;y[4]=u.Id;y[5]=t;return y};Object(x.a)(a,"DdaEventDispatch",null,[])},1431:function(x,C,b){function a(){var f=e.call(this,void 0,void 0,void 0,!0)||this;f.$Ca="AddinCommandsUILessDialog";f.wSc="WACDialogTitleText";
f.lVa="0";f.cDa=380;f.Zhb=190;f.Pe=f.$Ca;f.jc=5;f.tmg=String.format("{0}px",f.cDa);f.kVa=String.format("{0}px",f.Zhb);f.qv=!1;f.o6e=!1;f.qD();return f}b.d(C,"a",function(){return a});x=b(0);C=b(149);var c=b(91),e=C.a;Am(a,e);a.prototype.qD=function(){e.prototype.qD.call(this);this.Np.style.width=this.tmg;this.Np.style.height=this.kVa;this.Np.style.padding=this.lVa};a.prototype.Iv=function(f){this.IO();document.getElementById(this.ni(this.wSc)).innerText=f};a.prototype.IO=function(){e.prototype.IO.call(this);
this.Nb.style.width=String.format("{0}px",this.cDa);this.Nb.style.height=String.format("{0}px",this.Zhb);this.Nb.removeAttribute(c.a.Td);this.Nb.removeAttribute(c.a.rE)};a.prototype.hide=function(){this.wxb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)};Ek.Object.defineProperties(a.prototype,{q1a:{configurable:!0,enumerable:!0,get:function(){return this.Np}}});Object(x.a)(a,"AddinCommandsUILessDialog",C.a,[343])},1437:function(x,
C,b){function a(G){return Lj.call(this,G)||this}function c(G,ia,eb){this.rangePicker=null;this.$=G;this.Je=ia;this.Ee=new J(G.ea);this.iA=new P(G,this.Ee);this.grf=eb;this.r9b=new Map}function e(G,ia,eb,Fb,Oc){this.$Sc=null;this.IQb=G;this.xA=ia;this.fJ=eb;this.wb=Fb;this.pyg=Oc}function f(){}function l(){this.mra=null}function m(G){if(!G)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.Hvd=G}function r(G,ia,eb){return function(Fb){return function(Oc,
Tc){Rh.TaskExtensions.Ba(jj.GetServiceTaskFactory.create(ia.da,279,ia.la,1),function(Md){Md=Md.result;var Qd=!1,Je=eb.Fi.getOsfControl(G),kf=null;Je&&(kf=Je.getStoreType(),(Je=Je.getManifest())&&Je.getSharedRuntimeForCustomFunctions("Workbook")&&(Qd=!0));Rh.TaskExtensions.Ba(Md.X$e(G,kf,Fb,Qd),function(xf){xc.b(xf)?xf.result?Oc(null):Tc(OfficeExtension.WacRuntime.Utility.createRichApiException(hi.a.invalidArgument,gi.a.instance.fa(1732))):Tc(OfficeExtension.WacRuntime.Utility.createRichApiException(hi.a.generalException,
gi.a.instance.fa(1728)))},ia.la,3)},ia.la,3)}}}function h(G,ia){this.nP=mc.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.xA=G;this.fJ=ia;this.$sg=this.fJ.Fi.getOsfControl(this.xA)}function w(G,ia,eb,Fb){this.P2d="";this.zSb=0;this.nP=G;this._id=ia;this.xA=eb;this.fJ=Fb}function n(G,ia,eb){this.lqg=G;this.mqg=ia;this.lug=eb}function v(){this.vhe=this.Jbe=this.rA=!1}function u(G,ia,eb,Fb){this.Ps=G;this.L1=eb;this.Xy=Fb.Fi.getOsfControl(ia)}function t(G,ia){this.fJ=
ia;this.xA=G}function y(G){this.xA=G}function E(G){this.BIa={};this.Fyi=G}function B(G,ia){var eb=this;eb.Cgf=function(Fb,Oc){Fb=B.C2g(Fb,Oc);if(!ea.a(eb.$,Fb))return!0;Fb=eb.$.shortcutKeyManager.l2e(Fb);return!!Fb&&0<Fb.length};eb.addinId=G;eb.$=ia;return eb}function z(){}function M(){}function Q(G,ia,eb,Fb){this.rzh=G;this.fileSize=ia;this.JBj=Fb}function P(G,ia){var eb=this;this.rI=function(Fb,Oc){eb.HQ.PJa(bi.a.internalError,Oc)};this.$=G;this.HQ=ia}function L(G,ia,eb,Fb){eb=K.call(this,576,0,
eb,Fb)||this;eb.VLd=new U("576",G,ia);return eb}function ca(G,ia,eb,Fb,Oc,Tc,Md,Qd){ia=Uk.call(this,10,0,ia,Qd)||this;ia.$lb=eb;ia.tib=Fb;ia.K3=Oc;ia.gFa=Tc;ia.request=Md;ia.VLd=new U("10",G,Md);return ia}function U(G,ia,eb){this.parentName=G;this.$=ia;this.request=eb}function aa(G,ia){this.source=G;this.eventId=ia}function F(G,ia,eb,Fb,Oc,Tc){var Md=G.Na(1);Md.request=ia;return Yh.i(G,"ExecuteRichApiRequest",Md,eb,Fb,Oc,Tc,0)}function D(G,ia,eb){this.$=G;this.HQ=ia;this.iA=eb}function J(G){this.ea=
G}function R(G,ia,eb,Fb){G=Qj.call(this,G,"Select Data")||this;G.Vob=null;G.YFe=ia;G.D5c=eb;G.callback=Fb;return G}function Z(G){this.wb=G}function W(G){G.add("InternalTest","PreviewExecutionMethod",ka)}function ka(G,ia){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof G+", objectId="+G+", value="+ia);return null}function ma(G,ia){this.asg=G;this.xsg=ia}function pa(G){var ia=G.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}",
"{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var eb=ia.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);eb.addParameter("shortcuts","String[]",1,null,0);ia.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);eb=ia.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);eb.addParameter("shortcuts","Object",1,null,0);ia=G.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);eb=ia.addMethod("GetSharedFilePickerResponse",
1,"Object",1,1,"SharedFilePickerResponse",0);eb.addParameter("pickerCustomizationJsonString","String",1,null,0);ia=G.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);eb=ia.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);eb.addParameter("base64File","String",1,null,0);ia=G.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeState",0);eb=ia.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);eb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ia=G.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);ia.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);eb=ia.addMethod("Register",1,"Void",0,0,"Register",0);eb.addParameter("metadata",
"String",1,null,0);eb.addParameter("javascript","String",1,null,0);ia=G.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);ia.addProperty("Enabled",1,"Boolean",1,!1,null,0);ia.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);ia.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);ia=G.addEnumType("Microsoft.Authentication.IdentityType");ia.addEnumField("OrganizationAccount",0);ia.addEnumField("MicrosoftAccount",1);ia=G.addEnumType("Microsoft.Authentication.AuthorityType");
ia.addEnumField("External",0);ia.addEnumField("Msa",1);ia.addEnumField("Aad",2);ia=G.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);ia.addProperty("DisplayName",4,"String",1,!1,null,0);ia.addProperty("Email",3,"String",1,!1,null,0);ia.addProperty("FederationProvider",2,"String",1,!1,null,0);ia.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);ia=G.addType("Microsoft.Authentication.AuthContext",
"{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);ia.addProperty("AppId",4,"String",1,!1,null,0);ia.addProperty("Authority",2,"String",1,!1,null,0);ia.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);ia.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);ia.addProperty("TenantId",6,"String",1,!1,null,0);ia.addProperty("Upn",1,"String",1,!1,null,0);ia=G.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}",
"{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);ia.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);eb=ia.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);eb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);ia.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);ia.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",
2,1,"PrimaryIdentityInfo",4);ia=G.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);ia.addProperty("AuthChallenge",3,"String",1,!1,null,0);ia.addProperty("CorrelationId",7,"String",1,!1,null,0);ia.addProperty("Policy",4,"String",1,!1,null,0);ia.addProperty("Resource",2,"String",1,!1,null,0);ia.addProperty("Scope",5,"String",1,!1,null,0);ia.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);ia=G.addType("Microsoft.Authentication.SingleSignOnToken",
"{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);ia.addProperty("AccessToken",2,"String",1,!1,null,0);ia.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);ia=G.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);ia.addProperty("Id",1,"String",1,!0,null,0);ia.addProperty("Value",2,"Object",1,!1,null,0);ia=G.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}",
"",3,0);eb=ia.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);eb.addParameter("id","String",1,null,0);eb=ia.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);eb.addParameter("id","String",1,null,0);ia=G.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",
0);eb=ia.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);eb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ia=G.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ia.addEnumField("Inactive",0);ia.addEnumField("Background",1);ia.addEnumField("Visible",2);ia=G.addEnumType("Microsoft.AppRuntime.Visibility");ia.addEnumField("Hidden",1);ia.addEnumField("Visible",2);ia=G.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}",
"{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ia.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);eb=ia.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);eb.addParameter("jsonCreate","String",1,null,0);eb=ia.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);eb.addParameter("jsonUpdate","String",1,null,0);eb=ia.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);eb.addParameter("id","String",
1,null,0);eb=ia.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);eb.addParameter("id","String",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia=G.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);ia.addProperty("Id",2,"String",1,!0,null,0);eb=ia.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);eb.addParameter("visibility","Boolean",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia=G.addType("Microsoft.DynamicRibbon.RibbonButton",
"{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);ia.addProperty("Enabled",3,"Boolean",1,!1,null,0);ia.addProperty("Id",2,"String",1,!0,null,0);ia.addProperty("Label",4,"String",1,!0,null,0);eb=ia.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);eb.addParameter("enabled","Boolean",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia=G.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ia.addMethod("GetCount",3,"Int32",1,1,"Count",
0);eb=ia.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);eb.addParameter("key","String",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);ia=G.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");ia.addEnumField("Unknown",0);ia.addEnumField("Basic",1);ia.addEnumField("Premium",2);ia=G.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",
3,0);eb=ia.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);eb.addParameter("feature","String",1,null,0);eb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);eb=ia.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);eb.addParameter("feature","String",1,null,0);eb=ia.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);eb.addParameter("feature","String",
1,null,0);eb.addParameter("fallbackValue","Boolean",1,null,0);ia.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);eb=ia.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);eb.addParameter("experienceId","String",1,null,0);eb=ia.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);eb.addParameter("feature","String",1,null,0);ia=G.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}",
"",3,0);ia.addProperty("Id",5,"String",1,!0,null,0);ia.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);ia.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ia=G.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);ia.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);ia=G.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);ia.addMethod("Disable",3,"Void",0,1,"Disable",0);ia.addMethod("Enable",2,"Void",0,1,"Enable",0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function xa(G,ia,eb,Fb){this.menuItemId=G;this.LI=ia;this.nFj=eb;this.Czh=Fb}function va(G){this.Zwi=G}function ta(G){this.Kxa=G;this.Cng=Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function fa(){}function Ca(){}
function Sa(){}function Gb(G,ia){this.zhb=ia;this.xA=G}function kb(){this.a2d=null;this.Lfe=this.VVb=this.WD="";this.Xge=!0;this.options=null}function lb(G,ia){this.kQb=G;this.$ib=ia}function Nb(){}function Aa(){this.p6d=this.J5d=this.jfa=null;this.$ib=0}function qa(G){var ia=Pj.call(this)||this;ia.$=G;ia.Tb();return ia}function Xa(){this.initialized=!1;this.agaveCommandManager=this.Je=this.f0a=null;this.JU={}}function Ha(G){var ia=cj.call(this)||this;ia.$=G;ia.Tb();return ia}function Ra(G,ia,eb){this.skg=
null;this.ukg=0;this.vb=G;this.Mg=ia;this.v3d=eb}function mb(){}function La(G,ia,eb,Fb,Oc){var Tc=ui.call(this)||this;Tc.NRa={};Tc.Sad={};Tc.iwa=null;Tc.hza=null;Tc.U3h=function(Md,Qd,Je,kf,xf){if(2!==Je)return 32;Md=xf[eh.a.i9b];Je=xf[eh.a.qHa];xf=xf[eh.a.Sya];Qd=new ij.a;Qd.Ubi=xf.oi.InstanceToken;Qd.gl=xf.oi[le.gl];Qd.LS=xf.oi[le.LS];le.taskPaneWidth in xf.oi&&(Qd.taskPaneWidth=xf.oi[le.taskPaneWidth]);Qd.sourceLocationOverrideResourceId=xf.oi[le.sourceLocationOverrideResourceId];Qd.nI=xf.pr;Qd.onTaskPaneClose=
xf.oi[le.onTaskPaneClose];Qd.qHa=Je;Je=new Bk.a(-859308420,0,2,0,"");kf=Md.getStoreType()===OSF.StoreType.Sdx;var og=new mf;og.dba=xf.oi.HeaderCssClass||rj.a.p2a;og.rNb=xf.oi.TitleCssClass;Tc.R0(Je,Md.getId(),Qd,kf,og);return 32};Tc.F3h=function(Md,Qd,Je,kf,xf){if(2!==Je)return 32;Md=xf[eh.a.i9b].getId();xf=xf[eh.a.Sya].oi[le.sourceLocationOverrideResourceId];return Md?(Tc.Je.Fi.refreshOsfControl(Md,xf),32):8};Tc.nZi=function(Md){Md=Md.Result;if(Md=null===Md?null:Md.SolutionId)Tc.Je.jle(Md),Tj.a(Tc.$).jna(3,
Md)};Tc.aHf=function(Md,Qd){var Je,kf=(Md=Md.Result)?Md.AgaveData:null;if(kf){$e.ULS.shipAssertTag(537170434,0,kf.TaskpaneWidth===La.och,"Taskpane width is {0}, assetId is {1}.",kf.TaskpaneWidth,Telemetry.PrivacyRules.GetPrivacyCompliantId(kf.PrimaryMarketplace.SolutionId,kf.PrimaryMarketplace.MarketplaceType,null===(Je=null===kf||void 0===kf?void 0:kf.AssetMarketplace)||void 0===Je?void 0:Je.SolutionId,null,null,kf.PrimaryMarketplace.MarketplaceRef));if(Je=Tc.Sad[kf.PrimaryMarketplace.SolutionId])Je.Qzc&&
(kf.TaskpaneTitle=Je.Qzc),Je.Ozc&&(kf.TaskpaneIconId=Je.Ozc),Je.iVd&&(kf.TaskpaneButtonTooltip=Je.iVd),0<Je.Cu&&(kf.TaskpaneWidth=Je.Cu);Qd&&(kf.FocusOnIframeWhenLoaded=Qd.focusOnIframeWhenLoaded,Qd.width&&(kf.TaskpaneWidth=Qd.width),kf.TaskpaneIconCssClass=Qd.Qk,kf.TaskpaneHeaderCssClass=Qd.dba,kf.TaskpaneTitleCssClass=Qd.rNb,kf.IsFirstPartyOptOutAppContextOptmization=Qd.isFirstPartyOptOutAppContextOptmization);Tc.NRa[kf.PrimaryMarketplace.SolutionId]&&(kf.OsfPropertyBag=Tc.xwd(kf.OsfPropertyBag,
kf.PrimaryMarketplace.SolutionId));Ui.a(kf)||(kf.WebExtensionOsfControlType=1);kf&&(Tc.Je.jle(Md.SolutionId),Tc.Je.H0a(kf))}else $e.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};Tc.Eyh=function(Md){Md&&(Tc.Z$c.nif(Md),Tc.Hwe())};Tc.eHf=function(Md){Md=Md.toDataURL("image/jpeg");var Qd=Tc.Je.Aaa(La.w7e+"."+La.f4e);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Qd,"onScreenshot",{screenshot:Md},function(){})};Tc.h2h=
function(Md,Qd,Je,kf,xf){if(2!==Je)return 32;if(sf.a.Fh(xf)||xf[eh.a.QAe]!==ck.a.action)return 8;Qd=xf[eh.a.Sya];return Qd?(Md=(Md=Tc.zTh(xf))?Tc.Je.Aaa(Md):null)?(xf=Tc.Je.J3g(xf[eh.a.qHa],Qd.oi[le.yTc]),Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(Je=Tc.Je.FZ(Md),Je.TaskpaneTitle!==Qd.oi[le.gl]&&(Je.TaskpaneTitle=Qd.oi[le.gl],Je.TaskpaneIconCssClass=Qd.oi.IconCssClass,Je.TaskpaneIconUrl=Qd.oi.TaskPaneIconUrl,Je.TaskpaneIconId=Qd.oi.TaskPaneIconId,Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?
(Qd=Tc.Je.Fi,Qd.changeIframeTitle(Md,Je.TaskpaneTitle),Je=Qd.getOsfControl(Md),Qd.raiseOsfControlStatusChange(Je)):(Qd=Tc.Je.Fi.getOsfControl(Md),Tc.Je.Fi.raiseOsfControlStatusChange(Qd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Md,xf,Tc.SJb),32):8:8};Tc.SJb=function(Md,Qd){Tc.Je.uBh(Md,Qd)};Tc.$=G;Tc.viewBlockContainerHelpers=eb;Tc.Je=ia;Tc.Z$c=Fb;Tc.Di=Oc;Tc.Di.fc(kj.a.U2f,Ie.a.frame,Tc.U3h);Tc.Di.fc(kj.a.aTf,Ie.a.frame,Tc.F3h);Tc.Di.fc(kj.a.dRe,Ie.a.frame,Tc.h2h);
return Tc}function ha(){var G=sj.call(this)||this;G.kVa="calc(100% - 46px)";G.vRb="15px";G.lVa="0";G.nng="WACDialogPanel";G.cDa=695;G.ong=462;G.Zhb="80%";G.dlg=350;G.s2d="100%";G.jc=5;G.Pe="AppsForOfficeInsertionDialog";G.cIc=!!Tf.AFrameworkApplication.ga&&Tf.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return G}function Ia(){var G=gb.call(this)||this;G.isTable=!1;G.isPivotTable=!1;G.hasTableHeaders=!1;G.tableName=null;G.userSelectedPivotTable=!1;return G}function gb(){this.addressWithSheet=
this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function Sb(){this.iVd=this.Qzc=null;this.Cu=0;this.Ozc=null}function wc(){var G=this;this.Je=null;this.sab=function(ia,eb,Fb,Oc,Tc){if(2===Fb){ia=Tc?Tc:{};eb=ia.callback;if(!eb)return 16;G.Je.Wca(eb,ia.refresh?ia.refresh:!1)}return 32};this.d8i=function(ia,eb,Fb,Oc,Tc){2===Fb&&(ia=Tc?Tc.callback:null)&&G.Je.cEg(ia);return 32}}function tc(G,ia){this.p9=
ia}function Tb(G){return Pd.call(this,G)||this}function pb(G){var ia=Pc.call(this)||this;ia.$=G;ia.isFirstLaunch=!1;return ia}function cb(G){$e.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Lnf=Tf.AFrameworkApplication.ga.ra("IsTellMeUpSellEnterpriseEnabled");this.rwi=Tf.AFrameworkApplication.ga.Ua("SmartLookupApprovedOriginPattern");this.A8a=Tf.AFrameworkApplication.ga.Ua("SmartLookupShredderServiceEndpoint");this.Xwi=dl.a.UM(Tf.AFrameworkApplication.ga.Ua("AppCatalogUrl")||
"");this.z8a=new Db;this.z8a.EnableAllTabV2=!0;this.z8a.EnableIntentService=!0;this.z8a.EnableInDocumentSearch=Tf.AFrameworkApplication.ga.ra("SmartLookupEnableInDocumentSearch");this.z8a.EnableLocalSearch=Tf.AFrameworkApplication.ga.ra("SmartLookupEnableLocalSearch");this.z8a.IntentServiceEndpoint=ob.aXh();this.Rwi=new rc(G,this.A8a)}function ob(){}function rc(G,ia,eb){this.UJj=9E5;this.XJj=3E5;this.lvd=null;this.dnf="";this.ivd=0;this.VFe=Date.now;this.Kxa=G;this.A8a=ia;(void 0===eb||eb)&&this.Wcd()}
function Db(){}function Ja(){}function Qb(){}function yc(){}function Cd(){}function bc(G,ia,eb,Fb,Oc,Tc){this.$=G;this.agaveCommandManager=Tc}function Kb(G){var ia=gd.call(this)||this;ia.ddaFacade=null;ia.YLf=null;ia.$=G;G.da.Ga(106,ia);ia.Tb();return ia}function ic(){}function wb(){}function Wa(G){this.mFa=G}function Xb(G,ia,eb){this.iframe=G;this.onSuccess=ia;this.onError=eb;$addHandler(window,"message",Object(Kh.a)(this,this.M5e,"handleResponse"))}function Gc(G,ia){return Zj.a.Itd(42,function(){return window.OfficeExtension&&
window.OfficeExtension.WacRuntime},Tf.AFrameworkApplication.ga.Dd("MaxRetriesForLoadingScript",0),G,ia)}function zb(G){var ia=Ba.call(this)||this;ia.$=G;ia.Tb();return ia}function hc(G,ia){var eb=this;this.WPa=this.XPa=null;this.q$f=function(Fb,Oc){var Tc=null,Md=null,Qd=null;Oc?(Object(Jj.a)(497,Oc)?(Tc=Oc.bGa,Qd=Oc.instanceId):Object(Jj.a)(426,Oc)&&(Tc=Oc.get_element(),Qd=Oc.instanceId),Tc)?(Md=Object(Fi.a)(546,Fb),Md)?eb.ZLf(Qd,Tc,Md)||Qd in eb.WPa||(eb.XPa[Qd]=0,eb.WPa[Qd]=ok.a.instance.BC(function(){10<=
eb.XPa[Qd]||eb.ZLf(Qd,Tc,Md)?(delete eb.XPa[Qd],eb.WPa[Qd].dispose(),delete eb.WPa[Qd]):eb.XPa[Qd]+=1},500,X.a.fIg,!0,!1)):$e.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):$e.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):$e.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=G;this.$=ia;this.CXc=!1;this.$.da.Ga(224,this)}function Uc(G){var ia=tl.call(this)||
this;ia.$=G;ia.Tb();return ia}function jb(G){var ia=rl.call(this,G)||this;ia.handler=null;ia.jzg=function(){$e.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",ia.$.isEditMode,!!(ia.$.Pd&16384));var eb=new mk.a;ia.$.da.$a(53,function(xf){$e.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");eb.setResult(xf)});var Fb=eb.task,Oc=new Be,Tc=Mk.a.getInstance(),Md=new Pe(ia.$,
Tc),Qd=jj.GetServiceTaskFactory.create(ia.$.da,203,ia.la,ia.ub),Je=ia.d7i(Oc),kf=jj.GetServiceTaskFactory.Va(ia.$.da,349,350,ia.ub);return Rh.TaskExtensions.Ba(Rh.TaskExtensions.ye([Fb,Qd,Je,kf],ia.la),function(){$e.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Rh.TaskExtensions.Ba(jj.GetServiceTaskFactory.create(ia.$.da,106,ia.la,ia.ub),function(xf){ia.handler=new $a(ia.$,xf.result,Oc,new pe,Tc,Md,mc.a.instance.Kh("Common.IExternalUICommandDefinitionMapping"));
$e.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");ia.Cd([ia.handler]);ia.$.da.Ga(198,ia.handler)},ia.la,3)},ia.la,3)};ia.ybh=function(){void 0!==ia.handler&&null!==ia.handler?(ia.$.Ka.ebb(ia.handler),ia.$.da.ZU(198),ia.handler=null):$e.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");ia.$.da.ZU(204);fl.a(wk.a,21,ia.$.da,198)};return ia}function $a(G,
ia,eb,Fb,Oc,Tc,Md){var Qd=this;Md=void 0===Md?null:Md;this.disposed=!1;this.UFi=function(Je,kf){if(kf)if(kf)if(Je=kf.Mm){kf=kf.Ko;var xf=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(Je.solutionId in xf)kf=xf[Je.solutionId];else if(kf=Qd.BLh(kf),void 0===kf||null===kf){$e.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}xf=new Bk.a(kj.a.I2,0,0,2,null);var og={};Qd.executeCommand(0,xf,(og.SourceControlId=kf,og),null);Je.isAutoLaunched=
!0}else $e.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else $e.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else $e.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.lNi=function(Je,kf){Je=null;kf&&(Je=kf);(null===Je||void 0===Je?0:Je.Ko)&&Qd.Brj(Je.Ko);Qd.$.Bf();Ag.EwaSettings.ma(88)&&Je&&Je.Mm&&Qd.KMg(Je.Mm)};this.$=G;$e.ULS.shipAssertTag(537170659,0,!(void 0===ia||null===ia),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",
Tk.a.x3());this.Je=ia;this.BBe=eb;this.YZb=Fb;this.Tga=Oc;this.Knb=Tc;this.Ro=new al.a;this.Rga=new Ff;this.L$c=Md;Zk.a.zxb=Zk.a.$Qe;this.N5c=new gg.a;this.w1a=new gg.a}function I(G){var ia=this;this.SFa=this.VFa=this.Mm=this.Ko=null;this.xOf=0;this.kNi=function(){if(ia.Mm&&ia.SFa){var eb=new Bk.a(kj.a.I2,0,0,2,null),Fb={};ia.addinUICommandHandler.executeCommand(0,eb,(Fb.SourceControlId=ia.SFa,Fb),null);$e.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.vyj=function(eb,
Fb){eb=null;if(Fb)if(eb=Fb,ia.Mm=eb.Mm,ia.Ko=eb.Ko,ia.Ko&&ia.Ko.yW&&ia.Ko.yW.Ts&&(ia.VFa=ia.Ko.yW.Ts.oa(0)),ia.VFa&&ia.VFa.id)if(ia.VFa.isOfficeTab)if(Fb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),eb=I.lEc?ia.Mm.solutionId:ia.Mm.assetId,eb in Fb?ia.SFa=Fb[eb]:($e.ULS.sendTraceTag(537170695,220,15,"Failed to get button id from controlIdMap for add-in: {0}",I.GetPrivacyCompliantId(ia.Mm)),ia.SFa=ia.QHh(ia.Ko)),ia.SFa)if(Oj.a.contains(ia.VFa.id,gh.a.UW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Nk.a.Eub(ia.Ko),
function(){ia.W3f(ia.ggd(ia.SFa))});else{if(Fb=ia.$.Ka)Fb.ioe(ia.XCf),$e.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else $e.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Fb={},Fb=(Fb.AppTeachingUICalloutAction="NoEnabledButtonFound",Fb["SDX.Id"]=I.GetPrivacyCompliantId(ia.Mm),Fb.AppTeachingUICalloutGoal="NewAdminDeployment",Fb["SDX.AppInstallOrigin"]="Organization",Fb),Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:wj.a.Il(Fb)})),ia.Rxa();else ia.Y3f(ia.ggd(ia.VFa.id),0);else $e.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Fb={},Fb=(Fb.AppTeachingUICalloutAction="NoTabFound",Fb["SDX.Id"]=I.GetPrivacyCompliantId(ia.Mm),Fb.AppTeachingUICalloutGoal="NewAdminDeployment",Fb["SDX.AppInstallOrigin"]="Organization",Fb),Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(Fb)})),
ia.Rxa();else ia.Rxa()};this.XCf=function(){if(Oj.a.contains(ia.VFa.id,appChrome.selectors.getSelectedTabId(),!0)){var eb=ia.$.Ka;eb&&eb.qQf(ia.XCf);ia.W3f(ia.ggd(ia.SFa))}};this.$=G.$;this.addinUICommandHandler=G;this.appName=Tf.AFrameworkApplication.ga.Ua("WebAppShortName")||"Excel";this.rHg=Tf.AFrameworkApplication.ga.Dd("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}function ba(G,ia){this.okb=G;this.GUa=new Jb;this.gVa=new Mb(ia)}function sa(G,ia,eb,Fb,Oc,Tc){this.uQb=new gg.a;this.Hhb=this.dfa=
this.uVa=null;this.VNc=G;this.GUa=ia;this.gVa=eb;this.Ps=Fb;this.xQb=Oc;this.d6d=Tc}function Oa(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function qb(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}function Qa(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function ib(){this.iconLocation=this.title=this.id=null;
this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}function Mb(G){this.OCa=G}function Jb(){}function Zb(G){this.okb=G}function ub(G,ia,eb){this.eJ=this.tVa=null;this.VNc=G;this.gVa=ia;this.GUa=eb;this.gsg=new gg.a}function Za(G){this.wpa=null;if(Ij.c(G))throw $e.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=G}function vc(G){this.$ae=null;if(Ij.c(G))throw $e.ULS.sendTraceTag(9175313,
220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=G;this.sla[kd.id]=this._id}function zc(G,ia){this.fEa=this.c4d=null;if(Ij.c(G)||Ij.c(ia))throw $e.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.Emg=ia;this._id=G;this.LU[kd.id]=this._id}function kd(){}function wa(G,ia,eb,Fb,
Oc,Tc,Md,Qd){Qd=void 0===Qd?null:Qd;this.Za=new Wk.a;this.PEc=G;this.ymg=ia;this.Hn=eb;this.vie=Fb;this.oXa=Oc;this.Sjg=Tc;this.xQb=Md;this.Ksg=Qd;this.fjb=Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1);this.tTb=Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinTelemetryEnabled",!1);this.yqg=Tf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}
function Na(G,ia,eb,Fb,Oc,Tc,Md){this.LSa=new Kk.a;this.rt=G;this.Fi=ia;this.Ro=eb;this.ribbonManager=Fb;this.contextMenuManager=Oc;this.$F=Tc;this.Rga=Md;this.OO=Tf.AFrameworkApplication.ta.JD}function Vb(G,ia,eb){this.x1d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=G;this.eventBuilder=ia;this.contextMenuBuilder=eb}function pc(G){this.Hng=G.entitlement}function hd(G,ia,eb){ia=void 0===ia?null:ia;eb=void 0===eb?0:eb;if(Ij.c(G))throw $e.ULS.sendTraceTag(9041814,
220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.Ssg=G;this.pwg=ia;this.Kog=eb}function Ud(G){this.qce=null;if(Ij.c(G))throw $e.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.ckg=G}function Zc(){}function Ob(G){this.u$d=null;this.p8d=G}function Ad(G,ia,eb){this.hpa=null;this.Za=G;this.qTb=
ia;this.Dgb=eb}function we(G,ia,eb,Fb,Oc,Tc){this.rt=G;this.Mm=ia;this.i7=eb;this.displayName=Oc;this.Jif=Tc}function Wd(){var G=Ak.call(this)||this;G.Mm=null;G.Ko=null;return G}function qc(){new md(Sk.a.instance)}function md(G){this.ZDa=G}function bd(){this.Ver=1}function Xc(){}function ne(G){this.Zsg=G}function ed(G,ia,eb){this.Pa=new Wk.a;this.context=new Kf;this.azc=this.mXc=this.jTd=this.Rra=this.Bda=this.hpa=null;this.contextActivationMgr=G;this.oHg=ia;this.ZZb=eb;this.appName=Tf.AFrameworkApplication.ga.Ua("WebAppShortName")}
function nd(G){var ia=aj.call(this)||this;ia.solutionId=G.solutionId;ia.assetId=G.assetId;ia.storeType=G.storeType;ia.storeId=G.storeId;ia.assetStoreId=G.assetStoreId;ia.targetType=G.targetType;ia.width=G.width;ia.height=G.height;ia.displayName=G.displayName;ia.version=G.version;return ia}function Ub(){this.addinId=null;this.targetType=0;this.storeId=this.assetId=this.solutionId=null}function Hc(G,ia,eb,Fb){this.aJb=Tf.AFrameworkApplication.ga.Ua("RoamingServiceHandlerWebServiceBase");this.appName=
G;this.Pib=ia;this.Lib=eb;this.Ukb=void 0===Fb?null:Fb}function pd(G){var ia=$k.call(this)||this;ia.properties=G;return ia}function jc(){this.HA=this.qq=null;this._count=0}function vd(G,ia,eb){this.next=eb;this.previous=ia;this.data=G}function ae(G){this.Nr=null;this.uA=G}function $d(G){var ia=-1;switch(G.toLowerCase()){case "omex":ia=0;break;case "spcatalog":ia=1;break;case "spapp":ia=2;break;case "filesystem":ia=3;break;case "exchange":ia=4;break;case "registry":ia=6;break;case "inmemory":ia=7;
break;case "uploadfiledevcatalog":ia=8;break;case "hardcodedpreinstall":ia=9;break;case "excatalog":ia=10;break;case "wopicatalog":ia=16}return ia}function Bc(G){var ia=null;switch(G){case 0:ia="omex";break;case 1:ia="spcatalog";break;case 2:ia="spapp";break;case 3:ia="filesystem";break;case 4:ia="exchange";break;case 6:ia="registry";break;case 7:ia="inmemory";break;case 8:ia="uploadfiledevcatalog";break;case 9:ia="hardcodedpreinstall";break;case 10:ia="excatalog";break;case 16:ia="wopicatalog"}return ia}
function Hd(G){var ia={};ia.solutionId=G.solutionId;ia.version=G.version;ia.storeType=G.storeType;ia.storeId=G.storeId;ia.assetId=G.assetId;Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?ia.assetStoreId=G.assetStoreId:ia.assetStoreId=G.storeType;ia.targetType=G.targetType;ia.requireConsent=G.requireConsent||!1;ia.isAddinCommands=!0;ia.addinCommandsActionType=0;return ia}function xb(){return dl.a.E4(window.location.href.toLowerCase(),"wdtpl")}
function rd(){var G=dl.a.E4(window.location.href.toLowerCase(),"wdomexsrctype");return!!G&&"4"===G}function tf(){}function Kf(){this.rt=this.k0=0;this.RVc=null;this.Qqc=this.BAc=0;this.O3b=this.cja=this.Q9=null}function Ff(){this.RYa=null}function Pe(G,ia){var eb=jl.call(this)||this;eb.statusBarManager=null;eb.agaveCommandManager=null;eb.Cye=function(){eb.$F&&eb.$F.jye()};eb.H4e=function(){eb.raiseEvent("LAC")};eb.od=function(Fb,Oc){!Fb.sc&&pl.b(Oc)&&eb.statusBarManager&&(eb.statusBarManager.SF(eb),
eb.statusBarManager=null)};eb.$F=ia;eb.$=G;eb.JEj=G.Mb+"OfficeAddinLabel-Medium14";eb.$.da.$a(29,function(Fb){eb.statusBarManager=Fb;Fb.yJ(eb)});eb.$.ea.hk(eb.od);eb.$F.rDg(eb.H4e);eb.$.da.$a(206,function(Fb){eb.agaveCommandManager=Fb;Fb.UEg(eb.Cye)});return eb}function Xe(){}function de(){this.Bi=null;this.visible=!1}function Kd(G,ia){this.Ra=G;this.R1g=ia}function pe(){this.d2d=this.yEc=null}function Lf(){}function Be(){this.zlg=new gg.a}function eg(G){return Uj.call(this,G)||this}function Jc(G,
ia,eb){this.Vrb=null;this.$=G;ia?($e.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.Vrb=new dk.a(G,ia,eb)):$e.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}function Yd(G){var ia=Hk.call(this)||this;ia.$=G;ia.Tb();return ia}function Ge(G,ia){var eb=ud.call(this)||this;eb.$=G;eb.E1a=new DOMParser;eb.cache=new Nf.a;eb.indexedDB=
ia;ia.tg()&&eb.indexedDB.initialize("Scripts","OfficeScriptingCache");eb.Ywb=!1;eb.mq=new fb([],function(Fb){ud.JCj(Fb)});eb.Tj=new fb([],function(Fb){ud.lTd(Fb)});eb.LB=new fb([],function(Fb){ud.lTd(Fb)});eb.xt=new fb([],function(){});return eb}function ud(){this.xt=null;this.Ywb=this.iHb=this.WW=this.Jab=this.WGd=this.FLf=this.UGd=this.Kab=this.Edc=!1;this.LB=this.Tj=this.mq=null}function Ye(G,ia,eb,Fb){var Oc=this;this.g7a=!1;this.s9a=function(){Oc.L1f()?(Oc.kHf(),zj.g(Oc.$).Ea.ZId(Oc.s9a)):Oc.g7a&&
zj.g(Oc.$).Ea.ZId(Oc.s9a)};this.THi=function(Tc,Md){Object.getType(Md)===String&&Md.toString().endsWith(Pf.a.awb(Oc.$))&&(Oc.g7a=!1)};this.$=G;this.osa=ia;this.Wu=eb;this.businessBarManager=Fb;this.Ttj()}function mf(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.rNb=this.dba=this.Qk=null;this.isFirstPartyOptOutAppContextOptmization=!1}function xe(G,ia,eb,Fb,Oc,Tc,Md,Qd,Je){var kf=this;this.RA=null;this.cache=new Nf.a;this.Lwa=!1;this.aGa={};this.$=G;this.cQc=eb;this.indexedDB=Fb;this.Kob=Oc;
this.Wu=Tc;this.osa=Md;this.pf=Qd;this.Ix=Je;this.OMg=new Rb(this,G);this.$pg=Qh.a.Ta.Wb;this.k6f="";Fb.tg()&&(this.Lwa=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));G=!0;if(hb.a.hue){this.cache.tg()&&!Pf.a.Fta&&(ia=this.pf.RJh(Pf.a.pac(this.$)),ia.isSuccess&&(G=ri.getElapsedSeconds(ia.timeStamp,Qh.a.Ta.Wb),this.Wu.uy=new xd(!0,!0),this.RA=new xd(ia.value,!0),G=this.RA.value?604800<G:86400<G,this.$wb=this.eSa(!0)));this.VHh();if("undefined"!==typeof makerstorage&&this.Dhf)if(this.k6f=
Mg(this.$),Nc(this.$))dg(this.$,"localstorageToken"),this.Wu.uy=new xd(!0,!0),this.RA=new xd(!0,!0),this.$wb=this.eSa(!0);else if((ia=Pf.a.y_e())&&makerstorage.setStorageEnvironmentOverride(ia),G||Pf.a.Fta)try{this.$.Pcb("automateTab",!0),this.$wb=Pf.a.Fta?this.Wu.f0c().then(function(){return kf.eSa(!1)}).catch(function(){return kf.eSa(!1)}):this.Wu.f0c().then(function(){return kf.osa.Dbc()}).then(function(xf){return kf.u4h(xf)}).then(function(){return kf.eSa(!1)}).catch(function(){return kf.eSa(!1)})}catch(xf){$e.ULS.sendTraceTag(537170314,
0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",xf.message),this.$wb=Promise.resolve(!1),this.$.Pcb("automateTab",!1)}Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&this.$wb?this.$wb.then(function(xf){return kf.jKd(xf)}):this.jKd(!1)}else $e.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.jKd(!1)}function Qe(G,
ia,eb,Fb,Oc,Tc){this.actionName=G;this.shapeId=ia;this.scriptLink=eb;this.clickId=Fb;this.Hba=Oc;this.buttonText=Tc}function jg(G,ia,eb,Fb){this.ykd=G;this.Lxh=ia;this.Sya=eb;this.qHa=Fb}function je(G){return Hb.a.Ld(G)?rj.a.TNe:rj.a.SNe}function pf(G){return Hb.a.Ld(G)?G.isChromeRtl?rj.a.Rqh:rj.a.Qqh:rj.a.p2a}function qg(G){G=G.na.ua.Na(1);G.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",
RequestHeaders:null,RequestBody:"",RequestFlags:256};return G}function Gf(G,ia,eb,Fb,Oc){function Tc(){function og(Ug,kh,Yi){return Yh.i(Qd.ua,"ExecuteRichApiRequest",Fb,Bh.b(Ug,ia),Bh.a(kh,eb),Yi,null,0)}if(Md.wHa()||0<Qd.ua.l4||0<Qd.Lk.l4)return!1;Je&&Md.Cr(Je);kf&&Qd.Dr(kf);xf&&Qd.Wz(xf);Ag.EwaSettings.qc()?Md.Zt(new Lh.a(507,0,og,80)):Md.Zt(new Yg.a(507,0,og,16));return!0}var Md=G.userOperationManager,Qd=G.na,Je=null,kf=null,xf=null;Tc()||(Je=function(){Tc()},kf=function(){Tc()},xf=function(){Tc()},
Md.Vu(Je),Qd.Bq(kf),Qd.dz(xf));return Oc.task}function Mg(G){if(Nc(G))return Ag.EwaSettings.getBooleanFeatureGate(Pf.a.uCb,!1)?"makerservicelocal":"localstorage";G=Pf.a.y_e();return Pf.a.cYh(G)}function dg(G,ia){Nc(G)&&(Ag.EwaSettings.getBooleanFeatureGate(Pf.a.uCb,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(G.ya.UserSessionId);makerstorage.setUserAccessInfo(new Nd(ia,null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,
"1")}function lc(G,ia){ia.WacTaskPaneInfra=Hb.a.Ld(G);ia.TaskpanelessRFB=Ag.EwaSettings.getBooleanFeatureGate(Pf.a.d8f,!1);ia.OfficeScriptsAutomateTask=Pf.a.Psf;ia.DeferAdminCheck=Pf.a.Fta}function Nc(G){return"TestHost"===G.ya.DocumentHostInfo.HostTier}function Nd(G,ia){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=G;this.currentUserMlapiToken=ia}function le(){}function ke(){this.uy=null;return this}function xd(G,ia,eb,Fb,Oc){this.value=G;this.isSuccess=ia;this.timeStamp=
void 0===eb?null:eb;this.errorCode=void 0===Fb?"":Fb;this.errorMessage=void 0===Oc?"":Oc}function fc(){this.uy=null}function fe(G,ia){this.rD=null;this.$=G;this.pf=ia;return this}function oa(G){this.N$=Fa.b(G)||{};this.shareId=this.shareId||null}function fb(G,ia){this.scripts=G;this.T4f=ia}function Rb(G,ia){this.automateCommandManager=G;this.$=ia}function dc(){this.rD=null}function uc(G,ia,eb){var Fb,Oc;this.$=G;this.oAuthManager=ia;this.Wu=eb;this.Fob=new Bd;this.Fse=null!==(Oc=null===(Fb=this.oAuthManager)||
void 0===Fb?void 0:Fb.V5a())&&void 0!==Oc?Oc:!1}function Bd(){this.token=null;this.timeStamp=0}function Od(G){return vj.call(this,G)||this}function Td(G,ia){this.automateCommandManager=G;this.$=ia}function Ze(G){var ia=Yj.call(this)||this;ia.$=G;ia.Tb();return ia}function vf(G){this.Gb=null;this.$=G}function wf(){return be.call(this)||this}function Wf(){return be.call(this)||this}function ug(){return be.call(this)||this}function Gg(){return be.call(this)||this}function Cf(){return be.call(this)||
this}function rg(){return be.call(this)||this}function dh(){return be.call(this)||this}function fh(){return be.call(this)||this}function vg(){return be.call(this)||this}function Me(){return be.call(this)||this}function Of(){return be.call(this)||this}function ac(){return be.call(this)||this}function Lc(){return be.call(this)||this}function wd(){return be.call(this)||this}function Mc(){return be.call(this)||this}function ge(){return be.call(this)||this}function nf(){return be.call(this)||this}function Ee(){return be.call(this)||
this}function ya(){return be.call(this)||this}function Cb(){return be.call(this)||this}function cc(){return be.call(this)||this}function Rc(){return be.call(this)||this}function yd(){return be.call(this)||this}function od(){return be.call(this)||this}function ze(){return be.call(this)||this}function gf(){return be.call(this)||this}function of(){return be.call(this)||this}function tg(){return be.call(this)||this}function Fe(){return be.call(this)||this}function hh(){return be.call(this)||this}function Dg(){return be.call(this)||
this}function pg(){return be.call(this)||this}function Fc(){return be.call(this)||this}function jd(){return be.call(this)||this}function td(){return be.call(this)||this}function ue(){return be.call(this)||this}function He(){return be.call(this)||this}function bf(){return be.call(this)||this}function Rf(){return be.call(this)||this}function ig(){return be.call(this)||this}function Vf(){return be.call(this)||this}function Qf(){return be.call(this)||this}function df(){return be.call(this)||this}function hg(){return be.call(this)||
this}function re(){return be.call(this)||this}function se(){return be.call(this)||this}function wg(){return be.call(this)||this}function Mf(){return be.call(this)||this}function zh(){return be.call(this)||this}function Da(){return be.call(this)||this}function Ib(){return be.call(this)||this}function Ic(){return be.call(this)||this}function Gd(){return be.call(this)||this}function Sd(){return be.call(this)||this}function We(){return be.call(this)||this}function Ne(){return be.call(this)||this}function Se(){return be.call(this)||
this}function Ka(){return jf.call(this,195,16)||this}function bb(){return jf.call(this,194,8)||this}function Yb(){return be.call(this)||this}function Ec(){return jf.call(this,198,2)||this}function ad(){return jf.call(this,197,1)||this}function Rd(){return jf.call(this,196,32)||this}function ce(){return be.call(this)||this}function Ue(){return jf.call(this,193,4)||this}function jf(G,ia){var eb=be.call(this)||this;eb.qfa=G;eb.CZd=ia;return eb}function Hf(){return be.call(this)||this}function bg(){return be.call(this)||
this}function Dd(){return be.call(this)||this}function oc(){return be.call(this)||this}function nc(){return be.call(this)||this}function cf(){return be.call(this)||this}function Jg(){return Fg.call(this,11,16)||this}function Re(){return Fg.call(this,10,128)||this}function ve(){return be.call(this)||this}function zf(){return be.call(this)||this}function zg(){return be.call(this)||this}function Ed(){return be.call(this)||this}function rf(){return be.call(this)||this}function Uf(){return be.call(this)||
this}function lg(){return be.call(this)||this}function ni(){return be.call(this)||this}function he(){return be.call(this)||this}function Ke(){return Fg.call(this,9,2)||this}function Qg(){return Fg.call(this,8,1)||this}function Rg(){return Fg.call(this,7,8)||this}function Oe(){return Fg.call(this,6,32)||this}function Df(){return be.call(this)||this}function Zg(){return be.call(this)||this}function qh(){return be.call(this)||this}function Xi(){return be.call(this)||this}function uh(){return be.call(this)||
this}function Sf(){return be.call(this)||this}function ji(){return be.call(this)||this}function Uh(){return be.call(this)||this}function sh(){return be.call(this)||this}function Jh(){return be.call(this)||this}function Dh(){return be.call(this)||this}function Og(){return be.call(this)||this}function oi(){return be.call(this)||this}function $h(){return be.call(this)||this}function Ch(){return Fg.call(this,4,64)||this}function Gh(){return be.call(this)||this}function Oi(){return be.call(this)||this}
function Di(){return be.call(this)||this}function nh(){return be.call(this)||this}function Vg(){return be.call(this)||this}function li(){return be.call(this)||this}function wh(){return be.call(this)||this}function Hi(){}function lh(){return be.call(this)||this}function kg(){return Fg.call(this,3,4)||this}function Fg(G,ia){var eb=be.call(this)||this;eb.qfa=G;eb.CZd=ia;return eb}function xi(){return be.call(this)||this}function Ng(){return be.call(this)||this}function Sh(){return be.call(this)||this}
function Gi(){return be.call(this)||this}function ag(){return nb.call(this,185,18)||this}function pi(){return be.call(this)||this}function Th(){return nb.call(this,181,14)||this}function xh(){return nb.call(this,169,2)||this}function Ea(){return nb.call(this,168,1)||this}function ua(){return be.call(this)||this}function Ab(){return nb.call(this,182,15)||this}function Xd(){return be.call(this)||this}function oe(){return be.call(this)||this}function yf(){return nb.call(this,180,13)||this}function Pg(){return nb.call(this,
186,19)||this}function Af(){return nb.call(this,175,8)||this}function ch(){return nb.call(this,176,9)||this}function Xg(){return nb.call(this,187,20)||this}function vh(){return nb.call(this,174,7)||this}function ci(){return nb.call(this,179,12)||this}function Ih(){return nb.call(this,178,11)||this}function Ae(){return nb.call(this,177,10)||this}function zi(){return be.call(this)||this}function ph(){return nb.call(this,170,3)||this}function yg(){return nb.call(this,172,5)||this}function na(){return nb.call(this,
173,6)||this}function sb(){return nb.call(this,183,16)||this}function Wb(){return nb.call(this,184,17)||this}function Dc(){return nb.call(this,171,4)||this}function nb(G,ia){var eb=be.call(this)||this;eb.qfa=G;eb.opType=ia;return eb}function Yc(){return be.call(this)||this}function ee(){return be.call(this)||this}function ye(){return be.call(this)||this}function lf(){return be.call(this)||this}function Ef(){return be.call(this)||this}function O(){return be.call(this)||this}function da(){return be.call(this)||
this}function Pa(){return be.call(this)||this}function rb(){return be.call(this)||this}function d(){return be.call(this)||this}function A(){return be.call(this)||this}function S(){return be.call(this)||this}function ja(){return be.call(this)||this}function Ua(){return be.call(this)||this}function kc(){return be.call(this)||this}function tb(){return be.call(this)||this}function $c(){return be.call(this)||this}function zd(){return be.call(this)||this}function qe(){return be.call(this)||this}function Te(){return be.call(this)||
this}function qf(){return be.call(this)||this}function la(){return fi.call(this)||this}function ab(){return be.call(this)||this}function ec(){return be.call(this)||this}function Vc(){return be.call(this)||this}function Kc(){return be.call(this)||this}function Fd(){return be.call(this)||this}function te(){return be.call(this)||this}function hf(){return be.call(this)||this}function Yf(){return be.call(this)||this}function mg(){return be.call(this)||this}function cg(){return Ai.call(this,78,[-105,-106,
-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function Sg(){return Ai.call(this,79,[0,1,2,-102])||this}function $g(){return Ai.call(this,75,[-101])||this}function ti(){return Ai.call(this,81,[100,101,102,103,104,105,106])||this}function Hh(){return be.call(this)||this}function Lg(){return Ai.call(this,85,[328,329,330,331,332,333,334,335])||this}function Tg(){return fi.call(this)||this}function Vh(G,
ia,eb){this.response=this.request=this.eventId=this.source=null;G&&(this.source=G.source,this.eventId=G.eventId,this.request=ia,this.response=eb)}function fi(){return be.call(this)||this}function Gj(){return Ai.call(this,83,[500,501,502])||this}function Zi(){return Ai.call(this,76,[-100])||this}function Sj(){return Ai.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function oh(){return Ai.call(this,80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])||this}function Li(){return Ai.call(this,
84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function Ai(G,ia){var eb=be.call(this)||this;eb.qfa=G;eb.qUj=ia;return eb}function Ri(){return be.call(this)||this}function ki(){return be.call(this)||this}function Pi(){return be.call(this)||this}function Ni(){return be.call(this)||this}function be(){this.wIc=this.xIc=this.vOc=this.TSc=null}function V(G,ia,eb){var Fb=this;this.X9b=null;this.cxi=function(Oc,Tc){Fb.M1f()&&Fb.Jad(Tc)};this.oof=ia;this.nof=eb;this.$=G;this.$.Eba&&this.$.KFg(this.cxi);
G.da.Ga(297,this)}function Ga(){}function Bb(){}function gc(){this.Ngb=null}function dd(){this.tb=null}function sd(G){this._initialized=!1;this.t$a={};this.$yc={};this.OO=Tf.AFrameworkApplication.ta.JD;this.xkd=G}function ie(G,ia,eb){this.expiration=this.authority=this.accessToken=null;this.accessToken=G;this.authority=ia;this.expiration=eb}function Ce(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}function af(){this.authority=this.userId=this.upn=
null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}function ff(){}function fg(G,ia){this.requestCallback=this.requestParameters=null;this.requestParameters=G;this.requestCallback=ia}function Ig(){}b.r(C);var ah=b(557),bh=b(1161),me=b(0),$e=b(14),Kh=b(82),Ph;(function(G){G[G.generalException=0]="generalException";G[G.invalidArgument=1]="invalidArgument";
G[G.notAllowed=2]="notAllowed";G[G.apiNotAvailable=3]="apiNotAvailable";G[G.unresolvedPendingRequest=4]="unresolvedPendingRequest";G[G.timeout=5]="timeout";G[G.adalTimeout=6]="adalTimeout";G[G.userNotSignedIn=7]="userNotSignedIn";G[G.userAborted=8]="userAborted";G[G.silentSignInFailed=9]="silentSignInFailed";G[G.invalidResourceUrl=10]="invalidResourceUrl";G[G.invalidGrant=11]="invalidGrant";G[G.connectionLost=12]="connectionLost";G[G.clientError=13]="clientError";G[G.serverError=14]="serverError"})(Ph||
(Ph={}));Object(me.b)("ErrorCodes",Ph);Ig.eEf="OneDriveWOPI";Object(me.a)(Ig,"HostApplicationType",null,[]);Object(me.a)(fg,"OutstandingRequest",null,[]);ff.QCi="AADSTS50058";ff.invalidResourceUrl="AADSTS50001";ff.LCi="AADSTS65001";ff.aDi="AADSTS70011";ff.userAborted="13002";ff.bZi="Popup Window is null";ff.aZi="Popup Window closed";ff.adalTimeout="Token renewal operation failed due to timeout";ff.YJj="tokenRevoked";Object(me.a)(ff,"WopiHostErrorType",null,[]);var Tf=b(4),Qi=b(942),T=b(636),ra=b(41);
af.IIh=function(G){switch(G){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object(me.a)(af,"WopiAuthContext",null,[189]);Object(me.a)(Ce,"WopiIdentityInfo",null,[188]);Object(me.a)(ie,"WopiIdentityToken",null,[187]);var hb=b(24),Eb=b(152),sc=b(390),vb=b(168),Wc=b(77),Zd=b(355);sd.prototype.b2a=function(G){this._initialized||(G.io(vb.a.XGf),G.Rl(vb.a.XGf,Object(Kh.a)(this,this.IPi,"onReceivedAccessToken")),this._initialized=!0)};sd.prototype.getAccessToken=
function(G,ia,eb){var Fb=this;eb=void 0===eb?null:eb;this.RNa(G,ia);return new Promise(function(Oc,Tc){if(Fb.Vmd(ia))if(ia in Fb.t$a)Tc("unresolvedPendingRequest");else{var Md=window.setTimeout(function(){var Je={};$e.ULS.sendTraceTag(37856032,344,10,ra.c((Je.error="Request timeout.",Je.callerId=ia,Je)));Tc("timeout")},12E4);Fb.Hcd(G,ia,eb,function(Je,kf){window.clearTimeout(Md);Je?Oc(Je):(Je={},$e.ULS.sendTraceTag(37856033,369,15,ra.c((Je.error=Ph[kf],Je))),Tc(kf))})}else{var Qd={};$e.ULS.sendTraceTag(37856034,
344,10,ra.c((Qd.error="Caller is not allowed.",Qd)));Tc("notAllowed")}})};sd.prototype.getPrimaryIdentityInfo=function(G){var ia=this;return new Promise(function(eb,Fb){if(ia.Vmd(G))ia.AUh(function(Tc,Md){Tc?eb(Tc):(Tc={},$e.ULS.sendTraceTag(37856064,369,10,ra.c((Tc.error=Md.toString(),Tc))),Fb(Md))});else{var Oc={};$e.ULS.sendTraceTag(37856065,344,10,ra.c((Oc.error="Caller is not allowed.",Oc)));Fb("notAllowed")}})};sd.prototype.getAuthContext=function(G){var ia=this;return new Promise(function(eb,
Fb){var Oc=ia.getAuthContextSync(G);Oc?eb(Oc):Fb("notAllowed")})};sd.prototype.getAuthContextSync=function(G){if(this.Vmd(G)){var ia=new af;ia.upn=Tf.AFrameworkApplication.ga.Ua("UserPrincipalName");ia.userId=Tf.AFrameworkApplication.ga.Ua("LoggableUserId");ia.authority=Tf.AFrameworkApplication.ga.Ua("HostAuthAuthority");ia.tenantId=Tf.AFrameworkApplication.ga.Ua("TenantId");ia.isAnonymous=Tf.AFrameworkApplication.ga.ra("IsAnonymousUser");ia.supportsAuthToken=this.U6h(G);G=Tf.AFrameworkApplication.ga.Ua("HostAuthType");
ia.authorityType="aad"===G.toLowerCase()?2:"msa"===G.toLowerCase()?1:0;return ia}ia={};$e.ULS.sendTraceTag(40751647,344,10,ra.c((ia.error="Caller is not allowed.",ia)));return null};sd.prototype.U6h=function(G){var ia=Qi.a.Axb;return hb.a.Nka?ia&&Qi.a.i8f?Array.contains(Qi.a.i8f,G.toLowerCase()):!1:ia};sd.prototype.Hcd=function(G,ia,eb,Fb){var Oc=this,Tc=[];Array.add(Tc,Object.assign(new Wc.a,{name:"CallerId",string:ia}));Array.add(Tc,Object.assign(new Wc.a,{name:sc.a.vTd,string:G.correlationId}));
Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Tc}));Tc=T.a.create().toString();var Md="getAccessToken_"+Tc,Qd=this.OO.Gc("ComponentAttach",Md);this.$yc[Md]=Qd;var Je={};Je[sc.a.wTd]=Tc;Je[sc.a.tDj]=G.resource;Je[sc.a.uDj]=G.scope;Je[sc.a.j5f]=Tf.AFrameworkApplication.ga.Ua("HostAuthType");Je[sc.a.xDj]=Tf.AFrameworkApplication.ga.Ua("UserPrincipalName");Je[sc.a.vDj]=G.silentLogin;Je[sc.a.qDj]=G.options;Je[sc.a.vTd]=
G.correlationId;Je[sc.a.rDj]=ia;eb&&(Je[sc.a.addinName]=eb.AddinName,Je[sc.a.pDj]=eb.AddinTrustId);this.xkd.execute(function(kf){Oc.b2a(kf);kf.Hj(vb.a.getAuthToken,Je)});this.t$a[Tc]=new fg(G,Fb)};sd.prototype.AUh=function(G){var ia=Tf.AFrameworkApplication.ga.Ua("UserName"),eb=Tf.AFrameworkApplication.ga.Ua("UserPrincipalName"),Fb=Tf.AFrameworkApplication.ga.Ua("LoggableUserIdSpace"),Oc=new Ce;Oc.email=eb;Oc.displayName=ia;switch(Fb){case "OrgIdPuid":Oc.authority="AzureActiveDirectoryAccount";break;
case "MsaCid":case "MsaPuid":Oc.authority="MicrosoftAccount";break;default:Oc.authority=Fb}G(Oc,null)};sd.prototype.IPi=function(G){var ia=null;try{var eb=G.Values[sc.a.wTd],Fb=G.Values[sc.a.oDj],Oc=G.Values[sc.a.j5f],Tc=G.Values[sc.a.wDj],Md=null,Qd=null,Je=this.t$a[eb];if("undefined"!==typeof Je&&Je){var kf=[];Array.add(kf,Object.assign(new Wc.a,{name:sc.a.vTd,string:Je.requestParameters.correlationId}));Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",
dataFields:kf}));ia=Je.requestCallback;delete this.t$a[eb];"undefined"!==typeof Fb&&Fb&&Fb.length?Qd=new ie(Fb,Oc,Tc):Md=Ph[this.Txi(G)];eb="getAccessToken_"+eb;eb in this.$yc&&(this.$yc[eb].stop(),delete this.$yc[eb]);ia(Qd,Md)}else Md={},$e.ULS.sendTraceTag(37856066,344,10,ra.c((Md.error="No matching outstanding request for request ID.",Md.requestId=eb,Md)))}catch(xf){G=G.Values[sc.a.wTd],G in this.t$a&&delete this.t$a[G],this.gkc(),G={},$e.ULS.sendTraceTag(37856067,344,10,ra.c((G.error=xf.message,
G.stack=xf.stack,G))),ia&&ia(null,"generalException")}};sd.prototype.Vmd=function(G){var ia=Tf.AFrameworkApplication.t0h();G=G.toLowerCase();ia=El(ia);for(var eb=ia.next();!eb.done;eb=ia.next())if(G===eb.value.toLowerCase())return!0;ia=Qi.a.AWc;for(var Fb in ia)if(G===ia[Fb].toLowerCase())return!0;return!1};sd.prototype.Txi=function(G){G=G.Values[sc.a.sDj];this.gkc();var ia={};$e.ULS.sendTraceTag(39068821,344,15,ra.c((ia.error=G,ia)));return G?-1<G.indexOf(ff.QCi)?9:-1<G.indexOf(ff.bZi)||-1<G.indexOf(ff.aZi)?
12:-1<G.indexOf(ff.invalidResourceUrl)?10:-1<G.indexOf(ff.userAborted)?8:-1<G.indexOf(ff.aDi)||-1<G.indexOf(ff.LCi)||G===ff.YJj?11:-1<G.indexOf(ff.adalTimeout)?6:0:13};sd.prototype.RNa=function(G,ia){G=this.s6i(G.resource);var eb={};$e.ULS.sendTraceTag(39921882,344,50,ra.c((eb.callerId=ia,eb.resource=G,eb)))};sd.prototype.gkc=function(){var G={};$e.ULS.sendTraceTag(39068822,344,50,ra.c((G.userAgent=window.navigator.userAgent,G)))};sd.prototype.s6i=function(G){return(G?G:"").replace("://","__").replace(RegExp("\\.",
"g"),"_dot_").replace("/","\\")};Object(me.a)(sd,"WopiIdentityManager",null,[164]);var uf=b(255);dd.prototype.ei=function(G){this.tb=G;G.register(sd,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Hc().Oc(function(){return new sd(G.lc("Postmessage.IHostPostmessenger"))})};dd.prototype.init=function(){Tf.AFrameworkApplication.ga&&Tf.AFrameworkApplication.ga.sv(Object(Kh.a)(this,this.EB,"onFullAppSettingsReady"))};dd.prototype.EB=function(){try{this.tb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(G){$e.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+G)}};dd.prototype.dispose=function(){};dd.main=function(){uf.a.instance.hj(new dd)};Ek.Object.defineProperties(dd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});Object(me.a)(dd,"WopiIdentityPackage",null,[4,5]);var If=b(11),ng=b(228),gg=b(202),Wh=b(649);gc.prototype.uei=function(G){return this.nNg.contains(G.operation)};gc.prototype.INj=function(G){for(var ia=[],eb=El(G.payload.batchedOperations),
Fb=eb.next();!Fb.done;Fb=eb.next())ia.push(new Wh.a(G.operation,Fb.value));return ia};Ek.Object.defineProperties(gc.prototype,{nNg:{configurable:!0,enumerable:!0,get:function(){this.Ngb||(this.Ngb=new gg.a,this.Ngb.add(12),this.Ngb.add(11));return this.Ngb}}});Object(me.a)(gc,"MacroRecorderBatchedEventList",null,[]);var di=b(56),uj=b(125),qj=b(738);Bb.prototype.equals=function(G,ia){return G===ia};Bb.prototype.getHashCode=function(G){return G};Bb.prototype.qja=function(G){return G};Object(me.a)(Bb,
"UserOperationNameComparer",null,[30,31]);Ga.r0h=function(){Ga.Rc||(Ga.Rc=new qj.a(new Bb),Ga.Rc.add(507),Ga.Rc.add(10),Ga.Rc.add(576),Ga.Rc.add(563),Ga.Rc.add(564),Ga.Rc.add(565),Ga.Rc.add(566),Ga.Rc.add(567),Ga.Rc.add(568),Ga.Rc.add(569),Ga.Rc.add(570),Ga.Rc.add(571),Ga.Rc.add(572),Ga.Rc.add(573),Ga.Rc.add(574),Ga.Rc.add(575),Ga.Rc.add(501),Ga.Rc.add(520),Ga.Rc.add(1),Ga.Rc.add(1002),Ga.Rc.add(129),Ga.Rc.add(198),Ga.Rc.add(500),Ga.Rc.add(519),Ga.Rc.add(538),Ga.Rc.add(1E3),Ga.Rc.add(1003),Ga.Rc.add(144),
Ga.Rc.add(502),Ga.Rc.add(505),Ga.Rc.add(179),Ga.Rc.add(205),Ga.Rc.add(134),Ga.Rc.add(230),Ga.Rc.add(103),Ga.Rc.add(110),Ga.Rc.add(112),Ga.Rc.add(113),Ga.Rc.add(124),Ga.Rc.add(133),Ga.Rc.add(154),Ga.Rc.add(162),Ga.Rc.add(168),Ga.Rc.add(172),Ga.Rc.add(201),Ga.Rc.add(222),Ga.Rc.add(227),Ga.Rc.add(513),Ga.Rc.add(534),Ga.Rc.add(539),Ga.Rc.add(545),Ga.Rc.add(600),Ga.Rc.add(547),Ga.Rc.add(555),Ga.Rc.add(558),Ga.Rc.add(562),Ga.Rc.add(585),Ga.Rc.add(1001),Ga.Rc.add(1005),Ga.Rc.add(1008),Ga.Rc.add(1010),Ga.Rc.add(1011),
Ga.Rc.add(1012),Ga.Rc.add(1018),Ga.Rc.add(252),Ga.Rc.add(253),Ga.Rc.add(258),Ga.Rc.add(101),Ga.Rc.add(102),Ga.Rc.add(108),Ga.Rc.add(118),Ga.Rc.add(257),Ga.Rc.add(119),Ga.Rc.add(120),Ga.Rc.add(123),Ga.Rc.add(126),Ga.Rc.add(127),Ga.Rc.add(130),Ga.Rc.add(140),Ga.Rc.add(159),Ga.Rc.add(160),Ga.Rc.add(165),Ga.Rc.add(166),Ga.Rc.add(167),Ga.Rc.add(169),Ga.Rc.add(189),Ga.Rc.add(223),Ga.Rc.add(214),Ga.Rc.add(228),Ga.Rc.add(233),Ga.Rc.add(247),Ga.Rc.add(504),Ga.Rc.add(511),Ga.Rc.add(512),Ga.Rc.add(525),Ga.Rc.add(533),
Ga.Rc.add(537),Ga.Rc.add(542),Ga.Rc.add(544),Ga.Rc.add(548),Ga.Rc.add(550),Ga.Rc.add(551),Ga.Rc.add(552),Ga.Rc.add(554),Ga.Rc.add(577),Ga.Rc.add(584),Ga.Rc.add(586),Ga.Rc.add(587),Ga.Rc.add(588),Ga.Rc.add(592),Ga.Rc.add(1009),Ga.Rc.add(1016),Ga.Rc.add(1017));return Ga.Rc};Ga.Rc=null;Object(me.a)(Ga,"MacroRecorderUnrecognizedEventList",null,[]);V.prototype.init=function(G){this.$.Eba&&(G?this.X9b=G:$e.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};
V.prototype.Jad=function(G){if(this.M1f())try{if(this.nof.uei(G))for(var ia=this.nof.INj(G),eb=El(ia),Fb=eb.next();!Fb.done;Fb=eb.next())this.zTe(Fb.value);else this.zTe(G)}catch(Oc){G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",uj.a(G.operation),Oc.stack),$e.ULS.sendTraceTag(537155423,0,10,G)}};V.prototype.zTe=function(G){var ia=this.oof.w_e(G,!0);ia?(this.X9b(ia.eventId,di.a.Kc(G.payload)),G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",
ia.eventId),$e.ULS.sendTraceTag(537155422,0,50,G)):(ia=this.oof.w_e(G,!1))?(G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",ia.eventId),$e.ULS.sendTraceTag(537155421,0,50,G)):Ga.r0h().contains(G.operation)||(this.X9b(0,di.a.Kc(G.operation)),G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",uj.a(G.operation)),$e.ULS.sendTraceTag(537155420,0,50,G))};V.prototype.M1f=function(){return this.$.Dka&&this.X9b&&
this.$.Aba?!0:!1};Object(me.a)(V,"MacroRecorderEventHandler",null,[755]);var Ag=b(1);be.prototype.sg=function(){};be.prototype.gwa=function(){};be.prototype.Bd=function(G){this.LCc.add(G)};be.prototype.Vb=function(G){this.operations.contains(G)||this.operations.add(G)};be.prototype.dnb=function(){this.featureGates.add(679)};be.prototype.tle=function(G){this.cSe.add(G)};Ek.Object.defineProperties(be.prototype,{operations:{configurable:!0,enumerable:!0,get:function(){this.vOc||(this.vOc=new gg.a,this.mc());
return this.vOc}},LCc:{configurable:!0,enumerable:!0,get:function(){this.TSc||(this.TSc=new gg.a,this.sg());return this.TSc}},cSe:{configurable:!0,enumerable:!0,get:function(){this.wIc||(this.wIc=new gg.a);return this.wIc}},featureGates:{configurable:!0,enumerable:!0,get:function(){this.xIc||(this.xIc=new gg.a,this.gwa());return this.xIc}}});Object(me.a)(be,"MacroRecorderEventBase",null,[]);Am(Ni,be);Ni.prototype.mc=function(){this.Vb(100)};Ek.Object.defineProperties(Ni.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 130}}});Object(me.a)(Ni,"AccessibilityCheckRunEvent",be,[]);Am(Pi,be);Pi.prototype.mc=function(){this.Vb(241)};Pi.prototype.sg=function(){this.Bd(function(G){return G.addToPrintArea})};Ek.Object.defineProperties(Pi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 160}}});Object(me.a)(Pi,"AddedToPrintAreaEvent",be,[]);Am(ki,be);ki.prototype.mc=function(){this.Vb(516)};Ek.Object.defineProperties(ki.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 65}}});Object(me.a)(ki,"AutoFilterToggledEvent",be,[]);Am(Ri,be);Ri.prototype.mc=function(){this.Vb(502)};Ri.prototype.sg=function(){this.Bd(function(G){return!(G.q4a().FirstColumn===G.q4a().LastColumn&&G.q4a().FirstRow===G.q4a().LastRow)})};Ek.Object.defineProperties(Ri.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(me.a)(Ri,"AutoSumEvent",be,[]);Am(Ai,be);Ai.prototype.mc=function(){this.Vb(529);this.Vb(594)};Ai.prototype.sg=function(){var G=
this;this.Bd(function(ia){return Array.contains(G.qUj,ia.Kfd())})};Ek.Object.defineProperties(Ai.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.qfa}}});Object(me.a)(Ai,"ChartPropertyAppliedEventBase",be,[]);Am(Li,Ai);Object(me.a)(Li,"ChartAxisChangedEvent",Ai,[]);Am(oh,Ai);Object(me.a)(oh,"ChartAxisTitleChangedEvent",Ai,[]);Am(Sj,Ai);Object(me.a)(Sj,"ChartDataLabelsChangedEvent",Ai,[]);Am(Zi,Ai);Object(me.a)(Zi,"ChartDataSelectedEvent",Ai,[]);Am(Gj,Ai);Object(me.a)(Gj,
"ChartDataTableChangedEvent",Ai,[]);var Eg=b(616),Jj=b(438),Fi=b(83);Am(fi,be);Object(me.a)(fi,"RichApiRequestExecutedEventBase",be,[]);Ek.Object.defineProperties(Vh.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}});Object(me.a)(Vh,"MacroRecorderRichApiRequestExecutedPayload",null,[445]);Am(Tg,fi);Tg.prototype.sF=function(G){Tg.d7||(Tg.d7=new qj.a(Eg.a.Pk()),Tg.d7.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),
Tg.d7.add("fa000000014"));return!!G&&Tg.d7.contains(G.toLowerCase())};Tg.prototype.mc=function(){this.Vb(507);this.Vb(10);this.Vb(576)};Tg.prototype.sg=function(){var G=this;this.Bd(function(ia){return Object(Jj.a)(Vh,ia)&&(ia=Object(Fi.a)(Vh,ia),ia.isValid&&G.sF(ia.source))?($e.ULS.sendTraceTag(537155427,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",ia.eventId),!0):!1})};Ek.Object.defineProperties(Tg.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 117}}});Tg.d7=null;Object(me.a)(Tg,"ChartFormatRichApiRequestExecutedEvent",fi,[]);Am(Lg,Ai);Object(me.a)(Lg,"ChartGridlinesChangedEvent",Ai,[]);Am(Hh,be);Hh.prototype.mc=function(){this.Vb(528)};Ek.Object.defineProperties(Hh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});Object(me.a)(Hh,"ChartInsertedEvent",be,[]);Am(ti,Ai);Object(me.a)(ti,"ChartLegendChangedEvent",Ai,[]);Am($g,Ai);Object(me.a)($g,"ChartRowColumnSwitchedEvent",Ai,[]);Am(Sg,Ai);
Object(me.a)(Sg,"ChartTitleChangedEvent",Ai,[]);Am(cg,Ai);Object(me.a)(cg,"ChartTypeChangedEvent",Ai,[]);Am(mg,be);mg.prototype.mc=function(){this.Vb(521)};Ek.Object.defineProperties(mg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object(me.a)(mg,"ConnectorFloatingObjectResizedEvent",be,[]);Am(Yf,be);Yf.prototype.mc=function(){this.Vb(109)};Ek.Object.defineProperties(Yf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object(me.a)(Yf,
"EntitySelectedEvent",be,[]);Am(hf,be);hf.prototype.mc=function(){this.Vb(149);this.Vb(147)};Ek.Object.defineProperties(hf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(me.a)(hf,"FindCellEvent",be,[]);Am(te,be);te.prototype.mc=function(){this.Vb(122)};Ek.Object.defineProperties(te.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 96}}});Object(me.a)(te,"FloatingObjectAltTextAppliedEvent",be,[]);Am(Fd,be);Fd.prototype.mc=function(){this.Vb(522)};
Ek.Object.defineProperties(Fd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(me.a)(Fd,"FloatingObjectDeletedEvent",be,[]);Am(Kc,be);Kc.prototype.mc=function(){this.Vb(524)};Ek.Object.defineProperties(Kc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(me.a)(Kc,"FloatingObjectMovedAndResizedEvent",be,[]);Am(Vc,be);Vc.prototype.mc=function(){this.Vb(523)};Ek.Object.defineProperties(Vc.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 95}}});Object(me.a)(Vc,"FloatingObjectRotatedEvent",be,[]);Am(ec,be);ec.prototype.mc=function(){this.Vb(543)};Ek.Object.defineProperties(ec.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object(me.a)(ec,"GroupDetailsShownOrHiddenEvent",be,[]);Am(ab,be);ab.prototype.mc=function(){this.Vb(125)};Ek.Object.defineProperties(ab.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(me.a)(ab,"HyperlinksRemovedFromRangeEvent",
be,[]);Am(la,fi);la.prototype.sF=function(G){la.d7||(la.d7=new qj.a(Eg.a.Pk()),la.d7.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),la.d7.add("fa000000005"));return!!G&&la.d7.contains(G.toLowerCase())};la.prototype.mc=function(){this.Vb(507);this.Vb(10);this.Vb(576)};la.prototype.sg=function(){var G=this;this.Bd(function(ia){return Object(Jj.a)(Vh,ia)?(ia=Object(Fi.a)(Vh,ia),ia.isValid&&G.sF(ia.source)):!1})};Ek.Object.defineProperties(la.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});
la.d7=null;Object(me.a)(la,"IdeasRichApiRequestExecutedEvent",fi,[]);Am(qf,be);qf.prototype.mc=function(){this.Vb(115)};Ek.Object.defineProperties(qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});Object(me.a)(qf,"LinkedEntityConvertedEvent",be,[]);Am(Te,be);Te.prototype.mc=function(){this.Vb(114)};Ek.Object.defineProperties(Te.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(me.a)(Te,"LinkedEntityDisambiguationPaneToggledEvent",
be,[]);Am(qe,be);qe.prototype.mc=function(){this.Vb(119)};Ek.Object.defineProperties(qe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object(me.a)(qe,"MovedToEdgeEvent",be,[]);Am(zd,be);zd.prototype.mc=function(){this.Vb(191)};zd.prototype.gwa=function(){this.dnb()};Ek.Object.defineProperties(zd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 135}}});Object(me.a)(zd,"NamedSheetViewCreatedEvent",be,[]);Am($c,be);$c.prototype.mc=function(){this.Vb(200)};
$c.prototype.gwa=function(){this.dnb()};Ek.Object.defineProperties($c.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object(me.a)($c,"NamedSheetViewDeletedEvent",be,[]);Am(tb,be);tb.prototype.mc=function(){this.Vb(192)};tb.prototype.gwa=function(){this.dnb()};Ek.Object.defineProperties(tb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});Object(me.a)(tb,"NamedSheetViewExitedEvent",be,[]);Am(kc,be);kc.prototype.mc=function(){this.Vb(199)};
kc.prototype.gwa=function(){this.dnb()};Ek.Object.defineProperties(kc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object(me.a)(kc,"NamedSheetViewRenamedEvent",be,[]);Am(Ua,be);Ua.prototype.mc=function(){this.Vb(195)};Ua.prototype.gwa=function(){this.dnb()};Ek.Object.defineProperties(Ua.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object(me.a)(Ua,"NamedSheetViewSwitchedEvent",be,[]);Am(ja,be);ja.prototype.mc=function(){this.Vb(174)};
Ek.Object.defineProperties(ja.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(me.a)(ja,"OutlineLevelSetEvent",be,[]);Am(S,be);S.prototype.mc=function(){this.Vb(244)};Ek.Object.defineProperties(S.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(me.a)(S,"PageBreakInsertedEvent",be,[]);Am(A,be);A.prototype.mc=function(){this.Vb(245)};Ek.Object.defineProperties(A.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});
Object(me.a)(A,"PageBreakRemovedEvent",be,[]);Am(d,be);d.prototype.mc=function(){this.Vb(246)};Ek.Object.defineProperties(d.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object(me.a)(d,"PageBreaksAllResetEvent",be,[]);Am(rb,be);rb.prototype.mc=function(){this.Vb(503)};rb.prototype.sg=function(){this.Bd(function(G){return!!G.pasteParameters.ClientEstimationFloatingObjectId&&2===G.pasteParameters.CopyPasteTargetType&&!G.isFromCurrentSession})};Ek.Object.defineProperties(rb.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(me.a)(rb,"PasteArtOtherWorkbookEvent",be,[]);Am(Pa,be);Pa.prototype.mc=function(){this.Vb(503)};Pa.prototype.sg=function(){this.Bd(function(G){return!!G.pasteParameters.ClientEstimationFloatingObjectId&&2===G.pasteParameters.CopyPasteTargetType&&G.isFromCurrentSession})};Ek.Object.defineProperties(Pa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});Object(me.a)(Pa,"PasteArtSameWorkbookEvent",
be,[]);Am(da,be);da.prototype.mc=function(){this.Vb(204)};Ek.Object.defineProperties(da.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object(me.a)(da,"PasteHtmlEvent",be,[]);Am(O,be);O.prototype.mc=function(){this.Vb(506)};Ek.Object.defineProperties(O.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(me.a)(O,"PasteRangeEvent",be,[]);Am(Ef,be);Ef.prototype.mc=function(){this.Vb(503)};Ef.prototype.sg=function(){this.Bd(function(G){return 1===
G.pasteParameters.CopyPasteTargetType})};Ek.Object.defineProperties(Ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object(me.a)(Ef,"PasteShadowWorkbookRangeEvent",be,[]);Am(lf,be);lf.prototype.mc=function(){this.Vb(180)};Ek.Object.defineProperties(lf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(me.a)(lf,"PasteStringEvent",be,[]);Am(ye,be);ye.prototype.mc=function(){this.Vb(220)};Ek.Object.defineProperties(ye.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 134}}});Object(me.a)(ye,"PendingMergeEvent",be,[]);Am(ee,be);ee.prototype.mc=function(){this.Vb(510)};Ek.Object.defineProperties(ee.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object(me.a)(ee,"PictureInsertedEvent",be,[]);Am(Yc,be);Yc.prototype.mc=function(){this.Vb(161)};Ek.Object.defineProperties(Yc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});Object(me.a)(Yc,"PivotDrillToggledEvent",be,[]);
Am(nb,be);nb.prototype.mc=function(){this.Vb(225)};nb.prototype.sg=function(){var G=this;this.Bd(function(ia){return ia.opType===G.opType})};Ek.Object.defineProperties(nb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.qfa}}});Object(me.a)(nb,"PivotTableSettingsChangedEventBase",be,[]);Am(Dc,nb);Object(me.a)(Dc,"PivotTableAllItemLabelsRepeatedEvent",nb,[]);Am(Wb,nb);Object(me.a)(Wb,"PivotTableAltTextDescriptionChangedEvent",nb,[]);Am(sb,nb);Object(me.a)(sb,"PivotTableAltTextTitleChangedEvent",
nb,[]);Am(na,nb);Object(me.a)(na,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",nb,[]);Am(yg,nb);Object(me.a)(yg,"PivotTableBlankLineAfterEachItemToggledEvent",nb,[]);Am(ph,nb);Object(me.a)(ph,"PivotTableColumnGrandTotalShownEvent",nb,[]);Am(zi,be);zi.prototype.mc=function(){this.Vb(132)};Ek.Object.defineProperties(zi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(me.a)(zi,"PivotTableCreatedEvent",be,[]);Am(Ae,nb);Object(me.a)(Ae,"PivotTableDisplayErrorStringToggledEvent",
nb,[]);Am(Ih,nb);Object(me.a)(Ih,"PivotTableDisplayNullStringToggledEvent",nb,[]);Am(ci,nb);Object(me.a)(ci,"PivotTableErrorStringChangedEvent",nb,[]);Am(vh,nb);Object(me.a)(vh,"PivotTableExpandCollapseButtonsShownEvent",nb,[]);Am(Xg,nb);Object(me.a)(Xg,"PivotTableIndentChangedEvent",nb,[]);Am(ch,nb);Object(me.a)(ch,"PivotTableItemsWithNoDataOnColumnsShownEvent",nb,[]);Am(Af,nb);Object(me.a)(Af,"PivotTableItemsWithNoDataOnRowsShownEvent",nb,[]);Am(Pg,nb);Object(me.a)(Pg,"PivotTableLayoutTypeSetEvent",
nb,[]);Am(yf,nb);Object(me.a)(yf,"PivotTableNullStringChangedEvent",nb,[]);Am(oe,be);oe.prototype.mc=function(){this.Vb(219)};Ek.Object.defineProperties(oe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(me.a)(oe,"PivotTablePivotLocationChangedEvent",be,[]);Am(Xd,be);Xd.prototype.mc=function(){this.Vb(145)};Ek.Object.defineProperties(Xd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});Object(me.a)(Xd,"PivotTablePivotedEvent",be,
[]);Am(Ab,nb);Object(me.a)(Ab,"PivotTableRefreshDataOnLoadToggledEvent",nb,[]);Am(ua,be);ua.prototype.mc=function(){this.Vb(50)};ua.prototype.sg=function(){this.Bd(function(G){return!!G.pivotTableId&&!!G.pivotTableName})};Ek.Object.defineProperties(ua.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object(me.a)(ua,"PivotTableRefreshedEvent",be,[]);Am(Ea,nb);Object(me.a)(Ea,"PivotTableRenamedEvent",nb,[]);Am(xh,nb);Object(me.a)(xh,"PivotTableRowGrandTotalShownEvent",
nb,[]);Am(Th,nb);Object(me.a)(Th,"PivotTableSaveSourceDataWithFileToggledEvent",nb,[]);var mj=b(704);Am(pi,be);pi.prototype.mc=function(){this.Vb(131)};pi.prototype.sg=function(){this.Bd(function(G){G=Object(Fi.a)(mj.a,G);return!!G&&!!G.eKa()&&!!G.hierarchyName})};Ek.Object.defineProperties(pi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(me.a)(pi,"PivotTableSortedEvent",be,[]);Am(ag,nb);Object(me.a)(ag,"PivotTableSubTotalsVisibilitySettingSetEvent",nb,[]);
Am(Gi,be);Gi.prototype.mc=function(){this.Vb(560)};Ek.Object.defineProperties(Gi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(me.a)(Gi,"PivotValueFieldSettingAppliedEvent",be,[]);Am(Sh,be);Sh.prototype.mc=function(){this.Vb(243)};Ek.Object.defineProperties(Sh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(me.a)(Sh,"PrintAreaClearedEvent",be,[]);Am(Ng,be);Ng.prototype.mc=function(){this.Vb(241)};Ng.prototype.sg=function(){this.Bd(function(G){return!G.addToPrintArea})};
Ek.Object.defineProperties(Ng.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(me.a)(Ng,"PrintAreaSetEvent",be,[]);Am(xi,be);xi.prototype.mc=function(){this.Vb(517)};Ek.Object.defineProperties(xi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 57}}});Object(me.a)(xi,"RangeAutoFilterClearedEvent",be,[]);Am(Fg,be);Fg.prototype.mc=function(){this.Vb(11)};Fg.prototype.sg=function(){var G=this;this.Bd(function(ia){return 16===ia.LZ().ValidMembers});
this.Bd(function(ia){return ia.LZ().Font.ValidMembers===G.CZd})};Ek.Object.defineProperties(Fg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.qfa}}});Object(me.a)(Fg,"RangeFontFormattedEventBase",be,[]);Am(kg,Fg);Object(me.a)(kg,"RangeBoldedEvent",Fg,[]);Am(lh,be);lh.prototype.mc=function(){this.Vb(11)};lh.prototype.sg=function(){this.Bd(function(G){return 128===G.LZ().ValidMembers})};Ek.Object.defineProperties(lh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 2}}});
Object(me.a)(lh,"RangeBorderedEvent",be,[]);Hi.p$a="Table";Hi.apc="Sheet";Object(me.a)(Hi,"MacroRecorderEventConstants",null,[]);Am(wh,be);wh.prototype.mc=function(){this.Vb(208)};wh.prototype.sg=function(){this.Bd(function(G){return G.getParameters().FilterType===Hi.apc})};Ek.Object.defineProperties(wh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(me.a)(wh,"RangeCheckedItemsFilteredEvent",be,[]);Am(li,be);li.prototype.mc=function(){this.Vb(106);this.Vb(105)};
Ek.Object.defineProperties(li.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object(me.a)(li,"RangeConditionalFormattingChangedEvent",be,[]);Am(Vg,be);Vg.prototype.mc=function(){this.Vb(221)};Ek.Object.defineProperties(Vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object(me.a)(Vg,"RangeConditionalFormattingRuleDeletedEvent",be,[]);Am(nh,be);nh.prototype.mc=function(){this.Vb(508)};nh.prototype.sg=function(){this.Bd(function(G){return 3===
G.cu()||1===G.cu()||4===G.cu()})};Ek.Object.defineProperties(nh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(me.a)(nh,"RangeContentClearedEvent",be,[]);Am(Di,be);Di.prototype.mc=function(){this.Vb(104)};Ek.Object.defineProperties(Di.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(me.a)(Di,"RangeCopiedCutCellsInsertedEvent",be,[]);Am(Oi,be);Oi.prototype.mc=function(){this.Vb(209)};Oi.prototype.sg=function(){this.Bd(function(G){return G.getParameters().FilterType===
Hi.apc})};Ek.Object.defineProperties(Oi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(me.a)(Oi,"RangeCustomFilteredEvent",be,[]);Am(Gh,be);Gh.prototype.mc=function(){this.Vb(121)};Ek.Object.defineProperties(Gh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(me.a)(Gh,"RangeDataValidationChangedEvent",be,[]);Am(Ch,Fg);Object(me.a)(Ch,"RangeDoubleUnderlinedEvent",Fg,[]);Am($h,be);$h.prototype.mc=function(){this.Vb(190)};
Ek.Object.defineProperties($h.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object(me.a)($h,"RangeDuplicatesRemovedEvent",be,[]);Am(oi,be);oi.prototype.mc=function(){this.Vb(527);this.Vb(12)};Ek.Object.defineProperties(oi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(me.a)(oi,"RangeEditedEvent",be,[]);Am(Og,be);Og.prototype.mc=function(){Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Vb(255):this.Vb(232)};Og.prototype.sg=function(){this.Bd(function(G){return 4===G.actionType})};Ek.Object.defineProperties(Og.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 164}}});Object(me.a)(Og,"RangeExternalLinksBrokeAllLinksEvent",be,[]);Am(Dh,be);Dh.prototype.mc=function(){Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Vb(255):this.Vb(232)};Dh.prototype.sg=function(){this.Bd(function(G){return 3===G.actionType})};
Ek.Object.defineProperties(Dh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(me.a)(Dh,"RangeExternalLinksBrokeLinkEvent",be,[]);Am(Jh,be);Jh.prototype.mc=function(){Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Vb(256):this.Vb(249)};Jh.prototype.gwa=function(){this.tle("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};Ek.Object.defineProperties(Jh.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 205}}});Object(me.a)(Jh,"RangeExternalLinksChangeSourceEvent",be,[]);Am(sh,be);sh.prototype.mc=function(){this.Vb(553)};sh.prototype.sg=function(){this.Bd(function(G){return 1===G.actionType})};Ek.Object.defineProperties(sh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object(me.a)(sh,"RangeExternalLinksRefreshedAllEvent",be,[]);Am(Uh,be);Uh.prototype.mc=function(){this.Vb(553)};Uh.prototype.sg=function(){this.Bd(function(G){return 0===G.actionType})};
Ek.Object.defineProperties(Uh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});Object(me.a)(Uh,"RangeExternalLinksRefreshedEvent",be,[]);Am(ji,be);ji.prototype.mc=function(){this.Vb(224)};Ek.Object.defineProperties(ji.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object(me.a)(ji,"RangeExternalLinksSetAutoRefreshEvent",be,[]);Am(Sf,be);Sf.prototype.mc=function(){this.Vb(11)};Sf.prototype.sg=function(){this.Bd(function(G){return 64===G.LZ().ValidMembers})};
Ek.Object.defineProperties(Sf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object(me.a)(Sf,"RangeFillColoredEvent",be,[]);Am(uh,be);uh.prototype.mc=function(){this.Vb(155)};Ek.Object.defineProperties(uh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object(me.a)(uh,"RangeFilledEvent",be,[]);Am(Xi,be);Xi.prototype.mc=function(){this.Vb(176)};Xi.prototype.sg=function(){this.Bd(function(G){return G.wV().AutoFilterType===Hi.apc&&!!G.wV().CriteriaType})};
Ek.Object.defineProperties(Xi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object(me.a)(Xi,"RangeFilterAppliedEvent",be,[]);Am(qh,be);qh.prototype.mc=function(){this.Vb(176)};qh.prototype.sg=function(){this.Bd(function(G){return G.wV().AutoFilterType===Hi.apc&&!G.wV().CriteriaType})};Ek.Object.defineProperties(qh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});Object(me.a)(qh,"RangeFilterClearedEvent",be,[]);Am(Zg,be);Zg.prototype.mc=
function(){this.Vb(518)};Ek.Object.defineProperties(Zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(me.a)(Zg,"RangeFilterReappliedEvent",be,[]);Am(Df,be);Df.prototype.mc=function(){this.Vb(150)};Ek.Object.defineProperties(Df.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object(me.a)(Df,"RangeFlashFilledEvent",be,[]);Am(Oe,Fg);Object(me.a)(Oe,"RangeFontColoredEvent",Fg,[]);Am(Rg,Fg);Object(me.a)(Rg,"RangeFontItalicizedEvent",
Fg,[]);Am(Qg,Fg);Object(me.a)(Qg,"RangeFontNamedEvent",Fg,[]);Am(Ke,Fg);Object(me.a)(Ke,"RangeFontSizedEvent",Fg,[]);Am(he,be);he.prototype.mc=function(){this.Vb(215)};Ek.Object.defineProperties(he.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(me.a)(he,"RangeFormattedAsTableEvent",be,[]);Am(ni,be);ni.prototype.mc=function(){this.Vb(188)};Ek.Object.defineProperties(ni.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 97}}});Object(me.a)(ni,
"RangeGroupedOrUngroupedEvent",be,[]);Am(lg,be);lg.prototype.mc=function(){this.Vb(11)};lg.prototype.sg=function(){this.Bd(function(G){return 2===G.LZ().ValidMembers})};Ek.Object.defineProperties(lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(me.a)(lg,"RangeHorizontallyAlignedEvent",be,[]);Am(Uf,be);Uf.prototype.mc=function(){this.Vb(526)};Ek.Object.defineProperties(Uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 43}}});Object(me.a)(Uf,
"RangeHyperlinkAppliedEvent",be,[]);Am(rf,be);rf.prototype.mc=function(){this.Vb(11)};rf.prototype.sg=function(){this.Bd(function(G){return 256===G.LZ().ValidMembers})};Ek.Object.defineProperties(rf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(me.a)(rf,"RangeIndentChangedEvent",be,[]);Am(Ed,be);Ed.prototype.mc=function(){this.Vb(156)};Ed.prototype.sg=function(){this.Bd(function(G){return 2===G.cu()||5===G.cu()||6===G.cu()||7===G.cu()})};Ek.Object.defineProperties(Ed.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});Object(me.a)(Ed,"RangeMergedEvent",be,[]);Am(zg,be);zg.prototype.mc=function(){this.Vb(216)};Ek.Object.defineProperties(zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(me.a)(zg,"RangeNamedCellStyleAppliedEvent",be,[]);Am(zf,be);zf.prototype.mc=function(){this.Vb(11)};zf.prototype.sg=function(){this.Bd(function(G){return 32===G.LZ().ValidMembers})};Ek.Object.defineProperties(zf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});Object(me.a)(zf,"RangeNumberFormattedEvent",be,[]);var Xh=b(1162);Am(ve,be);ve.prototype.mc=function(){this.Vb(141)};ve.prototype.sg=function(){this.Bd(function(G){return Object(Jj.a)(Xh.a,G)})};Ek.Object.defineProperties(ve.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object(me.a)(ve,"RangeSortedEvent",be,[]);Am(Re,Fg);Object(me.a)(Re,"RangeStrikedThroughEvent",Fg,[]);Am(Jg,Fg);Object(me.a)(Jg,
"RangeUnderlinedEvent",Fg,[]);Am(cf,be);cf.prototype.mc=function(){this.Vb(11)};cf.prototype.sg=function(){this.Bd(function(G){return 1===G.LZ().ValidMembers})};Ek.Object.defineProperties(cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(me.a)(cf,"RangeVerticallyAlignedEvent",be,[]);Am(nc,be);nc.prototype.mc=function(){this.Vb(11)};nc.prototype.sg=function(){this.Bd(function(G){return 8===G.LZ().ValidMembers})};Ek.Object.defineProperties(nc.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 62}}});Object(me.a)(nc,"RangeWrapTextToggledEvent",be,[]);Am(oc,be);oc.prototype.mc=function(){this.Vb(51)};Ek.Object.defineProperties(oc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(me.a)(oc,"RefreshedAllEvent",be,[]);Am(Dd,be);Dd.prototype.mc=function(){this.Vb(148)};Ek.Object.defineProperties(Dd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});Object(me.a)(Dd,"ReplaceAllEvent",be,[]);Am(bg,
be);bg.prototype.mc=function(){this.Vb(532)};bg.prototype.sg=function(){this.Bd(function(G){return 95!==G.getShapeType()&&96!==G.getShapeType()&&97!==G.getShapeType()&&98!==G.getShapeType()&&100!==G.getShapeType()&&102!==G.getShapeType()&&103!==G.getShapeType()})};Ek.Object.defineProperties(bg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object(me.a)(bg,"ShapeInsertedEvent",be,[]);Am(Hf,be);Hf.prototype.mc=function(){this.Vb(531)};Ek.Object.defineProperties(Hf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(me.a)(Hf,"ShapeStyleSetEvent",be,[]);var Dj=b(1022);Am(jf,be);jf.prototype.mc=function(){this.Vb(581)};jf.prototype.sg=function(){var G=this;this.Bd(function(ia){return Object(Jj.a)(Dj.a,ia)&&4===ia.getShapeTextFormat().ValidMembers});this.Bd(function(ia){return Object(Jj.a)(Dj.a,ia)&&ia.getShapeTextFormat().Font.ValidMembers===G.CZd})};Ek.Object.defineProperties(jf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.qfa}}});
Object(me.a)(jf,"ShapeTextFontFormattedEventBase",be,[]);Am(Ue,jf);Object(me.a)(Ue,"ShapeTextBoldedEvent",jf,[]);var vk=b(1164);Am(ce,be);ce.prototype.mc=function(){this.Vb(581)};ce.prototype.sg=function(){this.Bd(function(G){return Object(Jj.a)(vk.a,G)})};Ek.Object.defineProperties(ce.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object(me.a)(ce,"ShapeTextChangedEvent",be,[]);Am(Rd,jf);Object(me.a)(Rd,"ShapeTextFontColorChangedEvent",jf,[]);Am(ad,jf);Object(me.a)(ad,
"ShapeTextFontNameChangedEvent",jf,[]);Am(Ec,jf);Object(me.a)(Ec,"ShapeTextFontSizeChangedEvent",jf,[]);Am(Yb,be);Yb.prototype.mc=function(){this.Vb(581)};Yb.prototype.sg=function(){this.Bd(function(G){return Object(Jj.a)(Dj.a,G)&&2===G.getShapeTextFormat().ValidMembers})};Ek.Object.defineProperties(Yb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object(me.a)(Yb,"ShapeTextHorizontallyAlignedEvent",be,[]);Am(bb,jf);Object(me.a)(bb,"ShapeTextItalicizedEvent",jf,[]);
Am(Ka,jf);Object(me.a)(Ka,"ShapeTextUnderlinedEvent",jf,[]);Am(Se,be);Se.prototype.mc=function(){this.Vb(581)};Se.prototype.sg=function(){this.Bd(function(G){return Object(Jj.a)(Dj.a,G)&&1===G.getShapeTextFormat().ValidMembers})};Ek.Object.defineProperties(Se.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object(me.a)(Se,"ShapeTextVerticallyAlignedEvent",be,[]);Am(Ne,be);Ne.prototype.mc=function(){this.Vb(138)};Ek.Object.defineProperties(Ne.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 13}}});Object(me.a)(Ne,"SheetAddedEvent",be,[]);var Hj=b(9);Am(We,be);We.prototype.mc=function(){this.Vb(237)};We.prototype.sg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){G=G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>G.DeltaColumn&&!G.DeltaRow&&(!!G.InsertDeleteRange.FirstRow||G.InsertDeleteRange.LastRow!==
Hj.a.wy)||!G.DeltaColumn&&0>G.DeltaRow&&(!!G.InsertDeleteRange.FirstColumn||G.InsertDeleteRange.LastColumn!==Hj.a.wv)})};Ek.Object.defineProperties(We.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(me.a)(We,"SheetCellsDeletedEvent",be,[]);Am(Sd,be);Sd.prototype.mc=function(){this.Vb(237)};Sd.prototype.sg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});
this.Bd(function(G){G=G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<G.DeltaColumn&&!G.DeltaRow&&(!!G.InsertDeleteRange.FirstRow||G.InsertDeleteRange.LastRow!==Hj.a.wy)||!G.DeltaColumn&&0<G.DeltaRow&&(!!G.InsertDeleteRange.FirstColumn||G.InsertDeleteRange.LastColumn!==Hj.a.wv)})};Ek.Object.defineProperties(Sd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object(me.a)(Sd,"SheetCellsInsertedEvent",be,[]);Am(Gd,be);Gd.prototype.mc=function(){this.Vb(237)};
Gd.prototype.sg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
Hj.a.wy})};Ek.Object.defineProperties(Gd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 139}}});Object(me.a)(Gd,"SheetColumnDeletedEvent",be,[]);Am(Ic,be);Ic.prototype.mc=function(){this.Vb(237)};Ic.prototype.sg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Hj.a.wy})};Ek.Object.defineProperties(Ic.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(me.a)(Ic,"SheetColumnInsertedEvent",be,[]);Am(Ib,be);Ib.prototype.mc=function(){this.Vb(137)};Ek.Object.defineProperties(Ib.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object(me.a)(Ib,"SheetDeletedEvent",be,[]);Am(Da,be);Da.prototype.mc=function(){this.Vb(185)};Ek.Object.defineProperties(Da.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object(me.a)(Da,"SheetDirectionChangedEvent",be,[]);Am(zh,be);zh.prototype.mc=function(){this.Vb(139)};Ek.Object.defineProperties(zh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(me.a)(zh,"SheetDuplicatedEvent",be,
[]);Am(Mf,be);Mf.prototype.mc=function(){this.Vb(207)};Ek.Object.defineProperties(Mf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(me.a)(Mf,"SheetNameEditedEvent",be,[]);Am(wg,be);wg.prototype.mc=function(){this.Vb(151)};Ek.Object.defineProperties(wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(me.a)(wg,"SheetPaneFrozenEvent",be,[]);Am(se,be);se.prototype.mc=function(){this.Vb(226)};Ek.Object.defineProperties(se.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 120}}});Object(me.a)(se,"SheetPrintSettingsSavedEvent",be,[]);var xk=b(1066);Am(re,be);re.prototype.mc=function(){this.Vb(507)};re.prototype.gwa=function(){this.tle("Microsoft.Office.Excel.SheetProtectionMacroRecording")};re.prototype.sg=function(){this.Bd(function(G){return Object.getType(G)===xk.a})};Ek.Object.defineProperties(re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(me.a)(re,"SheetProtectionPausedResumedEvent",
be,[]);Am(hg,be);hg.prototype.mc=function(){this.Vb(557)};Ek.Object.defineProperties(hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(me.a)(hg,"SheetReorderedEvent",be,[]);Am(df,be);df.prototype.mc=function(){this.Vb(237)};df.prototype.sg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.Bd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Hj.a.wv})};Ek.Object.defineProperties(df.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(me.a)(df,"SheetRowDeletedEvent",be,
[]);Am(Qf,be);Qf.prototype.mc=function(){this.Vb(237)};Qf.prototype.sg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.Bd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Hj.a.wv})};Ek.Object.defineProperties(Qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(me.a)(Qf,"SheetRowInsertedEvent",be,[]);Am(Vf,be);Vf.prototype.mc=function(){this.Vb(135)};Ek.Object.defineProperties(Vf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(me.a)(Vf,"SheetRowsColumnsAutoFitEvent",be,[]);
Am(ig,be);ig.prototype.mc=function(){this.Vb(136)};Ek.Object.defineProperties(ig.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(me.a)(ig,"SheetRowsColumnsResizedEvent",be,[]);Am(Rf,be);Rf.prototype.mc=function(){this.Vb(183)};Ek.Object.defineProperties(Rf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object(me.a)(Rf,"SheetShowGridlinesToggledEvent",be,[]);Am(bf,be);bf.prototype.mc=function(){this.Vb(184)};Ek.Object.defineProperties(bf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(me.a)(bf,"SheetShowHeadingsToggledEvent",be,[]);Am(He,be);He.prototype.mc=function(){this.Vb(213)};Ek.Object.defineProperties(He.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(me.a)(He,"SheetSpellCheckedEvent",be,[]);Am(ue,be);ue.prototype.mc=function(){this.Vb(515)};Ek.Object.defineProperties(ue.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(me.a)(ue,
"SheetTabColoredEvent",be,[]);Am(td,be);td.prototype.mc=function(){this.Vb(157)};Ek.Object.defineProperties(td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(me.a)(td,"SheetVisibilityChangedEvent",be,[]);Am(jd,be);jd.prototype.mc=function(){this.Vb(239)};Ek.Object.defineProperties(jd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(me.a)(jd,"SheetsVisibilityChangedEvent",be,[]);Am(Fc,be);Fc.prototype.mc=function(){this.Vb(203)};
Ek.Object.defineProperties(Fc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(me.a)(Fc,"SlicerInsertedEvent",be,[]);Am(pg,be);pg.prototype.mc=function(){this.Vb(173)};pg.prototype.sg=function(){this.Bd(function(G){return!G.clearFilter})};Ek.Object.defineProperties(pg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object(me.a)(pg,"SlicerSelectionAppliedEvent",be,[]);Am(Dg,be);Dg.prototype.mc=function(){this.Vb(173)};Dg.prototype.sg=
function(){this.Bd(function(G){return G.clearFilter})};Ek.Object.defineProperties(Dg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(me.a)(Dg,"SlicerSelectionClearedEvent",be,[]);Am(hh,be);hh.prototype.mc=function(){this.Vb(208)};hh.prototype.sg=function(){this.Bd(function(G){return G.getParameters().FilterType===Hi.p$a})};Ek.Object.defineProperties(hh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(me.a)(hh,"TableCheckedItemsFilteredEvent",
be,[]);Am(Fe,be);Fe.prototype.mc=function(){this.Vb(237)};Fe.prototype.sg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Ek.Object.defineProperties(Fe.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object(me.a)(Fe,"TableColumnDeletedEvent",be,[]);Am(tg,be);tg.prototype.mc=function(){this.Vb(237)};tg.prototype.sg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Ek.Object.defineProperties(tg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(me.a)(tg,"TableColumnInsertedEvent",be,[]);var Xj=b(1163);Am(of,be);of.prototype.mc=function(){this.Vb(141)};of.prototype.sg=function(){this.Bd(function(G){return Object(Jj.a)(Xj.a,G)})};Ek.Object.defineProperties(of.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(me.a)(of,"TableColumnSortedEvent",be,[]);Am(gf,be);gf.prototype.mc=function(){this.Vb(193)};
Ek.Object.defineProperties(gf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(me.a)(gf,"TableConvertedToRangeEvent",be,[]);Am(ze,be);ze.prototype.mc=function(){this.Vb(206)};Ek.Object.defineProperties(ze.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(me.a)(ze,"TableCreatedEvent",be,[]);Am(od,be);od.prototype.mc=function(){this.Vb(209)};od.prototype.sg=function(){this.Bd(function(G){return G.getParameters().FilterType===
Hi.p$a})};Ek.Object.defineProperties(od.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(me.a)(od,"TableCustomFilteredEvent",be,[]);Am(yd,be);yd.prototype.mc=function(){this.Vb(187)};yd.prototype.sg=function(){this.Bd(function(G){return 1===G.options.OperationType})};Ek.Object.defineProperties(yd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(me.a)(yd,"TableCustomSortedEvent",be,[]);Am(Rc,be);Rc.prototype.mc=function(){this.Vb(176)};
Rc.prototype.sg=function(){this.Bd(function(G){return G.wV().AutoFilterType===Hi.p$a});this.Bd(function(G){return 0===G.wV().CriteriaType})};Ek.Object.defineProperties(Rc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(me.a)(Rc,"TableFilterClearedEvent",be,[]);Am(cc,be);cc.prototype.mc=function(){this.Vb(176)};cc.prototype.sg=function(){this.Bd(function(G){return G.wV().AutoFilterType===Hi.p$a});this.Bd(function(G){var ia=new gg.a;ia.add(1);ia.add(2);ia.add(8);
ia.add(9);ia.add(10);ia.add(11);ia.add(12);ia.add(13);ia.add(14);ia.add(15);ia.add(16);ia.add(17);ia.add(18);ia.add(19);ia.add(20);ia.add(21);ia.add(22);ia.add(23);ia.add(24);ia.add(25);ia.add(26);ia.add(27);ia.add(28);ia.add(29);ia.add(30);ia.add(31);ia.add(32);ia.add(33);ia.add(34);ia.add(35);ia.add(36);ia.add(37);ia.add(38);ia.add(39);return ia.contains(G.wV().CriteriaType)})};Ek.Object.defineProperties(cc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 32}}});Object(me.a)(cc,
"TableItemFilteredEvent",be,[]);Am(Cb,be);Cb.prototype.mc=function(){this.Vb(217)};Ek.Object.defineProperties(Cb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(me.a)(Cb,"TableRenamedEvent",be,[]);Am(ya,be);ya.prototype.mc=function(){this.Vb(211)};Ek.Object.defineProperties(ya.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(me.a)(ya,"TableResizedEvent",be,[]);Am(Ee,be);Ee.prototype.mc=function(){this.Vb(514)};Ek.Object.defineProperties(Ee.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 44}}});Object(me.a)(Ee,"TableRowColumnRearrangedEvent",be,[]);Am(nf,be);nf.prototype.mc=function(){this.Vb(237)};nf.prototype.sg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Ek.Object.defineProperties(nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(me.a)(nf,"TableRowDeletedEvent",be,[]);Am(ge,be);ge.prototype.mc=function(){this.Vb(237)};ge.prototype.sg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return 0<
G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Ek.Object.defineProperties(ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(me.a)(ge,"TableRowInsertedEvent",be,[]);Am(Mc,be);Mc.prototype.mc=function(){this.Vb(177)};Mc.prototype.sg=function(){this.Bd(function(G){return G.wV().AutoFilterType===Hi.p$a})};Ek.Object.defineProperties(Mc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});Object(me.a)(Mc,"TableSortedEvent",
be,[]);Am(wd,be);wd.prototype.mc=function(){this.Vb(212)};Ek.Object.defineProperties(wd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(me.a)(wd,"TableStyleAppliedEvent",be,[]);Am(Lc,be);Lc.prototype.mc=function(){this.Vb(196)};Ek.Object.defineProperties(Lc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(me.a)(Lc,"TableStyleOptionToggledEvent",be,[]);Am(ac,be);ac.prototype.mc=function(){this.Vb(210)};ac.prototype.sg=function(){this.Bd(function(G){return G.getParameters().FilterType===
Hi.p$a})};Ek.Object.defineProperties(ac.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(me.a)(ac,"TableTop10FilteredEvent",be,[]);Am(Of,be);Of.prototype.mc=function(){this.Vb(238)};Ek.Object.defineProperties(Of.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(me.a)(Of,"TextToColumnsEvent",be,[]);Am(Me,be);Me.prototype.mc=function(){this.Vb(559)};Ek.Object.defineProperties(Me.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 128}}});Object(me.a)(Me,"ValuesSortedEvent",be,[]);Am(vg,be);vg.prototype.mc=function(){this.Vb(197)};Ek.Object.defineProperties(vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(me.a)(vg,"WorkbookCalculationModeSetEvent",be,[]);Am(fh,be);fh.prototype.mc=function(){this.Vb(181)};fh.prototype.sg=function(){this.Bd(function(G){return!!G.parentCommentId})};Ek.Object.defineProperties(fh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});
Object(me.a)(fh,"WorkbookCommentRepliedEvent",be,[]);Am(dh,be);dh.prototype.mc=function(){this.Vb(181)};dh.prototype.sg=function(){this.Bd(function(G){return!G.parentCommentId})};Ek.Object.defineProperties(dh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(me.a)(dh,"WorkbookCommentedEvent",be,[]);Am(rg,be);rg.prototype.mc=function(){this.Vb(128)};Ek.Object.defineProperties(rg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 56}}});Object(me.a)(rg,
"WorkbookRecalculatedEvent",be,[]);Am(Cf,be);Cf.prototype.mc=function(){this.Vb(171)};Ek.Object.defineProperties(Cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(me.a)(Cf,"WorkbookRedoEvent",be,[]);Am(Gg,be);Gg.prototype.mc=function(){this.Vb(170)};Ek.Object.defineProperties(Gg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(me.a)(Gg,"WorkbookUndoEvent",be,[]);Am(ug,be);ug.prototype.mc=function(){this.Vb(507);this.Vb(576);
this.Vb(10)};ug.prototype.sg=function(){this.Bd(function(G){if(Object(Jj.a)(Vh,G)&&(G=Object(Fi.a)(Vh,G),void 0!==G.source&&null!==G.source&&void 0!==G.eventId&&null!==G.eventId))return $e.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",G.source,G.eventId),!0;$e.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};Ek.Object.defineProperties(ug.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 116}}});Object(me.a)(ug,"DefaultRichApiRequestExecutedEvent",be,[]);Am(Wf,be);Wf.prototype.mc=function(){this.Vb(1022)};Ek.Object.defineProperties(Wf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 216}}});Object(me.a)(Wf,"TablelAltTextEditedEvent",be,[]);Am(wf,be);wf.prototype.mc=function(){this.Vb(263)};Ek.Object.defineProperties(wf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 217}}});Object(me.a)(wf,"FloatingObjectZOrderChangedEvent",
be,[]);vf.prototype.w_e=function(G,ia){var eb=this.x_e(G,this.macroRecorderEvents,ia);eb||(eb=this.x_e(G,vf.l0h(),ia),!eb&&this.jef(G,vf.BGe,ia)&&(eb=vf.BGe));return eb};vf.prototype.x_e=function(G,ia,eb){var Fb=new gg.a;ia=El(ia);for(var Oc=ia.next();!Oc.done;Oc=ia.next())Oc=Oc.value,this.jef(G,Oc,eb)&&Fb.add(Oc);return 1===Fb.count?Fb.oa(0):1<Fb.count?vf.XIh(Fb):null};vf.prototype.jef=function(G,ia,eb){var Fb=vf.IUi(G,ia);return eb?Fb&&vf.TUj(G,ia):Fb};vf.prototype.A9i=function(){for(var G=new gg.a,
ia=El(this.Gb),eb=ia.next();!eb.done;eb=ia.next()){eb=eb.value;for(var Fb=!1,Oc=El(eb.featureGates),Tc=Oc.next();!Tc.done;Tc=Oc.next())if(!Ag.EwaSettings.ma(Tc.value)){G.add(eb);Fb=!0;break}if(!Fb)for(Fb=El(eb.cSe),Oc=Fb.next();!Oc.done;Oc=Fb.next())if(!Ag.EwaSettings.getBooleanFeatureGate(Oc.value,!1)){G.add(eb);break}}G=El(G);for(ia=G.next();!ia.done;ia=G.next())this.Gb.remove(ia.value)};vf.l0h=function(){vf.sCb||(vf.sCb=new gg.a,vf.sCb.add(new Tg),vf.sCb.add(new la));return vf.sCb};vf.IUi=function(G,
ia){return ia.operations.contains(G.operation)};vf.TUj=function(G,ia){var eb=ia.LCc;if(!eb.count)return!0;ia=!0;eb=El(eb);for(var Fb=eb.next();!Fb.done;Fb=eb.next())if(Fb=Fb.value,!Fb(G.payload)){ia=!1;break}return ia};vf.XIh=function(G){var ia=G.oa(0);G=El(G);for(var eb=G.next();!eb.done;eb=G.next())eb=eb.value,eb.LCc.count>ia.LCc.count&&(ia=eb);return ia};Ek.Object.defineProperties(vf.prototype,{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.Gb||(this.Gb=new gg.a,this.Gb.add(new oi),
this.Gb.add(new lh),this.Gb.add(new kg),this.Gb.add(new Ch),this.Gb.add(new Sf),this.Gb.add(new Oe),this.Gb.add(new Rg),this.Gb.add(new Qg),this.Gb.add(new Ke),this.Gb.add(new Re),this.Gb.add(new Jg),this.Gb.add(new zf),this.Gb.add(new Ne),this.Gb.add(new Ib),this.Gb.add(new Mf),this.Gb.add(new ze),this.Gb.add(new Fe),this.Gb.add(new tg),this.Gb.add(new nf),this.Gb.add(new ge),this.Gb.add(new Ic),this.Gb.add(new Gd),this.Gb.add(new Qf),this.Gb.add(new df),this.Gb.add(new yd),this.Gb.add(new Mc),this.Gb.add(new hh),
this.Gb.add(new Rc),this.Gb.add(new nh),this.Gb.add(new od),this.Gb.add(new ac),this.Gb.add(new cc),this.Gb.add(new dh),this.Gb.add(new fh),this.Gb.add(new O),this.Gb.add(new ig),this.Gb.add(new We),this.Gb.add(new Sd),this.Gb.add(new Vf),this.Gb.add(new Di),this.Gb.add(new Zg),this.Gb.add(new Uf),this.Gb.add(new lf),this.Gb.add(new Ee),this.Gb.add(new Cf),this.Gb.add(new Gg),this.Gb.add(new Dd),this.Gb.add(new hf),this.Gb.add(new Pa),this.Gb.add(new Ed),this.Gb.add(new zh),this.Gb.add(new vg),this.Gb.add(new rg),
this.Gb.add(new xi),this.Gb.add(new qh),this.Gb.add(new uh),this.Gb.add(new lg),this.Gb.add(new cf),this.Gb.add(new nc),this.Gb.add(new rf),this.Gb.add(new hg),this.Gb.add(new ki),this.Gb.add(new Hh),this.Gb.add(new bf),this.Gb.add(new Rf),this.Gb.add(new $h),this.Gb.add(new td),this.Gb.add(new ue),this.Gb.add(new ya),this.Gb.add(new he),this.Gb.add(new $g),this.Gb.add(new Zi),this.Gb.add(new Uh),this.Gb.add(new cg),this.Gb.add(new Sg),this.Gb.add(new oh),this.Gb.add(new ti),this.Gb.add(new Sj),this.Gb.add(new Gj),
this.Gb.add(new Li),this.Gb.add(new Lg),this.Gb.add(new Df),this.Gb.add(new wd),this.Gb.add(new Lc),this.Gb.add(new He),this.Gb.add(new wg),this.Gb.add(new bg),this.Gb.add(new Hf),this.Gb.add(new Fd),this.Gb.add(new Kc),this.Gb.add(new Vc),this.Gb.add(new te),this.Gb.add(new ni),this.Gb.add(new zi),this.Gb.add(new ja),this.Gb.add(new ec),this.Gb.add(new Cb),this.Gb.add(new Xd),this.Gb.add(new oc),this.Gb.add(new ua),this.Gb.add(new gf),this.Gb.add(new Gh),this.Gb.add(new zg),this.Gb.add(new ve),this.Gb.add(new li),
this.Gb.add(new da),this.Gb.add(new Ef),this.Gb.add(new rb),this.Gb.add(new wh),this.Gb.add(new Oi),this.Gb.add(new Xi),this.Gb.add(new Ri),this.Gb.add(new ee),this.Gb.add(new Dh),this.Gb.add(new se),this.Gb.add(new of),this.Gb.add(new Vg),this.Gb.add(new jd),this.Gb.add(new qe),this.Gb.add(new Me),this.Gb.add(new Yf),this.Gb.add(new Ni),this.Gb.add(new mg),this.Gb.add(new tb),this.Gb.add(new ye),this.Gb.add(new zd),this.Gb.add(new qf),this.Gb.add(new Da),this.Gb.add(new Te),this.Gb.add(new oe),this.Gb.add(new Yc),
this.Gb.add(new ab),this.Gb.add(new pi),this.Gb.add(new S),this.Gb.add(new A),this.Gb.add(new d),this.Gb.add(new Ng),this.Gb.add(new Pi),this.Gb.add(new Sh),this.Gb.add(new kc),this.Gb.add(new sh),this.Gb.add(new Og),this.Gb.add(new ji),this.Gb.add(new $c),this.Gb.add(new Ua),this.Gb.add(new Ea),this.Gb.add(new xh),this.Gb.add(new ph),this.Gb.add(new Dc),this.Gb.add(new yg),this.Gb.add(new na),this.Gb.add(new vh),this.Gb.add(new Af),this.Gb.add(new ch),this.Gb.add(new Ae),this.Gb.add(new Ih),this.Gb.add(new ci),
this.Gb.add(new yf),this.Gb.add(new Th),this.Gb.add(new Ab),this.Gb.add(new sb),this.Gb.add(new Wb),this.Gb.add(new ag),this.Gb.add(new Pg),this.Gb.add(new Xg),this.Gb.add(new Fc),this.Gb.add(new pg),this.Gb.add(new Dg),this.Gb.add(new ce),this.Gb.add(new Ue),this.Gb.add(new bb),this.Gb.add(new Ka),this.Gb.add(new Rd),this.Gb.add(new ad),this.Gb.add(new Ec),this.Gb.add(new Yb),this.Gb.add(new Se),this.Gb.add(new Jh),this.Gb.add(new Gi),this.Gb.add(new Of),this.Gb.add(new re),this.Gb.add(new Wf),this.Gb.add(new wf),
Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.A9i());return this.Gb}}});vf.sCb=null;vf.BGe=new ug;Object(me.a)(vf,"MacroRecorderEventList",null,[]);var Yj=ng.a;Am(Ze,Yj);Ze.prototype.create=function(){this.Eb(this.$.da.Aa(297)||new V(this.$,new vf(this.$),new gc))};Ze.ka=function(G){G.da.Ga(298,new Ze(G))};Object(me.a)(Ze,"MacroRecorderEventHandlerFactory",ng.a,[]);var mi=b(906),th=b(79),Rh=b(36);Td.prototype.Zc=function(){return!1};Td.prototype.executeCommand=
function(G,ia,eb){G=Rh.TaskExtensions.hl();ia=ia.command;switch(ia){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 971811139:this.$.Xd(2045014907,-1,0,null),this.automateCommandManager.Rqi(ia,1904816141===ia?eb[th.a.ld].toString():null)}return G};Td.prototype.Lc=function(G,ia){G=!1;switch(ia.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case 1904816141:case 1606046412:G=this.$.Eba}return G};Td.prototype.jd=function(G,ia,eb){return"PopulateAutomateGalleryMenu"===
ia&&this.$.Eba?(this.automateCommandManager.jd(ia,eb),!0):!1};Object(me.a)(Td,"AutomateCommandHandler",null,[429]);var ih=b(491),vj=mi.a;Am(Od,vj);Od.prototype.Nd=function(){var G=this;ih.a(this.$,374,375,this.ub,function(){var ia=G.$.da.Aa(352);ia?G.Cd([new Td(ia,G.$)]):$e.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})};Od.ka=function(G){G.da.Ga(308,new Od(G))};Object(me.a)(Od,"AutomateCommandHandlerFactory",mi.a,[]);var $f=
b(7);Object(me.a)(Bd,"AuthContext",null,[]);var Pf=b(564),Ei=b(131),ri=b(111),Qh=b(28),Fk=b(1023),Bi=b(187);uc.prototype.getAuthContext=function(){return this.Fob};uc.prototype.Dbc=function(){function G(Tc,Md){return(new Promise(function(Qd){window.setTimeout(function(){Qd(Tc)},Md)})).then(function(Qd){Fb.push(Object($f.a)(new Wc.a,{name:"Error"+Oc,string:Qd.ErrorMessage}));Fb.push(Object($f.a)(new Wc.a,{name:"ErrorCode"+Oc,string:Qd.ErrorCode}));Oc++;return ia.Q$f()})}var ia=this,eb=Qh.a.Ta.Wb,Fb=
[];if(this.oAuthManager)Fb.push(Object($f.a)(new Wc.a,{name:"IsAuthSupported",bool:this.Fse}));else return this.q9b(Fb,eb,"need_OAuthManager","No OAuthManager");if(!this.Wu.uy||!this.Wu.uy.value)return this.q9b(Fb,eb,"need_license","No License");if(Tf.AFrameworkApplication.ga.ra("IsAnonymousUser"))return this.q9b(Fb,eb,"need_user","Anonymous User");if(33E5>Date.now()-this.Fob.timeStamp)return Fb.push(Object($f.a)(new Wc.a,{name:"UsedCachedToken",bool:!0})),Bi.a(Ei.a.azd,!0,0,Fb),Promise.resolve(Object($f.a)(new Fk.a,
{IsSuccess:!0,Token:this.Fob.token}));Fb.push(Object($f.a)(new Wc.a,{name:"UsedCachedToken",bool:!1}));var Oc=1;return this.Q$f().catch(function(Tc){return G(Tc,200)}).catch(function(Tc){return G(Tc,400)}).then(function(Tc){Tc.IsSuccess?(ia.Fob.token=Tc.Token,ia.Fob.timeStamp=Date.now()):(Fb.push(Object($f.a)(new Wc.a,{name:"Error"+Oc,string:Tc.ErrorMessage})),Fb.push(Object($f.a)(new Wc.a,{name:"ErrorCode"+Oc,string:Tc.ErrorCode})));Fb.push(Object($f.a)(new Wc.a,{name:"Attempts",int64:Oc}));Fb.push(Object($f.a)(new Wc.a,
{name:"Error",string:Tc.ErrorMessage}));Fb.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:Tc.ErrorCode}));Bi.a(Ei.a.azd,Tc.IsSuccess,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);return Promise.resolve(Tc)}).catch(function(Tc){Fb.push(Object($f.a)(new Wc.a,{name:"Error"+Oc,string:Tc.ErrorMessage}));Fb.push(Object($f.a)(new Wc.a,{name:"ErrorCode"+Oc,string:Tc.ErrorCode}));Fb.push(Object($f.a)(new Wc.a,{name:"Attempts",int64:Oc}));return ia.q9b(Fb,eb,Tc.ErrorCode,Tc.ErrorMessage)})};uc.prototype.q9b=
function(G,ia,eb,Fb){G.push(Object($f.a)(new Wc.a,{name:"Error",string:Fb}));G.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:eb}));Bi.a(Ei.a.azd,!1,ri.getElapsedMilliseconds(ia,Qh.a.Ta.Wb),G);return Promise.resolve(Object($f.a)(new Fk.a,{IsSuccess:!1,ErrorMessage:Fb,ErrorCode:eb}))};uc.prototype.Q$f=function(){var G=this,ia=Pf.a.mZh(),eb=0;ia=this.oAuthManager.US("Maker",ia).then(function(Fb){if(Fb)return!Fb.IsSuccess&&G.Qwj(Fb)?Promise.reject(Fb):Promise.resolve(Fb);Fb=Object($f.a)(new Fk.a,
{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Fb)}).catch(function(Fb){var Oc=new Fk.a;Object.getType(Fb)===Object.getType(Oc)?Oc=Fb:(Oc.ErrorMessage=Fb.toString(),Oc.ErrorCode="exception");return Promise.reject(Oc)});return Promise.race([ia,new Promise(function(Fb,Oc){eb=window.setTimeout(function(){Oc(Object($f.a)(new Fk.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(function(Fb){window.clearTimeout(eb);
return Fb})};uc.prototype.Qwj=function(G){return"interaction_required"===G.ErrorCode||"InitFailed"===G.ErrorCode||"invalid_resource"===G.ErrorCode||"login_required"===G.ErrorCode&&G.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object(me.a)(uc,"AutomateCommandAuth",null,[629]);var yk=b(1024);Object(me.a)(dc,"AutomateCommandGalleryBase",null,[]);var Yk=b(392),Mj=b(29),zk=b(623),Gk=b(1430),rj=b(19),Zj=b(54),gi=b(15);b(321);var N=b(654);Rb.prototype.KGh=function(G){var ia=this.automateCommandManager.Ra.Yp().oC(),
eb=Rb.NU(G,gi.a.instance.fa(2092));this.SUc(eb,Pf.a.xSi,this.automateCommandManager.Tj,Pf.a.$Di,gi.a.instance.fa(2088),this.automateCommandManager.Ra);ia.MenuSectionList.push(eb);eb=Rb.NU(G,gi.a.instance.fa(2093));this.SUc(eb,Pf.a.nBi,Pf.a.e6?this.automateCommandManager.xt.qTe(this.automateCommandManager.Tj):this.automateCommandManager.mq.qTe(this.automateCommandManager.Tj),Pf.a.jsf,gi.a.instance.fa(2089),this.automateCommandManager.Ra);ia.MenuSectionList.push(eb);eb=Rb.NU(G,gi.a.instance.fa(2094));
this.SUc(eb,Pf.a.Kij,this.automateCommandManager.LB,Pf.a.jsf,"",this.automateCommandManager.Ra);ia.MenuSectionList.push(eb);eb=Object($f.a)(new Yk.a,{Id:Pf.a.Yoe,ExternalId:Pf.a.Yoe,Command:"1606046412",LabelText:gi.a.instance.fa(2085),Alt:gi.a.instance.fa(2086),Image16by16:Zj.a.We(16),Image16by16Class:rj.a.qOe,Visible:!0});G=Rb.NU(G,null);G.ControlsId="myScriptsSection.Controls";G.ControlList.push(eb);ia.MenuSectionList.push(G);return ia};Rb.prototype.SUc=function(G,ia,eb,Fb,Oc,Tc){if(eb&&0<eb.length){ia=
Tc.dB(ia,1,"Size150by20").a1b();Oc={};Tc={};Tc.root=Rb.ota(320,30);Tc.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",lineHeight:"normal"};Tc.label={margin:"0px 3px"};Oc.galleryButtonInExpanded=Tc;ia.GalleryStyle=Oc;for(Oc=0;Oc<eb.length&&Oc<Fb;Oc++)Tc=eb.XM(Oc),ia.GalleryItems.push(Rb.G3c(Tc.id,Tc,!1));G.ControlList.push(ia)}else eb=Object($f.a)(new N.a,{Id:ia,ExternalId:ia,LabelText:Oc}),G.ControlsId=eb.Id+".Controls",G.ControlList.push(eb)};
Rb.IFh=function(G){if(G){var ia=String.format(Pf.a.obi,G.isShared?Pf.a.l$f:Pf.a.QVf,Zj.a.We(16));G=String.format(Pf.a.pbi,Mj.a.Sf(G.name));return String.format(Pf.a.nbi,ia,G)}return""};Rb.NU=function(G,ia){return Object($f.a)(new zk.a,{Id:G,Title:ia,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};Rb.G3c=function(G,ia,eb){var Fb=eb?Pf.a.vLj:Pf.a.uLj,Oc=eb?Pf.a.akj:Pf.a.$jj,Tc=eb?Pf.a.l$f:Pf.a.wLj,Md=eb?Pf.a.QVf:Pf.a.bkj;return ia?Rb.EDe(ia.shareId||
ia.id,ia.name,eb,ia.isShared?Fb:Oc,G,G,ia.isShared?Tc:Md):Rb.EDe("","",eb,"",G,G)};Rb.EDe=function(G,ia,eb,Fb,Oc,Tc,Md){Oc=void 0===Oc?null:Oc;Tc=void 0===Tc?null:Tc;Md=void 0===Md?null:Md;var Qd=void 0===Qd?null:Qd;var Je={},kf={};eb?(Je.root=Rb.ota(32,32),kf.root=Rb.ota(32,32)):(Je.root=Rb.ota(20,20),kf.root=Rb.ota(20,20));return Object($f.a)(new Gk.a,{Id:G,ExternalId:Oc||G,MenuItemId:Tc||G,Command:"1904816141",Icon:Fb,Image:Zj.a.We(16),ImageClass:Md,LabelText:ia,FullIconStyle:Je,PreviewIconStyle:kf,
Alt:Qd||ia})};Rb.ota=function(G,ia){var eb={};eb.width=G;eb["min-width"]=G;eb.height=ia;return eb};Object(me.a)(Rb,"AutomateCommandRenderer",null,[]);fb.prototype.zKa=function(G){for(var ia=0;ia<this.scripts.length;ia++)if(this.scripts[ia].id===G||this.scripts[ia].shareId===G)return ia;return-1};fb.prototype.sort=function(){this.T4f(this.scripts)};fb.prototype.Uu=function(G){return-1===this.zKa(G.id)?(this.scripts.push(G),!0):!1};fb.prototype.RUc=function(G){return-1===this.zKa(G.id)?(this.scripts=
[G].concat(this.scripts),!0):!1};fb.prototype.TAi=function(G){G=this.zKa(G.id);if(-1!==G){for(var ia=this.scripts[G].U_a();0<G;)this.scripts[G]=this.scripts[G-1],G--;this.scripts[0]=ia}};fb.prototype.ofb=function(G){var ia=this.zKa(G.id);if(-1!==ia){var eb=this.scripts[ia].shareId;this.scripts[ia]=G;this.scripts[ia].shareId=eb}};fb.prototype.Cef=function(G){var ia=this.zKa(G.id);return-1!==ia?G.name===this.scripts[ia].name:!1};fb.prototype.j1a=function(G){G=this.zKa(G);return-1!==G?(this.scripts.splice(G,
1),!0):!1};fb.prototype.clear=function(){this.scripts=[]};fb.prototype.getScripts=function(){return this.scripts};fb.prototype.DH=function(G){G=this.zKa(G);return-1!==G?this.scripts[G]:null};fb.prototype.XM=function(G){return 0<=G&&this.length>G?this.scripts[G]:null};fb.prototype.qTe=function(G){for(var ia=new fb([],this.T4f),eb=0;eb<this.scripts.length;eb++){var Fb=this.scripts[eb];G.DH(Fb.id)||ia.Uu(Fb)}return ia};fb.prototype.qeb=function(){for(var G=[],ia=El(this.scripts),eb=ia.next();!eb.done;eb=
ia.next())G.push(eb.value.VVd());return G};Ek.Object.defineProperties(fb.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(me.a)(fb,"ScriptCollection",null,[]);var Fa=b(198);oa.prototype.U_a=function(){return new oa(this.N$)};oa.prototype.VVd=function(){return this.N$};Ek.Object.defineProperties(oa.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.N$.id}},shareId:{configurable:!0,enumerable:!0,get:function(){return this.N$.shareId},
set:function(G){this.N$.shareId=G||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.N$.name}},UFe:{configurable:!0,enumerable:!0,get:function(){return this.N$.dateLastPublished}},body:{configurable:!0,enumerable:!0,get:function(){return this.N$.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.N$.description}},Sbf:{configurable:!0,enumerable:!0,get:function(){return this.N$.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.shareId&&
0<this.shareId.length}}});Object(me.a)(oa,"ScriptCore",null,[]);var Hb=b(37);Am(fe,dc);fe.prototype.ygd=function(G){switch(G){case "1":case "2":case "3":return this.rD.XM(parseInt(G,10)-1);default:return!Pf.a.J7||"4"!==G&&"5"!==G&&"6"!==G?this.pf.xt.DH(G)||this.pf.mq.DH(G)||this.pf.Tj.DH(G)||this.pf.LB.DH(G):this.rD.XM(parseInt(G,10)-1)}};fe.prototype.Hed=function(G,ia,eb){var Fb=null;if(this.pf.Z4a)switch(G){case "1":case "2":case "3":Fb=this.rD.XM(parseInt(G,10)-1);break;case "4":case "5":case "6":Fb=
Pf.a.J7?this.rD.XM(parseInt(G,10)-1):this.rD.DH(G);break;default:Fb=this.rD.DH(G)}Hb.a.isReactRibbonEnabled()?ia[yk.a.GalleryButtonProps]=Rb.G3c(G,Fb,2===eb&&!Pf.a.J7):ia[yk.a.InnerHTML]=Rb.IFh(Fb);ia[yk.a.Alt]=Fb?Fb.name:""};fe.prototype.iO=function(G){this.rD=this.fHd();this.$.Bf();var ia=[];ia.push(Object($f.a)(new Wc.a,{name:"Operation",string:G}));ia.push(Object($f.a)(new Wc.a,{name:"HasReadRecentCachedScripts",bool:this.pf.Edc}));ia.push(Object($f.a)(new Wc.a,{name:"ReadScriptsDone",bool:this.pf.wjd}));
ia.push(Object($f.a)(new Wc.a,{name:"ReadSamplesScriptsDone",bool:this.pf.iHb}));ia.push(Object($f.a)(new Wc.a,{name:"SamplesScriptCount",int64:this.pf.LB.length}));ia.push(Object($f.a)(new Wc.a,{name:"ReadRecentScriptsDone",bool:this.pf.Kab}));ia.push(Object($f.a)(new Wc.a,{name:"RecentScriptCount",int64:this.pf.xt.length}));ia.push(Object($f.a)(new Wc.a,{name:"ReadWorkbookScriptsDone",bool:this.pf.WW}));ia.push(Object($f.a)(new Wc.a,{name:"WorkbookScriptCount",int64:this.pf.Tj.length}));Bi.a(Ei.a.Osf,
!0,0,ia)};fe.prototype.Pid=function(G){var ia=!1,eb="",Fb=new oa(G.scriptMetadata),Oc={Operation:"HandleRefreshRibbonGallery"};Oc.RefreshOperation=G.operationName;switch(G.operationName){case Pf.a.fNf:G=this.Oid(Fb);eb=G.message;ia=G.returnValue;break;case Pf.a.dNf:G=this.Mid(Fb);eb=G.message;ia=G.returnValue;break;case Pf.a.cNf:G=this.Lid(Fb);eb=G.message;ia=G.returnValue;break;case Pf.a.eNf:G=this.Nid(Fb);eb=G.message;ia=G.returnValue;break;case Pf.a.J6i:G=this.x3h(Fb),eb=G.message,ia=G.returnValue}(Oc.GalleryUpdated=
ia)?($e.ULS.sendTraceTag(537170322,0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",eb),this.iO("RefreshGallery")):$e.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",eb);Oc.Message=eb;$e.ULS.sendTraceTag(537170320,0,50,ra.c(Oc))};fe.prototype.fHd=function(){for(var G=new fb([],function(){}),ia=this.pf.Tj?this.pf.Tj.length:0,eb=this.pf.xt?this.pf.xt.length:0,Fb=this.pf.LB?this.pf.LB.length:
0,Oc=0,Tc=Pf.a.J7?6:Pf.a.ZHf,Md=0;Md<Tc;Md++)if(Md<ia)G.Uu(this.pf.Tj.XM(Md));else if(Md-ia+Oc<eb){var Qd=this.pf.xt.XM(Md-ia+Oc);this.pf.Tj.DH(Qd.id)?(Oc++,Md--):G.Uu(Qd)}else Md-ia-eb+Oc<Fb&&G.Uu(this.pf.LB.XM(Md-ia+Oc-eb));return G};fe.prototype.Oid=function(G){if(this.pf.xt.RUc(G))var ia="";else{ia="";var eb=G.U_a();this.pf.Tj.ofb(eb);this.pf.Tj.sort();this.pf.xt.ofb(G)}return{returnValue:!0,message:ia}};fe.prototype.Mid=function(G){this.pf.Tj.j1a(G.id);return this.pf.xt.j1a(G.id)?{returnValue:!0,
message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};fe.prototype.Lid=function(G){var ia=G.U_a();ia.shareId=null;this.pf.xt.RUc(ia);return this.pf.Tj.Uu(G)?(this.pf.Tj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};fe.prototype.Nid=function(G){return this.pf.Tj.j1a(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};
fe.prototype.x3h=function(G){var ia=G.U_a(),eb=!1;this.pf.Tj.Cef(ia)&&(this.pf.Tj.ofb(ia),this.pf.Tj.sort(),eb=!0);this.pf.xt.RUc(G)?eb=!0:this.pf.xt.Cef(G)&&(this.pf.xt.ofb(G),this.pf.xt.TAi(G),eb=!0);return{returnValue:eb,message:""}};Object(me.a)(fe,"AutomateCommandGallery",dc,[]);var mc=b(85);Object(me.a)(fc,"AutomateCommandLicensingBase",null,[]);Object(me.a)(xd,"BoolResultWrapper",null,[]);Am(ke,fc);ke.prototype.f0c=function(){var G=this,ia=Qh.a.Ta.Wb,eb=[];return new Promise(function(Fb){mc.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Oc){Oc.isFeatureEnabled("ExcelOfficeScripting",
!1).then(function(Tc){eb.push(Object($f.a)(new Wc.a,{name:"IsLicensed",bool:Tc}));Bi.a(Ei.a.Ksf,!0,ri.getElapsedMilliseconds(ia,Qh.a.Ta.Wb),eb);G.uy=new xd(Tc,!0);Fb(Tc)}).catch(function(Tc){eb.push(Object($f.a)(new Wc.a,{name:"IsLicensed",bool:!1}));eb.push(Object($f.a)(new Wc.a,{name:"Error",string:Tc.toString()}));eb.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:"exception"}));Bi.a(Ei.a.Ksf,!1,ri.getElapsedMilliseconds(ia,Qh.a.Ta.Wb),eb);G.uy=new xd(!1,!1,void 0,"exception",Tc.toString());
Fb(!1)})})})};Object(me.a)(ke,"AutomateCommandLicensing",fc,[]);var cd=b(1355),Le=b(1353),Qc=b(1352),Id=b(1354);le.taskPaneWidth="TaskPaneWidth";le.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";le.gl="TaskPaneTitle";le.Qk="IconCssClass";le.eVd="TaskPaneIconUrl";le.LS="TaskPaneIconId";le.nI="NonPersistedSettings";le.onTaskPaneClose="OnTaskPaneClose";le.yTc="ActionArgs";Object(me.a)(le,"PropertyNames",null,[]);var Xf=b(176),Nf=b(322),gh=b(5);Object(me.a)(Nd,"UserInfo",null,[]);
var Yg=b(562),Lh=b(175),Yh=b(84),Bh=b(291);Object(me.a)(jg,"LaunchSDXParams",null,[]);Object(me.a)(Qe,"RunfromButtonParameters",null,[]);var jh=b(166),hj=b(995),Nj=b(49),bk=b(45),yj=b(165);xe.prototype.eSa=function(G){var ia=Tf.AFrameworkApplication.ga.ra("IsO365CommercialHost"),eb="",Fb="",Oc=!1;var Tc=this.Wu.uy&&this.Wu.uy.isSuccess&&this.Wu.uy.value;Tc=Pf.a.Fta?Tc:!(Tc&&(!this.RA||!this.RA.isSuccess));this.Wu.uy&&!this.Wu.uy.isSuccess?(Fb=this.Wu.uy.errorCode,eb=this.Wu.uy.errorMessage):this.RA&&
!this.RA.isSuccess&&(Fb=this.RA.errorCode,eb=this.RA.errorMessage);var Md=[];Md.push(Object($f.a)(new Wc.a,{name:"IsScriptingEnabled",bool:this.Hba}));Md.push(Object($f.a)(new Wc.a,{name:"IsValidHost",bool:ia}));Md.push(Object($f.a)(new Wc.a,{name:"IsUserLicensed",bool:this.Wu.uy?this.Wu.uy.value:!1}));Pf.a.Fta||Md.push(Object($f.a)(new Wc.a,{name:"IsAdminSwitchOn",bool:this.RA?this.RA.value:!1}));Md.push(Object($f.a)(new Wc.a,{name:"ShowTab",bool:this.Hba}));Pf.a.Fta||Md.push(Object($f.a)(new Wc.a,
{name:"ServiceChecked",bool:!G}));this.Hba?Hb.a.Wwa(this.$)&&(G=jh.a(this.$),(null===G||void 0===G?0:G.Vm)?(Md.push(Object($f.a)(new Wc.a,{name:"RibbonType",string:"React"})),G.Vm.BAj(gh.a.eHb),G.Vm.nPd(["AutomateAutomateTask"],!Pf.a.Psf),Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(Oc=!0)):(Fb="ribbon_manager_error",eb="The RibbonManager or RibbonUser is null")):
this.h6h();Md.push(Object($f.a)(new Wc.a,{name:"Error",string:eb}));Md.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:Fb}));Bi.a(Ei.a.QEi,Tc,ri.getElapsedMilliseconds(this.initTime,Qh.a.Ta.Wb),Md);this.$.Pcb("automateTab",!1);return Promise.resolve(Oc)};xe.prototype.jd=function(G,ia){if(!ia)return!1;ia.MenuItems=this.OMg.KGh(ia.MenuId);return!0};xe.prototype.oYi=function(){var G=this;this.Lwa&&(Pf.a.e6?this.pf.GLf(this.Ix).continueWith(function(ia){ia.result&&G.Ix.iO(Pf.a.aQa)}):this.pf.j5i(this.Ix));
Nc(this.$)?this.J1e(Object($f.a)(new Fk.a,{IsSuccess:!0,Token:"FakeToken"})):this.osa.Dbc().then(function(ia){G.J1e(ia)})};xe.prototype.Hed=function(G,ia,eb){if(Pf.a.e6)this.Ix.Hed(G,ia,eb);else{var Fb=null;if(this.pf.Z4a)switch(G){case "1":case "2":case "3":Fb=this.Ix.rD.XM(parseInt(G,10)-1);break;case "4":case "5":case "6":Fb=Pf.a.J7?this.Ix.rD.XM(parseInt(G,10)-1):this.Ix.rD.DH(G);break;default:Fb=this.Ix.rD.DH(G)}ia[yk.a.GalleryButtonProps]=Rb.G3c(G,Fb,2===eb&&!Pf.a.J7);ia[yk.a.Alt]=Fb?Fb.name:
""}};xe.prototype.Pid=function(G){if(Pf.a.e6)this.Ix.Pid(G);else{var ia=!1,eb="",Fb=new oa(G.scriptMetadata),Oc={Operation:"HandleRefreshRibbonGallery"};Oc.RefreshOperation=G.operationName;switch(G.operationName){case Pf.a.fNf:G=this.Oid(Fb);eb=G.message;ia=G.returnValue;break;case Pf.a.dNf:G=this.Mid(Fb);eb=G.message;ia=G.returnValue;break;case Pf.a.cNf:G=this.Lid(Fb);eb=G.message;ia=G.returnValue;break;case Pf.a.eNf:G=this.Nid(Fb),eb=G.message,ia=G.returnValue}(Oc.GalleryUpdated=ia)?($e.ULS.sendTraceTag(537170313,
0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",eb),this.iO("RefreshGallery")):$e.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",eb);Oc.Message=eb;$e.ULS.sendTraceTag(537170311,0,50,ra.c(Oc))}};xe.prototype.R3h=function(G,ia,eb,Fb){if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.Cq(null,!1,1023))G=new Qe(Pf.a.rUf,G,ia,eb,this.Hba,Fb),this.Kob.Jwb(G)};
xe.prototype.S5e=function(G,ia,eb){G=new Qe(Pf.a.yVj,G,ia,eb,this.Hba);this.Kob.Jwb(G)};xe.prototype.F1h=function(G){this.Kob.eid(Pf.a.PAj,G)};xe.prototype.E1h=function(G){this.Kob.eid(Pf.a.u1g,G)};xe.prototype.G1h=function(G){this.Kob.eid(Pf.a.XEj,G)};xe.prototype.Rqi=function(G,ia){var eb=Nj.b().ri(G),Fb=[];Fb.push(Object($f.a)(new Wc.a,{name:"SessionId",string:this.$.ya.UserSessionId}));Fb.push(Object($f.a)(new Wc.a,{name:"MenuItemId",string:ia}));Fb.push(Object($f.a)(new Wc.a,{name:"WorkbookScriptCount",
int64:this.Tj.length}));Fb.push(Object($f.a)(new Wc.a,{name:"PublishedScriptCount",int64:this.mq.length}));Fb.push(Object($f.a)(new Wc.a,{name:"RecentScriptCount",int64:this.xt.length}));Fb.push(Object($f.a)(new Wc.a,{name:"Command",string:eb}));ia=ia?this.ygd(ia):null;if(eb=this.kRh(G,eb,ia))Fb.push(Object($f.a)(new Wc.a,{name:Pf.a.z$,string:eb.Sya.pr[Pf.a.z$]})),cd.a.instance.yNa(eb.Lxh,"Taskpane",eb.qHa,eb.ykd,eb.Sya),1904816141===G&&(Fb.push(Object($f.a)(new Wc.a,{name:"ScriptId",string:ia.id})),
Fb.push(Object($f.a)(new Wc.a,{name:"ShareId",string:ia.shareId})),Fb.push(Object($f.a)(new Wc.a,{name:"IsPreviewGallery",bool:!!this.Ix.rD.DH(ia.id)})),Fb.push(Object($f.a)(new Wc.a,{name:"IsOwner",bool:ia.Sbf||!!this.mq.DH(ia.id)})),this.$.Bf());Bi.a(Ei.a.NEi,void 0,void 0,Fb)};xe.prototype.kRh=function(G,ia,eb){var Fb=null,Oc=Pf.a.Cu,Tc=new Le.a(Pf.a.n8e,Pf.a.FUe,Pf.a.locale),Md=new Qc.a(Pf.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,Pf.a.XMd),Qd=new Id.a;Qd.pr.AdminPolicyForFeedback=ra.c(this.aGa);
Qd.pr.DocumentHostInfo=di.a.Kc(this.$.ya.DocumentHostInfo);Qd.pr.CodeEditorUrl=Pf.a.lvb(this.$);Qd.pr.MakerTestService=Ag.EwaSettings.getBooleanFeatureGate(Pf.a.uCb,!1);Qd.pr[Pf.a.ITf]=Pf.a.t3a(this.$);Qd.pr.StorageModePreference=this.k6f||"";Qd.pr.Source="Ribbon";Qd.pr.IsTeams=hb.a.Nka;Qd.pr[Pf.a.c8f]=di.a.Kc(Oc);Qd.pr[Pf.a.xte]=this.$.Jsf?"true":"false";Qd.pr[Pf.a.z$]=Xf.a.create().toString();var Je=pf(this.$),kf=je(this.$);Qd.oi.HeaderCssClass=Je;Qd.oi.TitleCssClass=kf;Qd.pr[Pf.a.k7e]=Je;Qd.pr[Pf.a.i9f]=
kf;Je={};Je.ribbonCommand=ia;Je[Pf.a.i6f]=this.osa.getAuthContext();Je[Pf.a.qab]=this.pf.FLf?this.mq.qeb():null;Je[Pf.a.qPb]=this.pf.WGd?this.Tj.qeb():null;Pf.a.e6&&(Je[Pf.a.aQa]=this.pf.UGd?this.xt.qeb():null);Qd.pr[Pf.a.uaf]=di.a.Kc(Je);ia={};lc(this.$,ia);Qd.pr[Pf.a.UTe]=di.a.Kc(ia);switch(G){case -45542983:Qd.pr.Script="";Qd.pr.Destination="Editor";Qd.pr.IsOwner=!0;Qd.oi[le.gl]=gi.a.instance.fa(2081);Qd.oi[le.taskPaneWidth]=Oc;Qd.oi[le.sourceLocationOverrideResourceId]=Pf.a.lvb(this.$);Fb=Pf.a.l1c;
break;case -1342227603:Qd.oi[le.gl]=gi.a.instance.fa(2083);Qd.oi[le.taskPaneWidth]=Oc;Qd.oi[le.sourceLocationOverrideResourceId]=Pf.a.W0e(this.$);break;case 971811139:case 1606046412:Qd.pr.Script="";Qd.pr.Destination="BackStage";Qd.pr.IsOwner=!0;Qd.oi[le.gl]=gi.a.instance.fa(2081);Qd.oi[le.taskPaneWidth]=Oc;Qd.oi[le.sourceLocationOverrideResourceId]=Pf.a.lvb(this.$);Fb=Pf.a.l1c;break;case 1845457202:Qd.oi[le.gl]=gi.a.instance.fa(2082);Qd.oi[le.taskPaneWidth]=Oc;Qd.oi[le.sourceLocationOverrideResourceId]=
Pf.a.l1e(this.$);Fb=Pf.a.fkj;break;case 1904816141:if(eb)Qd.pr.Script=di.a.Kc(eb.VVd()),Qd.pr.Destination="Details",Qd.pr.IsOwner=eb.Sbf||!!this.mq.DH(eb.id),Qd.oi[le.gl]=gi.a.instance.fa(2081),Qd.oi[le.taskPaneWidth]=Oc,Qd.oi[le.sourceLocationOverrideResourceId]=Pf.a.lvb(this.$),Fb=Pf.a.l1c;else return null;break;default:return null}return new jg(Tc,Md,Qd,Fb)};xe.prototype.VHh=function(){var G=this;mc.a.instance.lc("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(ia){G.aGa.FeedbackEnabled=
!0;G.aGa.ScreenshotEnabled=!0;G.aGa.EmailEnabled=!0;ia.ZJ("Enabled").then(function(eb){G.aGa.FeedbackEnabled=eb},function(){});ia.ZJ("IncludeScreenshot").then(function(eb){G.aGa.ScreenshotEnabled=eb},function(){});ia.ZJ("IncludeEmail").then(function(eb){G.aGa.EmailEnabled=eb},function(){})})};xe.prototype.u4h=function(G){var ia=this,eb=Qh.a.Ta.Wb,Fb=[];if(!G||!G.IsSuccess){var Oc=G?G.ErrorCode:"need_token";G=G?G.ErrorMessage:"No Access Token";Fb.push(Object($f.a)(new Wc.a,{name:"ServiceChecked",bool:!1}));
Fb.push(Object($f.a)(new Wc.a,{name:"Error",string:G}));Fb.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:Oc}));Bi.a(Ei.a.Zyd,!1,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);this.RA=new xd(!1,!1,void 0,Oc,G);return Promise.resolve(!1)}Fb.push(Object($f.a)(new Wc.a,{name:"ServiceChecked",bool:!0}));dg(this.$,G.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(Tc){ia.RA=new xd(Tc.OfficeScriptingEnabled,!0);ia.pf.FSg(Pf.a.pac(ia.$),Tc.OfficeScriptingEnabled);Fb.push(Object($f.a)(new Wc.a,
{name:"IsEnabled",bool:ia.RA.value}));Bi.a(Ei.a.Zyd,!0,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);return Promise.resolve(ia.RA.value)}).catch(function(Tc){Object.getType(Tc)===makerstorage.StorageServiceError?(Fb.push(Object($f.a)(new Wc.a,{name:"Error",string:Tc.message})),Fb.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Tc.errorCode.toString(),Tc.status.toString())}))):(Fb.push(Object($f.a)(new Wc.a,{name:"Error",string:Tc.toString()})),Fb.push(Object($f.a)(new Wc.a,
{name:"ErrorCode",string:"exception"})));Bi.a(Ei.a.Zyd,!1,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);ia.RA=new xd(!1,!1,void 0,"exception",Tc.toString());return Promise.resolve(!1)})};xe.prototype.J1e=function(G){var ia=this;this.pf.AWh(this.Ix);Pf.a.e6?this.pf.tVh(G,this.Ix,this.cache):this.TUh(G);this.pf.i5i(function(eb){ia.pf.nXh(eb,G,ia.Ix)},this.Ix)};xe.prototype.TUh=function(G){var ia=this,eb=Qh.a.Ta.Wb,Fb=[];if(G&&G.IsSuccess){dg(this.$,G.Token);var Oc=T.a.create().toString();Fb.push(Object($f.a)(new Wc.a,
{name:"CorrelationId",string:Oc}));makerstorage.getScripts(Oc).then(function(Tc){Fb.push(Object($f.a)(new Wc.a,{name:"HasReadCachedScripts",bool:ia.pf.Ywb}));ia.mq.clear();Tc=El(Tc);for(var Md=Tc.next();!Md.done;Md=Tc.next())ia.mq.Uu(new oa(Md.value));ia.mq.sort();ia.pf.FLf=!0;ia.pf.Jab=!0;ia.Lwa&&(Tc=di.a.Kc(ia.mq.qeb()),ia.indexedDB.hcb(new hj.a(Pf.a.qab,Tc)));Fb.push(Object($f.a)(new Wc.a,{name:"ScriptCount",int64:ia.mq.length}));Bi.a(Ei.a.JDb,!0,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);ia.iO(Pf.a.qab)}).catch(function(Tc){Object.getType(Tc)===
makerstorage.StorageServiceError?(Fb.push(Object($f.a)(new Wc.a,{name:"Error",string:Tc.message})),Fb.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Tc.errorCode.toString(),Tc.status.toString())})),17===Tc.errorCode&&ia.cache.EId(Pf.a.pac(ia.$))):(Fb.push(Object($f.a)(new Wc.a,{name:"Error",string:Tc.toString()})),Fb.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:"exception"})));Bi.a(Ei.a.JDb,!1,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);ia.pf.Jab=
!0;ia.iO(Pf.a.qab)})}else Oc=G?G.ErrorCode:"need_token",G=G?G.ErrorMessage:"No Access Token",Fb.push(Object($f.a)(new Wc.a,{name:"ServiceChecked",bool:!1})),Fb.push(Object($f.a)(new Wc.a,{name:"Error",string:G})),Fb.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:Oc})),Bi.a(Ei.a.JDb,!1,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb),this.pf.Jab=!0,this.iO(Pf.a.qab)};xe.prototype.ygd=function(G){if(Pf.a.e6)return this.Ix.ygd(G);switch(G){case "1":case "2":case "3":return this.Ix.rD.XM(parseInt(G,
10)-1);default:return!Pf.a.J7||"4"!==G&&"5"!==G&&"6"!==G?this.mq.DH(G)||this.Tj.DH(G)||this.LB.DH(G):this.Ix.rD.XM(parseInt(G,10)-1)}};xe.prototype.Oid=function(G){if(this.mq.Uu(G)){this.mq.sort();var ia=""}else{ia="";var eb=G.U_a();this.Tj.ofb(eb);this.Tj.sort();this.mq.ofb(G);this.mq.sort()}return{returnValue:!0,message:ia}};xe.prototype.Mid=function(G){this.Tj.j1a(G.id);return this.mq.j1a(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};
xe.prototype.Lid=function(G){var ia=G.U_a();ia.shareId=null;this.mq.Uu(ia)&&this.mq.sort();return this.Tj.Uu(G)?(this.Tj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};xe.prototype.Nid=function(G){return this.Tj.j1a(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};xe.prototype.iO=function(G){if(Pf.a.e6)this.Ix.iO(G);else{this.fHd();this.$.Bf();var ia=
[];ia.push(Object($f.a)(new Wc.a,{name:"Operation",string:G}));ia.push(Object($f.a)(new Wc.a,{name:"HasReadCachedScripts",bool:this.pf.Ywb}));ia.push(Object($f.a)(new Wc.a,{name:"ReadScriptsDone",bool:this.pf.wjd}));ia.push(Object($f.a)(new Wc.a,{name:"ReadSamplesScriptsDone",bool:this.pf.iHb}));ia.push(Object($f.a)(new Wc.a,{name:"SamplesScriptCount",int64:this.LB.length}));ia.push(Object($f.a)(new Wc.a,{name:"ReadPublishedScriptsDone",bool:this.pf.Jab}));ia.push(Object($f.a)(new Wc.a,{name:"PublishedScriptCount",
int64:this.mq.length}));ia.push(Object($f.a)(new Wc.a,{name:"ReadWorkbookScriptsDone",bool:this.pf.WW}));ia.push(Object($f.a)(new Wc.a,{name:"WorkbookScriptCount",int64:this.Tj.length}));Bi.a(Ei.a.Osf,!0,0,ia)}};xe.prototype.fHd=function(){this.Ix.rD=new fb([],function(){});for(var G=this.Tj?this.Tj.length:0,ia=this.mq?this.mq.length:0,eb=this.LB?this.LB.length:0,Fb=0,Oc=Pf.a.J7?6:Pf.a.ZHf,Tc=0;Tc<Oc;Tc++)if(Tc<G)this.Ix.rD.Uu(this.Tj.XM(Tc));else if(Tc-G+Fb<ia){var Md=this.mq.XM(Tc-G+Fb);this.Tj.DH(Md.id)?
(Fb++,Tc--):this.Ix.rD.Uu(Md)}else Tc-G-ia+Fb<eb&&this.Ix.rD.Uu(this.LB.XM(Tc-G+Fb-ia))};xe.prototype.jKd=function(G){Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(G?(bk.PageLoadTrackingInfo.instance.g7(gh.a.pO,["automateTab"]),bk.PageLoadTrackingInfo.instance.dX(gh.a.pO,["automateTab"]),bk.PageLoadTrackingInfo.instance.kS(gh.a.pO,["automateTab"])):bk.PageLoadTrackingInfo.instance.sda(gh.a.pO,
["automateTab"]))};xe.prototype.h6h=function(){Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&yj.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(gh.a.eHb))};Ek.Object.defineProperties(xe.prototype,{mq:{configurable:!0,enumerable:!0,get:function(){return this.pf.mq}},Tj:{configurable:!0,enumerable:!0,get:function(){return this.pf.Tj}},LB:{configurable:!0,enumerable:!0,get:function(){return this.pf.LB}},xt:{configurable:!0,enumerable:!0,
get:function(){return this.pf.xt}},Ra:{configurable:!0,enumerable:!0,get:function(){return this.cQc}},Z4a:{configurable:!0,enumerable:!0,get:function(){return this.pf.Z4a}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.$pg}},Hba:{configurable:!0,enumerable:!0,get:function(){var G=!!this.Wu.uy&&this.Wu.uy.isSuccess&&this.Wu.uy.value,ia=!!this.RA&&!this.RA.isSuccess,eb=!!this.RA&&this.Wu.uy.isSuccess&&this.RA.value;ia=Pf.a.Fta||eb||ia&&!hb.a.Jka(11);return this.Dhf&&G&&ia}},Dhf:{configurable:!0,
enumerable:!0,get:function(){var G="TestHost"===this.$.ya.DocumentHostInfo.HostTier,ia=Tf.AFrameworkApplication.ga.Ua("UserPrincipalName");ia=!Tf.AFrameworkApplication.ga.ra("IsAnonymousUser")&&!!ia&&!ia.includes("ext#")&&!ia.includes("guest#");return!hb.a.Bka&&(G||this.osa.Fse&&ia)}}});Object(me.a)(xe,"AutomateCommandManager",null,[622]);var ij=b(1405),ck=b(1357),Ii=b(244);mf.key="InsertAgaveClientSideParametersKey";Object(me.a)(mf,"InsertAgaveClientSideParameters",null,[]);var jj=b(51),Tj=b(104),
zj=b(22),hk=b(1166);Ye.prototype.Jwb=function(G){if(G.Hba){var ia=[];ia.push(Object($f.a)(new Wc.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.g7a}));ia.push(Object($f.a)(new Wc.a,{name:"actionName",string:G.actionName}));ia.push(Object($f.a)(new Wc.a,{name:Pf.a.z$,string:G.clickId.toString()}));this.g7a?this.MWf(G):this.n2h(G);Bi.a(Ei.a.OEi,void 0,void 0,ia)}};Ye.prototype.eid=function(G,ia){var eb={};eb[Pf.a.z$]=ia;this.INd(G,eb)};Ye.prototype.Ttj=function(){this.L1f()?this.kHf():zj.g(this.$).Ea.Ime(this.s9a)};
Ye.prototype.L1f=function(){if(this.g7a||Nc(this.$))return!1;var G=Tj.a(this.$);return zj.g(this.$).Ea.r_b&&G.kei()};Ye.prototype.kHf=function(){var G=this;this.Wu.uy?this.Wu.uy.value&&this.osa.Dbc():this.Wu.f0c().then(function(ia){ia&&G.osa.Dbc()});Bi.a(Ei.a.JEi)};Ye.prototype.nmj=function(){var G=Xf.a.create().toString(),ia={};lc(this.$,ia);var eb={};eb[Pf.a.i6f]=this.osa.getAuthContext();var Fb={};Fb[Pf.a.UTe]=di.a.Kc(ia);Fb[Pf.a.uaf]=di.a.Kc(eb);Fb[Pf.a.Rgh]=di.a.Kc(this.$.ya.DocumentHostInfo);
Fb[Pf.a.dFj]=Mg(this.$);Fb[Pf.a.c8f]=di.a.Kc(Pf.a.Cu);Fb[Pf.a.xte]=this.$.Jsf?"true":"false";Fb[Pf.a.ITf]=Pf.a.t3a(this.$);Fb[Pf.a.k7e]=pf(this.$);Fb[Pf.a.i9f]=je(this.$);Fb[Pf.a.z$]=G;ia=[];ia.push(Object($f.a)(new Wc.a,{name:Pf.a.z$,string:G}));Bi.a(Ei.a.MEi,void 0,void 0,ia);this.INd(Pf.a.Y9h,Fb)};Ye.prototype.n2h=function(G){var ia=this;this.pyj(G);Nc(this.$)&&dg(this.$,"localstorage");Rh.TaskExtensions.Ba(jj.GetServiceTaskFactory.Va(this.$.da,374,375,1),function(eb){ia.ysi(eb.result).continueWith(function(){ia.mmj(G)});
ia.g7a=!0},this.$.la,3)};Ye.prototype.ysi=function(G){var ia={};ia.SolutionId=Pf.a.solutionId;ia.Version=Pf.a.XMd;ia.StoreType=OSF.StoreType.Sdx;ia.StoreId=OSF.StoreType.Sdx;ia.AssetId=Pf.a.solutionId;ia.AssetStoreId=OSF.StoreType.Sdx;ia.TargetType=1;ia.SharedRuntimeId=Pf.a.awb(this.$);ia.SourceLocationOverrideResourceId=Pf.a.awb(this.$);ia.IsToBePersisted=!1;var eb=new ij.a;eb.gl=gi.a.instance.fa(2102);eb.taskPaneWidth=Pf.a.Cu;var Fb=new mf;Fb.rNb=je(this.$);Fb.dba=pf(this.$);return G.HMd(ia,eb,
void 0,void 0,Fb)};Ye.prototype.mmj=function(G){this.nmj();Ii.a(this.$)&&Ii.a(this.$).Vme(this.THi);this.MWf(G)};Ye.prototype.MWf=function(G){var ia={};ia[Pf.a.vij]=G.shapeId;ia[Pf.a.uij]=G.scriptLink;ia[Pf.a.z$]=G.clickId.toString();ia[Pf.a.tij]=G.buttonText;this.INd(G.actionName,ia)};Ye.prototype.INd=function(G,ia){var eb=new Qc.a(Pf.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,Pf.a.XMd),Fb=new Le.a(Pf.a.n8e,Pf.a.FUe,this.$.ya.UICultureTag),Oc=new Id.a;Oc.oi[le.gl]=gi.a.instance.fa(2102);Oc.oi[le.sourceLocationOverrideResourceId]=
Pf.a.awb(this.$);Oc.oi[le.yTc]=ia;Oc.oi[le.taskPaneWidth]=Pf.a.Cu;cd.a.instance.yNa(eb,ck.a.action,G,Fb,Oc)};Ye.prototype.pyj=function(G){Ag.EwaSettings.getBooleanFeatureGate(Pf.a.d8f,!1)&&G.actionName===Pf.a.rUf&&(G=new hk.a(G.scriptLink,"initializing",G.clickId.toString(),G.buttonText),this.businessBarManager.Ple(63,G))};Object(me.a)(Ye,"AutomateCommandRunFromButton",null,[623]);var mk=b(161),Oj=b(21);ud.JCj=function(G){G.sort(function(ia,eb){return eb.UFe-ia.UFe})};ud.lTd=function(G){G.sort(function(ia,
eb){return Oj.a.compare(ia.name,eb.name,!0)})};ud.bYh=function(G){var ia;var eb=ia=null;if(G){var Fb=G.indexOf(":");if(-1!==Fb)return ia=G.substr(0,Fb),eb=G.substr(Fb+1),{returnValue:!0,j6f:ia,shareId:eb}}return{returnValue:!1,j6f:ia,shareId:eb}};ud.ZWh=function(G,ia){var eb={};eb[Pf.a.pgg]=encodeURIComponent(G.workbookContext.WorkbookFileName);eb[Pf.a.UVf]=ia.qeb();return ra.c(eb)};ud.JLf=function(G,ia){return Rh.TaskExtensions.Wha(ia.S3a(Pf.a.qPb),function(eb){eb=eb.result;if(""!==eb){eb=ra.b(eb);
var Fb=eb[Pf.a.UVf];if(eb[Pf.a.pgg]===encodeURIComponent(G.workbookContext.WorkbookFileName)){eb=new fb([],function(Tc){ud.lTd(Tc)});Fb=El(Fb);for(var Oc=Fb.next();!Oc.done;Oc=Fb.next())eb.Uu(new oa(Oc.value));eb.sort();return eb}}},G.la,3)};Ek.Object.defineProperties(ud.prototype,{Z4a:{configurable:!0,enumerable:!0,get:function(){var G=Pf.a.e6?this.Edc:this.Ywb;return this.iHb||G||this.wjd}},wjd:{configurable:!0,enumerable:!0,get:function(){return(Pf.a.e6?this.Kab:this.Jab)&&this.WW&&this.iHb}}});
Object(me.a)(ud,"AutomateCommandStorageBase",null,[]);var yh=b(119),Kk=b(98);Am(Ge,ud);Ge.prototype.FSg=function(G,ia){if(this.cache.tg()){var eb={};eb.TimeStamp=Qh.a.Ta.Wb;eb.IsEnabled=ia;this.cache.UOd(G,di.a.Kc(eb))}};Ge.prototype.RJh=function(G){var ia=!1,eb=!1,Fb=null;this.cache.tg()&&(G=ra.b(this.cache.Hvb(G)))&&(eb=G.IsEnabled,Fb=new Date(G.TimeStamp),ia=!0);return new xd(eb,ia,Fb)};Ge.prototype.GLf=function(G){var ia=this,eb=Qh.a.Ta.Wb,Fb=[];return Rh.TaskExtensions.Wha(this.indexedDB.S3a(Pf.a.aQa),
function(Oc){var Tc=!ia.Kab||!ia.xt.length;Oc=Oc.result;Fb.push(Object($f.a)(new Wc.a,{name:"ExistingScriptCount",int64:ia.xt.length}));if(""!==Oc&&(Oc=ra.b(Oc),Fb.push(Object($f.a)(new Wc.a,{name:"CachedScriptCount",int64:Oc.length})),Tc)){for(var Md=El(Oc),Qd=Md.next();!Qd.done;Qd=Md.next())ia.xt.Uu(new oa(Qd.value));ia.Edc=!0;ia.UGd=0<Oc.length;Bi.a(Ei.a.Msf,Tc,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);ia.DHd(G);return!0}Bi.a(Ei.a.Msf,Tc,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);return!1},
this.$.la,3)};Ge.prototype.j5i=function(G){Ag.EwaSettings.getBooleanFeatureGate(Pf.a.SXc,!1)&&this.p5i(G);Pf.a.e6?this.GLf(G):this.h5i(G)};Ge.prototype.tVh=function(G,ia,eb){var Fb=this,Oc=Qh.a.Ta.Wb,Tc=[];if(G&&G.IsSuccess){dg(this.$,G.Token);var Md=T.a.create().toString();Tc.push(Object($f.a)(new Wc.a,{name:"CorrelationId",string:Md}));makerstorage.getRecentScripts(Md).then(function(Qd){Tc.push(Object($f.a)(new Wc.a,{name:"HasReadCachedScripts",bool:Fb.Edc}));Fb.xt.clear();Qd=El(Qd);for(var Je=
Qd.next();!Je.done;Je=Qd.next())Fb.xt.Uu(new oa(Je.value));Fb.UGd=!0;Fb.Kab=!0;Fb.indexedDB.tg()&&(Qd=di.a.Kc(Fb.xt.qeb()),Fb.indexedDB.hcb(new hj.a(Pf.a.aQa,Qd)));Tc.push(Object($f.a)(new Wc.a,{name:"ScriptCount",int64:Fb.xt.length}));Bi.a(Ei.a.JDb,!0,ri.getElapsedMilliseconds(Oc,Qh.a.Ta.Wb),Tc);ia.iO(Pf.a.aQa)}).catch(function(Qd){Object.getType(Qd)===makerstorage.StorageServiceError?(Tc.push(Object($f.a)(new Wc.a,{name:"Error",string:Qd.message})),Tc.push(Object($f.a)(new Wc.a,{name:"ErrorCode",
string:String.format("makerstorage_{0}_{1}",Qd.errorCode.toString(),Qd.status.toString())})),17===Qd.errorCode&&eb.EId(Pf.a.pac(Fb.$))):(Tc.push(Object($f.a)(new Wc.a,{name:"Error",string:Qd.toString()})),Tc.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:"exception"})));Bi.a(Ei.a.KEi,!1,ri.getElapsedMilliseconds(Oc,Qh.a.Ta.Wb),Tc);Fb.Kab=!0;ia.iO(Pf.a.aQa)})}else Md=G?G.ErrorCode:"need_token",G=G?G.ErrorMessage:"No Access Token",Tc.push(Object($f.a)(new Wc.a,{name:"ServiceChecked",bool:!1})),
Tc.push(Object($f.a)(new Wc.a,{name:"Error",string:G})),Tc.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:Md})),Bi.a(Ei.a.JDb,!1,ri.getElapsedMilliseconds(Oc,Qh.a.Ta.Wb),Tc),this.Kab=!0,ia.iO(Pf.a.aQa)};Ge.prototype.i5i=function(G,ia){var eb=this,Fb=new mk.a,Oc=qg(this.$);Gf(this.$,function(Tc){if((Tc=Tc.Result)&&200===Tc.ResponseStatusCode)Tc=Tc.ResponseBody.join(""),Tc=JSON.parse(Tc),G(eb.sWi(Tc.value)),Fb.setResult(!0);else{Tc=Tc?"RichApi_"+Tc.ResponseStatusCode:"RichApiError";var Md=[];Md.push(Object($f.a)(new Wc.a,
{name:"Error",string:"Failed to read shared script ids from document"}));Md.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:Tc}));eb.WW=!0;eb.K_a(ia,Qh.a.Ta.Wb,0,Md);Fb.setResult(!1)}},function(Tc){Tc=yh.a.pg(Tc.data);$e.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var Md=[];Md.push(Object($f.a)(new Wc.a,{name:"Error",string:"Failure using rich api: "+Tc}));Md.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:"RichApiFailure"}));eb.WW=!0;
eb.K_a(ia,Qh.a.Ta.Wb,0,Md);Fb.setResult(!1)},Oc,Fb)};Ge.prototype.nXh=function(G,ia,eb){var Fb=this,Oc=Qh.a.Ta.Wb,Tc=0,Md=0;this.WW=Tc===G.count;var Qd=[];Qd.push(Object($f.a)(new Wc.a,{name:"ScriptIds",int64:G.count}));if(G.count)if(ia&&ia.IsSuccess){dg(this.$,ia.Token);var Je={};ia=El(G);for(var kf=ia.next();!kf.done;Je={$fb:Je.$fb},kf=ia.next())kf=kf.value,Je.$fb=T.a.create().toString(),makerstorage.getSharedScript(kf.value,Je.$fb).then(function(xf){return function(og){var Ug=[];Ug.push(Object($f.a)(new Wc.a,
{name:"BodySize",int64:og.body.length}));Ug.push(Object($f.a)(new Wc.a,{name:"CorrelationId",string:xf.$fb}));Bi.a(Ei.a.Nsf,!0,ri.getElapsedMilliseconds(Oc,Qh.a.Ta.Wb),Ug);Tc++;og=new oa(og);og.shareId=G.oa(og.id);Fb.Tj.Uu(og);Fb.WW=Tc===G.count;Fb.WGd=!0;Fb.K_a(eb,Oc,Md,Qd)}}(Je)).catch(function(xf){return function(og){var Ug=[];Object.getType(og)===makerstorage.StorageServiceError?(Qd.push(Object($f.a)(new Wc.a,{name:"Error",string:og.message})),Qd.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",
og.errorCode.toString(),og.status.toString())}))):(Ug.push(Object($f.a)(new Wc.a,{name:"Error",string:og.toString()})),Ug.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:"exception"})));Ug.push(Object($f.a)(new Wc.a,{name:"CorrelationId",string:xf.$fb}));Bi.a(Ei.a.Nsf,!1,ri.getElapsedMilliseconds(Oc,Qh.a.Ta.Wb),Ug);Tc++;Md++;Fb.WW=Tc===G.count;Fb.K_a(eb,Oc,Md,Qd)}}(Je)).finally(function(){if(Ag.EwaSettings.getBooleanFeatureGate(Pf.a.SXc,!1)&&Fb.indexedDB.tg()&&Fb.WW){var xf=ud.ZWh(Fb.$,Fb.Tj);
Fb.indexedDB.hcb(new hj.a(Pf.a.qPb,xf))}})}else Je=ia?ia.ErrorCode:"need_token",ia=ia?ia.ErrorMessage:"No Access Token",Qd.push(Object($f.a)(new Wc.a,{name:"Error",string:ia})),Qd.push(Object($f.a)(new Wc.a,{name:"ErrorCode",string:Je})),this.WW=!0,this.K_a(eb,Oc,Md,Qd);else this.WW=this.WGd=!0,this.K_a(eb,Oc,Md,Qd),Ag.EwaSettings.getBooleanFeatureGate(Pf.a.SXc,!1)&&Rh.TaskExtensions.Wha(ud.JLf(this.$,this.indexedDB),function(xf){xf.result&&(Fb.indexedDB.e6c(Pf.a.qPb),Fb.Tj.clear(),eb.iO("CachedScripts"))},
this.$.la,3)};Ge.prototype.AWh=function(G){var ia={id:"samples-6"};ia.name=gi.a.instance.fa(2098);this.LB.Uu(new oa(ia));ia.id="samples-8";ia.name=gi.a.instance.fa(2099);this.LB.Uu(new oa(ia));ia.id="samples-2";ia.name=gi.a.instance.fa(2095);this.LB.Uu(new oa(ia));ia.id="samples-4";ia.name=gi.a.instance.fa(2096);this.LB.Uu(new oa(ia));ia.id="samples-5";ia.name=gi.a.instance.fa(2097);this.LB.Uu(new oa(ia));Pf.a.J7&&(ia.id="samples-9",ia.name=gi.a.instance.fa(2100),this.LB.Uu(new oa(ia)));this.iHb=
!0;G.iO("SampleScripts")};Ge.prototype.sWi=function(G){var ia=new Kk.a;if(G=this.E1a.parseFromString(G,"text/xml").querySelector('[id="script-ids-node-id"]')){G=G.getElementsByTagName("scriptId");for(var eb={},Fb=0;Fb<G.length;eb={dQb:eb.dQb,aQb:eb.aQb,WPb:eb.WPb},Fb++)eb.dQb=G[Fb].getAttribute("id"),eb.dQb&&(eb.aQb=void 0,eb.WPb=void 0,function(Oc){return function(){var Tc=ud.bYh(Oc.dQb);Oc.aQb=Tc.j6f;Oc.WPb=Tc.shareId;return Tc}}(eb)().returnValue&&ia.ia(eb.aQb,eb.WPb))}return ia};Ge.prototype.p5i=
function(G){var ia=this,eb=Qh.a.Ta.Wb,Fb=[];Rh.TaskExtensions.Wha(ud.JLf(this.$,this.indexedDB),function(Oc){var Tc=Oc.result;Fb.push(Object($f.a)(new Wc.a,{name:"ExistingScriptCount",int64:ia.Tj.length}));if(Tc){Fb.push(Object($f.a)(new Wc.a,{name:"CachedScriptCount",int64:Tc.length}));if(Oc=!ia.WW||0===ia.Tj.length){Tc=El(Tc.getScripts());for(var Md=Tc.next();!Md.done;Md=Tc.next())ia.Tj.Uu(Md.value);ia.Tj.sort();Bi.a(Ei.a.$yd,Oc,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);ia.DHd(G);return!0}Bi.a(Ei.a.$yd,
Oc,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb)}else Bi.a(Ei.a.$yd,!1,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);return!1},this.$.la,3)};Ge.prototype.h5i=function(G){var ia=this,eb=Qh.a.Ta.Wb,Fb=[];Rh.TaskExtensions.Wha(this.indexedDB.S3a(Pf.a.qab),function(Oc){var Tc=!ia.Jab||!ia.mq.length;Oc=Oc.result;Fb.push(Object($f.a)(new Wc.a,{name:"ExistingScriptCount",int64:ia.mq.length}));if(""!==Oc&&(Oc=ra.b(Oc),Fb.push(Object($f.a)(new Wc.a,{name:"CachedScriptCount",int64:Oc.length})),Tc)){Oc=El(Oc);
for(var Md=Oc.next();!Md.done;Md=Oc.next())ia.mq.Uu(new oa(Md.value));ia.mq.sort();Bi.a(Ei.a.Lsf,Tc,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);ia.DHd(G);return!0}Bi.a(Ei.a.Lsf,Tc,ri.getElapsedMilliseconds(eb,Qh.a.Ta.Wb),Fb);return!1},this.$.la,3)};Ge.prototype.K_a=function(G,ia,eb,Fb){this.WW&&(Fb.push(Object($f.a)(new Wc.a,{name:"ScriptCount",int64:this.Tj.length})),Fb.push(Object($f.a)(new Wc.a,{name:"ScriptErrorCount",int64:eb})),Bi.a(Ei.a.LEi,!eb,ri.getElapsedMilliseconds(ia,Qh.a.Ta.Wb),Fb),
this.Tj.sort(),G.iO(Pf.a.qPb))};Ge.prototype.DHd=function(G){this.Ywb=!0;G.iO("CachedScripts")};Object(me.a)(Ge,"AutomateCommandStorage",ud,[]);var Hk=ng.a;Am(Yd,Hk);Yd.prototype.create=function(){var G=this,ia=jj.GetServiceTaskFactory.Va(this.$.da,349,350,this.ub),eb=Zj.a.loadScript(109,4,this.ub,void 0,void 0,351),Fb=jj.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.ub),Oc=jj.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.ub),Tc=jj.GetServiceTaskFactory.Va(this.$.da,5,4,this.ub);
Rh.TaskExtensions.Ba(Rh.TaskExtensions.ye([ia,eb,Fb,Oc,Tc],this.la,3),function(){var Md=ia.result,Qd=Oc.result,Je=Tc.result,kf=new ke,xf=new uc(G.$,Md,kf),og=new Ge(G.$,Qd),Ug=new fe(G.$,og);Je=new Ye(G.$,xf,kf,Je);G.Eb(G.$.da.Aa(352)||new xe(G.$,Md,Fb.result,Qd,Je,kf,xf,og,Ug))},this.la,3)};Yd.ka=function(G){G&&G.da.Ga(351,new Yd(G))};Object(me.a)(Yd,"AutomateCommandManagerFactory",ng.a,[]);var Aj=b(103),dk=b(1358),Lk=b(186),ik=b(55);Jc.prototype.Zc=function(){return!1};Jc.prototype.executeCommand=
function(G,ia,eb){G=!1;switch(ia.command){case 73979048:this.Vrb&&this.Vrb.g_i(ia,Aj.a.instance,Tf.AFrameworkApplication.ga,eb),G=!0}return G?ik.Task.Sa(!0):Lk.a(ia.command)};Jc.prototype.Lc=function(G,ia){return 73979048===ia.command&&Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)};Jc.prototype.jd=function(){return!1};Jc.prototype.dispose=function(){this.Vrb&&this.Vrb.dispose()};Object(me.a)(Jc,"DataFromPictureCommandHandler",null,[429,3]);var Uj=mi.a;Am(eg,
Uj);eg.prototype.Nd=function(){var G=this,ia=jj.GetServiceTaskFactory.Va(this.$.da,328,327,1),eb=jj.GetServiceTaskFactory.Va(this.$.da,484,485,1);Rh.TaskExtensions.Ba(Rh.TaskExtensions.ye([ia,eb],this.$.la),function(){G.Cd([new Jc(G.$,ia.result,eb.result)])},this.$.la,3)};eg.ka=function(G){mi.a.fe(452,new eg(G))};Object(me.a)(eg,"DataFromPictureCommandHandlerFactory",mi.a,[]);Be.prototype.jTh=function(G){$e.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",G);for(var ia=new gg.a,eb=El(this.r1b),
Fb=eb.next();!Fb.done;Fb=eb.next()){Fb=El(Fb.value.GDb);for(var Oc=Fb.next();!Oc.done;Oc=Fb.next())Oc=Oc.value,Oc.id===G&&ia.add(Oc)}return ia};Be.prototype.gle=function(G){this.r1b.add(G)};Be.prototype.w9i=function(G){for(var ia=El(this.r1b),eb=ia.next();!eb.done;eb=ia.next())if(eb=eb.value,eb.Uoe===G.Uoe){this.r1b.remove(eb);break}};Be.Weh=function(G,ia,eb){eb=void 0===eb?null:eb;G=Be.xLh(G);0<G.length&&(Be.gwc(G,!1),eb&&eb(ia,G))};Be.xLh=function(G){var ia=[];if(G&&G.GDb&&0<G.GDb.count){G=El(G.GDb);
for(var eb=G.next();!eb.done;eb=G.next())if(eb=eb.value,eb.controls&&0<eb.controls.count){eb=El(eb.controls);for(var Fb=eb.next();!Fb.done;Fb=eb.next())if(Fb=Fb.value,Fb.menuItems&&0<Fb.menuItems.count){Fb=El(Fb.menuItems);for(var Oc=Fb.next();!Oc.done;Oc=Fb.next())Array.add(ia,Oc.value.id)}}}return ia};Be.gwc=function(G,ia){if(G.length){var eb=[];G=El(G);for(var Fb=G.next();!Fb.done;Fb=G.next())eb.push(appChrome.actions.updateControlEnabledDisabledState(Fb.value,ia));appChrome.api.dispatch(eb)}};
Ek.Object.defineProperties(Be.prototype,{r1b:{configurable:!0,enumerable:!0,get:function(){return this.zlg}}});Object(me.a)(Be,"ContextMenuExtensibilityCache",null,[338,339]);var Mk=b(1479),cl=b(1073),Nk=b(1019);Lf.prototype.AYa=function(G,ia){ia=void 0===ia?null:ia;if(G=Nk.a.Eub(G)){appChrome.addInApi.dispatchActionsToInstallAddIn(G,ia);ia=El(G.tabs);for(var eb=ia.next();!eb.done;eb=ia.next())if(eb.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(G,function(){});break}}};
Lf.prototype.TId=function(G){(G=Nk.a.Eub(G))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(G)};Lf.efh=function(G,ia,eb){eb=void 0===eb?null:eb;G=Lf.eWh(G);0<G.length&&(Lf.gwc(G,!1),eb&&eb(ia,G))};Lf.eWh=function(G){var ia=[];if(G&&(G=G.yW,G.Ts&&0<G.Ts.count)){G=El(G.Ts);for(var eb=G.next();!eb.done;eb=G.next())if(eb=eb.value,eb.groups&&0<eb.groups.length){eb=El(eb.groups);for(var Fb=eb.next();!Fb.done;Fb=eb.next())if(Fb=Fb.value,Fb.controls&&0<Fb.controls.length){Fb=El(Fb.controls);for(var Oc=
Fb.next();!Oc.done;Oc=Fb.next())Array.add(ia,Oc.value.id)}}}return ia};Lf.gwc=function(G){if(G.length){var ia=[];G=El(G);for(var eb=G.next();!eb.done;eb=G.next())ia.push(appChrome.actions.updateControlEnabledDisabledState(eb.value,!0));appChrome.api.dispatch(ia)}};Object(me.a)(Lf,"OneLineRibbonExtensibilityManager",null,[368]);var jk=b(1140);pe.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(G,ia){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(G,ia)};
pe.prototype.bid=function(G,ia,eb,Fb,Oc,Tc,Md){Tc=void 0===Tc?null:Tc;Md=void 0===Md?null:Md;$e.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",G);if((G=ia.Pia(Oc.ownerAddinInfo.storeType,Oc.ownerAddinInfo.solutionId))&&G.GB&&!G.GB.getIsUpgrading())if(ia=null,0<G.GB.getNotificationParams().length&&(ia=this.uue(G.GB.getNotificationParams()[0]),Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1)&&ia&&2147758681===ia.errorCode&&(G.isUpgraded=
!0),Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpgradeAddinUsageEnabled",!1)&&ia&&2147758681===ia.errorCode&&$e.ULS.sendTraceTag(529278163,220,50,"Upgrade")),2!==G.GB.getStatus()&&(1!==G.GB.getStatus()||ia&&2147758681===ia.errorCode))ia&&this.v2f(G,ia,Md);else try{eb.setOwnerAddinEToken(G.GB.getEToken()),Oc.action(eb,Fb.lma),Tc&&Tc()}catch(Qd){$e.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",Tf.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?
Qd.stack:Qd.message)),jk.a.DRd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}};pe.prototype.v2f=function(G,ia,eb){var Fb=this;eb=void 0===eb?null:eb;var Oc=G.GB;if(1===Oc.getNotificationParams().length||ia.eec){var Tc=ia.vha,Md=ia.mia;ia.vha=function(){Oc.removeFirstNotification();if(0<Oc.getNotificationParams().length){var Qd=Fb.uue(Oc.getNotificationParams()[0]);Fb.v2f(G,Qd)}2147758681===ia.errorCode&&(Lf.efh(G.Ko,Oc,Object(Kh.a)(Fb,Fb.$9e,"initUpgradeStateDetectTask")),
Be.Weh(G.Uqb,Oc,Object(Kh.a)(Fb,Fb.$9e,"initUpgradeStateDetectTask")));Tc&&Tc()};ia.mia=function(){Md&&Md();eb&&eb()};jk.a.FRd(ia)}};pe.prototype.$9e=function(G,ia){var eb=null;eb=function(){G.getIsUpgrading()?window.setTimeout(eb,1E3):G.getUpgradingFailed()?Lf.gwc(ia,!0):Tf.AFrameworkApplication.ta.updateCommandUI()};window.setTimeout(eb,1E3)};pe.prototype.uue=function(G){var ia=new cl.a;ia.BLa=G.infoType;ia.id=G.id;ia.title=G.title;ia.description=G.description;ia.buttonText=G.buttonTxt;ia.vha=G.buttonCallback;
ia.eec=G.highPriority;ia.mia=G.dismissCallback;ia.errorCode=G.errorCode;ia.Z8e=G.iframeNotificationUrl;return ia};Ek.Object.defineProperties(pe.prototype,{Tje:{configurable:!0,enumerable:!0,get:function(){return this.yEc||(this.yEc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},set:function(G){this.yEc=G}},LMg:{configurable:!0,enumerable:!0,get:function(){return this.d2d||(this.d2d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(me.a)(pe,"AddinCommandsActionHandler",
null,[334]);var sk=b(947),Ij=b(907);Kd.prototype.jGh=function(G){if(void 0!==G&&null!==G&&G===gh.a.CBe)G="ContextMenuCell";else return null;var ia=this.Ra.Pc();this.BFh(ia,G);return ia};Kd.prototype.BFh=function(G,ia){ia=this.R1g.jTh(ia);ia=El(ia);for(var eb=ia.next();!eb.done;eb=ia.next()){eb=El(eb.value.controls);for(var Fb=eb.next();!Fb.done;Fb=eb.next())this.oFh(G,Fb.value)}};Kd.prototype.oFh=function(G,ia){var eb=ia.LU[sk.a.id],Fb=ia.LU[sk.a.zUa],Oc=ia.LU[sk.a.CUa],Tc="Image16by16",Md=ia.LU[sk.a.AUa];
Ij.c(Oc)&&(Tc="None");0<ia.menuItems.count?(eb=this.Ra.ww(eb,eb,Fb,798637440),eb.uKb(Tc,Oc,null),this.hGh(eb.menu,ia),G.buttons.push(eb)):G.buttons.push(this.Ra.GHa(eb,Fb,Md,Oc,Tc,null,!1))};Kd.prototype.hGh=function(G,ia){var eb,Fb=this.Ra.Pc();ia=El(ia.menuItems);for(eb=ia.next();!eb.done;eb=ia.next()){var Oc=eb.value;eb=Oc.sla[sk.a.id];var Tc=Oc.sla[sk.a.zUa],Md=Oc.sla[sk.a.CUa],Qd="Image16by16";Oc=Oc.sla[sk.a.AUa];Ij.c(Md)&&(Qd="None");eb=this.Ra.GHa(eb,Tc,Oc,Md,Qd,null,!1);Fb.buttons.push(eb)}G.Ec.push(Fb)};
Object(me.a)(Kd,"AddInCommandsContextMenuExtensibilityHandler",null,[595]);var il=b(1068);Object(me.a)(de,"AddinStatusCommandValues",null,[]);Xe.R1i=function(G){var ia=new de;ia.Bi=G.SYa;ia.visible=ia.Bi?!0:!1;return ia};Xe.Vxc=function(G,ia,eb,Fb,Oc){var Tc=document.getElementById(eb);Tc?Xe.Fzj(G,ia,Tc,Fb,Oc):$e.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",eb))};Xe.Fzj=function(G,ia,eb,Fb,Oc){eb?G.SYa===CommonUIStrings.l_ErrorLoadingAddInsTitle?jk.a.syj(ia,eb,Fb,
Oc):G.SYa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&jk.a.Kzj(ia,eb):$e.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object(me.a)(Xe,"AddinCommandsStatusHandler",null,[]);var Rk=b(38),pl=b(231),jl=Rk.a;Am(Pe,jl);Pe.prototype.Aq=function(G){this.addHandler("LAC",G)};Pe.prototype.Wq=function(G){this.removeHandler("LAC",G)};Pe.prototype.es=function(G,ia){var eb=this;if("QueryAddinLabel"!==G)return!1;ia[il.a.LabelText]!==this.$F.SYa&&
(G=Xe.R1i(this.$F),ia[il.a.LabelText]=G.Bi,ia[il.a.Visible]=G.visible,window.setTimeout(function(){eb.Vxc()},0));return!0};Pe.prototype.vn=function(){return!0};Pe.prototype.Vxc=function(){this.$&&Xe.Vxc(this.$F,this.$.domElement,this.JEj,gi.a.instance.fa(337),gi.a.instance.fa(338))};Pe.prototype.dispose=function(){this.$.ea.Dk(this.od);this.$F.C$i(this.H4e);this.agaveCommandManager&&(this.agaveCommandManager.Saj(this.Cye),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.SF(this),
this.statusBarManager=null);this.$F=this.$=null;jl.prototype.dispose.call(this)};Object(me.a)(Pe,"AddinCommandsStatusBarManager",Rk.a,[483,271]);var Zk=b(1365),Hg=b(935),wj=b(123),ql=b(139);Ff.prototype.setErrorMessageForAddin=function(G,ia){this.RYa||(this.RYa={});this.RYa[G]=ia};Ff.prototype.TNh=function(G){return this.RYa&&G in this.RYa?this.RYa[G]:null};Object(me.a)(Ff,"AddinCommandsErrorManager",null,[]);var Ji=b(345),Wk=b(97);Object(me.a)(Kf,"AddinCommandsListLoaderContext",null,[]);var Ok=
b(1025);Object(me.a)(tf,"AppsForOfficeEntitlementQueryInfo",null,[]);var dl=b(80),kl=b(894);ae.prototype.get_current=function(){if(!this.Nr)throw Error.argumentOutOfRange();return this.Nr.data};ae.prototype.moveNext=function(){if(!this.Nr)return this.Nr=this.uA,!!this.uA;if(!this.Nr.next)return!1;this.Nr=this.Nr.next;return!0};ae.prototype.Flc=function(){if(!this.Nr)return this.Nr=this.uA,!!this.uA;if(!this.Nr.previous)return!1;this.Nr=this.Nr.previous;return!0};ae.prototype.reset=function(){this.Nr=
this.uA};Object(me.a)(ae,"ListEnumerator",null,[0]);Object(me.a)(vd,"ListNode",null,[]);jc.prototype.add=function(G){this.qq?this.HA=this.HA.next=new vd(G,this.HA,null):this.qq=this.HA=new vd(G,null,null);this._count=this.count+1};jc.prototype.insert=function(G,ia){if(G>this.count||0>G)throw Error.argumentOutOfRange("pos");if(G===this.count)this.add(ia);else{for(var eb=this.qq;0!==G--;)eb=eb.next;G=new vd(ia,eb.previous,eb);G.previous?G.previous.next=G:this.qq=G;G.next?G.next.previous=G:this.HA=G;
this._count=this.count+1}};jc.prototype.remove=function(G){for(var ia=this.qq;ia&&ia.data!==G;)ia=ia.next;if(!ia)return!1;ia.previous?ia.previous.next=ia.next:this.qq=ia.next;ia.next?ia.next.previous=ia.previous:this.HA=ia.previous;this._count=this.count-1;return!0};jc.prototype.clear=function(){var G=this.qq;for(this.HA=this.qq=null;G;){var ia=G.next;G.previous=null;G.next=null;G=ia}this._count=0};jc.prototype.indexOf=function(G){for(var ia=this.qq,eb=0;ia&&ia.data!==G;)ia=ia.next,eb++;return ia?
eb:-1};jc.prototype.oa=function(G){return this.at(G).data};jc.prototype.getEnumerator=function(){return new ae(this.qq)};jc.prototype[Symbol.iterator]=function(){return Object(kl.a)(this.getEnumerator())};jc.prototype.ebc=function(G){G=this.at(G);return new ae(G)};jc.prototype.toArray=function(){for(var G=Array(this.count),ia=0,eb=El(this),Fb=eb.next();!Fb.done;Fb=eb.next())G[ia]=Fb.value,ia++;return G};jc.prototype.at=function(G){for(var ia=this.qq,eb=0;eb!==G;){if(!ia)throw Error.argumentOutOfRange("pos");
ia=ia.next;eb++}return ia};Ek.Object.defineProperties(jc.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}}});Object(me.a)(jc,"List",null,[1]);var $k=Sys.EventArgs;Am(pd,$k);Object(me.a)(pd,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);Hc.prototype.q$c=function(G){var ia=new Sys.StringBuilder(this.aJb);ia.append("RoamingServiceHandler.ashx?action=");ia.append("getAddinTeachingCalloutSettings");ia.append("&");ia.append(this.fgd(G));ia.append("&");
ia.append(Tf.AFrameworkApplication.oj);Tf.AFrameworkApplication.Jd.El(ia.toString(),1,null,null,!0,2,Object(Kh.a)(this,this.xKa,"getRequestSuccessCallback"),Object(Kh.a)(this,this.Cja,"getRequestFailureCallback"),null)};Hc.prototype.Dtb=function(G){var ia=new Sys.StringBuilder(this.aJb);ia.append("RoamingServiceHandler.ashx?action=");ia.append("saveAddinTeachingCalloutSettings");ia.append("&");ia.append(Tf.AFrameworkApplication.oj);ia=ia.toString();G=ra.c(G);Tf.AFrameworkApplication.Jd.El(ia,2,G,
null,!0,4,null,Object(Kh.a)(this,this.L6,"postRequestFailureCallback"),null)};Hc.prototype.xKa=function(G){var ia=!1,eb=null;try{if(0<G.data.ke.length){var Fb=Object(Fi.a)(Object,ra.a(G.data.ke)),Oc=Fb?Fb[this.appName]:null;Oc&&(eb=Object(Fi.a)(Object,ra.a(Oc.toString())))}ia=!0}catch(Tc){this.Cja(null)}ia&&this.Pib&&this.Pib(eb)};Hc.prototype.Cja=function(G){this.Lib&&this.Lib(G?G.data:null)};Hc.prototype.L6=function(G){this.Ukb&&this.Ukb(G?G.data:null)};Hc.prototype.fgd=function(G){for(var ia=new Sys.StringBuilder("requestedsettings="),
eb=0;eb<G.count;eb++)ia.append(G.oa(eb)),eb<G.count-1&&ia.append(";");return ia.toString()};Object(me.a)(Hc,"AddinTeachingUIRoamingRequestHandler",null,[]);Object(me.a)(Ub,"MiniAddinInfo",null,[]);var aj=Sys.EventArgs;Am(nd,aj);Object(me.a)(nd,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);ed.prototype.pDg=function(G){this.Pa.addHandler(Hg.a.$Zb,G)};ed.prototype.LGg=function(G){this.Pa.addHandler(Hg.a.JRd,G)};ed.prototype.dNj=function(G){var ia=this;null!==G&&(this.context.k0=G[Hg.a.Sga],
this.context.rt=G[Hg.a.hU],this.context.BAc=this.context.Qqc=0,G=Hg.a.TFa in G?G[Hg.a.TFa]:0,-1!==this.context.k0&&0!==this.context.rt&&(this.context.Q9=new jc,this.context.cja=new jc,this.context.O3b=new jc,this.context.RVc=this.oHg.createAddinDataProvider(Bc(this.context.k0),this.contextActivationMgr),this.context.RVc?this.context.RVc.getEntitlementsAsync(this.contextActivationMgr.lma,!0,G,function(eb){ia.zNi(eb)}):$e.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.k0)))};
ed.prototype.zNi=function(G){var ia=this;if(G&&0<G.length){this.context.BAc=G.length;for(var eb=0;eb<G.length;eb++){var Fb=G[eb];if(!Fb||1!==Fb.targetType&&-1!==Fb.targetType)this.mzd();else{var Oc={};Oc.marketplaceId=Fb.solutionId;Oc.marketplaceVersion=Fb.version;Oc.storeType=Fb.storeType;Oc.storeId=Fb.storeId;Oc.targetData=Fb;this.contextActivationMgr.isAddinCommandsAsync(Oc,function(Tc,Md,Qd){Tc?(Md&&ia.context.Q9.add(Qd.targetData),10===ia.context.k0&&(Tc=Qd.targetData,Md=Tc.targetType,Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PropertiesForTeachingUIOfPrivateCatelogEnabled",
!1)&&!Ij.c(Qd.targetTypeForExp)&&(Md=Qd.targetTypeForExp,Tc.targetType=Md),Tf.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&ia.context.cja.add(Tc),Tf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&0===Md&&ia.context.O3b.add(Tc))):(Qd=Qd.targetData,$e.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Qd.solutionId,
Qd.storeType,Qd.assetId,null,null,Qd.storeId),Qd.storeType));ia.mzd()})}}}else this.mzd()};ed.prototype.mzd=function(){var G;(G=this.context).Qqc=G.Qqc+1;this.context.Qqc>=this.context.BAc&&(this.ZZb.CXf(this.context.k0,!1),0<this.context.BAc&&10===this.context.k0&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(G=!1,Tf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&rd()&&(G=this.Oti()),Tf.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&
this.cti(),Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!G?this.RHh(this.context.Q9):this.XYb(this.context.Q9)):this.XYb(this.context.Q9))};ed.prototype.XYb=function(G){var ia=new gg.a;if(G){G=El(this.context.Q9);for(var eb=G.next();!eb.done;eb=G.next())ia.add(Hd(eb.value))}this.context.Q9&&1>this.context.Q9.count&&Ok.a.NNb(Hg.a.a_b,"false",this.context.k0);G={};ia=(G.ack2=ia,G);ia[Hg.a.Sga]=this.context.k0;ia[Hg.a.hU]=this.context.rt;
this.Pa.raiseEvent(Hg.a.$Zb,new pd(ia),this)};ed.prototype.fcb=function(G){if(this.appName){var ia={},eb={};eb.LastTeachingUIShowTime=(new Date).toUTCString();eb.AddinHasShown=G;ia[this.appName]=ra.c(eb);this.hpa&&(this.hpa.Dtb(ia),$e.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else $e.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};ed.prototype.RHh=function(G){if(this.Rra=
G)G=new gg.a,G.add(this.appName),this.hpa=new Hc(this.appName,Object(Kh.a)(this,this.xKa,"getRequestSuccessCallback"),Object(Kh.a)(this,this.Cja,"getRequestFailureCallback"),Object(Kh.a)(this,this.L6,"postRequestFailureCallback")),this.hpa.q$c(G);else{G=new gg.a;var ia={};G=(ia.ack2=G,ia);G[Hg.a.Sga]=this.context.k0;G[Hg.a.hU]=this.context.rt;this.Pa.raiseEvent(Hg.a.$Zb,new pd(G),this)}};ed.prototype.xKa=function(G){G?this.qxj(G)?($e.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.Bda=
"AddinHasShown"in G&&G.AddinHasShown?G.AddinHasShown.toString():null,this.RAe()):($e.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.XYb(this.Rra)):($e.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.Bda=null,this.RAe())};ed.prototype.Cja=function(G){$e.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",G?G.httpStatus:-1);this.XYb(this.Rra)};ed.prototype.L6=function(G){$e.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
G?G.httpStatus:-1)};ed.prototype.RAe=function(){if(Tf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")){var G=this.Rdh();if(0===G.targetType){ed.ySa?G.solutionId?(this.jTd=G.solutionId,this.azc=G.storeId,this.xJf()):this.Vtd("NoSolutionId"):G.assetId?(this.mXc=G.assetId,this.azc=G.storeId,this.xJf()):this.Vtd("NoAssetId");if(G.addinId){var ia=this.Bda?this.Bda+","+G.addinId:G.addinId;Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)?window.g_roamingAddinList=ia:this.fcb(ia)}this.BUc(null)}else this.BUc(G.addinId);$e.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",G.addinId)}else G=this.Qdh(),this.BUc(G),$e.ULS.sendTraceTag(538248464,306,50,"Show teaching callout for taskpane addin: {0}",G)};ed.prototype.xJf=function(){var G=this,ia=new tf;ia.callbackFunc=function(eb){if(eb.errorCode)G.Vtd("FailToGetAppDetails");else if(eb.value){var Fb=El(eb.value);for(eb=Fb.next();!eb.done;eb=Fb.next())if(eb=eb.value,
ed.ySa){var Oc=eb[1];if(Oc===G.jTd){Fb={solutionId:Oc};Fb.assetId=eb[5];Fb.storeType=eb[6];Tf.AFrameworkApplication.ga.isChangeGateEnabled("StoreIdFixEnabled")?Fb.storeId=G.azc:Fb.storeId=eb[11];Fb.assetStoreId=eb[6];Fb.targetType=eb[3];Fb.width=eb[7];Fb.height=eb[8];Fb.displayName=eb[0];Fb.version=eb[4];eb=new nd(Fb);G.Pa.raiseEvent(Hg.a.JRd,eb);break}}else if(Oc=eb[1],Oc===G.mXc){Fb={solutionId:Oc,assetId:Oc};Fb.storeType=eb[6];Tf.AFrameworkApplication.ga.isChangeGateEnabled("StoreIdFixEnabled")?
Fb.storeId=G.azc:Fb.storeId=eb[11];Fb.assetStoreId=eb[6];Fb.targetType=eb[3];Fb.width=eb[7];Fb.height=eb[8];Fb.displayName=eb[0];Fb.version=eb[4];eb=new nd(Fb);G.Pa.raiseEvent(Hg.a.JRd,eb);break}}};ia.storeType=OSF.StoreTypeEnum.PrivateCatalog;ia.fromInsertDialog=!1;ia.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(ia)};ed.prototype.qxj=function(G){if("LastTeachingUIShowTime"in G){if(G=+new Date-+new Date(G.LastTeachingUIShowTime.toString()),G<Tf.AFrameworkApplication.ga.YQ("AddinShowTeachingUIIntervalInMS",
864E5))return $e.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",G),!1}else $e.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0};ed.prototype.Qdh=function(){for(var G=new Ji.a("",0),ia=new Ji.a("",0),eb=0,Fb=0,Oc=0,Tc=El(this.Rra),Md=Tc.next();!Md.done;Md=Tc.next())if(Md=Md.value,!("excatalog"!==Md.storeType||Ij.c(Md.installTimeInMS)||!Md.installTimeInMS||Md.installTimeInMS<=Tf.AFrameworkApplication.ga.YQ("DateTimeInMSForNewAddin",
16409664E5))){var Qd=ed.Scd(Md);if(this.Bda){var Je=this.Bda.split(",");if(0<Je.length&&Array.contains(Je,Qd)){Oc++;$e.ULS.sendTraceTag(538817694,306,50,"This addin has shown teaching UI before");continue}}Qd.startsWith("private_")?(G.value<Md.installTimeInMS&&(G=new Ji.a(Qd,Md.installTimeInMS)),Fb++):(ia.value<Md.installTimeInMS&&(ia=new Ji.a(Qd,Md.installTimeInMS)),eb++)}$e.ULS.sendTraceTag(538817695,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
Fb,eb,Oc);return 0<ia.value?ia.key:0<G.value?G.key:null};ed.prototype.Rdh=function(){var G=new Ji.a(new Ub,0),ia=new Ji.a(new Ub,0),eb=0,Fb=0,Oc=0,Tc=new jc;if(0<this.context.Q9.count)for(var Md=El(this.context.Q9),Qd=Md.next();!Qd.done;Qd=Md.next())Tc.add(Qd.value);if(0<this.context.O3b.count)for(Md=El(this.context.O3b),Qd=Md.next();!Qd.done;Qd=Md.next())Tc.add(Qd.value);Tc=El(Tc);for(Qd=Tc.next();!Qd.done;Qd=Tc.next())if(Qd=Qd.value,!("excatalog"!==Qd.storeType||Ij.c(Qd.installTimeInMS)||!Qd.installTimeInMS||
Qd.installTimeInMS<=Tf.AFrameworkApplication.ga.YQ("DateTimeInMSForNewAddin",16409664E5))){Md=ed.Scd(Qd);if(this.Bda){var Je=this.Bda.split(",");if(0<Je.length&&Array.contains(Je,Md)){Oc++;$e.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}}Md.startsWith("private_")?(G.value<Qd.installTimeInMS&&(G=ed.ySa?new Ji.a(Object.assign(new Ub,{addinId:Md,targetType:Qd.targetType,storeId:Qd.storeId,solutionId:Qd.solutionId}),Qd.installTimeInMS):new Ji.a(Object.assign(new Ub,
{addinId:Md,targetType:Qd.targetType,storeId:Qd.storeId,assetId:Qd.assetId}),Qd.installTimeInMS)),Fb++):(ia.value<Qd.installTimeInMS&&(ia=ed.ySa?new Ji.a(Object.assign(new Ub,{addinId:Md,targetType:Qd.targetType,storeId:Qd.storeId,solutionId:Qd.solutionId}),Qd.installTimeInMS):new Ji.a(Object.assign(new Ub,{addinId:Md,targetType:Qd.targetType,storeId:Qd.storeId,assetId:Qd.assetId}),Qd.installTimeInMS)),eb++)}$e.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
Fb,eb,Oc);return 0<ia.value?ia.key:0<G.value?G.key:Object.assign(new Ub,{addinId:null,targetType:-1,solutionId:null,storeId:null,assetId:null})};ed.prototype.BUc=function(G){for(var ia=new gg.a,eb=El(this.Rra),Fb=eb.next();!Fb.done;Fb=eb.next()){var Oc=Fb.value;Fb=Hd(Oc);G&&(Oc=ed.Scd(Oc),G===Oc&&(Fb.showCallout=!0,Oc=this.Bda?this.Bda+","+G:G,Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=G:this.fcb(Oc)));ia.add(Fb)}this.Rra&&
1>this.Rra.count&&Ok.a.NNb(Hg.a.a_b,"false",this.context.k0);G={};ia=(G.ack2=ia,G);ia[Hg.a.Sga]=this.context.k0;ia[Hg.a.hU]=this.context.rt;this.Pa.raiseEvent(Hg.a.$Zb,new pd(ia),this)};ed.prototype.Oti=function(){var G=!1;if(this.context.cja&&1>this.context.cja.count)return G;var ia=xb();if(!ia)return G;for(var eb=El(this.context.cja),Fb=eb.next();!Fb.done;Fb=eb.next())if(Fb=Fb.value,Fb.storeId&&Fb.storeId.toLowerCase()===ia.toLowerCase()||Fb.assetId&&Fb.assetId.toLowerCase()===ia.toLowerCase()){G=
ed.k4a(Fb);var Oc={};Fb=(Oc.SDX_Id=G,Oc.SDX_TargetType=Ij.c(Fb.targetType)?"":Fb.targetType.toString(),Oc);Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:wj.a.Il(Fb)}));G=!0}return G};ed.prototype.cti=function(){if(!(this.context.cja&&1>this.context.cja.count))if(this.ZZb.aji()){var G=this.ZZb.xUh();G?(G=this.XXe(this.context.cja,G),$e.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(G=this.XXe(this.context.cja,
null),$e.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.ZZb.mrj(G)}else $e.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")};ed.prototype.XXe=function(G,ia){var eb={},Fb=!1;G=El(G);for(var Oc=G.next();!Oc.done;Oc=G.next()){Oc=Oc.value;var Tc=ed.k4a(Oc);Tc&&(!ia||Tc in ia||(this.Exa(Oc,Tc),$e.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===Tc.toLowerCase()?Fb||(Fb=!0,eb[Tc]=null):eb[Tc]=null)}return eb};ed.prototype.Exa=function(G,
ia){var eb=G.installTimeInMS?(new Date(G.installTimeInMS)).toISOString():"",Fb={};eb=(Fb["SDX.Id"]=ia,Fb["SDX.AppInstallOrigin"]="Organization",Fb["SDX.TargetType"]=Ij.c(G.targetType)?"":G.targetType.toString(),Fb["SDX.AdminDeploymentTime"]=eb,Fb);Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wj.a.Il(eb)}));1===G.targetType&&(G={},ia=(G["SDX.Id"]=ia,G["SDX.AppInstallOrigin"]="Organization",G["SDX.CommandPlacement"]="Ribbon",G),Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,
{name:"Office.Extensibility.Host.AppPinning",dataFields:wj.a.Il(ia)})))};ed.prototype.Vtd=function(G){var ia={};G=(ia.AppTeachingUICalloutAction=G,ia["SDX.Id"]=ed.ySa?this.jTd:this.mXc,ia.AppTeachingUICalloutGoal="NewAdminDeployment",ia["SDX.AppInstallOrigin"]="Organization",ia);Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)}))};ed.k4a=function(G){return ed.ySa?Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,G.storeType,
G.assetId,null,null,G.storeId):Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.assetId)};ed.Scd=function(G){if(ed.ySa){var ia=G.solutionId;var eb=Telemetry.PrivacyRules.IsPrivateAddin(G.storeType,G.assetId,null,null,G.storeId)}else ia=G.assetId,eb=Telemetry.PrivacyRules.IsPrivateAddin(G.storeType,G.storeId,G.assetId);return eb?"private_"+G.installTimeInMS:ia};Ek.Object.defineProperties(ed,{ySa:{configurable:!0,enumerable:!0,get:function(){return Tf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:6189484_TeachingCalloutSolutionIdRefactorEnabled")}}});
Object(me.a)(ed,"AddInCommandsListLoader",null,[]);ne.prototype.insertOsfControl=function(G){return this.lma.insertOsfControl(G)};ne.prototype.getManifestInvaildErrorString=function(){return this.lma.getManifestInvaildErrorString()};ne.prototype.isAddinCommandsAsync=function(G,ia){this.lma.isAddinCommandsAsync(G,ia)};ne.prototype.ownerAddinControlRecreated=function(G,ia){this.lma.ownerAddinControlRecreated(G,ia)};ne.prototype.queryEntitlementDetails=function(G){this.lma.queryEntitlementDetails(G)};
Ek.Object.defineProperties(ne.prototype,{lma:{configurable:!0,enumerable:!0,get:function(){return this.Zsg}}});Object(me.a)(ne,"ContextActivationMgrWrapper",null,[335]);Xc.prototype.createAddinDataProvider=function(G,ia){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(G,ia.lma)};Ek.Object.defineProperties(Xc,{instance:{configurable:!0,enumerable:!0,get:function(){Xc.Ma||(Xc.Ma=new Xc);return Xc.Ma}}});Xc.Ma=null;Object(me.a)(Xc,"OSFAddinDataProviderFactory",null,[332]);Object(me.a)(bd,
"CacheItem",null,[]);md.prototype.sl=function(G){if(Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFRemoveUnusedCode",!1))$e.ULS.sendTraceTag(523375833,220,10,"GetCacheItem is deprecated");else{$e.ULS.sendTraceTag(526989510,220,15,"GetCacheItem");var ia=this.ZDa.getItem(G);if(ia){var eb=new bd;try{eb=Sys.Serialization.JavaScriptSerializer.deserialize(ia,!0)}catch(Fb){return this.ZDa.removeItem(G),null}return eb.Data?eb.Data:eb.data}}return null};md.prototype.nQa=
function(G){Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFRemoveUnusedCode",!1)?$e.ULS.sendTraceTag(523375835,220,10,"RemoveCacheItem is deprecated"):($e.ULS.sendTraceTag(526989512,220,15,"RemoveCacheItem"),this.ZDa.removeItem(G))};Object(me.a)(md,"AppsDataCacheManager",null,[373]);var Sk=b(1026);qc.prototype.CXf=function(G,ia){G=Hg.a.$Ye()+G;Sk.a.instance.setItem(G,ia.toString())};qc.prototype.xUh=function(){var G=Hg.a.$0e();$e.ULS.sendTraceTag(527523850,306,
50,"set cache key:{0}",G);G=Sk.a.instance.getItem(G);return ra.a(G)};qc.prototype.mrj=function(G){var ia=Hg.a.$0e();$e.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",ia);Sk.a.instance.setItem(ia,ra.c(G))};qc.prototype.aji=function(){return!!Sk.a.instance.localStorage};Ek.Object.defineProperties(qc,{instance:{configurable:!0,enumerable:!0,get:function(){qc.Ma||(qc.Ma=new qc);return qc.Ma}}});qc.Ma=null;Object(me.a)(qc,"AddInCommandsCacheManager",null,[337]);var Ak=Sys.EventArgs;Am(Wd,Ak);Object(me.a)(Wd,
"InsertionParamEventArgs",Sys.EventArgs,[]);Object(me.a)(we,"PostLaunchAddinCommandsParameters",null,[]);Ad.prototype.GAg=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Kh.a)(this,this.mNi,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Kh.a)(this,this.CIi,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Kh.a)(this,this.gHi,"onCloseButtonClickedEventHandler"),!0),Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&window.addEventListener("FGWebSurfaceEvent",Object(Kh.a)(this,this.guf,"onCampaignLaunchedHandler"),!0)):$e.ULS.sendTraceTag(525112601,306,15,"AddEventListenerForTeachingCallout failed to get Window")};Ad.prototype.mNi=function(){var G=this,ia={};ia=(ia.AppTeachingUICalloutAction="ClickOnLaunch",ia["SDX.Id"]=Ad.k4a(this.qTb),ia.AppTeachingUICalloutGoal="NewAdminDeployment",ia["SDX.AppInstallOrigin"]="Organization",ia);Tf.AFrameworkApplication.ga.isChangeGateEnabled("TeachingUIExtraLogForLaunch")&&
this.Dgb&&this.Dgb.tabs&&!this.Dgb.tabs[0].isOfficeTab&&(ia["SDX.FeatureFlags"]="NonOfficeTab");Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(ia)}));this.Dgb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Dgb,function(){var eb=new Wd;eb.Mm=G.qTb;G.Za.raiseEvent(Hg.a.Djf,eb)}):$e.ULS.sendTraceTag(525112602,306,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};Ad.prototype.gHi=function(){var G=
{};G=(G.AppTeachingUICalloutAction="ClickOnClose",G["SDX.Id"]=Ad.k4a(this.qTb),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)}))};Ad.prototype.CIi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnDismiss",G["SDX.Id"]=Ad.k4a(this.qTb),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",
G);Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)}))};Ad.prototype.guf=function(G){if(G&&(G=G.detail)&&G.id&&this.Oei(G.id)){var ia=(G.action||"").toLowerCase();if(G.success&&"opened"===ia){$e.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");var eb=window.g_roamingAddinList;eb&&this.fcb(eb);window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Kh.a)(this,
this.guf,"onCampaignLaunchedHandler"),!0)}else try{eb=JSON.stringify(G),$e.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+eb)}catch(Fb){eb="id : "+G.id+" telemetryEventName: "+G.telemetryEventName,$e.ULS.sendTraceTag(523321996,306,50,"Error serializing campaign event. "+eb+" Error: "+(Fb?Fb.toString():""))}}};Ad.prototype.Oei=function(G){return-1!==G.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==G.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==G.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")};
Ad.prototype.fcb=function(G){var ia=Tf.AFrameworkApplication.ga.Ua("WebAppShortName");if(ia){var eb={},Fb={};Fb.LastTeachingUIShowTime=(new Date).toUTCString();Fb.AddinHasShown=G;eb[ia]=ra.c(Fb);this.hpa=new Hc(ia,null,null,Object(Kh.a)(this,this.L6,"postRequestFailureCallback")),this.hpa.Dtb(eb),$e.ULS.sendTraceTag(523535564,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else $e.ULS.sendTraceTag(523535565,306,10,"Fail to save roaming service since AppName is null")};
Ad.prototype.L6=function(G){$e.ULS.sendTraceTag(523535566,306,10,"failed to POST data to Roaming Settings Service with status: {0}",G?G.httpStatus:-1)};Ad.k4a=function(G){return Tf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:6189484_TeachingCalloutSolutionIdRefactorEnabled")?Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,G.storeType,G.assetId,null,null,G.storeId):Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.assetId)};Object(me.a)(Ad,"PrivateCatalogTeachingCalloutHandler",
null,[]);Ob.prototype.AYa=function(G,ia){this.p8d.AYa(G,void 0===ia?null:ia);this.u$d=G};Ob.prototype.TId=function(G){this.p8d.TId(G)};Ek.Object.defineProperties(Ob.prototype,{iNa:{configurable:!0,enumerable:!0,get:function(){return this.u$d}}});Object(me.a)(Ob,"RibbonExtensibilityManagerWithChangeDetection",null,[368]);var tk=b(1072);Zc.JZe=function(G){var ia=new gg.a;if(Zc.FAe)for(var eb=El(Zc.FAe),Fb=eb.next();!Fb.done;Fb=eb.next())ia.add(Fb.value);Fb=null;switch(G){case "Workbook":Fb=Zc.QWj;break;
case "Document":Fb=Zc.Qgh;break;case "Presentation":Fb=Zc.D_i}if(Fb)for(G=El(Fb),Fb=G.next();!Fb.done;Fb=G.next())ia.add(Fb.value);return ia};Zc.FAe=["PrimaryCommandSurface","ContextMenu"];Zc.QWj=null;Zc.Qgh=null;Zc.D_i=null;Object(me.a)(Zc,"ExtensionPointType",null,[]);Ek.Object.defineProperties(Ud.prototype,{GDb:{configurable:!0,enumerable:!0,get:function(){return this.qce||(this.qce=new gg.a)}},Uoe:{configurable:!0,enumerable:!0,get:function(){return this.ckg}}});Object(me.a)(Ud,"ContextMenuExtensibility",
null,[342]);Ek.Object.defineProperties(hd.prototype,{yW:{configurable:!0,enumerable:!0,get:function(){return this.Ssg}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.pwg}},fHh:{configurable:!0,enumerable:!0,get:function(){return this.Kog}}});Object(me.a)(hd,"RibbonExtensibility",null,[399]);pc.prototype.createActionContext=function(G,ia){G={};G.ownerAddinInfo=this.entitlement;G.action=ia;return G};Ek.Object.defineProperties(pc.prototype,{entitlement:{configurable:!0,enumerable:!0,
get:function(){return this.Hng}}});Object(me.a)(pc,"AddInCommandsContextProvider",null,[]);Vb.prototype.h5g=function(G){return new pc(G)};Vb.prototype.createActionBuilder=function(G,ia){return OfficeExt.DefaultControlActionBinder.createActionBuilder(G,ia.entitlement,ia.manifest)};Vb.prototype.startApplyAddin=function(G){this.x1d=G;var ia=this.h5g(G);this.actionBuilder=this.createActionBuilder(ia,G)};Vb.prototype.endApplyAddin=function(){};Vb.prototype.Ccd=function(G,ia,eb){eb=void 0===eb?0:eb;return this.ribbonBuilder.Ts&&
0<this.ribbonBuilder.Ts.count?new hd(this.uGh(G,ia),this.roe.startedNode,eb):null};Vb.prototype.BVe=function(){var G=void 0===G?null:G;if(this.contextMenuBuilder.mlc&&0<this.contextMenuBuilder.mlc.count){G||(G=this.roe.entitlement.solutionId);G=new Ud(G);for(var ia=El(this.contextMenuBuilder.mlc),eb=ia.next();!eb.done;eb=ia.next())G.GDb.add(eb.value);return G}return null};Vb.prototype.uGh=function(G,ia){return this.ribbonBuilder.Ts&&0<this.ribbonBuilder.Ts.count?new Nk.a(this.ribbonBuilder.Ts,G,ia):
null};Ek.Object.defineProperties(Vb.prototype,{roe:{configurable:!0,enumerable:!0,get:function(){return this.x1d}}});Object(me.a)(Vb,"AddinCommandsBuilder",null,[]);Na.prototype.wBb=function(G,ia,eb,Fb,Oc,Tc,Md){function Qd(Ug,kh,Yi,Ah){Oc(Ug,kh,Yi,Ah);Ug=tk.a[Je.rt]+kh.assetId;Yi=Je.LSa.Nc(Ug);kh=Yi.value;Yi.returnValue&&(kh.stop(),Je.LSa.remove(Ug))}var Je=this;if(0!==this.rt&&G)for($e.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",G.count),4===this.rt&&($e.ULS.sendTraceTag(17586256,220,100,
String.format("Refresh AddinCommands for dataprovider : {0}",Fb)),this.wXg(G,Fb),Tc()),G=El(G),Fb=G.next();!Fb.done;Fb=G.next())if(Fb=Fb.value,$e.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Ro.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Fb.solutionId,Fb.ownerAddinStoreType||Fb.storeType,Fb.assetId,null,null,Fb.storeId))),this.Yeg(Fb))if(Md&&Fb.requireConsent)Md(Fb,function(Ug){try{if(Je.OO){var kh=tk.a[Je.rt]+Ug.solutionId,Yi=Je.OO.Gc("ComponentAttach",kh);Je.LSa.ia(kh,
Yi)}var Ah=Je.$F.Pia(Ug.storeType,Ug.solutionId);6!==Je.rt&&(Ah&&(Je.y2b(Ah),Ah.GB.purge(!1)),Je.Fi.insertOsfControl(Je.uGb(Ug,ia,eb,Qd)),Ah&&Je.Fi.ownerAddinControlRecreated(Ug.solutionId,Ug.storeType))}catch(yi){$e.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",Je.Ro.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Ug.solutionId,Ug.ownerAddinStoreType||Ug.storeType,Ug.assetId,null,null,
Ug.storeId),Ug.version,Ug.storeType,Ug.storeId,yi.message)),Qd(!1,Ug,null,null)}});else try{if(this.OO){var kf=tk.a[this.rt]+Fb.solutionId,xf=this.OO.Gc("ComponentAttach",kf);this.LSa.ia(kf,xf)}var og=this.$F.Pia(Fb.storeType,Fb.solutionId);6!==this.rt&&(og&&(this.y2b(og),og.GB.purge(!1)),this.Fi.insertOsfControl(this.uGb(Fb,ia,eb,Qd)),og&&this.Fi.ownerAddinControlRecreated(Fb.solutionId,Fb.storeType))}catch(Ug){$e.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.Ro.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Fb.solutionId,Fb.ownerAddinStoreType||Fb.storeType,Fb.assetId,null,null,Fb.storeId),Fb.version,Fb.storeType,Fb.storeId,Ug.message)),Qd(!1,Fb,null,null)}else Qd(!1,Fb,null,null)};Na.prototype.vqi=function(G,ia,eb,Fb,Oc,Tc){function Md(og,Ug,kh,Yi){Tc(og,Ug,kh,Yi);og=tk.a[Qd.rt]+Ug.solutionId;kh=Qd.LSa.Nc(og);Ug=kh.value;kh.returnValue&&(Ug.stop(),Qd.LSa.remove(og))}var Qd=this;if(6===this.rt&&G)if($e.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",
this.Ro.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,G.ownerAddinStoreType||G.storeType,G.assetId,null,null,G.storeId))),this.Yeg(G))try{if(this.OO){var Je=tk.a[this.rt]+G.solutionId,kf=this.OO.Gc("ComponentAttach",Je);this.LSa.ia(Je,kf)}var xf=this.$F.Pia(G.storeType,G.solutionId);xf||Md(!1,G,null,null);Tf.AFrameworkApplication.ta&&Tf.AFrameworkApplication.ta.Qa.delayInstallAddInIsEnabled?this.$Ve(G,ia,Fb,Oc,eb,function(og){Md(og,G,eb,xf.displayName)}):(this.$Ve(G,ia,Fb,Oc,eb),Md(!0,
G,eb,xf.displayName))}catch(og){$e.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.Ro.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,G.ownerAddinStoreType||G.storeType,G.assetId,null,null,G.storeId),G.version,G.storeType,G.storeId,og.message)),Md(!1,G,null,null)}else Md(!1,G,null,null)};Na.prototype.oFi=function(G,ia,eb,Fb,Oc,Tc){if(Tc)if(Tc._isAddinCommandsManifest(this.Ro.dN))try{Tf.AFrameworkApplication.ta&&
Tf.AFrameworkApplication.ta.Qa.delayInstallAddInIsEnabled?this.ZVe(G,ia,eb,Oc,Tc,function(Md){Fb(Md,G,Tc,Tc.getDefaultDisplayName())}):(this.ZVe(G,ia,eb,Oc,Tc),Fb(!0,G,Tc,Tc.getDefaultDisplayName()))}catch(Md){$e.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Ro.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,G.ownerAddinStoreType||G.storeType,G.assetId,
null,null,G.storeId),G.version,G.storeType,G.storeId,Md.message)),Fb(!1,G,Tc,Tc.getDefaultDisplayName())}else $e.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.Ro.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,G.ownerAddinStoreType||G.storeType,G.assetId,null,null,G.storeId),G.version,G.storeType,G.storeId)),Fb(!1,G,null,null);else $e.ULS.sendTraceTag(17586259,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Ro.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,G.ownerAddinStoreType||G.storeType,G.assetId,null,null,G.storeId),G.version,G.storeType,G.storeId)),Fb(!1,G,null,null)};Na.prototype.uGb=function(G,ia,eb,Fb){var Oc=this,Tc={},Md=document.createElement("div");Md.setAttribute("visible","false");Tc.div=Md;Tc.id=G.solutionId;Tc.solutionId=G.solutionId;Tc.version=G.version;
Tc.storeType=G.storeType;Tc.storeId=G.storeId;Tc.assetId=G.assetId;Tc.assetStoreId=G.assetStoreId;Tc.isvirtualOsfControl=!0;Tc.virtualOsfControlActivationCallback=function(Qd,Je){var kf=Oc.$F.Pia(G.storeType,G.solutionId);kf&&(kf.isUpgraded&&(G.isUpgraded=!0),Oc.y2b(kf));Oc.oFi(G,ia,eb,Fb,Qd,Je)};Tc.reason=3===this.rt?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Tc};Na.prototype.ZVe=function(G,ia,eb,Fb,Oc,Tc){Tc=
void 0===Tc?null:Tc;var Md={};Md.solutionId=Fb.getSolutionId();Md.version=Fb.getVersion();Md.storeType=Fb.getStoreType();Md.storeId=Fb.getStoreId();Md.assetId=Fb.getSolutionId();Md.assetStoreId=Fb.getAssetStoreId();Md.targetType=Fb.getOsfControlType();var Qd=null,Je=null;if(Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Qd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Ro.dN,this.Ro.formFactor)).parseExtensions(Md,
Oc,this.Rga),Je=Zc.JZe(this.Ro.dN);else try{Qd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Ro.dN,this.Ro.formFactor)).parseExtensions(Md,Oc,this.Rga),Je=Zc.JZe(this.Ro.dN)}catch(ej){throw $e.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+ej.message),ej;}if(Je&&0<Je.count){if(Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var kf=ia(G);var xf=eb(G);eb=!!Tf.AFrameworkApplication.ga&&
Tf.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");kf=new Vb(kf,null,xf);Je=El(Je);for(xf=Je.next();!xf.done;xf=Je.next())kf.commandSurface=xf.value,Qd.apply(kf,this.Rga,eb)}else try{var og=ia(G),Ug=eb(G),kh=!!Tf.AFrameworkApplication.ga&&Tf.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");kf=new Vb(og,null,Ug);var Yi=El(Je);for(xf=Yi.next();!xf.done;xf=Yi.next())kf.commandSurface=xf.value,Qd.apply(kf,this.Rga,kh)}catch(ej){throw $e.ULS.sendTraceTag(538752132,
220,10,"Exception encounter while building ribbon. Exception: "+ej.message),ej;}if(OSF.OUtil.checkFlight(14))try{var Ah=kf.Ccd(G.solutionId,Oc.getDefaultDisplayName()),yi=kf.BVe();Ah&&this.ribbonManager.AYa(Ah,Tc);yi&&this.contextMenuManager.gle(yi);this.$F.Jle(Fb,Ah,yi,Oc.getDefaultDisplayName());$e.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Oc.getDefaultDisplayName())}catch(ej){throw OfficeExt.DevConsole.log(ej),$e.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+
ej.message),ej;}else try{var Ki=kf.Ccd(G.solutionId,Oc.getDefaultDisplayName()),Rj=kf.BVe();Ki&&this.ribbonManager.AYa(Ki);Rj&&this.contextMenuManager.gle(Rj);this.$F.Jle(Fb,Ki,Rj,Oc.getDefaultDisplayName());$e.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Oc.getDefaultDisplayName())}catch(ej){throw $e.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+ej.message),ej;}}};Na.prototype.$Ve=function(G,ia,eb,Fb,Oc,Tc){Tc=void 0===Tc?null:Tc;var Md={};Md.solutionId=
G.solutionId;Md.version=G.version;Md.storeType=G.storeType;Md.storeId=G.assetStoreId;Md.assetId=G.assetId;Md.assetStoreId=G.assetStoreId;Md.targetType=G.targetType;var Qd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Ro.dN,this.Ro.formFactor);try{var Je=ia.getManifest(),kf=Qd.parse(Md,Je,Oc,this.Rga,ia.getSharedRuntimeId()),xf=eb(G),og=Fb(G),Ug=new Vb(xf,null,og);Ug.commandSurface="PrimaryCommandSurface";kf.apply(Ug,this.Rga,!0);if(Ug.ribbonBuilder.Ts&&0<Ug.ribbonBuilder.Ts.count){var kh=
Ug.Ccd(G.solutionId,ia.getManifest().getDefaultDisplayName(),1);Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.AYa(kh,Tc):kh&&this.ribbonManager.AYa(kh,Tc);this.$F.xBg(ia,kh,Oc,ia.getManifest().getDefaultDisplayName());$e.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",ia.getManifest().getDefaultDisplayName())}}catch(Yi){$e.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",
ia.getManifest().getDefaultDisplayName(),Yi.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Yi)}};Na.prototype.y2b=function(G){G.Ko&&this.ribbonManager.TId(G.Ko);G.Uqb&&this.contextMenuManager.w9i(G.Uqb);this.$F.d9i(G.GB.getStoreType(),G.GB.getSolutionId())};Na.prototype.wXg=function(G,ia){ia=Bc(ia);for(var eb=El(this.$F.K5a),Fb=eb.next();!Fb.done;Fb=eb.next())if(Fb=Fb.value,Fb.GB.getStoreType()===ia){for(var Oc=!0,Tc=El(G),Md=Tc.next();!Md.done;Md=Tc.next())if((Md=Md.value)&&Fb.bgf(Md.storeType,
Md.solutionId)){Oc=!1;break}Oc&&(this.y2b(Fb),Fb.GB.purge(!1))}};Na.prototype.Yeg=function(G){return!!G&&!!G.solutionId&&!!G.version&&!!G.storeType&&!!G.storeId};Object(me.a)(Na,"AddInCommandsIntegration",null,[]);wa.prototype.qDg=function(G){this.Za.addHandler(Hg.a.qoe,G)};wa.prototype.iFg=function(G){this.Za.addHandler(Hg.a.Djf,G)};wa.prototype.KGg=function(G){this.Za.addHandler(Hg.a.C2f,G)};wa.prototype.yDg=function(G){this.Za.addHandler(Hg.a.OXc,G)};wa.prototype.Nqi=function(G,ia,eb){var Fb=this,
Oc=eb[Hg.a.Jnb],Tc=void 0===eb[Hg.a.hU]?0:eb[Hg.a.hU];if(Oc&&0!==Tc)if(0>=Oc.count&&4!==Tc)this.cHf(new we(Tc,null,null,ia,null,!0));else{var Md=Oc.count,Qd=new Ob(new Lf),Je=void 0===eb[Hg.a.Sga]?-1:eb[Hg.a.Sga],kf=new Na(Tc,this.Hn,this.PEc,Qd,this.ymg,this.oXa,this.xQb),xf=function(Ah){return Fb.vie.GQg(Ah.solutionId,Fb.xQb,Fb.PEc,G)},og=function(Ah){return Fb.vie.RPg(Ah.solutionId)},Ug=function(Ah,yi,Ki){Md--;Ki=new we(Tc,yi,Qd,ia,Ki,0>=Md);Ah&&yi?Fb.cHf(Ki):(Fb.tTb&&(3===Tc||yi&&yi.isUpgraded)&&
(Ah="",yi&&(Ah=Telemetry.PrivacyRules.GetPrivacyCompliantId(yi.solutionId,yi.ownerAddinStoreType||yi.storeType,yi.assetId,null,null,yi.storeId)),yi={},yi=(yi.SDX_AppInstallOrigin="User",yi.SDX_IsAutoLaunchEnabled=Fb.fjb,yi.SDX_AppInstallErrorCode="onAddinCompletedBase.fail",yi.SDX_Id=Ah,yi),Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wj.a.Il(yi)}))),Fb.bHf(Ki));Md||Tf.AFrameworkApplication.ta.updateCommandUI()},kh=function(Ah,yi,Ki,Rj){Ug(Ah,
yi,Rj)},Yi=function(){Fb.Byd();0>=Oc.count&&4===Tc&&Fb.oXa.COd()};6===Tc?(Je=eb[Hg.a.HIa],eb=eb[Hg.a.IIa],kf.vqi(Oc.oa(0),Je,eb,xf,og,function(Ah,yi,Ki,Rj){Ug(Ah,yi,Rj)})):kf.wBb(Oc,xf,og,Je,kh,Yi,this.Ksg)}else this.tTb&&(kf={},kf=(kf.SDX_AppInstallOrigin="User",kf.SDX_IsAutoLaunchEnabled=this.fjb,kf.SDX_AppInstallErrorCode="LaunchOneLineRibbonAddinCommands.fail",kf.SDX_Id="",kf),Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wj.a.Il(kf)}))),
$e.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.PEc.dN)),this.bHf(new we(Tc,null,null,ia,null,!0))};wa.prototype.bHf=function(G){this.Byd(G);this.t3f(!1,G)};wa.prototype.cHf=function(G){var ia=G.Mm,eb=null;null!==ia&&(eb=ia.storeType,eb=eb.toLowerCase());if(this.tTb&&G&&"omex"===eb&&(3===G.rt||ia.isUpgraded)){var Fb={};Fb=(Fb.SDX_AppInstallOrigin="User",Fb.SDX_IsAutoLaunchEnabled=this.fjb,Fb.SDX_AppInstallErrorCode="0",Fb.SDX_Id=
Telemetry.PrivacyRules.GetPrivacyCompliantId(ia.solutionId,ia.ownerAddinStoreType||ia.storeType,ia.assetId,null,null,ia.storeId),Fb);Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wj.a.Il(Fb)}))}this.Byd(G);this.fjb&&"omex"===eb&&G.i7&&(3===G.rt||ia.isUpgraded)&&(Fb=new Wd,Fb.Mm=ia,Fb.Ko=G.i7.iNa,this.Za.raiseEvent(Hg.a.OXc,Fb));if(this.yqg){Fb=rd();var Oc=xb();Fb&&ia&&"excatalog"===ia.storeType&&G.i7&&5===G.rt&&Oc&&(ia.storeId&&ia.storeId.toLowerCase()===
Oc.toLowerCase()||ia.assetId&&ia.assetId.toLowerCase()===Oc.toLowerCase())&&(Fb=new Wd,Fb.Mm=ia,Fb.Ko=G.i7.iNa,this.Za.raiseEvent(Hg.a.OXc,Fb),$e.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}ia&&(qc.instance.CXf($d(eb),!0),"uploadfiledevcatalog"===eb&&(Fb=this.Sjg.createAddinDataProvider(eb,this.Hn))&&Fb.localCacheAddinCommands(this.Hn.lma,ia.solutionId,ia.version,ia.storeId),Ok.a.NNb(Hg.a.a_b,"true",$d(eb)));this.t3f(!0,G)};wa.prototype.t3f=function(G,ia){G?Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&ia.i7&&5===ia.rt&&ia.i7.iNa&&void 0!==ia.Mm.showCallout&&null!==ia.Mm.showCallout&&ia.Mm.showCallout?((new Ad(this.Za,ia.Mm,Nk.a.Eub(ia.i7.iNa))).GAg(),G=new Wd,G.Ko=ia.i7.iNa,G.Mm=ia.Mm,this.Za.raiseEvent(Hg.a.C2f,G)):3!==ia.rt?ia.Jif&&this.oXa.COd():ia.i7&&ia.i7.iNa&&"hardcodedpreinstall"!==ia.Mm.storeType&&(G=!1,this.fjb&&(G=ia.Mm.isAutoLaunched),jk.a.uyj(ia.displayName,ia.i7.iNa,G)):3===ia.rt?ia.Mm&&"uploadfiledevcatalog"===ia.Mm.storeType.toLowerCase()?(ia=this.xQb.TNh(ia.Mm.solutionId),
jk.a.DRd(ia?ia:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.oXa.IYf():ia.Jif&&this.oXa.COd()};wa.prototype.Byd=function(G){var ia=(G=void 0===G?null:G)?G.Mm:null,eb=new Wd;if(eb.Mm=ia){var Fb=this.oXa.Pia(ia.storeType,ia.solutionId,6===G.rt?1:0);Fb&&Fb.Ko&&(eb.Ko=Fb.Ko,this.tTb&&3===G.rt&&"hardcodedpreinstall"!==ia.storeType)&&(G="",Fb.Ko.yW&&Fb.Ko.yW.Ts&&(Fb=Fb.Ko.yW.Ts.oa(0))&&(G=Fb.id),Fb={},ia=(Fb.SDX_CommandPlacement=G,Fb.SDX_PinningAction="Pinning",Fb.SDX_PinningActionErrorCode=
"0",Fb.SDX_Id=Telemetry.PrivacyRules.GetPrivacyCompliantId(ia.solutionId,ia.ownerAddinStoreType||ia.storeType,ia.assetId,null,null,ia.storeId),Fb),Eb.a.sendTelemetryEvent(Object.assign(new Zd.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:wj.a.Il(ia)})))}this.Za.raiseEvent(Hg.a.qoe,eb)};Object(me.a)(wa,"LaunchAddinCommandsHandler",null,[344]);kd.zUa="Alt";kd.AUa="Command";kd.id="Id";kd.CUa="Image16by16";kd.gQb="LabelText";kd.EUa="Title";kd.GROUP="Group";kd.H0d="Groups";kd.sgb="Controls";
kd.button="Button";kd.Faa="FlyoutAnchor";kd.LARGE="Large";kd.SMALL="Small";Object(me.a)(kd,"AddinDataNodeConstants",null,[]);b(632);b(625);Ek.Object.defineProperties(zc.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}},LU:{configurable:!0,enumerable:!0,get:function(){return this.c4d||(this.c4d={})}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.Emg||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.fEa||(this.fEa=new gg.a)}}});
Object(me.a)(zc,"ControlDefinition",null,[341]);Ek.Object.defineProperties(vc.prototype,{sla:{configurable:!0,enumerable:!0,get:function(){return this.$ae||(this.$ae={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object(me.a)(vc,"MenuItemDefinition",null,[391]);Ek.Object.defineProperties(Za.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.wpa||(this.wpa=new gg.a)}}});Object(me.a)(Za,
"OfficeMenuDefinition",null,[340]);var kj=b(27);ub.prototype.addButton=function(G){$e.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",G.actionType);this.eJ=new zc(this.usa(G.id),kd.button);this.eJ.LU[kd.gQb]=G.label;this.eJ.LU[kd.zUa]=G.label;this.eJ.LU[kd.CUa]=G.icon["16"];this.Uob(this.eJ.LU[kd.id],G.action);this.AFa(this.eJ.LU);this.tVa.controls.add(this.eJ);this.eJ=null};ub.prototype.startBuildMenu=function(G){if(Ij.c(this.tVa))this.tVa=new Za(G.id);else{var ia=this.usa(G.id);
this.eJ=new zc(ia,kd.Faa);this.$Za(this.eJ.LU,G);this.eJ.LU[kd.CUa]=G.icon["16"];this.eJ.LU[kd.AUa]=kj.a.alwaysEnabled}};ub.prototype.addMenuItem=function(G){$e.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",G.actionType);var ia=new vc(this.usa(G.id));this.$Za(ia.sla,G);G.icon&&(ia.sla[kd.CUa]=G.icon["16"]);this.Uob(ia.sla[kd.id],G.action);this.AFa(ia.sla);this.eJ.menuItems.add(ia)};ub.prototype.endBuildMenu=function(){Ij.c(this.eJ)?(this.mlc.add(this.tVa),this.tVa=null):
(this.tVa.controls.add(this.eJ),this.eJ=null)};ub.prototype.Uob=function(G,ia){this.zTc.bindAction(G,ia)};ub.prototype.AFa=function(G){this.xqb.AFa(G)};ub.prototype.usa=function(G){return this.Tlc.aKa(G)};ub.prototype.$Za=function(G,ia){G[kd.gQb]=ia.label;G[kd.zUa]=ia.label};Ek.Object.defineProperties(ub.prototype,{Tlc:{configurable:!0,enumerable:!0,get:function(){return this.VNc}},xqb:{configurable:!0,enumerable:!0,get:function(){return this.gVa}},zTc:{configurable:!0,enumerable:!0,get:function(){return this.GUa}},
mlc:{configurable:!0,enumerable:!0,get:function(){return this.gsg}}});Object(me.a)(ub,"ContextMenuExtensibilityCreator",null,[372,367]);Zb.prototype.aKa=function(G){return this.dDb+G};Ek.Object.defineProperties(Zb.prototype,{dDb:{configurable:!0,enumerable:!0,get:function(){return this.okb}}});Object(me.a)(Zb,"DefaultContextMenuNamingProvider",null,[370]);var Xk=b(1366);Jb.prototype.bindAction=function(G,ia){OfficeExt.DefaultControlActionBinder.bindAction(G,ia)};Object(me.a)(Jb,"DefaultUIControlActionBinder",
null,[371]);Mb.prototype.AFa=function(G){G[kd.AUa]=this.command};Ek.Object.defineProperties(Mb.prototype,{command:{configurable:!0,enumerable:!0,get:function(){return this.OCa}}});Object(me.a)(Mb,"DefaultUIControlCommandBinder",null,[369]);var el=b(32);Object(me.a)(ib,"AddInControl",null,[]);Object(me.a)(Qa,"AddInGroup",null,[]);Object(me.a)(qb,"AddInMenuItem",null,[]);Object(me.a)(Oa,"AddInTab",null,[]);sa.prototype.startBuildTab=function(G){var ia=G.isOfficeTab?G.id:this.Tlc.J2e(G.id),eb=G.isOfficeTab?
null:G.label;this.uVa=Object.assign(new Oa,{id:ia,title:eb,isOfficeTab:G.isOfficeTab,visible:G.visible,groups:[],tabType:G.tabType,insertBefore:G.insertBefore,insertAfter:G.insertAfter,autoFocus:G.autoFocus})};sa.prototype.startBuildGroup=function(G){var ia=this.usa(G.id);this.dfa=Object.assign(new Qa,{id:ia,mlrId:G.mlrId,title:G.label,controls:[],groupType:0})};sa.prototype.addNativeGroup=function(G){this.dfa=Object.assign(new Qa,{id:G.id,mlrId:G.mlrId,title:G.label,controls:[],groupType:1});this.uVa.groups.push(this.dfa)};
sa.prototype.addButton=function(G){var ia=this.usa(G.id);ia&&(this.Uob(ia,G.action),$e.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",G.actionType),G=Object.assign(new ib,{id:ia,title:G.label,iconLocation:this.Ued(G),enabled:G.enabled,controlType:0,attributes:this.$Za()}),this.d6d.Wke(new el.a(ia,this.xqb.command.toString())),this.dfa.controls.push(G))};sa.prototype.addNativeControl=function(G){G.id&&($e.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",
G.actionType),G=Object.assign(new ib,{id:G.id,title:"",iconLocation:"",enabled:G.enabled,controlType:2,attributes:this.$Za()}),this.dfa.controls.push(G))};sa.prototype.startBuildMenu=function(G){var ia=this.usa(G.id);ia&&(this.Hhb=Object.assign(new ib,{id:ia,title:G.label,iconLocation:this.Ued(G),controlType:1,attributes:{},menuItems:[]}))};sa.prototype.addMenuItem=function(G){var ia=this.usa(G.id);ia&&(this.Uob(ia,G.action),$e.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",
G.actionType),G=Object.assign(new qb,{id:ia,title:G.label,iconLocation:this.Ued(G),enabled:G.enabled,attributes:this.$Za()}),this.d6d.Wke(new el.a(ia,this.xqb.command.toString())),this.Hhb.menuItems.push(G))};sa.prototype.endBuildMenu=function(){Ij.c(this.Hhb.id)||this.dfa.controls.push(this.Hhb);this.Hhb=null};sa.prototype.endBuildGroup=function(){Ij.c(this.dfa.id)||this.uVa.groups.push(this.dfa);this.dfa=null};sa.prototype.endBuildTab=function(){Ij.c(this.uVa.id)||this.uQb.add(this.uVa);this.uVa=
null};sa.prototype.$Za=function(){var G={};this.AFa(G);return G};sa.prototype.Ued=function(G){return G.icon["80"]?G.icon["80"]:G.icon["32"]};sa.prototype.AFa=function(G){this.xqb.AFa(G)};sa.prototype.usa=function(G){return this.Tlc.aKa(G)};sa.prototype.Uob=function(G,ia){this.zTc.bindAction(G,ia)};Ek.Object.defineProperties(sa.prototype,{Tlc:{configurable:!0,enumerable:!0,get:function(){return this.VNc}},Ts:{configurable:!0,enumerable:!0,get:function(){return this.uQb}},zTc:{configurable:!0,enumerable:!0,
get:function(){return this.GUa}},xqb:{configurable:!0,enumerable:!0,get:function(){return this.gVa}}});Object(me.a)(sa,"OneLineRibbonExtensibilityCreator",null,[366,367]);ba.prototype.RPg=function(G){G=new Zb(G);return new ub(G,this.gVa,this.GUa)};ba.prototype.GQg=function(G,ia,eb,Fb){eb=new Xk.a(this.okb,G,eb,!0);return new sa(eb,this.GUa,this.gVa,G,ia,Fb)};Object(me.a)(ba,"UIExtensibilityFactory",null,[333]);var Bk=b(95),al=b(1071);I.GetPrivacyCompliantId=function(G){return I.lEc?Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,
G.storeType,G.assetId,null,null,G.storeId):Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.assetId)};I.BUa=function(G){return I.lEc?Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,G.storeType,G.assetId,null,null,G.storeId):Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.assetId)};I.prototype.z8i=function(G){this.xC=G;window.addEventListener&&(window.addEventListener("LaunchContentAddin",Object(Kh.a)(this,this.nNi,"onLaunchButtonClicked_ContentAddin"),!0),window.addEventListener("DismissCallout",
Object(Kh.a)(this,this.DIi,"onDismissButtonClicked_ContentAddin"),!0),window.addEventListener("CloseCallout",Object(Kh.a)(this,this.hHi,"onCloseButtonClicked_ContentAddin"),!0))};I.prototype.ggd=function(G){return"[id="+G+"]"};I.prototype.Y3f=function(G,ia){var eb=this;ia>this.rHg?(window.clearTimeout(this.xOf),this.X3f("[data-unique-id='pivotOverflowButton']"),$e.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+
G)?this.X3f(G):this.xOf=window.setTimeout(function(){eb.Y3f(G,ia+1)},1E3)};I.prototype.W3f=function(G){var ia=document.querySelector("button[data-unique-id='RightPaddle']");if(ia)G={},G=(G.AppTeachingUICalloutAction="RightPaddlePresent",G["SDX.Id"]=I.GetPrivacyCompliantId(this.Mm),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)}));else if(ia=
document.querySelector("button"+G),!ia||"none"===window.getComputedStyle(ia).display)if(ia=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!ia){ia={};ia=(ia.AppTeachingUICalloutAction="NoAnchor",ia["SDX.Id"]=I.GetPrivacyCompliantId(this.Mm),ia.AppTeachingUICalloutGoal="NewAdminDeployment",ia["SDX.AppInstallOrigin"]="Organization",ia);Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(ia)}));$e.ULS.sendTraceTag(537170691,
220,15,"ShowTeachingCallout failed to get an anchorElement");this.Rxa();return}this.n$f(ia,"ShowTeachingUIForAddinButton")};I.prototype.X3f=function(G){G=document.querySelector("button"+G);if(!G&&(G=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!G)){G={};G=(G.AppTeachingUICalloutAction="NoAnchor",G["SDX.Id"]=I.GetPrivacyCompliantId(this.Mm),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)}));$e.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.Rxa();return}this.n$f(G,"ShowTeachingUIForAddinTab")};I.prototype.n$f=function(G,ia){G.setAttribute("lpp-id","latestAddin");var eb=mc.a.instance.lc("Common.ISystemInitiatedFeedback");eb&&G?(eb.execute(function(Fb){Fb.logActivity(ia,null)}),G={},G=(G.AppTeachingUICalloutAction="Show",G["SDX.Id"]=I.GetPrivacyCompliantId(this.Mm),
G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)})),$e.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):($e.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),G={},G=(G.AppTeachingUICalloutAction="NoSifFutureObject",G["SDX.Id"]=I.GetPrivacyCompliantId(this.Mm),
G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)})),this.Rxa())};I.prototype.QHh=function(G){if(!G)return null;G=G.yW;if((null===G||void 0===G?0:G.Ts)&&0<G.Ts.count){G=El(G.Ts);for(var ia=G.next();!ia.done;ia=G.next())if(ia=ia.value,ia.groups&&0<ia.groups.length){ia=El(ia.groups);for(var eb=ia.next();!eb.done;eb=ia.next())if(eb=eb.value,
eb.controls&&0<eb.controls.length){eb=El(eb.controls);for(var Fb=eb.next();!Fb.done;Fb=eb.next()){Fb=Fb.value;if(Fb.attributes&&0===Fb.controlType&&Fb.enabled)return Fb.id;if(Fb.menuItems)for(var Oc=El(Fb.menuItems),Tc=Oc.next();!Tc.done;Tc=Oc.next())if(Tc=Tc.value,Tc.attributes&&Tc.enabled)return Fb.id}}}}return null};I.prototype.RAj=function(){var G=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(G&&"none"!==window.getComputedStyle(G).display)$e.ULS.sendTraceTag(527286666,
220,15,"Callout show on OfficeAddin Button");else{G=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==G){G={};G=(G.AppTeachingUICalloutAction="NoAnchor",G["SDX.Id"]=I.BUa(this.xC),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)}));$e.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");
this.Rxa();return}$e.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}var ia=mc.a.instance.lc("Common.ISystemInitiatedFeedback");null==ia||null==G?(G={},G=(G.AppTeachingUICalloutAction="NoSifFutureObject",G["SDX.Id"]=I.BUa(this.xC),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)})),$e.ULS.sendTraceTag(527286665,220,
15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.Rxa()):(ia.execute(function(eb){eb.logActivity("ShowTeachingUIForContentAddin",null)}),G={},G=(G.AppTeachingUICalloutAction="Show",G["SDX.Id"]=I.BUa(this.xC),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)})),$e.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))};
I.prototype.nNi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnLaunch",G["SDX.Id"]=I.BUa(this.xC),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)}));var ia={};ia[th.a.Cg]=this.xC;G={};G.solutionId=this.xC.solutionId;G.assetId=this.xC.assetId;G.assetStoreId=this.xC.assetStoreId;G.height=0!=this.xC.height?this.xC.height:600;
G.storeId=this.xC.storeId;G.storeType=this.xC.storeType;G.targetType=this.xC.targetType;G.width=0!=this.xC.width?this.xC.width:600;G.displayName=this.xC.displayName;G.version=this.xC.version;G.isAddinCommands=!1;ia[Hg.a.Sra]=G;var eb=new Bk.a(-741808261,0,0,2,null);Rh.TaskExtensions.Ba(jj.GetServiceTaskFactory.Va(this.$.da,374,375,1),function(Fb){Fb=Fb.result;null!=Fb&&Fb.insertAgave(ia,eb)},this.$.la,3)};I.prototype.hHi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnClose",G["SDX.Id"]=
I.BUa(this.xC),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(G)}))};I.prototype.DIi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnDismiss",G["SDX.Id"]=I.BUa(this.xC),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:wj.a.Il(G)}))};I.prototype.fcb=function(G){var ia={},eb={};eb.LastTeachingUIShowTime=(new Date).toUTCString();eb.AddinHasShown=G;ia[this.appName]=ra.c(eb);this.toe=new Hc(this.appName,null,null,Object(Kh.a)(this,this.L6,"postRequestFailureCallback")),this.toe.Dtb(ia),$e.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")};I.prototype.Rxa=function(){if(Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)){var G=window.g_roamingAddinList;G&&this.fcb(G)}};I.prototype.L6=function(G){$e.ULS.sendTraceTag(522981591,306,10,"failed to POST data to Roaming Settings Service with status: {0}",G?G.httpStatus:-1)};Ek.Object.defineProperties(I,{lEc:{configurable:!0,enumerable:!0,get:function(){return Tf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:6189484_TeachingCalloutSolutionIdRefactorEnabled")}}});Object(me.a)(I,"AddinTeachingCalloutHandler",null,[]);var Ck=b(1313),Pk=b(393),bl=b(10),Tk=b(40);
$a.prototype.dispose=function(){void 0!==this.Knb&&null!==this.Knb&&(this.Knb.dispose(),this.Knb=null);this.Je=this.$=null;this.disposed=!0};$a.prototype.Mvj=function(G,ia){switch(G){case kj.a.I2:G=this.yvj(ia);break;default:G=!1}return G};$a.prototype.Zc=function(){return!1};$a.prototype.executeCommand=function(G,ia,eb){var Fb=this;G=Rh.TaskExtensions.hl();ia=ia.command;switch(ia){case 843847158:break;case -2025863019:jk.a.DRd(eb[Hg.a.SVc].toString(),function(){zj.g(Fb.$).focus()});break;case -1777565636:Ck.a.showUILessDialog(eb[Hg.a.Lnb].toString());
this.Je.Jyj(eb[Hg.a.Lnb].toString());break;case 1592314317:Ck.a.hideUILessDialog(eb[Hg.a.Lnb].toString());this.Je.U5h(eb[Hg.a.Lnb].toString());break;case kj.a.I2:G=this.bid(eb);break;case kj.a.vBb:this.wBb(eb);break;case kj.a.Zma:this.Zma(eb);break;case kj.a.ERd:this.Knb.Vxc();break;case kj.a.refreshAddinCommands:this.u6i();break;case 1949669462:this.Tga.IYf(!0);break;case -1014260128:G=this.executeDynamicAddInCommandsAPI(eb);break;default:G=Lk.a(ia)}return G};$a.prototype.Lc=function(G,ia){G=!1;
switch(ia.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case kj.a.Zma:case kj.a.ERd:case kj.a.refreshAddinCommands:case 1949669462:case kj.a.vBb:case -1014260128:G=!0;break;case kj.a.I2:G=!Tf.AFrameworkApplication.protectedFile}return G};$a.prototype.jd=function(){return!1};$a.prototype.BLh=function(G){if(!G)return $e.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((G=G.yW)&&G.Ts&&0<G.Ts.count){G=El(G.Ts);for(var ia=G.next();!ia.done;ia=G.next()){ia=
ia.value;if(ia.groups&&1===ia.groups.length){var eb=ia.groups[0];if(eb.controls&&1===eb.controls.length){var Fb=eb.controls[0];if(Fb.attributes&&!Fb.controlType&&Fb.enabled)return Fb.id}eb.controls&&$e.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}ia.groups&&$e.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}}return null};$a.prototype.u6i=function(){if(this.Tga.Mtd()){this.Tga.jye();var G=this.$cd();if(G&&0<G.count){G=El(G);for(var ia=G.next();!ia.done;ia=G.next()){var eb=
{};ia=(eb[Hg.a.Sga]=ia.value,eb[Hg.a.hU]=4,eb[Hg.a.TFa]=(new Date).getTime(),eb);this.Zma(ia)}}}};$a.prototype.Zma=function(G){var ia=this;$e.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",G[Hg.a.hU],G[Hg.a.Sga]);this.Tga.Ynj();window.setTimeout(function(){if(void 0===ia.Je||null===ia.Je)$e.ULS.sendTraceTag(537170656,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",
Tk.a.x3()));else{var eb=new ed(new ne(ia.Je.Fi),Xc.instance,qc.instance);eb.pDg(function(Fb,Oc){ia.wBb(Oc.properties)});Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Tf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&eb.LGg(function(Fb,Oc){null==Oc?(Fb={},Fb=(Fb.AppTeachingUICalloutAction="InvalidEventArgs",Fb.AppTeachingUICalloutGoal="NewAdminDeployment",
Fb["SDX.AppInstallOrigin"]="Organization",Fb),Eb.a.sendTelemetryEvent(Object($f.a)(new Zd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.Il(Fb)}))):(ia.e8f=new I(ia),ia.e8f.z8i(Oc),Fb=ia.$.Ka,null!=Fb&&(Fb.ioe(Object(Kh.a)(ia,ia.Q$e,"onTabSwitched")),$e.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});eb.dNj(G)}},0)};$a.prototype.Q$e=function(G,ia){"Insert"==ia.tabName&&(G=this.$.Ka,null!=G&&(G.qQf(Object(Kh.a)(this,this.Q$e,"onTabSwitched")),$e.ULS.sendTraceTag(527286662,
220,50,"Remove insertTabSwitched handler")),this.e8f.RAj())};$a.prototype.wBb=function(G){var ia=this;if(!this.disposed){$e.ULS.sendTraceTag(537170655,220,50,"LaunchOperationType {0}.",G[Hg.a.hU]);try{if(Ag.EwaSettings.ma(187)){var eb=G[Hg.a.Jnb];if(eb&&0<eb.count){for(var Fb=eb.count,Oc=Fb-1;0<=Oc;Oc--){var Tc=eb.oa(Oc);OSF.OsfControl.isFirstPartyStoreString(Tc.storeType)||eb.remove(eb.oa(Oc))}if(eb.count<Fb){var Md=jj.GetServiceTaskFactory.Va(this.$.da,5,4,0);Rh.TaskExtensions.Ba(Md,function(){Md.result.eg(35,
null)},this.$.la,3)}if(!eb.count)return}}if(void 0===this.Je||null===this.Je)$e.ULS.sendTraceTag(537170654,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",Tk.a.x3()));else{var Qd=null;Qd=Tf.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled")?new wa(this.Ro,this.BBe,new ne(this.Je.Fi),new ba(this.$.Mb,kj.a.I2),this.Tga,Xc.instance,this.Rga,function(kf,xf){var og={};og.InstanceId=T.a.create().toString();og.PrimaryMarketplace={};og.PrimaryMarketplace.SolutionId=
kf.solutionId;og.PrimaryMarketplace.SolutionVersion=kf.version;og.PrimaryMarketplace.MarketplaceType=kf.storeType;og.PrimaryMarketplace.MarketplaceRef=kf.storeId;og.WebExtensionType=1;ia.Je.XAj(og,function(){xf(kf)})}):new wa(this.Ro,this.BBe,new ne(this.Je.Fi),new ba(this.$.Mb,kj.a.I2),this.Tga,Xc.instance,this.Rga);(Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinOnExcelWacEnabled",!1)||Tf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled"))&&
Qd.yDg(this.UFi);Qd.qDg(this.lNi);if(Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var Je=new I(this);Qd.iFg(Je.kNi);Qd.KGg(Je.vyj)}this.$.da.Aa(53).Vm&&ql.a.get_instance().Mk(5,null).continueWith(function(){ia.disposed||Qd.Nqi(ia.L$c,ia.$.domElement,G)})}}catch(kf){$e.ULS.sendTraceTag(537170653,220,10,String.format("LaunchAddinCommands error message : {0}.",kf.message))}}};$a.prototype.bid=function(G){var ia=Rh.TaskExtensions.hl();
G=G[this.Ro.Xha];var eb=this.YZb.Tje(G),Fb=new Ck.a(this.$,this.Je,eb.ownerAddinInfo,ia);return this.G4e(ia,G,eb,Fb)};$a.prototype.G4e=function(G,ia,eb,Fb){var Oc=this;this.YZb.bid(ia,this.Tga,Fb,new ne(this.Je.Fi),eb,function(){G=Fb.t1g()},function(){zj.g(Oc.$).focus()});return G};$a.prototype.KMg=function(G){var ia=this,eb=Rh.TaskExtensions.hl(),Fb=this.Je.Aaa(G.solutionId);if(Fb){var Oc=this.Je.FZ(Fb);if(bl.HelperMethods.Kw(Oc)&&0!==Oc.SharedRuntime.State)return}Oc=this.YZb.LMg;var Tc=G.solutionId in
Oc?Oc[G.solutionId]:null;if(Tc){var Md=this.YZb.Tje(Tc),Qd=new Ck.a(this.$,this.Je,Md.ownerAddinInfo,eb);Oc=function(kf){if(kf){var xf={};kf=El(kf);for(var og=kf.next();!og.done;og=kf.next())og=og.value,xf[og[0]]=og[1];(xf=Hg.a.poe in xf?xf[Hg.a.poe]:null)&&"true"===xf.toLowerCase()&&($e.ULS.sendTraceTag(537170652,220,50,"Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",G.storeType,G.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,null!==Md.ownerAddinInfo?
Md.ownerAddinInfo.storeType:G.storeType,G.assetId,null,null,G.storeId)),ia.G4e(eb,Tc,Md,Qd))}};$e.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",G.storeType,G.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,null!==Md.ownerAddinInfo?Md.ownerAddinInfo.storeType:G.storeType,G.assetId,null,null,G.storeId));if(Fb)Oc(this.Je.FZ(Fb).OsfPropertyBag);else if(Fb=this.$.ea.workbookContext.WebExtensions){Fb=El(Fb);for(var Je=
Fb.next();!Je.done;Je=Fb.next())if(Je=Je.value,(1===Je.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===G.targetType&&Je.PrimaryMarketplace.MarketplaceType.toLowerCase()===G.storeType.toLowerCase()&&Je.PrimaryMarketplace.MarketplaceRef.toLowerCase()===G.storeId.toLowerCase()&&Je.PrimaryMarketplace.SolutionId.toLowerCase()===G.solutionId.toLowerCase()){Oc(Je.OsfPropertyBag);break}}}};$a.prototype.TUd=function(G,ia,eb){G&&(void 0===eb||!eb||ia||this.N5c.contains(G)||
this.N5c.add(G),(eb=this.w1a.contains(G))&&ia&&this.w1a.remove(G),eb||ia||this.w1a.add(G))};$a.prototype.Brj=function(G){if((G=G.yW)&&G.Ts){G=El(G.Ts);for(var ia=G.next();!ia.done;ia=G.next())if(ia=ia.value,ia.groups){ia=El(ia.groups);for(var eb=ia.next();!eb.done;eb=ia.next())if(eb=eb.value,eb.controls){eb=El(eb.controls);for(var Fb=eb.next();!Fb.done;Fb=eb.next())if(Fb=Fb.value,this.TUd(Fb.id,Fb.enabled,!0),1===Fb.controlType&&Fb.menuItems){Fb=El(Fb.menuItems);for(var Oc=Fb.next();!Oc.done;Oc=Fb.next())Oc=
Oc.value,this.TUd(Oc.id,Oc.enabled,!0)}}}}};$a.prototype.$cd=function(){var G=new gg.a;Ag.EwaSettings.ma(54)&&(this.$.ea.Zg.get(27)&&(G.add(0),G.add(16)),this.$.ea.Zg.get(33)&&G.add(1),G.add(8));return G};$a.prototype.executeDynamicAddInCommandsAPI=function(G){var ia=!0;if(void 0===G||null===G||void 0===G[Hg.a.Lsb]||null===G[Hg.a.Lsb])return ik.Task.Sa(!1);switch(G[Hg.a.Lsb]){case 1:ia=this.eQj(G);break;case 2:ia=this.Frj(G);break;case 4:this.w1a.clear();this.w1a.addRange(this.N5c);break;case 3:ia=
this.installContextualTab(G);break;default:ia=!1}return ik.Task.Sa(ia)};$a.prototype.yvj=function(G){return G&&this.Ro.Xha in G?(G=G[this.Ro.Xha])?this.w1a.contains(G):!1:!1};$a.prototype.eQj=function(G){var ia=null,eb=null,Fb=null,Oc=!0;void 0!==G[Hg.a.c4]&&null!==G[Hg.a.c4]&&void 0!==G[this.Ro.Xha]&&null!==G[this.Ro.Xha]&&void 0!==G[Hg.a.b4]&&null!==G[Hg.a.b4]&&(ia=G[Hg.a.c4],eb=G[Hg.a.B7b],Fb=G[this.Ro.Xha],Oc=G[Hg.a.b4]);if(!ia||!Fb)return $e.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),
!1;G=(new Xk.a(this.$.Mb,ia,this.Ro,!0)).aKa(Fb);ia={DynamicAddinCommandsApiName:"UpdateControlEnableState"};ia.AssetId=eb;ia.MaskedTabId=G;ia.IsToEnable=Oc;$e.ULS.sendTraceTag(537170648,220,50,di.a.Kc(ia));this.TUd(G,Oc);Pk.a.az.updateCommandUI();return!0};$a.prototype.Frj=function(G){var ia,eb,Fb=null,Oc=null,Tc=null,Md=null,Qd=!0;void 0!==G[Hg.a.x7c]&&null!==G[Hg.a.x7c]&&void 0!==G[Hg.a.c4]&&null!==G[Hg.a.c4]&&void 0!==G[this.Ro.Xha]&&null!==G[this.Ro.Xha]&&void 0!==G[Hg.a.b4]&&null!==G[Hg.a.b4]&&
(Fb=G[Hg.a.x7c],Oc=G[Hg.a.c4],Tc=G[Hg.a.B7b],Md=G[this.Ro.Xha],Qd=G[Hg.a.b4]);if(!Fb||!Oc||!Md)return $e.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;G=(new Xk.a(this.$.Mb,Oc,this.Ro,!0)).J2e(Md);Md={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};Md.StoreType=Fb;Md.AssetId=Tc;Md.MaskedTabId=G;Md.IsToShow=Qd;$e.ULS.sendTraceTag(537170646,220,15,di.a.Kc(Md));Oc=this.Tga.Pia(Fb,Oc,1);Fb=!1;if(null===(eb=null===(ia=null===Oc||void 0===
Oc?void 0:Oc.Ko)||void 0===ia?void 0:ia.yW)||void 0===eb?0:eb.Ts)for(ia=El(Oc.Ko.yW.Ts),eb=ia.next();!eb.done;eb=ia.next())if(eb.value.id===G){Fb=!0;break}if(!Fb)return $e.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;ia=[];Qd?appChrome.selectors.getSelectedTabId()!==G&&ia.push(appChrome.actions.activateRibbonTab(G)):(appChrome.selectors.getSelectedTabId()===G&&ia.push(appChrome.actions.setCurrentTab(gh.a.UW)),ia.push(appChrome.actions.deactivateRibbonTab(G)));
appChrome.api.dispatch(ia);return!0};$a.prototype.installContextualTab=function(G){var ia=null,eb=null,Fb=null,Oc=null;if(void 0!==G[Hg.a.c4]&&null!==G[Hg.a.c4]&&void 0!==G[Hg.a.b4]&&null!==G[Hg.a.b4]){var Tc=G[Hg.a.b4];ia=G[Hg.a.c4];void 0!==Tc[Hg.a.HIa]&&null!==Tc[Hg.a.HIa]&&void 0!==Tc[Hg.a.IIa]&&null!==Tc[Hg.a.IIa]&&(eb=Tc[Hg.a.HIa],Fb=Tc[Hg.a.IIa],Oc=Tc[Hg.a.y7c])}if(!(ia&&Fb&&eb&&Oc))return $e.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;G=this.Tga.Pia(Oc.PrimaryMarketplace.MarketplaceType,
Oc.PrimaryMarketplace.SolutionId,1);if(null===G||void 0===G?0:G.Ko)return $e.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;G={};G.solutionId=Oc.PrimaryMarketplace.SolutionId;G.version=Oc.PrimaryMarketplace.SolutionVersion;G.storeType=Oc.PrimaryMarketplace.MarketplaceType;G.storeId=Oc.PrimaryMarketplace.MarketplaceRef;G.assetId=Oc.PrimaryMarketplace.SolutionId;G.assetStoreId=Oc.PrimaryMarketplace.MarketplaceRef;G.targetType=Oc.WebExtensionOsfControlType;G.width=
Oc.TaskpaneWidth;G.height=0;G.isAddinCommands=!0;Oc=new gg.a;Oc.add(G);G={};G[Hg.a.Jnb]=Oc;G[Hg.a.hU]=6;G[Hg.a.HIa]=eb;G[Hg.a.IIa]=Fb;this.wBb(G);return!0};Object(me.a)($a,"AddinUICommandHandler",null,[556,429,3]);var ll=b(69),Ik=b(697),wk=b(20),fl=b(17),rl=mi.a;Am(jb,rl);jb.prototype.Nd=function(){var G=this;$e.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");ll.a(this.$).add(Object($f.a)(new Ik.a,{$wc:function(){var ia=G.$.ea.uF&&G.$.ea.sc&&!!(G.$.Pd&16384)&&
G.$.isEditMode;G.$.ea.sc&&$e.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",ia,G.$.ea.uF,G.$.ea.sc,!!(G.$.Pd&16384),G.$.isEditMode);return ia},lYb:this.jzg,U5b:this.ybh,Jtb:2}))};jb.prototype.d7i=function(G){var ia=this,eb=jj.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub);return Rh.TaskExtensions.Ba(eb,function(){$e.ULS.sendTraceTag(38942483,
0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");ia.$.da.Ga(204,new Kd(eb.result,G))},this.la,3)};jb.ka=function(G){mi.a.fe(199,new jb(G))};Object(me.a)(jb,"AddinUICommandHandlerFactory",mi.a,[]);var sl=b(1302),ml=b(1304),tl=ng.a;Am(Uc,tl);Uc.prototype.create=function(){var G=this,ia;if(Ag.EwaSettings.ma(405)){var eb=jj.GetServiceTaskFactory.create(this.$.da,106,this.$.la,this.ub),Fb=jj.GetServiceTaskFactory.create(this.$.da,396,this.$.la,
this.ub);Rh.TaskExtensions.Ba(ik.Task.WAA(eb,Fb),function(){G.Eb(G.$.da.Aa(278)||new sl.CustomFunctionsInstaller(G.$,eb.result,Fb.result))},this.$.la,3)}else(ia=this.$.da.Aa(278))||(ia=this.$.da.Ga(278,new ml.CustomFunctionsLegacyInstaller(this.$))),this.Eb(ia)};Uc.ka=function(G){G.da.Ga(279,new Uc(G))};Object(me.a)(Uc,"CustomFunctionsInstallerFactory",ng.a,[]);var gl=b(90),ok=b(47),X=b(44);hc.prototype.ka=function(G){this.CXc?$e.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):
(this.CXc=!0,this.WPa={},this.XPa={},G?G.dEg(this.q$f):$e.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};hc.prototype.detach=function(G){if(G){G.haj(this.q$f);G=this.WPa;for(var ia in G)gl.a.Ha(G[ia]);this.XPa=this.WPa=null;this.CXc=!1}else $e.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};hc.prototype.ZLf=function(G,ia,eb){if(this.$di(eb,G))return!1;G=ia.querySelector("iframe");
if(!G)return $e.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;G=G.title;if(!G||!G.length)return $e.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(G);return!0};hc.prototype.$di=function(G,ia){return(G=G.Fi.getOsfControl(ia))?G.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0};Object(me.a)(hc,"AgaveOnSelectedReadoutHandler",null,[547]);var Ba=
ng.a;Am(zb,Ba);zb.prototype.create=function(){var G=this,ia=this.$.da;Rh.TaskExtensions.Ba(jj.GetServiceTaskFactory.Va(ia,211,212,this.ub),function(eb){eb=ia.Aa(224)||new hc(eb.result,G.$);G.Eb(eb)},this.la,3)};zb.ka=function(G){G.da.Ga(225,new zb(G))};Object(me.a)(zb,"AgaveOnSelectedReadoutHandlerFactory",ng.a,[]);var db=b(946),$b=b(243);Xb.prototype.M5e=function(G){try{if(G&&G.rawEvent&&G.rawEvent.origin&&this.iframe&&this.iframe.id){var ia=this.tFf(G.rawEvent.origin),eb=this.tFf(document.domain);
if(Eg.a.Pk().equals(eb,ia))if(G.rawEvent.source&&G.rawEvent.source.frameElement&&G.rawEvent.source.frameElement.id&&Eg.a.Pk().equals(G.rawEvent.source.frameElement.id,this.iframe.id)){ia=null;try{ia=JSON.parse(G.rawEvent.data)}catch(Fb){$e.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",Fb.message)}ia?(ia.statusCode!==$b.a.kP||void 0!==ia.error&&ia.error?($e.ULS.sendTraceTag(23707648,344,50,
"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",ia.statusCode,ia.error),this.onError()):($e.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(ia.authorizationCode?ia.authorizationCode:ia.signInUrl)),$removeHandler(window,"message",Object(Kh.a)(this,this.M5e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):$e.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):
$e.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):$e.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else $e.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else $e.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else $e.ULS.sendTraceTag(51418200,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Fb){$e.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Fb.message)}};Xb.prototype.tFf=function(G){var ia="";try{G&&(ia=-1<G.indexOf("//")?G.split("/")[2]:G.split("/")[0])&&(ia=ia.split(":")[0],ia=ia.split("?")[0])}catch(eb){$e.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",eb.message)}return ia};Xb.ka=function(G,ia,eb){new Xb(G,ia,eb)};Object(me.a)(Xb,
"ResponseHandler",null,[]);var Cc=b(260);Wa.prototype.tryAuthenticate=function(G,ia){this.M$a(Wa.Npg,function(){G()},ia)};Wa.prototype.tryAuthorize=function(G,ia){this.M$a(Wa.Okg,G,ia)};Wa.prototype.getSignInUrl=function(G,ia){this.M$a(Wa.Vge,G,ia)};Wa.prototype.signOut=function(G,ia){this.M$a(Wa.awg,G,ia)};Wa.prototype.M$a=function(G,ia,eb){var Fb=new Cc.QueryStringBuilder("AuthenticationProxyHandler.aspx");Fb.Xi("responseType",G);Tf.AFrameworkApplication.vYa(Fb);Fb=String.format("{0}{1}&{2}",this.mFa,
Fb.toString(),Tf.AFrameworkApplication.oj);var Oc=document.createElement("iframe");Oc.setAttribute("id","privateCatalogIframe");Oc.setAttribute("name","privateCatalogIframe");Oc.setAttribute("style","display: none");Eg.a.Pk().equals(G,Wa.Vge)||Oc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Xb.ka(Oc,ia,eb);Oc.setAttribute("src",Fb);document.body.appendChild(Oc)};Wa.Okg="authcode";Wa.Npg="identitytoken";Wa.Vge="signinurl";Wa.awg="signout";Object(me.a)(Wa,
"AuthenticationProxy",null,[]);wb.getUserId="getUserId";wb.getLastStoreUpdate="laststoreupdate";wb.getEntitlement="getEntitlements";wb.getEToken="getEToken";wb.getManifest="getManifest";wb.getAppState="getAppState";wb.getKilledApps="getRemovedAddins";wb.getAppDetails="getAppDetails";wb.removeApps="removeAddin";wb.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";wb.getPrivateCatalogAddIns="getAddIns";wb.getPrivateCatalogManifests="getAppManifests";wb.isStoreDisabled="isStoreDisabled";Object(me.a)(wb,
"S2SWebRequestActions",null,[]);var fd=b(640);ic.prototype.getUserId=function(G,ia){var eb=new gg.a;eb.add(new Ji.a("corr",G));this.wS(wb.getUserId,eb,1,ia)};ic.prototype.getLastStoreUpdate=function(G,ia,eb){var Fb=new gg.a;Fb.add(new Ji.a("lc",G));Fb.add(new Ji.a("corr",ia));this.wS(wb.getLastStoreUpdate,Fb,1,eb)};ic.prototype.getEntitlement=function(G,ia,eb,Fb){G=new gg.a;G.add(new Ji.a("av",ia));G.add(new Ji.a("corr",eb));this.wS(wb.getEntitlement,G,1,Fb)};ic.prototype.getEToken=function(G,ia,
eb,Fb,Oc,Tc){var Md=new gg.a;Md.add(new Ji.a("cmu",G));Md.add(new Ji.a("cmf",ia));Md.add(new Ji.a("assetid",eb));Md.add(new Ji.a("expver",Fb));Md.add(new Ji.a("corr",Oc));this.wS(wb.getEToken,Md,1,Tc)};ic.prototype.getManifest=function(G,ia,eb,Fb){var Oc=new gg.a;Oc.add(new Ji.a("cmu",G));Oc.add(new Ji.a("assetid",ia));Oc.add(new Ji.a("corr",eb));this.wS(wb.getManifest,Oc,1,Fb)};ic.prototype.getAppState=function(G,ia,eb){var Fb=new gg.a;Fb.add(new Ji.a("ma",G));Fb.add(new Ji.a("corr",ia));this.wS(wb.getAppState,
Fb,1,eb)};ic.prototype.getKilledApps=function(G,ia){var eb=new gg.a;eb.add(new Ji.a("corr",G));this.wS(wb.getKilledApps,eb,1,ia)};ic.prototype.getAppDetails=function(G,ia,eb,Fb){var Oc=new gg.a;Oc.add(new Ji.a("cmo",G));Oc.add(new Ji.a("corr",eb));this.sendWithBody(wb.getAppDetails,Oc,ia,2,Fb,!1)};ic.prototype.removeApps=function(G,ia,eb){var Fb=new gg.a;Fb.add(new Ji.a("corr",ia));this.sendWithBody(wb.removeApps,Fb,G,2,eb,!1)};ic.prototype.getLastPrivateCatalogUpdate=function(G,ia,eb,Fb,Oc,Tc){var Md=
new gg.a;Md.add(new Ji.a("catalog","privatecatalog"));Md.add(new Ji.a("clientCode",G));Md.add(new Ji.a("clientVersion",ia));Md.add(new Ji.a("corr",Oc));G=String.format("authorizationCode={0}&refreshToken={1}",eb?Mj.a.mf(eb):"",Fb?Mj.a.mf(Fb):"");this.sendWithBody(wb.getLastPrivateCatalogUpdate,Md,G,2,Tc,!0)};ic.prototype.getPrivateCatalogAddIns=function(G,ia,eb,Fb,Oc,Tc){var Md=new gg.a;Md.add(new Ji.a("catalog","privatecatalog"));Md.add(new Ji.a("clientCode",G));Md.add(new Ji.a("clientVersion",ia));
Md.add(new Ji.a("corr",Oc));G=String.format("authorizationCode={0}&refreshToken={1}",eb?Mj.a.mf(eb):"",Fb?Mj.a.mf(Fb):"");this.sendWithBody(wb.getPrivateCatalogAddIns,Md,G,2,Tc,!0)};ic.prototype.getPrivateCatalogManifests=function(G,ia,eb,Fb,Oc){var Tc=new gg.a;Tc.add(new Ji.a("catalog","privatecatalog"));Tc.add(new Ji.a("corr",Fb));G=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Mj.a.mf(G),ia?Mj.a.mf(ia):"",eb?Mj.a.mf(eb):"");this.sendWithBody(wb.getPrivateCatalogManifests,
Tc,G,2,Oc,!0)};ic.prototype.isStoreDisabled=function(G,ia){var eb=new gg.a;eb.add(new Ji.a("corr",G));this.wS(wb.isStoreDisabled,eb,2,ia)};ic.prototype.wS=function(G,ia,eb,Fb){this.sendWithBody(G,ia,null,eb,Fb,!1)};ic.prototype.sendWithBody=function(G,ia,eb,Fb,Oc,Tc){var Md=new Cc.QueryStringBuilder("AddinServiceHandler.ashx");Md.Xi("action",G);Md.Xi("app",fd.a[Tf.AFrameworkApplication.ta.Qa.Sj]);ia=El(ia);for(var Qd=ia.next();!Qd.done;Qd=ia.next())Qd=Qd.value,Md.Xi(Qd.key,Qd.value);Md=String.format("{0}{1}&{2}",
Tf.AFrameworkApplication.ta.Qa.sW,Md.toString(),Tf.AFrameworkApplication.oj);Tf.AFrameworkApplication.Jd.El(Md,Fb,eb,null,!1,2,function(Je){var kf=null;Je&&Je.data&&(Je.data.responseHeaders["X-BlockedForMinor"]&&"1"===Je.data.responseHeaders["X-BlockedForMinor"].toString()&&(Je.data.httpStatus=451),kf=Je.data.ke);Oc(Je.data.httpStatus,kf)},function(Je){var kf=null;Tc&&Je&&Je.data&&Je.data.ke&&(kf=Je.data.ke);Oc(Je.data.httpStatus,kf);if(Tf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",
!0)){kf={message:"AddinServiceHandler request failed"};kf.code=Je.data.httpStatus;kf.action=G;if(Je.data.request||Je.data.request.get_headers())kf["X-UserSessionId"]=Je.data.request.get_headers()["X-UserSessionId"];408===Je.data.httpStatus||503===Je.data.httpStatus?$e.ULS.sendTraceTag(538784582,220,10,JSON.stringify(kf)):$e.ULS.sendTraceTag(18392345,220,50,JSON.stringify(kf))}else $e.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Je.data.httpStatus)},null,void 0,void 0,void 0,
void 0,"AddinServiceHandler_"+G)};Object(me.a)(ic,"S2SWebRequestManager",null,[]);var gd=ng.a;Am(Kb,gd);Kb.prototype.create=function(){var G=this;$e.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");Tf.AFrameworkApplication.disableWholeAppsForOfficeFeature?$e.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",Tf.AFrameworkApplication.disableWholeAppsForOfficeFeature):Ag.EwaSettings.ma(409)?mc.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(ia){ia.isFeatureEnabled("mso_officeStore",
!0).then(function(eb){db.DdaFacade.G2c=eb;G.KDe();return null})}):this.KDe()};Kb.prototype.KDe=function(){var G=this,ia=jj.GetServiceTaskFactory.Va(this.$.da,224,225,this.ub),eb=Zj.a.Itd(41,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.ub,106),Fb=Gc(this.la,this.ub);Rh.TaskExtensions.Ba(Rh.TaskExtensions.ye([ia,eb,Fb],this.$.la),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?$e.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",
Tk.a.x3()):G.x9h();$e.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");G.YLf=ia.result;G.Eb(G.Je);$e.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)};Kb.prototype.x9h=function(){Ag.EwaSettings.ma(65)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new ic);this.$.Yf.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new ic,new Wa(Tf.AFrameworkApplication.ga.appSettings.WebServiceBase),Ag.EwaSettings.ma(72),
Ag.EwaSettings.ma(436))};Kb.prototype.dispose=function(){gl.a.Ha(this.ddaFacade);this.$=this.ddaFacade=null;gd.prototype.dispose.call(this)};Kb.ka=function(G){new Kb(G)};Ek.Object.defineProperties(Kb.prototype,{Je:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new db.DdaFacade(this.$,this.YLf))}}});Object(me.a)(Kb,"DdaFacadeServiceFactory",ng.a,[]);bc.prototype.jd=function(){return!1};bc.prototype.Zc=function(){return!1};bc.prototype.Lc=function(G,ia,eb,Fb){var Oc=
!1;switch(ia.command){case -684355545:Oc=!0;break;case -741808261:Oc=!!eb;break;case -859308420:Oc=!!Fb&&1===Fb.Nx;break;case 418618014:Oc=1===G&&!!Fb&&1===Fb.Nx;break;case -515602470:ia=Ag.EwaSettings.ma(235)&&2===G;Oc=(1===G||ia)&&!!Fb&&1===Fb.Nx;break;case 2086613372:Oc=Ag.EwaSettings.ma(235)&&2===G&&!!Fb&&1===Fb.Nx;break;case -1336341324:Oc=Ag.EwaSettings.ma(485)&&1===G&&!!Fb&&1===Fb.Nx;break;case 451940422:Oc=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",
!1)&&1===G&&!!Fb&&1===Fb.Nx;break;case -1444574190:case -336193495:Oc=1===G&&!!Fb&&1===Fb.Nx;break;case 1296389134:Oc=1===G&&!!Fb&&1===Fb.Nx;break;case -1473679467:Oc=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===G&&!!Fb&&1===Fb.Nx;break;case 1221897806:Oc=Ag.EwaSettings.ma(167)&&2===G;break;case 1172793074:case 1930653487:Oc=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===G;break;case -1753056834:Oc=
Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:Oc=!0;break;case 301511274:Oc=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Oc=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:Oc=this.$.isEditMode&&this.$.ea.$Kb}return Oc};bc.prototype.executeCommand=function(G,ia,eb){var Fb=Rh.TaskExtensions.hl(),
Oc=ia.command;switch(ia.command){case -1473679467:ih.a(this.$,488,489,1,function(Tc){Fb=Tc.vbi(eb.SourceControlId,ia)});break;case 1296389134:this.agaveCommandManager.WDj(eb.SourceControlId,eb.LabelText);break;case -684355545:this.agaveCommandManager.XZc();break;case -741808261:Fb=this.agaveCommandManager.insertAgave(eb,ia);ih.a(this.$,488,489,1,function(Tc){Tc.Kzg(eb)});break;case -1336341324:Ag.EwaSettings.ma(485)&&(Fb=this.agaveCommandManager.wid(eb,G,ia));break;case 1172793074:Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&(Fb=this.agaveCommandManager.wid(eb,G,ia));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:Fb=this.agaveCommandManager.wid(eb,G,ia);break;default:Fb=Lk.a(Oc)}return Fb};Object(me.a)(bc,"AgaveCommandHandler",null,[429]);Object(me.a)(Cd,"Selection",null,[]);Object(me.a)(yc,"SmartLookupApplicationInterface",null,[]);Object(me.a)(Qb,
"ApplicationProperties",null,[]);Object(me.a)(Ja,"EnterpriseUserInfo",null,[]);Object(me.a)(Db,"FeatureGates",null,[]);rc.prototype.CXh=function(){var G=void 0===G?!0:G;var ia=this.VFe();if(ia<this.ivd+this.UJj)return ia>this.ivd+this.XJj&&this.Wcd(),this.dnf;G&&this.Wcd();return""};rc.prototype.Wcd=function(){var G=this;this.lvd=this.lvd||new Promise(function(ia){G.DXh().then(function(eb){G.dnf=eb;G.ivd=G.VFe();G.lvd=null;ia(eb)})})};rc.prototype.DXh=function(){var G=this;return this.A8a&&this.A8a.length?
new Promise(function(ia){G.Kxa.US("SmartLookup",G.A8a).then(function(eb){eb.IsSuccess?eb.Token||(ia(""),$e.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):($e.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+eb.ErrorCode+": "+eb.ErrorMessage),ia(""));ia(eb.Token)}).catch(function(eb){eb=ra.c(eb);$e.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+eb);ia("")})}):($e.ULS.sendTraceTag(51446543,
1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))};Object(me.a)(rc,"SmartLookupAuthenticationManager",null,[392]);ob.NNh=function(){switch(Object(Fi.a)(String,Tf.AFrameworkApplication.dc.AudienceGroup)||""){case "Dogfood":if(Tf.AFrameworkApplication.ga){var G=Tf.AFrameworkApplication.ga.Ua("UserPrincipalName");G=Mj.a.Ul(G);var ia=Tf.AFrameworkApplication.ga.mz("SmartLookupINTEnabledForSKITeam")?Tf.AFrameworkApplication.ga.Iw("SmartLookupINTEnabledForSKITeam"):[];return 0<=
Array.indexOf(ia,G)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};ob.aXh=function(){switch(Tf.AFrameworkApplication.ga.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":Tf.AFrameworkApplication.ga.ra("IntentSvcEnableProdSourceLocationOverride")?"PROD":Tf.AFrameworkApplication.ga.ra("IntentSvcEnableIntSourceLocationOverride")?"INT":ob.NNh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";
default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Object(me.a)(ob,"Utils",null,[]);var Sc=b(620);cb.prototype.tIh=function(){return Promise.resolve(this.uIh())};cb.prototype.uIh=function(){var G=new Qb;G.anid="";G.applicationVersion=Tf.AFrameworkApplication.buildVersion;G.appCorrelationId=Xf.a.create().toString();G.themePlatform=cb.TVj;G.lcid=Tf.AFrameworkApplication.lcid;G.launchUtcTime=(new Date).toUTCString();G.featureGates=this.z8a;var ia=Sc.a.wH(Tf.AFrameworkApplication.lcid);
ia=ia?ia.name:null;G.market=this.Rac(ia);G.uiLanguage=ia;G.sessionId=Tf.AFrameworkApplication.userSessionId;G.themeId=0;G.parentalControl=cb.WVi;var eb=new Ja;eb.CountryCode=this.Rac(ia);eb.ServiceEndpoint=this.A8a;eb.IsGoLocal=!1;eb.IsEnabled=this.Lnf;eb.IsEnterpriseEnabled=this.Lnf;eb.TenantRoot=this.Xwi;G.enterpriseUserInfo=eb;G.accessToken=this.Rwi.CXh();return G};cb.prototype.Rac=function(G){G=G.split("-");return G[G.length-1]};Ek.Object.defineProperties(cb.prototype,{approvedOriginPattern:{configurable:!0,
enumerable:!0,get:function(){return this.rwi}}});cb.TVj="web";cb.WVi="yes";Object(me.a)(cb,"SmartLookupManager",null,[346]);var Pc=Rk.a;Am(pb,Pc);pb.prototype.jd=function(){return!1};pb.prototype.Zc=function(){return!1};pb.prototype.Lc=function(G,ia){G=Ag.EwaSettings.ma(135);return-983891024===ia.command&&G};pb.prototype.executeCommand=function(G,ia){G=Rh.TaskExtensions.hl();-983891024===ia.command&&this.wqi();return G};pb.prototype.wqi=function(){var G=this,ia=new cb(null),eb={},Fb=zj.g(this.$).kc(null).originalText;
Fb=Object($f.a)(new Cd,{neighborhood:Fb,mentionStart:0,mentionLength:Fb?Fb.length:0});var Oc=Object($f.a)(new yc,{selection:Fb,entryPoint:0});ia.tIh().then(function(Md){Md.applicationName=pb.appName;Md.isFirstLaunch=G.isFirstLaunch;Md.themeId=5;eb[pb.smartLookupApplicationInterface]=JSON.stringify(Oc);eb[pb.sJg]=JSON.stringify(Md);G.isFirstLaunch=!1});ia=new Le.a("ExcelOnline","Web","en-Us");Fb=new Qc.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var Tc=new Id.a;Tc.oi[le.gl]=
gi.a.instance.fa(1773);Tc.oi[le.taskPaneWidth]=350;Tc.oi[le.sourceLocationOverrideResourceId]="WAC.PROD.URL";Tc.pr=eb;cd.a.instance.yNa(Fb,"Taskpane","SmartLookupSDXTaskpane",ia,Tc)};pb.sJg="AppProperties";pb.appName="Excel";pb.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(me.a)(pb,"SmartLookupCommandHandler",Rk.a,[429]);var Pd=mi.a;Am(Tb,Pd);Tb.prototype.Nd=function(){var G=this;ih.a(this.$,374,375,this.ub,function(ia){G.Cd([new bc(G.$,null,null,null,null,ia),new pb(G.$)])})};
Tb.ka=function(G){mi.a.fe(76,new Tb(G))};Object(me.a)(Tb,"AgaveCommandHandlerFactory",mi.a,[]);Object(me.a)(function(){},"AppInfoDetail",null,[]);b(1151);Object(me.a)(function(){},"AppsForOfficeUtils",null,[]);Object(me.a)(tc,"AppsDataManager",null,[159]);var Vd=b(1367),Ie=b(107);wc.prototype.initialize=function(G){wc.initialized||(this.Je=G,this.Qg(),wc.initialized=!0)};wc.prototype.Qg=function(){Tf.AFrameworkApplication.Ib.Te(kj.a.sab,Ie.a.frame,this.sab,96);Tf.AFrameworkApplication.Ib.fc(kj.a.U6i,
Ie.a.frame,this.d8i)};Ek.Object.defineProperties(wc,{instance:{configurable:!0,enumerable:!0,get:function(){wc.Ma||(wc.Ma=new wc);return wc.Ma}}});wc.Ma=null;wc.initialized=!1;Object(me.a)(wc,"AgaveCommandActor",null,[]);var sf=b(112),Bf=b(372),Bg=b(368),xg=b(1326),Nh=b(358);Object(me.a)(Sb,"FirstPartyAddinTaskpaneOverrides",null,[]);Object(me.a)(gb,"IdeasSelectionContext",null,[]);Am(Ia,gb);Object(me.a)(Ia,"IdeasTableSelectionContext",gb,[]);var Oh=b(63),Eh=b(46),Si=b(387),Ti=b(167),Ui=b(630),bj=
b(132),Vi=b(149),pj=b(182),sj=Vi.a;Am(ha,sj);ha.prototype.qD=function(){sj.prototype.qD.call(this);this.Np.style.width=this.s2d;this.Np.style.height=this.kVa;this.Np.style.marginTop=this.vRb;this.Np.style.padding=this.lVa};ha.prototype.SPa=function(){this.Np.style.width=this.s2d;this.Np.style.height=this.kVa;this.Np.style.marginTop=this.vRb;this.Np.style.padding=this.lVa;this.cDa>pj.a.y$a?(this.Nb.style.width=String.format("{0}px",pj.a.y$a),this.Nb.style.overflowX="scroll",Tf.AFrameworkApplication.isRtl?
this.Nb.style.right="0":this.Nb.style.left="0"):(this.Nb.style.width=String.format("{0}px",this.cDa),this.Nb.style.overflowX="hidden");this.Nb.offsetHeight>pj.a.x$a||this.ong+50>pj.a.x$a?(this.Nb.style.height=String.format("{0}px",pj.a.x$a),this.Nb.style.overflowY="scroll",this.Nb.style.top="0",Tf.AFrameworkApplication.isRtl?this.Nb.style.right="0":this.Nb.style.left="0",this.cIc||(this.Nb.style.marginTop="-48px"),this.Np.style.minHeight=String.format("{0}px",this.dlg)):(this.Nb.style.overflowY="hidden",
this.Nb.style.top="10%",this.Nb.style.height=this.Zhb);this.F_a()};ha.prototype.F_a=function(){if(this.Nb){var G=this.Nb.style.zIndex;this.Nb.style.zIndex="-9999";if(this.cDa>pj.a.y$a)Tf.AFrameworkApplication.isRtl?this.Nb.style.marginRight="0":this.Nb.style.marginLeft="0";else{var ia=String.format("{0}px",Math.floor(-this.Nb.offsetWidth/2));Tf.AFrameworkApplication.isRtl?this.Nb.style.marginRight=ia:this.Nb.style.marginLeft=ia;Tf.AFrameworkApplication.isRtl?this.Nb.style.right="50%":this.Nb.style.left=
"50%"}this.Nb.style.zIndex=String(G)}else $e.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")};ha.prototype.IO=function(){sj.prototype.IO.call(this);var G=document.getElementById(this.ni(this.nng));G.style.width=String.format("{0}px",this.cDa);G.style.height=this.Zhb};Ek.Object.defineProperties(ha.prototype,{q1a:{configurable:!0,enumerable:!0,get:function(){return this.Np}}});Object(me.a)(ha,"AppsForOfficeInsertionDialog",Vi.a,[400]);var eh=b(1165),ui=Rk.a;Am(La,ui);La.prototype.UEg=
function(G){this.addHandler(La.uCd,G)};La.prototype.Saj=function(G){this.removeHandler(La.uCd,G)};La.prototype.dispose=function(){gl.a.Ha(this.iwa);this.iwa=null;ui.prototype.dispose.call(this)};La.prototype.XZc=function(){this.iwa.hide()};La.prototype.WDj=function(G,ia){if(G){this.raiseEvent(La.uCd);var eb=G.split("|");this.zui(G,ia,eb);this.iwa=new ha;this.iwa.initializeAndShow("",null,null);this.Je.Pqi(this.iwa.q1a,eb)}};La.prototype.wid=function(G,ia,eb){var Fb=Rh.TaskExtensions.hl();if(-515602470===
eb.command||-336193495===eb.command||2086613372===eb.command||-1444574190===eb.command||-1336341324===eb.command||451940422===eb.command)Fb=this.B2h(G,ia,eb);418618014===eb.command&&(ia=new ij.a,ia.gl=gi.a.instance.fa(1784),Fb=this.R0(eb,La.G5h,ia,!0));if((eb.tabName===this.$.Mb+gh.a.yTf||eb.tabName===gh.a.r0)&&2===eb.Ye||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),G[th.a.ld])||G[th.a.ld]===gh.a.NV)return this.r5e(G,eb);if(7===eb.Ye&&G.SourceControlId===this.$.Mb+
gh.a.Qcc)return G.MenuItemId=gh.a.ZGd,this.r5e(G,eb);1221897806===eb.command&&(Fb=this.F2f(eb,"Format"));if(1930653487===eb.command||1172793074===eb.command)Fb=this.F2f(eb,"Data");-1753056834===eb.command&&(Fb=this.Dzj(eb));932597253===eb.command&&($e.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Bi.c(932597253,!0),ia=new ij.a,ia.gl=gi.a.instance.fa(2113),ia.sourceLocationOverrideResourceId=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",
!1)?La.wZi:La.yZi,ia.focusOnIframeWhenLoaded=!0,ia.taskPaneWidth=La.V8e,Fb={},Fb.LaunchSource=Object(Fi.a)(String,G.SourceControlId),Fb.LaunchMode="Default",ia.nI=Fb,Fb=this.R0(eb,La.xZi,ia,!0));301511274===eb.command&&(Fb=this.Nzj(eb));515196233===eb.command&&((ia=this.$.da.Aa(465))&&ia.C7e(),ia=new ij.a,ia.gl=gi.a.instance.fa(2182),Fb={},Fb.SourceUILocation=Bf.a[eb.Ye],ia.nI=Fb,Fb=new mf,Fb.dba=rj.a.p2a,Fb=this.R0(eb,La.JUi,ia,!0,Fb,void 0,ia.gl));1723441034===eb.command&&(ia=new ij.a,ia.gl=gi.a.instance.fa(2194),
ia.focusOnIframeWhenLoaded=!0,ia.taskPaneWidth=La.u1i,Fb=new mf,Fb.dba=rj.a.dph,Fb=this.R0(eb,La.t1i,ia,!0,Fb));Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&G.LoadDataFromPictureTaskpane&&(ia={},Fb=new ij.a,Fb.gl=gi.a.instance.fa(2220),ia.SessionID=G.SessionID,Fb.nI=ia,Fb.focusOnIframeWhenLoaded=!0,Fb=this.R0(eb,G.DataFromPictureAssetId,Fb,!0));return Fb};La.prototype.insertAgave=function(G,ia){var eb=this,Fb=Rh.TaskExtensions.hl(),Oc=this.$,Tc=G[Hg.a.Sra];
if("SourceControlId"in G){var Md={};$e.ULS.sendTraceTag(523819228,220,15,"insertAgave with SourceControlId called.");var Qd=G.SourceControlId.split("|");if(8!==Qd.length||!(Qd[0]&&Qd[1]&&Qd[2]&&!isNaN(parseInt(Qd[2],10))&&Qd[3]&&!isNaN(parseInt(Qd[3],10))&&Qd[4]&&Qd[5]&&!isNaN(parseInt(Qd[5],10))&&Qd[6]&&Qd[7]))return Rh.TaskExtensions.L4();Tc={};Tc.version=Md.Version=Qd[0];Tc.assetId=Md.AssetId=Qd[1];Tc.solutionId=Md.SolutionId=Qd[1];Tc.height=Md.Height=parseInt(Qd[2],10);Tc.width=Md.Width=parseInt(Qd[3],
10);Tc.storeId=Md.StoreId=Qd[4];Tc.targetType=Md.TargetType=parseInt(Qd[5],10);Tc.assetStoreId=Md.AssetStoreId=Qd[6];Tc.storeType=Md.StoreType=Qd[7]}else Md=G[th.a.Cg];Qd=null;mf.key in G&&(Qd=G[mf.key]);this.iwa&&this.iwa.hide();if(!Md||!Tc)return $e.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Fb;this.$.y5&&gh.a.ioa in G&&(Md.EnabledInViewMode=G[gh.a.ioa]);G=this.YKh(ia.command);if(!Md.EnabledInViewMode&&!Oc.Cq(null,!1,G))return Fb;var Je=void 0===Md.IsToBePersisted||
null===Md.IsToBePersisted||Md.IsToBePersisted?0:16;if(1===Md.TargetType)Fb=this.Qbi(Md,Tc,ia,Qd,Je);else{Tc=zj.g(Oc);Fb=this.viewBlockContainerHelpers.Gfb(Tc);var kf=Oc.ea.isNamedObjectViewMode?Oc.qa.sheetName:Oc.qa.name;if(Fb){Tc=Fb.tf;var xf=Tc.uf.top;var og=Tc.uf.left;var Ug=Fb.vG.x;var kh=Fb.vG.y}else xf=og=1,Fb=this.viewBlockContainerHelpers.IKa(Tc),Ug=Fb.x,kh=Fb.y;var Yi=this.$.na.ua.hc();Fb=function(Ah,yi,Ki){var Rj=Oc.na.ua,ej=Md,tj=xf,fk=og,pk=Ug,qk=kh;Ah=Bh.b(Ah,eb.nZi);var Fj=Rj.Na(9,Yi);
Fj.sharedInfo=ej;Fj.sheetName=kf;Fj.positionRow=tj;Fj.positionCol=fk;Fj.positionOffsetX=pk;Fj.positionOffsetY=qk;return Yh.i(Rj,"InsertWebExtension",Fj,Ah,yi,Ki,null,0)};Ag.EwaSettings.qc()?(Je|=64,Fb=Si.a(this.$.userOperationManager,Fb,function(Ah){return new Lh.a(534,0,Ah,Je)},ia)):Fb=Si.a(this.$.userOperationManager,Fb,function(Ah){return new Yg.a(534,0,Ah,Je)},ia)}return Fb};La.prototype.l1g=function(){var G=mc.a.instance.lc("Common.App.ICustomerFeedbackUiWrapper"),ia=mc.a.instance.lc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");
this.Z$c?this.Z$c.zjb?this.Hwe():ia.instance.d7c(this.Eyh):$e.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");ia={};Tf.AFrameworkApplication.ga.Cle(ia);G=G.instance.getContext(ia);ia={};"telemetryGroup"in G&&(ia=G.telemetryGroup);ia.processSessionId=G.sessionId;ia.officeBuild=G.build;G.telemetryGroup=ia;G.feedbackType=-1;G.userVoiceEnabled=!1;"disableIncludeScreenshot"in G||(G.disableIncludeScreenshot=!1);"screenshot"in G||(G.screenshot=!1);G.disableScreenshotPreview=!1;G.includeScreenshotSelectedDefault=
!0;return G};La.prototype.LZi=function(G){if(!this.hza&&Ag.EwaSettings.ma(712)&&Ag.EwaSettings.getBooleanFeatureGate(La.z7h,!1)){var ia=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";ia=this.oue(ia);var eb=new mf;eb.Qk=rj.a.N8b;this.hza=this.HMd(ia,null,!1,null,eb);ia={};bj.b(this.$).Vd(Ei.a.MZi,(ia.Location=Bf.a[G.Ye],ia.InputMethod=Bg.a[G.method],ia),void 0,!0)}};La.prototype.JYf=function(G){var ia=this.$.ea.Zg.get(17);
mc.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(eb){eb.isFeatureEnabled("mso_sendASmile",ia).then(function(Fb){G.FeedbackEnabled=ia&&Fb;return null})})};La.prototype.F2f=function(G,ia){var eb=zj.g(this.$),Fb=new ij.a,Oc={};Oc.ActiveTab=ia;Oc.DatapaneFlighting=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);Oc.RangePickerFlighting=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",
!1);Oc.AceFlighting=!0;Oc.ChartNewSDXRecording=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);Oc.ThemeColorsFlighting=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");Oc.UOMirror=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);Oc.FormatTaskPaneAceButtonDark=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",
!1);Oc.FormatTaskPaneBetterFeedbackButton=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);Oc.FormatTaskPaneBetterScrollbar=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);this.JYf(Oc);Oc.startTimeMs=Date.now();Oc.UserSessionId=this.$.ya.UserSessionId;(ia=eb.ha.Oa.No)&&(Oc.SubSelection=ia);$e.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",
Oc.UserSessionId,void 0===G.Ye||null===G.Ye?"Null":Bf.a[G.Ye],ia||"ChartRoot");Fb.nI=Oc;Fb.gl=gi.a.instance.fa(966);Oc=new mf;Oc.dba=rj.a.p2a;return this.R0(G,La.$Vg,Fb,!0,Oc)};La.prototype.Dzj=function(G){var ia=new ij.a;ia.nI={};ia.gl=gi.a.instance.fa(1772);ia.LS=La.jkf;var eb=new mf;eb.dba=rj.a.p2a;return this.R0(G,La.jkf,ia,!0,eb,void 0,ia.gl)};La.prototype.Nzj=function(G){var ia=new ij.a;ia.nI={};ia.gl=gi.a.instance.fa(2137);var eb=new mf;eb.dba=rj.a.Sqh;eb.rNb=rj.a.UNe;return this.R0(G,La.ZBi,
ia,!0,eb)};La.prototype.r5e=function(G,ia){var eb=La.w7e,Fb=G[th.a.ld].toString(),Oc={},Tc=new ij.a;Tc.gl=gi.a.instance.fa(9);switch(Fb){case "A0":Oc.query=(G[th.a.Cg]||"").split("|").slice(2,Nh.a.fT).join("|");break;case "A1":Oc.query=G.CommandValueId;break;case "Help":Oc.gwdropdownflightinfo=Ag.EwaSettings.ma(240);Oc.query="";break;case gh.a.ZGd:Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(Tc.gl=gi.a.instance.fa(1738),Tc.sourceLocationOverrideResourceId=
La.f4e,Oc.feedback=this.l1g()):Oc.query=Fb;break;case "HelpArticle":Oc.query=G[th.a.Cg];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":Oc.query=Fb;break;default:return ik.Task.Sa(!0)}Tc.nI=Oc;Fb=new mf;Fb.dba=rj.a.p2a;return this.R0(ia,eb,Tc,!1,Fb,G[gh.a.ioa]||!1)};La.prototype.oue=function(G){var ia={Version:"0.0.0.0"};ia.AssetId=La.dwa;ia.SolutionId=La.dwa;ia.AssetStoreId="";ia.StoreType=OSF.StoreType.Sdx;ia.Height=0;ia.Width=0;ia.StoreId=OSF.StoreType.Sdx;ia.TargetType=OSF.OsfControlTarget.TaskPane;
ia.IsToBePersisted=!1;ia.SourceLocationOverrideResourceId=G;ia.SharedRuntimeId=G;return ia};La.prototype.B2h=function(G,ia,eb){function Fb(){Qd.LaunchMode="Default";Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Tc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Tc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Tc.gl=gi.a.instance.fa(1783);Tc.LS=La.tWc;Tc.Qk=rj.a.N8b;Md.Qk=rj.a.N8b}var Oc=this,Tc=new ij.a,Md=new mf,Qd={};this.hza&&this.JYf(Qd);
Qd.LaunchSource="";Qd.StartTimeMs=Date.now();Qd.CorrelationId=Xf.a.create().toString();Tc.nI=Qd;Tc.focusOnIframeWhenLoaded=!0;Tc.taskPaneWidth=La.V8e;Md.dba=rj.a.Pqh;Md.rNb=rj.a.RNe;switch(eb.command){case -1444574190:var Je,kf;Qd.LaunchMode="RecommendedPivotTables";Qd.SelectionContext="";Qd.LaunchSource="PivotTableHandRaise"===Object(Fi.a)(String,G.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&
G.SourceSelection){var xf=G.SourceSelection.split(",")[0];ia=Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var kh=Eh.Z(xf,Oc.$.xa);Je=kh.sheetName;kf=kh.ZGb;og=kh.range;return kh}().returnValue&&!zj.g(this.$).Rb.Gka(og))G=this.$.xa.getItemByName(Je),Qd.SelectionContext=JSON.stringify(Object($f.a)(new gb,{address:kf,addressWithSheet:Je+"!"+og.pB(!1),sheetId:Oh.d(G),sheetName:Je,isSheetEmpty:!1,columnCount:og.width,rowCount:og.height,columnIndex:og.left+
ia,rowIndex:og.top+ia,selectionType:"Continuous"}));else if((G=this.$.Hb.getItemByName(Object(Fi.a)(String,G.SourceSelection)))&&Oh.n(G)){var og=Ti.a(G,!0);var Ug=this.$.xa.getItemByName(G.sheetName);Qd.SelectionContext=JSON.stringify(Object($f.a)(new Ia,{tableName:G.name,hasTableHeaders:Ti.d(G),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:og.pB(!1),addressWithSheet:Ug.name+"!"+og.pB(!1),sheetId:Oh.d(Ug),sheetName:Ug.name,isSheetEmpty:!1,columnCount:og.width,rowCount:og.height,columnIndex:og.left+
ia,rowIndex:og.top+ia,selectionType:"Continuous"}))}}Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Tc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":Tc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";Tc.gl=gi.a.instance.fa(1782);Tc.LS=La.NXi;Tc.Qk=rj.a.mQe;Md.Qk=rj.a.mQe;break;case -336193495:Qd.LaunchMode="RecommendedCharts";Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Tc.sourceLocationOverrideResourceId=
"RecommendCharts.PPE.Bundle":Tc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";Tc.gl=gi.a.instance.fa(1781);Tc.LS=La.H5i;Tc.Qk=rj.a.nQe;Md.Qk=rj.a.nQe;break;case -1336341324:if(!Ag.EwaSettings.ma(485))return ik.Task.Sa(!1);Qd.LaunchMode="NL";Tc.LS=La.tWc;Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Tc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":Tc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(Ag.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",
0)){case 1:Tc.gl=gi.a.instance.fa(1786);Qd.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:Tc.gl=gi.a.instance.fa(1787);Qd.NLLaunchModeBrandingCandidatesIndex=2;break;default:Tc.gl=gi.a.instance.fa(1785),Qd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!Ag.EwaSettings.ma(235))return ik.Task.Sa(!1);Qd.LaunchMode="ChartDesigner";Qd.LaunchSelectionMode=ia.toString();Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Tc.sourceLocationOverrideResourceId=
"Insights.Https.PPE.Bundle":Tc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Tc.gl=gi.a.instance.fa(1788);Tc.LS=La.tWc;break;case 451940422:Qd.LaunchSource="AutoFilter";ia=JSON.parse(G.CommandValueId);Qd.AutoFilterSource=JSON.stringify({autoFilterRange:{sheetName:ia.AutoFilterRange.SheetName,firstColumn:ia.AutoFilterRange.FirstColumn,lastColumn:ia.AutoFilterRange.LastColumn,firstRow:ia.AutoFilterRange.FirstRow,lastRow:ia.AutoFilterRange.LastRow},Iob:ia.AutoFilterType,HZj:ia.ItemIndex,id:ia.Id});
Fb();break;default:Ag.EwaSettings.ma(235)&&(Qd.LaunchSelectionMode=ia.toString()),Fb()}return Ag.EwaSettings.ma(712)?(Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Tc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Tc.sourceLocationOverrideResourceId="Insights.Https.Bundle",this.hza?this.hza.CWR(function(){return Oc.LWf(Qd,Tc)}):this.Y$h(eb,Tc,Md,Qd)):this.R0(eb,La.dwa,Tc,!0,Md)};La.prototype.Y$h=function(G,ia,eb,Fb){var Oc=this;this.hza=this.HMd(this.oue(ia.sourceLocationOverrideResourceId),
ia,!1,G,eb,!1);return Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(Fb.NoActionMsgOnFirstInstance=!0,this.NRa[La.dwa]=Fb,this.hza):this.hza.CWR(function(){return Oc.LWf(Fb,ia)})};La.prototype.LWf=function(G,ia){var eb=this.Je.Aaa(this.Je.m3a(La.dwa,ia.sourceLocationOverrideResourceId));if(eb){this.NRa[La.dwa]=G;var Fb=this.xwd(this.Je.FZ(eb).OsfPropertyBag,La.dwa);this.Je.FZ(eb).OsfPropertyBag=Fb}this.yNa(La.dwa,"LaunchIdeasAction",G,ia);return ik.Task.Sa(!0)};
La.prototype.R0=function(G,ia,eb,Fb,Oc,Tc,Md){eb=void 0===eb?null:eb;Fb=void 0===Fb?!1:Fb;Oc=void 0===Oc?null:Oc;Tc=void 0===Tc?!1:Tc;Md=void 0===Md?null:Md;Rh.TaskExtensions.hl();eb||(eb=new ij.a);var Qd={Version:"0.0.0.0"};Qd.AssetId=ia;Qd.SolutionId=ia;Qd.AssetStoreId="";Qd.StoreType=Fb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Qd.Height=0;Qd.Width=0;Qd.StoreId=Fb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Qd.TargetType=OSF.OsfControlTarget.TaskPane;Qd.IsToBePersisted=!1;Qd.SourceLocationOverrideResourceId=
eb.sourceLocationOverrideResourceId;if(eb.gl||Md)this.Sad[ia]=Object($f.a)(new Sb,{Qzc:eb.gl,iVd:Md,Ozc:eb.LS});Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(eb.nI||(eb.nI={}),eb.nI.ShowFeedback=this.$.isFeedbackEnabled,this.NRa[ia]=eb.nI):eb.nI&&(this.NRa[ia]=eb.nI);ia={};ia[th.a.Cg]=Qd;Md={};Md.solutionId=Qd.SolutionId;Md.version=Qd.Version;Md.storeType=Qd.StoreType;Md.storeId=Qd.StoreId;Md.assetId=Qd.AssetId;Md.assetStoreId=
Qd.AssetStoreId;Md.height=Qd.Height;Md.targetType=Qd.TargetType;Md.width=Qd.Width;Md.isAddinCommands=!Fb;ia[Hg.a.Sra]=Md;Oc||(Oc=new mf);Oc.focusOnIframeWhenLoaded=eb.focusOnIframeWhenLoaded;Oc.width=eb.taskPaneWidth;ia[mf.key]=Oc;ia[gh.a.ioa]=Tc;return this.insertAgave(ia,G)};La.prototype.Qbi=function(G,ia,eb,Fb,Oc){function Tc(xf){$e.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(xf.solutionId,xf.storeType,xf.assetId,null,
null,xf.storeId),xf.storeType);var og={},Ug=new gg.a;Ug.add(xf);og[Hg.a.Jnb]=Ug;og[Hg.a.hU]=3;xf=new Bk.a(kj.a.vBb,0,Qd.$.ed,0,null);return Qd.$.Ka.Xb(xf,og)}function Md(xf,og){var Ug=xf.SolutionId;var kh=OSF.OsfControl.isFirstPartyStoreString(xf.StoreType);kh&&xf.SourceLocationOverrideResourceId&&(Ug=Qd.Je.m3a(Ug,xf.SourceLocationOverrideResourceId));var Yi=Qd.Je.Dxe(Ug,null,xf.SharedRuntimeId);kh&&(Ag.EwaSettings.ma(296)&&Yi&&(kh=Qd.Je.Aaa(Ug))&&(Ug=null,Ug=Qd.xwd(Qd.Je.FZ(kh).OsfPropertyBag,xf.SolutionId),
(kh=Qd.Je.Fi.getOsfControl(kh))&&kh.setSettings(Ug)),xf.SharedRuntimeId&&Yi||Qd.Je.Fi.refreshOsfControl(xf.SolutionId,xf.SourceLocationOverrideResourceId));if(!Yi){var Ah=Qd.$.na.ua.hc(),yi=519;Yi=function(Ki,Rj,ej){var tj=Qd.$.na.ua;Ki=Bh.b(Ki,Qd.aHf);var fk=tj.Na(9,Ah);fk.sharedInfo=xf;return Yh.i(tj,"InsertAgaveTaskpane",fk,Ki,Rj,ej,Fb,0)};void 0===xf.IsToBePersisted||null===xf.IsToBePersisted||xf.IsToBePersisted||(yi=538,Yi=function(Ki,Rj,ej){$e.ULS.sendTraceTag(537170442,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",
xf.StoreType,xf.StoreId,Telemetry.PrivacyRules.GetPrivacyCompliantId(xf.SolutionId,xf.StoreType,xf.AssetId,null,null,xf.StoreId));var tj=Qd.$.na.ua;Ki=Bh.b(Ki,Qd.aHf);var fk=tj.Na(9,void 0===Ah?null:Ah);fk.sharedInfo=xf;return Yh.i(tj,"ShowAgaveTaskpane",fk,Ki,Rj,ej,Fb,0)});return Ag.EwaSettings.qc()?(Oc|=64,Si.a(Qd.$.userOperationManager,Yi,function(Ki){return new Lh.a(yi,0,Ki,Oc)},og)):Si.a(Qd.$.userOperationManager,Yi,function(Ki){return new Yg.a(yi,0,Ki,Oc)},og)}return Rh.TaskExtensions.L4()}
var Qd=this;if(!Ag.EwaSettings.ma(54)||G.StoreId===OSF.StoreType.FirstParty)return Md(G,eb,Fb);if(ia.isAddinCommands)return Tc(ia);var Je=new mk.a,kf={};kf.marketplaceId=G.SolutionId;kf.marketplaceVersion=G.Version;kf.storeType=G.StoreType;kf.storeId=G.StoreId;kf.targetData=G;Ag.EwaSettings.ma(94)&&(kf.clearCache=!0);this.Je.Fi.isAddinCommandsAsync(kf,function(xf,og,Ug){Je.setResult(og);xf||(xf=Ug.targetData,$e.ULS.sendTraceTag(537170438,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",
Telemetry.PrivacyRules.GetPrivacyCompliantId(xf.SolutionId,xf.StoreType,xf.AssetId,null,null,xf.StoreId),xf.StoreType))});return Rh.TaskExtensions.ts(Je.task,function(xf){return xf.result?Tc(ia):Md(G,eb,Fb)},this.$.la)};La.prototype.xwd=function(G,ia){if(!this.NRa[ia])return G;var eb={};if(G){G=El(G);for(var Fb=G.next();!Fb.done;Fb=G.next())Fb=Fb.value,eb[Fb[0]]=Fb[1]}G=this.NRa[ia];Fb=El(Object.keys(G));for(ia=Fb.next();!ia.done;ia=Fb.next())ia=ia.value,ia===La.Gyh&&Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?eb[ia]=Sys.Serialization.JavaScriptSerializer.serialize(G[ia]):eb[ia]=Sys.Serialization.JavaScriptSerializer.serialize(G[ia].toString());ia=Object.keys(eb).length;G=Array(ia);Fb=0;var Oc=El(Object.keys(eb));for(ia=Oc.next();!ia.done;ia=Oc.next())ia=ia.value,G[Fb]=[ia,eb[ia].toString()],Fb++;return G};La.prototype.zui=function(G,ia,eb){var Fb=this.$.ya.UserSessionId,Oc=this.$.ya.UICultureTag,Tc=this.$.ya.UICultureTagLcid,Md=this.$.ya.WacHostId,Qd="",Je="";5<=eb.length&&(Qd=eb[3],Je=eb[4]);this.Aui(Qd,
Je,G,ia,Oc,Tc,Fb,Md)};La.prototype.Aui=function(G,ia,eb,Fb,Oc,Tc,Md,Qd){var Je={};Je.a=Md;Je.b=eb;Je.c=Fb;Je.d=G;Je.e=ia;Je.f=Oc;Je.g=Tc;Je.h=Qd;Nj.b().Qe(36,Je)};La.prototype.Hwe=function(){if(xg.a.Bsf())$e.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.eHf);return}catch(G){$e.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(G?G.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,
null)().then(this.eHf)}catch(G){$e.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(G?G.toString():null))}}};La.prototype.HMd=function(G,ia,eb,Fb,Oc,Tc){ia=void 0===ia?null:ia;eb=void 0===eb?!1:eb;Fb=void 0===Fb?null:Fb;Oc=void 0===Oc?null:Oc;Tc=void 0===Tc?!0:Tc;var Md=G.SolutionId,Qd=ik.Task.Sa(!1);G&&Md&&G.SharedRuntimeId&&(Fb=Fb||new Bk.a(-859308420,0,2,0,""),Md={},Md.solutionId=G.SolutionId,Md.version=G.Version,Md.storeType=G.StoreType,Md.storeId=G.StoreId,Md.assetId=G.AssetId,
Md.assetStoreId=G.AssetStoreId,Md.height=G.Height,Md.targetType=G.TargetType,Md.width=0,Md.isAddinCommands=!1,Md.sharedRuntimeId=G.SharedRuntimeId,G.Preload=Tc,Oc=Oc?Oc:new mf,Oc.width=0,ia&&(Oc.focusOnIframeWhenLoaded=ia.focusOnIframeWhenLoaded,Tc=new Sb,ia.gl&&(Tc.Qzc=ia.gl),0<ia.taskPaneWidth&&(Tc.Cu=ia.taskPaneWidth),ia.LS&&(Tc.Ozc=ia.LS),this.Sad[G.SolutionId]=Tc),ia={},ia[th.a.Cg]=G,ia[Hg.a.Sra]=Md,ia[mf.key]=Oc,ia[gh.a.ioa]=eb,Qd=this.insertAgave(ia,Fb));return Qd};La.prototype.yNa=function(G,
ia,eb,Fb){Fb=void 0===Fb?null:Fb;if(G&&ia){G=new Qc.a(G,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var Oc=new Le.a("ExcelOnline","Web",this.$.ya.UICultureTag),Tc=new Id.a;Tc.oi[le.yTc]=eb;Fb&&(eb=Fb,eb.sourceLocationOverrideResourceId&&(Tc.oi[le.sourceLocationOverrideResourceId]=eb.sourceLocationOverrideResourceId),eb.gl&&(Tc.oi[le.gl]=eb.gl),eb.Qk&&(Tc.oi.IconCssClass=eb.Qk),eb.eVd&&(Tc.oi.TaskPaneIconUrl=eb.eVd),eb.LS&&(Tc.oi.TaskPaneIconId=eb.LS));cd.a.instance.yNa(G,ck.a.action,ia,Oc,Tc)}};
La.prototype.zTh=function(G){if(!sf.a.Fh(G)){var ia=G[eh.a.i9b];if(ia&&(ia=ia.getId(),G=G[eh.a.Sya],ia&&G))return this.m3a(ia,G.oi[le.sourceLocationOverrideResourceId])}return null};La.prototype.m3a=function(G,ia){ia=void 0===ia?null:ia;return G&&ia?String.format("{0}.{1}",G,ia):G};La.prototype.YKh=function(G){switch(G){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return Ag.EwaSettings.ma(235)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;
case 515196233:return 1023;default:return 1}};La.z7h="Microsoft.Office.Excel.IdeasXLOPreload";La.uCd="IDS";La.w7e="FA000000012";La.dwa="FA000000005";La.G5h="HelloWorld";La.$Vg="FA000000014";La.f4e="Help.GiveFeedback.Url";La.Gyh="feedback";La.jkf="FA000000066";La.yZi="PowerBi.Url";La.wZi="PowerBi.DevUrl";La.xZi="FA000000054";La.ZBi="FA000000064";La.JUi="FA000000075";La.t1i="FA000000080";La.tWc="AnalyzeDataTaskPane";La.H5i="RecommendedChartsTaskPane";La.NXi="PivotTableTaskPane";La.och=350;La.V8e=320;
La.u1i=320;Object(me.a)(La,"AgaveCommandManager",Rk.a,[606,607]);Ek.Object.defineProperties(mb,{instance:{configurable:!0,enumerable:!0,get:function(){return mb.Ma}}});mb.Ma=new mb;Object(me.a)(mb,"AppsDataManagerFactory",null,[]);Object(me.a)(function(G,ia){this.httpStatus=G;this.data=ia},"AppData",null,[]);Ra.prototype.tyb=function(G){this.skg(this.ukg,G)};Ra.prototype.wS=function(G,ia,eb,Fb){0===G?this.vb&&this.Mg&&ia?this.Mg.El(String.format("{0}AppsForOfficeProxy.ashx?lcid={1}&syslcid={1}&uilcid={1}&rt=xml&client={2}&cv=16.1.0.0",
this.vb.appSettings.WebServiceBase,Tf.AFrameworkApplication.lcid,ia),1,"",null,!0,2,eb,Fb,null):$e.ULS.sendTraceTag(6070476,344,10,"The request objects are not available"):(ia={},$e.ULS.sendTraceTag(6070477,344,15,"The request datatype is not supported.  {0}",(ia.dataType=G,ia)))};Object(me.a)(Ra,"AppsDataProvider",null,[398]);var cj=ng.a;Am(Ha,cj);Ha.prototype.create=function(){var G=this,ia=this.$.da,eb=jj.GetServiceTaskFactory.create(ia,106,this.la,this.ub),Fb=jj.GetServiceTaskFactory.create(ia,
104,this.la,this.ub),Oc=Zj.a.loadScript(36,0,this.ub,void 0,void 0,375);Rh.TaskExtensions.Ba(Rh.TaskExtensions.ye([Fb,eb,Oc],this.la),function(){var Tc=new md(Sk.a.instance),Md=new Ra(Tf.AFrameworkApplication.ga,Tf.AFrameworkApplication.Jd,"WAC_Excel");new tc(Tc,Md,"PreinstalledAppsData_Excel");Tc=null;Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Tc=mc.a.instance.lc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);wc.instance.initialize(eb.result);
Tc=new La(G.$,eb.result,Fb.result,Tc,Tf.AFrameworkApplication.Ib);ia.Ga(206,Tc);G.Eb(ia.Aa(374)||ia.Ga(374,Tc))},this.la,3);mc.a.instance.register(Vd.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Hc().Oc(function(){return new Vd.a(G.$.uw)})};Ha.ka=function(G){G.da.Ga(375,new Ha(G))};Object(me.a)(Ha,"AgaveCommandManagerFactory",ng.a,[]);var dj=b(626);Xa.prototype.initialize=function(G){Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)&&!this.initialized&&this.wij(G)};Xa.prototype.vbi=function(G,ia){var eb=Rh.TaskExtensions.hl();if(this.initialized&&G&&0<G.length){var Fb=this.XHh(G);G in this.JU&&(eb=this.agaveCommandManager.insertAgave(Fb,ia))}return eb};Xa.prototype.Kzg=function(G){var ia=this;this.initialized&&(G=G[th.a.Cg]||{},!G.SolutionId||G.SolutionId in this.JU||this.Je.Wca(function(eb){ia.Wca(eb)},!0))};Xa.prototype.A3h=function(G){var ia=this;this.initialized&&(G=G||"")&&0<G.length&&G in this.JU&&(delete this.JU[G],
this.Je.Wca(function(eb){ia.Wca(eb)},!0))};Xa.prototype.XHh=function(G){return G in this.JU?this.JU[G]:{}};Xa.prototype.Wca=function(G){var ia=!1;if(G&&!G.errorCode){if(G.value){G=El(G.value);for(var eb=G.next();!eb.done;eb=G.next()){eb=eb.value;var Fb=eb[1];eb[3]==OSF.OsfControlTarget.InContent&&Fb&&0<Fb.length&&!(Fb in this.JU)&&(ia={NoReporting:!1,IsSystemInitiated:!1},ia.description=eb[2],ia.iconUrl=eb[9],ia[Hg.a.Sra]={solutionId:eb[1],version:eb[4],storeType:eb[6],storeId:eb[11],assetId:eb[5],
assetStoreId:eb[6],targetType:eb[3],width:eb[7],height:eb[8],displayName:eb[0],id:eb[1],appVersion:eb[4],currentStoreType:eb[6]},ia[th.a.Cg]={SolutionId:eb[1],Version:eb[4],StoreType:eb[6],StoreId:eb[11],AssetId:eb[5],AssetStoreId:eb[6],TargetType:eb[3],Width:eb[7],Height:eb[8],Id:eb[1],AppVersion:eb[4],CurrentStoreType:eb[6]},this.JU[Fb]=ia,ia=!0)}}ia&&this.b5g()}};Xa.prototype.b5g=function(){var G=[],ia;for(ia in this.JU)G.push({id:ia,controlType:0,title:this.JU[ia][Hg.a.Sra].displayName});if(0<
G.length){for(var eb in this.JU)appChrome.addInApi.registerAddinIcon("AddinIcon_"+eb,this.JU[eb].iconUrl);this.mXg();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:Xa.Isf,isOfficeTab:!0,groups:[{id:Xa.Z$e,title:Xa.$$e,controls:G}]}]});for(var Fb in this.JU)this.f0a.addCommandToMaps(Object($f.a)(new el.a(Fb,"-1473679467"),{legacyControlId:Fb}))}};Xa.prototype.mXg=function(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:Xa.Isf,isOfficeTab:!0,groups:[{id:Xa.Z$e,title:Xa.$$e,
controls:[]}]}]})};Xa.prototype.wij=function(G){var ia=this,eb=jj.GetServiceTaskFactory.Va(G.da,374,375,1),Fb=jj.GetServiceTaskFactory.create(G.da,106,G.la,1);Rh.TaskExtensions.Ba(Rh.TaskExtensions.ye([eb,Fb],G.la),function(){ia.agaveCommandManager=eb.result;ia.f0a=mc.a.instance.Kh("Common.IExternalUICommandDefinitionMapping")||new dj.a(G.Mb,G);Tf.AFrameworkApplication.Ib.fc(kj.a.iOf,Ie.a.frame,function(Oc,Tc,Md,Qd,Je){ia.A3h(Je)});ia.Je=Fb.result;ia.Je.Wca(function(Oc){ia.Wca(Oc)},!0);ia.initialized=
!0},G.la,3)};Xa.Isf="tabinsert";Xa.Z$e="installedContentAddins";Xa.$$e=gi.a.instance.fa(2228);Object(me.a)(Xa,"AgaveCommandRibbon",null,[545]);var Pj=ng.a;Am(qa,Pj);qa.prototype.create=function(){if(Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){var G=this.$.da,ia=new Xa;ia.initialize(this.$);this.Eb(G.Aa(488)||G.Ga(488,ia))}};qa.ka=function(G){G.da.Ga(489,new qa(G))};Object(me.a)(qa,"AgaveCommandRibbonFactory",ng.a,[]);var hi=b(944);
Aa.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};Aa.prototype.invokePropertyGet=function(G){switch(G){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Aa.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Aa.prototype.invokePropertySet=
function(G,ia){switch(G){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};Aa.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Aa.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Aa.prototype.invokeMethodAsync=function(G,ia){G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Aa.n6g=function(G){var ia=new Aa;ia.displayName=G.displayName;ia.email=G.email;switch(G.authority){case Ig.eEf:ia.identityType=
1;break;default:ia.identityType=0}ia.federationProvider="";return ia};Ek.Object.defineProperties(Aa.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.jfa},set:function(G){this.jfa=G}},email:{configurable:!0,enumerable:!0,get:function(){return this.J5d},set:function(G){this.J5d=G}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.p6d},set:function(G){this.p6d=G}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.$ib},set:function(G){this.$ib=
G}}});Object(me.a)(Aa,"OfficeIdentityInfo",null,[]);Nb.fbc=function(G){return G in Nb.ZLe?Nb.ZLe[G].toString():G};Ek.Object.defineProperties(Nb,{ZLe:{configurable:!0,enumerable:!0,get:function(){return Nb.Lng}}});Nb.map=null;var ei={};Nb.Lng=(ei.GeneralException=hi.a.generalException,ei.AccessDenied=hi.a.uTc,ei.ApiNotAvailable=hi.a.apiNotAvailable,ei.UserNotSignedIn=hi.a.userNotSignedIn,ei.UserAborted=hi.a.userAborted,ei.UnsupportedUserIdentity=hi.a.gPj,ei.InvalidResourceUrl=hi.a.invalidResourceUrl,
ei.InvalidGrant=hi.a.invalidGrant,ei.AddinIsAlreadyRequestingToken=hi.a.qHg,ei.ResourceNotAllowed=hi.a.rgj,ei.ClientError=hi.a.clientError,ei.ServerError=hi.a.serverError,ei);Object(me.a)(Nb,"SingleSignOnErrorCodeMap",null,[]);lb.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};lb.prototype.invokePropertyGet=function(G){switch(G){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};lb.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};lb.prototype.invokePropertySet=function(G,ia){switch(G){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};lb.prototype.invokePropertySetAsync=
function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};lb.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};lb.prototype.invokeMethodAsync=function(G,ia){G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Ek.Object.defineProperties(lb.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.kQb},set:function(G){this.kQb=
G}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.$ib},set:function(G){this.$ib=G}}});Object(me.a)(lb,"SingleSignOnToken",null,[]);kb.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};kb.prototype.invokePropertyGet=function(G){switch(G){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};kb.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};kb.prototype.invokePropertySet=function(G,ia){switch(G){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");
return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};kb.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
kb.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};kb.prototype.invokeMethodAsync=function(G,ia){G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Ek.Object.defineProperties(kb.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.a2d},set:function(G){this.a2d=G}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.WD},set:function(G){this.WD=G}},
policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.VVb},set:function(G){this.VVb=G}},scope:{configurable:!0,enumerable:!0,get:function(){return this.Lfe},set:function(G){this.Lfe=G}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.Xge},set:function(G){this.Xge=G}}});Object(me.a)(kb,"TokenParameters",null,[630]);Gb.prototype.getAccessToken=function(G){var ia=this,eb=this.zhb.getOsfControl(this.xA),
Fb=eb.getManifest(),Oc=Fb.getMarketplaceID();this.RNa(G,Oc);return OfficeExtension.WacRuntime.Utility.createPromise(function(Tc,Md){eb.isFirstParty()&&ia.zhb._enableFirstPartySSO?ia.pei(Fb,G)?mc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(G,Oc).then(function(Qd){Tc(Qd)},function(Qd){Md(Qd)}):Md(hi.a.uTc):Md(hi.a.apiNotAvailable)}).then(function(Tc){switch(Tc.authority){case Ig.eEf:var Md=1;break;default:Md=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new lb(Tc.accessToken,
Md))},function(Tc){ia.logErrorResponse(G,Oc,Tc);return Tc?OfficeExtension.WacRuntime.Utility.createPromise(function(Md,Qd){Qd(OfficeExtension.WacRuntime.Utility.createRichApiException(Tc,Nb.fbc(Tc)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(Md,Qd){Qd(OfficeExtension.WacRuntime.Utility.createRichApiException(hi.a.generalException,Nb.fbc(hi.a.generalException)))})})};Gb.prototype.getAuthContext=function(){return null};Gb.prototype.getPrimaryIdentityInfo=function(){var G=this.zhb.getOsfControl(this.xA);
G.getManifest();var ia=G.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(eb,Fb){mc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(ia).then(function(Oc){eb(Oc)},function(Oc){Fb(Oc.toString())})}).then(function(eb){eb=Aa.n6g(eb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(eb)},function(eb){return eb?OfficeExtension.WacRuntime.Utility.createPromise(function(Fb,Oc){Oc(OfficeExtension.WacRuntime.Utility.createRichApiException(eb,
Nb.fbc(eb)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(Fb,Oc){Oc(OfficeExtension.WacRuntime.Utility.createRichApiException(hi.a.generalException,Nb.fbc(hi.a.generalException)))})})};Gb.prototype.getTypeName=function(){return"Microsoft.Authentication.AuthenticationService"};Gb.prototype.invokePropertyGet=function(G){switch(G){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Gb.prototype.invokePropertyGetAsync=function(G){G=
this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Gb.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Gb.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Gb.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Gb.prototype.invokeMethodAsync=
function(G,ia){switch(G){case 1:return this.qHh(ia);case 3:return this.GIh();case 2:return this.zUh()}G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Gb.prototype.qHh=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,kb);return this.getAccessToken(G)};Gb.prototype.GIh=function(){return this.getAuthContext()};Gb.prototype.zUh=function(){return this.getPrimaryIdentityInfo()};Gb.prototype.pei=function(G,ia){var eb=!1,Fb=G.getWebApplicationAuthorizations();
G=null;Fb=El(Fb);for(var Oc=Fb.next();!Oc.done;Oc=Fb.next())if(Oc=Oc.value,Oc.getResource().toLowerCase()===ia.resource.toLowerCase()){G=Oc;eb=!0;break}if(!eb)return!1;ia=ia.scope.split(" ,+");ia=El(ia);for(eb=ia.next();!eb.done;eb=ia.next())if((eb=eb.value)&&eb.length){Fb=!1;Oc=El(G.getScopes());for(var Tc=Oc.next();!Tc.done;Tc=Oc.next())eb.toLowerCase()===Tc.value.toLowerCase()&&(Fb=!0);if(!Fb)return!1}return!0};Gb.prototype.RNa=function(G,ia){G=this.usf(G.resource);var eb={};$e.ULS.sendTraceTag(538572831,
369,50,"{0}",(eb.manifestId=ia,eb.resource=G,eb))};Gb.prototype.logErrorResponse=function(G,ia,eb){G=this.usf(G.resource);var Fb={};$e.ULS.sendTraceTag(538572830,369,10,"{0}",(Fb.manifestId=ia,Fb.resource=G,Fb.error=eb,Fb))};Gb.prototype.usf=function(G){return G.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Ek.Object.defineProperties(Gb.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(me.a)(Gb,"AuthenticationService",null,
[]);Sa.prototype.create=function(G,ia){return new Gb(G,ia)};Object(me.a)(Sa,"AuthenticationServiceFactory",null,[]);var Mh=b(1057),ai=b(1169),lj=b(1152);Ca.generalException="generalException";Ca.invalidArgument="invalidArgument";Ca.notAllowed="notAllowed";Ca.apiNotAvailable="apiNotAvailable";Ca.unresolvedPendingRequest="unresolvedPendingRequest";Ca.timeout="timeout";Ca.adalTimeout="adalTimeout";Ca.userNotSignedIn="userNotSignedIn";Ca.userAborted="userAborted";Ca.silentSignInFailed="silentSignInFailed";
Ca.invalidResourceUrl="invalidResourceUrl";Ca.invalidGrant="invalidGrant";Ca.connectionLost="connectionLost";Ca.clientError="clientError";Ca.serverError="serverError";Object(me.a)(Ca,"WopiHostErrorCodes",null,[]);Object(me.a)(fa,"OAuthCallerMetadata",null,[]);ta.prototype.Wyg=function(G,ia,eb,Fb,Oc,Tc){var Md=this;if(!this.Kxa)return Fb=new ai.a,Fb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(Fb);var Qd=new fa;Qd.AddinName=Oc;Qd.AddinTrustId=Tc;var Je=-1;Tc=null;
if(Fb&&this.Ldf())Tc=this.Kxa.V$f(Hg.a.dAc,G,Fb,ta.b1e(Oc),Qd);else{var kf=Date.now();Tc=this.Kxa.US(Hg.a.dAc,G,Qd).then(function(xf){Je=Date.now()-kf;var og=(ia||eb)&&"login_required"===xf.ErrorCode;return(ia&&("interaction_required"===xf.ErrorCode||"consent_required"===xf.ErrorCode||"invalid_grant"===xf.ErrorCode)||og)&&Md.Ldf()?Md.Kxa.V$f(Hg.a.dAc,G,null,ta.b1e(Oc),Qd):Promise.resolve(xf)})}return Tc.then(function(xf){var og=new ai.a;xf.IsSuccess?(og.token=xf.Token,xf.Telemetry&&(og.jTa=xf.Telemetry.fromCache,
og.expiresOn=xf.Telemetry.expiresOn)):(og.errorCode=Md.Sxi(xf),og.mVd=Md.YVi(xf));return og}).catch(function(){var xf=new ai.a;xf.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(xf)}).then(function(xf){xf.gha="OauthManager";0<=Je&&(xf.swb=Je);return xf})};ta.prototype.Ngi=function(G){var ia=(Tf.AFrameworkApplication.ga.Ua(Tf.AFrameworkApplication.sea)||"").toLowerCase();return(hb.a.Nka||"teams"===ia&&Qi.a.Axb)&&!ta.qgi(G)||!this.Kxa||!this.Kxa.V5a()?!1:!0};ta.prototype.Ldf=
function(){return this.Cng||1!==lj.a.iac()};ta.prototype.Sxi=function(G){switch(G.ErrorCode){case "UserCancelled":case "interaction_required":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:G=G.ErrorCode===Ca.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:G.ErrorCode===Ca.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:G.ErrorCode===Ca.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:G.ErrorCode===Ca.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:G.ErrorCode===Ca.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return G};ta.prototype.YVi=function(G){var ia="";(G=RegExp("AADSTS(\\d+)").exec(G.ErrorMessage))&&1<G.length&&(ia=G[1]);return ia};ta.b1e=function(G){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,G)};ta.qgi=function(G){if(!G)return!1;G=G.toLowerCase();for(var ia=
El(Mh.AppsForOfficeSingleSignOnManager.GTe),eb=ia.next();!eb.done;eb=ia.next())if(eb.value===G)return!0;return!1};Object(me.a)(ta,"AppsforOfficeTokenFromOauthManager",null,[355]);va.woa=function(){if(Tf.AFrameworkApplication.ga.ra("AppForOfficeSSOV2IsEnabled")){var G=null;try{G=mc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ia){$e.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+ia)}G=new ta(G);va.Ma=new va(G)}};va.getInstance=function(){va.h8d||(va.woa(),va.h8d=
!0);return va.Ma};va.Ma=null;va.h8d=!1;Object(me.a)(va,"AppsForOfficeOauthManagerFactory",null,[326]);var Mi=b(133);Object(me.a)(xa,"NewDocumentParameters",null,[]);var vi=b(179);ma.prototype.createAndOpenWorkbook=function(G){var ia=this;if(G&&G.length>this.asg)throw $e.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",G.length),OfficeExtension.WacRuntime.Utility.createRichApiException(hi.a.invalidArgument,vi.a.fa(1732));var eb=new xa("blank","agave",G?"streamBase64":"streamEmpty",
G),Fb=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(Oc,Tc){var Md=new Mi.StandardDialog;Md.jc=4;Md.yk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Qd){2===Qd||0===Qd?Tc("Cancelled"):(Fb=window.open(""),ia.xsg.create(Oc,Tc,eb).G0a())})}).then(function(Oc){if(!Oc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(hi.a.generalException,vi.a.fa(1728));try{Fb.top.location.href=Oc}catch(Tc){$e.ULS.sendTraceTag(538572820,
0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",hb.a.pp,Tc),$e.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),Fb.location.replace(Oc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(Oc){if("Cancelled"===Oc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(hi.a.xCd,vi.a.fa(1731));Fb.close();ia.rIj();return null})};
ma.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};ma.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ma.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ma.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ma.prototype.invokePropertySetAsync=function(G,
ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ma.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ma.prototype.invokeMethodAsync=function(G,ia){switch(G){case 1:return this.b4g(ia)}G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ma.prototype.b4g=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return this.createAndOpenWorkbook(G)};
ma.prototype.rIj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(hi.a.generalException,vi.a.fa(1728));};Object(me.a)(ma,"WacWorkbook",null,[]);var bi=b(943),Fh=b(949);Ek.Object.defineProperties(Z.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Object(me.a)(Z,"RichApiPreviewExecutionContext",null,[]);var kk=b(25),ek=b(1074),nl=b(212),Jk=b(214),xj=b(116),Vj=b(12),Qj=Jk.a;Am(R,Qj);R.prototype.start=function(G,ia){var eb="<div class='"+xj.a.onh+
" "+rj.a.$o+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+xj.a.MC+"' /></div>";eb=String.format(eb,Mj.a.Sf(this.D5c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Qb.innerHTML=eb;this.Vob=Vj.DOMElementExtensions.getElementById(this.Qb,"bindingText");G=ia?G.J2a(ia,this.D5c.DdaBindingsMethod.BindingId):null;(null===G||void 0===G?0:G.IsValidRef)?(ia=new kk.Range(G.Reference.FirstRow+1,G.Reference.FirstColumn+1,G.Reference.LastRow+
1,G.Reference.LastColumn+1,!1,!1),this.Vob.value=G.Reference.SheetName+"!"+ia):(G=zj.g(this.$).ha,this.Vob.value=Oh.f(this.$.qa)||!G.sa.Ig?"":G.hia);this.initialize();this.kf()};R.prototype.tm=function(){this.p0c();this.addButton(0);this.addButton(1);Qj.prototype.tm.call(this)};R.prototype.setFocus=function(){Vj.DOMElementExtensions.setFocus(this.Vob)};R.prototype.validate=function(){return!0};R.prototype.commit=function(){var G=this.Vob.value.trim(),ia=G.indexOf("!");-1!==ia&&(G=this.vXh(G.substring(0,
ia))+G.substr(ia));this.YFe.addBinding(this.D5c,G,0,this.callback);return!0};R.prototype.Bsa=function(){this.YFe.HQ.wf(bi.a.internalError,this.callback);Qj.prototype.Bsa.call(this)};R.prototype.vXh=function(G){G=Oj.a.trimStart(G.trim(),"=");return G.length?G.startsWith("'")&&G.endsWith("'")?G:bl.HelperMethods.n8b(G):""};Ek.Object.defineProperties(R.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(me.a)(R,"DdaBindingPrompt",Jk.a,[]);J.prototype.wf=function(G,
ia){if(ia){var eb={};eb.Error=G;eb.Version=this.ea.rf;ia(eb)}};J.prototype.PJa=function(G,ia){this.wf(G,ia)};J.prototype.uH=function(G,ia){this.wf(bi.a.bVe(G.Errors[0].MessageId),ia)};J.prototype.lv=function(G){G&&G(this.oQ())};J.prototype.oQ=function(){var G={Error:0};G.Version=this.ea.rf;return G};Object(me.a)(J,"DdaErrorGenerator",null,[]);var qi=b(292),Ej=b(105);D.prototype.txd=function(G,ia){function eb(Qd){var Je=Fb.$.xa.getItemByName(Qd.SheetName);(null===Je||void 0===Je?0:Je.visible)?(zj.g(Fb.$).Gg(Qd,
null,null,null,3,Ej.a.ubh,void 0,void 0,void 0,void 0,!0),Fb.HQ.lv(ia)):Fb.HQ.wf(bi.a.CUg,ia)}var Fb=this,Oc=G.DdaGoToByIdMethod.GoToType,Tc=G.DdaGoToByIdMethod.SelectionMode,Md=G.DdaGoToByIdMethod.Id.toString().trim();0===Oc?this.PBi(Md,Tc,G.DdaMethod.ControlId,eb,ia):1===Oc?this.TBi(Md,Tc,eb,ia):this.HQ.wf(bi.a.dPj,ia)};D.prototype.PBi=function(G,ia,eb,Fb,Oc){var Tc=this;this.iA.ddaGetBinding(eb,G,function(Md){if(!qi.a(Md)&&Md.Result&&Md.Result.Reference){Md=Md.Result;var Qd={};Qd.SheetName=Md.Reference.SheetName;
Qd.FirstRow=Md.Reference.FirstRow;Qd.FirstColumn=Md.Reference.FirstColumn;Qd.LastRow=Md.Reference.LastRow;Qd.LastColumn=Md.Reference.LastColumn;D.fWc(Qd,ia);1!==Md.BindingType?Fb(Qd):Tc.iA.ddaGetBindingData(eb,G,1,0,2,0,0,-1,-1,function(Je){qi.a(Je)||!Je.Result?Tc.HQ.uH(Je,Oc):(Je=Je.Result,2!==ia&&(Qd.FirstRow-=Je.Headers.length,0>Qd.FirstRow&&(Qd.FirstRow=0)),Fb(Qd))},Oc)}else Tc.HQ.PJa(bi.a.$4f,Oc)},Oc)};D.prototype.TBi=function(G,ia,eb,Fb){var Oc=this,Tc=Eh.z(G);Tc?(Tc=Eh.v(Tc,this.$),D.fWc(Tc,
ia),eb(Tc)):this.$.ea.isNamedObjectViewMode&&this.$.Hb.rj(G)?this.$.Hb.qa=this.$.Hb.getItemByName(G):(Tc=function(Md){qi.a(Md)||!Md.Result?Oc.$.xa.contains(G)?(Md={},Md.SheetName=G,Md.FirstRow=0,Md.FirstColumn=0,Md.LastRow=0,Md.LastColumn=0,eb(Md)):Oc.HQ.PJa(bi.a.$4f,Fb):(Md=Md.Result,D.fWc(Md,ia),eb(Md))},this.$.xa.qa?this.iA.parseRangeForGoto(G,this.$.xa.qa.name,Tc,Fb):this.iA.parseRange(G,Tc,Fb))};D.fWc=function(G,ia){G.LastRow=2===ia?G.FirstRow:G.LastRow;G.LastColumn=2===ia?G.FirstColumn:G.LastColumn};
Object(me.a)(D,"DdaNavigator",null,[]);var lk=b(307),nk;(function(G){G[G.unsupported=0]="unsupported";G[G.surface=1]="surface";G[G.combo=2]="combo";G[G.column=3]="column";G[G.column3D=4]="column3D";G[G.bar=5]="bar";G[G.bar3D=6]="bar3D";G[G.line=7]="line";G[G.line3D=8]="line3D";G[G.pie=9]="pie";G[G.pie3D=10]="pie3D";G[G.scatter=11]="scatter";G[G.bubble=12]="bubble";G[G.area=13]="area";G[G.area3D=14]="area3D";G[G.doughnut=15]="doughnut";G[G.radar=16]="radar";G[G.stock=17]="stock";G[G.waterfall=18]=
"waterfall";G[G.funnel=19]="funnel";G[G.treemap=20]="treemap";G[G.sunburst=21]="sunburst";G[G.boxWhisker=22]="boxWhisker";G[G.histogram=23]="histogram";G[G.pareto=24]="pareto";G[G.regionMap=25]="regionMap";G[G.noVisibleSeries=26]="noVisibleSeries";G[G.complexDataSource=27]="complexDataSource";G[G.pivotChart=28]="pivotChart"})(nk||(nk={}));Object(me.b)("ChartCategory",nk);Object(me.a)(aa,"MacroRecorderEventData",null,[]);U.prototype.PVh=function(G){var ia;if(void 0===G||null===G||void 0===G.RequestBody||
null===G.RequestBody)return null;var eb=JSON.parse(G.RequestBody);if(void 0!==G.ActiveChartId&&null!==G.ActiveChartId){eb.ActiveChartId=G.ActiveChartId;var Fb=zj.g(this.$).ha.Oa.oc;if(null===(ia=null===Fb||void 0===Fb?void 0:Fb.floatingObject)||void 0===ia?0:ia.$c)eb.ActiveChartType=nk[Fb.floatingObject.$c.ChartCategory]}void 0!==G.SheetMultiRange&&null!==G.SheetMultiRange&&(eb.SheetName=G.SheetMultiRange.SheetName);return eb};U.prototype.aWh=function(G){if(void 0===G||null===G||void 0===G.Result||
null===G.Result)return null;G=G.Result;return void 0===G.ResponseBody||null===G.ResponseBody||G.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(G.ResponseBody.join(""))};U.prototype.Zki=function(G){return!!G&&!(void 0===G.eventId||null===G.eventId)&&0<G.eventId.length};U.prototype.Zi=function(G){var ia=this;return function(){if(ia.$.Aba){var eb=ia.PQg(ia.request);if(ia.Zki(eb)){var Fb=ia.PVh(ia.request),Oc=ia.aWh(G);if(Fb&&!sf.a.isEmpty(Fb)&&Oc&&!sf.a.isEmpty(Oc))return $e.ULS.sendTraceTag(537163164,
0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Vh(eb,Fb,Oc);eb=String.format("requestInfo: {0}; responseInfo: {1}",Fb?"(not null)":"(null)",Oc?"(not null)":"(null)");$e.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",eb)}}return new Vh(null,null,null)}};U.prototype.PQg=function(G){var ia=this.$ki(G.SolutionId),eb=U.wVh(G);if(eb&&ia)return ia={},$e.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,
(ia.recorderEventId=eb,ia["request.SolutionId"]=G.SolutionId,ia)),new aa(G.SolutionId,eb);var Fb={};$e.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(Fb.recorderEventId=eb,Fb.isRecorderAwareAddin=ia,Fb["request.SolutionId"]=G.SolutionId,Fb));return null};U.prototype.$ki=function(G){if(!G)return!1;G=G.toLowerCase();return U.o0h().contains(G)};U.o0h=function(){U.Cza||(U.Cza=new qj.a(Eg.a.Pk()),U.Cza.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),U.Cza.add("fa000000005"),
U.Cza.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),U.Cza.add("fa000000014"),U.Cza.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return U.Cza};U.wVh=function(G){var ia=null,eb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(eb.test(G.RequestBody))ia=eb.exec(G.RequestBody)[1];else{G=G.RequestHeaders;if(!G)return ia;eb=Hj.a.GEi.toLowerCase();for(var Fb=0;Fb<G.length;Fb++)if(G[Fb].Name.toLowerCase()===eb){ia=G[Fb].Value;break}}return ia};U.Cza=null;Object(me.a)(U,"DdaRichApiRequestRecorder",
null,[]);var Qk=b(67),Uk=lk.a;Am(ca,Uk);ca.prototype.a3=function(G){return Uk.prototype.a3.call(this,G)||this.yTg(G)};ca.prototype.Zi=function(){return this.VLd.Zi(this.rd)};ca.prototype.reb=function(){var G={OperationType:3};G.RichApiRequest=this.request;return G};ca.prototype.yTg=function(G){var ia=this;return function(eb,Fb,Oc){return F(G,ia.request,Bh.b(eb,ia.$lb),Bh.a(Fb,ia.tib),Oc,ia.K3)}};Ek.Object.defineProperties(ca.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Ag.EwaSettings.qc()?
Object(Qk.a)(ca.prototype,this,"operationWorkingState"):2}},yCc:{configurable:!0,enumerable:!0,get:function(){return this.gFa}},At:{configurable:!0,enumerable:!0,get:function(){return this.$lb}},taa:{configurable:!0,enumerable:!0,get:function(){return this.tib}}});Object(me.a)(ca,"DdaRichApiRequestBatchOperation",lk.a,[]);var K=Lh.a;Am(L,K);L.prototype.Zi=function(){return this.VLd.Zi(this.rd)};Ek.Object.defineProperties(L.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Ag.EwaSettings.qc()?
Object(Qk.a)(L.prototype,this,"operationWorkingState"):0}}});Object(me.a)(L,"DdaRichApiRequestOperation",Lh.a,[]);P.prototype.ddaAddBinding=function(G,ia,eb,Fb,Oc,Tc,Md){var Qd=this;this.TJ(function(Je,kf,xf){var og=Qd.$.na.ua,Ug=Qd.mja();Je=Bh.b(Je,Tc);kf=Bh.a(kf,Qd.rI);var kh=og.Na(9);kh.controlId=G;kh.bindingId=ia;kh.bindingType=eb;kh.currentSheetName=Ug;kh.formula=Fb;kh.options=Oc;return Yh.i(og,"DdaAddBinding",kh,Je,kf,xf,Md,0)},Md,563)};P.prototype.ddaReleaseBinding=function(G,ia,eb,Fb){var Oc=
this;this.TJ(function(Tc,Md,Qd){var Je=Oc.$.na.ua;Tc=Bh.b(Tc,eb);Md=Bh.a(Md,Oc.rI);var kf=Je.Na(9);kf.controlId=G;kf.bindingId=ia;return Yh.i(Je,"DdaReleaseBinding",kf,Tc,Md,Qd,Fb,0)},Fb,564)};P.prototype.ddaGetBinding=function(G,ia,eb,Fb){var Oc=this;this.TJ(function(Tc,Md,Qd){var Je=Oc.$.na.ua;Tc=Bh.b(Tc,eb);Md=Bh.a(Md,Oc.rI);var kf=Je.Na(1);kf.controlId=G;kf.bindingId=ia;return Yh.i(Je,"DdaGetBinding",kf,Tc,Md,Qd,Fb,0)},Fb,565,16)};P.prototype.ddaGetAllBindings=function(G,ia,eb){var Fb=this;this.TJ(function(Oc,
Tc,Md){var Qd=Fb.$.na.ua;Oc=Bh.b(Oc,ia);Tc=Bh.a(Tc,Fb.rI);var Je=Qd.Na(1);Je.controlId=G;return Yh.i(Qd,"DdaGetAllBindings",Je,Oc,Tc,Md,eb,0)},eb,566,16)};P.prototype.ddaGetBindingData=function(G,ia,eb,Fb,Oc,Tc,Md,Qd,Je,kf,xf){var og=this;this.TJ(function(Ug,kh,Yi){var Ah=og.$.na.ua,yi=og.mja();Ug=Bh.b(Ug,kf);kh=Bh.a(kh,og.rI);var Ki=Ah.Na(1);Ki.controlId=G;Ki.bindingId=ia;Ki.coerceType=eb;Ki.valueFormat=Fb;Ki.filterType=Oc;Ki.startRow=Tc;Ki.startCol=Md;Ki.rowCount=Qd;Ki.colCount=Je;Ki.currentSheetName=
yi;return Yh.i(Ah,"DdaGetBindingData",Ki,Ug,kh,Yi,xf,0)},xf,567,16)};P.prototype.ddaSetBindingData=function(G,ia,eb,Fb,Oc,Tc,Md){var Qd=this;this.TJ(function(Je,kf,xf){var og=Qd.$.na.ua,Ug=Qd.mja();Je=Bh.b(Je,Tc);kf=Bh.a(kf,Qd.rI);var kh=og.Na(9);kh.controlId=G;kh.bindingId=ia;kh.startRow=eb;kh.startCol=Fb;kh.currentSheetName=Ug;kh.bindingData=Oc;return Yh.i(og,"DdaSetBindingData",kh,Je,kf,xf,Md,0)},Md,568)};P.prototype.ddaGetSelectedData=function(G,ia,eb,Fb,Oc,Tc,Md){var Qd=this;this.TJ(function(Je,
kf,xf){var og=Qd.$.na.ua,Ug=Qd.mja();Je=Bh.b(Je,Tc);kf=Bh.a(kf,Qd.rI);var kh=og.Na(1);kh.controlId=G;kh.coerceType=ia;kh.valueFormat=eb;kh.filterType=Fb;kh.currentSheetName=Ug;kh.formula=Oc;return Yh.i(og,"DdaGetSelectedData",kh,Je,kf,xf,Md,0)},Md,569,16)};P.prototype.ddaSetSelectedData=function(G,ia,eb,Fb,Oc){var Tc=this;this.TJ(function(Md,Qd,Je){var kf=Tc.$.na.ua,xf=Tc.mja();Md=Bh.b(Md,Fb);Qd=Bh.a(Qd,Tc.rI);var og=kf.Na(9);og.controlId=G;og.currentSheetName=xf;og.formula=ia;og.bindingData=eb;return Yh.i(kf,
"DdaSetSelectedData",og,Md,Qd,Je,Oc,0)},Oc,570)};P.prototype.ddaLoadSettings=function(G,ia,eb){var Fb=this;this.TJ(function(Oc,Tc,Md){var Qd=Fb.$.na.ua;Oc=Bh.b(Oc,ia);Tc=Bh.a(Tc,Fb.rI);var Je=Qd.Na(1);Je.controlId=G;return Yh.i(Qd,"DdaLoadSettings",Je,Oc,Tc,Md,eb,0)},eb,501,16)};P.prototype.ddaSaveSettings=function(G,ia,eb,Fb,Oc){var Tc=this;this.TJ(function(Md,Qd,Je){var kf=Tc.$.na.ua;Md=Bh.b(Md,Fb);Qd=Bh.a(Qd,Tc.rI);var xf=kf.Na(9);xf.controlId=G;xf.settings=ia;xf.overwriteIfStale=eb;return Yh.i(kf,
"DdaSaveSettings",xf,Md,Qd,Je,Oc,0)},Oc,571)};P.prototype.ddaAddRowsColumns=function(G,ia,eb,Fb,Oc,Tc){var Md=this;this.TJ(function(Qd,Je,kf){var xf=Md.$.na.ua,og=Md.mja();Qd=Bh.b(Qd,Oc);Je=Bh.a(Je,Md.rI);var Ug=xf.Na(9);Ug.controlId=G;Ug.bindingId=ia;Ug.isRow=eb;Ug.currentSheetName=og;Ug.bindingData=Fb;return Yh.i(xf,"DdaAddRowsColumns",Ug,Qd,Je,kf,Tc,0)},Tc,572)};P.prototype.ddaDeleteAllDataValues=function(G,ia,eb,Fb){var Oc=this;this.TJ(function(Tc,Md,Qd){var Je=Oc.$.na.ua,kf=Oc.mja();Tc=Bh.b(Tc,
eb);Md=Bh.a(Md,Oc.rI);var xf=Je.Na(9);xf.controlId=G;xf.bindingId=ia;xf.currentSheetName=kf;return Yh.i(Je,"DdaDeleteAllDataValues",xf,Tc,Md,Qd,Fb,0)},Fb,573)};P.prototype.ddaClearBindingFormats=function(G,ia,eb,Fb){var Oc=this;this.TJ(function(Tc,Md,Qd){var Je=Oc.$.na.ua,kf=Oc.mja();Tc=Bh.b(Tc,eb);Md=Bh.a(Md,Oc.rI);var xf=Je.Na(9);xf.controlId=G;xf.bindingId=ia;xf.currentSheetName=kf;return Yh.i(Je,"DdaClearBindingFormats",xf,Tc,Md,Qd,Fb,0)},Fb,574)};P.prototype.ddaSetBindingFormats=function(G,ia,
eb,Fb,Oc,Tc){var Md=this;this.TJ(function(Qd,Je,kf){var xf=Md.$.na.ua,og=Md.mja();Qd=Bh.b(Qd,Oc);Je=Bh.a(Je,Md.rI);var Ug=xf.Na(9);Ug.controlId=G;Ug.bindingId=ia;Ug.currentSheetName=og;Ug.bindingData=eb;Ug.isSetFormats=Fb;return Yh.i(xf,"DdaSetBindingFormats",Ug,Qd,Je,kf,Tc,0)},Tc,575)};P.prototype.parseRange=function(G,ia,eb){var Fb=this;this.TJ(function(Oc,Tc,Md){var Qd=Fb.$.na.ua.hc();return Yh.Q(Fb.$.na.ua,G,-1,Bh.b(Oc,ia),Bh.a(Tc,Fb.rI),Md,eb,Qd)},eb,162,16)};P.prototype.parseRangeForGoto=function(G,
ia,eb,Fb){var Oc=this;this.TJ(function(Tc,Md,Qd){var Je=Oc.$.na.ua.hc();return Yh.R(Oc.$.na.ua,G,ia,Bh.b(Tc,eb),Bh.a(Md,Oc.rI),Qd,Fb,Je)},Fb,562,16)};P.prototype.executeRichApiRequest=function(G,ia,eb){var Fb=this;Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(G.RequestFlags&=8191);if(Ag.EwaSettings.ma(259))this.uxh(this.$.na.ua.hc(),ia,function(){Fb.HQ.PJa(bi.a.internalError,eb)},eb,G);else{var Oc=db.DdaFacade.Jfd(G);!Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.zb.Kz||Oc&16?(Ag.EwaSettings.qc()&&(Oc|=64),this.$.userOperationManager.Zt(new L(this.$,G,function(Tc,Md,Qd){return F(Fb.$.na.ua,G,Bh.b(Tc,ia),Bh.a(Md,Fb.rI),Qd,eb)},Oc))):(this.HQ.PJa(bi.a.vDc,eb),$e.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};P.prototype.mja=function(){return this.$.ea.isNamedObjectViewMode?this.$.qa.sheetName:this.$.activeItemName};P.prototype.TJ=function(G,ia,eb,Fb){Fb=void 0===Fb?0:Fb;!Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.zb.Kz||Fb&16?Ag.EwaSettings.qc()?this.$.userOperationManager.Zt(new Lh.a(eb,0,G,Fb|64)):this.$.userOperationManager.Zt(new Yg.a(eb,0,G,Fb)):(this.HQ.PJa(bi.a.vDc,ia),$e.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};P.prototype.uxh=function(G,ia,eb,Fb,Oc){var Tc=db.DdaFacade.Jfd(Oc);if(!Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.zb.Kz||Tc&16){var Md=this.$.Ob.Gc("UserAction","Rich Api request");Ag.EwaSettings.qc()&&
(Tc|=64);this.$.userOperationManager.ic(new ca(this.$,G,ia,eb,Fb,Md,Oc,Tc),null)}else this.HQ.PJa(bi.a.vDc,Fb),$e.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")};Object(me.a)(P,"DdaWebServiceHelper",null,[]);Object(me.a)(Q,"DocumentFile",null,[]);M.generalException="GeneralException";M.iJg="ApiNotFound";M.xCd="OperationCancelled";M.invalidArgument="InvalidArgument";Object(me.a)(M,"ErrorCodes",null,[]);z.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};
z.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};z.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(me.a)(z,"WacApiDelegates",null,[]);var ea=b(713);Am(B,z);B.prototype.replaceShortcuts=function(G){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,G,this.Cgf)};B.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};
B.prototype.checkShortcutsInUse=function(G){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(G,this.Cgf)};B.W6g=function(G,ia){var eb=document.createEvent("KeyboardEvent");if(hb.a.wF)eb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(G&8),!!(G&32),!!(G&4),!!(G&256));else{var Fb=[];G&4&&Fb.push("Shift");G&8&&Fb.push("Control");G&32&&Fb.push("Alt");eb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,Fb.join(" "),!1,"en-US")}G=new Sys.UI.DomEvent(eb);G.keyCode=ia;return G};B.C2g=
function(G,ia){if(hb.a.Gf)switch(ia){case 189:ia=173;break;case 187:ia=61;break;case 186:ia=59}return B.W6g(G,ia)};Object(me.a)(B,"ExcelWacApiDelegates",z,[]);E.prototype.CAg=function(G,ia){this.Bdc(G)||(this.BIa[G]={});if(this.pgi(G))return $e.ULS.sendTraceTag(537163157,344,50,"App {0} has reach the limit of number of cached files.",G),bi.a.mzi;this.BIa[G][ia.rzh.toString()]=ia;return bi.a.success};E.prototype.lNh=function(G,ia){var eb=null;this.Bdc(G)&&(eb=this.BIa[G][ia.toString()]);eb||$e.ULS.sendTraceTag(537163156,
344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",G,ia);return eb};E.prototype.Bdc=function(G){return G in this.BIa};E.prototype.W8i=function(G,ia){if(this.Bdc(G)){var eb=this.BIa[G];delete eb[ia.toString()];1>Object.keys(eb).length&&delete this.BIa[G];return ia.toString()in eb?bi.a.internalError:bi.a.success}return bi.a.internalError};E.prototype.pgi=function(G){return this.Bdc(G)?Object.keys(this.BIa[G]).length>=this.Fyi:!1};E.getInstance=function(G){return G.da.Aa(200)||G.da.Ga(200,
new E(E.Gyi))};E.CCi=function(){return++E.OSg};E.lyi=4194304;E.Gyi=1;E.OSg=0;Object(me.a)(E,"GetFileApiHelper",null,[]);y.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.xA)};y.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};y.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};y.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};y.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};y.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};y.prototype.invokeMethod=function(G){switch(G){case 1:return this.kDi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};y.prototype.invokeMethodAsync=
function(G,ia){G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};y.prototype.kDi=function(){this.notifyActionHandlerReady();return null};Object(me.a)(y,"AddinInternalService",null,[]);t.prototype.getAppRuntimeState=function(){return this.fJ.getAppRuntimeState(this.xA)?2:1};t.prototype.setAppRuntimeState=function(G){switch(G){case 2:G=!0;break;case 1:G=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(hi.a.invalidArgument,
vi.a.fa(1732));}this.fJ.setAppRuntimeState(this.xA,G)};t.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};t.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};t.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};t.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};t.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};t.prototype.invokeMethod=function(G,ia){switch(G){case 2:return this.vIh();case 1:return this.Pnj(ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};t.prototype.invokeMethodAsync=function(G,ia){G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};t.prototype.vIh=function(){return this.getAppRuntimeState()};
t.prototype.Pnj=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");this.setAppRuntimeState(G);return null};Object(me.a)(t,"AppRuntimeService",null,[]);var Ta=b(1170);u.prototype.disable=function(){try{if(!vi.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.PCe();if(!this.agf())return this.QCe();this.L1.kOj(this.Ps)}catch(G){return $e.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",
G.message||"Unknown"),this.NCe()}return null};u.prototype.enable=function(){try{if(!vi.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.PCe();if(!this.agf())return this.QCe();this.L1.Z6i(this.Ps)}catch(G){return $e.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",G.message||"Unknown"),this.NCe()}return null};u.prototype._OnAccess=function(){};u.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};
u.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};u.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};u.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
u.prototype.invokeMethod=function(G){switch(G){case 1:return this.rCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};u.prototype.invokeMethodAsync=function(G,ia){switch(G){case 3:return this.afh();case 2:return this.Yjh()}G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.afh=function(){return this.disable()};u.prototype.Yjh=function(){return this.enable()};u.prototype.rCa=function(){this._OnAccess();return null};
u.prototype.PCe=function(){return Ta.a(hi.a.notImplemented,vi.a.fa(1733))};u.prototype.QCe=function(){return Ta.a(hi.a.sharedRuntimeNotAvailable,vi.a.fa(1737))};u.prototype.NCe=function(){return Ta.a(hi.a.generalException,vi.a.fa(1728))};u.prototype.agf=function(){var G=this.Xy.getSharedRuntimeId();return!!G&&0<G.length};Object(me.a)(u,"BeforeDocumentCloseNotification",null,[]);v.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};v.prototype.invokePropertyGet=
function(G){switch(G){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};v.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};v.prototype.invokePropertySet=function(G,ia){switch(G){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return;case 3:this.nativeRuntime=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};v.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};v.prototype.invokeMethodAsync=function(G,ia){G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Ek.Object.defineProperties(v.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.rA},set:function(G){this.rA=G}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.Jbe},set:function(G){this.Jbe=G}},streamingEnabled:{configurable:!0,enumerable:!0,get:function(){return this.vhe},set:function(G){this.vhe=G}}});Object(me.a)(v,
"CustomFunctionEngineStatus",null,[]);n.prototype.register=function(G){return OfficeExtension.WacRuntime.Utility.createPromise(this.lug(G))};n.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};n.prototype.invokePropertyGet=function(G){switch(G){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};n.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};
n.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};n.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};n.prototype.invokeMethodAsync=function(G,ia){switch(G){case 1:return this.R7i(ia)}G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};
n.prototype.R7i=function(G){var ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"string");return this.register(ia,G)};Ek.Object.defineProperties(n.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var G=new v;G.enabled=this.lqg;G.streamingEnabled=this.mqg;G.nativeRuntime=!1;return G}}});Object(me.a)(n,"CustomFunctionManager",null,[]);var Lb=b(1150);w.prototype._RegisterStateChange=function(){var G=
this;this.zSb||this.nP.execute(function(ia){G.P2d=ia.Ima(G._id,function(eb){G.fJ.xBh(G.xA,G._id,JSON.stringify(eb))})});this.zSb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype._UnregisterStateChange=function(){var G=this;this.zSb--;this.zSb||this.nP.execute(function(ia){ia.xId(G._id,G.P2d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};w.prototype.invokePropertyGet=
function(G){switch(G){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};w.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
w.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokeMethodAsync=function(G,ia){switch(G){case 6:return this.Ejg();case 7:return this.Gjg()}G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};w.prototype.Ejg=function(){return this._RegisterStateChange()};w.prototype.Gjg=function(){return this._UnregisterStateChange()};Ek.Object.defineProperties(w.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id}}});Object(me.a)(w,"LicenseFeature",null,[]);h.prototype.getFeatureTier=function(G,ia){var eb=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Fb){var Oc=1===ia?1:2===ia?2:0;eb.nP.execute(function(Tc){Tc.getFeatureTier(G,Oc).then(function(Md){Fb(eb.vRh(Md))},function(){Fb(ia)})})})};h.prototype.getLicenseFeature=function(G){G=new w(this.nP,G,this.xA,this.fJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};h.prototype.isFeatureEnabled=
function(G,ia){var eb=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Fb){eb.nP.execute(function(Oc){Oc.isFeatureEnabled(G,ia).then(function(Tc){Fb(Tc)},function(){Fb(ia)})})})};h.prototype.isFreemiumUpsellEnabled=function(){var G=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ia){G.nP.execute(function(eb){eb=eb.isFreemiumUpsellEnabled();ia(eb)})})};h.prototype.launchUpsellExperience=function(G){var ia=this;if(this.$sg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){ia.nP.execute(function(eb){eb.launchUpsellExperience(G)})});
throw OfficeExtension.WacRuntime.Utility.createRichApiException(hi.a.uTc,"");};h.prototype._TestFireStateChangedEvent=function(){};h.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};h.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};h.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};h.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};h.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};h.prototype.invokeMethod=function(G,ia){switch(G){case 6:return this.Fjg(ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};h.prototype.invokeMethodAsync=function(G,ia){switch(G){case 2:return this.gOh(ia);case 5:return this.uRh(ia);case 1:return this.ghi(ia);case 3:return this.Mhi();case 4:return this.Yqi(ia)}G=this.invokeMethod(G,
ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};h.prototype.gOh=function(G){var ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"int");return this.getFeatureTier(ia,G)};h.prototype.uRh=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return this.getLicenseFeature(G)};h.prototype.ghi=function(G){var ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,
0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"boolean");return this.isFeatureEnabled(ia,G)};h.prototype.Mhi=function(){return this.isFreemiumUpsellEnabled()};h.prototype.Yqi=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return this.launchUpsellExperience(G)};h.prototype.Fjg=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");this._TestFireStateChangedEvent(G);return null};h.prototype.vRh=function(G){switch(G){case 1:return 1;
case 2:return 2;default:return 0}};Object(me.a)(h,"License",null,[]);var xc=b(157);m.prototype.areShortcutsInUse=function(G){var ia=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(eb,Fb){ia.Hvd.checkShortcutsInUse(G).then(function(Oc){eb(Oc)}).catch(function(Oc){Fb(Oc)})})};m.prototype.getShortcuts=function(){var G=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ia,eb){G.Hvd.getShortcuts().then(function(Fb){ia(Fb)}).catch(function(Fb){eb(Fb)})})};m.prototype.replaceShortcuts=
function(G){var ia=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(eb,Fb){ia.Hvd.replaceShortcuts(G).then(function(){eb(null)}).catch(function(Oc){Fb(Oc)})})};m.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};m.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};m.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};
m.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};m.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};m.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};m.prototype.invokeMethodAsync=function(G,ia){switch(G){case 3:return this.QKg(ia);case 1:return this.zXh();case 2:return this.wdj(ia)}G=
this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};m.prototype.QKg=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"Array<string>");return this.areShortcutsInUse(G)};m.prototype.zXh=function(){return this.getShortcuts()};m.prototype.wdj=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"any");return this.replaceShortcuts(G)};Object(me.a)(m,"ActionService",null,[]);var qd=b(566);l.prototype.mXh=function(){this.mra||
(this.mra=qd.a.ar(mc.a.instance.lc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.mra};l.prototype.getSharedFilePickerResponse=function(G){var ia=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(eb,Fb){try{var Oc=ia.mXh();ik.Task.WAA.call(null,Oc).continueWith(function(){var Tc=Oc.result;if(Tc){var Md={};(function(){var Qd=ra.d(G);Md=Qd.dv;return Qd})().returnValue?Tc.ned(Md).then(function(Qd){Qd&&0<Qd.length?eb(Qd):Fb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(function(Qd){Fb(Qd)}):Fb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Fb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(Tc){Fb(Tc)}})};l.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};l.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};l.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};l.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};l.prototype.invokePropertySetAsync=function(G,ia){this.invokePropertySet(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};l.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};l.prototype.invokeMethodAsync=function(G,ia){switch(G){case 1:return this.lXh(ia)}G=this.invokeMethod(G,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};l.prototype.lXh=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return this.getSharedFilePickerResponse(G)};Object(me.a)(l,"SharedFilePicker",null,[]);f.prototype.createInstance=function(G,ia){switch(G){case "Microsoft.Office.ActionService":return new m(ia);case "Microsoft.Office.SharedFilePicker":return new l}return null};
Object(me.a)(f,"WacApiHost",null,[]);e.prototype.hostName=function(){return"ExcelOnline"};e.prototype.appId=function(){return this.IQb};e.prototype.createInstance=function(G){switch(G){case "Microsoft.Authentication.AuthenticationService":return mc.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.xA,this.fJ.Fi);case "Microsoft.Authentication.TokenParameters":return new kb;case "Microsoft.ExcelServices.CustomFunctionManager":G=this.wb.ma(122);
var ia=this.wb.ma(123);return new n(G,ia,r(this.IQb,this.wb,this.fJ));case "Microsoft.AppRuntime.AppRuntimeService":return new t(this.xA,this.fJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return G=Ii.a(this.wb),new u(this.IQb,this.xA,G,this.fJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return G=Ii.a(this.wb),new Lb.DynamicRibbon(this.IQb,this.xA,this.fJ,G,G.pn(this.xA).il);case "Microsoft.Office.Licensing.License":return new h(this.xA,this.fJ);case "Microsoft.InternalService.AddinInternalService":return new y(this.xA);
default:if(this.$Sc||(this.$Sc=new f),ia=this.$Sc.createInstance(G,this.pyg))return ia}$e.ULS.sendTraceTag(537163155,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",G);throw OfficeExtension.WacRuntime.Utility.createRichApiException(hi.a.generalException,hi.a.generalException);};Object(me.a)(e,"RichApiHost",null,[]);var Jd=b(407),De=b(117),Ve=b(35),sg=b(99),mh=b(294),Zh=b(43),Ci=b(258),Bj=b(6),Kj=b(66),uk=b(204);c.prototype.dispose=function(){this.$=this.r9b=
null};c.prototype.Zc=function(){return!1};c.prototype.jd=function(){return!1};c.prototype.executeCommand=function(G,ia,eb){G=ia.command;switch(G){case 451041795:this.Ee.wf(eb[th.a.Cg],eb[th.a.K3]);break;case 974713501:this.R2h(eb[th.a.Cg],eb[th.a.K3]);break;case 1237877382:this.Ee.lv(eb[th.a.K3]);break;default:return Lk.a(G)}return ik.Task.Sa(!0)};c.prototype.Lc=function(G,ia,eb){if(G=!!eb)switch(ia.command){case 974713501:case 1237877382:case 451041795:break;default:G=!1}return G};c.prototype.R2h=
function(G,ia){var eb,Fb=G.DdaMethod;if("undefined"===typeof Fb.DispatchId)this.Ee.wf(bi.a.internalError,ia);else if(c.igi(G)||this.$.Pd&1){if(Fb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new R(this.$,this,G,ia)).start(this.Je,G.DdaMethod.ControlId):Fb.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.MWh(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.dsj(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(G,this.Mdd(G.DdaMethod.ControlId),0,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.ZIh(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.Znj(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.YIh(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.V8i(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.$Hh(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.Jtd(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(G.DdaAddRowsColumns.IsRow=!0,this.cme(G,ia)):Fb.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(G.DdaAddRowsColumns.IsRow=!1,this.cme(G,ia)):Fb.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.Jch(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.BXg(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(G.DdaSetBindingFormats.IsSetFormats=!0,this.SXf(G,ia)):Fb.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(G.DdaSetBindingFormats.IsSetFormats=!1,this.SXf(G,ia)):Fb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(G,G.DdaBindingsMethod.ItemName,G.DdaBindingsMethod.FailOnCollision?2:1,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.kOh(ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.txd(G,ia):Fb.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.iNh(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.jNh(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.X8i(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(G.DdaMethod.ControlId,G),this.Ee.lv(ia)):
Fb.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?Ag.EwaSettings.ma(24)?this.Ee.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ia):this.Jzi(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?Ag.EwaSettings.ma(24)?this.Ee.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ia):this.Fzi(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(G,ia):Fb.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(G,ia):this.Ee.wf(bi.a.ACd,ia),Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&Fb.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){G=this.Je.FZ(G.DdaMethod.ControlId);ia="";if(G){ia=db.DdaFacade.getSolutionId(G,this.$);var Oc=G.PrimaryMarketplace.MarketplaceType;Oc===OSF.StoreType.InMemory?G.OwnerAddinSolutionId&&G.AssetMarketplace&&(Oc=G.AssetMarketplace.MarketplaceType):Oc===OSF.StoreType.WopiCatalog&&(Oc=OSF.StoreType.OMEX);
ia=Telemetry.PrivacyRules.GetPrivacyCompliantId(ia,Oc,null===(eb=G.AssetMarketplace)||void 0===eb?void 0:eb.SolutionId,null,null,G.PrimaryMarketplace.MarketplaceRef)}$e.ULS.sendTraceTag(537163224,344,50,"DDA method Id: {0}, AppID: {1}",Fb.DispatchId,ia)}}else this.Ee.wf(bi.a.SIe,ia)};c.prototype.ZIh=function(G,ia){var eb=this;G.DdaGetBindingData.CoerceType=c.Z2b(G.DdaGetBindingData.CoerceType);G.DdaGetBindingData.FilterType=c.LSe(G.DdaGetBindingData.FilterType);G.DdaGetBindingData.ValueFormat=c.Seg(G.DdaGetBindingData.ValueFormat);
if(this.Eic(G.DdaGetBindingData.CoerceType,ia)){if(G.DdaGetBindingData){var Fb=G.DdaGetBindingData;0===Fb.FilterType&&(Fb.FilterType=2);Fb.StartCol|=0;Fb.StartRow|=0;Fb.ColCount=void 0===Fb.ColCount?-1:Fb.ColCount;Fb.RowCount=void 0===Fb.RowCount?-1:Fb.RowCount}this.iA.ddaGetBindingData(G.DdaMethod.ControlId,G.DdaGetBindingData.BindingId,G.DdaGetBindingData.CoerceType,G.DdaGetBindingData.ValueFormat,G.DdaGetBindingData.FilterType,G.DdaGetBindingData.StartRow,G.DdaGetBindingData.StartCol,G.DdaGetBindingData.RowCount,
G.DdaGetBindingData.ColCount,function(Oc){if(qi.a(Oc)||!Oc.Result)eb.Ee.uH(Oc,ia);else{var Tc=eb.Ee.oQ();Tc.Data=c.mue(Oc.Result);ia(Tc)}},ia)}};c.prototype.Znj=function(G,ia){var eb=this;G.DdaSetBindingData.CoerceType=c.Z2b(G.DdaSetBindingData.CoerceType);if(this.Eic(G.DdaSetBindingData.CoerceType,ia)){var Fb=c.UYc(G.DdaSetBindingData.CoerceType,G.DdaSetBindingData.Data);c.Ifc(Fb)?this.Ee.wf(bi.a.oBc,ia):(1===Fb.CoerceType&&(Fb.CellFormat||(Fb.CellFormat=G.DdaSetBindingData.CellFormat),Fb.TableOptions||
(Fb.TableOptions=G.DdaSetBindingData.TableOptions)),G.DdaSetBindingData&&(G.DdaSetBindingData.StartCol|=0,G.DdaSetBindingData.StartRow|=0),this.iA.ddaSetBindingData(G.DdaMethod.ControlId,G.DdaSetBindingData.BindingId,G.DdaSetBindingData.StartRow,G.DdaSetBindingData.StartCol,Fb,function(Oc){qi.a(Oc)?eb.Ee.uH(Oc,ia):eb.Ee.lv(ia)},ia))}};c.prototype.MWh=function(G,ia){var eb=this;G.DdaGetBindingData.CoerceType=c.Z2b(G.DdaGetBindingData.CoerceType);G.DdaGetBindingData.ValueFormat=c.Seg(G.DdaGetBindingData.ValueFormat);
G.DdaGetBindingData.FilterType=c.LSe(G.DdaGetBindingData.FilterType);if(this.Eic(G.DdaGetBindingData.CoerceType,ia)){var Fb=this.Mdd(G.DdaMethod.ControlId);Fb?this.iA.ddaGetSelectedData(G.DdaMethod.ControlId,G.DdaGetBindingData.CoerceType,G.DdaGetBindingData.ValueFormat,G.DdaGetBindingData.FilterType,Fb,function(Oc){if(qi.a(Oc))eb.Ee.uH(Oc,ia);else{var Tc=eb.Ee.oQ();Tc.Data=c.mue(Oc.Result);ia(Tc)}},ia):this.Ee.wf(bi.a.V1e,ia)}};c.prototype.iNh=function(G,ia){var eb=this;if(hb.a.apd)this.Ee.wf(bi.a.UOg,
ia);else{var Fb=G[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],Oc=G[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Tc=G.DdaMethod.ControlId,Md=E.getInstance(this.$);if(0>=Oc)$e.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.Ee.wf(bi.a.Tci,ia);else if(Oc>E.lyi)$e.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.Ee.wf(bi.a.hYe,ia);else{var Qd=null;switch(Fb){case 1:Qd="Compressed";
break;case 0:Qd="Text";break;case 2:Qd="Pdf";break;default:$e.ULS.sendTraceTag(537163219,344,15,"Requested file type {0} is not supported.",Fb);this.Ee.wf(bi.a.zSe,ia);return}if("Text"===Qd)$e.ULS.sendTraceTag(537163218,344,15,"Requested file type {0} is not supported.",Qd),this.Ee.wf(bi.a.zSe,ia);else{Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(G=new Sys.StringBuilder,G.append(ek.a(this.$,Qd)),"Pdf"===Qd&&nl.a.eh(G,Hj.a.cGd,"WholeWorkbook"),G=
G.toString()):G=ek.a(this.$,Qd);var Je=null,kf=new XMLHttpRequest;kf.onreadystatechange=function(){if(4===kf.readyState)if(200===kf.status){var xf=kf.response;if(xf){Je=new Uint8Array(xf);xf=eb.Ee.oQ();for(var og=Je.length,Ug=E.CCi(),kh={},Yi=0,Ah=0;Ah<og;Ah+=Oc){for(var yi=[],Ki=Ah+Oc<og?Ah+Oc:og,Rj=0,ej=Ah;ej<Ki;Rj++,ej++)yi[Rj]=Je[ej];kh[(Yi++).toString()]=yi}kh=new Q(Ug,og,Oc,kh);kh=Md.CAg(Tc,kh);kh!==bi.a.success?eb.Ee.wf(kh,ia):(xf[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=
Ug,xf[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=og,$e.ULS.sendTraceTag(537163216,344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",Qd,og),ia(xf))}else $e.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type {0}.",Qd),eb.Ee.wf(bi.a.internalError,ia)}else 500===kf.status?eb.Ee.wf(bi.a.bVe(parseInt(kf.statusText,10)),ia):($e.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type {0}.",
Qd),eb.Ee.wf(bi.a.iCi,ia))};kf.open("GET",G,!0);kf.responseType="arraybuffer";kf.setRequestHeader("If-Modified-Since","0");kf.send(null)}}}};c.prototype.jNh=function(G,ia){var eb=G[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],Fb=G[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];G=G.DdaMethod.ControlId;(eb=E.getInstance(this.$).lNh(G,eb))?(eb=eb.JBj,0>Fb||Fb>=Object.keys(eb).length?this.Ee.wf(bi.a.A8h,ia):(Fb=eb[Fb.toString()],eb=this.Ee.oQ(),eb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=
Fb,eb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=Fb.length,ia(eb))):this.Ee.wf(bi.a.internalError,ia)};c.prototype.X8i=function(G,ia){var eb=G[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];G=G.DdaMethod.ControlId;eb=E.getInstance(this.$).W8i(G,eb);eb===bi.a.success?this.Ee.lv(ia):this.Ee.wf(eb,ia)};c.prototype.dsj=function(G,ia){var eb=this;G.DdaSetBindingData.CoerceType=c.Z2b(G.DdaSetBindingData.CoerceType);if(this.Eic(G.DdaSetBindingData.CoerceType,ia)){var Fb=
this.Mdd(G.DdaMethod.ControlId);if(Fb){var Oc=c.UYc(G.DdaSetBindingData.CoerceType,G.DdaSetBindingData.Data),Tc=zj.g(this.$).ha;1===Oc.CoerceType&&(!Oc.Data&&Tc.sa.r_&&(Oc.Headers||(Oc.Headers=[]),Oc.Headers.length||Oc.Headers.push([]),Oc.Headers[0].length||Array.add(Oc.Headers[0],"")),c.Ifc(Oc)||(Oc.CellFormat||(Oc.CellFormat=G.DdaSetBindingData.CellFormat),Oc.TableOptions||(Oc.TableOptions=G.DdaSetBindingData.TableOptions)));if(c.Ifc(Oc))this.Ee.wf(bi.a.oBc,ia);else{var Md=Tc.sa.qd.clone(),Qd=Tc.sa.activeCell.clone();
this.iA.ddaSetSelectedData(G.DdaMethod.ControlId,Fb,Oc,function(Je){var kf;if(qi.a(Je))eb.Ee.uH(Je,ia);else{Je=Md.clone();var xf=Oc.Headers?Oc.Headers[0].length:Oc.Data[0].length;1!==Oc.CoerceType||Oc.Data?1===Oc.CoerceType&&(null===(kf=Oc.TableOptions)||void 0===kf?0:kf.length)&&0==Oc.TableOptions[0]?(Je.top+=1,Je.bottom=Je.top+Oc.Data.length-1):Je.bottom=Je.top+Oc.Data.length-(1===Oc.CoerceType?0:1):Je.bottom=Je.top+1;Je.right=Je.left+xf-1;kf=Je.contains(Qd)?Qd:Je.topLeft;Tc.updateSelection(Je,
kf,0);eb.Ee.lv(ia)}},ia)}}else this.Ee.wf(bi.a.Ewe,ia)}};c.prototype.addBinding=function(G,ia,eb,Fb){var Oc=this;ia?this.iA.ddaAddBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,G.DdaBindingsMethod.BindingType,ia,eb,function(Tc){if(qi.a(Tc))Oc.Ee.uH(Tc,Fb);else{var Md=Oc.Ee.oQ();Md.Bindings=Array(1);Md.Bindings[0]=Oc.Je.J0b(Tc.Result);Fb(Md)}},Fb):this.Ee.wf(bi.a.slj,Fb)};c.prototype.YIh=function(G,ia){var eb=this;this.iA.ddaGetBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,
function(Fb){if(qi.a(Fb)||!Fb.Result)eb.Ee.uH(Fb,ia);else{var Oc=eb.Ee.oQ();Oc.Bindings=Array(1);Oc.Bindings[0]=eb.Je.J0b(Fb.Result);ia(Oc)}},ia)};c.prototype.kOh=function(G){var ia=this.Ee.oQ(),eb={};eb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;ia[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=eb;G(ia)};c.prototype.V8i=function(G,ia){var eb=this;this.iA.ddaReleaseBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(Fb){qi.a(Fb)?
eb.Ee.uH(Fb,ia):eb.Ee.lv(ia)},ia)};c.prototype.$Hh=function(G,ia){var eb=this;this.iA.ddaGetAllBindings(G.DdaMethod.ControlId,function(Fb){if(qi.a(Fb))eb.Ee.uH(Fb,ia);else{var Oc=eb.Ee.oQ();if(Fb.Result){Fb=Fb.Result;Oc.Bindings=Array(Fb.length);for(var Tc=0;Tc<Fb.length;Tc++)Oc.Bindings[Tc]=eb.Je.J0b(Fb[Tc])}else Oc.Bindings=null;ia(Oc)}},ia)};c.prototype.Jtd=function(G,ia){var eb=this;this.iA.ddaLoadSettings(G.DdaMethod.ControlId,function(Fb){if(qi.a(Fb))eb.Ee.uH(Fb,ia);else{var Oc=eb.Ee.oQ();Oc.Properties=
Fb.Result;ia(Oc)}},ia)};c.prototype.saveSettings=function(G,ia){for(var eb=this,Fb={Settings:[]},Oc=0;Oc<G.DdaSettingsMethod.Properties.length;Oc++){var Tc={};Tc.Name=G.DdaSettingsMethod.Properties[Oc][0];Tc.Value=G.DdaSettingsMethod.Properties[Oc][1];Fb.Settings[Oc]=Tc}this.iA.ddaSaveSettings(G.DdaMethod.ControlId,Fb,G.DdaSettingsMethod.OverwriteIfStale,function(Md){qi.a(Md)?eb.Ee.uH(Md,ia):eb.Ee.lv(ia)},ia)};c.prototype.cme=function(G,ia){var eb=this,Fb=c.UYc(1,G.DdaAddRowsColumns.Data);c.Ifc(Fb)?
this.Ee.wf(bi.a.oBc,ia):this.iA.ddaAddRowsColumns(G.DdaMethod.ControlId,G.DdaAddRowsColumns.BindingId,G.DdaAddRowsColumns.IsRow,Fb,function(Oc){qi.a(Oc)?eb.Ee.uH(Oc,ia):eb.Ee.lv(ia)},ia)};c.prototype.Jch=function(G,ia){var eb=this;this.iA.ddaDeleteAllDataValues(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(Fb){qi.a(Fb)?eb.Ee.uH(Fb,ia):eb.Ee.lv(ia)},ia)};c.prototype.BXg=function(G,ia){var eb=this;this.iA.ddaClearBindingFormats(G.DdaMethod.ControlId,G.DdaClearBindingFormats.BindingId,
function(Fb){qi.a(Fb)?eb.Ee.uH(Fb,ia):eb.Ee.lv(ia)},ia)};c.prototype.SXf=function(G,ia){var eb=this,Fb={},Oc=G.DdaSetBindingFormats.IsSetFormats;Oc?Fb.CellFormat=G.DdaSetBindingFormats.CellFormat:Fb.TableOptions=G.DdaSetBindingFormats.TableOptions;this.iA.ddaSetBindingFormats(G.DdaMethod.ControlId,G.DdaSetBindingFormats.BindingId,Fb,Oc,function(Tc){qi.a(Tc)?eb.Ee.uH(Tc,ia):eb.Ee.lv(ia)},ia)};c.prototype.executeRichApiRequest=function(G,ia){var eb=this,Fb,Oc=G.ArrayData,Tc={},Md=zj.g(this.$).ha;if(Oc){if("WacPartition"===
Oc[0]){this.axh(G,ia);return}var Qd=Object(Fi.a)(db.DdaFacade,Ii.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===Oc[0]){var Je=Qd.pn(G.DdaMethod.ControlId);Je&&(Je.Fpd=!0,Je.XIf())}Tc.HttpMethod=Oc[1];Tc.PathAndQuery=Oc[2];Tc.RequestHeaders=c.AZe(Oc[3]);Tc.RequestBody=Oc[4];Tc.AppPermission=Oc[5];Je=Oc[6];Tc.RequestFlags=Je;var kf=0;if(Oh.i(this.$.qa))switch(Md.Ue){case 1:kf=2;break;case 2:kf=3;break;case 128:kf=4;break;default:kf=1}var xf=null;Md.Oa.FC&&(xf=Md.Oa.FC.jj);Tc.SheetMultiRange=
Eh.r(Md.sa.selectedRanges,this.$);Tc.ActiveCell=Eh.v(Md.sa.activeCell,this.$);Tc.ActiveChartId=xf;Tc.SelectionState=kf;kf=this.Je.FZ(G.DdaMethod.ControlId);Tc.InstanceId=kf?kf.InstanceId:"";if(kf&&kf.PrimaryMarketplace){xf=db.DdaFacade.getSolutionId(kf,this.$);var og=kf.PrimaryMarketplace.MarketplaceType;if(og===OSF.StoreType.InMemory){if(!kf.OwnerAddinSolutionId){this.Ee.wf(bi.a.qyb,ia);return}if(kf.AssetMarketplace)og=kf.AssetMarketplace.MarketplaceType;else{this.Ee.wf(bi.a.qyb,ia);return}}else og===
OSF.StoreType.WopiCatalog&&(og=OSF.StoreType.OMEX);var Ug=Telemetry.PrivacyRules.GetPrivacyCompliantId(xf,og,null===(Fb=kf.AssetMarketplace)||void 0===Fb?void 0:Fb.SolutionId,null,null,kf.PrimaryMarketplace.MarketplaceRef);Tc.CompliantSolutionId=Ug;Tc.SolutionId=xf;Tc.MarketplaceType=og;Tc.SolutionVersion=kf.PrimaryMarketplace.SolutionVersion;Tc.StoreLocation=kf.PrimaryMarketplace.MarketplaceRef}else Tc.SolutionId=Tc.MarketplaceType="",Tc.CompliantSolutionId="";Tc.IsEventsEnabled=void 0===Qd||null===
Qd||Qd.ij.U_b(Tc.InstanceId);Tc.RequestGuid=Xf.a.create().toString();Fb=Tc.RequestBody.length;if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&Fb>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.Ee.wf(bi.a.Sej,ia);$e.ULS.sendTraceTag(537163213,0,50,"Request payload size:{0} exceeded the limit",Fb);return}Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Je&4096&&(Fb=new Z(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Fb,
W,Oc),Tc.RequestBody=Oc[4])}var kh=c.B1e(Tc.RequestHeaders);c.sDd++;var Yi=Qh.a.Ta.Wb;Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&Tc&&Tc.RequestBody&&$e.ULS.sendTraceTag(537163212,0,50,String.format("Richapi json request body size is {0}",Tc.RequestBody.length));this.iA.executeRichApiRequest(Tc,function(Ah){var yi;eb.bXf(Yi,!0,Ah.ServerCorrelationId);var Ki=null,Rj=null,ej=Ah.ServerCorrelationId;if(null===(yi=null===Ah||void 0===Ah?void 0:Ah.Errors)||void 0===
yi?0:yi[0])Ki=Ah.Errors[0].MessageIdName,Rj=Ah.Errors[0].Description,Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&Kj.a(eb.$).ud.kE(Ah.Errors[0].MessageId);if(qi.a(Ah)||!Ah.Result)eb.QNa(ej,kh,"Server error",Ki,Rj),eb.Ee.uH(Ah,ia);else{var tj=null;if(Ag.EwaSettings.ma(259))if((yi=Ah.Result)&&yi.length){for(var fk=0;fk<yi.length;fk++)if(yi[fk].RequestGuid===Tc.RequestGuid){tj=yi[fk];break}tj||eb.Ee.uH(Ah,ia)}else tj=Ah.Result;else tj=Ah.Result;if(!Ki&&tj&&tj.ResponseBody&&
tj.ResponseBody[0])if(Ah=tj.ResponseBody[0],Ah.startsWith('{"Error":')){1<tj.ResponseBody.length&&(Ah=Ah.substring(0,Ah.indexOf("}")+1),Ah+="}");try{var pk=di.a.mi(Ah);pk.Error&&eb.QNa(ej,kh,"Pipeline error",pk.Error.Code,pk.Error.Message)}catch(yl){eb.QNa(ej,kh,"Json deserialize error",null,"Error info cannot be deserialized.")}}else eb.QNa(ej,kh);else eb.QNa(ej,kh,"Server error",Ki,Rj);var qk=(pk=tj.SheetMultiRange)?pk.SheetName:null;Ah=tj.ActiveChartId;var Fj=tj.SelectionState;Ki=5===Fj&&!!pk||
6===Fj||7===Fj||8===Fj;if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&eb.$.zb.Kz&&Ki)eb.Ee.wf(bi.a.vDc,ia),$e.ULS.sendTraceTag(537163211,0,50,String.format("{0} is not allowed",Fj.toString()));else if(5===Fj&&pk){if(eb.$.xa&&qk)if(eb.$.xa.rj(qk))eb.TTc(qk);else{var ul=null;ul=function(){eb.$.xa.rj(qk)&&($e.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),eb.TTc(qk),eb.$.xa.iIb(ul))};eb.$.xa.ynb(ul);if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var vl=
null;vl=function(){eb.$.xa.rj(qk)&&(eb.TTc(qk),eb.$.xa.Pma(vl))};eb.$.xa.Oga(vl)}}}else if(6===Fj||7===Fj||8===Fj||9===Fj){if(pk){var xl=Eh.g(pk.Ranges);if(qk&&Eh.cb(xl,!0))if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!eb.$.xa.rj(qk)){var wl=null;wl=function(){eb.pdg(Md,xl,qk,Fj);eb.$.xa.Pma(wl)};eb.$.xa.Oga(wl)}else eb.pdg(Md,xl,qk,Fj)}7===Fj?(Ah="38.{"+uk.c(Ah)+"}",Tj.a(eb.$).jna(0,Ah,!0)):8===Fj&&Tj.a(eb.$).jna(2,Ah,!0);9===Fj&&(eb.$.ya.ApiCallToSetPageLayout=
!0)}tj.PostProcessActions?eb.$.tff?(ej=di.a.mi(tj.PostProcessActions),eb.sZi(ej).then(function(){eb.scb(tj,ia);eb.Kad(G.DdaMethod.ControlId,Tc);return Promise.resolve(null)},function(yl){eb.scb(tj,ia,yl);return Promise.reject(yl)})):(eb.QNa(ej,kh,"Promise not supported",null,"Promise is not supported on this browser."),eb.Ee.wf(bi.a.internalError,ia)):eb.scb(tj,ia)}},function(Ah){eb.bXf(Yi,!1,null);eb.QNa(null,kh,"Web service error");ia(Ah)})};c.prototype.Kad=function(G,ia){var eb=Object(Fi.a)(db.DdaFacade,
Ii.a(this.$));(null===eb||void 0===eb?0:eb.ULd)&&eb.pn(G)&&c.Wvj(ia.RequestHeaders)&&($e.ULS.sendTraceTag(537163209,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",G,ia.SolutionId),eb.ULd.flh(G))};c.prototype.axh=function(G,ia){var eb=this,Fb=this.Je.FZ(G.DdaMethod.ControlId),Oc=db.DdaFacade.getSolutionId(Fb,this.$),Tc=null;Tc=db.DdaFacade.Uua(Fb,this.$);Tc=new B(Tc,this.$);Tc=new e(Oc,G.DdaMethod.ControlId,this.Je,this.$,Tc);var Md=
{ResponseHeaders:[]};Md.ResponseBody=Array(1);Fb=c.AZe(G.ArrayData[3]);var Qd=c.B1e(Fb);Fb=new ma(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.grf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Tc,pa,Fb,G.ArrayData).then(function(Je){if(!Je)return eb.Bud(!1,"The rich api executor call failed",Qd),$e.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Md.ResponseStatusCode=500,eb.scb(Md,ia),null;eb.Bud(!0,"The rich api executor call succeeded",Qd);Md.ResponseStatusCode=
Je[0];Md.ResponseBody[0]=Je[2];eb.scb(Md,ia);return null},function(Je){Md.ResponseStatusCode=400;Md.ResponseBody[0]=Je.toString();eb.Bud(!1,"The rich api executor call failed",Qd);$e.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",Oc);eb.scb(Md,ia);return null})};c.prototype.bXf=function(G,ia,eb){c.sDd--;G=De.a(Qh.a.Ta,G);$e.ULS.sendTraceTag(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",
G,c.sDd,ia?"success":"false",eb)};c.prototype.scb=function(G,ia,eb){eb=void 0===eb?null:eb;var Fb=Array(3);Fb[0]=G.ResponseStatusCode;Fb[1]=c.fYh(G.ResponseHeaders);var Oc=[],Tc=!1;if(eb&&G.ResponseBody){var Md=di.a.mi(G.ResponseBody.join(""));Md.Error||(Tc={},Tc.Error=eb,Tc.TraceIds=Md.TraceIds,Tc.ProcessedResults={},Tc.ProcessedResults.Results=Md.Results,Oc[0]=di.a.Kc(Tc),Tc=!0)}Fb[2]=Tc?Oc:G.ResponseBody;G=this.Ee.oQ();G.Data=Fb;ia(G)};c.prototype.txd=function(G,ia){(new D(this.$,this.Ee,this.iA)).txd(G,
ia)};c.prototype.Jzi=function(G,ia){$e.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");var eb=G[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],Fb=G[Hg.a.TVc],Oc=G[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];G=this.$.da.Aa(232).r1a.Kzi(G.DdaMethod.ControlId,eb,Fb,Oc);G===bi.a.success?this.Ee.lv(ia):($e.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.Ee.wf(G,ia))};c.prototype.Fzi=function(G,ia){$e.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");
var eb=G[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],Fb=G[Hg.a.TVc],Oc=G[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.Aa(232).r1a.rmj(G.DdaMethod.ControlId,eb,Fb,Oc);this.Ee.lv(ia)};c.prototype.getAccessToken=function(G,ia){function eb(Tc,Md){var Qd;if(Tc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Tc=Fb.Ee.oQ(),Tc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Md.accessToken,ia(Tc);else{Md=Fb.Je.FZ(G.DdaMethod.ControlId);var Je=null!==Md.OwnerAddinSolutionId?
Md.OwnerAddinSolutionId:Md.PrimaryMarketplace.MarketplaceType,kf={};$e.ULS.sendTraceTag(537163202,0,10,"{0}.",(kf.errorCode=Tc.toString(),kf.appId=Telemetry.PrivacyRules.GetPrivacyCompliantId(db.DdaFacade.getSolutionId(Md,Fb.$),Je,null===(Qd=Md.AssetMarketplace)||void 0===Qd?void 0:Qd.SolutionId,null,null,Md.PrimaryMarketplace.MarketplaceRef),kf.storeType=Je,kf));Fb.Ee.wf(Tc,ia)}}var Fb=this;$e.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");var Oc=!Ag.EwaSettings.ma(24);Rh.TaskExtensions.Ba(jj.GetServiceTaskFactory.create(this.$.da,
137,this.$.la,1),function(Tc){var Md=Fb.Je.Fi,Qd=va.getInstance();Mh.AppsForOfficeSingleSignOnManager.getInstance(Md,Tc.result,Qd).getAccessToken(G.DdaMethod.ControlId,Oc,G,eb)},this.$.la)};c.prototype.getAuthContext=function(G,ia){var eb=this;Rh.TaskExtensions.Ba(jj.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),function(){var Fb=eb.Je.Fi.getOsfControl(G.DdaMethod.ControlId);if(!Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||Fb.isFirstParty()){Fb=
Fb.getManifest();var Oc=Fb.getMarketplaceID(),Tc=Fb.getWebApplicationId(),Md=Fb.getWebApplicationMsaId();mc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(Oc).then(function(Qd){var Je=eb.Ee.oQ(),kf={};kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Tc;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Md||Tc;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Qd.upn;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=
Qd.userId;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Qd.authority;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=af.IIh(Qd.authorityType);kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Qd.isAnonymous;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Qd.tenantId;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Qd.supportsAuthToken;Je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
kf;ia(Je)},function(Qd){var Je=eb.Ee.oQ(),kf={},xf=new af;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Tc;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Md||Tc;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=xf.upn;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=xf.userId;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=xf.authority;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=xf.authorityType;
kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=xf.isAnonymous;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=xf.tenantId;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Qd;kf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=xf.supportsAuthToken;Je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=kf;Je.Error=1;ia(Je)})}},this.$.la)};c.prototype.Wfi=function(G){var ia=zj.g(this.$).ha;return 16===ia.Ue&&!!ia.Oa.oc&&
!!ia.Oa.oc.floatingObject&&Oj.a.equals(ia.Oa.oc.floatingObject.id,G,!0)};c.prototype.Mdd=function(G){var ia=zj.g(this.$).ha;return ia.sa.Ig?1===ia.Ue||this.Wfi(G)?ia.hia:null:null};c.prototype.Eic=function(G,ia){return 1!==G&&2!==G&&3!==G?(this.Ee.wf(bi.a.Oze,ia),!1):!0};c.prototype.Bud=function(G,ia,eb){var Fb={};Fb.a=this.$.ya.UserSessionId;Fb.b=G;Fb.c=ia;Fb.d=null;Fb.e=eb;Nj.b().Qe(37,Fb)};c.prototype.QNa=function(G,ia,eb,Fb,Oc){eb=void 0===eb?null:eb;Fb=void 0===Fb?null:Fb;Oc=void 0===Oc?null:
Oc;var Tc={};G&&(Tc.ServerCorrelationId=G);void 0!==ia&&null!==ia&&(Tc.Source=ia);eb&&(Tc.ErrorType=eb);Fb&&(Tc.MessageId=Fb);Oc&&(Tc.StatusDescription=Oc);Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&Fb&&"ExternalDataRefreshFailed"===Fb&&(Tc.StatusDescription="");$e.ULS.sendTraceTag(50688452,0,50,di.a.Kc(Tc))};c.prototype.sZi=function(G){for(var ia=new Promise(function(Fb){Fb(null)}),eb=0;eb<G.length;eb++)ia=this.rZi(ia,G[eb]);return ia};c.prototype.rZi=function(G,
ia){var eb=this;if(!ia)return $e.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),G.then(function(){return Promise.reject(c.n3a(M.generalException,gi.a.instance.fa(1728),null))});switch(ia.actionType){case 1:case 2:G=G.then(function(){var Fb=Object(Fi.a)(db.DdaFacade,Ii.a(eb.$));if(Fb.pn(ia.controlId))switch(Fb.ij.g2h(ia),ia.messageType){case 14:case 100:Fb.TLd.r0b(ia);break;case 11:case 12:Fb.Chj.Cob(ia);break;case 51:case 52:Fb.Ahj.Cob(ia);break;case 2101:case 2102:Fb.Bhj.Cob(ia);break;
case 2E3:Fb.Dhj.r0b(ia);break;case 2201:eb.$.Dka&&Fb.ULd.LLg(ia);break;case 2203:Fb.Ehj.MLg(ia);break;case 2700:Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&Fb.SLd.r0b(ia)}else $e.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId[{0}] doesn't exist.",ia.controlId);return Promise.resolve(null)});break;case 3:G=G.then(function(){eb.V1h(ia);return Promise.resolve(null)});break;case 15:Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(G=G.then(function(){eb.u3h(ia);
return Promise.resolve(null)}));break;case 4:G=G.then(function(){if(Ag.EwaSettings.ma(105)){var Fb=zj.g(eb.$).ha.sa.activeCell;Fb.top!==ia.row+1&&Fb.left!==ia.column+1&&(Fb=Eh.v(kk.Range.hd(ia.row+1,ia.column+1),eb.$),zj.g(eb.$).Gg(Fb,null,null,null,3,Ej.a.sbh));ih.a(eb.$,243,242,0,function(Oc){Oc.wdb(ia.row+1,ia.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:G=G.then(function(){Object(Fi.a)(db.DdaFacade,Ii.a(eb.$)).ij.SKe(ia.controlId,ia.isEnableEvents);return Promise.resolve(null)});
break;case 5:G=G.then(function(){return eb.R$g(ia)});break;case 6:G=G.then(function(){return eb.DUi(ia)});break;case 8:G=G.then(function(){Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(Fi.a)(db.DdaFacade,Ii.a(eb.$)).AXg();var Fb=new Ci.a(Bj.a.Jk,5,null);Zh.a(eb.$).wt(Fb);return Promise.resolve(null)});break;case 9:G=G.then(function(){return eb.boj(ia)});break;case 10:G=G.then(function(){return eb.XWj(ia)});break;case 11:G=G.then(function(){return eb.WWj()});
break;case 12:G=G.then(function(){return eb.TWj()});break;case 13:G=G.then(function(){return eb.UWj(ia)});break;case 14:G=G.then(function(){return eb.VWj(ia)});break;case 16:G=G.then(function(){return Promise.resolve(ia)});break;case 17:G=G.then(function(){return eb.rkj(ia,Object(Fi.a)(db.DdaFacade,Ii.a(eb.$)))});break;case 18:zj.g(this.$).focus();break;case 19:this.L4e(ia.entryType,!1,ia.options);break;case 20:this.L4e(ia.entryType,!0,ia.options);break;default:G=G.then(function(){return Promise.reject(c.n3a(M.iJg,
gi.a.instance.fa(1729),null))})}return G};c.prototype.u3h=function(G){var ia=Object(Fi.a)(db.DdaFacade,Ii.a(this.$)).pn(G.controlId);if(ia&&!(0===G.operationType^!ia.Ada)){zj.g(this.$).Whc=!0;switch(G.operationType){case 0:var eb=new mh.a(document.createElement("input"));eb.text=G.range;ia.Dai(zj.g(this.$).rg.n9g(eb,new Jd.a(this.$)));ia.Ada.startEdit(!0);break;case 1:ia.WOf();this.rangePicker=null;break;case 2:ia.Ada.Edg(G.range);break;case 3:ia.Ada.Edg(G.startingRange);ia=G.expandSelection;eb=G.getNextDataRegionCell;
var Fb=0;switch(G.keyboardDirectionValue){case 2:Fb=38;G=ia&&eb?105288353:ia?-31900117:eb?542791952:137938150;break;case 3:Fb=40;G=ia&&eb?-1297307319:ia?-1603798598:eb?1713663844:-798660877;break;case 0:Fb=37;G=ia&&eb?-403586027:ia?2039316657:eb?-2012742350:-1470715894;break;case 1:Fb=39;G=ia&&eb?784916030:ia?589730764:eb?1324884057:-1231471547;break;default:G=1461300262}ia=this.J4b("keydown",Fb,ia,eb);zj.g(this.$).dJb(ia,new Bk.a(G,1,0,8,null))}zj.g(this.$).Whc=!1}};c.prototype.J4b=function(G,ia,
eb,Fb){var Oc=document.createEvent("KeyboardEvent");if(hb.a.wF)Oc.initKeyboardEvent(G,!1,!1,window.self,"A",0,Fb,!1,eb,!1);else{var Tc="";eb&&(Tc+="Shift");Fb&&(Tc+=0<Tc.length?" Control":"Control");Oc.initKeyboardEvent(G,!1,!1,window.self,"A",0,Tc,!1,"en-US")}G=new Sys.UI.DomEvent(Oc);G.keyCode=ia;return G};c.prototype.V1h=function(G){switch(G.operationType){case 1:Rh.TaskExtensions.Ba(jj.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1),function(ia){ia.result.QKd()},this.$.la,3);break;case 2:if(G=
Object(Fi.a)(db.DdaFacade,Ii.a(this.$)).pn(G.controlId))G.Fpd=!0,G.XIf()}};c.prototype.R$g=function(G){var ia=this,eb=G.fileBase64;return eb&&eb.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(c.n3a(M.invalidArgument,gi.a.instance.fa(1732),"Application.CreateWorkbook")):(new Promise(function(Fb,Oc){var Tc=new Mi.StandardDialog;Tc.jc=4;Tc.yk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Md){2!==Md&&0!==Md||Oc(c.n3a(M.xCd,gi.a.instance.fa(1731),
"Application.CreateWorkbook"));Md=new xa("blank","agave",eb?"streamBase64":"streamEmpty",eb);ia.grf.create(Fb,Oc,Md).G0a()})})).then(function(Fb){ia.r9b.set(G.fakeFileId,Fb);return Promise.resolve(null)},function(Fb){return Fb?Promise.reject(Fb):Promise.reject(c.n3a(M.generalException,gi.a.instance.fa(1728),"Application.CreateWorkbook"))})};c.prototype.DUi=function(G){var ia=this;return new Promise(function(eb,Fb){if(ia.r9b.has(G.fakeFileId)){var Oc=ia.r9b.get(G.fakeFileId);Fb=new Mi.StandardDialog;
Fb.jc=4;Fb.yk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(Tc){1===Tc&&bl.HelperMethods.jf(Oc,void 0,void 0,"DdaMethodHandler.fileUrl");eb(null)})}else Fb(c.n3a(M.generalException,gi.a.instance.fa(1728),"Document.Open"))})};c.prototype.boj=function(G){var ia=this;return new Promise(function(eb){Object(Fi.a)(db.DdaFacade,Ii.a(ia.$)).ETf=G.runtimeCalculationMode;var Fb=ia.$.da.Aa(268);Fb&&Fb.vyd(3===G.runtimeCalculationMode);eb(null)})};c.prototype.XWj=
function(G){Hb.a.CAb(this.$)&&this.$.da.Aa(331).tcb(0,G.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.WWj=function(){Hb.a.CAb(this.$)&&this.$.da.Aa(331).tcb(1,null,!0,!0,null);return Promise.resolve(null)};c.prototype.TWj=function(){Hb.a.CAb(this.$)&&this.$.da.Aa(331).PKe();return Promise.resolve(null)};c.prototype.UWj=function(G){Hb.a.CAb(this.$)&&this.$.da.Aa(331).tcb(5,G.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.VWj=function(G){if(Hb.a.CAb(this.$)){var ia=this.$.da.Aa(331);
ia=El(ia.qaa);for(var eb=ia.next();!eb.done;eb=ia.next())eb=eb.value,eb.IsActive&&eb.HostEditUrl&&eb.UrlStr===G.hostEditUrlStr&&bl.HelperMethods.jf(eb.HostEditUrl,"_blank")}return Promise.resolve(null)};c.prototype.rkj=function(G,ia){var eb=Fh.a.lX;G=di.a.mi(G.payload);var Fb={};"eventId"in G&&"payload"in G&&(Fb.eventId=G.eventId,Fb.payload=G.payload);ia.NM(2201,eb,di.a.Kc(Fb));return Promise.resolve(null)};c.prototype.L4e=function(G,ia,eb){var Fb=this.$.da.Aa(5);Fb&&(G=this.BJh(G))&&(ia?Fb.removeEntry(G):
Fb.Ple(G,eb))};c.prototype.BJh=function(G){switch(G){case 0:return 63}};c.prototype.TTc=function(G){G=Object(Fi.a)(sg.a,this.$.xa.getItemByName(G));(null===G||void 0===G?0:G.visible)&&G.activate(!0)};c.prototype.pdg=function(G,ia,eb,Fb){var Oc=G.sa.rB,Tc=Oc<ia.length&&ia[Oc].contains(G.sa.activeCell);G=Tc?G.sa.activeCell:ia[0].topLeft;Oc=Tc?Oc:0;zj.g(this.$).IV(ia,Oc,eb,null,G,null,null,3,Ej.a.tbh,void 0,void 0,void 0,6===Fb)};c.AZe=function(G){if(!G||!G.length)return null;for(var ia=Array(G.length/
2),eb=0;eb<G.length/2;eb++)ia[eb]={},ia[eb].Name=G[2*eb],ia[eb].Value=G[2*eb+1];return ia};c.fYh=function(G){if(!G||!G.length)return null;for(var ia=Array(2*G.length),eb=0;eb<G.length;eb++)ia[2*eb]=G[eb].Name,ia[2*eb+1]=G[eb].Value;return ia};c.Yad=function(G){if(!G||!G.length)return null;for(var ia=Array(G.length),eb=0,Fb=G.length;eb<Fb;eb++){var Oc=G[eb].length;if(Oc){ia[eb]=Array(Oc);for(var Tc=0;Tc<Oc;Tc++)ia[eb][Tc]=null==G[eb][Tc]?null:G[eb][Tc].toString()}else return null}return ia};c.Z2b=
function(G){return"string"===typeof G?Ve.a.ao(c.obh,G,0):G};c.LSe=function(G){return"string"===typeof G?Ve.a.ao(c.rbh,G,0):G};c.Seg=function(G){return"string"===typeof G?Ve.a.ao(c.vbh,G,0):G};c.igi=function(G){switch(G.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};c.UYc=function(G,ia){var eb={};eb.CoerceType=G;1===eb.CoerceType?(eb.Data=c.Yad(ia.Rows),eb.Headers=c.Yad(ia.Headers)):eb.Data=c.Yad(ia);return eb};c.mue=function(G){if(1===G.CoerceType){var ia=
{};return ia.Headers=G.Headers,ia.Rows=G.Data,ia}return G.Data};c.Ifc=function(G){return 1===G.CoerceType?!G.Data&&!G.Headers:!G.Data};c.B1e=function(G){var ia="Unknown";if(!G)return ia;for(var eb=0;eb<G.length;eb++)if(G[eb].Name.toLowerCase()===Hj.a.Fhj){ia=G[eb].Value;break}return ia};c.Wvj=function(G){if(!G)return!1;for(var ia=Hj.a.HEi.toLowerCase(),eb=0;eb<G.length;eb++)if(G[eb].Name.toLowerCase()===ia)return!0;return!1};c.n3a=function(G,ia,eb){var Fb={};Fb.Code=G;Fb.Message=ia;Fb.Location=eb;
Fb.ActionIndex=0;return Fb};Ek.Object.defineProperties(c.prototype,{HQ:{configurable:!0,enumerable:!0,get:function(){return this.Ee}}});Ek.Object.defineProperties(c,{obh:{configurable:!0,enumerable:!0,get:function(){c.Gpa||(c.Gpa={},c.Gpa[Microsoft.Office.WebExtension.CoercionType.Table]=1,c.Gpa[Microsoft.Office.WebExtension.CoercionType.Text]=2,c.Gpa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,c.Gpa[Microsoft.Office.WebExtension.CoercionType.Html]=4,c.Gpa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=
5);return c.Gpa}},rbh:{configurable:!0,enumerable:!0,get:function(){c.Nhb||(c.Nhb={},c.Nhb[Microsoft.Office.WebExtension.FilterType.All]=1,c.Nhb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return c.Nhb}},vbh:{configurable:!0,enumerable:!0,get:function(){c.Ohb||(c.Ohb={},c.Ohb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,c.Ohb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return c.Ohb}}});c.Gpa=null;c.Nhb=null;c.Ohb=null;c.sDd=0;Object(me.a)(c,"DdaMethodHandler",
null,[429,3]);var Lj=mi.a;Am(a,Lj);a.prototype.Nd=function(){var G=this,ia=jj.GetServiceTaskFactory.create(this.$.da,106,this.la,this.ub),eb=jj.GetServiceTaskFactory.create(this.$.da,165,this.la,this.ub),Fb=Gc(this.la,this.ub);Rh.TaskExtensions.Ba(Rh.TaskExtensions.ye([ia,eb,Fb],this.la),function(){var Tc=ia.result,Md=mc.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");G.Cd([new c(G.$,Tc,Md)])},this.la,3);var Oc=mc.a.instance;Rh.TaskExtensions.Ba(jj.GetServiceTaskFactory.create(this.$.da,
137,this.$.la,this.ub),function(){Oc.register(Sa,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Hc().Oc(function(){return new Sa})},this.$.la)};a.ka=function(G){mi.a.fe(82,new a(G))};Object(me.a)(a,"DdaCommandHandlerFactory",mi.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");
Type.registerNamespace("_Ewa");ah.a.Ki("");ah.a.Ki(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=bh.a;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.WopiIdentity");dd.main();(function(){If.a.Fa(function(G){Ze.ka(G)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.AppsForOfficeCommon");(function(){If.a.Fa(function(G){Od.ka(G);Yd.ka(G)})})();(function(){If.a.Fa(function(G){eg.ka(G)})})();Type.registerNamespace("CommandUI.AddInCommands");(function(){If.a.Fa(function(G){Ag.EwaSettings.ma(54)&&jb.ka(G)})})();(function(){If.a.Fa(function(G){Ag.EwaSettings.ma(122)&&Uc.ka(G)})})();If.a.Fa(zb.ka);If.a.Fa(Kb.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(function(){If.a.Fa(function(G){Tb.ka(G);
Ha.ka(G);qa.ka(G)})})();If.a.Fa(a.ka)},1479:function(x,C,b){function a(){this.OEc=null;this.xJc=0;this.dLc=!1;this.Za=new f.a;this.fqg=new e.a}function c(){this.NJe=this.displayName=this.Uqb=this.Ko=this.GB=null;this.isUpgraded=!1}x=b(0);var e=b(202),f=b(97);c.prototype.bgf=function(l,m){return this.GB.getStoreType().toLowerCase()===l.toLowerCase()&&this.GB.getSolutionId().toLowerCase()===m.toLowerCase()};Object(x.a)(c,"AddinCommandsResourceItem",null,[]);b.d(C,"a",function(){return a});a.prototype.rDg=
function(l){this.Za.addHandler("AddinCommandsLoadingMessageChanged",l)};a.prototype.C$i=function(l){this.Za.removeHandler("AddinCommandsLoadingMessageChanged",l)};a.prototype.Vcb=function(l){l!==this.OEc&&(this.OEc=l,this.Za.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.Ynj=function(){this.xJc++;this.SYa||this.Vcb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.COd=function(){this.xJc--;this.Mtd()&&(this.dLc?this.SYa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Vcb(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.Vcb(null))};a.prototype.IYf=function(l){this.dLc=!0;this.Vcb((void 0===l?0:l)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)};a.prototype.jye=function(){this.dLc=!1;this.Mtd()?this.Vcb(null):this.Vcb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Mtd=function(){return 0>=this.xJc};a.prototype.Pia=function(l,m,r){r=void 0===r?0:r;for(var h=El(this.K5a),w=h.next();!w.done;w=h.next())if(w=w.value,w.bgf(l,m)&&(!w.Ko||w.Ko.fHh===r))return w;
return null};a.prototype.Jle=function(l,m,r,h){var w=new c;w.GB=l;w.Ko=m;w.Uqb=r;w.displayName=h;this.K5a.add(w)};a.prototype.xBg=function(l,m,r,h){var w=new c;w.GB=l;w.Ko=m;w.Uqb=null;w.NJe=r;w.displayName=h;this.K5a.add(w)};a.prototype.d9i=function(l,m){for(var r=0,h=El(this.K5a),w=h.next();!w.done;w=h.next())w=w.value,w.GB.getStoreType()===l&&w.GB.getSolutionId()===m?this.K5a.removeAt(r):r++};a.getInstance=function(){a.Ma||(a.Ma=new a);return a.Ma};Ek.Object.defineProperties(a.prototype,{SYa:{configurable:!0,
enumerable:!0,get:function(){return this.OEc}},K5a:{configurable:!0,enumerable:!0,get:function(){return this.fqg}}});a.Ma=null;Object(x.a)(a,"AddinCommandsResourceManager",null,[])},943:function(x,C,b){function a(){}b.d(C,"a",function(){return a});x=b(0);var c=b(35);a.bVe=function(e){return c.a.ao(a.Hzi,e.toString(),a.internalError)};Ek.Object.defineProperties(a,{Hzi:{configurable:!0,enumerable:!0,get:function(){var e={};return a.hbe||(a.hbe=(e["-2002156328"]=a.Oze,e["-1954750170"]=a.V1e,e["317650254"]=
a.uZg,e["-1005263101"]=a.Mci,e["1353664579"]=a.Klj,e["159671765"]=a.Nci,e["1446690022"]=a.hYe,e["1150069548"]=a.oBc,e["-1409306331"]=a.Ewe,e["338507772"]=a.PFe,e["-457159301"]=a.vVi,e["-1037701970"]=a.Qah,e["-1893322318"]=a.Sci,e["965579896"]=a.Sah,e["93287890"]=a.Rah,e["358088857"]=a.Koj,e["-1223650923"]=a.PFe,e["2007306190"]=a.gVg,e["1549955423"]=a.tte,e["-1275974171"]=a.Rci,e["382101082"]=a.GUi,e["-898776235"]=a.tBi,e["335464256"]=a.iBi,e["1677378049"]=a.Qci,e["-261992848"]=a.cOj,e["-980820954"]=
a.tte,e["-931375837"]=a.FUi,e["929186550"]=a.Eih,e["-982144310"]=a.s1i,e["-785741187"]=a.Kci,e["2125217573"]=a.Uci,e["299124955"]=a.Lci,e["1669853884"]=a.Uhj,e["-1515932330"]=a.vZg,e["314621024"]=a.DDh,e["-300049690"]=a.kVg,e["14766835"]=a.Ktj,e["-1251992761"]=a.SIe,e["-2087635043"]=a.invalidOrTimedOutSession,e["2100961153"]=a.invalidOrTimedOutSession,e["-1218744139"]=a.invalidSheetName,e["-1468309555"]=5006,e["-315732528"]=a.invalidOrTimedOutSession,e["611268539"]=a.invalidOrTimedOutSession,e["1531005923"]=
5006,e["1593924569"]=5006,e["299476328"]=a.vFa,e["49173765"]=a.vFa,e["-907155566"]=a.vFa,e["-1201603824"]=a.vFa,e["1541165282"]=a.vFa,e["-1347753427"]=a.vFa,e["134912532"]=a.vFa,e["1780971550"]=a.responsePayloadSizeLimitExceeded,e))}}});a.success=0;a.Oze=1E3;a.V1e=1001;a.uZg=1002;a.Mci=1003;a.Klj=1004;a.Nci=1005;a.hYe=1008;a.zSe=1009;a.invalidSheetName=1014;a.oBc=2E3;a.Ewe=2001;a.PFe=2002;a.vVi=2003;a.Qah=2004;a.Sci=2005;a.Sah=2007;a.Rah=2008;a.Koj=2009;a.gVg=2014;a.slj=3E3;a.tte=3002;a.Rci=3004;
a.GUi=3005;a.tBi=3006;a.iBi=3007;a.Qci=3008;a.cOj=3009;a.FUi=3010;a.Ktj=4002;a.ACd=5E3;a.internalError=5001;a.SIe=5002;a.qyb=5004;a.dPj=5007;a.A8h=5008;a.UOg=5009;a.invalidOrTimedOutSession=5012;a.vDc=5016;a.vFa=5102;a.Sej=5103;a.responsePayloadSizeLimitExceeded=5104;a.CUg=7001;a.$4f=7002;a.Eih=8E3;a.s1i=8001;a.Kci=8010;a.Uci=8011;a.Lci=8012;a.Uhj=8020;a.vZg=8021;a.DDh=8022;a.kVg=8023;a.mzi=11E3;a.iCi=11001;a.Tci=11002;a.hbe=null;Object(x.a)(a,"DdaErrorIds",null,[])},944:function(x,C,b){function a(){}
b.d(C,"a",function(){return a});x=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";a.uTc="AccessDenied";a.notSupported="NotSupported";a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.xCd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.gPj="UnsupportedUserIdentity";a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.qHg="AddinIsAlreadyRequestingToken";a.rgj="ResourceNotAllowed";
a.clientError="ClientError";a.serverError="ServerError";a.o2g="ControlIdNotFound";a.fhj="RibbonApiNotAvailable";a.hostRestartNeeded="HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(x.a)(a,"ErrorCodes",null,[])},946:function(x,C,b){function a(oa,fb){var Rb=fe.call(this)||this;Rb.ea=null;Rb.Hn=null;Rb.fi=null;Rb.If=[];Rb.OIa=null;Rb.tFe=!1;Rb.pPb=!1;Rb.initialized=!1;Rb.disposed=!1;Rb.aCa=null;Rb.dpc=[];Rb.oFe=[];
Rb.rPa=[];Rb.d1a=null;Rb.EDd=new bc.a(Kb.a.Pk());Rb.XZb=new ic.a(Kb.a.Pk());Rb.VFb=[];Rb.bGf=[];Rb.d6b=350;Rb.Zea=null;Rb.mxa=null;Rb.eTc=!1;Rb.hfe=null;Rb.efe=null;Rb.ife=null;Rb.gfe=null;Rb.kfe=null;Rb.Oug=null;Rb.ffe=null;Rb.jfe=null;Rb.lfe=null;Rb.mfe=null;Rb.nfe=null;Rb.Hf=function(){Rb.aCa=Rb.ea.Qm.WebExtensions;for(var dc=Rb.If.length-1;0<=dc;--dc){var uc=Rb.If[dc],Bd;if(Bd=!Rb.qBh(uc.controlId))Bd=uc,Bd=ib.EwaSettings.ma(122)?!Bd.dIa:!0;Bd&&(uc.$mc(),Array.removeAt(Rb.If,dc))}if(Rb.aCa)for(dc=
0,uc=Rb.aCa.length;dc<uc;dc++){Bd=Rb.aCa[dc];var Od=Rb.pn(Bd.WebExtensionId);Od&&Od.aBd(Bd)}};Rb.Xnc=function(dc){Rb.raiseEvent("csc",dc.getID())};Rb.Uzf=function(dc,uc,Bd){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&uc===OSF.AgaveHostAction.KeyboardShortcuts){var Od=Object(wb.a)(Object,Bd);uc={};uc.keyCode=Od.keyCode;uc.type="keydown";uc.ctrlKey=Od.ctrlKey;uc.shiftKey=Od.shiftKey;uc.altKey=Od.altKey;uc.metaKey=Od.metaKey;dc=Rb.pn(dc);Od=dc.dha;uc.srcElement=
Object(Wa.a)(497,Od)?Od.bGa:Mb.g(Rb.$).uc;uc=new Sys.UI.DomEvent(uc);dc={focusedAddinId:a.Uua(dc.il,Rb.$)};Od=new Ud.a(1461300262,1,Rb.$.ed,6,null);Mb.g(Rb.$).dJb(uc,Od,dc)}else if(uc===OSF.AgaveHostAction.Select)Rb.I4e(!0);else if(uc===OSF.AgaveHostAction.UnSelect)Rb.I4e(!1);else if(uc===OSF.AgaveHostAction.CancelDialog)Rb.iK(-684355545,null);else if(uc===OSF.AgaveHostAction.InsertAgave)dc={},Bd&&(dc[rc.a.Sra]=Bd,dc[ba.a.Cg]=a.Arb(Bd),Rb.iK(-741808261,dc));else if(uc===OSF.AgaveHostAction.InsertDevManifest)dc=
{},Bd&&(dc[rc.a.Sra]=Bd,dc[ba.a.Cg]=a.Arb(Bd),Rb.iK(-741808261,dc));else if(uc===OSF.AgaveHostAction.InsertDevManifestError)dc=Object(wb.a)(Object,Bd),uc={},dc=(uc[rc.a.SVc]=Rb.Hn.getDevManifestInvalidUrlErrorString(dc.manifestUrl),uc),Rb.iK(-2025863019,dc);else if(uc===OSF.AgaveHostAction.NotifyHostError)dc={},dc=(dc[rc.a.SVc]=Rb.Hn.getManifestInvaildErrorString(),dc),Rb.iK(-2025863019,dc);else if(uc===OSF.AgaveHostAction.RefreshAddinCommands)ib.EwaSettings.ma(54)&&Rb.iK(fc.a.refreshAddinCommands,
null);else if(uc===OSF.AgaveHostAction.CtrlF6Exit||uc===OSF.AgaveHostAction.CtrlF6ExitShift){if(Od=Rb.$.da.Aa(15)){(dc=Rb.pn(dc).dha)&&dc.Wyc();mb.a.Gf&&document.activeElement.blur();var Td={keyCode:117,type:"keydown",ctrlKey:!0};Td.shiftKey=uc===OSF.AgaveHostAction.CtrlF6ExitShift;Td.srcElement=Object(Wa.a)(497,dc)?dc.bGa:Mb.g(Rb.$).uc;dc=new Sys.UI.DomEvent(Td);Od.xca(dc)}}else if(uc===OSF.AgaveHostAction.PageIsReady){if((dc=Rb.pn(dc).dha)&&dc.$Ya===OSF.OsfControlTarget.TaskPane&&(dc=Rb.$.da.Aa(183))&&
Rb.If)for(uc=wa.a.Ld(Rb.$),Od=El(Rb.If),Td=Od.next();!Td.done;Td=Od.next())a.aMa(Td.value.MU)&&(uc?dc.Wf(!0,!1):dc.setFocusOnToolbarFirstElement())}else if(uc===OSF.AgaveHostAction.TabExit){uc=Rb.pn(dc);var Ze=uc.dha;if(Ze)if(Ze.$Ya===OSF.OsfControlTarget.InContent)Ze.xif();else{if(Ze.$Ya===OSF.OsfControlTarget.TaskPane)if(wa.a.Ld(Rb.$))mb.a.Gf&&document.activeElement.blur(),Db.UISurfaces.Yj().then(function(Wf){var ug=Object(Wa.a)(497,Ze)?Ze:null;ug?ug.isResizable?Wf.focusResizeHandle():Wf.focusTabbedTaskPaneArea():
Wf.focusTabbedTaskPaneArea();return null});else if(dc=Rb.$.da.Aa(183))mb.a.Gf&&document.activeElement.blur(),(uc=document.getElementById(Rb.$.Mb+hc.a.mmc))&&Zc.DOMElementExtensions.isVisible(uc)?Zc.DOMElementExtensions.setFocus(uc):dc.setFocusOnToolbarFirstElement()}else uc&&4===uc.osfControlType&&Rb.Hn.notifyAgave(dc,OSF.AgaveHostAction.TabIn)}else if(uc===OSF.AgaveHostAction.TabExitShift)(uc=Rb.pn(dc),Od=uc.dha)?Od.$Ya===OSF.OsfControlTarget.InContent?Od.yif():Od.$Ya===OSF.OsfControlTarget.TaskPane&&
(dc=Object(Wa.a)(497,Od)?Od:null)&&(mb.a.Gf&&document.activeElement.blur(),dc.TYf()):uc&&4===uc.osfControlType&&Rb.Hn.notifyAgave(dc,OSF.AgaveHostAction.TabIn);else if(uc===OSF.AgaveHostAction.EscExit||uc===OSF.AgaveHostAction.ExitNoFocusable||uc===OSF.AgaveHostAction.ExitNoFocusableShift)if(Od=Rb.pn(dc).dha)Od.Wyc();else{if(uc===OSF.AgaveHostAction.EscExit){uc=null;Od=El(Z.Y_h());for(Td=Od.next();!Td.done;Td=Od.next())if(Td=Td.value,Td.value.Pe===dc){Td.value.dialog.hide();uc=Td.key;break}uc&&(dc=
Rb.pn(uc))&&4!==dc.osfControlType&&Rb.Fi.notifyAgave(uc,OSF.AgaveHostAction.TabIn)}}else if(uc===OSF.AgaveHostAction.InstallCustomFunctions)if(ib.EwaSettings.ma(122)){jg.a(Rb.$).AUe(function(){return!1});var vf=Rb.$.da;Na.TaskExtensions.Ba(zc.GetServiceTaskFactory.Va(vf,278,279,1),function(Wf){Wf=Wf.result;vf.Aa(278)||vf.Ga(278,Wf);var ug=Bd.osfControl.getStoreType();Wf.V$e(Bd.osfControl.getSolutionId(),ug,a.kMh(Bd.osfControl),Bd).cna()},Rb.la,3)}else lb.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");
else if(uc===OSF.AgaveHostAction.UninstallCustomFunctions)if(ib.EwaSettings.ma(122)){jg.a(Rb.$).AUe(function(){return!1});var wf=Rb.$.da;Na.TaskExtensions.Ba(zc.GetServiceTaskFactory.Va(wf,278,279,1),function(Wf){Wf=Wf.result;wf.Aa(278)||wf.Ga(278,Wf);Wf.Qag(Bd.solutionId,Bd.storeType).cna()},Rb.la,3)}else lb.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else uc===OSF.AgaveHostAction.SendTelemetryEvent?e(Bd):uc===
OSF.AgaveHostAction.SendCustomerContent?c(Bd):uc===OSF.AgaveHostAction.LaunchExtensionComponent?Nb.a.instance.yqi(Bd):uc===OSF.AgaveHostAction.RefreshRibbonGallery?(dc=Rb.$.da.Aa(352))&&dc.Pid(Bd):uc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(Rb.e$i(Bd.solutionId),wa.a.Ld(Rb.$)||(dc=Rb.$.da.Aa(183))&&dc.nx(),ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&Ha.AFrameworkApplication.Ib.ve(fc.a.iOf,2,Bd.assetId)):uc===OSF.AgaveHostAction.GetOriginalControlId&&
(dc=new pb.a(Rb.$.Mb,Bd.ownerAddinSolutionId,new Uc.a,!0),Bd.originalControlId=dc?dc.FFe(Bd.controlId):Bd.controlId)};Rb.yTi=function(){Rb.$.qa&&Xe.o(Rb.$.qa)&&Rb.$.da.Aa(34).Tld()};Rb.zd=function(){Rb.xkf()};Rb.WR=function(dc,uc){var Bd,Od;1===uc.su&&(dc=uc.Lg)&&(uc=new l(Qe.toTimestamp(dc.enqueueUtcTime),Qe.toTimestamp(dc.processUtcTime),Qe.toTimestamp(dc.dequeueUtcTime),Qe.getElapsedMilliseconds(dc.enqueueUtcTime,dc.processUtcTime),Qe.getElapsedMilliseconds(dc.processUtcTime,dc.dequeueUtcTime),
dc.operationCount,(null===(Od=null===(Bd=dc.operation)||void 0===Bd?void 0:Bd.rd)||void 0===Od?0:Od.ServerCorrelationId)?dc.operation.rd.ServerCorrelationId:null,dc.operation?Enum.toString(Jc.a,dc.operation.operationName):null,lc.a.sB(Qe.getElapsedMilliseconds(dc.enqueueUtcTime,je.a.Ta.Wb))),Bd=Sys.Serialization.JavaScriptSerializer.serialize(uc),lb.ULS.sendTraceTag(50872916,0,50,Bd))};Rb.od=function(dc,uc){!Rb.ea.sc&&Lf.a(uc)?(Array.forEach(Rb.If,Rb.Cvf),Array.clear(Rb.If),Rb.pPb=!1):(uc.SH&&(lb.ULS.sendTraceTag(537170516,
0,50,"Silent Reload require reset osf controls."),Rb.DSf()),Rb.hL(),ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(Rb.pPb=!1))};Rb.Io=function(){ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(lb.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),Rb.DSf());Rb.hL();ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Rb.pPb=!1)};
Rb.Cvf=function(dc){dc.$mc();Rb.raiseEvent("cd",dc.controlId)};Rb.wb=oa;Rb.jWc=fb;Rb.initialize();aa.ka(Rb);Rb.ETf=0;(oa=(oa=!(mb.a.rp||mb.a.Bka))&&(!ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!mb.a.Gf))&&OfficeExt.ShortcutKeyDispatchManager.init();Rb.gqg={};return Rb}function c(oa){Nd.a.sendOtelCustomerContent(Object.assign(new le.a,{otelEvent:oa}))}function e(oa){Nd.a.sendOtelEvent(Object.assign(new le.a,{otelEvent:oa}))}function f(oa,fb,Rb){var dc=
pe.call(this,Rb,oa)||this;dc.hashCode=null;dc.Dva=null;dc.Q3b=!1;dc.Sm=function(uc,Bd){Bd.nd.hash===dc.hashCode&&dc.Dva&&Object(wb.a)(b(946).DdaFacade,dc.$.da.Aa(35)).ozj(dc.Dva.InstanceId)};dc.zf=function(uc,Bd){switch(Bd.nd.block.state){case 1:case 3:case 5:dc.zna(Bd)}};dc.Pi=function(){dc.UGb(!0)};dc.Go=function(uc,Bd){dc.isVisible&&dc.DTa(Bd.NF);dc.clearCache()};dc.Ge=function(uc,Bd){dc.GSa(Bd.qa,!!Bd.NF)};dc.RN=function(){dc.$.ea.hma()};dc.kUa=fb;dc.domElement.classList.add(rd.a.O8b);dc.domElement.classList.add(tf.a.$o);
Rb.tabIndex=0;dc.GSa(dc.$.qa,!1);dc.Jc.ka("mousedown",dc.RN);dc.Jc.ka("contextmenu",function(uc){Kd.g(uc)});dc.$.xa.AJ(dc.Go);dc.$.Hb.AJ(dc.Go);dc.$.Hb.Bg(dc.Ge);dc.$.xa.Bg(dc.Ge);dc.Ea.Us(dc.zf);dc.Ea.PG(dc.Sm);dc.Ea.Gx(dc.Pi);ib.EwaSettings.qc()&&dc.Nt(dc.nya);return dc}function l(oa,fb,Rb,dc,uc,Bd,Od,Td,Ze){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;
this.IsDocumentHidden=!1;this.enqueueUtcTime=oa;this.processUtcTime=fb;this.dequeueUtcTime=Rb;this.inQueueDurationInMS=dc;this.executionDurationInMS=uc;this.operationCount=Bd;this.ServerCorrelationId=Od;this.UserOperationName=Td;this.IsDocumentHidden=Ze}function m(oa,fb,Rb){this.$=oa;this.ij=fb;this.runtimeCalculationMode=Rb}function r(){}function h(oa,fb,Rb){var dc=this;this.JEf=null;this.Jad=function(uc,Bd){var Od=bd.a.lX,Td={};Td.eventId=uc;Td.payload=Bd;dc.ij.j_(2201,Od)&&dc.fi.NM(2201,Od,md.a.Kc(Td))};
this.$=oa;this.ij=fb;this.fi=Rb;this.gai()}function w(oa,fb,Rb){var dc=this;this.CHb=0;this.qgg=!0;this.q$b=0;this.oqd=!0;this.Nxe=function(){var uc=document.hasFocus();if(dc.qgg!==uc){if(uc){var Bd=md.a.Kc({});dc.fi.NM(2203,bd.a.lX,Bd)}dc.qgg=uc}};this.Oxe=function(uc){(0<uc.timeRemaining()||uc.didTimeout)&&dc.Nxe();window.requestIdleCallback(dc.Oxe)};this.$=oa;this.ij=fb;this.fi=Rb;window.requestIdleCallback||(this.oqd=!1)}function n(oa,fb,Rb){var dc=this;this.BHb=0;this.X$a=this.dab=null;this.QDf=
function(){var uc=Mb.g(dc.$).ha.Oa.FC;if(uc)if(dc.Ghf(uc)){var Bd=dc.nja();dc.Lad(Bd);dc.dab=uc.floatingObject.id;dc.X$a=Bd}else dc.dab&&(dc.Lad(dc.X$a),dc.dab=null,dc.X$a=null);else dc.dab&&(dc.Lad(dc.X$a),dc.dab=null,dc.X$a=null)};this.$=oa;this.ij=fb;this.fi=Rb}function v(oa,fb,Rb){var dc=this;this.N2b=null;this.ord=!1;this.onPointerDown=function(uc){if(3===uc.yb){var Bd=dc.gridView.uac(uc.clientPoint).$Ga;dc.ord=!!Bd&&dc.gridView.ha.sa.TIe(Bd)}else dc.ord=!1;dc.N2b=uc.clientPoint;return!1};this.vd=
function(uc){if(dc.gridView.inRangePicker||dc.gridView.Mi||dc.ord||uc.shiftKey||uc.ctrlKey||uc.Ca.button!==Sys.UI.MouseButton.leftButton||!dc.N2b||!uc.clientPoint||uc.clientPoint.x!==dc.N2b.x||uc.clientPoint.y!==dc.N2b.y)return!1;var Bd=dc.gridView.uac(uc.clientPoint);uc=Bd.$Ga;Bd=Bd.returnValue;var Od=Object(wb.a)(ed.a,dc.$.xa.qa);if(Bd&&Od&&0===Od.GI){if(!dc.gridView.ha.sa.x4.contains(uc))return!1;uc=new u(Od,uc,Ob.HelperMethods.NDd(Bd.x),Ob.HelperMethods.NDd(Bd.y));dc.STi(uc)}return!1};this.$=
oa;this.gridView=Mb.g(oa);this.ij=fb;this.fi=Rb;this.C8i()}function u(oa,fb,Rb,dc){var uc=$d.call(this)||this;uc.sheet=oa;uc.dVg=fb;uc.offsetX=Rb;uc.offsetY=dc;return uc}function t(oa,fb,Rb){var dc=this;this.SNf=this.RNf=this.TNf=this.QNf=0;this.OTi=function(uc,Bd){uc=Object(wb.a)(ed.a,Bd.qa);dc.x7a(uc)&&(Bd={},Bd.worksheetId=uc.sheetId,Bd=md.a.Kc(Bd),dc.Sia(11,uc.sheetId,Bd))};this.RTi=function(uc,Bd){uc=Object(wb.a)(ed.a,Bd.NF);dc.x7a(uc)&&(Bd={},Bd.worksheetId=uc.sheetId,Bd=md.a.Kc(Bd),dc.Sia(12,
uc.sheetId,Bd))};this.PTi=function(uc,Bd){uc=Object(wb.a)(ed.a,Bd.qa);dc.x7a(uc)&&(Bd={},Bd.worksheetId=uc.sheetId,uc=md.a.Kc(Bd),dc.Sia(11,null,uc,!0))};this.QTi=function(uc,Bd){uc=Object(wb.a)(ed.a,Bd.NF);dc.x7a(uc)&&(Bd={},Bd.worksheetId=uc.sheetId,uc=md.a.Kc(Bd),dc.Sia(12,null,uc,!0))};this.$=oa;this.ij=fb;this.fi=Rb}function y(oa,fb,Rb){var dc=this;this.iQa=this.hQa=0;this.LGa=this.yha=null;this.Nwf=function(){var uc=Mb.g(dc.$).ha.Oa.FC;if(0<dc.iQa&&dc.yha&&dc.LGa){var Bd={};Bd.shapeId=dc.yha;
Bd.worksheetId=dc.LGa;Bd=md.a.Kc(Bd);dc.fireEvent(2102,dc.yha,Bd)}dc.emi(uc)?(dc.yha=dc.BMj(uc),dc.LGa=dc.nja(),dc.yha&&dc.LGa)?0<dc.hQa&&(uc={},uc.shapeId=dc.yha,uc.worksheetId=dc.LGa,uc=md.a.Kc(uc),dc.fireEvent(2101,dc.yha,uc)):lb.ULS.sendTraceTag(537170458,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",dc.yha,dc.LGa):(dc.yha=null,dc.LGa=null)};this.$=oa;this.ij=fb;this.fi=Rb}function E(oa,fb,Rb){oa=B.call(this,oa,fb,Rb)||
this;oa.Uif=null;oa.Tif=null;return oa}function B(oa,fb,Rb){var dc=Hc.call(this)||this;dc.Hza=0;dc.aV=0;dc.kd=function(uc,Bd){if(dc.enabled&&!(dc.Odf()||null!==Bd&&void 0!==Bd&&Bd.ghf)&&(uc=Object(wb.a)(ed.a,dc.$.xa.qa))&&0===uc.GI){var Od=uc.sheetId,Td=dc.aYe(),Ze=null,vf=null;dc.ij.Wgf()&&(Ze=dc.grid.Rb.Qj(dc.grid.ha.sa.activeCell),vf=Od in dc.mjc?dc.mjc[Od]:null);dc.zre(Od,Td)&&Na.TaskExtensions.Ba(Ub.Task.Sa(!0),function(){dc.p4h(Od,Td);dc.b4h(Od,Td,Ze,vf)},dc.la);dc.NIe(Od,Td,Ze)}};dc.$=oa;dc.ij=
fb;dc.fi=Rb;dc.grid=Mb.g(oa);dc.pNa={};dc.mjc={};return dc}function z(oa,fb,Rb){var dc=this;this.ONf=this.NNf=0;this.ZKb=this.gab=null;this.FGi=function(){var uc=Mb.g(dc.$).ha.Oa.FC;if(dc.ynd(uc)&&(uc=dc.yac(uc))){var Bd={chartId:uc};Bd.worksheetId=dc.nja();Bd=md.a.Kc(Bd);dc.Sia(51,uc,Bd);dc.Sia(51,dc.nja(),Bd)}};this.GGi=function(){if(dc.gab){var uc={};uc.chartId=dc.gab;uc.worksheetId=dc.ZKb;uc=md.a.Kc(uc);dc.Sia(52,dc.gab,uc);dc.Sia(52,dc.ZKb,uc)}uc=Mb.g(dc.$).ha.Oa.FC;dc.ynd(uc)?(dc.gab=dc.yac(uc),
dc.ZKb=dc.nja()):(dc.gab=null,dc.ZKb=null)};this.$=oa;this.ij=fb;this.fi=Rb}function M(){this.UYa={}}function Q(oa,fb,Rb,dc){dc=void 0===dc?!1:dc;var uc=qc.call(this)||this;uc.wcb=0;uc.UE=null;uc.Zva=!1;uc.Gqc=null;uc.aV=0;uc.$1d=null;uc.sHc=null;uc.wVa=null;uc.L5b=null;uc.G9d=!1;uc.s_d=null;uc.Ada=null;uc.wOc=null;uc.kd=function(){uc.enabled&&(uc.Bmj(),uc.Gqc=vc.d(Mb.g(uc.$).ha.sa.selectedRanges))};uc.T4e=function(Bd){Bd.controlId===uc.de.InstanceId&&Array.forEach(uc.UE,function(Od){Od.iyi(Bd)&&
Od.C1b(Bd)})};uc.ptf=function(Bd){if((Bd=Object(wb.a)(497,Bd))&&!Bd.ms())if(!uc.de||OSF.OsfControl.isFirstPartyStoreString(uc.de.PrimaryMarketplace.MarketplaceType)||uc.$.bha){Bd.vf=uc.de;Bd.xj=uc.Tg;uc.s_d=Bd;uc.wwc(Bd.bGa);var Od=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&wa.a.Ld(uc.$)&&Ob.HelperMethods.Kw(uc.de)&&uc.de.Preload&&!uc.de.TaskpaneVisible;Od?Bd.OAd():ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?
(Bd.OAd(),(uc.de.SharedRuntime&&1===uc.de.SharedRuntime.LifeTime||uc.de.SharedRuntimeId)&&!uc.de.TaskpaneVisible&&Bd.jg(!1)):((uc.de.SharedRuntime&&1===uc.de.SharedRuntime.LifeTime||uc.de.SharedRuntimeId)&&!uc.de.TaskpaneVisible&&Bd.jg(!1),Bd.OAd());uc.U5a||(wa.a.Ld(uc.$)?Od||Bd.G6():kd.a(uc.$).result.bG(Bd,!0));uc.$.da.Aa(77).mPf(uc.ptf);uc.dha=Object(wb.a)(524,Bd)}else lb.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};uc.onFloatingObjectControlAdded=function(Bd,Od){3===
Od.control.floatingObject.type&&Od.control.floatingObject.il.InstanceId===uc.p1.WebExtensionId&&(uc.dha=Object(wb.a)(524,Od.control),uc.wwc(Od.control.Sd.firstChild),Ad.a(uc.$).Msc(uc.onFloatingObjectControlAdded))};uc.wb=oa.$;uc.Tg=oa;uc.de=Rb;uc.de.InstanceId=Rb.SrcLocationOverrideResourceId?oa.m3a(Rb.InstanceId,Rb.SrcLocationOverrideResourceId):Rb.InstanceId;uc.fi=fb;uc.p1={};uc.p1.WebExtensionId=Rb.InstanceId;uc.IEf="osfControl_"+Rb.InstanceId;uc.B6c="disabled_"+Rb.InstanceId;uc.p1.BindingData=
Rb.BindingData;uc.U5a=uc.Tg.U5a(Rb.InstanceId);uc.Bfc=uc.Tg.Bfc(Rb.InstanceId);uc.Vce=Rb.WebExtensionOsfControlType;uc.UHf=dc;return uc}function P(){}function L(oa,fb,Rb,dc,uc,Bd,Od,Td){oa=Zb.call(this,oa,fb,Rb)||this;oa.startRow=0;oa.startColumn=0;oa.rowCount=0;oa.columnCount=0;oa.startColumn=Bd-dc.Reference.FirstColumn;oa.columnCount=Td;Bd=Math.max(uc,dc.Reference.FirstRow);uc=Math.min(uc+Od-1,dc.Reference.LastRow);Bd>uc?oa.startRow=oa.rowCount=void 0:(oa.startRow=Bd-dc.Reference.FirstRow,oa.rowCount=
uc-Bd+1);return oa}function ca(oa){var fb=this;this.UE=null;this.Zva=!1;this.kd=function(){fb.UE.forEach(function(Rb){Rb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Rb.C1b(new Oa.a(Rb.eventId,"",null))})};this.Tg=oa}function U(oa,fb){this.eB=null;this.qfa=oa;this.Swg=fb}function aa(oa){var fb=this;this.Fi=this.QWc=null;this.WNi=function(Rb,dc){fb.handlers.xb(dc.controlId)&&(Rb=new D(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,dc.controlId,null,dc.messageType,dc.messageContent,
dc.messageOrigin,dc.targetOrigin),fb.handlers.oa(dc.controlId)(Rb),dc.messageType===OSF.DialogMessageType.DialogClosed&&fb.handlers.remove(dc.controlId))};this.VNi=function(Rb,dc){fb.plc.xb(dc.controlId)&&(Rb=new F(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,dc.controlId,null,dc.messageType,dc.messageContent,dc.messageOrigin,dc.targetOrigin),fb.plc.oa(dc.controlId)(Rb))};this.handlers=new tc.a;this.plc=new tc.a;this.Tg=oa;this.r1a.NFg(this.WNi);this.r1a.MFg(this.VNi)}function F(oa,
fb,Rb,dc,uc,Bd,Od){oa=Qa.call(this,oa,fb,Rb)||this;oa.messageType=0;oa.messageContent=null;oa.messageOrigin=null;oa.targetOrigin=null;oa.messageType=dc;oa.messageContent=uc;oa.messageOrigin=Bd;oa.targetOrigin=Od;return oa}function D(oa,fb,Rb,dc,uc,Bd,Od){oa=qb.call(this,oa,fb,Rb)||this;oa.messageType=0;oa.messageContent=null;oa.messageOrigin=null;oa.targetOrigin=null;oa.messageType=dc;oa.messageContent=uc;oa.messageOrigin=Bd;oa.targetOrigin=Od;return oa}function J(oa,fb){var Rb=sa.call(this)||this;
Rb.requests=[];Rb.X1b=!1;Rb.disposed=!1;Rb.ug=function(){if(!Rb.disposed){Rb.grid.rc.Dn(Rb.ug);Rb.X1b=!1;var dc=Rb.requests;Rb.requests=[];dc=El(dc);for(var uc=dc.next();!uc.done;uc=dc.next())uc=uc.value,Rb.ddaFacade.iK(uc.command,uc.properties)}};Rb.ddaFacade=oa;Rb.grid=fb;return Rb}function R(){this.command=0;this.properties=null}function Z(oa){this.Za=new qa.a;this.Hn=oa}function W(oa,fb,Rb,dc,uc){Rb=void 0===Rb?null:Rb;dc=void 0===dc?"":dc;uc=void 0===uc?"":uc;var Bd=Ia.call(this)||this;Bd.controlId=
oa;Bd.messageType=fb;Bd.messageContent=Rb;Bd.messageOrigin=dc;Bd.targetOrigin=uc;return Bd}function ka(oa,fb,Rb,dc,uc){Rb=void 0===Rb?null:Rb;dc=void 0===dc?"":dc;uc=void 0===uc?"":uc;var Bd=ha.call(this)||this;Bd.controlId=oa;Bd.messageType=fb;Bd.messageContent=Rb;Bd.messageOrigin=dc;Bd.targetOrigin=uc;return Bd}function ma(){this.height=this.width=0;this.Pe=this.controlId=this.pageUrl=null;this.dec=this.K6c=!1}function pa(){}function xa(){this.dialog=this.Pe=null}function va(oa,fb,Rb){var dc=La.call(this)||
this;dc.A9=null;dc.wSc="WACDialogTitleText";dc.lVa="0";dc.vRb="15px";dc.smg="0px";dc.kVa="calc(100% - 30px)";dc.rmg="100%";dc.Hee=0;dc.Za=new qa.a;dc.Wjg=new fa;dc.jc=5;dc.$Ca=Rb;dc.Pe=Rb;dc.OHc=oa;dc.Z4d=fb;dc.cIc=!!Ha.AFrameworkApplication.ga&&Ha.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return dc}function ta(){}function fa(){}function Ca(oa,fb){oa=Sa.call(this,1,oa,fb)||this;oa.Faf=OfficeExt.CommandInvokeMode.ExclusiveForNew;return oa}function Sa(oa,fb,Rb){this._id=
oa;this.Ujg=fb;this.dmg=Rb;this.Faf=OfficeExt.CommandInvokeMode.Default}b.r(C);var Gb=b(0),kb=b(7),lb=b(14),Nb=b(1355),Aa=b(82),qa=b(97);Sa.prototype.execute=function(oa,fb,Rb){var dc=this;Rb=Rb||{};Rb.commandMode=this.Faf;fb.invokeAppCommand(this.pHg,this.YZg,Rb,function(){oa.gOi(dc.id)})};Ek.Object.defineProperties(Sa.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},pHg:{configurable:!0,enumerable:!0,get:function(){return this.Ujg}},YZg:{configurable:!0,enumerable:!0,
get:function(){return this.dmg}}});Object(Gb.a)(Sa,"AddinNativeActionBase",null,[212]);Am(Ca,Sa);Object(Gb.a)(Ca,"AddinTakeSnapshotAction",Sa,[]);fa.prototype.N3g=function(oa){return new Sa(3,oa,this.MHh().getNativeActionName(3))};fa.prototype.MHh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(Gb.a)(fa,"AddinNativeActionManager",null,[200]);var Xa=b(149);ta.prototype.invokeAppCommand=function(oa,fb,Rb,dc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(oa,
fb,Rb,dc)};ta.getInstance=function(){ta.Ma||(ta.Ma=new ta);return ta.Ma};ta.Ma=null;Object(Gb.a)(ta,"OSFAddinCommandsRuntimeManager",null,[199]);var Ha=b(4),Ra=b(182),mb=b(24),La=Xa.a;Am(va,La);va.prototype.FFg=function(oa){this.Za.addHandler("OnDialogClosedEventKey",oa)};va.prototype.Aqj=function(){this.hEa=null};va.prototype.qD=function(){La.prototype.qD.call(this);this.Np.style.width="100%";this.Np.style.height=this.Gdc?this.kVa:this.rmg;this.Np.style.marginTop=this.Gdc?this.vRb:this.smg;this.Np.style.padding=
this.lVa};va.prototype.IO=function(){La.prototype.IO.call(this);this.Nb.style.width=String.format("{0}px",this.OHc*window.innerWidth/100);this.Nb.style.height=String.format("{0}px",this.Z4d*window.innerHeight/100);this.Nb.style.minWidth="0px";this.cIc&&Ha.AFrameworkApplication.isRtl&&100===this.OHc&&(this.Nb.style.right="0px",this.Nb.style.marginRight="0px");this.A9=document.getElementById(this.ni(this.wSc));this.A9.style.position="absolute";this.A9.style.whiteSpace="nowrap";this.A9.style.textOverflow=
"ellipsis";Ha.AFrameworkApplication.isRtl?(this.A9.style.right="14px",this.A9.style.left="44px"):(this.A9.style.right="44px",this.A9.style.left="14px")};va.prototype.Iv=function(oa){La.prototype.Iv.call(this,oa);this.A9&&this.A9.setAttribute("title",oa)};va.prototype.WKd=function(){this.Nb.style.width=String.format("{0}px",this.OHc*window.innerWidth/100);this.Nb.style.height=String.format("{0}px",this.Z4d*window.innerHeight/100);this.Nb.style.overflowY="hidden";this.Nb.style.overflowX="hidden";this.Nb.style.marginTop=
"";this.Nb.style.top="";mb.a.rR&&Ha.AFrameworkApplication.isRtl?(this.Nb.style.right="",this.Nb.style.marginRight=""):(this.Nb.style.left="",this.Nb.style.marginLeft="")};va.prototype.hide=function(){var oa=this;this.Wjg.N3g(this.$Ca).execute(this,ta.getInstance(),{});this.Hee=window.setTimeout(function(){oa.Za.raiseEvent("OnDialogClosedEventKey",oa.$Ca);Ra.a.prototype.hide.call(oa)},500)};va.prototype.gOi=function(oa){3===oa&&(window.clearTimeout(this.Hee),this.Za.raiseEvent("OnDialogClosedEventKey",
this.$Ca),La.prototype.hide.call(this))};Ek.Object.defineProperties(va.prototype,{q1a:{configurable:!0,enumerable:!0,get:function(){return this.Np}}});Object(Gb.a)(va,"AppsForOfficeDialog",Xa.a,[184,185]);Object(Gb.a)(xa,"DialogInfo",null,[]);pa.url="url";pa.height="height";pa.width="width";pa.K6c="displayInIframe";pa.dec="hideTitle";Object(Gb.a)(pa,"DialogSettings",null,[]);Object(Gb.a)(ma,"DisplayDialogParams",null,[]);var ha=Sys.EventArgs;Am(ka,ha);Object(Gb.a)(ka,"OnMessageDialogEventArgs",Sys.EventArgs,
[]);var Ia=Sys.EventArgs;Am(W,Ia);Object(Gb.a)(W,"OnMessageParentEventArgs",Sys.EventArgs,[]);var gb=b(41),Sb=b(29),wc=b(176),tc=b(98);Z.prototype.NFg=function(oa){this.Za.addHandler("OnMessageParentEventKey",oa)};Z.prototype.MFg=function(oa){this.Za.addHandler("OnMessageDialogEventKey",oa)};Z.prototype.showDialog=function(oa,fb,Rb,dc){if(Z.u8.xb(fb))lb.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Rb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{var uc=gb.b(oa),Bd=uc[pa.url];if(this.Hn.getOsfControl(fb).checkAppDomains(Bd)){var Od=new ma;Od.width=uc[pa.width];Od.height=uc[pa.height];Od.pageUrl=Bd;Od.K6c=uc[pa.K6c];Od.dec=uc[pa.dec];Od.controlId=fb;Od.Pe=wc.a.create().toString();var Td=new xa;Td.Pe=Od.Pe;var Ze=this.Hn.getOsfControl(Od.controlId).getManifest().getDefaultDisplayName(),vf=this.Hn.getOsfControl(Od.controlId).getStoreType().toLowerCase();oa=null;var wf=Ha.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);oa=(4===Ha.AFrameworkApplication.ta.Qa.Sj&&"hardcodedpreinstall"===vf||wf&&"sdxcatalog"===vf)&&Od.dec?this.createAndShowAppsForOfficeDialog(Od.width,Od.height,Od.Pe,!0,Ze):this.createAndShowAppsForOfficeDialog(Od.width,Od.height,Od.Pe,!1,Ze);var Wf=this.Hn.getOsfControl(Od.controlId),ug=Wf.getManifest();wf={};wf.id=Od.Pe;wf.solutionId=Wf.getSolutionId();wf.version=Wf.getVersion();wf.storeType=vf;wf.storeId=Wf.getStoreId();wf.assetId=Wf.getAssetId();wf.assetStoreId=Wf.getAssetStoreId();wf.ownerAddinSolutionId=
Wf.getOwnerAddinSolutionId();wf.ownerAddinStoreType=Wf.getOwnerAddinStoreType();wf.appDomains=ug.getAppDomains();wf.dialogUrl=Bd;wf.osfControlType=1;wf.agaveName=Ze;wf.div=oa.q1a;lb.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(wf.solutionId,wf.ownerAddinStoreType||wf.storeType,wf.assetId,null,null,wf.storeId),Sb.a.mw(Od.pageUrl));this.Hn.insertDialogControl(wf);oa.FFg(Object(Aa.a)(this,this.xIi,"onDialogClosed"));Td.dialog=
oa;Z.u8.ia(Od.controlId,Td);dc&&dc(wf);Rb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else lb.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Rb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Gg){lb.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Gg.message),Rb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};Z.prototype.Kzi=function(oa,fb,Rb,dc){Ha.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===dc&&(dc=Rb);try{var uc=this.aKa(oa);uc&&this.Za.raiseEvent("OnMessageParentEventKey",new W(uc,OSF.DialogMessageType.DialogMessageReceived,fb,Rb,dc))}catch(Bd){return lb.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Bd.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};Z.prototype.Z0c=function(oa,fb){if(Z.u8.xb(oa))try{var Rb=Z.u8.oa(oa);Rb.dialog&&Rb.dialog.hide();this.Hn.purgeDialogControl(Rb.Pe);
Z.u8.remove(oa);fb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(dc){lb.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",dc.message),fb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else lb.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),fb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};Z.prototype.rmj=function(oa,fb,Rb,dc){Ha.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===dc&&(dc=Rb);if(Z.u8.xb(oa)&&(oa=Z.u8.oa(oa),oa.dialog))try{this.Za.raiseEvent("OnMessageDialogEventKey",new ka(oa.Pe,OSF.DialogMessageType.DialogParentMessageReceived,fb,Rb,dc))}catch(uc){lb.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",uc.message)}};Z.prototype.aKa=function(oa){for(var fb=null,Rb=El(Z.u8),dc=Rb.next();!dc.done;dc=Rb.next())if(dc=dc.value,dc.value.Pe===oa){fb=dc.key;break}return fb};Z.prototype.xIi=function(oa,fb){if(oa=this.aKa(fb))this.Hn.purgeDialogControl(fb),
Z.u8.remove(oa),this.Za.raiseEvent("OnMessageParentEventKey",new W(oa,OSF.DialogMessageType.DialogClosed,null,null,"*"))};Z.prototype.createAndShowAppsForOfficeDialog=function(oa,fb,Rb,dc,uc){oa=new va(oa,fb,Rb);uc=dc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,uc);dc&&(oa.Gdc=!1,oa.qv=!1);oa.initializeAndShow(uc,null,null);oa.Aqj();return oa};Z.Y_h=function(){return Z.u8};Z.getInstance=function(oa){Z.Ma||(Z.Ma=new Z(oa));return Z.Ma};Z.Ma=null;Z.u8=new tc.a;Object(Gb.a)(Z,"AppsForOfficeDialogManager",
null,[161]);var Tb=b(1057),pb=b(1366),cb=b(1431),ob=b(1140),rc=b(935),Db=b(203),Ja=b(1367),Qb=b(118),yc=b(85),Cd=b(90),bc=b(738),Kb=b(616),ic=b(895),wb=b(83),Wa=b(438),Xb=b(161),Gc=b(202),zb=b(38),hc=b(5),Uc=b(1071),jb=b(1313),$a=b(76);Object(Gb.a)(R,"DdaRequestInfo",null,[]);var I=b(943),ba=b(79),sa=$a.a;Am(J,sa);J.prototype.zch=function(oa,fb){this.disposed||(this.X1b||(this.grid.rc.mo(this.ug),this.X1b=!0),this.requests.push(Object(kb.a)(new R,{command:oa,properties:fb})))};J.prototype.dispose=
function(){if(!this.disposed){this.disposed=!0;this.X1b&&this.grid.rc.Dn(this.ug);var oa=this.requests;this.requests=null;oa=El(oa);for(var fb=oa.next();!fb.done;fb=oa.next())fb=fb.value,(fb=fb.properties?fb.properties[ba.a.K3]:null)&&this.ddaFacade.wf(I.a.qyb,fb);this.ddaFacade=this.grid=null;sa.prototype.dispose.call(this)}};J.a_g=function(oa,fb){var Rb=!1;974713501===oa&&(fb=(oa=fb?fb[ba.a.Cg]:null)?oa.DdaMethod:null)&&fb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(Rb=
oa.ArrayData,Rb=!!Rb&&64===(Rb[6]&64));return Rb};Object(Gb.a)(J,"DdaCellEditDelayRequestHandler",$a.a,[]);var Oa=b(975),qb=Oa.a;Am(D,qb);Object(Gb.a)(D,"DialogMessageReceivedEventArgs",Oa.a,[]);var Qa=Oa.a;Am(F,Qa);Object(Gb.a)(F,"DialogParentMessageReceivedEventArgs",Oa.a,[]);var ib=b(1),Mb=b(22);aa.prototype.addHandler=function(oa,fb,Rb,dc){var uc=this;if(ib.EwaSettings.ma(24))this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Rb);else{lb.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");
var Bd=function(Od){Od===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(uc.handlers.ia(oa,fb),uc.Tg.lv(Rb)):(lb.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),uc.Tg.wf(Od,Rb))};this.handlers.xb(oa)?Bd(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(oa,dc,Bd)}};aa.prototype.oBg=function(oa,fb,Rb){ib.EwaSettings.ma(24)?this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Rb):(lb.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),
this.plc.ia(oa,fb),this.Tg.lv(Rb))};aa.prototype.removeHandler=function(oa,fb){var Rb=this;ib.EwaSettings.ma(24)?this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,fb):this.handlers.xb(oa)?(lb.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.r1a.Z0c(oa,function(dc){Rb.handlers.remove(oa);dc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?Rb.Tg.lv(fb):(lb.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),
Rb.Tg.wf(dc,fb))})):this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,fb)};aa.prototype.Z9i=function(oa,fb){ib.EwaSettings.ma(24)?this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,fb):(lb.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.plc.remove(oa),this.Tg.lv(fb))};aa.prototype.showDialog=function(oa,fb,Rb){var dc=this;try{ib.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&Mb.g(this.Tg.$).isEditing&&
Mb.g(this.Tg.$).Jp(!0),this.r1a.showDialog(fb,oa,Rb,function(uc){dc.Tg.GBg(dc.IRg(uc))})}catch(uc){lb.ULS.sendTraceTag(537170496,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",uc.message),Rb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};aa.prototype.IRg=function(oa){var fb={};fb.InstanceId=oa.id;fb.WebExtensionType=oa.osfControlType===OSF.OsfControlTarget.InContent?0:1;fb.PrimaryMarketplace={};fb.PrimaryMarketplace.SolutionId=oa.solutionId;fb.PrimaryMarketplace.SolutionVersion=
oa.version;fb.PrimaryMarketplace.MarketplaceRef=oa.storeId;fb.PrimaryMarketplace.MarketplaceType=oa.storeType;return fb};aa.ka=function(oa){if(!oa.$.da.Aa(232)){var fb=new aa(oa);oa.$.da.Ga(232,fb)}};Ek.Object.defineProperties(aa.prototype,{r1a:{configurable:!0,enumerable:!0,get:function(){this.QWc||(this.QWc=Z.getInstance(this.contextActivationMgr));return this.QWc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.Fi&&this.Tg&&(this.Fi=this.Tg.Fi);return this.Fi}}});Object(Gb.a)(aa,
"DialogMessageReceivedEventManager",null,[571]);U.prototype.DZb=function(oa){oa&&(this.eB||(this.eB=[]),this.eB.push(oa))};U.prototype.Vsc=function(oa){this.eB&&Array.remove(this.eB,oa)};U.prototype.iyi=function(oa){return this.eventId!==oa.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===oa.ddaBinding.Name:!0};U.prototype.C1b=function(oa){this.eB&&Array.forEach(this.eB,function(fb){fb(oa)})};
U.prototype.Lma=function(){this.eB=[]};Ek.Object.defineProperties(U.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.qfa}},targetId:{configurable:!0,enumerable:!0,get:function(){return this.Swg}},P4h:{configurable:!0,enumerable:!0,get:function(){return 0<this.eB.length}}});Object(Gb.a)(U,"DdaEventRegistration",null,[]);ca.prototype.invokeDdaMethod=function(oa,fb){var Rb={};Rb[ba.a.Cg]=oa;Rb[ba.a.K3]=fb;this.Tg.iK(974713501,Rb)};ca.prototype.registerDdaEventAsync=function(oa,
fb,Rb,dc,uc){ca.Zyb(oa)?(ca.Pnd(oa)&&this.nkd(),this.UE||(this.UE=[]),fb=this.Qtb(oa,Rb),fb||(fb=new U(oa,Rb),this.UE.push(fb)),fb.DZb(dc),this.Tg.lv(uc)):this.Tg.wf(-1,uc)};ca.prototype.unregisterDdaEventAsync=function(oa,fb,Rb,dc,uc){ca.Zyb(oa)?((oa=this.Qtb(oa,Rb))&&oa.Vsc(dc),this.Tg.lv(uc)):this.Tg.wf(-1,uc)};ca.prototype.nkd=function(){this.Zva||(Mb.g(this.Tg.$).ha.oE(this.kd),this.Zva=!0)};ca.prototype.Qtb=function(oa,fb){if(!this.UE)return null;for(var Rb=0;Rb<this.UE.length;Rb++){var dc=
this.UE[Rb];if(dc.eventId===oa&&dc.targetId===fb)return dc}return null};ca.Zyb=function(oa){return oa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};ca.Pnd=function(oa){return oa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Object(Gb.a)(ca,"EmbeddingPage",null,[551]);var Jb=b(206),Zb=Oa.a;Am(L,Zb);L.prototype.getStartRow=function(){return this.startRow};L.prototype.getStartColumn=function(){return this.startColumn};L.prototype.getRowCount=function(){return this.rowCount};
L.prototype.getColumnCount=function(){return this.columnCount};Object(Gb.a)(L,"DdaBindingSelectionEventArgs",Oa.a,[]);var ub=b(191),Za=b(25),vc=b(46),zc=b(51),kd=b(439),wa=b(37),Na=b(36),Vb=b(630),pc=b(110),hd=b(54),Ud=b(95),Zc=b(12),Ob=b(10),Ad=b(104);P.rsh="ewa-wx-disabled-div";P.qsh="ewa-wx-container-div";P.QNe="ewa-ptp-nov2-flex";Object(Gb.a)(P,"CssClassNames",null,[]);var we=P.rsh,Wd=P.qsh,qc=Jb.a;Am(Q,qc);Q.prototype.Dai=function(oa){this.Ada||(this.Ada=oa)};Q.prototype.WOf=function(){this.Ada&&
(this.Ada.dispose(),this.Ada=null)};Q.prototype.Gld=function(){var oa=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.de.PrimaryMarketplace.MarketplaceType)&&ib.EwaSettings.ma(187)){var fb=zc.GetServiceTaskFactory.Va(this.$.da,5,4,0);Na.TaskExtensions.Ba(fb,function(){fb.result.eg(35,null)},this.la,3);return this}if(1===this.de.WebExtensionType)Na.TaskExtensions.Ba(kd.a(this.$),function(uc){uc.result.mrb(oa.$.da,77,6,oa.ptf,1)},this.la,3);else{var Rb=this.TSe(),dc=Ad.a(this.$);Rb||(Rb={Type:3},
Rb.Id=this.p1.WebExtensionId,Rb.WebExtensionData=this.de,Rb.ContentHtml="<div/>",Rb.Version=0,Rb.AbsoluteLeft=0,Rb.AbsoluteTop=0,Rb.AbsoluteRight=0,Rb.AbsoluteBottom=0,Rb.Width=0,Rb.Height=0,Rb.ZOrder=0,Rb.OriginDeltaX=0,Rb.OriginDeltaY=0,Rb=new ub.a(Rb),dc.s4b(Rb,null),Rb=dc.Hq(Rb.Vg()));Rb?(this.wwc(Rb.Sd.firstChild),this.dha=Object(wb.a)(524,Rb)):dc.tZb(this.onFloatingObjectControlAdded)}return this};Q.prototype.T9e=function(oa){this.wwc(oa);return this};Q.prototype.$mc=function(){this.UHf||this.Tg.Fi.purgeOsfControl(this.controlId,
!1);this.Nag(!0);var oa=this.TSe();oa&&Ad.a(this.$).deleteFloatingObject(oa);this.Tg.ij.I9i(this.controlId);this.Tg.ij.SKe(this.controlId,!0);this.wOc=null};Q.prototype.aBd=function(oa){this.p1=oa};Q.prototype.invokeDdaMethod=function(oa,fb){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Rb={};Rb[ba.a.Cg]=oa;Rb[ba.a.K3]=fb;this.Tg.iK(974713501,Rb)}else this.Tg.wf(I.a.qyb,fb)};Q.prototype.f7i=function(oa,fb,Rb,dc){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||
this.enabled)if(!Q.Zgh(oa)||void 0!==fb&&null!==fb&&void 0!==this.J2a(fb)&&null!==this.J2a(fb))if(lb.ULS.sendTraceTag(36444195,0,50,"eventId: {0}, targetId: {1}",oa,fb),Q.ecf(oa)&&this.E6h(),Q.Pnd(oa)&&this.nkd(),Q.ccf(oa))ib.EwaSettings.ma(24)?this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,dc):this.Tg.$.da.Aa(232).addHandler(this.controlId,Rb,dc,fb);else if(Q.dcf(oa))ib.EwaSettings.ma(24)?this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,dc):this.Tg.$.da.Aa(232).oBg(this.controlId,
Rb,dc);else{Q.bcf(oa)&&this.V4e(-1777565636,dc);this.UE||(this.UE=[]);var uc=this.Qtb(oa,fb);uc||(uc=new U(oa,fb),this.UE.push(uc));uc.Lma();uc.DZb(Rb);this.Tg.lv(dc);oa===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.wVa&&(this.L5b=Rb)}else this.Tg.wf(3002,dc);else this.Tg.wf(-1,dc)};Q.prototype.oOj=function(oa,fb,Rb,dc){Q.ccf(oa)?ib.EwaSettings.ma(24)?this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,dc):this.Tg.$.da.Aa(232).removeHandler(this.controlId,dc):Q.dcf(oa)?
ib.EwaSettings.ma(24)?this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,dc):this.Tg.$.da.Aa(232).Z9i(this.controlId,dc):(Q.bcf(oa)&&this.V4e(1592314317,dc),fb=this.Qtb(oa,fb),this.enabled?(fb&&(fb.Vsc(Rb),fb.P4h||Array.remove(this.UE,fb),this.UE.length?Q.ecf(oa)&&this.Oag(!1):this.Nag(!1)),this.Tg.lv(dc)):this.Tg.wf(-1,dc))};Q.prototype.ka=function(oa){Zc.DOMElementExtensions.getElementById(oa,this.IEf)||oa.appendChild(Zc.DOMElementExtensions.Af(this.Dy))};Q.prototype.showHide=
function(oa){Zc.DOMElementExtensions.setVisible(this.Dy,oa)};Q.prototype.resize=function(oa,fb){Zc.DOMElementExtensions.Kr(this.Dy,oa);Zc.DOMElementExtensions.XI(this.Dy,fb)};Q.prototype.OHe=function(oa){if(!this.aV&&!Zc.DOMElementExtensions.getElementById(this.Dy,this.B6c)&&this.Dy){var fb=document.createElement("div");fb.id=this.B6c;fb.className=we;fb.style.backgroundImage="url("+hd.a.current.kp(81)+")";fb.style.opacity=oa?"1":"0";fb.style.backgroundRepeat="no-repeat";fb.style.backgroundPosition=
"center";this.Dy.insertBefore(fb,this.Dy.firstChild)}this.aV++};Q.prototype.Vjh=function(){0<this.aV&&this.aV--;this.aV||(Zc.DOMElementExtensions.Af(Zc.DOMElementExtensions.getElementById(this.Dy,this.B6c)),this.Zva&&!vc.Q(this.Gqc,Mb.g(this.$).ha.sa.selectedRanges)&&this.kd(null,null))};Q.prototype.J2a=function(oa){if(!this.p1||!this.p1.BindingData)return null;for(var fb=0;fb<this.p1.BindingData.length;fb++)if(this.p1.BindingData[fb].Name===oa)return this.p1.BindingData[fb];return null};Q.prototype.getDefaultIconUrl=
function(){var oa=this.z0e();return oa?oa.getDefaultIconUrl():null};Q.prototype.getDefaultDisplayName=function(){if(this.de.TaskpaneTitle)return this.de.TaskpaneTitle;var oa=this.z0e();return oa?oa.getDefaultDisplayName():null};Q.prototype.XIf=function(){if(this.wVa&&this.L5b){var oa=new Oa.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.wVa);this.L5b(oa);this.L5b=this.wVa=null}};Q.prototype.jg=function(oa){this.s_d&&this.s_d.jg(oa)};Q.prototype.xoj=function(){var oa=this;
this.$.ea.isNamedObjectViewMode&&this.yki()&&(this.$.da.Aa(34).woj(this.Dy),this.showHide(!1));if(this.Tg.gWj){if(!this.UHf){var fb={};fb.div=this.Dy;fb.id=this.de.InstanceId;fb.solutionId=this.de.PrimaryMarketplace.SolutionId;fb.version=this.de.PrimaryMarketplace.SolutionVersion;fb.storeId=this.de.PrimaryMarketplace.MarketplaceRef;fb.storeType=this.de.PrimaryMarketplace.MarketplaceType;fb.ownerAddinSolutionId=this.de.OwnerAddinSolutionId;fb.ownerAddinStoreType=this.de.OwnerAddinStoreType;this.de.AssetMarketplace&&
(fb.assetId=this.de.AssetMarketplace.SolutionId,fb.assetStoreId=this.de.AssetMarketplace.MarketplaceRef);fb.settings=this.de.OsfPropertyBag;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?fb.reason=this.U5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Bfc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:fb.reason=this.U5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:
Microsoft.Office.WebExtension.InitializationReason.Inserted;fb.osfControlType=0===this.de.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;fb.isForUILessAction=4===this.de.WebExtensionOsfControlType;fb.sourceLocationOverrideResourceId=this.de.SrcLocationOverrideResourceId;fb.focusOnIframeWhenLoaded=this.de.FocusOnIframeWhenLoaded;Vb.a(this.de)&&(fb.featureGates=Ha.AFrameworkApplication.ga.JOh(fb.solutionId));fb.hostInfoFlags=0;this.dIa&&(fb.hostInfoFlags|=2);Ob.HelperMethods.Kw(this.de)&&
(fb.hostInfoFlags|=1);this.$.bha||(lb.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),fb.hostInfoFlags|=4);ib.EwaSettings.ma(641)&&(fb.hostInfoFlags|=8);ib.EwaSettings.ma(54)&&ib.EwaSettings.ma(94)&&!this.sHc&&(fb.virtualOsfControlActivationCallback=function(){oa.Tg.fCd(oa.de)});fb.sharedRuntimeId=this.de.SharedRuntime?this.de.SharedRuntime.Resid:this.de.SharedRuntimeId;!Ob.HelperMethods.Kw(this.de)||this.de.Preload||Vb.a(this.de)||this.Tg.Fi.getOsfControl(b(946).DdaFacade.getSolutionId(this.de,
this.$))||(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Tg.fCd(this.de):this.Tg.fCd(this.de));fb.initialDisplayMode=this.de.TaskpaneVisible?2:1;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(fb.titleOverride=this.il.TaskpaneTitle);this.Tg.Fi.insertOsfControl(fb)}this.aV=0}else this.OHe(!0)};Q.prototype.Nag=function(oa){this.Oag(oa);this.WNj()};Q.prototype.E6h=function(){this.wcb||this.fi.DZb(this.T4e);
this.wcb++};Q.prototype.Oag=function(oa){0<this.wcb&&(oa?this.wcb=0:this.wcb--,this.wcb||this.fi.Vsc(this.T4e))};Q.prototype.nkd=function(){if(!this.Zva){var oa=Mb.g(this.$).ha;this.Gqc=vc.d(Mb.g(this.$).ha.sa.selectedRanges);oa.oE(this.kd);this.Zva=!0}};Q.prototype.WNj=function(){this.Zva&&(Mb.g(this.$).ha.uI(this.kd),this.Zva=!1)};Q.prototype.tlj=function(oa){var fb=new Za.Range(oa.Reference.FirstRow+1,oa.Reference.FirstColumn+1,oa.Reference.LastRow+1,oa.Reference.LastColumn+1,!1,!1);1===oa.BindingType&&
(oa.HasHeaders&&--fb.top,oa.HasTotals&&(fb.bottom+=1));var Rb=Mb.g(this.$).ha.sa.selectedRanges;oa=fb.pyb(this.Gqc);Rb=fb.pyb(Rb);return(fb=fb.Me(Mb.g(this.$).ha.sa.activeRange))&&(pc.e(oa)&&!pc.e(Rb)||!pc.e(oa)&&!pc.e(Rb)&&!vc.Q(oa,Rb))?fb:null};Q.prototype.Bmj=function(){var oa=this;Array.forEach(this.UE,function(fb){if(fb.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&fb.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||oa.Tg.ij.U_b(oa.controlId))if(fb.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)fb.C1b(new Oa.a(fb.eventId,oa.controlId,null));else if(fb.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var Rb=oa.J2a(fb.targetId);if((null===Rb||void 0===Rb?0:Rb.IsValidRef)&&(oa.$.ea.isNamedObjectViewMode?oa.$.Hb.qa.sheetName:oa.$.xa.qa.name)===Rb.Reference.SheetName){var dc=oa.tlj(Rb);dc&&fb.C1b(new L(fb.eventId,oa.controlId,oa.Tg.J0b(Rb),Rb,dc.top-1,dc.left-1,dc.height,dc.width))}}})};Q.prototype.Qtb=function(oa,fb){if(!this.UE)return null;
for(var Rb=0;Rb<this.UE.length;Rb++){var dc=this.UE[Rb];if(dc.eventId===oa&&dc.targetId===fb)return dc}return null};Q.prototype.TSe=function(){for(var oa=Ad.a(this.$).pV,fb=oa.length-1;0<=fb;--fb){var Rb=oa[fb];if(3===Rb.floatingObject.type&&Rb.floatingObject.il.InstanceId===this.p1.WebExtensionId)return Rb}return null};Q.prototype.yki=function(){for(var oa=0;oa<this.$.Hb.count;oa++)if(this.$.Hb.getItem(oa).wLa===this.p1.WebExtensionId)return!0;return!1};Q.prototype.wwc=function(oa){this.wOc=oa;this.Dy.id=
this.IEf;this.Dy.className=Wd;this.Dy.dir=this.$.isChromeRtl?"rtl":"ltr";this.xoj()};Q.prototype.z0e=function(){if(!this.enabled)return null;var oa=Vb.a(this.il)?"":this.il.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.il.PrimaryMarketplace.SolutionId,oa)};Q.prototype.V4e=function(oa,fb){if(ib.EwaSettings.ma(24))this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,fb);else try{if(lb.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),
4!==this.Vce)this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,fb);else{var Rb={};Rb[rc.a.Lnb]=this.controlId;var dc=new Ud.a(oa,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Xb(dc,Rb);this.Tg.lv(fb)}}catch(uc){lb.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",uc.message),this.Tg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,fb)}};Q.Zgh=function(oa){return oa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||oa===
OSF.DDA.EventDispId.dispidBindingDataChangedEvent};Q.ecf=function(oa){return oa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||oa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||oa===OSF.DDA.EventDispId.dispidRichApiMessageEvent};Q.Pnd=function(oa){return oa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||oa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Q.ccf=function(oa){return oa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};Q.dcf=function(oa){return oa===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};Q.bcf=function(oa){return oa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};Ek.Object.defineProperties(Q.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.de.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.de.WebExtensionType}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,get:function(){return this.de.OwnerAddinSolutionId}},$:{configurable:!0,enumerable:!0,
get:function(){return this.wb}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.aV}},Dy:{configurable:!0,enumerable:!0,get:function(){return this.wOc}},MU:{configurable:!0,enumerable:!0,get:function(){return this.de.SrcLocationOverrideResourceId?this.Tg.m3a(this.de.PrimaryMarketplace.SolutionId,this.de.SrcLocationOverrideResourceId):this.de.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,enumerable:!0,get:function(){return this.de.SrcLocationOverrideResourceId}},
il:{configurable:!0,enumerable:!0,get:function(){return this.de}},dha:{configurable:!0,enumerable:!0,get:function(){return this.$1d},set:function(oa){this.$1d=oa}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.Vce}},dIa:{configurable:!0,enumerable:!0,get:function(){return this.sHc},set:function(oa){this.sHc=oa}},$4c:{configurable:!0,enumerable:!0,get:function(){return this.wVa},set:function(oa){this.wVa=oa}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.de.FocusOnIframeWhenLoaded}},
Fpd:{configurable:!0,enumerable:!0,get:function(){return this.G9d},set:function(oa){this.G9d=oa}}});Object(Gb.a)(Q,"OsfControl",Jb.a,[570]);M.prototype.add=function(oa){this.UYa[oa]=!0};M.prototype.remove=function(oa){delete this.UYa[oa]};M.prototype.clear=function(){for(var oa=El(Object.keys(this.UYa)),fb=oa.next();!fb.done;fb=oa.next())delete this.UYa[fb.value]};M.prototype.j6e=function(){return 0<Object.keys(this.UYa).length};M.prototype.LHh=function(){return Object.keys(this.UYa)};Object(Gb.a)(M,
"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var md=b(56);z.prototype.Cob=function(oa){51===oa.messageType?this.NNf=this.rGa(oa.actionType,this.NNf,this.FGi):52===oa.messageType&&(this.ONf=this.rGa(oa.actionType,this.ONf,this.GGi))};z.prototype.rGa=function(oa,fb,Rb){if(1===oa)fb||Mb.g(this.$).ha.Oa.jVc(Rb),fb++,this.csj();else if(2===oa){if(1>fb)return fb;1===fb&&Mb.g(this.$).ha.Oa.iJd(Rb);fb--}return fb};z.prototype.Sia=function(oa,fb,Rb){fb&&this.ij.j_(oa,fb)&&this.fi.NM(oa,
fb,Rb)};z.prototype.yac=function(oa){return oa&&oa.floatingObject?(oa=oa.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===oa.length?oa[0]:null:null};z.prototype.nja=function(){var oa=this.$.xa.qa;return oa&&0===oa.GI?oa.sheetId:null};z.prototype.csj=function(){var oa=Mb.g(this.$).ha.Oa.FC;this.ynd(oa)&&(this.gab=this.yac(oa),this.ZKb=this.nja())};z.prototype.ynd=function(oa){return!!oa&&!!oa.floatingObject&&0===oa.floatingObject.type};Object(Gb.a)(z,"RichApiEventChartActivatedDeactivatedHandler",
null,[]);var bd=b(949),Xc=b(198),ne=b(709),ed=b(99),nd=b(359),Ub=b(55),Hc=$a.a;Am(B,Hc);B.prototype.r0b=function(oa){Object(wb.a)(nd.a,this.$.xa);1===oa.actionType?(this.Hza||this.grid.ha.oE(this.kd),this.Hza++):2!==oa.actionType||1>this.Hza||(1===this.Hza&&this.grid.ha.uI(this.kd),this.Hza--)};B.prototype.ewc=function(oa){oa?this.aV++:(0<this.aV&&this.aV--,this.aV||this.kd(null,new ne.a(!1)))};B.prototype.aYe=function(){return this.grid.ha.sa.selectedRanges};B.prototype.zre=function(oa,fb){return ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?
(!!oa&&Xc.e(this.pNa)||oa in this.pNa)&&!vc.Q(this.pNa[oa],fb):oa in this.pNa&&!vc.Q(this.pNa[oa],fb)};B.prototype.NIe=function(oa,fb,Rb){this.pNa[oa]=vc.d(fb);this.mjc[oa]=Rb};B.prototype.Odf=function(){return this.grid.isEditing||this.grid.Mi};B.prototype.vTe=function(oa,fb){this.ij.j_(14,oa)&&this.fi.NM(14,oa,fb);this.ij.j_(14,bd.a.lX)&&this.fi.NM(14,bd.a.lX,fb)};B.prototype.p4h=function(oa,fb){var Rb={};Rb.worksheetId=oa;Rb.address=this.kgd(fb);fb=md.a.Kc(Rb);this.vTe(oa,fb)};B.prototype.b4h=
function(oa,fb,Rb,dc){if(this.ij.Wgf()){var uc="",Bd="";dc&&(uc=dc.jj);Rb&&(Bd=Rb.jj);dc?Rb?(fb=Rb.usedRange.pyb(fb),uc!==Bd&&this.$9b(uc,"",oa),this.$9b(Bd,this.kgd(fb),oa)):this.$9b(uc,"",oa):Rb&&(uc=Rb.usedRange.pyb(fb),this.$9b(Bd,this.kgd(uc),oa))}};B.prototype.$9b=function(oa,fb,Rb){if(this.ij.j_(100,oa)){var dc={};dc.address=fb;dc.worksheetId=Rb;this.fi.NM(100,oa,md.a.Kc(dc))}};B.prototype.kgd=function(oa){return vc.i(oa,",",this.$,!1)};B.prototype.dispose=function(){0<this.Hza&&this.grid.ha.uI(this.kd);
this.mjc=this.pNa=null;this.Hza=0;this.fi=this.ij=this.$=this.grid=null};Ek.Object.defineProperties(B.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.aV&&0<this.Hza}}});Object(Gb.a)(B,"RichApiEventSelectionChangedHandler",$a.a,[]);var pd=b(354);Am(E,B);E.prototype.aYe=function(){return pd.a.wrb(this.grid.ha.rangePicker.XK)};E.prototype.zre=function(oa,fb){return this.Uif!==oa||!vc.Q(this.Tif,fb)};E.prototype.NIe=function(oa,fb){this.Uif=oa;this.Tif=vc.d(fb)};E.prototype.Odf=
function(){return!this.grid.isEditing&&!this.grid.Mi};E.prototype.vTe=function(oa,fb){this.ij.j_(2700,bd.a.lX)&&this.fi.NM(2700,bd.a.lX,fb)};Object(Gb.a)(E,"RichApiEventPickedRangesChangedHandler",B,[]);y.prototype.Cob=function(oa){var fb=Mb.g(this.$).ha;1===oa.actionType?(this.hQa||this.iQa||fb.Oa.jVc(this.Nwf),2101===oa.messageType?this.hQa++:2102===oa.messageType&&this.iQa++):2===oa.actionType&&(2101===oa.messageType?this.hQa=0<this.hQa?this.hQa-1:0:2102===oa.messageType&&(this.iQa=0<this.iQa?
this.iQa-1:0),this.hQa||this.iQa||fb.Oa.iJd(this.Nwf))};y.prototype.emi=function(oa){return!!oa&&!!oa.floatingObject&&(0===oa.floatingObject.type||7===oa.floatingObject.type||1===oa.floatingObject.type||3===oa.floatingObject.type||5===oa.floatingObject.type)};y.prototype.BMj=function(oa){if(!oa||!oa.floatingObject)return null;oa=oa.floatingObject.id;var fb=oa.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));fb=fb&&1===fb.length?fb[0]:null;return fb?fb:(lb.ULS.sendTraceTag(537170457,344,
10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",oa),null)};y.prototype.nja=function(){var oa=this.$.xa.qa;return oa&&0===oa.GI?oa.sheetId:null};y.prototype.fireEvent=function(oa,fb,Rb){fb&&this.ij.j_(oa,fb)&&this.fi.NM(oa,fb,Rb)};Object(Gb.a)(y,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);t.prototype.Cob=function(oa){11===oa.messageType?oa.targetId===bd.a.lX?this.OLg(oa.actionType):this.NLg(oa.actionType):12===oa.messageType&&(oa.targetId===bd.a.lX?
this.PLg(oa.actionType):this.QLg(oa.actionType))};t.prototype.NLg=function(oa){this.QNf=this.rGa(oa,this.QNf,this.OTi)};t.prototype.QLg=function(oa){this.TNf=this.rGa(oa,this.TNf,this.RTi)};t.prototype.OLg=function(oa){this.RNf=this.rGa(oa,this.RNf,this.PTi)};t.prototype.PLg=function(oa){this.SNf=this.rGa(oa,this.SNf,this.QTi)};t.prototype.rGa=function(oa,fb,Rb){1===oa?fb=this.AXc(fb,Rb):2===oa&&(fb=this.m6c(fb,Rb));return fb};t.prototype.AXc=function(oa,fb){oa||this.$.xa.Bg(fb);oa++;return oa};t.prototype.m6c=
function(oa,fb){if(1>oa)return oa;1===oa&&this.$.xa.Xg(fb);oa--;return oa};t.prototype.x7a=function(oa){return!!oa&&0===oa.GI};t.prototype.Sia=function(oa,fb,Rb,dc){fb=(void 0===dc?0:dc)?bd.a.lX:fb;this.ij.j_(oa,fb)&&this.fi.NM(oa,fb,Rb)};Object(Gb.a)(t,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var jc=b(178),vd=b(13),ae=b(230),$d=Sys.EventArgs;Am(u,$d);Object(Gb.a)(u,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);v.prototype.dispose=function(){this.JOj()};v.prototype.C8i=function(){for(var oa=
El(this.gridView.yn),fb=oa.next();!fb.done;fb=oa.next())fb=fb.value.domElement,jc.a.instance.pa(vd.a.pointerDown,fb,this.onPointerDown),ae.a.instance.pa(vd.a.click,fb,this.vd)};v.prototype.JOj=function(){for(var oa=El(this.gridView.yn),fb=oa.next();!fb.done;fb=oa.next())fb=fb.value.domElement,jc.a.instance.za(vd.a.pointerDown,fb,this.onPointerDown),ae.a.instance.za(vd.a.click,fb,this.vd)};v.prototype.STi=function(oa){var fb=oa.sheet;if(this.x7a(fb)){var Rb={};Rb.worksheetId=fb.sheetId;Rb.address=
oa.dVg.toString();Rb.offsetX=oa.offsetX;Rb.offsetY=oa.offsetY;oa=fb.sheetId;this.ij.j_(21,oa)&&(fb=md.a.Kc(Rb),this.fi.NM(21,oa,fb));oa=bd.a.lX;this.ij.j_(21,oa)&&(Rb=md.a.Kc(Rb),this.fi.NM(21,oa,Rb))}};v.prototype.x7a=function(oa){return!!oa&&0===oa.GI};Object(Gb.a)(v,"RichApiEventSingleClickedHandler",null,[]);n.prototype.r0b=function(oa){2E3===oa.messageType&&(1===oa.actionType?(this.BHb||Mb.g(this.$).ha.Oa.jVc(this.QDf),this.BHb++,this.Eoj()):2===oa.actionType&&this.BHb&&(1===this.BHb&&Mb.g(this.$).ha.Oa.iJd(this.QDf),
this.BHb--))};n.prototype.Lad=function(oa){var fb,Rb={};Rb.worksheetId=oa;Rb.revisionLoad=!1;if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(ib.EwaSettings.ma(723)||ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){var dc=Mb.g(this.$).ha.Oa.FC;(null===(fb=null===dc||void 0===dc?void 0:dc.floatingObject)||void 0===fb?0:fb.$c)?Rb.selectedVisualId=dc.floatingObject.$c.VisualID:Rb.selectedVisualId=
null}fb=md.a.Kc(Rb);oa&&this.ij.j_(2E3,oa)&&this.fi.NM(2E3,oa,fb)};n.prototype.nja=function(){var oa=this.$.xa.qa;return oa&&0===oa.GI?oa.sheetId:null};n.prototype.Eoj=function(){var oa=Mb.g(this.$).ha.Oa.FC;this.Ghf(oa)&&(this.dab=oa.floatingObject.id,this.X$a=this.nja())};n.prototype.Ghf=function(oa){return!!oa&&oa.Grd()};Object(Gb.a)(n,"RichApiEventVisualSelectionChangedHandler",null,[]);w.prototype.MLg=function(oa){1===oa.actionType?(this.CHb||this.fMg(),this.CHb++):2!==oa.actionType||1>this.CHb||
(1===this.CHb&&this.Idh(),this.CHb--)};w.prototype.fMg=function(){if(this.ij.j_(2203,bd.a.lX))if(this.oqd){var oa={};oa.timeout=this.$.ya.CheckFocusTimeout;this.q$b=window.requestIdleCallback(this.Oxe,oa)}else this.q$b=window.setInterval(this.Nxe,this.$.ya.CheckFocusTimeInterval)};w.prototype.Idh=function(){this.oqd?window.cancelIdleCallback(this.q$b):window.clearInterval(this.q$b)};Object(Gb.a)(w,"RichApiEventWorkbookActivatedHandler",null,[]);var Bc;(function(oa){oa[oa.none=0]="none";oa[oa.registerEvent=
1]="registerEvent";oa[oa.unregisterEvent=2]="unregisterEvent";oa[oa.customFunction=3]="customFunction";oa[oa.showCard=4]="showCard";oa[oa.createWorkbook=5]="createWorkbook";oa[oa.openWorkbook=6]="openWorkbook";oa[oa.enableEvents=7]="enableEvents";oa[oa.closeWorkbook=8]="closeWorkbook";oa[oa.setCalculationMode=9]="setCalculationMode";oa[oa.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";oa[oa.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";oa[oa.workbookLinksEnableContent=
12]="workbookLinksEnableContent";oa[oa.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";oa[oa.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";oa[oa.rangePicker=15]="rangePicker";oa[oa.enableRichApiRecording=16]="enableRichApiRecording";oa[oa.recordAction=17]="recordAction";oa[oa.focus=18]="focus";oa[oa.businessBarShow=19]="businessBarShow";oa[oa.businessBarHide=20]="businessBarHide"})(Bc||(Bc={}));Object(Gb.b)("PostProcessActionType",Bc);var Hd=b(244);h.prototype.LLg=function(oa){1===
oa.actionType?(this.$.Aba=!0,Object(wb.a)(b(946).DdaFacade,Hd.a(this.$)).Kad(!0)):2===oa.actionType&&(this.$.Aba=!1);this.JEf=oa.controlId;lb.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",Bc[oa.actionType],this.JEf,this.$.Aba)};h.prototype.flh=function(oa){Object(wb.a)(b(946).DdaFacade,Hd.a(this.$)).yTe(oa,this.$.Aba)};h.prototype.gai=function(){var oa=this;this.$.Eba&&Na.TaskExtensions.Ba(zc.GetServiceTaskFactory.Va(this.$.da,
297,298,1),function(fb){(fb=fb.result)&&fb.init(oa.Jad)},this.$.la,3)};Object(Gb.a)(h,"RichApiMacroRecorderEventHandler",null,[]);Object(Gb.a)(r,"SessionRecreationInfo",null,[]);m.prototype.bCi=function(){return ib.EwaSettings.ma(260)?this.ij.Y4h()||0!==this.runtimeCalculationMode:!1};m.prototype.UQg=function(){var oa={};oa.eventRegistrationInfos=this.ij.XNh();oa.runtimeCalculationMode=this.runtimeCalculationMode;oa=Object(kb.a)(new r,{runtimeState:oa});var fb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",
RequestHeaders:null};fb.RequestBody=JSON.stringify(oa);fb.RequestFlags=1;return fb};Object(Gb.a)(m,"RichApiRuntimeStateHandler",null,[]);Object(Gb.a)(l,"UserOperationQueueItemsStatisticsData",null,[]);var xb=b(341),rd=b(31),tf=b(19),Kf=b(306),Ff=b(48),Pe=b(658),Xe=b(63),de=b(59),Kd=b(72),pe=xb.a;Am(f,pe);f.prototype.dispose=function(){this.$&&(this.$.xa.bL(this.Go),this.$.Hb.bL(this.Go),this.$.Hb.Xg(this.Ge),this.$.xa.Xg(this.Ge));this.kUa&&(this.kUa.Vq(this.zf),this.kUa.tI(this.Sm),this.kUa.Dv(this.Pi));
ib.EwaSettings.qc()&&this.cx(this.nya);this.clearCache();Cd.a.Ha(this.kUa);this.kUa=null;Zc.DOMElementExtensions.Af(this.domElement);pe.prototype.dispose.call(this)};f.prototype.woj=function(oa){Zc.DOMElementExtensions.Af(Zc.DOMElementExtensions.getElementById(this.domElement,oa.id));this.domElement.appendChild(oa)};f.prototype.Tld=function(){if(this.Dva&&!this.Q3b){var oa=Object(wb.a)(b(946).DdaFacade,Hd.a(this.$)).pn(this.Dva.InstanceId);oa&&(oa.resize(this.Dva.Width,this.Dva.Height),oa.ka(this.domElement),
oa.showHide(!0),this.Q3b=!0)}};f.prototype.z7a=function(){return!0};f.prototype.zna=function(oa){this.Dva=oa.nd.block.Be;this.Q3b=!1;this.Tld()};f.prototype.DTa=function(oa){this.$.ea.i_&&oa&&(oa.Ju||(oa.Ju=new Kf.a),oa.Ju.ti=new Ff.a(this.domElement.scrollLeft,this.domElement.scrollTop),oa.Ju.oGb=20)};f.prototype.clearCache=function(){this.Ea.nQa(this.hashCode);this.Dva=this.hashCode=null;this.Q3b=!1};f.prototype.GSa=function(oa,fb){if(this.isVisible=!!oa&&Xe.o(oa))this.hashCode=this.Ea.Jra(oa,de.a.Y5b,
this.hashCode),this.Lwc(fb)};f.sGa=function(oa){if(!oa.da.Aa(34)){var fb=oa.Lf;oa.da.Ga(34,new f(oa,new Pe.a(oa,oa.ea,oa.na.Lk,3,0),fb.appendChild(fb.ownerDocument.createElement("div"))))}};Ek.Object.defineProperties(f.prototype,{Ea:{configurable:!0,enumerable:!0,get:function(){return this.kUa}}});Object(Gb.a)(f,"WebExtensionView",xb.a,[569,443,3]);var Lf=b(231),Be=b(562),eg=b(387),Jc=b(467),Yd=b(175),Ge=b(84),ud=b(119),Ye=b(47),mf=b(44),xe=b(157),Qe=b(111),jg=b(69),je=b(28),pf=b(30),qg=b(292),Gf=
b(21),Mg=b(15),dg=b(291),lc=b(948),Nc=b(49),Nd=b(152),le=b(1168),ke=b(204),xd=b(1073),fc=b(27);b.d(C,"DdaFacade",function(){return a});var fe=zb.a;Am(a,fe);a.prototype.Vme=function(oa){this.addHandler("cd",oa)};a.prototype.gaj=function(oa){this.removeHandler("cd",oa)};a.prototype.eEg=function(oa){this.addHandler("csc",oa)};a.prototype.iaj=function(oa){this.removeHandler("csc",oa)};a.prototype.bEg=function(oa){this.addHandler("ca",oa)};a.prototype.faj=function(oa){this.removeHandler("ca",oa)};a.prototype.cEg=
function(oa){this.addHandler("ci",oa)};a.prototype.dEg=function(oa){this.addHandler("ekros",oa)};a.prototype.haj=function(oa){this.removeHandler("ekros",oa)};a.prototype.hDd=function(oa,fb){try{return JSON.parse(oa)[fb].toLowerCase()}catch(Rb){return""}};a.prototype.Yuj=function(oa){var fb=this.hDd(oa,"AudienceGroup"),Rb=this.hDd(oa,"SessionOrigin");try{var dc=parseInt(this.hDd(oa,"Ring"),10);if("automation"!==fb&&"bluechicken"!==Rb&&-2<=dc)return!0}catch(uc){if("automation"!==fb&&"bluechicken"!==
Rb)return!0}return!1};a.prototype.J0b=function(oa){var fb={};fb.Name=oa.Name;fb.BindingType=oa.BindingType;fb.HasHeaders=oa.HasHeaders;oa.IsValidRef&&(fb.ColCount=oa.Reference.LastColumn-oa.Reference.FirstColumn+1,fb.RowCount=oa.Reference.LastRow-oa.Reference.FirstRow+1);return fb};a.prototype.Pqi=function(oa,fb){this.Hn.launchInsertDialog(oa,null,this.YPg(fb))};a.prototype.Wca=function(oa,fb){var Rb={};Rb.callbackFunc=oa;Rb.storeType=OSF.StoreTypeEnum.MarketPlace;Rb.fromInsertDialog=!1;Rb.refresh=
fb;this.Hn.queryEntitlementDetails(Rb)};a.prototype.invokeDdaMethod=function(oa,fb){var Rb=this.pn(oa.DdaMethod.ControlId);Rb?Rb.invokeDdaMethod(oa,fb):this.wf(I.a.internalError,fb)};a.prototype.registerDdaEventAsync=function(oa,fb,Rb,dc,uc){(fb=this.pn(fb))?a.Zyb(oa)?fb.f7i(oa,Rb,dc,uc):this.wf(I.a.ACd,uc):this.wf(I.a.internalError,uc)};a.prototype.unregisterDdaEventAsync=function(oa,fb,Rb,dc,uc){(fb=this.pn(fb))?a.Zyb(oa)?fb.oOj(oa,Rb,dc,uc):this.wf(I.a.ACd,uc):this.wf(I.a.internalError,uc)};a.prototype.dispose=
function(){this.disposed||(this.$.Sl(this.zd),this.ea.Dk(this.od),this.ea.iS(this.Io),this.ea.Ev(this.Hf),this.jWc.detach(this),this.$.userOperationManager.Cr(this.WR),this.dpc=this.If=this.fi=this.jWc=this.wb=null,this.OIa&&(this.OIa.dispose(),this.OIa=null),Cd.a.Ha(this.TLd),Cd.a.Ha(this.SLd),this.d1a&&(this.d1a.dispose(),this.d1a=null),fe.prototype.dispose.call(this),this.disposed=!0,lb.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.Pdd=function(oa){return(oa=this.pn(oa))?
oa.getDefaultIconUrl():null};a.prototype.ewc=function(oa){if(this.tFe!==oa){this.tFe=oa;for(var fb=0,Rb=this.If.length;fb<Rb;fb++){var dc=this.If[fb];oa?dc.OHe(!1):dc.Vjh()}this.TLd.ewc(oa);this.SLd.ewc(oa)}};a.prototype.FMh=function(oa){return(oa=this.pn(oa))?oa.getDefaultDisplayName():null};a.prototype.wf=function(oa,fb,Rb){var dc={};dc[ba.a.Cg]=oa;dc[ba.a.K3]=fb;this.iK(451041795,dc,void 0===Rb?!0:Rb)};a.prototype.lv=function(oa){var fb={};fb[ba.a.K3]=oa;this.iK(1237877382,fb)};a.prototype.iK=
function(oa,fb,Rb){var dc=this;Rb=void 0===Rb?!0:Rb;var uc=new Ud.a(oa,0,this.$.ed,0,null),Bd=fb?fb[ba.a.K3]:null;this.d1a&&Mb.g(this.$).isEditing&&J.a_g(oa,fb)?this.d1a.zch(oa,fb):(oa=this.$.Ka.Xb(uc,fb),Rb&&Na.TaskExtensions.Ba(oa,function(Od){xe.a(Od)?dc.wf(I.a.internalError,Bd,!1):Od.result||(Mb.g(dc.$).isEditing?dc.wf(I.a.qyb,Bd,!1):dc.wf(I.a.internalError,Bd,!1))},this.la,8))};a.prototype.C1g=function(oa){var fb=this;return!!this.Ria(function(Rb){return a.getSolutionId(Rb.il,fb.$)===a.getSolutionId(oa,
fb.$)&&Rb.il.PrimaryMarketplace.MarketplaceType===oa.PrimaryMarketplace.MarketplaceType&&Rb.il.PrimaryMarketplace.MarketplaceRef===oa.PrimaryMarketplace.MarketplaceRef&&Rb.il.PrimaryMarketplace.SolutionVersion===oa.PrimaryMarketplace.SolutionVersion})};a.prototype.pn=function(oa){return this.Ria(function(fb){return fb.controlId.startsWith(oa)})};a.prototype.dBh=function(oa){return this.Ria(function(fb){return fb.dIa===oa})};a.prototype.USe=function(oa){return this.Ria(function(fb){return fb.MU===
oa&&!!fb.dIa})};a.prototype.nTe=function(oa,fb,Rb,dc){return this.Ria(function(uc){return uc.MU===oa&&uc.il.PrimaryMarketplace.MarketplaceRef.toLowerCase()===fb.toLowerCase()&&uc.il.PrimaryMarketplace.MarketplaceType.toLowerCase()===Rb.toLowerCase()&&!!uc.il.SharedRuntime&&!!uc.il.SharedRuntime.Resid&&!!dc&&!!dc.Resid&&uc.il.SharedRuntime.Resid.toLowerCase()===dc.Resid.toLowerCase()})};a.prototype.zLg=function(oa,fb){if(oa=this.pn(oa))oa.ka(fb),oa.showHide(!0)};a.prototype.ozj=function(oa){(oa=this.pn(oa))&&
oa.showHide(!1)};a.prototype.H0a=function(oa){var fb;if(1!==oa.WebExtensionType||this.$.Pd&8388608&&oa.TaskpaneVisible||this.$.Pd&8388608&&!oa.TaskpaneVisible&&Ob.HelperMethods.Kw(oa)){var Rb=null;Ob.HelperMethods.Kw(oa)&&(Rb=a.Uua(oa,this.$),oa.TaskpaneWidth||(oa.TaskpaneWidth=this.d6b));var dc=(new Q(this,this.fi,oa)).Gld();lb.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(oa.PrimaryMarketplace.SolutionId,
oa.PrimaryMarketplace.MarketplaceType,null===(fb=oa.AssetMarketplace)||void 0===fb?void 0:fb.SolutionId,null,null,oa.PrimaryMarketplace.MarketplaceRef),oa.PrimaryMarketplace.MarketplaceType,Ob.HelperMethods.Kw(oa));Rb&&(dc.dIa=Rb);this.If.push(dc);this.mxa=null;this.U5a(oa.InstanceId)||(oa=String.format("{0}|{1}|{2}|{3}|{4}",oa.PrimaryMarketplace.SolutionId,oa.PrimaryMarketplace.SolutionVersion,oa.PrimaryMarketplace.MarketplaceRef,oa.PrimaryMarketplace.MarketplaceType,oa.WebExtensionType),this.raiseEvent("ci",
oa))}};a.prototype.XAj=function(oa,fb){function Rb(){dc.pQa(Bd.controlId);dc.Fi.purgeOsfControl(Bd.controlId,!1);fb()}var dc=this;oa.TaskpaneWidth=this.d6b;oa.TaskpaneVisible=!0;var uc={};uc.SolutionId=oa.PrimaryMarketplace.SolutionId;uc.TargetType=oa.WebExtensionType;uc.Version=oa.PrimaryMarketplace.SolutionVersion;uc.StoreType=oa.PrimaryMarketplace.MarketplaceType;uc.StoreId=oa.PrimaryMarketplace.MarketplaceRef;uc.AssetId=oa.PrimaryMarketplace.SolutionId;uc.AssetStoreId=oa.PrimaryMarketplace.MarketplaceRef;
uc.Width=oa.TaskpaneWidth;var Bd=new Q(this,this.fi,oa,!0);Bd.Gld();this.If.push(Bd);var Od=null;Od=Ye.a.instance.BC(function(){Bd.Dy&&(Cd.a.Ha(Od),Od=null,dc.Fi.insertBlankControlWithErrorUX(dc.uGb(Bd,uc),Rb))},100,mf.a.qbh)};a.prototype.o5g=function(oa){var fb=this;if(oa&&oa.length){var Rb=[];oa.forEach(function(dc){if(dc.ContainsCustomFunctions){var uc=a.Uua(dc,fb.$);fb.EDd.contains(uc)||(fb.EDd.add(uc),fb.bGf.push(dc));fb.C1g(dc)||Rb.push(dc)}});Rb.length&&this.FCe(Rb)}};a.prototype.AEe=function(oa,
fb){this.pn(oa.InstanceId)||(fb=fb(),oa=(new Q(this,this.fi,oa)).T9e(fb),this.If.push(oa),this.mxa=null)};a.prototype.Jyj=function(oa){a.Y0a.xb(oa)&&a.Y0a.oa(oa).initializeAndShowWithTitle()};a.prototype.U5h=function(oa){a.Y0a.xb(oa)&&a.Y0a.oa(oa).hide()};a.prototype.uTh=function(oa){var fb=this,Rb=null,dc,uc=null;var Bd=a.Dhd(oa,!0);if(!Bd)return lb.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Ub.Task.Sa(null);(dc=this.Hn.getOsfControl(a.getSolutionId(Bd,
this.$)))&&(Rb=dc.getManifest())&&(uc=Rb.getSharedRuntimeForCustomFunctions("Workbook"));if(Rb=uc&&1===uc.LifeTime?this.nTe(Bd.PrimaryMarketplace.SolutionId,Bd.PrimaryMarketplace.MarketplaceRef,Bd.PrimaryMarketplace.MarketplaceType,uc):this.dBh(oa))return Ub.Task.Sa(Rb.controlId);var Od=new Xb.a;Ob.HelperMethods.Hic(uc)&&(Bd.SharedRuntime=uc);oa=dc?dc.getNotificationParams():[];if(!oa.length)return this.iDe(Bd);this.x2f(oa,function(){Na.TaskExtensions.Ba(Od.task,function(){fb.iDe(Bd)},fb.la,3)},function(){});
return Od.task};a.prototype.JHh=function(oa){oa=a.Dhd(oa,!1);if(!oa)return lb.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var fb=null,Rb=this.Hn.getOsfControl(a.getSolutionId(oa,this.$));Rb&&(Rb=Rb.getManifest())&&(fb=Rb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Ob.HelperMethods.Hic(fb)&&(oa=this.nTe(oa.PrimaryMarketplace.SolutionId,oa.PrimaryMarketplace.MarketplaceRef,oa.PrimaryMarketplace.MarketplaceType,fb))?oa.controlId:
null};a.prototype.M3g=function(oa,fb){var Rb=this,dc=a.Dhd(oa,!1);if(dc){var uc=null,Bd=this.Hn.getOsfControl(a.getSolutionId(dc,this.$));Bd&&(Bd=Bd.getManifest())&&(uc=Bd.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Ob.HelperMethods.Hic(uc)){dc.SharedRuntime=uc;var Od=dc.PrimaryMarketplace.SolutionId;Bd=dc.PrimaryMarketplace.SolutionVersion;var Td=OSF.OsfManifestManager.getCachedManifest(Od,Bd);if(Td)if(this.XZb.xb(oa))uc=this.XZb.oa(oa),Na.TaskExtensions.Ba(uc,function(wf){(wf=wf.result)&&
OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(wf,fb,Rb.fi.SJb)},this.la,3);else{var Ze={solutionId:Od,version:Bd};Ze.storeType=dc.PrimaryMarketplace.MarketplaceType;Ze.storeId=dc.PrimaryMarketplace.MarketplaceRef;Ze.assetId=Od;Ze.assetStoreId=null;Ze.targetType=OSF.OsfControlTarget.TaskPane;var vf=new Xb.a;dc=Na.TaskExtensions.hl();dc=new jb.a(this.$,this,Ze,dc);uc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Od,uc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Td,
uc,Bd);dc.createUILessSandbox(Ze,Td,function(wf,Wf){wf&&!Wf?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(wf,fb,Rb.fi.SJb),vf.setResult(wf)):vf.setResult(null);Rb.XZb.remove(oa)});this.XZb.ia(oa,vf.task)}}}else lb.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.Axe=function(oa){(oa=this.USe(oa))&&(oa.il.SharedRuntime||this.JHb(oa.controlId))};a.prototype.JHb=function(oa){(oa=this.USe(oa))&&this.pQa(oa.controlId)};
a.prototype.vgh=function(oa,fb){if(!this.If||!oa||!fb)return!1;if(oa.toLowerCase()===fb.toLowerCase())return!0;for(var Rb=null,dc=null,uc=0,Bd=this.If.length;uc<Bd;uc++){var Od=this.If[uc];if(Od.ownerAddinSolutionId&&(Od.controlId===oa&&(Rb=Od.ownerAddinSolutionId.toLowerCase()),Od.controlId===fb&&(dc=Od.ownerAddinSolutionId.toLowerCase()),Rb&&dc))break}return Rb&&Rb===dc?!0:!1};a.prototype.GBg=function(oa){this.pn(oa.InstanceId)||(oa=new Q(this,this.fi,oa),this.If.push(oa),this.mxa=null)};a.prototype.NOf=
function(oa){if(this.If&&0<=oa&&oa<this.If.length){var fb=this.If[oa],Rb=fb.Dy;Array.removeAt(this.If,oa);this.Cvf(fb);Zc.DOMElementExtensions.Af(Rb)}};a.prototype.pQa=function(oa){if(this.If)for(var fb=0,Rb=this.If.length;fb<Rb;fb++)if(this.If[fb].controlId===oa){this.NOf(fb);break}};a.prototype.e$i=function(oa){if(this.If){oa=oa.toLowerCase();for(var fb=0,Rb=this.If.length;fb<Rb;fb++)if(oa===this.If[fb].ownerAddinSolutionId.toLowerCase()){this.NOf(fb);break}}};a.prototype.eMg=function(oa){oa.un&&
(this.pn(oa.floatingObject.il.InstanceId)||(this.Bfc(oa.floatingObject.il.InstanceId)||this.dpc.push(oa.floatingObject.il.InstanceId),this.H0a(oa.floatingObject.il)),this.ea.isNamedObjectViewMode&&this.zLg(oa.floatingObject.il.InstanceId,oa.Sd))};a.prototype.Aaa=function(oa){if(this.If)for(var fb=0,Rb=this.If.length;fb<Rb;fb++)if(1===this.If[fb].controlType&&Gf.a.equals(this.If[fb].MU,oa,!0))return this.If[fb].controlId;return null};a.prototype.FAh=function(oa){var fb=[];if(this.If)for(var Rb=0,dc=
this.If.length;Rb<dc;Rb++)Gf.a.equals(this.If[Rb].MU,oa,!0)&&fb.push(this.If[Rb].controlId);return fb};a.prototype.kBh=function(oa,fb){if(!fb||!oa)return null;if(this.If)for(var Rb=0,dc=this.If.length;Rb<dc;Rb++)if(1===this.If[Rb].controlType&&Gf.a.equals(this.If[Rb].MU,oa,!0)&&this.If[Rb].il.SharedRuntime&&Gf.a.equals(this.If[Rb].il.SharedRuntime.Resid,fb.Resid,!0))return this.If[Rb].controlId;return null};a.prototype.m3a=function(oa,fb){fb=void 0===fb?null:fb;return oa?fb?String.format("{0}.{1}",
oa,fb):oa:""};a.prototype.Dxe=function(oa,fb,Rb){if(this.mxa===oa)return!0;this.mxa=oa;var dc=null,uc=!1;if(!dc&&this.If)for(var Bd=0,Od=this.If.length;Bd<Od;Bd++)if(1===this.If[Bd].controlType&&Gf.a.equals(this.If[Bd].MU,oa,!0)){var Td=!1,Ze=!1;fb?(Td=!0,Ze=!!this.If[Bd].il.SharedRuntime&&Gf.a.equals(this.If[Bd].il.SharedRuntime.Resid,fb.Resid,!0)):Rb&&(Td=!0,Ze=Gf.a.equals(this.If[Bd].il.SharedRuntimeId,Rb,!0));if(!Td||Ze){Ze&&this.If[Bd].jg(!0);dc=this.If[Bd].controlId;uc=!0;this.mxa=null;break}}dc&&
this.raiseEvent("ca",dc);return uc};a.prototype.setAppRuntimeState=function(oa,fb){var Rb;if(oa){var dc=this.pn(oa);if(dc&&Ob.HelperMethods.Kw(dc.il))dc.jg(fb),fb&&(this.raiseEvent("ca",oa),(null===(Rb=dc.Dy)||void 0===Rb?0:Rb.firstChild)&&(oa=dc.Dy.firstChild.title)&&0<oa.length&&this.b0b.tmj(oa));else throw lb.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Mg.a.instance.fa(2195));}else throw lb.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(Mg.a.instance.fa(2196));};a.prototype.getAppRuntimeState=function(oa){if(oa)if((oa=this.pn(oa))&&Ob.HelperMethods.Kw(oa.il))oa=oa.il.TaskpaneVisible;else throw lb.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Mg.a.instance.fa(2195));else throw lb.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Mg.a.instance.fa(2196));return oa};a.prototype.J2a=function(oa,fb){return(oa=
this.pn(oa))?oa.J2a(fb):null};a.prototype.U5a=function(oa){return this.Fxe(this.dpc,oa)};a.prototype.Bfc=function(oa){return this.Fxe(this.oFe,oa)};a.prototype.jle=function(oa){this.oFe.push(oa)};a.prototype.FZ=function(oa){return(oa=this.pn(oa))?oa.il:null};a.prototype.xyd=function(oa){this.raiseEvent("ekros",oa,this)};a.prototype.fCd=function(oa){if(oa){var fb=this.pn(oa.InstanceId);fb&&(oa.SharedRuntime||oa.SharedRuntimeId||(this.pQa(fb.controlId),this.Fi.purgeOsfControl(fb.controlId,!1)),fb={},
fb.SolutionId=oa.PrimaryMarketplace.SolutionId,fb.TargetType=oa.WebExtensionType,fb.Version=oa.PrimaryMarketplace.SolutionVersion,fb.StoreType=oa.PrimaryMarketplace.MarketplaceType,fb.StoreId=oa.PrimaryMarketplace.MarketplaceRef,fb.AssetId=oa.PrimaryMarketplace.SolutionId,fb.AssetStoreId=oa.PrimaryMarketplace.MarketplaceRef,fb.Width=oa.TaskpaneWidth,fb.SharedRuntimeId=oa.SharedRuntimeId,this.o$f(fb))}};a.prototype.yia=function(){this.fi.yia()};a.prototype.NM=function(oa,fb,Rb){this.fi.NM(oa,fb,Rb)};
a.prototype.Cmj=function(oa,fb){var Rb=Array(2);Rb[0]=fb;Rb[1]=null;this.fi.zBh(oa,JSON.stringify(Rb))};a.prototype.yTe=function(oa,fb){fb=a.X8g(fb);oa=this.FZ(oa);this.fi.Z9b(oa.InstanceId,2202,bd.a.lX,fb)};a.prototype.Kad=function(oa){for(var fb=0,Rb=this.If.length;fb<Rb;fb++)this.yTe(this.If[fb].controlId,oa)};a.prototype.vBh=function(oa,fb){fb=a.q4g(fb);this.fi.Z9b(oa,65539,"",fb)};a.prototype.xBh=function(oa,fb,Rb){this.fi.Z9b(oa,1,fb,Rb)};a.prototype.uBh=function(oa,fb){this.fi.yBh(oa,fb)};
a.prototype.J3g=function(oa,fb){return[[2,1E3,"",JSON.stringify([oa,fb]),0,!1]]};a.prototype.vei=function(){return!!this.$ma&&this.$ma.j6e()};a.prototype.AXg=function(){this.$ma&&this.$ma.clear()};a.prototype.wBh=function(){if(this.$ma&&this.$ma.j6e()){var oa=this.$ma.LHh();oa=El(oa);for(var fb=oa.next();!fb.done;fb=oa.next()){fb=this.FAh(fb.value);fb=El(fb);for(var Rb=fb.next();!Rb.done;Rb=fb.next())this.fi.Z9b(Rb.value,65540,"","{}")}}};a.prototype.Z6i=function(oa){this.$ma.add(oa)};a.prototype.kOj=
function(oa){this.$ma.remove(oa)};a.prototype.Ria=function(oa){if(!this.If)return null;for(var fb=El(this.If),Rb=fb.next();!Rb.done;Rb=fb.next())if(Rb=Rb.value,oa(Rb))return Rb;return null};a.prototype.iDe=function(oa){var fb=this,Rb=new Xb.a,dc=a.Uua(oa,this.$);if(Ob.HelperMethods.Kw(oa))lb.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.ZFf(oa,function(Bd){Bd?(oa.InstanceId=Bd.InstanceId,oa.WebExtensionOsfControlType=3,oa.TaskpaneVisible=!1,fb.H0a(oa),Rb.setResult(oa.InstanceId)):
(lb.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetPrivacyCompliantId(oa.PrimaryMarketplace.SolutionId,oa.PrimaryMarketplace.MarketplaceType,null,null,null,oa.PrimaryMarketplace.MarketplaceRef)),Rb.setException(Error.create("Null insert data")))});else{a.Y0a.ia(oa.InstanceId,new cb.a);var uc=a.Y0a.oa(oa.InstanceId).q1a;this.n5g(oa,uc,dc);this.ZFf(oa,null);Rb.setResult(oa.InstanceId)}return Rb.task};a.prototype.n5g=function(oa,fb,Rb){this.pn(oa.InstanceId)||
(oa=new Q(this,this.fi,oa),oa.dIa=Rb,oa.T9e(fb),this.If.push(oa),this.mxa=null)};a.prototype.ZFf=function(oa,fb){var Rb=a.Uua(oa,this.$);if(!this.EDd.contains(Rb))this.VFb.push(oa),1<=this.VFb.length&&this.$Ff(oa,fb);else if(fb){oa=El(this.bGf);for(var dc=oa.next();!dc.done;dc=oa.next())if(dc=dc.value,a.Uua(dc,this.$)===Rb){fb(dc,0);break}}};a.prototype.$Ff=function(oa,fb){function Rb(wf){wf&&!qg.a(wf)||lb.ULS.sendTraceTag(537170527,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(Od.SolutionId,Od.StoreType,Od.AssetId,null,null,Od.StoreId),pf.a.Wc(wf.Errors));uc.VFb.shift();0<uc.VFb.length&&uc.$Ff(uc.VFb[0],fb)}function dc(wf){wf=ud.a.pg(wf.data);lb.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",pf.a.Wc(wf))}var uc=this,Bd=null,Od={};Od.SolutionId=a.getSolutionId(oa,this.$);Od.TargetType=oa.WebExtensionType;Od.Version=oa.PrimaryMarketplace.SolutionVersion;
Od.StoreType=oa.PrimaryMarketplace.MarketplaceType;Od.StoreId=oa.PrimaryMarketplace.MarketplaceRef;Od.AssetId=oa.PrimaryMarketplace.SolutionId;Od.AssetStoreId=oa.PrimaryMarketplace.MarketplaceRef;Od.Width=oa.TaskpaneWidth;Od.ContainsCustomFunctions=!0;Ob.HelperMethods.Kw(oa)&&(Od.SharedRuntimeId=oa.SharedRuntime.Resid);var Td=this.$.na.ua;oa=this.$.na.ua.hc();var Ze=Td.Na(9,oa);Ze.sharedInfo=Od;if(fb){var vf=function(wf){var Wf=wf.Result;(Bd=Wf?Wf.AgaveData:null)||fb(null,wf.Errors?wf.Errors[0].ErrorCause:
5001);fb(Bd,0)};oa=function(wf,Wf,ug){return Ge.i(Td,"InsertAgaveTaskpane",Ze,dg.b(wf,Rb,vf),dg.a(Wf,dc),ug,null,0)}}else oa=function(wf,Wf,ug){return Ge.i(Td,"InsertAgaveTaskpane",Ze,dg.b(wf,Rb),dg.a(Wf,dc),ug,null,0)};ib.EwaSettings.qc()?eg.a(this.$.userOperationManager,oa,function(wf){return new Yd.a(519,0,wf,64)},null):eg.a(this.$.userOperationManager,oa,function(wf){return new Be.a(519,0,wf)},null)};a.prototype.Ovj=function(){return this.$.Yf.get(35)};a.prototype.PId=function(oa){oa=this.pn(oa);
(null===oa||void 0===oa?0:oa.Ada)&&oa.WOf()};a.prototype.pDi=function(oa){var fb=this.Ria(function(Rb){return a.aMa(Rb.MU)});fb&&(fb=this.Fi.getOsfControl(fb.controlId))&&fb.notifyAgave(OSF.AgaveHostAction.SendMessage,oa)};a.prototype.jfi=function(){return!!this.Ria(function(oa){return 1===oa.controlType&&a.aMa(oa.MU)})};a.prototype.ifi=function(){var oa=this.Ria(function(fb){return a.aMa(fb.MU)});return oa?oa.Dy?Zc.DOMElementExtensions.isVisible(oa.Dy):!1:!1};a.prototype.upj=function(){var oa=this.Ria(function(fb){return a.aMa(fb.MU)});
oa&&(oa.jg(!0),this.raiseEvent("ca",oa.controlId))};a.prototype.initialize=function(){var oa=b(1408).DdaEventDispatch,fb=void 0===this.$||null===this.$||ib.EwaSettings.ma(260);void 0!==this.$&&null!==this.$||lb.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");fb&&lb.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(f.sGa(this.$),this.ea=this.$.ea,this.fi=new oa(this.$),this.$.nl(this.zd),
this.ea.hk(this.od),this.ea.mM(this.Io),this.ea.Ot(this.Hf),this.$.userOperationManager.Vu(this.WR),this.xkf(),this.CNi(),this.u$h(),this.$.da.Ga(35,this),this.jWc.ka(this),fb&&lb.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.hfe=new bd.a,fb&&lb.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.kfe=new t(this.$,this.ij,this.fi),this.Oug=new v(this.$,this.ij,this.fi),this.ife=new B(this.$,this.ij,this.fi),this.gfe=
new E(this.$,this.ij,this.fi),this.ffe=new z(this.$,this.ij,this.fi),this.jfe=new y(this.$,this.ij,this.fi),this.lfe=new n(this.$,this.ij,this.fi),this.mfe=new w(this.$,this.ij,this.fi),this.$.Eba&&(this.nfe=new h(this.$,this.ij,this.fi)),ib.EwaSettings.ma(191)&&(this.d1a=new J(this,Mb.g(this.$))),ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.efe=new M),this.initialized=!0,lb.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.qBh=
function(oa){if(!this.aCa)return null;for(var fb=0,Rb=this.aCa.length;fb<Rb;fb++)if(oa.startsWith(this.aCa[fb].WebExtensionId))return this.aCa[fb];return null};a.prototype.xkf=function(){var oa,fb=this.ea;if(fb.sc&&!this.pPb){if(fb.workbookContext){if(this.eTc=this.$.ea.Zg.get(22),null===(oa=fb.workbookContext.WebExtensions)||void 0===oa?0:oa.length){oa=fb.workbookContext.WebExtensions;fb=!1;for(var Rb={},dc=oa.length-1;0<=dc;Rb={KPb:Rb.KPb},dc--){if(!this.ea.isNamedObjectViewMode){this.dpc.push(oa[dc].InstanceId);
if(1!==oa[dc].WebExtensionType){Array.removeAt(oa,dc);continue}if(Ob.HelperMethods.Kw(oa[dc])&&0!==oa[dc].SharedRuntime.State)1===oa[dc].SharedRuntime.State?oa[dc].TaskpaneVisible=!1:2===oa[dc].SharedRuntime.State?oa[dc].TaskpaneVisible=!0:lb.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!oa[dc].ContainsCustomFunctions&&!oa[dc].TaskpaneVisible&&!Vb.a(oa[dc])){Array.removeAt(oa,dc);continue}}var uc=OSF.OsfControl.isFirstPartyStoreString(oa[dc].PrimaryMarketplace.MarketplaceType);
ib.EwaSettings.ma(187)&&!uc&&(Array.removeAt(oa,dc),fb||(fb=!0,Rb.KPb=zc.GetServiceTaskFactory.Va(this.$.da,5,4,3),Na.TaskExtensions.Ba(Rb.KPb,function(Bd){return function(){Bd.KPb.result.eg(35,null)}}(Rb),this.la,3)));ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&oa[dc].PrimaryMarketplace&&a.aMa(oa[dc].PrimaryMarketplace.SolutionId)&&(lb.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(oa,
dc))}this.FCe(oa)}}else this.eTc=!1;this.pPb=!0}};a.prototype.I4e=function(oa){var fb=Mb.g(this.$),Rb=fb.ha.Oa.oc;if(Rb&&oa){oa=!1;if(this.If)for(var dc=El(this.If),uc=dc.next();!uc.done;uc=dc.next())if(uc=uc.value,a.aMa(uc.MU)||a.sii(uc.MU)){oa=!0;break}oa||fb.ha.Oa.jH(Rb)}};a.prototype.CNi=function(){this.Fi&&this.ea.isNamedObjectViewMode&&this.$.qa&&Xe.o(this.$.qa)&&(this.$.da.Aa(34).lR?this.$.da.Aa(34).Tld():this.$.da.Aa(34).Nt(this.yTi))};a.prototype.FCe=function(oa){var fb=this,Rb=null;Rb=function(Bd){function Od(){fb.rPa.shift();
0<fb.rPa.length&&Rb(fb.rPa[0])}var Td=Bd.WebExtensionData,Ze=Bd.IsTaskPane,vf=Bd.RecordHandler;if(fb.Aaa(Td.PrimaryMarketplace.SolutionId))Od();else{Ze&&(Td.WebExtensionOsfControlType=1);var wf=Vb.a(Td);if(!Ze||Td.TaskpaneVisible||wf||Td.SharedRuntime&&0!==Td.SharedRuntime.State||Td.ContainsCustomFunctions){var Wf=new Q(fb,fb.fi,Td,!Ze);lb.ULS.sendTraceTag(537170517,0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Td.PrimaryMarketplace.SolutionId,
Td.PrimaryMarketplace.MarketplaceType,null,null,null,Td.PrimaryMarketplace.MarketplaceRef),Td.PrimaryMarketplace.MarketplaceType,Ob.HelperMethods.Kw(Td));Wf.Gld();Ob.HelperMethods.Kw(Td)&&(Wf.dIa=a.Uua(Td,fb.$),Td.TaskpaneWidth=fb.d6b);wf&&(Td.WebExtensionToolTip="");Ze&&Td.TaskpaneVisible&&!wf&&(Td.TaskpaneWidth=fb.d6b);fb.If.push(Wf);var ug=fb.mxa=null;ug=Ye.a.instance.BC(function(){Wf.Dy&&(Cd.a.Ha(ug),ug=null,vf&&vf(Bd,Wf),Od())},100,mf.a.pbh)}else Od()}};for(var dc={},uc=0;uc<oa.length;dc={t1:dc.t1},
uc++)if(!this.pn(oa[uc].InstanceId))if(1!==oa[uc].WebExtensionType)this.H0a(oa[uc]);else if(!ib.EwaSettings.ma(54))this.Imb(oa[uc],Rb);else if(this.$.Pd&8388608||oa[uc].TaskpaneVisible)dc.t1={},dc.t1.marketplaceId=oa[uc].PrimaryMarketplace.SolutionId,dc.t1.marketplaceVersion=oa[uc].PrimaryMarketplace.SolutionVersion,dc.t1.storeType=oa[uc].PrimaryMarketplace.MarketplaceType,dc.t1.storeId=oa[uc].PrimaryMarketplace.MarketplaceRef,dc.t1.targetData=oa[uc],this.Fi.isAddinCommandsAsync(dc.t1,function(Bd){return function(Od,
Td,Ze){if(Od){var vf=Ze.targetData;if(Td){if(ib.EwaSettings.ma(88))if(Bd.t1.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Od=Bd.t1.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Td=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&Bd.t1.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Od||Td)&&Ob.HelperMethods.Kw(vf)&&fb.Imb(vf,Rb);else if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))fb.b3h(Ze,
Rb);else{var wf=!1;fb.Wca(function(Wf){if(!Wf.errorCode){if(Wf.value){Wf=El(Wf.value);for(var ug=Wf.next();!ug.done&&!wf;ug=Wf.next())wf=ke.c(ug.value[1])===ke.c(vf.PrimaryMarketplace.SolutionId)}wf?Ob.HelperMethods.Kw(vf)&&fb.Imb(vf,Rb):(Wf={},Wf.SolutionId=Ze.marketplaceId,Wf.TargetType=vf.WebExtensionType,Wf.Version=Ze.marketplaceVersion,Wf.StoreType=vf.PrimaryMarketplace.MarketplaceType,Wf.StoreId=Ze.storeId,Wf.AssetId=Ze.marketplaceId,Wf.AssetStoreId=Ze.storeId,Wf.Width=vf.TaskpaneWidth,vf.TaskpaneVisible=
!0,fb.Wje(Wf,vf,Rb))}},!0)}}else fb.Imb(vf,Rb)}else Od=Ze.targetData,lb.ULS.sendTraceTag(542185164,220,15,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetPrivacyCompliantId(Od.PrimaryMarketplace.SolutionId,Od.PrimaryMarketplace.MarketplaceType,null,null,null,Od.PrimaryMarketplace.MarketplaceRef),Od.PrimaryMarketplace.MarketplaceType)}}(dc))};a.prototype.b3h=function(oa,fb){var Rb=this,dc=!1;this.Wca(function(uc){var Bd=oa.targetData;if(!uc.errorCode){if(uc.value){uc=
El(uc.value);for(var Od=uc.next();!Od.done&&!dc;Od=uc.next())dc=ke.c(Od.value[1])===ke.c(Bd.PrimaryMarketplace.SolutionId)}dc?Ob.HelperMethods.Kw(Bd)&&Rb.Imb(Bd,fb):(uc={},uc.SolutionId=oa.marketplaceId,uc.TargetType=Bd.WebExtensionType,uc.Version=oa.marketplaceVersion,uc.StoreType=Bd.PrimaryMarketplace.MarketplaceType,uc.StoreId=oa.storeId,uc.AssetId=oa.marketplaceId,uc.AssetStoreId=oa.storeId,uc.Width=Bd.TaskpaneWidth,Bd.TaskpaneVisible=!0,Rb.Wje(uc,Bd,fb))}},!0)};a.prototype.Imb=function(oa,fb){var Rb=
{};Rb.WebExtensionData=oa;Rb.IsTaskPane=!0;this.rPa.push(Rb);1===this.rPa.length&&fb(Rb)};a.prototype.Wje=function(oa,fb,Rb){var dc=this,uc={};uc.ActivationInfo=oa;uc.WebExtensionData=fb;uc.IsTaskPane=!1;uc.RecordHandler=function(Bd,Od){var Td=Bd.ActivationInfo;dc.Fi.insertBlankControlWithErrorUX(dc.uGb(Od,Td),function(){dc.pQa(Od.controlId);dc.Fi.purgeOsfControl(Od.controlId,!1);dc.o$f(Td)})};this.rPa.push(uc);1===this.rPa.length&&Rb(uc)};a.prototype.o$f=function(oa){var fb={};fb.solutionId=oa.SolutionId;
fb.version=oa.Version;fb.storeType=oa.StoreType;fb.storeId=oa.StoreId;fb.assetId=oa.AssetId;fb.assetStoreId=oa.AssetStoreId;fb.targetType=oa.TargetType;fb.sharedRuntimeId=oa.SharedRuntimeId;oa=new Gc.a;oa.add(fb);fb={};fb[rc.a.Jnb]=oa;fb[rc.a.hU]=3;oa=new Ud.a(fc.a.vBb,0,this.$.ed,0,null);this.$.Ka.Xb(oa,fb)};a.prototype.uGb=function(oa,fb){var Rb={};Rb.div=oa.Dy;Rb.id=oa.controlId;Rb.solutionId=fb.SolutionId;Rb.version=fb.Version;Rb.storeId=fb.StoreId;Rb.storeType=fb.StoreType;Rb.osfControlType=
OSF.OsfControlTarget.TaskPane;return Rb};a.prototype.DSf=function(){var oa=this;if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var fb=[],Rb=0;Rb<this.If.length;Rb++){var dc=this.If[Rb];0!==dc.osfControlType&&3!==dc.osfControlType&&4!==dc.osfControlType||fb.push(dc)}Rb=!1;for(dc=0;dc<fb.length;dc++){var uc=fb[dc];this.pQa(uc.controlId);!Rb&&uc&&uc.il&&(Rb=Ob.HelperMethods.Kw(uc.il))}Rb&&(fb={},fb=(fb.DynamicAddinCommandsMethodDispatchId=4,fb),this.iK(-1014260128,
fb))}ib.EwaSettings.ma(405)&&Na.TaskExtensions.Ba(zc.GetServiceTaskFactory.Va(this.$.da,278,279,3),function(Bd){Bd&&(Bd=Bd.result)&&(oa.$.da.Aa(278)||oa.$.da.Ga(278,Bd),Bd.Y$e().cna())},this.la,3)};a.prototype.hL=function(){var oa=this,fb=new m(this.$,this.ij,this.ETf);void 0===this.$||null===this.$?lb.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):ib.EwaSettings.ma(260)&&lb.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+
(void 0===this.ij||null===this.ij));if(fb.bCi()){var Rb=function(){},dc=function(Od){Od=ud.a.pg(Od.data);lb.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",pf.a.Wc(Od))},uc=fb.UQg();fb=function(Od,Td,Ze){return Ge.i(oa.$.na.ua,"ExecuteRichApiRequest",oa.VQg(uc),dg.b(Od,Rb),dg.a(Td,dc),Ze,null,0)};var Bd=a.Jfd(uc);ib.EwaSettings.qc()?this.$.userOperationManager.Zt(new Yd.a(507,0,fb,Bd|64)):this.$.userOperationManager.Zt(new Be.a(507,
0,fb,Bd))}};a.prototype.VQg=function(oa){var fb=this.$.na.ua.Na(1);fb.request=oa;return fb};a.prototype.Fxe=function(oa,fb){if(oa)for(var Rb=0;Rb<oa.length;Rb++)if(Gf.a.equals(oa[Rb],fb,!0))return!0;return!1};a.prototype.YPg=function(oa){var fb={};fb.navigationMode=OSF.OsfNavigationMode.DefaultMode;fb.assetId=null;fb.category=null;if(!oa||3>oa.length)return fb;if(oa[0]){var Rb=parseInt(oa[0],10);isNaN(parseInt(Rb,10))||(fb.navigationMode=Rb)}oa[1]&&(fb.assetId=oa[1]);oa[2]&&(fb.category=oa[2]);return fb};
a.prototype.u$h=function(){if(ib.EwaSettings.ma(62)){var oa=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(oa&&"*"!==oa.trim()){this.OIa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new ca(this),oa,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Yf.get(2));try{this.OIa.init()}catch(fb){try{this.OIa.dispose()}catch(Rb){}this.OIa=null;lb.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+fb.message)}oa={};oa.a=this.$.ya.UserSessionId;
Nc.b().Qe(39,oa)}}};a.prototype.x2f=function(oa,fb,Rb){var dc=this,uc=a.kPg(oa[0]),Bd=uc.vha,Od=uc.mia;uc.vha=function(){Bd&&Bd();var Td=uc.BLa!==OSF.InfoType.Error?fb:null;oa.shift();oa.length?dc.x2f(oa,Td,Rb):Td&&Td()};uc.mia=function(){Od&&Od();Rb&&uc.BLa!==OSF.InfoType.Error&&Rb()};ob.a.FRd(uc)};a.prototype.fQh=function(){var oa={};oa.AddinRibbonControlsOverriddenByApi=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();oa.AddinActionDefinitionHybridMode=
ib.EwaSettings.ma(644).toString();oa.UseActionIdForUILessCommand=ib.EwaSettings.ma(647).toString();oa.AllowStorageAccessByUserActivationOnIFrame=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();oa.RequirementSetRibbonApiOnePointTwo=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();oa.flightingTreatmentVariables=Ha.AFrameworkApplication.ga.i$b;oa.ShortcutInfoArrayInUserPreferenceData=
ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return oa};a.getSolutionId=function(oa){var fb=oa.PrimaryMarketplace.SolutionId;ib.EwaSettings.ma(294)&&oa.OwnerAddinSolutionId&&(fb=oa.OwnerAddinSolutionId);return fb};a.Jfd=function(oa){var fb=0;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?oa.RequestFlags&1&&256!==(oa.RequestFlags&256)||(fb=16):fb=oa.RequestFlags&1?0:16;return fb};a.Uua=function(oa,
fb){fb=a.getSolutionId(oa,fb);return a.dYe(fb,oa.PrimaryMarketplace.SolutionVersion,oa.PrimaryMarketplace.MarketplaceType,oa.PrimaryMarketplace.MarketplaceRef)};a.X8g=function(oa){var fb={};oa=(fb.recording=oa,fb);return JSON.stringify(oa)};a.q4g=function(oa){var fb={};fb.visibility=oa?"Visible":"Hidden";return JSON.stringify(fb)};a.kMh=function(oa){var fb=oa.getSolutionId(),Rb=oa.getVersion(),dc=oa.getStoreType();oa=oa.getStoreId();return a.dYe(fb,Rb,dc,oa)};a.dYe=function(oa,fb,Rb,dc){return String.format("{0}|{1}|{2}|{3}|{4}|||",
"2",oa,fb,a.dYh(Rb).toString(),dc)};a.Dhd=function(oa,fb){var Rb=oa.split("|");if(7>Rb.length)return lb.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Rb[0])return lb.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",Rb[0]),null;var dc=Rb[1],uc=Rb[2],Bd=a.eYh(Rb[3]),Od=Rb[4];Rb=Rb[5];dc&&dc.length||(dc=Rb);Rb={};Rb.InstanceId=String.format("{{{0}}}",wc.a.create().toString());
Rb.WebExtensionOsfControlType=4;Rb.WebExtensionType=1;Rb.PrimaryMarketplace={};Rb.PrimaryMarketplace.SolutionId=dc;Rb.PrimaryMarketplace.SolutionVersion=uc;Rb.PrimaryMarketplace.MarketplaceRef=Od;Rb.PrimaryMarketplace.MarketplaceType=Bd;Rb.ContainsCustomFunctions=fb?!0:!1;fb&&(Rb.OsfPropertyBag=[["customFunctionAddinId",oa]]);return Rb};a.eYh=function(oa){oa=parseInt(oa,10);return oa===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:oa===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:oa===OSF.StoreTypeEnum.SPApp?
OSF.StoreType.SPApp:oa===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:oa===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:oa===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:oa===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:oa===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:oa===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:oa===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:oa===OSF.StoreTypeEnum.WopiCatalog?
OSF.StoreType.WopiCatalog:null};a.dYh=function(oa){return oa===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:oa===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:oa===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:oa===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:oa===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:oa===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:oa===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:oa===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:
oa===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:oa===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:oa===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.Arb=function(oa){var fb={};fb.Version=oa.version;fb.AssetId=oa.assetId;fb.AssetStoreId=null!==oa.assetStoreId?oa.assetStoreId.toString():null;fb.StoreType=oa.storeType;fb.Height=oa.height;fb.SolutionId=oa.solutionId;fb.StoreId=oa.storeId;fb.TargetType=oa.targetType;fb.Width=1===fb.TargetType?0:oa.width;
fb.SharedRuntimeId=oa.sharedRuntimeId;return fb};a.Zyb=function(oa){return oa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||oa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||oa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||oa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||oa===OSF.DDA.EventDispId.dispidRichApiMessageEvent||oa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||oa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||oa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};
a.kPg=function(oa){return Object(kb.a)(new xd.a,{BLa:oa.infoType,id:oa.id,title:oa.title,description:oa.description,buttonText:oa.buttonTxt,vha:oa.buttonCallback,eec:oa.highPriority,mia:oa.dismissCallback,errorCode:oa.errorCode,Z8e:oa.iframeNotificationUrl})};a.aMa=function(oa){var fb="FA000000014"===oa;fb||(fb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===oa);return fb};a.sii=function(oa){return"FA000000005"===oa};Ek.Object.defineProperties(a.prototype,{b0b:{configurable:!0,enumerable:!0,get:function(){return this.Zea||
(this.Zea=new Ja.a(this.$.uw))}},Fi:{configurable:!0,enumerable:!0,get:function(){if(!this.Hn){var oa={},fb=!(this.$.Pd&1),Rb=hd.a.current.dO,dc=this.$.workbookContext,uc=Qb.a.vL+Qb.a.n3b,Bd=0;ib.EwaSettings.ma(492)&&(Bd|=2);oa.pageBaseUrl=Rb.LayoutsContentUrlPrefix;oa.appName=OSF.AppName.ExcelWebApp;oa.appVersion="16";oa.appSettings=this.fQh();oa.singleSignOnSettings=Tb.AppsForOfficeSingleSignOnManager.HXh();oa.clientMode=fb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;oa.appUILocale=this.$.ya.UICultureTag;
oa.dataLocale=this.$.ya.DataCultureTag;oa.docUrl=dc.ClientUrl;oa.hostControl=this;oa.formFactor=OSF.FormFactor.Default;oa.lcid=this.$.sG.toString();oa.localizedScriptsUrl=Qb.a.vL+Qb.a.W1c;oa.localizedImagesUrl=uc;oa.localizedStylesUrl=Qb.a.vL+Qb.a.EAe;oa.localizedResourcesUrl=uc;oa.osfOmexBaseUrl=Rb.OsfOmexBaseUrl;oa.firstPartyManifestCDNUrl=Rb.FirstPartyAddInManifestCDN;oa.sdxAssetsToPrefetchMapping=Ha.AFrameworkApplication.ga.Ua("SdxAssetsToPrefetchMapping");oa.sdxCdnUrl=Rb.SdxCdnUrl;oa.sdxDmsUrl=
Rb.SdxDmsUrl;oa.devCatalogUrl=Rb.DevCatalogUrl;oa.controlStatusChanged=this.Xnc;oa.notifyHost=this.Uzf;oa.allowExternalMarketplace=this.$.ea.Zg.get(27)&&a.G2c;oa.enableAddinCommands=ib.EwaSettings.ma(54);oa.enableBlackForestRedirect=ib.EwaSettings.ma(89);oa.enableMyOrg=this.$.ea.Zg.get(33);oa.enableMyApps=this.$.ea.Zg.get(34);oa.enableDevCatalog=ib.EwaSettings.ma(45);oa.enablePrivateCatalog=this.Ovj();oa.enableTaskpaneUpgradeToAppCommand=ib.EwaSettings.ma(94);oa.showSignOutFromPrivateCatalogMessage=
this.$.ea.Zg.get(36);oa.enableUploadFileDevCatalog=ib.EwaSettings.ma(54)&&!ib.EwaSettings.ma(283);oa.userNameHashCode=Sb.a.mw(Ha.AFrameworkApplication.userName);oa.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();oa.enableSingleSignOnForAddin=!ib.EwaSettings.ma(24)&&Ha.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;oa.enableDisplayBlockedMinorError=ib.EwaSettings.ma(184);oa.hideAppsExtensionUrl=Ha.AFrameworkApplication.hideAppsExtensionUrl;oa.enableAnonymousUseLegacyCatalogService=
ib.EwaSettings.ma(174);oa.enableInsertDialogAccessibilityFix=ib.EwaSettings.ma(181);oa.disableAppsForOfficeThirdParty=ib.EwaSettings.ma(187);oa.enableFirstPartySSO=ib.EwaSettings.ma(199);oa.wacSessionId=this.$.ya.UserSessionId;oa.disableLogging=!this.$.ya.AriaLoggingIsEnabled;oa.enableFirstPartySDXErrorMessages=ib.EwaSettings.ma(212);oa.enableRichApiCellEditDelay=ib.EwaSettings.ma(191);oa.isHostDocumentDomain=ib.EwaSettings.ma(227);oa.loggableUserId=Ha.AFrameworkApplication.ga.Ua("LoggableUserId");
oa.sessionStartInfoJson=Ha.AFrameworkApplication.ga.Ua("SessionStartInfoJson");oa.wopiHostOriginFromPostMessage=Ha.AFrameworkApplication.wopiHostOriginFromPostMessage;oa.wopiHostOriginFromWacPropBag=Ha.AFrameworkApplication.ga.Ua("PostMessageOrigin");oa.wacIsEmbedded=Ha.AFrameworkApplication.ga.ra("IsEmbedded");oa.accessibilityAllowFocusAddinTaskpane=Ha.AFrameworkApplication.ga.ra("AccessibilityAllowFocusAddinTaskpane");oa.enableRemoveAppCommandsAddin=Ha.AFrameworkApplication.ga.ra("RemoveAppCommandsAddinIsEnabled");
oa.isHostFrameTrustCheckEnabledForAddIns=Ha.AFrameworkApplication.ga.ra("HostFrameTrustCheckIsEnabledForAddIns");oa.isHostFrameTrusted=Ha.AFrameworkApplication.isHostFrameTrusted;oa.agaveAddinUploadEnabled=ib.EwaSettings.ma(47);oa.hostAllowedOfficeStore=Ha.AFrameworkApplication.ga.ra("HostAllowedOfficeStore");oa.hostAllowedSdxEmbedding=Ha.AFrameworkApplication.ga.ra("HostAllowedSdxEmbedding");oa.hostInstallAddIns=Ha.AFrameworkApplication.ga.Ua("HostInstallAddIns");oa.hostInstallAddInsIsEnabled=Ha.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled");
oa.approvedAddIns=Ha.AFrameworkApplication.ga.Ua("ApprovedAddIns");oa.addinEnforceHttpsIsEnabled=this.Yuj(oa.sessionStartInfoJson);oa.hostFeatureGateFlag=Bd;oa.isUpnCheckEnabled=Ha.AFrameworkApplication.ga.ra("IsUpnCheckEnabled");oa.wacUpn=Ha.AFrameworkApplication.ga.Ua("UserPrincipalName");oa.isReactRibbonEnabled=wa.a.isReactRibbonEnabled();oa.enableSetFocusOnTaskpaneOnUserAction=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);oa.isSafariWithIndexedDBDisabled=
ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&mb.a.QMa;oa.isIndexedDBDisabled=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&mb.a.QMa||ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&mb.a.Gf;oa.enableCustomShortcuts=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");oa.changeGetModifierKeyStringOutputOrder=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");
this.Hn=new OSF.ContextActivationManager(oa);oa={};this.Hn.setIframeAttributeBag((oa.frameborder=0,oa.marginheight=0,oa.marginwidth=0,oa));this.Hn.setWSA(Ha.AFrameworkApplication.Zm);this.Hn&&"undefined"!==typeof this.Hn.hostCheckReadyHandler&&Ha.AFrameworkApplication.ZEg(Object(Aa.a)(this.Hn,this.Hn.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var Od=yc.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Hn.setOAuthManager(Od)}catch(Td){}}return this.Hn}},gWj:{configurable:!0,enumerable:!0,
get:function(){return this.eTc}},ij:{configurable:!0,enumerable:!0,get:function(){return this.hfe}},$ma:{configurable:!0,enumerable:!0,get:function(){return this.efe}},TLd:{configurable:!0,enumerable:!0,get:function(){return this.ife}},SLd:{configurable:!0,enumerable:!0,get:function(){return this.gfe}},Chj:{configurable:!0,enumerable:!0,get:function(){return this.kfe}},Ahj:{configurable:!0,enumerable:!0,get:function(){return this.ffe}},Bhj:{configurable:!0,enumerable:!0,get:function(){return this.jfe}},
Dhj:{configurable:!0,enumerable:!0,get:function(){return this.lfe}},Ehj:{configurable:!0,enumerable:!0,get:function(){return this.mfe}},ULd:{configurable:!0,enumerable:!0,get:function(){return this.nfe}},UV:{configurable:!0,enumerable:!0,get:function(){return this.gqg}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Ek.Object.defineProperties(a,{G2c:{configurable:!0,enumerable:!0,get:function(){return a.d4d},set:function(oa){a.d4d=oa}}});a.Y0a=new tc.a;a.d4d=!0;Object(Gb.a)(a,
"DdaFacade",zb.a,[489,549,546,550,551,3])},949:function(x,C,b){function a(){this.jId=0;this.ZW={};this.ata={}}b.d(C,"a",function(){return a});x=b(0);var c=b(14),e=b(112);a.prototype.ATh=function(f,l){return this.ZW[a.WYc(f,l)]};a.prototype.SKe=function(f,l){l||void 0!==this.ata[f]&&null!==this.ata[f]?l&&void 0!==this.ata[f]&&null!==this.ata[f]&&delete this.ata[f]:this.ata[f]=1};a.prototype.U_b=function(f){return void 0===this.ata[f]||null===this.ata[f]};a.prototype.g2h=function(f){var l=a.WYc(f.messageType,
f.targetId);1===f.actionType?this.z3h(f.controlId,f.messageType,l):2===f.actionType&&this.i4h(f.controlId,f.messageType,l)};a.prototype.I9i=function(f){if(f){var l=Object.keys(this.ZW);if(!(void 0===l||null===l||0>=l.length)){l=El(l);for(var m=l.next();!m.done;m=l.next()){m=m.value;var r=this.ZW[m];r[f]&&(delete r[f],Object.keys(r).length||delete this.ZW[m])}}}};a.prototype.j_=function(f,l){f=a.WYc(f,l);f=this.ZW[f];return!!f&&0<Object.keys(f).length};a.prototype.Y4h=function(){return!e.a.isEmpty(this.ZW)};
a.prototype.Wgf=function(){return 0<this.jId};a.prototype.XNh=function(){var f=[],l=this.ZW,m;for(m in l){var r=m,h=l[m],w;for(w in h){h=w;var n={};n.eventType=parseInt(r.split("#")[0],10);n.targetId=r.split("#")[1];n.addinId=h;f.push(n)}}return f};a.prototype.z3h=function(f,l,m){if(this.ZW[m])m=this.ZW[m],m[f]=m[f]?m[f]+1:1;else{var r={};r[f]=1;this.ZW[m]=r}100===l&&this.jId++};a.prototype.i4h=function(f,l,m){if(this.ZW[m]){var r=this.ZW[m];if(f){var h=r[f];1===h?(delete r[f],Object.keys(r).length||
delete this.ZW[m]):r[f]=h-1;100===l&&this.jId--}else c.ULS.sendTraceTag(537170459,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",f,m)}else c.ULS.sendTraceTag(537170460,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",m)};a.WYc=function(f,l){return String.format("{0}#{1}",f,l)};a.lX="Workbook";Object(x.a)(a,"RichApiEventRegistration",null,[])},975:function(x,C,b){function a(c,e,f,l){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=
c;this.controlId=e;this.ddaBinding=f;this.ArrayData=void 0===l?null:l}b.d(C,"a",function(){return a});x=b(0);a.prototype.getDispid=function(){return this.dispid};a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(x.a)(a,"DdaEventArgs",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.agave.js.map/8fbc5d45c6456ddf86381e1bd134cbe3/EwaDS.agave.js.map