(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1047:function(x,C,b){function a(){}b.d(C,"a",function(){return a});x=b(0);var c=b(14),e=b(4),f=b(39),l=b(24);a.CWe=function(m,r){switch(m){case 3:return a.Q_h(r);case 2:return a.KTh(r);case 1:return a.YNh(r)}return""};a.Q_h=function(m){switch(m){case 1:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString()}return""};
a.KTh=function(m){switch(m){case 1:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString()}return""};a.YNh=function(m){switch(m){case 1:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};a.openInClient=function(m,r,h){if(l.a.Eh||l.a.np)window.setTimeout(function(){a.JMf(h,
a.Gcc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.bqe(h),m,0,!1)};a.yYg=function(m,r,h,w){r&&w&&w();a.openInClient(m,r,h)};a.Gcc=function(){return l.a.Eh?1:l.a.np?2:l.a.D7a?3:l.a.isMac?4:0};a.M_h=function(m){switch(m){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}};a.N_h=function(m){switch(m){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";
default:return""}};a.JMf=function(m,r){1===r?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),m=a.CWe(m,r),8<l.a.s5a?f.a.jf(m,void 0,void 0,"RedirectToAppStore"):f.a.tV(m)):document.hidden||(a.xzb?(m=e.AFrameworkApplication.ga.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),f.a.tV(m)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),
MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.CWe(m,r),null,null)))};a.bqe=function(m){switch(m){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};a.cdd=function(m){switch(m){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}};a.jpd=function(m){return(m=a.RQh(m))&&""!==m?Boolean.parse(m):!1};a.CPd=function(m){a.gqj(m)};a.RQh=function(m){try{return localStorage.getItem(m)}catch(r){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+r.message),null}};a.gqj=function(m){try{localStorage.setItem(m,"true")}catch(r){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+r.message)}};Ek.Object.defineProperties(a,{xzb:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},Dxc:{configurable:!0,enumerable:!0,get:function(){return(l.a.D7a||l.a.isMac)&&l.a.pp}},uxj:{configurable:!0,enumerable:!0,
get:function(){return l.a.Eh||l.a.np}}});a.aye="ChromeExtensionBarDismiss";Object(x.a)(a,"WildFireUtilities",null,[])},1155:function(x,C,b){function a(t,y){var E=this;this.od=function(){r.a.zg(w.a(E.$).ud.activityState,u.a.ezd)||E.xaa.reset()};this.$=y;this.Hkc=t;this.ea=y.ea;this.ea.hk(this.od);this.xaa=v.a.nse(this.$)}function c(t){var y=this;this.kj=this.LDc=null;this._state=0;this.moveNext=function(){try{for(y._state=1;1===y._state;)y.Qu=y.Qu()}catch(E){y.dispose(),y._state=3}};this.Cf=t;this.Qu=
this.ML;this.moveNext()}b.r(C);x=b(0);var e=b(14),f=b(36),l=b(212),m=b(119),r=b(35),h=b(1),w=b(66),n=b(55);c.prototype.ML=function(){this.LDc=this.Cf.$.Ob.Gc("LoadResource","DownloadACopyOperation");return this.d0d};c.prototype.d0d=function(){var t=b(1155).DownloadACopyOperation;if(this.Cf.xaa.Y8e||!(this.LDc.Bc<t.alc))return this.Ugg;this.kj=n.Task.delay(t.mJe).g();this.kj.isCompleted||(this._state=2,this.kj.NN(this.moveNext));return this.Rfb};c.prototype.Ugg=function(){var t=b(1155).DownloadACopyOperation;
this.LDc.Bc>=t.alc&&e.ULS.sendTraceTag(537154819,0,15,"Download did not complete after 10 seconds.");w.a(this.Cf.$).ud.IJ();this._state=3};c.prototype.Rfb=function(){this.kj.Az();return this.d0d};c.prototype.dispose=function(){};Object(x.a)(c,"$$sm_Microsoft$Office$Excel$WebUI$Client$OpenInClient$DownloadACopyOperation$IframeCompleteLoadOld",null,[3]);var v=b(1249),u=b(145);b.d(C,"DownloadACopyOperation",function(){return a});a.prototype.mhh=function(){var t=this,y=this.JRg(this.$),E=this.$.userOperationManager.operationCount;
0<E&&e.ULS.sendTraceTag(537154822,0,15,"flushing queue in downloadcopy. Queue is {0}",E);this.$.userOperationManager.r4("DownloadACopyOperation.DownloadForkedFile");this.Hkc&&e.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.xaa.downloadFile(y,-21742208);h.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?f.TaskExtensions.Ba(n.Task.delay(1),function(){t.X8e()},this.xaa.la,3):f.TaskExtensions.Ba(n.Task.delay(1),
function(){t.G7h()},this.xaa.la,3)};a.prototype.dispose=function(){this.ea&&this.ea.Dk(this.od);this.$=this.ea=null};a.prototype.X8e=function(t){var y=this;(t=void 0===t?null:t)||(t=this.$.Ob.Gc("LoadResource","DownloadACopyOperation"));!this.xaa.Y8e&&t.Bc<a.alc?window.setTimeout(function(){y.X8e(t)},a.mJe):(t.Bc>=a.alc&&e.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),w.a(this.$).ud.IJ())};a.prototype.G7h=function(){new c(this)};a.prototype.JRg=function(t){var y=new Sys.StringBuilder,
E=t.workbookContext,B=t.ya;y.append(t.Lda);y.append(B.FileHandlerRelativeUri);y.append("?id=");y.append(encodeURIComponent(l.a.THb(E.WorkbookUri,"sc")));t.ea.sc&&(y.append("&sessionId="),y.append(encodeURIComponent(t.ea.sessionId)));y.append("&workbookType=FullForkedWorkbook");y.append("&dataloss=");y.append(this.Hkc?"true":"false");m.a.hZa(y,B);return y.toString()};a.alc=1E5;a.mJe=100;Object(x.a)(a,"DownloadACopyOperation",null,[3])},1241:function(x,C,b){function a(m,r){m=l.call(this,m,r)||this;
c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");m.title="";m.message=a.Jxa;m.Ova=!0;return m}b.d(C,"a",function(){return a});x=b(0);var c=b(14),e=b(39),f=b(80);b=b(919);var l=b.a;Am(a,l);a.prototype.ama=function(m){l.prototype.ama.call(this,m);e.a.openWindow(4,f.a.zH(a.Nnf))};a.prototype.eD=function(m){l.prototype.eD.call(this,m);a.jvd&&a.jvd(null)};a.initialize=function(m,r,h,w){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");
a.Jxa=m;a.Onf=r;a.Nnf=h;a.jvd=w};Ek.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.Onf}}});a.Jxa=null;a.Onf=null;a.Nnf=null;a.jvd=null;Object(x.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1242:function(x,C,b){function a(){}b.d(C,"a",function(){return a});x=b(0);a.fmh="ewa-bb";a.hmh="ewa-bb-entry";a.imh="ewa-bb-entry-body";a.omh="ewa-bb-icon";a.kmh="ewa-bb-entry-icon";a.nmh="ewa-bb-entry-title";a.mmh="ewa-bb-entry-message";a.wMe="ewa-bb-entry-button";
a.lmh="ewa-bb-entry-link";a.jmh="ewa-bb-entry-close";a.xMe="ewa-bb-entry-button-holder";a.gmh="ewa-bb-content";Object(x.a)(a,"CssClassNames",null,[])},1243:function(x,C,b){function a(e,f){e=c.call(this,e,f)||this;e.pv=!0;e.title=a.bpa;e.message=a.Zoa;return e}b.d(C,"a",function(){return a});x=b(0);b=b(919);var c=b.a;Am(a,c);a.prototype.Fo=function(e){c.prototype.Fo.call(this,e);(e=a.$oa)&&e(null)};a.initialize=function(e,f,l,m){a.bpa=e;a.Zoa=f;a.Yoa=l;a.$oa=m};Ek.Object.defineProperties(a.prototype,
{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Yoa}}});a.bpa=null;a.Zoa=null;a.Yoa=null;a.$oa=null;Object(x.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",b.a,[])},1244:function(x,C,b){function a(e,f){e=c.call(this,e,f)||this;e.pv=!0;e.title=a.bpa;e.message=a.Zoa;return e}b.d(C,"a",function(){return a});x=b(0);b=b(919);var c=b.a;Am(a,c);a.prototype.Fo=function(e){c.prototype.Fo.call(this,e);(e=a.$oa)&&e(null)};a.initialize=function(e,f,l,m){a.bpa=e;a.Zoa=f;a.Yoa=l;a.$oa=m};
Ek.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Yoa}}});a.bpa=null;a.Zoa=null;a.Yoa=null;a.$oa=null;Object(x.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",b.a,[])},1245:function(x,C,b){function a(e,f){e=c.call(this,e,f)||this;e.pv=!0;e.title=a.bpa;e.message=a.Zoa;return e}b.d(C,"a",function(){return a});x=b(0);b=b(919);var c=b.a;Am(a,c);a.prototype.Fo=function(e){c.prototype.Fo.call(this,e);(e=a.$oa)&&e(null)};a.initialize=function(e,
f,l,m){a.bpa=e;a.Zoa=f;a.Yoa=l;a.$oa=m};Ek.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Yoa}}});a.bpa=null;a.Zoa=null;a.Yoa=null;a.$oa=null;Object(x.a)(a,"MandatorySensitivityLabelBusinessBarEntry",b.a,[])},1246:function(x,C,b){function a(e,f){e=c.call(this,e,f)||this;e.pv=!0;e.title=a.qCb;e.message=a.Jxa;return e}b.d(C,"a",function(){return a});x=b(0);b=b(919);var c=b.a;Am(a,c);a.prototype.Fo=function(e){c.prototype.Fo.call(this,e);a.Lxa&&
a.Lxa(null)};a.initialize=function(e,f,l,m){a.qCb=e;a.Jxa=f;a.u8a=l;a.Lxa=m};Ek.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.u8a}}});a.qCb=null;a.Jxa=null;a.u8a=null;a.Lxa=null;Object(x.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",b.a,[])},1247:function(x,C,b){function a(e,f){e=c.call(this,e,f)||this;a.u8a&&a.Lxa&&(e.pv=!0);e.title=a.qCb;e.message=a.Jxa;return e}b.d(C,"a",function(){return a});x=b(0);b=b(919);var c=b.a;
Am(a,c);a.prototype.Fo=function(e){c.prototype.Fo.call(this,e);a.Lxa&&a.Lxa(null)};a.initialize=function(e,f,l,m){a.qCb=e;a.Jxa=f;a.u8a=l;a.Lxa=m};Ek.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.u8a}}});a.qCb=null;a.Jxa=null;a.u8a=null;a.Lxa=null;Object(x.a)(a,"SensitivityApplicationSetLabelErrorBusinessBarEntry",b.a,[])},1248:function(x,C,b){function a(m,r,h,w,n,v){this.oY=m;this.pY=r;this.fKc=h;this.UD=w;this.ZRb=n;this.RUa=v}b.d(C,"a",
function(){return a});x=b(0);var c=b(1303),e=b(4),f=b(52),l=b(85);a.prototype.A4i=function(m){this.Vsf(m)};a.prototype.pri=function(m){this.Vsf(m)};a.prototype.Vsf=function(m){var r=10;1===m?(l.a.instance.resolve("Common.IOfficeTrialExperience").Gjc(this.RUa),r=3):2===m&&((!this.fKc||this.fKc(this.UD))&&this.pY&&c.a.instance.Q7g(this.pY,this.oY,this.UD),r=5);(0===m||1===m)&&this.oY&&this.oY(this.UD);e.AFrameworkApplication.ytc(f.a.tEf,this.ZRb,r);this.dispose()};a.prototype.dispose=function(){this.UD=
this.pY=this.oY=null};Ek.Object.defineProperties(a.prototype,{d3f:{configurable:!0,enumerable:!0,get:function(){return!this.pY&&!this.fKc}},zsf:{configurable:!0,enumerable:!0,get:function(){return 2===this.RUa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},$Le:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},K8e:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},Sva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},v7e:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},eYb:{configurable:!0,enumerable:!0,get:function(){return 2===this.RUa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}},Hm:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(x.a)(a,"AOICErrorDialogWithTrial",null,[3])},1249:function(x,C,b){function a(v,u){var t=n.call(this,v)||this;t.vTj=["id","sessionId","workbookType","workbookFileType","dataloss"];t.command=0;t.rEb=function(){var y=t.WNh();if(y){t.$.sI(!0);if(-2028960985!==t.command&&1461300262!==t.command){var E=h.a(t.$).ud.activityState;E[r.a.tYa]=m.a.download;E[w.a.YTc]=t.command}l.a(t.$).Bs(y.Errors)}};t.iframe=v;t.$=u;t.Jc.ka("load",t.rEb);return t}b.d(C,"a",function(){return a});x=b(0);var c=b(14),e=b(39);
C=b(242);var f=b(212),l=b(43),m=b(6),r=b(34),h=b(66),w=b(652),n=C.a;Am(a,n);a.prototype.downloadFile=function(v,u){var t={};(v=this.gyh(v,t))&&e.a.lqc("dlfr",v,t);this.command=u};a.prototype.gyh=function(v,u){var t=v.split("?");if(2!==t.length)return v=null,c.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),v;t=t[1].split("&");t=El(t);for(var y=t.next();!y.done;y=t.next()){var E=y.value.split("=",2);if(2!==E.length){v=null;c.ULS.sendTraceTag(537154787,
0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}y=E[0];Array.contains(this.vTj,y)&&(E=decodeURIComponent(E[1]),u[y]=E,v=f.a.THb(v,y))}return v};a.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};a.prototype.WNh=function(){try{return this.iframe.contentWindow.ewaResult}catch(u){if(!this.$.ea.xc.isDivSyndicated){var v=window.document.referrer.match(RegExp("://(.[^/]+)/"));c.ULS.sendTraceTag(537154785,
0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<v.length?v[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.zwa);throw u;}return null}};a.nse=function(v){var u=document.createElement("iframe");u.id="ewaFileLoader";u.style.cssText="height:0;width:0;display:none";u.src="about:blank";u.setAttribute("name","dlfr");u=v.domElement.appendChild(u);return new a(u,v)};Ek.Object.defineProperties(a.prototype,
{Y8e:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(x.a)(a,"FileLoader",C.a,[])},1250:function(x,C,b){function a(){this.BaseDocQuerySignature=null;this.RoamingApp=0}b.d(C,"a",function(){return a});x=b(0);var c=b(1403),e=b(4),f=b(41),l=b(80);a.prototype.TNd=function(){return f.c([this.Laa(),this])};a.prototype.execute=function(m,r,h){var w="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&
0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(w=l.a.Dl(w,"wdEnableRoaming","1"));e.AFrameworkApplication.Jd.El(w,2,this.TNd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.j4a(),m,r,h,void 0,void 0,void 0,void 0,"6")};Object(x.a)(a,"ARoamingAppsRequest",null,[])},1255:function(x,C,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=this.logger=this.printPreviewPaneCallbacks=
this.backActionButtonText=null}b.d(C,"a",function(){return a});x=b(0);Object(x.a)(a,"PrintPreviewPaneProps",null,[])},1256:function(x,C,b){function a(){}b.d(C,"a",function(){return a});x=b(0);a.Y_i="PrintDialogBody";a.printDialogTitle="PrintDialogTitle";a.u8b="ewa-dlg-elements-container-rtl";a.Z_i="PrintDialogLeftContainer";a.$_i="PrintDialogRightContainer";a.jab="PrintDialogRadioButtonContainer";a.uIf="PrintRadioButtonElementInnerDiv";a.f0i="PrintRadioButtonElementOuterDiv";a.kab="PrintDialogTitleSection";
a.mFd="PrintDialogComboBoxContainer";a.g0i="PrintRadioButtonIcon";a.X_i="PrintButtonArea";a.Zw="PrintPreviewerContainer";Object(x.a)(a,"CssClassNames",null,[])},1295:function(x,C,b){function a(zb,hc){var Uc=Gc.call(this,hc)||this;Uc.hDh=D.DOMElementExtensions.sr+",div";Uc.QU=Array(66);Uc.Am=!1;Uc.wW=function(jb){if(jb.Ca.keyCode===P.a.MD){var $a=Uc.uc.querySelectorAll(Uc.hDh),I=D.DOMElementExtensions.Km($a);$a=D.DOMElementExtensions.nB($a);return D.DOMElementExtensions.una(jb.Ca,I,$a)}return!1};Uc.wb=
zb;Uc.set_visible(!1);Uc.addCssClass(R.a.fmh);L.KeyInputManager.instance.pa(ca.a.Yb,Uc.uc,Uc.wW);W.a(zb).$h(Uc);return Uc}function c(zb,hc,Uc,jb,$a,I){var ba=M.call(this,zb,hc,Uc)||this;wb.a.instance.create(function(){if(ba.businessBar&&ba.businessBar.mMa(hc.FGa)){var sa=new xa.a(-847286761,0,ba.businessBar.$.ed,0,null),Oa={};Oa=(Oa.CalloutName=jb,Oa.Target=Wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?ba.domElement.getElementsByClassName("ms-Button")[0]:ba.gT.domElement,
Oa);ba.businessBar.$.Ka.Xb(sa,Oa)}},$a,I,!0,!0);return ba}function e(zb,hc,Uc,jb){zb=ic.call(this,zb,hc)||this;zb.automateCommandManager=Uc.da.Aa(352);Q.ULS.shipAssertTag(526787654,0,!!zb.automateCommandManager);zb.id=yc.a.create();zb.$=Uc;zb.title=Ca.a.instance.fa(2226);zb.message="";zb.WTd=Ca.a.instance.fa(2222);zb.zVj=Ca.a.instance.fa(2223);zb.mfg=Ca.a.instance.fa(2224);zb.v1g=Ca.a.instance.fa(2225);zb.update(jb);return zb}function f(zb,hc){zb=pb.call(this,zb,hc)||this;zb.eCa=Tb.a.Z4b();zb.pv=
!0;zb.VZ=zb.eCa.FTj;zb.title=zb.eCa.title;zb.message=zb.eCa.message;return zb}function l(zb,hc){zb=wc.call(this,zb,hc)||this;zb.pv=!0;zb.title="";return zb}function m(zb,hc){hc=mb.call(this,zb,hc)||this;hc.policyManager=zb.$.da.Aa(274);if(!hc.policyManager)return Q.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),hc;hc.message=hc.policyManager.aqc;hc.title=hc.policyManager.title;hc.Ova=!0;return hc}function r(zb,hc){zb=Ha.call(this,
zb,hc)||this;zb.pv=!0;zb.VZ=!0;return zb}function h(zb,hc,Uc,jb){zb=Xa.call(this,zb,hc)||this;zb.oxb=Uc;zb.command=jb;zb.Ova=!0;zb.pv=1461300262!==jb;return zb}function w(zb,hc,Uc){zb=Aa.call(this,zb,hc)||this;zb.oxb=Uc;zb.Ova=!0;return zb}function n(zb,hc,Uc){zb=Nb.call(this,zb,hc)||this;zb.oxb=Uc;zb.pv=!0;return zb}function v(zb,hc){zb=kb.call(this,zb,hc)||this;zb.pv=!0;zb.VZ=!1;return zb}function u(zb,hc){zb=Gb.call(this,zb,hc)||this;zb.pv=!0;zb.VZ=!0;return zb}function t(zb,hc,Uc,jb,$a,I,ba,sa){return y.call(this,
zb,0,hc,Uc,jb,$a,I,ba,sa)||this}function y(zb,hc,Uc,jb,$a,I,ba,sa,Oa){this.lJ=this.v8=this.gT=0;this.rlg=zb;this.rJj=hc;this.zP=Uc;this.Kpg=ba;this.Uib=F.a.mw(Oa);this.Ing=Oa;this.wlg=sa;0!==jb&&(this.gT=jb);0!==$a&&(this.v8=$a);0!==I&&(this.lJ=I)}function E(zb,hc,Uc,jb,$a){zb=B.call(this,zb,hc,Uc,jb)||this;zb.command=$a;zb.VZ=!0;return zb}function B(zb,hc,Uc,jb){zb=fa.call(this,zb,hc)||this;zb.error=Uc;zb.options=jb;zb.error&&zb.options&2&&(zb.message=zb.error.Description);zb.error&&zb.options&1&&
(zb.title=zb.error.Caption);zb.pv=!(jb&4);return zb}function z(zb,hc,Uc){return M.call(this,zb,hc,Uc)||this}function M(zb,hc,Uc){zb=va.call(this,zb,hc)||this;zb.pv=!0;zb.command=Uc;return zb}b.r(C);x=b(0);var Q=b(14),P=b(86),L=b(109),ca=b(13),U=b(90),aa=b(52),F=b(29),D=b(12),J=b(242),R=b(1242),Z=b(5),W=b(271),ka=b(1243),ma=b(919),pa=b(1321),xa=b(95),va=ma.a;Am(M,va);M.prototype.Fo=function(zb){va.prototype.Fo.call(this,zb);this.businessBar.$.Ka.Xb(new xa.a(this.command,zb,this.businessBar.$.ed,10,
null))};Object(x.a)(M,"CommandActionBusinessBarEntry",ma.a,[]);Am(z,M);z.prototype.eD=function(zb){M.prototype.eD.call(this,zb)};Object(x.a)(z,"EditAttemptReadOnlyBusinessBarEntry",M,[]);var ta=b(43),fa=ma.a;Am(B,fa);B.prototype.Fo=function(zb){fa.prototype.Fo.call(this,zb);this.error.Appearance&=-33;ta.a(this.businessBar.$).Bs([this.error])};Object(x.a)(B,"ErrorBusinessBarEntry",ma.a,[]);Am(E,B);E.prototype.W_=function(zb){B.prototype.W_.call(this,zb);this.businessBar.$.Ka.Xb(new xa.a(this.command,
zb,this.businessBar.$.ed,10,null))};Object(x.a)(E,"ErrorAndCommandBusinessBarEntry",B,[]);var Ca=b(15);y.fa=function(zb){return Ca.a.instance.fa(zb)};Ek.Object.defineProperties(y.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return y.fa(this.rJj)}},message:{configurable:!0,enumerable:!0,get:function(){return y.fa(this.zP)}},messageId:{configurable:!0,enumerable:!0,get:function(){return this.zP}},FGa:{configurable:!0,enumerable:!0,get:function(){return this.rlg}},actionButton:{configurable:!0,
enumerable:!0,get:function(){return y.fa(this.gT)}},gGa:{configurable:!0,enumerable:!0,get:function(){return y.fa(this.v8)}},link:{configurable:!0,enumerable:!0,get:function(){return y.fa(this.lJ)}},Qk:{configurable:!0,enumerable:!0,get:function(){return this.Kpg}},SRg:{configurable:!0,enumerable:!0,get:function(){return this.wlg}},hash:{configurable:!0,enumerable:!0,get:function(){return this.Uib}},alt:{configurable:!0,enumerable:!0,get:function(){var zb=b(1295).BusinessBarControl;switch(this.Qk){case zb.zia:return y.fa(26);
case zb.UB:return y.fa(25);case zb.tj:return y.fa(24);default:return y.fa(0)}}},J8c:{configurable:!0,enumerable:!0,get:function(){return this.Ing}}});Object(x.a)(y,"EwaBusinessBarEntry",null,[]);Am(t,y);Ek.Object.defineProperties(t.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(x.a)(t,"EwaNoTitleBusinessBarEntry",y,[]);var Sa=b(72),Gb=ma.a;Am(u,Gb);u.prototype.Fo=function(zb){Gb.prototype.Fo.call(this,zb);this.set_visible(!1);this.businessBar.$.gL();this.businessBar.$.Ka.Xb(new xa.a(1038998010,
zb,this.businessBar.$.ed,10,null))};u.prototype.W_=function(zb){Gb.prototype.W_.call(this,zb);this.businessBar.$.Ka.Xb(new xa.a(-722953877,zb,this.businessBar.$.ed,10,null))};u.prototype.eD=function(zb){this.businessBar.removeEntry(53);Sa.g(zb)};Object(x.a)(u,"ExternalLinksEnableContentBusinessBarEntry",ma.a,[]);var kb=ma.a;Am(v,kb);v.prototype.Fo=function(zb){kb.prototype.Fo.call(this,zb);this.businessBar.$.Ka.Xb(new xa.a(-722953877,zb,this.businessBar.$.ed,10,null))};v.prototype.eD=function(zb){this.businessBar.removeEntry(5);
Sa.g(zb)};Object(x.a)(v,"ExternalLinksShowErrorBusinessBarEntry",ma.a,[]);var lb=b(10),Nb=ma.a;Am(n,Nb);n.prototype.Fo=function(zb){Nb.prototype.Fo.call(this,zb);lb.HelperMethods.E6(this.businessBar.$.sG,this.oxb,this.businessBar.$.YS)};Object(x.a)(n,"HelpButtonBusinessBarEntry",ma.a,[]);var Aa=ma.a;Am(w,Aa);w.prototype.ama=function(zb){Aa.prototype.ama.call(this,zb);lb.HelperMethods.E6(this.businessBar.$.sG,this.oxb,this.businessBar.$.YS)};Object(x.a)(w,"HelpTextBusinessBarEntry",ma.a,[]);var qa=
b(79),Xa=ma.a;Am(h,Xa);h.prototype.Fo=function(zb){Xa.prototype.Fo.call(this,zb);this.businessBar.$.Ka.Xb(new xa.a(this.command,zb,this.businessBar.$.ed,10,null))};h.prototype.ama=function(zb){Xa.prototype.ama.call(this,zb);var hc=new xa.a(-859308420,zb,this.businessBar.$.ed,12,null),Uc={};zb=(Uc[qa.a.Cg]="HelpID="+this.oxb,Uc.InputMethod=zb,Uc[qa.a.ld]=Z.a.NV,Uc[Z.a.ioa]=!0,Uc);this.businessBar.$.Ka.Xb(hc,zb)};Object(x.a)(h,"HelpTextTaskPaneAndCommandBusinessBarEntry",ma.a,[]);var Ha=ma.a;Am(r,Ha);
r.prototype.Fo=function(zb){Ha.prototype.Fo.call(this,zb);this.set_visible(!1);this.businessBar.$.gL();this.businessBar.$.Ka.Xb(new xa.a(-1081442996,zb,this.businessBar.$.ed,10,null))};r.prototype.W_=function(zb){Ha.prototype.W_.call(this,zb);this.businessBar.$.Ka.Xb(new xa.a(1702917262,zb,this.businessBar.$.ed,10,null))};r.prototype.eD=function(zb){this.businessBar.removeEntry(57);Sa.g(zb)};Object(x.a)(r,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",ma.a,[]);var Ra=b(1245),mb=ma.a;Am(m,mb);
m.prototype.ama=function(zb){mb.prototype.ama.call(this,zb);(zb=this.policyManager.vNi)&&zb(null)};Ek.Object.defineProperties(m.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(x.a)(m,"PolicyBusinessBarEntry",ma.a,[]);var La=b(1244),ha=b(1247),Ia=b(1246);b(440);var gb=b(187),Sb=b(27),wc=ma.a;Am(l,wc);l.prototype.Fo=function(zb){wc.prototype.Fo.call(this,zb);gb.c(Sb.a.lCi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ",
"_blank")};Object(x.a)(l,"UnsupportedBrowserBusinessBarEntry",ma.a,[]);var tc=b(1241),Tb=b(1336),pb=ma.a;Am(f,pb);f.prototype.Fo=function(zb){pb.prototype.Fo.call(this,zb);this.eCa.cuf(null)};f.prototype.W_=function(zb){pb.prototype.W_.call(this,zb);this.eCa.fuf(null)};f.prototype.eD=function(zb){pb.prototype.eD.call(this,zb);this.eCa.fIe(null)};Ek.Object.defineProperties(f.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.eCa.Uue}},gGa:{configurable:!0,enumerable:!0,
get:function(){return this.eCa.Wue}}});Object(x.a)(f,"WildFireMobileAppBusinessBarEntry",ma.a,[]);var cb=b(254),ob=b(21),rc=b(223),Db=b(177),Ja=b(45),Qb=b(7),yc=b(176),Cd=b(1166),bc=b(77),Kb=b(131),ic=ma.a;Am(e,ic);e.prototype.update=function(zb){this.scriptLink=zb.scriptLink;this.runStatus=zb.runStatus;this.buttonText=zb.buttonText||"";this.lti(zb.clickId);this.ifj();"preparing"===this.runStatus?(this.message=String.format(Ca.a.instance.Ab(199),this.buttonText),this.pv=!0,this.iYa=this.WTd,this.rqb=
this.rFa=this.c$a):"running"===this.runStatus?(this.message=String.format(Ca.a.instance.Ab(198),this.buttonText),this.pv=!0,this.iYa=this.WTd,this.rqb=this.rFa=this.c$a):"succeeded"===this.runStatus?(this.message=String.format(Ca.a.instance.Ab(201),this.buttonText),this.pv=!0,this.iYa=this.mfg,this.rFa=this.MDf,this.VZ=!0,this.oWc=this.zVj,this.pWc=this.tTi):"runFailed"===this.runStatus?(this.message=String.format(Ca.a.instance.Ab(200),this.buttonText),this.t5a=a.zia,this.pv=!0,this.iYa=this.mfg,
this.rFa=this.MDf,"false"===zb.isOwner&&(this.VZ=!0,this.oWc=this.v1g,this.pWc=this.IHi)):"fetchFailed"===this.runStatus?(this.t5a=a.zia,this.message=String.format(Ca.a.instance.Ab(202),this.buttonText)):"canceled"===this.runStatus?(this.t5a=a.UB,this.message=String.format(Ca.a.instance.Ab(204),this.buttonText)):"alreadyRunning"===this.runStatus?(this.t5a=a.UB,this.message=String.format(Ca.a.instance.Ab(203),this.buttonText),this.pv=!0,this.iYa=this.WTd,this.rqb=this.rFa=this.c$a):"initializing"===
this.runStatus&&(this.t5a=a.tj,this.message=Ca.a.instance.fa(2227))};e.prototype.Fo=function(zb){ic.prototype.Fo.call(this,zb);this.rFa&&this.rFa()};e.prototype.W_=function(zb){ic.prototype.W_.call(this,zb);this.gGa&&this.pWc()};e.prototype.eD=function(zb){ic.prototype.eD.call(this,zb);this.rqb&&this.rqb()};e.prototype.ifj=function(){this.message="";this.t5a=a.tj;this.pv=!1;this.iYa="";this.rFa=void 0;this.VZ=!1;this.oWc="";this.pWc=void 0;this.i5a=!1;this.rqb=void 0};e.prototype.c$a=function(){var zb=
yc.a.create().toString();this.automateCommandManager.G1h(zb);this.fkc(-2186799,zb)};e.prototype.MDf=function(){var zb=yc.a.create().toString();this.automateCommandManager.F1h(zb);this.fkc(1036446140,zb)};e.prototype.tTi=function(){var zb=yc.a.create();if(this.scriptLink){var hc=new Cd.b(this.scriptLink);this.automateCommandManager.S5e(this.id.toString(),JSON.stringify(hc),zb)}this.fkc(-585097204,zb.toString())};e.prototype.IHi=function(){var zb=yc.a.create().toString();this.automateCommandManager.E1h(zb);
this.fkc(-639858579,zb)};e.prototype.lti=function(zb){var hc=[];hc.push(Object(Qb.a)(new bc.a,{name:"id",string:this.id.toString()}));hc.push(Object(Qb.a)(new bc.a,{name:"hasScriptLink",bool:!!this.scriptLink}));hc.push(Object(Qb.a)(new bc.a,{name:"runStatus",string:this.runStatus}));hc.push(Object(Qb.a)(new bc.a,{name:"clickId",string:zb}));hc.push(Object(Qb.a)(new bc.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));gb.a(Kb.a.IEi,void 0,void 0,hc)};e.prototype.fkc=function(zb,
hc){var Uc=[];Uc.push(Object(Qb.a)(new bc.a,{name:"id",string:this.id.toString()}));Uc.push(Object(Qb.a)(new bc.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Uc.push(Object(Qb.a)(new bc.a,{name:"runStatus",string:this.runStatus}));Uc.push(Object(Qb.a)(new bc.a,{name:"clickId",string:hc}));gb.d(zb,void 0,void 0,void 0,void 0,void 0,Uc)};Ek.Object.defineProperties(e.prototype,{Qk:{configurable:!0,enumerable:!0,get:function(){return this.t5a}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.iYa}},
gGa:{configurable:!0,enumerable:!0,get:function(){return this.oWc}}});Object(x.a)(e,"OfficeScriptsRunStatusBusinessBarEntry",ma.a,[]);var wb=b(47),Wa=b(1);Am(c,M);Object(x.a)(c,"CalloutBusinessBarEntry",M,[]);var Xb=b(19);b.d(C,"BusinessBarControl",function(){return a});var Gc=J.a;Am(a,Gc);a.prototype.Wf=function(zb,hc){hc||D.DOMElementExtensions.setFocus(this.domElement.firstChild);return!hc};a.prototype.ph=function(zb){return D.DOMElementExtensions.Ff(this.uc,zb)};a.prototype.Cj=function(){};a.prototype.Rj=
function(){};a.prototype.dispose=function(){this.Am||(L.KeyInputManager.instance.za(ca.a.Yb,this.uc,this.wW),U.a.zc(this.QU),this.QU=Array(66),this.wb=null,Gc.prototype.dispose.call(this),this.Am=!0)};a.prototype.mMa=function(zb){if(!this.get_visible())return!1;zb=this.QU[zb];return!!zb&&zb.isVisible};a.prototype.sC=function(zb){return!!this.QU[zb]};a.prototype.hOb=function(zb,hc){if(zb=this.QU[zb])zb.update(hc),zb.FPj()};a.prototype.lE=function(zb,hc,Uc,jb){Uc=void 0===Uc?null:Uc;jb=void 0===jb?
null:jb;var $a=!1;if(this.sC(zb))Uc=this.QU[zb].get_visible();else{this.set_visible(!0);var I=a.Q3e()[zb];this.QU[zb]=this.P$(zb,hc,Uc,jb);Uc=!1;$a=!0;jb="";var ba=0;hc&&(jb=hc.MessageIdName,ba=hc.MessageId);var sa=I.J8c;Q.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",zb,Ja.PageLoadTrackingInfo.instance.Bja(new Date));if(Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")){var Oa=this.QU.filter(function(qb){return null!=
qb}).length;1<Oa&&Q.ULS.sendTraceTag(525349006,0,50,"Total BizBars: {0}",Oa.toString())}Db.a(this.$).lKd(I.hash,jb,ba,aa.a.dBc,!0,1,hc,sa)}Uc||!Array.contains(pa.a.Icc(),zb)&&!$a||(this.QU[zb].set_visible(!0),this.$.gL())};a.prototype.removeEntry=function(zb){return this.F9i(zb)};a.prototype.oId=function(){U.a.zc(this.QU);this.QU=Array(66);this.set_visible(!1)};a.prototype.F9i=function(zb){if(!this.sC(zb))return!1;U.a.Ha(this.QU[zb]);this.QU[zb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);
this.$.gL();return!0};a.prototype.P$=function(zb,hc,Uc,jb){Uc=void 0===Uc?null:Uc;jb=void 0===jb?null:jb;var $a=a.Q3e()[zb],I=!!(this.$.Pd&64);switch(zb){case 2:case 4:case 23:case 25:case 26:case 35:case 34:zb=new ma.a(this,$a);break;case 12:case 29:case 30:case 31:case 32:case 55:zb=I?new M(this,$a,-8805455):new ma.a(this,$a);break;case 22:zb=new z(this,$a,-8805455);break;case 44:case 43:zb=I?new E(this,$a,hc,0,-8805455):new B(this,$a,hc,0);break;case 11:case 41:case 7:case 0:case 1:case 3:case 33:zb=
new B(this,$a,hc,0);break;case 19:zb=new ma.a(this,$a);break;case 45:zb=new B(this,$a,hc,0);break;case 6:case 14:zb=new n(this,$a,hc.HelpTopicId);break;case 64:zb=new w(this,$a,hc.HelpTopicId);break;case 36:zb=new w(this,$a,Z.a.Zah);break;case 16:zb=new ma.a(this,$a);zb.title=F.a.Sf(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);zb.message=F.a.Sf(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:zb=new M(this,$a,-1762562205);zb.i5a=!0;break;case 20:zb=new f(this,
$a);break;case 21:case 54:zb=new ma.a(this,$a);break;case 28:zb=new ma.a(this,$a);break;case 24:zb=new l(this,$a);break;case 27:zb=new m(this,$a);break;case 37:zb=new tc.a(this,$a);break;case 38:zb=new ka.a(this,$a);break;case 39:zb=new La.a(this,$a);break;case 40:zb=new Ra.a(this,$a);break;case 46:zb=new ma.a(this,$a);break;case 47:zb=new ma.a(this,$a);break;case 48:zb=new ma.a(this,$a);break;case 49:zb=new ma.a(this,$a);break;case 50:zb=new ma.a(this,$a);break;case 51:zb=new Ia.a(this,$a);break;
case 52:zb=new ha.a(this,$a);break;case 53:zb=new u(this,$a);break;case 5:zb=new v(this,$a);break;case 56:zb=new M(this,$a,-1753056834);hc?(hc=hc.Directive,ob.a.Rn(hc)||"&nbsp;"===hc||(zb.message=hc)):Uc&&(zb.message=Uc);break;case 57:zb=new r(this,$a);break;case 58:zb=new ma.a(this,$a);break;case 59:case 62:zb=new w(this,$a,Z.a.PDi);break;case 60:zb=new h(this,$a,Z.a.gNg,-8805455);break;case 65:zb=new h(this,$a,Z.a.e5i,1461300262);break;case 61:zb=Wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",
!1)?new c(this,$a,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new M(this,$a,515196233);break;case 63:zb=new e(this,$a,this.$,jb);break;default:zb=new B(this,$a,hc,7)}zb.n3c();return zb};a.Q3e=function(){var zb=rc.a.u6a()?262:261;return a.Kue||(a.Kue=[new y(0,277,278,279,0,0,a.zia,1,"BB_UnableToRefreshLock"),new y(1,277,278,279,0,0,a.zia,1,"BB_UnableToRefreshLockExpected"),new y(2,269,270,0,0,0,a.UB,5,"BB_WorkbookAlmostTooLarge"),new y(3,271,272,273,0,0,a.zia,1,"BB_WorkbookTooLarge"),
new y(4,260,zb,0,0,0,a.UB,5,"BB_ExternalWorkbookLinksDisabled"),new y(5,264,263,265,0,0,a.zia,1,"BB_ExternalWorkbookLinksShowError"),new y(6,266,267,268,0,0,a.tj,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new y(7,252,253,254,0,0,a.tj,0,"BB_UnsupportedFeatures"),new y(8,0,0,0,0,0,a.tj,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new y(9,0,0,0,0,0,a.tj,0,"BB_CollabDataStringsLocaleMismatch"),new y(10,0,0,0,0,0,a.tj,0,"BB_CollabDataLocaleMismatch"),new y(11,280,281,282,0,0,a.zia,1,"BB_LastGenericStatusError"),
new y(12,283,284,285,0,0,a.UB,5,"BB_ScratchPadWarning"),new y(13,286,287,288,0,0,a.zia,1,"BB_AuthenticationLost"),new y(14,289,290,291,0,0,a.UB,5,"BB_OdfCompatibilityIssues"),new y(15,0,577,0,0,0,a.UB,5,"BB_PivotChartInteractivityMissingWarning"),new y(16,0,0,0,0,0,a.tj,0,"BB_WorkbookIsIrmProtected"),new y(17,0,0,0,0,0,a.tj,0,"BB_BIFeatureNotAvailable"),new y(18,292,293,288,0,0,a.UB,5,"BB_AnonymousCreateMode"),new y(19,255,256,0,0,0,a.UB,5,"BB_UnsupportedInteractiveReportEditing"),new y(20,0,0,0,
0,0,a.tj,0,"BB_MobileAppCampaignBizBar"),new y(21,298,299,0,0,0,a.tj,0,"BB_TransientServerCommunicationFailures"),new y(22,1611,1622,1623,0,0,a.tj,0,"BB_EditAttemptInReadOnly"),new y(23,1611,1622,0,0,0,a.tj,0,"BB_EditAttemptInReadOnlyNoEditPermissions"),new y(24,0,lb.HelperMethods.cPj(),1600,0,0,a.tj,0,"BB_UnsupportedBrowser"),new y(25,301,302,0,0,0,a.tj,0,"BB_ReadOnlyPermissions"),new y(26,303,304,0,0,0,a.tj,0,"BB_DocumentIsIrmProtectedWarning"),new y(27,0,0,0,0,0,a.UB,5,"BB_PolicyWarningMessage"),
new y(28,1255,300,0,0,0,a.tj,0,"BB_WorkingOnIt"),new y(29,1611,1609,1610,0,0,a.tj,0,"BB_PasswordProtectedWorkbookLockedForEdit"),new y(30,1624,1625,1626,0,0,a.tj,0,"BB_WorkbookIsReadOnlyRecommended"),new y(31,1611,1627,1628,0,0,a.tj,0,"BB_WorkbookHasPasswordToModify"),new y(32,1611,1629,1632,0,0,a.tj,0,"BB_LegacySharedWorkbookEditWarning"),new y(33,1619,1630,254,0,0,a.tj,0,"BB_LegacyConnectionsWarning"),new y(34,1620,1621,0,0,0,a.tj,0,"BB_GroupedSlicers"),new y(35,314,315,0,0,0,a.UB,5,"BB_ThirdPartyAddinDisabled"),
new y(36,1752,1753,0,0,1754,a.tj,0,"BB_FinanceLinkedEntityDisclaimerBar"),new y(37,0,0,0,0,0,a.tj,0,"BB_WacGdprNotice"),new y(38,0,0,0,0,0,a.tj,0,"BB_AutomaticSensitivityLabel"),new y(39,0,0,0,0,0,a.tj,0,"BB_RecommendedSensitivityLabel"),new y(40,0,0,0,0,0,a.tj,0,"BB_MandatorySensitivityLabel"),new y(41,316,317,318,0,0,a.tj,0,"BB_LocalStorageDisabled"),new y(42,634,635,0,0,0,a.tj,0,"BB_AutoRefreshDisabled"),new y(43,996,994,998,1284,0,a.tj,0,"BB_CorruptedFileRepaired"),new y(44,997,995,998,1284,0,
a.tj,0,"CorruptedOdsFileRepaired"),new y(45,274,275,276,0,0,a.UB,5,"BB_MinorVersionLimitReached"),new y(46,305,306,0,0,0,a.UB,5,"BB_SensitivityApplicationGenericError"),new y(47,307,309,0,0,0,a.UB,5,"BB_SensitivityApplicationTooLargeFileError"),new y(48,308,309,0,0,0,a.UB,5,"BB_SensitivityApplicationLabelNotSupportedError"),new y(49,310,311,0,0,0,a.UB,5,"BB_SensitivityApplicationLabelDisabledError"),new y(50,312,313,0,0,0,a.UB,5,"BB_SensitivityApplicationMandatoryConflictError"),new y(51,0,0,0,0,
0,a.UB,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new y(52,0,0,0,0,0,a.UB,5,"BB_SensitivityApplicationSetLabelError"),new y(53,2072,2073,2074,2077,0,a.tj,0,"BB_ExternalWorkbookLinksPromptEnableContent"),new y(54,298,299,0,0,0,a.tj,0,"BB_NetworkDown"),new y(55,319,320,321,0,0,a.tj,0,"BB_DefaultToViewDueToCogs"),new y(56,1778,1779,1780,0,0,a.tj,0,"BB_RefreshLinkedEntityErrorBar"),new y(57,1755,1756,1757,1758,0,a.tj,0,"BB_LinkedEntitiesUntrustedImagesDisabled"),new t(58,251,0,0,0,a.tj,
0,"BB_CanvasHealth"),new y(59,322,323,0,0,324,a.tj,0,"BB_NovModeDepreciation"),new y(60,999,1E3,1284,0,1001,a.tj,0,"BB_MismatchedFileFormatConverted"),new y(61,2183,2184,2185,0,0,a.tj,0,"BB_OptimizeWorkbook"),new y(62,325,326,0,0,327,a.tj,0,"BB_NovModePostDepreciation"),new y(63,0,0,0,0,0,a.tj,0,"BB_OfficeScriptsRunning"),new y(64,2162,2163,0,0,2164,a.tj,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new y(65,328,329,0,0,330,a.tj,0,"BB_ReadOnlyPivotTable")])};Ek.Object.defineProperties(a.prototype,
{we:{configurable:!0,enumerable:!0,get:function(){return cb.a.eZc}},uc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});a.zia=Xb.a.Qph;a.UB=Xb.a.Sph;a.tj=Xb.a.Rph;a.Kue=null;Object(x.a)(a,"BusinessBarControl",J.a,[444])},1303:function(x,C,b){function a(){this.rjb=!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Qa.vv}
function c(z,M,Q){var P=l.call(this,z,M,Q)||this;z={};z=(z.errorMessage=P.aMe,z.errorFileDownloadOffer=P.itb,z);M={};z.helpLink=(M.type="AppLinkProps",M.id="helpLink",M.text=P.Sva,M.onExecute=function(L){P.DOa(L)},M);M=new B.a(!1,!1,!0);M.jc=1;M.Dc(1,P.jtb);M.Pe=P.id;Q={};z=(Q.id=P.id,Q.dialogIcon=P.icon,Q.bodyControls=z,Q);M.initializeAndShow(P.Hm,Object(h.a)(P,P.LGd,"reactOICErrorDialogHandler"),z);return P}function e(z,M,Q,P){var L=r.call(this,z,M,Q,P)||this;z={};z=(z.errorMessage=L.errorMessage,
z);M={};z.helpLink=(M.type="AppLinkProps",M.id="helpLink",M.text=L.Sva,M.onExecute=function(ca){L.DOa(ca)},M);L.oxc?(z.macOfficePreLinkText=L.mof,M={},z.macOfficeLink=(M.type="AppLinkProps",M.id="macOfficeLink",M.text=L.jof,M.onExecute=function(ca){L.fzd(ca)},M),z.macOfficePostText=L.lof):L.L3b&&(z.errorFileDownloadOffer=L.itb);M=new B.a(!1,!1,!0);L.L3b?(M.jc=1,M.Dc(1,L.jtb)):M.jc=0;M.Pe=L.id;Q={};z=(Q.id=L.id,Q.dialogIcon=L.icon,Q.bodyControls=z,Q);M.initializeAndShow(L.Hm,Object(h.a)(L,L.LGd,"reactOICErrorDialogHandler"),
z);return L}function f(z,M,Q){z=l.call(this,z,M,Q)||this;z.Zl=null;M=document.createElement("span");M.id="errorMessageText";M.innerText=z.aMe;M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));z.Zl=document.createElement("a");z.Zl.href="#";z.Zl.innerText=z.Sva;M.appendChild(z.Zl);y.a.addHandler(z.Zl,"click",Object(h.a)(z,z.DOa,"oicErrorHelpLinkHandler"));M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));Q=document.createElement("span");
Q.innerText=z.itb;M.appendChild(Q);Q=new E.StandardDialog;Q.Pe=z.id;Q.jc=1;Q.Dc(1,z.jtb);Q.yk(z.Hm,null,z.icon,Object(h.a)(z,z.jtd,"legacyOICErrorDialogHandler"),M);Q.rX("errorMessageText");return z}function l(z,M,Q){this.oY=M;this.pY=z;this.UD=Q}function m(z,M,Q,P){z=r.call(this,z,M,Q,P)||this;z.Zl=null;z.yqa=null;M=document.createElement("span");M.id="errorMessageText";M.innerText=z.errorMessage;M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));z.Zl=document.createElement("a");
z.Zl.href="#";z.Zl.innerText=z.Sva;M.appendChild(z.Zl);y.a.addHandler(z.Zl,"click",Object(h.a)(z,z.DOa,"oicErrorHelpLinkHandler"));Q=new E.StandardDialog;Q.Pe=z.id;if(z.oxc){P=document.createElement("span");var L=document.createElement("span");P.innerText=z.mof;L.innerText=z.lof;z.yqa=document.createElement("a");z.yqa.href="#";z.yqa.innerText=z.jof;M.appendChild(document.createElement("br"));M.appendChild(P);M.appendChild(z.yqa);M.appendChild(L);y.a.addHandler(z.yqa,"click",Object(h.a)(z,z.fzd,"oicErrorMacOfferLinkHandler"))}else z.L3b&&
(M.appendChild(document.createElement("br")),M.appendChild(document.createElement("br")),P=document.createElement("span"),P.innerText=z.itb,M.appendChild(P));z.L3b?(Q.jc=1,Q.Dc(1,z.jtb)):Q.jc=0;Q.yk(z.Hm,null,z.icon,Object(h.a)(z,z.jtd,"legacyOICErrorDialogHandler"),M);Q.rX("errorMessageText");return z}function r(z,M,Q,P){this.iNc=null;this.ZRb=P;this.oY=z;this.pY=M;this.UD=Q;this.Kge=this.kof.vwj;z=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.Yrg=z[0];this.Xrg=z[1]}x=b(0);var h=b(82),
w=b(14),n=b(4),v=b(52),u=b(440),t=b(85);r.prototype.LGd=function(z){this.KDb(z)};r.prototype.jtd=function(z){this.KDb(z)};r.prototype.KDb=function(z){var M=10;this.pY&&1===z&&(this.pY(this.UD),M=1);this.oY&&this.oY(this.UD);this.ZF(M)};r.prototype.DOa=function(){u.Redirect.showHelp("OICFailure");this.ZF(2)};r.prototype.fzd=function(){this.kof.Jjf();this.ZF(4)};r.prototype.ZF=function(z){w.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.ZRb,z);n.AFrameworkApplication.ytc(v.a.rEf,
this.ZRb,z)};r.prototype.dispose=function(){this.UD=this.oY=this.pY=null};Ek.Object.defineProperties(r.prototype,{kof:{configurable:!0,enumerable:!0,get:function(){return this.iNc||(this.iNc=t.a.instance.resolve("Common.IMacOfficeOffer"))}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},Sva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},
oxc:{configurable:!0,enumerable:!0,get:function(){return this.Kge}},mof:{configurable:!0,enumerable:!0,get:function(){return this.Yrg}},lof:{configurable:!0,enumerable:!0,get:function(){return this.Xrg}},jof:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},icon:{configurable:!0,enumerable:!0,get:function(){return this.Kge?3:2}},itb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},L3b:{configurable:!0,enumerable:!0,
get:function(){return!!this.pY}},jtb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},Hm:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(x.a)(r,"AOICErrorDialog",null,[3]);var y=b(42),E=b(133);Am(m,r);m.prototype.dispose=function(){this.Zl&&(y.a.removeHandler(this.Zl,"click",Object(h.a)(this,this.DOa,"oicErrorHelpLinkHandler")),this.Zl=null);this.yqa&&(y.a.removeHandler(this.yqa,"click",Object(h.a)(this,
this.fzd,"oicErrorMacOfferLinkHandler")),this.yqa=null);r.prototype.dispose.call(this)};Object(x.a)(m,"OICErrorDialog",r,[]);l.prototype.LGd=function(z){this.KDb(z)};l.prototype.jtd=function(z){this.KDb(z)};l.prototype.KDb=function(z){var M=10;1===z&&(this.pY(this.UD),M=1);this.oY&&this.oY(this.UD);this.ZF(M)};l.prototype.DOa=function(){u.Redirect.showHelp("OICFailure");this.ZF(2)};l.prototype.ZF=function(z){n.AFrameworkApplication.ytc(v.a.sEf,3,z)};l.prototype.dispose=function(){this.UD=this.pY=
this.oY=null};Ek.Object.defineProperties(l.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},aMe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},Sva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},itb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},jtb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},
icon:{configurable:!0,enumerable:!0,get:function(){return 2}},Hm:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(x.a)(l,"AOICErrorDialogWithDownload",null,[3]);Am(f,l);f.prototype.dispose=function(){this.Zl&&(y.a.removeHandler(this.Zl,"click",Object(h.a)(this,this.DOa,"oicErrorHelpLinkHandler")),this.Zl=null);l.prototype.dispose.call(this)};Object(x.a)(f,"OICErrorDialogWithDownload",l,[]);var B=b(149);Am(e,r);Object(x.a)(e,"ReactOICErrorDialog",
r,[]);Am(c,l);Object(x.a)(c,"ReactOICErrorDialogWithDownload",l,[]);b.d(C,"a",function(){return a});a.prototype.P7g=function(z,M,Q){this.rjb?new e(z,M,null,Q):new m(z,M,null,Q)};a.prototype.Q7g=function(z,M,Q){this.rjb?new c(z,M,Q):new f(z,M,Q)};a.prototype.R7g=function(z,M,Q,P,L){var ca=b(1384).ReactOICErrorDialogWithTrial,U=b(1385).OICErrorDialogWithTrial;this.rjb?new ca(z,M,Q,null,P,L):new U(z,M,Q,null,P,L)};Ek.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Ma||
(a.Ma=new a)}}});a.Ma=null;Object(x.a)(a,"OICErrorDialogFactory",null,[394])},1321:function(x,C,b){function a(pa,xa){var va=ma.call(this)||this;va.Pa=new h.a;va.vU=null;va.aIc=[];va.Imc=function(){va.$.na.ULa?va.removeEntry(13):va.eg(13,null)};va.Bya=function(){F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170243,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");va.removeEntry(21);va.sC(54)&&(e.ULS.sendTraceTag(537170242,
0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),va.removeEntry(54));va.eRf("OnNetworkResumed")};va.Th=function(fa,Ca){fa=0;for(var Sa=a.Icc().length;fa<Sa;fa++){var Gb=a.Icc()[fa];va.removeEntry(Gb)}Ca.context&&0<Ca.context.communicationErrorRetryCount&&(e.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),va.removeEntry(21));va.eRf("OnWebMethodSuccess")};va.Un=
function(fa,Ca){var Sa;fa=va.dAh(Ca.errors);for(var Gb=[],kb=0,lb=fa.length;kb<lb;++kb){var Nb=fa[kb];if(1===Nb.Type&&Nb.Appearance&32)Gb=va.N3h(Nb,Gb);else if(Ca.knj){e.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var Aa=(null===(Sa=Ca.context)||void 0===Sa?0:Sa.stopwatch)?Ca.context.stopwatch.Bc:-1;5E3>Aa?e.ULS.sendTraceTag(537170208,0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",
Aa):f.AFrameworkApplication.Lgf()||va.aDg(Nb,Ca.context.methodName)}Aa=[].concat(Fl(a.Icc()));for(var qa=0,Xa=Gb.length;qa<Xa;++qa){var Ha=Gb[qa];va.eg(Ha,Nb);Array.remove(Aa,Ha)}Nb=0;for(qa=Aa.length;Nb<qa;++Nb)va.removeEntry(Aa[Nb])}};va.JEb=function(fa,Ca){fa=0;for(var Sa=Ca.errors.length;fa<Sa;++fa){var Gb=Ca.errors[fa];f.AFrameworkApplication.Lgf()||(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),
va.eg(54,Gb))}};va.od=function(fa,Ca){va.Yc(fa,Ca)};va.Yc=function(){var fa=va.$.ea;fa.sc||fa.Hg()||(va.oId(),Array.clear(va.aIc))};va.zd=function(fa,Ca){va.$.ea.Hg()&&!Ca.eW||va.K9e(Ca.eW)};va.pFb=function(){var fa=va.$.userOperationManager.vcc();fa&&fa.operation.flags&1&&va.c3f()};va.Gxf=function(){va.c3f()};va.Hf=function(){va.Bxe();va.l3f()};va.QN=function(){if(va.$.y5&&va.$.ea.Hg()&&va.$.ea.sc)if(va.$.ea.isEditMode)va.removeEntry(43),va.removeEntry(12),va.removeEntry(29),va.removeEntry(30),va.removeEntry(31),
va.removeEntry(32),va.removeEntry(22),va.removeEntry(55);else{var fa=va.$.da.Aa(331);fa&&fa.mJa||va.removeEntry(53);va.removeEntry(5)}};va.$=pa;va.aZa=xa;va.uLg();f.AFrameworkApplication.Jd&&f.AFrameworkApplication.Jd.FUc(va);va.Omb=Array(66);for(var ta=0;66>ta;ta++)va.Omb[ta]=null;va.qh=U.EcmaDateClock.instance;va.Cif=va.qh.Wb.getTime();xa&&(xa=pa.na,ta=xa.qf,xa.dz(va.Un),xa.Bq(va.Th),xa.mnb(va.Imc),xa.EYa(va.Imc),F.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(ta.zFg(va.JEb),
ta.znb(va.Bya)),pa.ea.hk(va.od),pa.ea.Ot(va.Hf),pa.nl(va.zd),pa.Zk(va.Yc),pa.ea.N2(va.QN),pa.userOperationManager.Vu(va.pFb),F.EwaSettings.ma(170)&&pa.ea.Zg.get(45)&&f.AFrameworkApplication.ga.ra("SupportsPolicies")||va.C5e(),va.K9e(R.c(pa)));pa.da.Ga(5,va);return va}function c(pa,xa,va){va=void 0===va?null:va;var ta=t.call(this)||this;ta.FGa=pa;ta.O6c=xa;ta.data=va;return ta}x=b(0);var e=b(14),f=b(4),l=b(90),m=b(24),r=b(126),h=b(38),w=b(76),n;(function(pa){pa[pa.unableToRefreshLock=0]="unableToRefreshLock";
pa[pa.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";pa[pa.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";pa[pa.workbookTooLarge=3]="workbookTooLarge";pa[pa.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";pa[pa.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";pa[pa.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";pa[pa.unsupportedFeatures=7]="unsupportedFeatures";pa[pa.collabDataAndDataStringsLocaleMismatch=8]=
"collabDataAndDataStringsLocaleMismatch";pa[pa.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";pa[pa.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";pa[pa.lastGenericStatusError=11]="lastGenericStatusError";pa[pa.scratchPadWarning=12]="scratchPadWarning";pa[pa.authenticationLost=13]="authenticationLost";pa[pa.odfCompatibilityIssues=14]="odfCompatibilityIssues";pa[pa.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";pa[pa.workbookIsIrmProtected=
16]="workbookIsIrmProtected";pa[pa.biFeatureNotAvailable=17]="biFeatureNotAvailable";pa[pa.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";pa[pa.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";pa[pa.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";pa[pa.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";pa[pa.editAttemptInReadOnly=22]="editAttemptInReadOnly";pa[pa.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";
pa[pa.unsupportedBrowser=24]="unsupportedBrowser";pa[pa.readOnlyPermissions=25]="readOnlyPermissions";pa[pa.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";pa[pa.policyWarningMessage=27]="policyWarningMessage";pa[pa.workingOnIt=28]="workingOnIt";pa[pa.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";pa[pa.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";pa[pa.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";pa[pa.legacySharedWorkbookEditWarningBB=
32]="legacySharedWorkbookEditWarningBB";pa[pa.legacyConnectionsBB=33]="legacyConnectionsBB";pa[pa.groupedSlicersBB=34]="groupedSlicersBB";pa[pa.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";pa[pa.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";pa[pa.wacGdprNotice=37]="wacGdprNotice";pa[pa.automaticSensitivityLabel=38]="automaticSensitivityLabel";pa[pa.recommendedSensitivityLabel=39]="recommendedSensitivityLabel";pa[pa.mandatorySensitivityLabel=40]="mandatorySensitivityLabel";
pa[pa.localStorageDisabled=41]="localStorageDisabled";pa[pa.autoRefreshDisabled=42]="autoRefreshDisabled";pa[pa.corruptedFileRepaired=43]="corruptedFileRepaired";pa[pa.corruptedOdsFileRepaired=44]="corruptedOdsFileRepaired";pa[pa.minorVersionLimitReached=45]="minorVersionLimitReached";pa[pa.sensitivityApplicationGenericError=46]="sensitivityApplicationGenericError";pa[pa.sensitivityApplicationTooLargeFileError=47]="sensitivityApplicationTooLargeFileError";pa[pa.sensitivityApplicationLabelNotSupportedError=
48]="sensitivityApplicationLabelNotSupportedError";pa[pa.sensitivityApplicationLabelDisabledError=49]="sensitivityApplicationLabelDisabledError";pa[pa.sensitivityApplicationMandatoryConflictError=50]="sensitivityApplicationMandatoryConflictError";pa[pa.sensitivityApplicationMinorVersionLimitReachedError=51]="sensitivityApplicationMinorVersionLimitReachedError";pa[pa.sensitivityApplicationSetLabelError=52]="sensitivityApplicationSetLabelError";pa[pa.promptEnableExternalLinks=53]="promptEnableExternalLinks";
pa[pa.networkDown=54]="networkDown";pa[pa.defaultToViewDueToCogs=55]="defaultToViewDueToCogs";pa[pa.refreshLinkedEntityErrorBar=56]="refreshLinkedEntityErrorBar";pa[pa.promptEnableLinkedEntitiesUntrustedImages=57]="promptEnableLinkedEntitiesUntrustedImages";pa[pa.canvasHealth=58]="canvasHealth";pa[pa.novModeDepreciation=59]="novModeDepreciation";pa[pa.mismatchedFileFormatConverted=60]="mismatchedFileFormatConverted";pa[pa.optimizeWorkbook=61]="optimizeWorkbook";pa[pa.novModePostDepreciation=62]="novModePostDepreciation";
pa[pa.officeScriptsRunning=63]="officeScriptsRunning";pa[pa.powerQueryRefreshDataSourceNotSupported=64]="powerQueryRefreshDataSourceNotSupported";pa[pa.readOnlyPivotTable=65]="readOnlyPivotTable";pa[pa.count=66]="count"})(n||(n={}));Object(x.b)("EwaBusinessBarEntryType",n);var v=b(5),u=b(1243),t=Sys.EventArgs;Am(c,t);Object(x.a)(c,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var y=b(1245),E=b(1244),B=b(1247),z=b(1246),M=b(1241),Q=b(522),P=b(51),L=b(592),ca=b(36),U=b(743),aa=b(30),F=
b(1),D=b(10),J=b(22),R=b(53),Z=b(66),W=b(1047),ka=b(187);b.d(C,"a",function(){return a});var ma=w.a;Am(a,ma);a.prototype.C5e=function(){aa.a.lr(this.$.ea.MF)&&this.Un(this,new Q.a(this.$.ea.MF,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.FDg=function(pa){this.Pa.addHandler("bBarAttachedOrDetached",pa)};a.prototype.dispose=function(){if(this.$){var pa=this.$,xa=pa.na,va=xa.qf;xa.Wz(this.Un);xa.Dr(this.Th);xa.Gsc(this.Imc);xa.VHb(this.Imc);va.kIb(this.Bya);va.sbj(this.JEb);pa.ea.Dk(this.od);pa.ea.Ev(this.Hf);
pa.Sl(this.zd);pa.rm(this.Yc);pa.ea.x0(this.QN);pa.userOperationManager.Cr(this.pFb);J.g(pa).rc.fl(this.Gxf)}l.a.Ha(this.vU);this.$=this.vU=null;ma.prototype.dispose.call(this)};a.prototype.Nei=function(pa){switch(pa){case 4:case 5:case 11:case 53:case 7:case 36:return!0;case 57:return F.EwaSettings.ma(658);default:return!1}};a.prototype.eg=function(pa,xa,va,ta,fa){va=void 0===va?null:va;ta=void 0===ta?null:ta;fa=void 0===fa?null:fa;if(!this.$.isMobileMode||this.Nei(pa))this.aZa&&!this.sC(pa)&&(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&
e.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: {0}",Enum.toString(n,pa)),this.Omb[pa]=this.qh.Dea,this.vU.lE(pa,xa,ta,fa),this.Pa.raiseEvent("bBarAttachedOrDetached",new c(pa,!0,va))),xa&&32===xa.Appearance&&Z.a(this.$).ud.nla(xa)};a.prototype.kzj=function(pa,xa,va,ta){e.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");M.a.initialize(pa,xa,va,ta);this.eg(37,null)};a.prototype.myj=function(pa,xa,va,ta){u.a.initialize(pa,xa,va,ta);this.eg(38,null)};a.prototype.uAj=
function(pa,xa,va,ta){E.a.initialize(pa,xa,va,ta);this.eg(39,null)};a.prototype.Jzj=function(pa,xa,va,ta){y.a.initialize(pa,xa,va,ta);this.eg(40,null)};a.prototype.FAj=function(pa,xa,va,ta){z.a.initialize(pa,xa,va,ta);this.eg(51,null)};a.prototype.EAj=function(pa,xa,va,ta){B.a.initialize(pa,xa,va,ta);this.eg(52,null)};a.prototype.removeEntry=function(pa){this.aZa&&(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: {0}",
Enum.toString(n,pa)),this.Omb[pa]=null,this.vU.removeEntry(pa)&&this.Pa.raiseEvent("bBarAttachedOrDetached",new c(pa,!1)))};a.prototype.mMa=function(pa){return this.aZa?this.vU.mMa(pa):!1};a.prototype.sC=function(pa){return this.aZa?this.vU.sC(pa):!1};a.prototype.hDb=function(){e.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};a.prototype.Wlc=function(){e.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");
this.removeEntry(21)};a.prototype.uLg=function(){var pa=b(1295).BusinessBarControl;if(this.aZa&&!this.vU){J.g(this.$).rc.ml(this.Gxf);var xa=document.getElementById(this.$.Mb+v.a.Mue);this.vU=new pa(this.$,xa)}};a.prototype.oId=function(){this.aZa&&this.vU.oId()};a.prototype.eRf=function(pa){if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var xa=this.qh.Dea;if(3E5<=xa-this.Cif){this.Cif=xa;for(var va=0;66>va;va++){var ta=this.Omb[va];ta&&(ta=xa-ta,3E5<=ta&&e.ULS.sendTraceTag(537170241,
0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",pa,Enum.toString(n,va),ta))}}}};a.prototype.dAh=function(pa){for(var xa=[],va=El(pa),ta=va.next();!ta.done;ta=va.next())switch(ta.value.MessageId){case -113742550:ta=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.ea.isNamedObjectViewMode||aa.a.nh(pa,ta))&&xa.push(-113742550)}return aa.a.TF(pa,xa)};a.prototype.N3h=function(pa,xa){switch(pa.MessageId){case 2113407564:for(var va=aa.a.b_a([1821390342,
-943219229,-502303485,1437034227]),ta=0;ta<va.length;ta++)va[ta].HelpTopicId=pa.HelpTopicId,va[ta].HelpDescription=pa.HelpDescription,this.aIc.push(va[ta])}switch(pa.MessageId){case -395951567:this.eg(6,pa);break;case 1643490758:this.eg(4,pa);break;case -907264831:this.eg(5,pa);break;case 757111532:case 2113407564:this.eg(7,pa);break;case 2010656511:this.eg(15,pa);break;case 1321660996:this.$.o5c=!0;this.eg(8,pa);break;case 526339737:this.$.o5c=!0;this.eg(9,pa);break;case -407088521:this.eg(10,pa);
break;case 1756116017:this.eg(14,pa);break;case -1703455218:this.eg(17,pa);break;case 1393475740:this.eg(25,pa);break;case -949523941:this.eg(26,pa);break;case 1779381952:this.eg(42,pa);break;case 1421575100:this.eg(43,pa);break;case 613676060:this.eg(44,pa);break;case 1233668252:this.eg(60,pa);break;case 1911608588:pa=!!(this.$.Pd&64);!this.$.ea.Hg()&&pa&&xa.push(29);break;case 1544494907:break;case -655555355:xa.push(this.mrd()?1:0);break;case -1221382671:xa.push(2);break;case 1662282929:xa.push(3);
break;case 104919273:this.$.ea.Hg()||xa.push(30);break;case -689453604:pa=!!(this.$.Pd&64);this.$.ea.P6e=!0;!this.$.ea.Hg()&&pa&&xa.push(31);break;case 157762400:this.$.ea.Xgc=!0;!this.$.ea.Hg()&&this.$.Pd&64&&!this.$.isEditMode&&xa.push(32);break;case -73730134:F.EwaSettings.isChangeGateEnabled("OfficeVSO:6079602_EnableEditingOfFilesWithLegacyConnections")&&!this.$.ea.Hg()&&this.$.Pd&64&&xa.push(33);break;case -293349236:xa.push(64);break;case -37299333:break;case 136737622:xa.push(45);break;case -1780327030:this.eg(53,
pa);break;case -113742550:this.eg(55,pa);break;case -260312420:this.$.ea.Hg()||xa.push(65);break;default:this.eg(11,pa)}return xa};a.prototype.R9h=function(){var pa=this;if(f.AFrameworkApplication.ga.ra("WildFireExcelBizBar")&&!W.a.jpd(W.a.cdd(1))&&(m.a.np||m.a.Eh)){var xa=P.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);ca.TaskExtensions.Ba(xa,function(){pa.eg(20,null)},this.la,3)}};a.prototype.O9h=function(){var pa=F.EwaSettings.ma(74),xa=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled",
!1),va=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockStringIsEnabled",!1);D.HelperMethods.uRd(va||xa,pa)&&(ka.a("NewBrowserSuggestionShown"),va||r.a.Kv("NewBrowserSuggestionShown","true",7),this.eg(24,null))};a.prototype.k9h=function(pa){!pa&&L.b(this.$)&&this.eg(59,null)};a.prototype.l9h=function(pa){!pa&&L.c(this.$)&&this.eg(62,null)};a.prototype.K9e=function(pa){(!pa&&!this.$.printingEnabled||this.$.Yf.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&
(e.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.eg(16,null));this.R9h();this.O9h();this.Bxe();this.l3f();this.k9h(pa);this.l9h(pa)};a.prototype.Bxe=function(){this.$.workbookContext.Options&32768&&this.azj()};a.prototype.azj=function(){this.Omb[36]||this.eg(36,null)};a.prototype.l3f=function(){F.EwaSettings.ma(658)&&this.$.workbookContext.Options&524288&&this.eg(57,null)};a.prototype.I3f=function(pa,xa){this.eg(56,pa,null,xa)};a.prototype.Ple=
function(pa,xa){var va=null,ta=null;va=void 0===va?null:va;ta=void 0===ta?null:ta;xa=void 0===xa?null:xa;this.vU.sC(pa)?this.vU.hOb(pa,xa):this.eg(pa,null,va,ta,xa)};a.prototype.c3f=function(){this.$.Pd&8&&this.eg(12,null)};a.prototype.mrd=function(){var pa=this.$.da.Aa(38);return pa?pa.tokenExpired:!1};a.prototype.aDg=function(pa,xa){if(!this.sC(21)&&-1387426400!==pa.MessageId){e.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");var va={};
va.FailedMethod=xa;this.eg(21,pa,va)}};a.Icc=function(){return a.bpe||(a.bpe=[0,1,2,3])};Ek.Object.defineProperties(a.prototype,{T7c:{configurable:!0,enumerable:!0,get:function(){return this.aIc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.vU?this.vU.domElement:null}}});a.bpe=null;Object(x.a)(a,"BusinessBarManager",w.a,[765,3,88])},1336:function(x,C,b){function a(v,u,t,y,E,B){this.uOc=null;this._id=v;this.aPc=u;this.cpg=void 0===E?null:E;this.kjb=y;this.wlb=void 0===B?null:
B;this.kpa=null;this.$Xa=t;this.Vlb=c.instance.jYh(u,v)}function c(){this.gFc=new r.a;this.eFc=new r.a;this.dFc=new r.a;this.pPg(this.gFc);this.oPg(this.eFc);this.nPg(this.dFc);this.iKc=new r.a;this.hKc=new r.a;this.gKc=new r.a;this.MRg(this.iKc);this.LRg(this.hKc);this.KRg(this.gKc);this.uGc=new r.a;this.IPg(this.uGc);this.BFa(this.uGc);this.BFa(this.dFc);this.BFa(this.eFc);this.BFa(this.gFc);this.BFa(this.hKc);this.BFa(this.iKc);this.BFa(this.gKc)}x=b(0);var e=b(14),f=b(82),l=b(1060),m=b(1047),
r=b(1316);c.prototype.jYh=function(v,u){switch(v){case 1:return this.x0h(u);case 2:return this.nIh(u)}return m.a.Dxc?this.uGc:null};c.prototype.pPg=function(v){v.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);v.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);v.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};c.prototype.oPg=function(v){v.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);v.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
v.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};c.prototype.nPg=function(v){v.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);v.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);v.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};c.prototype.MRg=function(v){v.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);v.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);v.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);v.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);v.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);v.add("OverlayBig","Get the Word app");v.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");v.add("OverlaySmallSplit1","Discover Word");v.add("OverlaySmallSplit2","designed for the iPad.");v.add("SkipButton","Skip for now")};c.prototype.IPg=function(v){v.add("Headline",
"Get the Office Online extension for Chrome");v.add("UseAppButton","Get the extension");v.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};c.prototype.LRg=function(v){v.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);v.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);v.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);v.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);v.add("CallToAction",
CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);v.add("OverlayBig","Get the PowerPoint app");v.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");v.add("OverlaySmallSplit1","Discover PowerPoint");v.add("OverlaySmallSplit2","designed for the iPad.");v.add("SkipButton","Skip for now")};c.prototype.KRg=function(v){v.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);v.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);v.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);v.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);v.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};c.prototype.BFa=function(v){v.add("Corporation","Microsoft Corporation")};c.prototype.x0h=function(v){switch(v){case 3:return this.iKc;case 2:return this.hKc;case 1:return this.gKc}return null};c.prototype.nIh=function(v){switch(v){case 3:return this.gFc;case 2:return this.eFc;case 1:return this.dFc}return null};
Ek.Object.defineProperties(c,{instance:{configurable:!0,enumerable:!0,get:function(){c.Ma||(c.Ma=new c);return c.Ma}}});c.Ma=null;Object(x.a)(c,"WildFireStringFactory",null,[]);var h=b(4),w=b(39),n=b(24);b.d(C,"a",function(){return a});a.prototype.n3c=function(){this.kpa=new l.a(this.title,this.message,null);this.kpa.addButton(this.Uue,Object(f.a)(this,this.cuf,"onButtonOneClick"),"");this.$Xa&&this.kpa.lCg(this.Wue,Object(f.a)(this,this.fuf,"onButtonTwoClick"));this.kpa.B$=Object(f.a)(this,this.fIe,
"dismissBar");this.kpa.image=3;this.kpa.id=16;this.kpa.closeable=!0};a.prototype.cuf=function(){this.$Xa?this.Tbi():this.wTj()};a.prototype.fuf=function(){this.$Xa&&this.$Ti()};a.prototype.Tbi=function(){e.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.kjb&&this.wlb&&this.wlb();m.a.JMf(this._id,this.aPc)};a.prototype.$Ti=function(){this.openUrl&&(e.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.kjb&&this.wlb&&this.wlb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(m.a.bqe(this._id),
this.openUrl,0,!1))};a.prototype.wTj=function(){m.a.Dxc?this.URg():(e.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),m.a.CPd("BizBarClicked"),1!==this.aPc&&2!==this.aPc||m.a.yYg(this.openUrl,this.kjb,this._id,this.wlb))};a.prototype.URg=function(){this.kjb?e.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):e.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");w.a.tV(h.AFrameworkApplication.ga.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.ofh=function(){this.kjb?
e.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):e.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");m.a.CPd(m.a.aye)};a.prototype.fIe=function(){m.a.Dxc?this.ofh():(m.a.CPd(m.a.cdd(this._id)),e.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.Z4b=function(){var v=h.AFrameworkApplication.ta.Qa,u=new a(v.Sj,m.a.Gcc(),8<n.a.s5a,1===v.qca,function(){return v.Px},v.IUf());e.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return u};Ek.Object.defineProperties(a.prototype,
{title:{configurable:!0,enumerable:!0,get:function(){return this.Vlb.oa("Headline")}},message:{configurable:!0,enumerable:!0,get:function(){return this.Vlb.oa("CallToAction")}},FTj:{configurable:!0,enumerable:!0,get:function(){return this.$Xa}},Uue:{configurable:!0,enumerable:!0,get:function(){return this.$Xa?this.Vlb.oa("InstallButton"):this.Vlb.oa("UseAppButton")}},Wue:{configurable:!0,enumerable:!0,get:function(){return this.$Xa?this.Vlb.oa("OpenAppButton"):""}},QRg:{configurable:!0,enumerable:!0,
get:function(){return this.kpa}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.uOc||(this.uOc=this.cpg());return this.uOc}}});Object(x.a)(a,"WildFireBusinessBar",null,[])},1384:function(x,C,b){function a(m,r,h,w,n,v){var u=l.call(this,m,r,h,w,n,v)||this;m={};r=(m.errorMessage=u.$Le,m.offerString=u.zsf,m);m=new f.a(!1,!1,!0);u.d3f?(m.jc=1,h={},r.helpLink=(h.type="AppLinkProps",h.id="helpLink",h.text=u.Sva,h.onExecute=function(){e.Redirect.showHelp(u.v7e)},h)):(m.jc=4,m.Dc(2,u.K8e));m.Dc(1,
u.eYb);m.Pe=u.id;h={};r=(h.id=u.id,h.dialogIcon=u.icon,h.bodyControls=r,h);m.initializeAndShow(u.Hm,Object(c.a)(u,u.A4i,"reactOICErrorDialogWithTrialHandler"),r);return u}b.r(C);b.d(C,"ReactOICErrorDialogWithTrial",function(){return a});x=b(0);var c=b(82);C=b(1248);var e=b(440),f=b(149),l=C.a;Am(a,l);Object(x.a)(a,"ReactOICErrorDialogWithTrial",C.a,[])},1385:function(x,C,b){function a(l,m,r,h,w,n){l=f.call(this,l,m,r,h,w,n)||this;m=document.createElement("span");m.innerText=l.$Le;m.appendChild(document.createElement("br"));
m.appendChild(document.createElement("br"));r=document.createElement("span");r.innerText=l.zsf;m.appendChild(r);r=new e.StandardDialog;l.d3f?(r.jc=1,r.Ble(l.Sva,l.v7e)):(r.jc=4,r.Dc(2,l.K8e));r.Dc(1,l.eYb);r.Pe=l.id;r.yk(l.Hm,null,l.icon,Object(c.a)(l,l.pri,"legacyOICErrorDialogWithTrialHandler"),m);return l}b.r(C);b.d(C,"OICErrorDialogWithTrial",function(){return a});x=b(0);var c=b(82);C=b(1248);var e=b(133),f=C.a;Am(a,f);Object(x.a)(a,"OICErrorDialogWithTrial",C.a,[])},1386:function(x,C,b){function a(){return c.call(this)||
this}b.r(C);b.d(C,"CheckRoamingRightsRequest",function(){return a});x=b(0);b=b(1250);var c=b.a;Am(a,c);a.prototype.j4a=function(){return 2};a.prototype.Laa=function(){return 1};Object(x.a)(a,"CheckRoamingRightsRequest",b.a,[])},1387:function(x,C,b){function a(){return c.call(this)||this}b.r(C);b.d(C,"GetRoamingLauncherRequest",function(){return a});x=b(0);b=b(1250);var c=b.a;Am(a,c);a.prototype.j4a=function(){return 0};a.prototype.Laa=function(){return 2};Object(x.a)(a,"GetRoamingLauncherRequest",
b.a,[])},1403:function(x,C,b){function a(h){this.sGc=!1;this.qXa=a.Xec;this.eQc=this.hOc=0;this.platform=null;this.Qug=h;this.Uie=this.fQc=!1}function c(){this.state=this.callback=null;this.Aod=!1}function e(){this.classId=0}x=b(0);var f=b(82),l=b(41);e.pIa=function(h){try{return l.a(h)}catch(w){}return null};Object(x.a)(e,"ARoamingAppsResponse",null,[]);Object(x.a)(c,"GetRoamingAppsLauncherContext",null,[]);var m=b(4),r=b(108);b.d(C,"a",function(){return a});a.prototype.TWg=function(){m.AFrameworkApplication.ohc&&
this.roamingAppsAreEnabled&&!this.fQc&&!this.sGc&&(this.eQc=1,this.sGc=!0,this.Efj(),this.gRe())};a.prototype.Efj=function(){this.qXa=a.Xec;this.hOc=0};a.prototype.getRoamingAppsLauncher=function(h,w,n){this.QTj?(h=new c,h.callback=w,h.state=n,h.Aod=!0,this.lRe(h)):w(!1,"",n)};a.prototype.gRe=function(){var h=new (b(1386).CheckRoamingRightsRequest);h.RoamingApp=this.eQc;h.BaseDocQuerySignature=m.AFrameworkApplication.oj;h.execute(Object(f.a)(this,this.VWg,"checkUserRoamingRightsSucceeded"),Object(f.a)(this,
this.UWg,"checkUserRoamingRightsFailed"),null)};a.prototype.VWg=function(h){m.AFrameworkApplication.Pg||((h=e.pIa(h.data.ke))?this.EPd(h.HasRights):this.EPd(!1))};a.prototype.UWg=function(){if(!m.AFrameworkApplication.Pg)if(this.hOc>=a.Iyi)this.EPd(!1);else{var h=new r.a(2,1,this.qXa,Object(f.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);m.AFrameworkApplication.Qi.Sg(h);this.hOc++;this.qXa*=a.Vgj;this.qXa>a.Yof&&(this.qXa=a.Yof)}};a.prototype.EPd=function(h){this.Uie=
h;this.fQc=!0;this.sGc=!1};a.prototype.retryCheckUserRoamingRights=function(){this.gRe()};a.prototype.lRe=function(h){var w=new (b(1387).GetRoamingLauncherRequest);w.RoamingApp=this.eQc;w.BaseDocQuerySignature=m.AFrameworkApplication.oj;w.execute(Object(f.a)(this,this.oWh,"getRoamingAppsLauncherSucceeded"),Object(f.a)(this,this.nWh,"getRoamingAppsLauncherFailed"),h)};a.prototype.oWh=function(h){if(!m.AFrameworkApplication.Pg){var w=e.pIa(h.data.ke);h=h.data.state;w?(this.platform=w.Platform,h.callback(!0,
w.Launcher,h.state)):h.callback(!1,"",h.state)}};a.prototype.nWh=function(h){if(!m.AFrameworkApplication.Pg){var w=h.data.state;5===h.data.status&&w.Aod?(w.Aod=!1,this.lRe(w)):w.callback(!1,"",w.state)}};Ek.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Qug}},QTj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.fQc?this.Uie:!1}}});Ek.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,
get:function(){return a.gC||(a.gC=new a(m.AFrameworkApplication.NKg))}}});a.Xec=1E3;a.Vgj=5;a.Yof=12E5;a.Iyi=5;a.gC=null;Object(x.a)(a,"RoamingAppsManager",null,[])},1438:function(x,C,b){function a(K){return Uk.call(this,K)||this}function c(K,ea,Ta){var Lb=this;this.ignorePrintArea=!1;this.mLj=function(){var xc=Tg.g(Lb.$).Ea;Lb.dRc=!0;xc.Cyd()};this.TOi=function(){Lb.Iid()};this.SOi=function(xc,qd,Jd){Ed.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",
Jd);Lb.Iid()};this.$=K;this.ea=K.ea;this.lia=ea;this.cO=new F(1,this.ignorePrintArea);this.vD=ea=new e(K,ea,he.AFrameworkApplication.Jd,Ta);this.$.da.Ga(418,ea);this.mIf=new B(K);this.$.da.Ga(384,this);this.dRc=!1}function e(K,ea,Ta,Lb){var xc=this;this.activeCell=this.selectedRange=this.wg=this.graphServiceEndpoint=null;this.i0=0;this.Um=this.Av=null;this.OH=new E;this.wk=new E;this.Tba=0;this.P7a=null;this.LMb=!1;this.g3a=this.JFb=null;this.Ypd=!1;this.N6a=this.Lzb=this.thc=!0;this.mma=this.Uya=
this.qNa=null;this.Myb=!1;this.M7a=null;this.g6a=this.zLc=!1;this.rAd=function(qd){if(!(qd&&qd.data&&qd.data.ke&&qd.data.responseHeaders&&qd.data.ke.length)){var Jd=qd?qd.data?qd.data.ke?qd.data.responseHeaders?qd.data.ke.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";xc.wg&&(qd=xc.cAa(Kc.a.instance.fa(1181)),xc.Rna(qd,0));Ed.ULS.sendTraceTag(593266765,
0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",Jd);xc.rKd&&(qd=Object(jh.a)(new ek.a,{extendedProperties:new Map}),qd.extendedProperties.set("InvalidParameterName",Jd),Ke.Health.instance.recordQosError(kk.a.oIf,[Sc.a.pIf],!1,!0,!0,!1,qd))}else if(0<xc.Tba&&qd.data.id===xc.Tba){if(qd.data.responseHeaders["Content-Type"]&&(bh.a.contains(qd.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||bh.a.contains(qd.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){Ed.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var De=null;bh.a.contains(qd.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(De=xc.D4g(qd));Jd={};xc.bEb(Jd,null,null,De);qd.data.responseHeaders["Total-Pdf-PageCount"]?(De=parseInt(qd.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),xc.Myb||(xc.pFd>=De?xc.mma=De:xc.Myb=!0),xc.N6a&&xc.wg&&xc.wg.setPageRangeSettings(De,xc.pFd,xc.Myb,xc.Uya,
xc.mma)):Ed.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else Jd=Zk.a.mi(qd.data.ke),$g.a.c$(Jd.Errors)||Ga.a(xc.$).ud.kE(Jd.Errors[0].MessageId),xc.d6i(Jd.Errors),xc.wg&&(De=xc.cAa(Jd.Errors[0].Description),-1831476778===Jd.Errors[0].MessageId?(Ed.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),xc.Rna(De,0,Kc.a.instance.fa(1184))):xc.Rna(De,
0)),297284985===Jd.Errors[0].MessageId?Ed.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",Jd.Errors[0].MessageId):Ed.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",Jd.Errors[0].MessageId);qd=qd.data.state;qd.u9c(Jd,qd.userContext,qd.methodName)}};this.qAd=function(qd){if(0<xc.Tba&&qd.data.id===xc.Tba){var Jd=Dj.a.pg(qd.data);xc.wg&&xc.Rna(xc.cAa(Jd[0].Description),
1);Ed.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",$g.a.Wc(Jd));Jd=qd.data.state;Jd.saa(qd,Jd.userContext,Jd.methodName);xc.$.userOperationManager.Wka.operation.Ana(function(){return xc.LMb})}};this.$Hi=function(qd,Jd,De){qd.Errors&&0<qd.Errors.length&&xc.wg?($g.a.c$(qd.Errors)||Ga.a(xc.$).ud.kE(qd.Errors[0].MessageId),xc.Rna(xc.cAa(qd.Errors[0].Description),0),Ed.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",
qd.Errors[0].MessageId)):(Ed.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),xc.bEb(qd,Jd,De,null))};this.ZHi=function(qd){qd=Dj.a.pg(qd.data);xc.wg&&xc.Rna(xc.cAa(qd[0].Description),1);Ed.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",$g.a.Wc(qd));xc.$.userOperationManager.Wka.operation.Ana(function(){return xc.LMb})};this.Kzf=function(qd,Jd){if(Jd)switch(Jd.c0i){case 1:if(xc.wk&&
xc.g3a)switch(qd=xc.g3a.Bc,xc.g3a.stop(),xc.g3a=null,xc.wk.Vv){case 1:xc.Y_c(qd,4800,"ActiveSheet");break;case 0:xc.Y_c(qd,6100,"CurrentSelection");break;case 2:xc.Y_c(qd,7500,"EntireWorkbook")}break;case 0:xc.JFb&&(qd=xc.JFb.Bc,xc.JFb.stop(),2400<qd&&(Jd=Object(jh.a)(new ek.a,{extendedProperties:new Map}),Jd.extendedProperties.set("PaneLoadTime",qd.toString()),Ke.Health.instance.recordQosError(kk.a.jCj,[Sc.a.M4f],!1,!0,!0,!1,Jd)),xc.Av.gdi(function(De){xc.kAj(De)}))}};this.JF=function(qd,Jd){(1===
Jd.su&&xc.qNa===Jd.Lg||2===Jd.su)&&xc.dLd()};this.$=K;this.lia=ea;this.l3=Ta;this.Uyd=Lb;this.rKd=Hh.HelperMethods.n_;this.Pa=new uf.a;this.pFd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.Wxj();this.$$h();this.xei=this.nWg();this.Xpd=hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!Lb&&Lb.V5a()&&hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.Yf.get(116))this.graphServiceEndpoint=
this.$.ya.GraphServiceEndpoint}function f(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function l(){this.onBackToSheet=null}function m(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}function r(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function h(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function w(K,ea,Ta,Lb,xc,qd){var Jd=v.call(this,xc)||this;Jd.Od=!1;Jd.E4f=!1;Jd.uBd=function(De){Jd.vD.uBd(De)};Jd.GBd=function(De){Jd.vD.GBd(De)};Jd.xQi=function(){Ed.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
Jd.wQi=function(De){De=Dj.a.pg(De.data);Ed.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",$g.a.Wc(De))};Jd.JF=function(De,Ve){2===Ve.su?Jd.zv.clear():1===Ve.su&&Jd.zv&&Jd.zv.contains(Ve.Lg)&&(Ed.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",lk.a(Ve.Lg.operation.operationName),Ve.Lg.dequeueUtcTime.getTime()-Ve.Lg.enqueueUtcTime.getTime()),
Jd.zv.remove(Ve.Lg))};Jd.vD=K;Jd.cO=Ta;Jd.$=ea;Jd.sheetName=Lb;Jd.locale=window.navigator.browserLanguage||window.navigator.language||Jd.$.ya.UICultureTag;Jd.JVi=Jd.F2g();Jd.$.userOperationManager.Vu(Jd.JF);Jd.zv=new ua.a;Jd.isUniversalPrintEnabled=qd;return Jd}function n(K,ea){this.sheetPrintOptions=this.sheetName=null;this.sheetName=K;this.sheetPrintOptions=ea}function v(K){this.VCi=[.75,.75,.7,.7,.3,.3];this.IBi=[.75,.75,.25,.25,.3,.3];this.vWj=[1,1,1,1,.5,.5];this.Rae=this.Kfe=this.gde=this.Qce=
this.rje=this.O6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Ym=K;this.oai();this.vai()}function u(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function t(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}function y(){this.marginValue=this.printSettingOption=null}function E(){this.margin=this.D0=this.Eca=this.orientation=this.Vv=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.H1a=!1;this.NoColor=null}function B(K){var ea=
this;this.ribbonCommandInfo=this.wFb=null;this.tLj=function(Ta,Lb,xc){Lb=!!Ta&&!!Ta.RequestTelemetryData;Tg.g(ea.$).Ji&&Tg.g(ea.$).Ji.ola(ea.NKa.oa(ea.ribbonCommandInfo.command),Ta.StateId,Lb?Ta.RequestTelemetryData.EcsOperationDuration:0,Lb?Ta.RequestTelemetryData.EcsRequestDuration:0,Lb?Ta.RequestTelemetryData.WfeRequestDuration:0);Hh.HelperMethods.n_&&ea.iWg(xc)};this.$=K;this.NKa=new nl.a;this.Gva=new nl.a;this.Gva.add(78661008,12);this.Gva.add(275604654,13);this.Gva.add(-13332329,14);this.Gva.add(-837651977,
9);this.Gva.add(-1778266776,10);this.Gva.add(845325699,11);this.Xpd=hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}function z(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function M(){this.Max=this.Min=this.Index=0}function Q(){this.Col=this.Row=null}function P(K){this.sheetName=null;this.sheetName=K}function L(K){this.sheetName=null;this.sheetName=K}function ca(K){this.sharedSheetCell=null;this.sharedSheetCell=K}function U(K){this.sharedSheetCell=
null;this.sharedSheetCell=K}function aa(K,ea){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=K;this.addToPrintArea=ea}function F(K,ea){this.P6=0;this.$7d=!1;this.Vv=K;this.ignorePrintArea=ea}function D(K,ea,Ta,Lb,xc,qd,Jd,De){var Ve=ma.call(this,K,ea,Ta,Lb,xc,hf.EwaSettings.ma(399))||this;Ve.Uca=null;Ve.kaa=null;Ve.Bec=null;Ve.$Sd=!1;Ve.oxa=null;Ve.U$a=null;Ve.Wya=null;Ve.fAa=null;Ve.x5a=null;Ve.oza=1;Ve.zma=1;Ve.h0=0;Ve.P6=1;Ve.GGb=!1;Ve.vs=null;Ve.zJb=0;Ve.yJb=0;Ve.Xya=null;Ve.gAa=
null;Ve.selectedRange=null;Ve.i0=0;Ve.x9a=function(){Ve.i0++;Ve.P6=Ve.CZc();Ve.Z7c(Ve.kaa.checked?!0:!1);Ve.G7&&(Ve.Bec.disabled=Ve.yw.checked);Ve.yOd(Ve.kaa.checked?!0:!1);Ed.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",Ve.P6.toString());return!0};Ve.ruf=function(){Ve.i0++;Ve.GGb=Ve.x5a.checked;Ed.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",Ve.GGb.toString())};Ve.Qmc=
function(){Ve.i0++;Ve.oza=Ve.yve();Ed.ULS.sendTraceTag(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",Ve.oza.toString());return!0};Ve.suf=function(){Ve.i0++;var sg=Ve.zma;Ve.zma=D.paperSizeOptions[Ve.Wya.selectedIndex];Ed.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",sg.toString(),Ve.zma.toString());return!0};Ve.tuf=function(){Ve.i0++;var sg=Ve.h0;Ve.h0=D.scalingOptions[Ve.fAa.selectedIndex];2===Ve.h0?
(Ve.zJb=1,Ve.yJb=0):3===Ve.h0?(Ve.zJb=0,Ve.yJb=1):1===Ve.h0&&(Ve.zJb=1,Ve.yJb=1);Ed.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",sg.toString(),Ve.h0.toString());return!0};Ve.rAd=function(sg){if(sg&&sg.data&&sg.data.ke&&sg.data.responseHeaders&&sg.data.ke.length){if(sg.data.responseHeaders["Content-Type"]&&bh.a.contains(sg.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){Ed.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");
var mh={};Ve.bEb(mh,null,null)}else mh=Zk.a.mi(sg.data.ke),Ed.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",mh.Errors[0].MessageId);sg=sg.data.state;sg.u9c(mh,sg.userContext,sg.methodName)}else Ed.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",sg?sg.data?sg.data.ke?sg.data.responseHeaders?sg.data.ke.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":
"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};Ve.qAd=function(sg){var mh=Dj.a.pg(sg.data);Ed.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",$g.a.Wc(mh));mh=sg.data.state;mh.saa(sg,mh.userContext,mh.methodName)};Ve.bEb=function(sg){sg.Errors&&0<sg.Errors.length?Ed.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",
sg.Errors[0].MessageId):(6===Ve.Rd.Ye&&he.AFrameworkApplication.ta.Re.fk(Tg.g(Ve.$).MVf),Ed.ULS.shipAssertTag(537154309,0,!!Ve.$.xa.qa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),Ve.$.xa.qa&&Ve.lia.E3f(Ve.JHa()))};Ve.lia=qd;Ve.activeCell=Ve.$.qa.activeCell.toString();Ve.Um.SelectedRanges&&Ve.Um.SelectedRanges.Ranges&&0<Ve.Um.SelectedRanges.Ranges.length&&Ve.Um.SelectedRanges.Ranges[0]&&(Ve.selectedRange=sd.B(Ve.Um.SelectedRanges.Ranges[0]).toString());
Ve.sheetName=Jd;Ve.cO=De;Ve.$Cd={};K=0;for(ea=D.paperSizeOptions.length;K<ea;++K)Ve.$Cd[D.paperSizeOptions[K].toString()]=K;Ve.locale=window.navigator.browserLanguage||window.navigator.language||Ve.$.ya.UICultureTag;Ve.G7=hf.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");return Ve}function J(K,ea){this.printSettings=this.sheetName=null;this.sheetName=K;this.printSettings=ea}function R(K,ea,Ta,Lb,xc){K=ma.call(this,K,ea,Ta,Lb,xc)||this;K.dtb=null;return K}
function Z(K,ea,Ta,Lb,xc,qd,Jd,De){De=K.Na(1,void 0===De?null:De);De.sheetName=ea;De.locale=Ta;return qe.i(K,"GetPrintSettings",De,Lb,xc,qd,Jd,4)}function W(K,ea,Ta,Lb,xc,qd,Jd){Jd=K.Na(1,void 0===Jd?null:Jd);Jd.ConvertInParameters=ea;return qe.i(K,"ConvertWorkbookToPrintPdf",Jd,Ta,Lb,xc,qd,4)}function ka(K,ea,Ta,Lb,xc,qd,Jd,De){De=K.Na(9,void 0===De?null:De);De.sheetName=ea;De.printSettings=Ta;return qe.i(K,"SetSheetPrintSettings",De,Lb,xc,qd,Jd,0)}function ma(K,ea,Ta,Lb,xc,qd){K=Pj.call(this,K,
ea,Ta,void 0===qd?!1:qd)||this;K.yw=null;K.Um=Lb;K.qRb=xc;return K}function pa(){this.g5d=this.tb=null}function xa(K,ea,Ta,Lb,xc,qd,Jd,De,Ve,sg){this.MXb=null;this.jng=K;this.pkb=ea;this.WNc=Ta;this.Aqg=Lb;this.grg=xc;this.mPc=new zg.a(Object(rf.a)(this,this.NUh,"getProbeResults"));this.xVa=qd;this.fae=Ve;this.vwg=Jd;this.hrg=De;this.org=sg}function va(K,ea){this.f7f=K;this.USa=ea}function ta(K){this.isEnabled=Boolean.parse(K.DirectPrintIsEnabled||"false");Boolean.parse(K.DirectPrintProbeIsEnabled||
"false");this.Gii=Boolean.parse(K.DirectPrintEnabledForInternetExplorer||"false");this.TSa=(K.DirectPrintSupportedMimeTypes||"").split(ta.z6c);this.USa=(K.DirectPrintSupportedPlugins||"").split(ta.z6c);this.$7h=(K.DirectPrintImmersivePreviewPlugins||"").split(ta.z6c);this.tcf=Boolean.parse(K.DirectPrintEnabledForEdge||"false");this.mfi=Boolean.parse(K.ChromePrintLayoutFixIsEnabled||"false");this.gXg=parseInt(K.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Hwd=14;this.Ppf=14394;if(K=K.DirectPrintMinimalSupportedEdgeVersion){var ea=
K.split(".");2===ea.length?(this.Hwd=parseInt(ea[0]),this.Ppf=parseInt(ea[1])):Ed.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",K)}else Ed.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}function fa(K,ea,Ta,Lb,xc){Ta=void 0===Ta?null:Ta;Lb=void 0===Lb?!0:Lb;xc=void 0===xc?!1:xc;ea=Cf.call(this,K,!0,!(fa.RTa&&Lb),new rg(K,ea),Ta,xc)||this;fa.RTa=fa.RTa&&Lb;if(fa.RTa){Lb=
document.createElement("iframe");xc=null;var qd=ea.Beh;Lb.name="pdfObjectFrame";Lb.id="pdfObjectIFrame";if(Ta&&0<Ta.count){var Jd=Ng.a.Ufd(K,Ta);K=Ng.a.NId(K,Ta);xc=document.createElement("form");xc.id="printPreviewPostForm";xc.method="POST";xc.target=Lb.name;xc.action=K;K=El(Jd);for(Ta=K.next();!Ta.done;Ta=K.next())Ta=Ta.value,Jd=document.createElement("input"),Jd.type="hidden",Jd.name=Ta.key,Jd.value=Ta.value,xc.appendChild(Jd)}else Lb.src=K;qd.appendChild(Lb);xc&&(qd.appendChild(xc),xc.submit());
Sys.UI.DomElement.addCssClass(Lb,"DirectPrintPdfObjectHidden");Th.a.yh(Lb,Th.a.mC,Th.a.Mj)}return ea}function Ca(K){this.AP=K}function Sa(K,ea,Ta,Lb){Lb=void 0===Lb?null:Lb;var xc=cj.call(this)||this;xc.Vpa=null;xc.$l=null;xc.HP=null;xc.en=[];xc.gVb=ea;xc.AP=K;xc.wpg=Ta;xc.tWb=Lb;xc.Ulb=new ui.a("LoadResource","LoadPrintablePdf");return xc}function Gb(K){var ea=bj.call(this)||this;ea.$=K;ea.Tb();return ea}function kb(K){this.stopwatch=this.z_b=this.Rzc=this.kVd=null;this.g8f=0;this.$=K;(this.WWc=
hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||K.da.Ga(322,this)}function lb(K){this.Yhe=0;this.h8f=K}function Nb(K,ea,Ta,Lb,xc,qd,Jd){this.title=K;this.body=ea;this.V_i=Ta;this.primaryButtonAction=Lb;this.secondaryButtonAction=qd;this.nWf=xc;this.targetObject=Jd}function Aa(K){var ea=Oh.call(this)||this;ea.$=K;ea.Tb();return ea}function qa(K){this.$=K;K.da.Ga(309,this)}function Xa(K){var ea=xg.call(this,K)||this;ea.Zo=null;ea.stopwatch=null;ea.DBi=function(Ta){if(1===Ta)ea.$.Ka.Xb(new Xj.a(-2050946363,
Ua.a.Ub,2,8,null)).continueWith(function(xc){ea.Zo.setResult(!gc.a(xc)&&xc.result)}),Ta="Yes";else{var Lb=2===Ta;ea.Zo.setResult(Lb);Ta=2===Ta?"No":"Close";Lb&&ea.J_i()}ea.Kui(Ta);ea.hide()};return ea}function Ha(){}function Ra(K){return Bf.call(this,K)||this}function mb(K){this.Di=K}function La(K){var ea=sf.call(this)||this;ea.$=K;ea.Tb();return ea}function ha(K){K.da.Ga(446,this)}function Ia(K){return Ie.call(this,K)||this}function gb(K,ea){var Ta=this;this.sortOptions=this.Ayc=this.selectedRange=
null;this.Pbf=!1;this.activeCell=this.$f=this.Db=this.Fc=null;this.ORi=function(Lb,xc){Bi.b(Lb,-901005882)?(Ga.a(Ta.$).ud.kE(-901005882),Ta.QFd(xc)):Ta.M6e(Lb)?Ta.y5e(Lb.Errors[0]):!Bi.a(Lb)&&Lb.Result&&(Ta.sortOptions=xc,Ta.Ayc=sd.D(Lb.Result.ActualSortRange),Ta.sjf=Ta.ha().hia,Ta.Pbf||(Ta.selectedRange=Ta.ha().sa.qd,Ta.selectedRange.equals(Ta.Ayc)||Ta.MAj()),Ta.sortOptions&&Ta.sortOptions.ActiveCell&&(Lb=Ta.sortOptions.ActiveCell,Lb=new hk.Range(Lb.FirstRow+1,Lb.FirstColumn+1,Lb.FirstRow+1,Lb.FirstColumn+
1,!0,!1),Ta.CL(Lb),Ta.WWd(Lb)))};this.onContentReady=function(){Ta.sNf(!1);var Lb=Ta.ha();Lb.sa.Ig&&Lb.sa.qd.equals(Ta.Ayc)&&Lb.updateSelection(Ta.selectedRange,Lb.sa.activeCell,0,void 0,void 0,void 0,!0)};this.oLi=function(Lb,xc){Lb&&!$g.a.oh(Lb.Errors)&&Ta.Fc&&(Ta.Fc.Uo=Lb.Result,Ta.pKb(),Ta.applyPivotSort(xc))};this.nLi=function(){};this.$=K;this.sjf="";this.namedSheetViewPublic=ea;this.gridView=Tg.g(this.$);this.$.Ob.$g("LoadResource","LoadDialogControlsStopwatch")}function Sb(K,ea,Ta,Lb,xc,qd,
Jd){Jd=K.Na(41,void 0===Jd?null:Jd);Jd.options=ea;return qe.i(K,"Sort",Jd,Ta,Lb,xc,qd,0)}function wc(K){this.filterRange=null;this.filterRange=K}function tc(K){this.selection=null;this.selection=K}function Tb(K,ea,Ta,Lb){var xc=$b.call(this,K)||this;xc.kRd=!1;xc.jgc=!1;xc.I6=[];xc.jdi=function(qd,Jd){var De=xc.r6g(qd);xc.ILa(214,function(Ve,sg,mh){return qe.H(xc.$.na.ua,De,xc.G_a(Ve,xc.JFh(Jd)),xc.AU(sg),mh,null)},16,!0)};xc.idi=function(qd,Jd,De){qd=qe.G(xc.$.na.ua,Jd,xc.tGh(Jd,De),xc.ELi,null,qd);
xc.I6.push(qd)};xc.ELi=function(){Ed.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");xc.N6b(Tb.krb())};xc.t6c=function(qd,Jd){if(1===qd){qd=Jd.sortRangeType;var De={};De.SortOptions=Jd.sortOptions;De.ShouldRestoreSelection=xc.kRd;De.SelectedRange=xc.selectedRange;De.OriginalActiveCell=xc.cpc;De.TopCellAddress=xc.nTa;De.ShouldPromptNamedSheetViewTeachingDialog=hf.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?
0===qd||3===qd:!1;if(!hf.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")&&xc.Ewj(qd)){var Ve=xc.$;xc.namedSheetViewPublic.OAa().continueWith(function(sg){sg.result&&Tb.vKf(Ve,De)})}else Tb.vKf(xc.$,De)}else xc.kRd&&xc.Goa(xc.selectedRange,xc.cpc)};xc.A6h=function(qd,Jd){xc.kRd=!0;xc.Goa(qd,Jd)};xc.getColorName=function(qd){return tl.a.pKa(gl.a.rH(qd))};Ed.ULS.shipAssertTag(529105669,0,!!ea.ActiveCell);Ed.ULS.shipAssertTag(529105668,0,!!ea.SelectedRange);Ed.ULS.shipAssertTag(529105667,
0,sd.D(ea.SelectedRange).contains(sd.C(ea.ActiveCell)));Ed.ULS.shipAssertTag(529105666,0,bh.a.equals(ea.SelectedRange.SheetName,ea.ActiveCell.SheetName,!0));hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(xc.ecb=new db.a(K,Ba.a.Aah,function(){return xc.jgc},1));xc.selectedRange=ea.SelectedRange;xc.cpc=ea.ActiveCell;xc.ITg=ea.ExpandSelection;xc.namedSheetViewPublic=Ta;xc.nTa=Lb;xc.initializeAndShow(Kc.a.instance.fa(182),xc.t6c,xc.kta(ea));return xc}function pb(K,ea){K=
X.call(this,K,ea)||this;K.HCb=K.zcd();K.Gr();return K}function cb(K,ea){var Ta=K.SortRange;K=K.SortTopToBottom?Ta.LastColumn-Ta.FirstColumn:Ta.LastRow-Ta.FirstRow;return 0<=ea&&ea<=K}function ob(K,ea){if(!K.SortColumnInfoItems)return Ed.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var Ta=new ua.a,Lb=El(K.SortColumnInfoItems),xc=Lb.next();!xc.done;xc=Lb.next()){xc=xc.value;if(!cb(K,xc.ColumnOffset))return Ed.ULS.sendTraceTag(537151617,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",xc.ColumnOffset,K.SortRange),!1;if(!xc.Name)return Ed.ULS.sendTraceTag(537151616,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",xc.ColumnOffset),!1;if(xc.CellColors&&!xc.CellColors.length)return Ed.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",xc.CellColors.length),!1;if(xc.TextColors&&
!xc.TextColors.length)return Ed.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",xc.TextColors.length),!1;if(xc.Icons&&!xc.Icons.length)return Ed.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",xc.Icons.length),!1;Ta.add(xc.ColumnOffset)}if(K.SortConditions)for(Lb=El(K.SortConditions),xc=Lb.next();!xc.done;xc=Lb.next())if(xc=xc.value,!Ta.contains(xc.RowColOffset))return Ed.ULS.shipAssertTag(537151584,
0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",xc.RowColOffset),!1;if(K.HeaderColumnInfoItems){if(K.HeaderColumnInfoItems.length!==K.SortColumnInfoItems.length)return Ed.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Ta=0;Ta<K.HeaderColumnInfoItems.length;++Ta){Lb=K.HeaderColumnInfoItems[Ta];if(ea&&Lb.ColumnOffset!==K.SortColumnInfoItems[Ta].ColumnOffset)return Ed.ULS.shipAssertTag(537151582,
0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(Lb.CellColors&&1<Lb.CellColors.length)return Ed.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(Lb.TextColors&&1<Lb.TextColors.length)return Ed.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),
!1;if(Lb.Icons&&1<Lb.Icons.length)return Ed.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0}function rc(K){if(!K.SortConditions)return!0;for(var ea=El(K.SortConditions),Ta=ea.next();!Ta.done;Ta=ea.next()){Ta=Ta.value;if(!cb(K,Ta.RowColOffset))return Ed.ULS.sendTraceTag(537151620,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",Ta.RowColOffset,
K.SortRange),!1;if(1===Ta.SortConditionType&&Ta.FillGradient&&!Ja.isValid(Ta.FillGradient))return Ed.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0}function Db(K){return K.SortRange?4===K.SortRangeType?(Ed.ULS.sendTraceTag(537151622,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",K.SortRangeType),!1):2===K.SortRangeType&&K.SortTopToBottom&&(null==K.HeaderRowSize||
0>K.HeaderRowSize)?(Ed.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(Ed.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1)}function Ja(){}function Qb(K,ea,Ta,Lb){new Sys.UI.Point(K,ea);new Sys.UI.Point(Ta,Lb)}function yc(){}function Cd(K,ea,Ta,Lb){K=K.HeaderColumnInfo;return Lb||K?2===ea&&Ta?K.CellColors&&1!==K.CellColors.length?
(Ed.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):K.TextColors&&1!==K.TextColors.length?(Ed.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):K.Icons&&1!==K.Icons.length?(Ed.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),
!1):!0:K?(Ed.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",Ta),!1):!0:!0}function bc(K,ea){K=K.ColumnInfo;switch(ea){case 1:return K.CellColors&&K.CellColors.length?!0:(Ed.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),
!1);case 2:return K.TextColors&&K.TextColors.length?!0:(Ed.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return K.Icons&&K.Icons.length?!0:(Ed.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return Ed.ULS.sendTraceTag(537151628,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function Kb(K){var ea=this;this.Aw=function(Ta){switch(Ta){case 0:ea.RNa("Cancel");break;case 1:ea.RNa("Expand and sort");ea.tRe(!0);break;case 2:ea.RNa("Just sort"),ea.tRe(!1)}};this.tRe=K}function ic(K,ea,Ta,Lb,xc,qd,Jd){Jd=K.Na(41,void 0===Jd?null:Jd);Jd.filterRange=ea;return qe.i(K,"ReapplyAutoFilter",Jd,Ta,Lb,xc,qd,0)}function wb(K){this.options=null;this.options=K}function Wa(K){return fl.call(this,
K)||this}function Xb(K,ea,Ta){var Lb=wk.call(this)||this;Lb.Ove=!1;Lb.Nve=!1;Lb.rGi=function(){Lb.Ove=!0;Lb.I2f()};Lb.$=K;Lb.Ra=ea;Lb.cK=Ta;Ga.a(Lb.$).LHd(new Tk.a(oh.a.Dbg,oh.a.idle,Xb.EVg),new Ji.a(oh.a.nze,oh.a.Q_,null,oh.a.dP,oh.a.idle));return Lb}function Gc(K){var ea=Pk.call(this,K,Kc.a.instance.fa(1241))||this;ea.textBox=null;ea.fRa=null;ea.CTa=null;ea.CDf=function(){var Ta=ea.$;ea.Ut();var Lb=new zb(Ta,1244,1245,1246,function(xc,qd,Jd){var De=Ta.na.ua.hc(),Ve=Ta.na.ua;De=Ve.Na(1,De);return qe.i(Ve,
"UnshareForm",De,xc,qd,Jd,null,0)},16);Lb.initialize();Lb.kf()};return ea}function zb(K,ea,Ta,Lb,xc,qd){qd=void 0===qd?0:qd;K=Ck.call(this,K,Kc.a.instance.fa(ea),!1)||this;K.message=Ta;K.ZEi=Lb;K.t_d=xc;K.operationFlags=qd;return K}function hc(K,ea,Ta){var Lb=I.call(this,K,new Sys.UI.Point(hc.tch,hc.Wbh),Kc.a.instance.fa(ea?1239:1238))||this;Lb.M0a=null;Lb.rLc=!1;Lb.Ooc=function(xc){function qd(sg,mh,Zh){return qe.F(Jd.na.ua,Lg.b(sg,Lb.YQi),mh,Zh,De)}var Jd=Lb.$,De=new Uc;De.GH=xc.Values[jb.GH];var Ve=
!1;switch(xc.MessageId){case jb.B0f:Lb.Ut();Ve=!0;De.lEd=1334518759;break;case jb.view:Lb.rBa=Kc.a.instance.fa(1239);Lb.zdg(!0);break;case jb.fze:Lb.Ut(),Ve=!0}hf.EwaSettings.qc()?(xc=new $c.a(140,0,qd),xc.flags=Ve?16:80):(xc=Ve?new $c.a(140,0,qd):new Uj.a(140,0,qd),xc.flags=16);Jd.userOperationManager.ic(xc,Lb.Rd)};Lb.$Ii=function(){var xc=Lb.$;xc.ya.SurveyRedirectUrl?(Lb.Ut(),xc.Xd(1305810481,0,8,null)):(Lb.rBa=Kc.a.instance.fa(1238),Lb.zdg(!1))};Lb.lRi=function(){var xc=Lb.$;Lb.Ut();xc.Xd(1334518759,
0,8,null)};Lb.Ouf=function(xc){var qd=Lb.$;Lb.Ut();xc.MessageId===jb.pze&&qd.ea.Gbd()};Lb.GPi=function(){Lb.rLc=!0;Lb.raiseEvent(hc.ktd)};Lb.YQi=function(xc,qd){if(!Bi.a(xc)){xc=Lb.$;if(qd.GH){var Jd=xc.ea.xa;if(Jd.contains(qd.GH.SheetName))Lb.Bnc(qd);else{var De=null;De=function(){Jd.Pma(De);Lb.Bnc(qd)};Jd.Oga(De)}}1461300262!==qd.lEd&&xc.Xd(qd.lEd,0,8,null)}};Lb.L9d=ea;Lb.Rd=Ta;return Lb}function Uc(){this.GH=null;this.lEd=1461300262}function jb(){}function $a(K){K=I.call(this,K,new Sys.UI.Point(960,
680),Kc.a.instance.fa(1234))||this;K.name=A.a.FKe;return K}function I(K,ea,Ta,Lb){var xc=aj.call(this,K,Ta,2,void 0===Lb?null:Lb)||this;xc.dKc=null;xc.onResize=function(){var qd=xc.kQh();xc.rLa.setAttribute("width",qd.x.toString());xc.rLa.setAttribute("height",qd.y.toString());xc.mQj(qd);xc.KAd()};xc.Mkh=function(){var qd=xc.Qx.parentNode.style,Jd=qd.top;qd.top="2px";qd.top=Jd};xc.FGe=ea;xc.$.QA(xc.onResize);xc.Udc();return xc}function ba(K){return kl.call(this,K)||this}function sa(K){this.$=K}function Oa(K,
ea,Ta,Lb,xc,qd,Jd,De){De=K.Na(9,void 0===De?null:De);De.sheetName=ea;De.directionRtl=Ta;return qe.i(K,"ChangeSheetDirection",De,Lb,xc,qd,Jd,0)}function qb(K,ea,Ta,Lb,xc,qd,Jd,De){De=K.Na(9,void 0===De?null:De);De.sheetName=ea;De.show=Ta;return qe.i(K,"ShowHeadings",De,Lb,xc,qd,Jd,0)}function Qa(K,ea,Ta,Lb,xc,qd,Jd,De){De=K.Na(9,void 0===De?null:De);De.sheetName=ea;De.show=Ta;return qe.i(K,"ShowGridlines",De,Lb,xc,qd,Jd,0)}function ib(K,ea){this.sheetName=null;this.value=!1;this.sheetName=K;this.value=
ea}function Mb(K,ea){var Ta=dl.call(this)||this;Ta.activityName=K;Ta.EM=ea;Ta.Tb();return Ta}function Jb(K,ea,Ta,Lb,xc){K=Ok.call(this,K,ea)||this;Jb.Cvd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];Jb.Bvd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];Jb.eof=[-1468309555,611268539,-1750576502,61029505];Jb.dof=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];K.jyc=Ta;K.hBj=Lb;K.qKj=xc;return K}function Zb(){var K=
jl.call(this)||this;K.Tb();return K}function ub(K,ea){return pl.call(this,K,ea)||this}function Za(K){var ea=Rk.call(this)||this;ea.$=K;ea.Tb();return ea}function vc(K,ea){this.$=K;this.Di=ea;this.$.da.Ga(393,this)}function zc(K){var ea=il.call(this,K)||this;ea.mDh=function(Ta,Lb,xc,qd,Jd){return 1===xc?32:Ta===Sf.a.ZQa&&2===xc?(Ta=ea.$.na.ua.hc(),qe.ab(ea.$.na.ua,Jd[0],Jd[1],null,null,Ta),32):8};return ea}function kd(K,ea){this.$=K;this.Di=ea}function wa(K){return Ij.call(this,K)||this}function Na(K,
ea){var Ta=this;this.fBf=function(Lb,xc){if(!Bi.a(Lb)&&xc){var qd=!!Lb&&!!Lb.RequestTelemetryData;Tg.g(Ta.$).Ji.ola(xc,Lb.StateId,qd?Lb.RequestTelemetryData.EcsOperationDuration:0,qd?Lb.RequestTelemetryData.EcsRequestDuration:0,qd?Lb.RequestTelemetryData.WfeRequestDuration:0)}};this.sHi=function(Lb,xc){xc&&xc.x0b&&xc.x0b.SheetName&&xc.x0b.Ranges.length&&xc.yfi&&hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(Lb=sk.d(Ta.$.xa.qa),Ta.IZg(new Nk.a(sd.B(xc.x0b.Ranges[0]),
Lb)))};this.$=K;this.Ug=ea}function Vb(K,ea){var Ta=cl.call(this,K)||this;Ta.Gvb=function(Lb){Lb=Ta.cfd(Lb);return Ta.tcd(Lb)};Ta.Wfj=function(Lb,xc){var qd=Ta.kAb=xc[Vb.kgi];1===Lb?(Lb=xc[Vb.pBj],qd=Ta.s3e(Lb,qd),Ed.ULS.shipAssertTag(537153996,0,qd!==Vb.rba,"ResizeHeadersDialogHandler - invalid size input, size = {0}",Lb),Lb=qd!==Ta.Nld,Ed.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",Ta.isRow,Ta.kAb,
qd,Lb),Lb&&Ta.d4g(qd)):Ed.ULS.sendTraceTag(537153994,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",Ta.isRow)};Ta.isRow=2040891415===ea.command;Ta.gridView=Tg.g(Ta.$);Ta.Utc=new Ob(Ta.$.workbookContext.DxDigitNormal);Ta.Nld=Ta.gTg();K=Ta.Q2g(Ta.Nld);ea=Ta.S2g(Ta.Nld);Ta.Hm=Kc.a.instance.fa(Ta.isRow?479:480);K=Ta.GV(K,ea);Ta.initializeAndShow(Ta.Hm,Ta.Wfj,K);Ed.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",Ta.isRow);return Ta}function pc(K){this.resizeParameters=
null;this.resizeParameters=K}function hd(K,ea){this.isRow=!1;this.autoFitRange=null;this.isRow=K;this.autoFitRange=ea}function Ud(){var K=Lk.call(this)||this;K.Tb();return K}function Zc(K,ea){var Ta=dk.call(this,ea.domElement)||this;Ta.OSf=!1;Ta.lY=!1;Ta.JSa=null;Ta.O7a=null;Ta.fm=null;Ta.PKd=!0;Ta.offset=0;Ta.ql=0;Ta.xJb=0;Ta.Y0=null;Ta.hX=null;Ta.bN=null;Ta.z5h="headerResizeTooltip";Ta.Aud=null;Ta.rG=null;Ta.Xza=!1;Ta.sWa=!1;Ta.QXc=!1;Ta.RN=function(Lb){if(Ta.grid.iq)return!1;Lb=Aj.a(Ta.grid.$).je(Lb);
if(3===Lb.yb&&!Ta.ohf(Lb.Ca)||!Ta.zHf(Lb,!1))return!1;Ed.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var xc=Ta.cyc();Ta.Bcd(Lb.clientPoint,xc,!0);Ta.Xza||(ij.a.instance.pa(ag.a.vh,Ta.domElement.ownerDocument.body,Ta.B9a),ck.a.instance.pa(ag.a.yg,Ta.domElement.ownerDocument.body,Ta.B9a),Ta.Xza=!0);Ta.odf()&&Ta.lY&&Ta.d9e(Lb);return!1};Ta.dEb=function(Lb){Lb=Aj.a(Ta.grid.$).je(Lb);Ta.odf()&&Ta.QXc&&Ta.d9e(Lb);if(hf.EwaSettings.isChangeGateEnabled("OfficeVSO:6093232_ResizeRowColUsingTouch")){if(!Lb.Ca.type.includes("touch")&&
Lb.Ca.button!==Sys.UI.MouseButton.leftButton||!Ta.Y6a)return!1}else if(Lb.Ca.button!==Sys.UI.MouseButton.leftButton||!Ta.Y6a)return!1;yh.g(Lb.Ca);Ta.fLe();Lb=af.a.O5a;Ta.fm&&(Lb=Ta.sWa?Ta.$dd():Ta.fm.tja());var xc=Lb!==Ta.ql;if(Ta.JSa&&xc&&Lb!==af.a.O5a){Lb=Ta.grid;xc=Ta.pgd(Lb);var qd={};qd.SheetMultiRange=sd.r(xc,Lb.$);Zc.lPd(qd,Ta.isRow,Ta.ql);Ta.Akh(qd);Lb.DGj=!0}else Ta.Kg(null,null),Ta.NHb();return Ta.sWa=!1};Ta.tca=function(Lb){if(Ta.grid.iq)return!1;Lb=Ii.a.create(Lb.eventName,Lb.Lb,Lb.Ca,
Lb.yb);Lb=Aj.a(Ta.grid.$).je(Lb);if(!Ta.zHf(Lb,!0))return!1;Lb=Ta.grid;var xc=Ta.pgd(Lb);xc=sd.r(xc,Lb.$);Lb.Cb.Nh([Ta.isRow?13:14]);Lb.Cb.lSa();Ta.NHb();var qd={};Lb.$.Xd(Ta.isRow?146338636:1391094586,Ua.a.Ub,30,(qd.autoFitRanges=xc,qd));return!1};Ta.Oxf=function(Lb){Lb=new Sys.UI.DomEvent(Lb);Lb=Ii.a.create(ag.a.qha,Ta.domElement,Lb,2);Lb=Aj.a(Ta.grid.$).je(Lb);Ta.Pxf(Lb.clientPoint,void 0)};Ta.Qxf=function(Lb){Lb=new Sys.UI.DomEvent(Lb);Lb=Ii.a.create(ag.a.qha,Ta.domElement,Lb,2);Ta.dEb(Lb)};Ta.cMi=
function(Lb){Ta.sya(Lb,Ta.fm)};Ta.B9a=function(Lb){Lb=Aj.a(Ta.grid.$).je(Lb);hf.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")&&yh.g(Lb.Ca);return Ta.Pxf(Lb.clientPoint,Lb.Ca)};Ta.VR=function(Lb){if(Ta.grid.iq)return!1;Lb=Aj.a(Ta.grid.$).je(Lb);var xc;if(!Ta.Rff||-1!==Ta.grid.ha.selectionType)return Vh.a(Ta.grid.$).Mq()&&(xc=Ta.Oed(Lb))&&(xc.Pva.style.cursor=""),!1;if(Ta.lY)return Ta.x$e(),!1;xc=Ta.Oed(Lb);if(!xc)return!1;xc.Pva.style.cursor=!Ta.grid.isEditing&&
Ta.Krd(xc)?Ta.isRow?"row-resize":"col-resize":"";yh.g(Lb.Ca);return!0};Ta.Dp=function(){Ta.NHb()};Ta.Kg=function(){if((3===Ua.a.Ub||Af.a.rp)&&Ta.grid.ha.sa.Ig){var Lb=Ta.grid.ha.sa.qd;if(!(!Lb.isRow&&!Lb.ef||!Ta.domElement||Lb.isRow&&Ta.isRow&&!Array.contains(Ta.tf.Qn,Lb.top)||Lb.ef&&!Ta.isRow&&!Array.contains(Ta.tf.Qn,Lb.left))){var xc=Ta.grid.qg(Lb,Ta.tf.zj.paneType);if(xc){if(Ta.grid.iq){var qd=Ta.isRow?Lb.top:Lb.left;Ta.fm=Ta.tf.hs(hk.Range.hd(Lb.top,Lb.left));if(!Ta.fm){Ed.ULS.sendTraceTag(522826880,
2,50,"HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index "+qd+", is row "+Ta.isRow);return}}Ta.rG||Ta.w$g();Lb.isRow&&Ta.isRow?(Id.DOMElementExtensions.setVisible(Ta.rG,!0),Ta.rG.style.top=xc.bottomRight.y-Ta.rG.offsetHeight/2+"px"):Lb.isRow||Ta.isRow||(Id.DOMElementExtensions.setVisible(Ta.rG,!0),Kk.c(Ta.rG.style,Ta.grid.rtl,xc.bottomRight.x-Ta.rG.offsetWidth/2+"px"))}}}};Ta.HF=function(Lb,xc){hf.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&
Ed.ULS.sendTraceTag(521787422,2,50,"HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated "+xc.gM);xc.gM&&Ta.Kpb()};Ta.tf=ea;Ta.isRow=ea.isRow;Ta.rtl=ea.zj.rtl;Ta.grid=K;Ta.Mof=Ta.isRow?af.a.dwd:af.a.Ykc;Ta.v5h=Kc.a.instance.fa(438);Ta.E5h=Kc.a.instance.fa(437);Ta.y5h=Kc.a.instance.fa(439);gh.a(Ta.grid.$,function(Lb){Ta.Aud=Lb.qQ(cd.a.dgj,!1)});Ta.q7i();Ta.grid.ha.OP(Ta.Kg);Ta.grid.ha.S2(Ta.Dp);Ta.grid.Nt(Ta.Kg);Vh.a(Ta.grid.$).vg.Pga(Ta.HF);return Ta}function Ob(K){this.w7c=
K}function Ad(K,ea,Ta,Lb,xc,qd,Jd){this.Pva=K;this.QCb=ea;this.COa=Ta;this.Gjd=Lb;this.Qbb=xc;this.nhf=qd;this.C4h=Jd}function we(){}function Wd(K){var ea=yj.call(this)||this;ea.$=K;ea.Tb();return ea}function qc(K){var ea=this;this.uoa=this.dVe=this.wGb=this.o2a=this.yqc=this.Rca=this.FPa=null;this.Eqd=this.jOb=this.LLd=!1;this.wLb=!0;this.pgc=!1;this.mSd=!0;this.iOb=this.T0a=this.vBe=0;this.nvc={};this.opc={};this.npc={};this.NHf=0;this.h7a=this.K9d=!1;this.r$i=function(){Id.DOMElementExtensions.toggleCssClass(ea.$.kr,
"ewr-presentMode-transition",!1);$removeHandler(ea.o2a,"transitionend",ea.uoa)};this.fj=function(){parseInt(ea.$.uw.style.right,10)!==ea.vBe&&window.requestAnimationFrame(function(){ea.EBc(0);ea.$.vza(mc.a.PZ("PresentModeManager.OnContentAreaResized"))})};this.Jya=function(){var Ta=Object(T.a)(Xf.a,ea.$.qa);if(Ta&&ea.Hz){ea.gridView.Mod=!1;Ta=Ta.headersVisible;var Lb=Tg.g(ea.$).rtl;Id.DOMElementExtensions.toggleCssClass(ea.$.kr,"ewr-presentMode-on-headers-off",!Ta);Id.DOMElementExtensions.toggleCssClass(ea.$.kr,
"ewr-presentMode-on-rtl",Lb);(12!==ea.T0a&&!Ta||32!==ea.T0a&&Ta&&!Lb||0!==ea.T0a&&Ta&&Lb)&&window.requestAnimationFrame(function(){ea.EBc(2)})}};this.zd=function(){ea.Iaf();ea.wh("OnWorkbookOpened");Ed.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};this.Dp=function(){ea.Eqd=!0;ea.xea("OnSelectionStarted")};this.Kg=function(){ea.Eqd=!1;ea.xea("OnSelectionEnded");ea.bVf()};this.gj=function(){ea.xea("OnEditStarted")};this.ug=function(){ea.xea("OnEditEnded")};
this.Tw=function(){if(!ea.pgc){var Ta=hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");ea.xea("OnVisibleAreaChanged",!0,Ta)}};this.PDb=function(){ea.pgc=!0};this.Bp=function(){ea.xea("OnCurrentSelectionModeChanged");ea.bVf();ea.wh("OnCurrentSelectionModeChanged")};this.Sm=function(){ea.xea("OnBlockCacheItemEvicted")};this.zf=function(){ea.xea("OnBlockCacheItemChanged")};this.EF=function(){ea.pgc||ea.xea("OnActiveItemPanesChanged")};this.gi=function(){ea.pgc=
!1;ea.Rca.wh("ActiveSheetChanged");ea.Jya()};this.ZEb=function(Ta,Lb){if(Ta=Object(T.a)(Xf.a,Lb.item))Ta.Upb(16,!0),Ta.Hnb(ea.Jya)};this.aKi=function(){md.Ohi||(ea.yqc&&ea.yqc.Nq&&ea.yqc.hide(),Tg.g(ea.$).isEditing&&Tg.g(ea.$).Jp(!0),ea.Xxc(!1),Ed.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};this.bKi=function(){Ed.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};
this.$=K;this.gridView=Tg.g(this.$);this.Wjj=K.ya.PresentModeRenderUpdateTimeout;this.initialize(K)}function md(){}function bd(K,ea){var Ta=Nj.call(this,K)||this;Ta.B_i=function(){Ta.Rca.hSd(!0)};Ta.Rca=ea;Ta.domElement.classList.add("ewr-presentMode-on");K={};K=(K[bd.Yx]=Ta.Cc,K);Ta.jc=0;Ta.initializeAndShow("",Ta.B_i,K);return Ta}function Xc(K){this.m_a=this.LEd=null;this.$=K;this.gridView=Tg.g(this.$)}function ne(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function ed(){this.height=
this.width=0}function nd(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}function Ub(K){var ea=this;this.ese=this.DPa=this.JEd=this.KEd=this.Qca=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.eqc={};this.dqc={};this.APa=null;this.CGf=0;this.onKeyDown=function(Ta){Ta=Ta.Ca;if(9===Ta.keyCode){var Lb=ea.Qca.querySelectorAll(Id.DOMElementExtensions.sr),xc=Id.DOMElementExtensions.Km(Lb);Lb=Id.DOMElementExtensions.nB(Lb);Id.DOMElementExtensions.una(Ta,
xc,Lb);return!0}return!1};this.Pl=function(){var Ta=[];ea.$.da.$a(337,function(Lb){ea.DPa.getPresentModeFloatieControlsMap().then(function(xc){for(var qd={},Jd=0;Jd<xc.length;Jd++)qd[xc[Jd].controlId]=xc[Jd].modelType;Ta.push.apply(Ta,Lb.Xca.w4a(qd));0<Ta.length&&appChrome.api.dispatch(Ta);ea.njj()})})};this.$=K}function Hc(){}function pd(K){return Zj.call(this,K)||this}function jc(K,ea){this.$=K;this.presentModeManager=ea}function vd(K,ea,Ta,Lb){var xc=rj.call(this)||this;xc.activityName=K;xc.EM=
ea;xc.VJ=Ta;xc.$=Lb;xc.Tb();return xc}function ae(K,ea,Ta){var Lb=Gk.call(this,K,ea)||this;Lb.xi=null;Lb.tri=function(xc){var qd=Lb.Is.ud,Jd=Object(T.a)(6,qd.Ke);var De=xc.jsb;Lb.unsubscribe(function(mh){xc.remove_disposing(mh)});for(var Ve=0,sg=qd.errors.length;Ve<sg;Ve++)-573864504===qd.errors[Ve].MessageId&&qd.nla(qd.errors[Ve]);switch(De){case 1:Jd.ea.YAc=!0;Ed.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");
Lb.zh(Jd.isEditMode?oh.a.DNb:Lb.ech);Lb.Ap();break;case 2:Lb.zh(oh.a.openInExcelClient);Lb.Ap();break;case 0:qd.activityState[ki.a.Ss]=!1,Lb.zh(Lb.VJ),Lb.Ap()}};Lb.ech=ea;Lb.VJ=Ta;return Lb}function $d(K,ea){K=zk.call(this,K,ea)||this;K.Ipa=0;K.Gr();return K}function Bc(K,ea,Ta,Lb){var xc=Yk.call(this)||this;xc.activityName=K;xc.EM=ea;xc.VJ=Ta;xc.$=Lb;xc.Tb();return xc}function Hd(K,ea,Ta){return Pe.call(this,K,ea,Ta)||this}function xb(K,ea){K=Ff.call(this,K)||this;K.password=null;K.Lhf=ea;K.hh();
return K}function rd(K,ea,Ta,Lb){var xc=yk.call(this)||this;xc.activityName=K;xc.EM=ea;xc.VJ=Ta;xc.$=Lb;xc.Tb();return xc}function tf(K,ea,Ta){return Pe.call(this,K,ea,Ta)||this}function Kf(K){var ea=Ff.call(this,K)||this;ea.DLd=5;ea.H9d=!1;ea.passwordToModify=null;ea.BFf=function(){ea.$.isEditMode&&ea.shc&&(Sj.b().l8c("PasswordToModifyPasswordVerifiedTillInteractive"),ea.$.Sl(ea.BFf))};ea.hh();ea.$.nl(ea.BFf);return ea}function Ff(K){var ea=Fk.call(this,K)||this;ea.Ipa=0;ea.L4i=function(Ta,Lb){ea.Fab(Ta,
Lb)};return ea}function Pe(K,ea,Ta){var Lb=ri.call(this,K,ea)||this;Lb.xi=null;Lb.kDd=null;Lb.HWi=function(xc,qd){Lb.SFb(xc,qd)};Lb.VJ=Ta;return Lb}function Xe(K){var ea=Ei.call(this)||this;ea.$=K;K.da.Ga(56,new Kd(K));ea.Tb();return ea}function de(K,ea){return Pf.call(this,K,ea)||this}function Kd(K){var ea=ih.call(this)||this;ea.$=K;ea.Tb();Kd.N0g();return ea}function pe(K,ea,Ta){var Lb=Lf.call(this,!0)||this;Lb.Pa=new uf.a;Lb.zUe=!1;Lb.e7c=!1;Lb.zze=null;Lb.Fm=null;Lb.t3b=null;Lb.od=function(){Yj.a.zg(Ga.a(Lb.$).ud.activityState,
Li.a.ezd)||Lb.xaa.reset()};Lb.ZIi=function(xc){Lb.iRf(xc)};Lb.YIi=function(){Lb.Uyj()};Lb.$=K;Lb.ea=K.ea;Lb.cK=ea;Lb.businessBar=Ta;Lb.ea.hk(Lb.od);Lb.xaa=th.a.nse(Lb.$);Lb.O0g();K.da.Ga(55,Lb);Lb.lga=oi.a.instance.lc("Common.ISystemInitiatedFeedback");return Lb}function Lf(K){this.Ufa=this.v5d=this.eVa=null;this.Gib=!1;this.iNc=this.rce=null;this.kRb=this.WD=this.BWb="";this.application=this.bC=0;this.kGj=this.FUd=!1;this.zTj=K&&he.AFrameworkApplication.ga.ra("OICLaunchDialogIsEnabled");he.AFrameworkApplication.Ib.z4(Sf.a.LQa)||
he.AFrameworkApplication.Ib.fc(Sf.a.LQa,uh.a.frame,Object(rf.a)(this,this.Ygj,"retryOpenInClientAction"));this.n4f=!!he.AFrameworkApplication.ga&&he.AFrameworkApplication.ga.ra("SilentExternalHandler")}function Be(){}function eg(){}function Jc(K){var ea=uj.call(this)||this;ea.uq=K;ea.Pe="ProtocolLaunchingDialog";he.AFrameworkApplication.Qi.b5a&&he.AFrameworkApplication.Qi.Ytc();he.AFrameworkApplication.ta.Qa.Nhd&&ea.ule(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(rf.a)(ea,ea.pnc,
"onGiveFeedbackClick"));Jc.q6e?(ea.jc=12,ea.Dc(1,CommonUIStrings.l_CloseFile),ea.Dc(2,CommonUIStrings.l_OICDialogContinueHere),ea.Dc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(ea.jc=4,ea.Dc(1,CommonUIStrings.l_OICDialogContinueHere),ea.Dc(2,CommonUIStrings.l_OICDialogLaunchAgain));ea.ICb(CommonUIStrings.l_OICDialog2ndTitle,5===ea.uq.nEf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(rf.a)(ea,ea.TFd,"protocolLaunchingDialogResultHandler"),
null);return ea}function Yd(K){var ea=Wh.call(this)||this;ea.$ea=null;ea.YUa=null;ea.Kpa=!1;ea.opa=null;ea.uq=K;ea.gg=Ge.gg;ea.Sse=!0;ea.jc=5;ea.Pe="ProtocolLaunchingDialog";ea.rHc="OICRetryDialog";he.AFrameworkApplication.Qi.b5a&&he.AFrameworkApplication.Qi.Ytc();he.AFrameworkApplication.Qi.Sg(new Rg.a(2,1,5E3,function(){ea.switchToBackupMode()},101));ea.showDialog("",Object(rf.a)(ea,ea.TFd,"protocolLaunchingDialogResultHandler"));ea.DZf();ea.rX("Issues");ea.mUe();Ed.ULS.sendTraceTag(19239262,211,
50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return ea}function Ge(){}function ud(K){var ea=gg.call(this)||this;ea.FCa=null;ea.ZUa=null;ea.Kpa=!1;ea.uq=K;ea.gg=Ye.gg;ea.Sse=!0;ea.jc=5;ea.Pe="OICLaunchDialog";ea.showDialog("",Object(rf.a)(ea,ea.XEi,"oicLaunchDialogResultHandler"));ea.DZf();ea.rX("ProtocolLaunchingDialogTitle");4!==he.AFrameworkApplication.ta.Qa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);
ea.$z(ea.FCa);Ed.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return ea}function Ye(){}function mf(K,ea,Ta,Lb,xc){var qd=document.createElement("img");qd.alt=K;qd.className=mg.getImageClassWithCluster(Ta,Lb);qd.src=ea;qd.setAttribute(Th.a.Td,Th.a.Sr);K=document.createElement("span");K.className="ProtocolLaunchingDialogImg32Container";K.appendChild(qd);qd=document.createElement("span");qd.className="ProtocolLaunchingDialogIconContainer";
qd.appendChild(K);xc.appendChild(qd)}function xe(K,ea,Ta,Lb,xc,qd,Jd){var De=document.createElement("a");De.className="ProtocolLaunchingDialogButtonAnchor";De.className+=" OICDialog";De.id=K;De.setAttribute(Th.a.Td,Th.a.Ws);De.style.padding="0";De.style.margin="0";Lb&&mf(xc,ea,Ta,Lb,De);K=document.createElement("span");K.className="ProtocolLaunchingDialogButtonLabel";K.innerText=xc;De.appendChild(K);De.tabIndex=0;qd&&ng.a.instance.pa(ag.a.click,De,qd);Jd&&te.KeyInputManager.instance.pa(ag.a.Ud,De,
Jd);return De}function Qe(K){return K.Ca.keyCode===pi.a.di||K.Ca.keyCode===pi.a.Moa?(K.Lb.click(),!0):!1}function jg(K){for(var ea=0;ea<K.children.length;ea++){var Ta=K.children[ea];Ta.style.position="relative";Ta.style.top=(Ta.parentNode.offsetHeight-Ta.offsetHeight)/2+"px"}}function je(){}function pf(K,ea,Ta){var Lb=this;this.La=K;this.Nqg=ea;this.oFc=null;(this.JXb=he.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))&&oi.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(xc){Lb.oFc=xc});this.b2=Ta}function qg(K,ea,Ta){this.La=K;this.Kqg=ea;this.b2=Ta}function Gf(K){var ea=Wc.call(this)||this;ea.$=K;ea.Tb();return ea}function Mg(K){var ea=vb.call(this)||this;ea.$=K;ea.Tb();return ea}function dg(K,ea,Ta){Ta=void 0===Ta?!1:Ta;var Lb=sc.call(this,K,ea)||this;Lb.iCb=null;Lb.vBd=function(xc){Lb.unsubscribe(function(qd){xc.remove_disposing(qd)});Lb.zh(oh.a.Jk);Lb.Ap()};
Lb.Hkc=Ta;return Lb}function lc(K){return Tf.call(this,K)||this}function Nc(K,ea){this.Di=ea;this.$=K}function Nd(K){var ea=Ph.call(this)||this;ea.$=K;ea.Tb();return ea}function le(K){return Kh.call(this,K)||this}function ke(K){this.wo="Excel";this.$=K;this.uV=me.a.current}function xd(K,ea,Ta,Lb,xc,qd,Jd){Jd=K.Na(9,void 0===Jd?null:Jd);Jd.sheetName=ea;Jd.confirmationChoice=!0;return qe.i(K,"DeleteSheet",Jd,Ta,Lb,xc,qd,0)}function fc(){}function fe(K){var ea=$e.call(this)||this;ea.e0d=null;ea.g0d=
0;ea.kj=null;ea._state=0;ea.moveNext=function(){try{for(ea._state=1;1===ea._state;)ea.Qu=ea.Qu()}catch(Ta){ea.dispose(),ea.Mda(Ta),ea._state=3}};ea.Cf=K;ea.Qu=ea.ML;ea.moveNext();return ea}function oa(){}function fb(K){return ah.call(this,K)||this}function Rb(K,ea){this.$=K;this.gridView=ea}function dc(K,ea,Ta){var Lb=Ig.call(this,K)||this;Lb.Pmb=0;Lb.Wyb=!1;Lb.y1a=null;Lb.RHe=!1;Lb.Zqb=!0;Lb.QTc=null;Lb.Hm=null;Lb.Pxd=0;Lb.Qxd=null;Lb.Oxd=null;Lb.removeHyperLink=!1;Lb.cellValue=null;Lb.location=
null;Lb.c7h=function(xc,qd){1===xc||2===xc?(Ed.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===xc?"OK":"Remove"),Lb.Qxd=qd[dc.Kri],Lb.Pxd=qd[dc.mlj],Lb.Oxd=qd[dc.Pfh],2===xc&&(Lb.removeHyperLink=!0),Lb.commit()):Ed.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};Lb.GUj=function(xc,qd){return 0!==qd&&xc.length?1===qd?Lb.KYe(sd.y(xc,Lb.ea.xa)||Lb.vBi(xc),760):Lb.KYe(lg.a.jod(xc),762):null};Lb.selectedRange=ea;Lb.hM=Ta;Lb.ea=K.ea;Lb.sheetName=ea.SheetName;Lb.DLa();Lb.tm();Lb.jc=
Lb.Wyb?9:1;Lb.Dc(1,Kc.a.instance.fa(4));Lb.Wyb&&Lb.Dc(2,Kc.a.instance.fa(763));K={};K=(K[dc.Zeh]=Lb.RHe,K[dc.Qfh]=Lb.y1a,K[dc.rzg]=Lb.Pmb,K[dc.szg]=Lb.QTc,K[dc.m3g]=Lb.Zqb,K);ea={};K=(ea[dc.Yx]=Lb.Cc,ea[dc.HUj]=Lb.GUj,ea[dc.mOg]=K,ea);Lb.initializeAndShow(Lb.Hm,Lb.c7h,K);return Lb}function uc(K){return dd.call(this,K)||this}function Bd(K,ea,Ta,Lb){var xc=Bb.call(this)||this;xc.$=K;xc.businessBar=Lb;xc.openInExcelOperation=ea;xc.cK=Ta;return xc}function Od(){}function Td(K){var ea=this;this.i7h="itms-apps://";
this.j7h="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.Lig=function(Ta){1==Ta&&ea.jEc()};this.$=K;this.Px=he.AFrameworkApplication.ta.Qa.Px;this.Lla="ms-excel:ofe|u|"+this.Px;this.um=he.AFrameworkApplication.ga.Ua("AppUrl");Af.a.xba||Af.a.Eh?this.um=this.i7h+this.j7h:Af.a.np&&(he.AFrameworkApplication.ga.ra("UseAppAndroidMarketURL")?(Ed.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.um=he.AFrameworkApplication.ga.Ua("WildFireMarketUrlExcelAndroid")):
Af.a.xzb?this.um=he.AFrameworkApplication.ga.Ua("WildFireUrlChinaStoreAndroid"):4<Af.a.uWc.D8a&&(this.um=he.AFrameworkApplication.ga.Ua("WildFireUrlExcelAndroid")))}function Ze(K){var ea=cg.call(this,K)||this;ea.eI=null;ea.WDb=function(){Ed.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(ea.$.ya.IsMeetingLiveSession)return ea.jEc(),!0;Af.a.np?(Ed.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),ea.Px&&ea.Px.length||
Ed.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),ea.openUrl("intent:"+ea.Px+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+ea.um+";end","_top")):9<=Af.a.Mkd?(Ed.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),ea.openUrl(ea.Lla,"_top"),window.setTimeout(function(){ea.openUrl(ea.um,"_blank")},9E3)):(Ed.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),
ea.openUrl(ea.Lla,"_top"),window.setTimeout(function(){ea.openUrl(ea.um,"_blank")},500));return!0};ea.vya=function(Ta){return Ta.Ca.keyCode===pi.a.di||Ta.Ca.keyCode===pi.a.Moa?(Ed.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Ta.Lb.click(),!0):!1};if(1!==he.AFrameworkApplication.ta.Qa.Sj)return ea;ea.Px=ea.$.workbookContext.ClientUrl;ea.Lla="ms-excel:ofe|u|"+ea.Px;ea.um=he.AFrameworkApplication.ga.Ua("AppUrl");Af.a.xba?ea.um="itms-apps://"+he.AFrameworkApplication.ga.Ua("WildFireUrlExceliOS")+
"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":Af.a.np&&(hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&ea.$.ya.IsMeetingLiveSession?(Ed.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),ea.um=he.AFrameworkApplication.ga.Ua("WildFireMarketUrlExcelAndroid")):Af.a.xzb?ea.um=he.AFrameworkApplication.ga.Ua("WildFireUrlChinaStoreAndroid"):4<Af.a.uWc.D8a&&(ea.um=he.AFrameworkApplication.ga.Ua("WildFireUrlExcelAndroid")+
"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return ea}function vf(){}function wf(K){this.calculateType=0;this.calculateType=K}function Wf(K){this.calculationMode=0;this.calculationMode=K}function ug(K,ea){var Ta=this;this.dialog=null;this.Ovf=function(){Ta.dialog&&Ta.dialog.hide()};this.YEi=K;this.zb=ea;this.zb.rnb(this.Ovf)}function Gg(K,ea){return Cf.call(this,K,void 0,void 0,ea)||this}function Cf(K,ea,Ta,Lb,xc,qd){ea=void 0===ea?!0:ea;Ta=void 0===Ta?!1:Ta;Lb=void 0===
Lb?null:Lb;xc=void 0===xc?null:xc;qd=void 0===qd?!1:qd;var Jd=ab.call(this)||this;Jd.mY=null;Jd.$l=null;Jd.TVa=null;Jd.UVa=null;var De=Jd.UVd?Jd.UVd:CommonUIStrings.l_DefaultDialogTitle;Cf.txb=qd;Jd.fSb=Lb||new rg(K,!0);Jd.fSb.kse(Jd);var Ve=[],sg=[];Cf.Fu&&(Jd.XVc&&Jd.XVc.forEach(function(Bj){Array.add(Ve,Bj)}),Jd.woe&&Jd.woe.forEach(function(Bj){Array.add(sg,Bj)}));ea?Ta?(Jd.jc=4,Jd.Dc(1,Jd.buttonText),Jd.Dc(2,CommonUIStrings.l_DialogClose)):(Jd.jc=6,Jd.Dc(0,CommonUIStrings.l_DialogClose)):Jd.jc=
5;qd=document.createElement("span");Jd.F4c&&(qd.className=Jd.F4c);Lb=document.createElement("a");Lb.innerText=Jd.Pjc;Lb.href=K;Lb.target="_blank";Lb.id=Jd.Ojc;Lb.className=la.AFrame.dpe;var mh=!Af.a.XC&&!!xc&&0<xc.count;if(mh){var Zh=Ng.a.Ufd(K,xc);xc=Ng.a.NId(K,xc);Lb.href="#";Lb.target="_self";Jd.$l=document.createElement("form");Jd.$l.id="printPreviewPostForm1";Jd.$l.method="post";Jd.$l.target="_blank";Jd.$l.action=xc;xc=El(Zh);for(Zh=xc.next();!Zh.done;Zh=xc.next()){Zh=Zh.value;var Ci=document.createElement("input");
Ci.type="hidden";Ci.name=Zh.key;Ci.value=Zh.value;Jd.$l.appendChild(Ci)}}else Jd.$l=null;Jd.$l||Cf.txb?Cf.txb||(K={},Array.add(sg,(K.type="AppLinkProps",K.id=Jd.Ojc,K.text=Jd.Pjc,K.onExecute=function(){Jd.fLf()},K))):(xc={},Zh={},Array.add(sg,(Zh.type="AppLinkProps",Zh.id=Jd.Ojc,Zh.text=Jd.Pjc,Zh.handler=(xc.href=mh?"#":K,xc.target=mh?"_self":"_blank",xc),Zh)));Jd.jOa&&Array.add(Ve,Jd.jOa);Ta?(K=document.createElement("span"),K.innerText=Jd.jOa.replace("{0}",""),qd.appendChild(K)):Jd.Gpf?(K=document.createElement("span"),
K.id=Jd.ni("message"),mh=document.createElement("span"),xc=document.createElement("span"),Zh=Jd.jOa.split("{0}"),mh.innerText=Zh[0],xc.innerText=Zh[1],K.appendChild(mh),K.appendChild(Lb),K.appendChild(xc),qd.appendChild(K)):(K=document.createElement("span"),K.innerText=Jd.jOa,qd.appendChild(K),qd.appendChild(document.createElement("br")),qd.appendChild(document.createElement("br")),qd.appendChild(Lb),Cf.txb||Array.add(Ve,"{0}"));Jd.$l&&qd.appendChild(Jd.$l);Cf.Fu&&(Jd.d8a&&(Jd.zBb?Jd.sle(Jd.d8a,Jd.zBb):
(Array.add(Ve,"{0}"),K={},Array.add(sg,(K.type="AppLinkProps",K.id="LearnMoreLinkId",K.text=Jd.d8a,K.onExecute=function(){Jd.Ijc()},K)))),Jd.Hra(Ve,sg));Jd.ICb(De,null,Jd.R8e,null,Object(rf.a)(Jd,Jd.Aw,"dialogHandler"),Cf.Fu?null:qd);Jd.rX(Jd.ni("message"));!Cf.Fu&&Jd.zBb&&Jd.d8a&&(De=document.createElement("div"),De.className="WACDialogLearnMoreLinkContainer",Jd.mY=document.createElement("a"),Jd.mY.innerText=Jd.d8a,Jd.mY.href=Jd.zBb,Jd.mY.target="_blank",Jd.mY.id=Jd.ni("LearnMoreLinkId"),Jd.mY.className=
la.AFrame.dpe,De.appendChild(Jd.mY),ea?Jd.Nb.insertBefore(De,Jd.Nb.lastChild):Jd.Nb.appendChild(De),Jd.rX(String.format("{0} {1}",Jd.ni("message"),Jd.ni("LearnMoreLinkId"))));Jd.bib=Lb;Ta?Jd.$z(Jd.WB):Jd.$z(Jd.bib);Jd.qlf();he.AFrameworkApplication.ta.DX.pa(ag.a.click,Jd.bib,Object(rf.a)(Jd,Jd.hJe,"downloadLinkClicked"),null);Jd.mY&&he.AFrameworkApplication.ta.DX.pa(ag.a.click,Jd.mY,Object(rf.a)(Jd,Jd.Ijc,"learnMoreLinkClicked"),null);Jd.eSb=!1;return Jd}function rg(K,ea){this._url=K;this.Wsg=ea}
function dh(K){return Ef.call(this,K)||this}function fh(K){this.Di=K}function vg(K){var ea=Wb.call(this)||this;ea.$=K;ea.Tb();return ea}function Me(){}function Of(){this.tb=null}function ac(K){this.oLa=this.oab=null;this._initialized=!1;this.xkd=K}function Lc(){this.tb=null}function wd(K,ea,Ta,Lb,xc,qd){ea=Rc.call(this,ea,Ta,Lb,xc,qd)||this;ea.La=K;return ea}function Mc(K,ea,Ta,Lb,xc,qd,Jd){ea=tg.call(this,ea,Ta,Lb,xc,qd,Jd)||this;ea.eog=K;return ea}function ge(K,ea,Ta,Lb){K=of.call(this,K,ea,Ta,
Lb)||this;K.Rsg=ea;return K}function nf(K){var ea=Ae.call(this)||this;ea.jc=1;ea.Dc(1,CommonUIStrings.l_RetryButtonLabel);ea.Dc(0,CommonUIStrings.l_DialogClose);ea.La=K;return ea}function Ee(K,ea,Ta){this.La=K;this.XX=ea;this.qmb=Ta}function ya(K,ea,Ta,Lb){var xc=Ih.call(this)||this;xc.T8=null;xc.OSb=null;xc.La=K;xc.XX=ea;xc.qmb=Ta;xc.Dc(1,CommonUIStrings.l_SaveButtonLabel);xc.gg=Cb.gg;xc.Pe="FileNameDialog-SaveACopy";xc.Lh=Lb;return xc}function Cb(){}function cc(){this.tb=null}function Rc(K,ea,Ta,
Lb,xc){this.T8=this.Cm=this.JCa=null;this.rDa=!1;this.Lh=this.yga=null;this.LSc=K;this.Zkb=ea;this.Js=Ta;this.df=Lb;this.Dh=xc}function yd(K){this.vb=K;this.mFa=K.appSettings.SkyDriveUploadWebServiceBase;this.tA=K.appSettings.FileName;this.zfa=K.Ua("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function od(K,ea,Ta,Lb,xc,qd,Jd){this.lFa=K;this.tA=ea;this.OVa=Ta;this.OSb=Lb;this.uPc=xc;this.zfa=qd;this.Lh=Jd}function ze(K,ea,Ta){this.La=K;this.m2=ea;this.XX=Ta}function gf(K,ea,Ta){var Lb=ci.call(this)||
this;Lb.La=K;Lb.m2=ea;Lb.XX=Ta;Lb.$v=!1;Lb.jc=1;Lb.u7(1);Lb.Dc(1,CommonUIStrings.l_SignIn);Lb.Dc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return Lb}function of(K,ea,Ta,Lb){this.$Vb=null;this.dvg=K;this.vb=Ta;this.Hce=ea;this.oae=new Di.a;this.Dh=Lb}function tg(K,ea,Ta,Lb,xc,qd){this.Lh=null;this.$vg=K;this.m2=ea;this.qmb=Ta;this.vb=Lb;this.GQb=xc;this.Js=qd}function Fe(){}function hh(){var K=Xg.call(this)||this;K.jc=0;K.Dc(1,CommonUIStrings.l_DialogClose);return K}function Dg(){this.mra=
this.LNc=this.GNc=this.tb=null}function pg(K,ea,Ta,Lb,xc){this.Cm=this.JCa=null;this.ZEc=!1;this.xQc=this.T8=null;this.LSc=ea;this.Zkb=Ta;this.Js=Lb;this.df=xc;this.La=K}function Fc(K){this.mFa=K.appSettings.SaveAsToHostWebServiceBase;this.tA=K.appSettings.FileName;this.zfa=K.Ua("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}function jd(K,ea,Ta,Lb,xc,qd,Jd,De){this.lFa=K;this.tA=ea;this.OVa=Lb;this.uPc=qd;this.T8=Ta;this.gwg=xc;this.zfa=Jd;this.Lh=De}function td(K,ea,Ta,Lb){this.Lh=this.Obe=
null;this.eFa=K;this.Js=ea;this.sOc=Ta;this.df=Lb}function ue(K,ea,Ta,Lb,xc,qd,Jd){this.vb=K;this.BIc=Ta;this.La=ea;this.zlb=Lb;this.yib=xc;this.sOc=qd;this.Ilg=Jd}function He(){return yf.call(this)||this}function bf(K,ea,Ta,Lb){var xc=this;this.Oo=this.zkb=null;this.yib=K;this.df=Ta;this.ttg=Lb;this.ADa=new zg.a(function(){return new Uf.a(ea.value,Object(rf.a)(xc,xc.Nvb,"getMoreInfoEventReceived"))})}function Rf(K,ea,Ta,Lb,xc,qd,Jd,De,Ve,sg){this.La=ea;this.vb=K;this.XX=Lb;this.zga=qd;this.Js=xc;
this.df=Ta;this.Hfe=Jd;this.Crg=void 0===De?null:De;this.eFa=void 0===Ve?null:Ve;this.GXa=void 0===sg?null:sg}function ig(K,ea,Ta,Lb,xc,qd,Jd,De,Ve){this.KMc=null;this.tA="";this.zlb=K;this.Js=ea;this.Lh=Ve;this.zga=Ta;this.df=xc;this.Zv=Lb;this.eFa=Jd;this.GXa=De;qd&&(this.KMc=new zg.a(function(){return new Uf.a(qd.value,null)}))}function Vf(){this.properties=this.friendlyPath=this.folderName=null}function Qf(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=
null}function df(K,ea,Ta,Lb,xc,qd,Jd,De){K=Ic.call(this,K,ea,Ta,Lb,xc,qd,De)||this;K.Zy=null;K.BQc=null;K.cqa=null;K.cSg=CommonUIStrings.l_SaveToAnotherFolder;K.gg=hg.gg;K.Pe="FileNameDialog-SaveToSharePoint";K.zlb=Jd;K.Ysg=De;return K}function hg(){}function re(){var K=Gi.call(this)||this;K.jc=0;K.Dc(1,CommonUIStrings.l_DialogClose);return K}function se(){this.tb=null}function wg(K,ea,Ta,Lb,xc,qd,Jd,De){this.Cm=null;this.YWa=this.rDa=!1;this.yga=this.Lh=this.tA=null;this.vb=ea;this.lFa=this.vb.appSettings.SaveAsToHostWebServiceBase;
this.L8d=Lb;this.Zkb=xc;this.Mg=Ta;this.Js=qd;this.Dh=De;this.df=Jd;this.La=K;this.zfa=ea.Ua("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}function Mf(K,ea,Ta){this.zga=Ta;this.BIc=ea;this.vb=K}function zh(K,ea,Ta,Lb,xc,qd){this.La=ea;this.vb=K;this.XX=Lb;this.zga=qd;this.Js=xc;this.df=Ta}function Da(K,ea,Ta,Lb,xc,qd){K=Ic.call(this,K,ea,Ta,Lb,xc,qd)||this;K.gg=Ib.gg;K.Pe="FileNameDialog-SaveAsToHost";return K}function Ib(){}function Ic(K,ea,Ta,Lb,xc,qd,Jd){Jd=void 0===Jd?null:Jd;var De=
Fg.call(this)||this;De.hJ=null;De.La=ea;De.XX=Lb;De.zga=qd;De.vb=K;De.Js=xc;De.df=Ta;De.sib=De.vb.ra("SaveToHostWithExtraCharsInFileName");De.Lh=Jd;De.Dc(1,CommonUIStrings.l_SaveButtonLabel);return De}function Gd(K,ea){this.vb=K;this.La=ea;this.sib=this.vb.ra("SaveToHostWithExtraCharsInFileName")}function Sd(K,ea){var Ta=Hi.call(this)||this;Ta.YWa=!1;Ta.tA=null;Ta.La=K;Ta.sib=ea;Ta.mSa=!1;return Ta}function We(){this.tb=null}function Ne(K){this.am=null;this.Mg=K;this.WPc=3}function Se(K,ea,Ta,Lb){ea=
bb.call(this,K,ea,Ta,Lb)||this;ea.options.advanced.filter=K.Ua("OneDriveApiV72Filter")||"folder,photo";ea.options.advanced.linkType="download";ea.options.multiSelect=he.AFrameworkApplication.$pe;K.ra("OneDriveApiV72CommandModeEnabled")&&(ea.options.commandMode=K.Ua("OneDriveApiV72CommandMode")||"none");K.ra("OneDriveApiV72QosExtraDataEnabled")&&(ea.options.qosExtradata=new Ka(he.AFrameworkApplication.userSessionId));return ea}function Ka(K){this.olsSessionId=this.value=this.key=null;this.olsSessionId=
K}function bb(K,ea,Ta,Lb){ea=ad.call(this,K,ea,Ta,Lb)||this;ea.vkg=K;ea.options={};ea.options.advanced={};ea.options.action="query";ea.options.clientId=ea.ga.Ua("OneDriveApiV72ClientId");ea.options.advanced.trapFocus=!0;return ea}function Yb(K,ea,Ta,Lb,xc){K=ad.call(this,K,ea,Ta,Lb)||this;K.Gce=null;K.aTb=null;K.Fng=xc;K.options={};K.options.clientId=K.ga.Ua("OneDriveApiV7ClientId");K.options.cancel=Object(rf.a)(K,K.qAc,"toggleHostDivVisibility");return K}function Ec(K,ea,Ta,Lb,xc,qd){ea=ad.call(this,
ea,Ta,Lb,qd)||this;ea.Lh=null;ea.m2=K;ea.Uvg=xc;return ea}function ad(K,ea,Ta,Lb){this.qEa=this.s6=null;this.TQc=this.VQc=!1;this.XWa=null;this.vb=K;this.GQb=ea;this.XDa=Ta;this.Js=Lb}function Rd(){}function ce(){var K=Oi.call(this)||this;K.jc=0;K.Dc(1,CommonUIStrings.l_DialogClose);return K}function Ue(){}function jf(K,ea,Ta,Lb){this.xib=K;this.Fqa=ea;this.f2=Ta;this.Tog=Lb}function Hf(K,ea,Ta,Lb,xc,qd,Jd){var De=this;this.Oo=null;this.Sfe=!1;this.Xpa=this.O2d=0;this.wsg=K;this.VWa=ea;this.GUb=Ta;
this.xib=Lb;this.Fqa=xc;this.f2=qd;this.ADa=new zg.a(function(){return new Uf.a(Jd.value,Object(rf.a)(De,De.Nvb,"getMoreInfoEventReceived"))})}function bg(K,ea,Ta,Lb,xc,qd,Jd,De){var Ve=this;this.bGc=null;this.bTc=!0;this.WQb="";this.uxg=0;this.EWa=null;this.uMc=3;this.vb=De;this.f2=K;this.nj=ea;this.fog=Ta;this.klg=Lb;this.jlg=xc;this.ADa=new zg.a(function(){return new Uf.a(qd.value,null)});this.Uog=new zg.a(function(){return new Uf.a(Jd.value,Object(rf.a)(Ve,Ve.cBi,"mruEventResultReceived"))});
this.vb.ra("WacInTabOpenMRUIsEnabledForUiHost");this.vb.ra("UiHostSupportsDocRebootFeatures")}function Dd(){return Uh.call(this)||this}function oc(K,ea,Ta,Lb,xc,qd){var Jd=this;this.eSc=this.Oo=this.XQb=null;this.RWb=this.qRc=!1;this.dbe=0;this.eRc=this.ALc=!1;this.f2=K;this.xib=ea;this.ADa=new zg.a(function(){return new Uf.a(Ta.value,Object(rf.a)(Jd,Jd.Nvb,"getMoreInfoEventReceived"))});this.osg=Lb;this.Fqa=xc;this.Lvg=qd;this.Klb=this.Axc;2===this.IK.kca&&(this.eRc=!0)}function nc(){this.folderName=
this.folderUrl=this.hostName=this.hostUrl=null}function cf(){}function Jg(){}b.r(C);var Re=b(557),ve=b(0),zf=b(255);Jg.prototype.ei=function(){};Jg.prototype.init=function(){};Jg.prototype.dispose=function(){};Jg.main=function(){zf.a.instance.hj(new Jg)};Ek.Object.defineProperties(Jg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});Object(ve.a)(Jg,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var zg=b(615),Ed=b(14),rf=b(82),Uf=
b(1018),lg=b(29),ni=b(130);cf.dkh=function(K){return cf.Gue("New",K)};cf.ekh=function(K){return cf.Gue("Open",K)};cf.rue=function(K,ea){return cf.tha("LoadingMenuSection",cf.Msi,K,cf.jpb("lblLoading",ea))};cf.kpb=function(K,ea,Ta,Lb){return cf.tha("MessageMenuSection",cf.pqf,ea,cf.jpb("lblMessage",K,void 0===Ta?null:Ta,void 0===Lb?null:Lb))};cf.CQg=function(K){return cf.rue(K,CommonUIStrings.l_VoicedLoadingText)};cf.DQg=function(K,ea){return cf.kpb(CommonUIStrings.l_NewCreationLocationMessage,K.Bi,
ea.aS,ea.boa)};cf.BQg=function(K,ea){return cf.kpb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,ea.boa,"\n\n"),K.Bi)};cf.tue=function(K){return cf.kpb(CommonUIStrings.l_NewGenericErrorMessage,K.Bi)};cf.zQg=function(K,ea,Ta){return cf.tha("menuNewBlank",cf.s5h,Ta?K.Bi:null,cf.epb(K.g7e,K.h7e,K.i7e,null,K.$ja,K.Ixb,ea,"blank"))};cf.xRg=function(){return cf.jpb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};cf.Due=function(){return cf.jpb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};
cf.yRg=function(K,ea){return cf.tha("menuNewTemplates",K,null,ea)};cf.xQg=function(K,ea){return cf.tha("menuNewMoreTemplates",cf.yUe,null,cf.epb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,K,ea))};cf.APg=function(K,ea,Ta){var Lb="";Ta&&ea&&(Lb=cf.tha("BrowseMoreMenuSection",cf.yUe,null,cf.epb("btnBrowseMore",ea,ea,null,null,null,K||"1959943459",Ta)));return Lb};cf.jpb=function(K,ea,Ta,Lb){Ta=void 0===Ta?null:Ta;var xc=Lb=void 0===
Lb?null:Lb;ea&&0<ea.length&&(xc=cf.jrf.Qpc(ea).trimEnd(),xc=0<=xc.indexOf("{0}")?String.format(xc,Lb):String.format("{0} {1}",xc,Lb));Ta=Ta&&Lb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',lg.a.nf(Ta),lg.a.nf(Lb),lg.a.nf(xc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',lg.a.nf(K||""),cf.jrf.Qpc(lg.a.nf(ea||"")),Ta)};cf.epb=function(K,ea,Ta,Lb,xc,qd,Jd,De){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
lg.a.nf(K||""),lg.a.nf(ea||""),lg.a.nf(Ta||""),Lb||"32by32",lg.a.nf(xc||""),lg.a.nf(qd||""),Jd,lg.a.nf(De||""))};cf.Gue=function(K,ea){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',K,ea)};cf.tha=function(K,ea,Ta,Lb){Ta=Ta?String.format('Title="{0}"',lg.a.nf(Ta)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
lg.a.nf(K||""),lg.a.nf(ea||""),Ta,Lb)};cf.pqf="MenuMru";cf.Msi="MenuLoading";cf.s5h="MenuHeader";cf.yUe="MenuFooter";cf.jrf=ni.a.Vx("\n","&#10;");Object(ve.a)(cf,"NewAndOpenXmlUtilities",null,[]);var he=b(4),Ke=b(100),Qg=b(165);Object(ve.a)(nc,"HostInformation",null,[]);var Rg=b(108),Oe=b(39),Df=b(390),Zg=b(168),qh=b(741),Xi=b(640),uh=b(107),Sf=b(27);oc.prototype.Qg=function(){var K=this.IK.c9a;K.fc(Sf.a.newDocument,uh.a.frame,Object(rf.a)(this,this.newDocument,"newDocument"));K.Te(Sf.a.iqc,uh.a.frame,
Object(rf.a)(this,this.iqc,"populateNewMenu"),96)};oc.prototype.newDocument=function(K,ea,Ta,Lb,xc){return 1===Ta?32:2===Ta&&xc&&xc.MenuItemId&&xc.SourceControlId?this.G0a(xc.MenuItemId,xc.SourceControlId):8};oc.prototype.G0a=function(K,ea){var Ta=this.Zlc.a4c;if(null===Ta)return 8;var Lb=he.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(he.AFrameworkApplication.Oka&&Lb){Ed.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
var xc={};xc[Df.a.t8f]=K;xc[Df.a.PP]=this.PP;xc[Df.a.lcid]=he.AFrameworkApplication.lcid.toString();xc[Df.a.reason]=qh.a.createNew;he.AFrameworkApplication.HV().execute(function(qd){qd.Hj(Zg.a.G0a,xc)})}else Lb=(new Date).getTime(),ea=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Ta,lg.a.mf(this.Cla),lg.a.mf(K),lg.a.mf(this.PP),lg.a.mf(he.AFrameworkApplication.lcid.toString()),lg.a.mf(Lb.toString()),lg.a.mf(ea),lg.a.mf(he.AFrameworkApplication.canary),
he.AFrameworkApplication.oj),(Ta=he.AFrameworkApplication.ga.Ua("ScenarioId"))&&""!==Ta&&(ea+="&wdscenarioid="+lg.a.mf(Ta)),ea+="&"+he.AFrameworkApplication.kcc(),he.AFrameworkApplication.Owa&&(ea+="&"+he.AFrameworkApplication.Cbc()),(Ta=this.Oo?this.Oo.aS:null)&&(ea+="&DestinationUrl="+lg.a.mf(Ta)),Oe.a.jf(ea,"_blank",void 0,"CreateNewDocument");2===this.IK.kca&&(ea={},Ed.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(ea.AppType=Xi.a[this.IK.kca],ea.Template=K,ea)));return 32};
oc.prototype.Rvi=function(K){var ea=Number.MAX_VALUE,Ta=Number.MIN_VALUE,Lb=window.performance;if(Lb&&"undefined"!==typeof Lb.getEntriesByName){for(var xc=0;xc<K.length;xc++){var qd=Lb.getEntriesByName(K[xc]);qd&&0<qd.length&&(qd=qd[0],ea=Math.min(parseInt(String(qd.fetchStart)),ea),Ta=Math.max(parseInt(String(qd.responseEnd)),Ta))}Ta>ea&&(K={},Ed.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(K.TotalElapsedMs=Ta-ea,K.MinFetchStart=ea,K.MaxResponseEnd=Ta,K)))}};
oc.prototype.iqc=function(K,ea,Ta,Lb,xc){if(1===Ta)return this.eRc&&(he.AFrameworkApplication.tN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.eRc=!1),32;2!==Ta||this.ALc||(this.dbe=(new Date).getTime(),K={},Ed.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(K.ShouldShowTemplates=this.Axc,K.CachedNewMenuXmlExists=!!this.XQb,K.ShouldCallGetMoreInfo=this.IK.supportsGetMoreInfoForPersonalStorage,K)));return this.HYi(xc)};oc.prototype.HYi=function(K){K&&
(this.XQb?K.PopulationXML=this.XQb:(this.IK.supportsGetMoreInfoForPersonalStorage&&!this.Oo&&this.vCi.Az("Opened New menu",!0),K.PopulationXML=this.iHh(this.getTemplateListJson())));return 32};oc.prototype.Hff=function(){return!this.IK.supportsGetMoreInfoForPersonalStorage||!!this.Oo&&3===this.Oo.state&&!!this.Oo.boa&&!!this.Oo.aS};oc.prototype.Wki=function(){return he.AFrameworkApplication.ta&&he.AFrameworkApplication.ta.Qa.q_?!0:this.Hff()};oc.prototype.getTemplateListJson=function(){var K=this;
if(!this.Axc||!this.Wki())return null;if(this.Klb&&!this.RWb){var ea="9",Ta=he.AFrameworkApplication.ga.appSettings;"NumberOfTemplatesInBackstage"in Ta&&(ea=Ta.NumberOfTemplatesInBackstage);var Lb=this.PP;"TemplateCollectionId"in Ta&&(Lb=Ta.TemplateCollectionId);ea=String.format(this.IK.sW+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",lg.a.mf(he.AFrameworkApplication.lcid.toString()),lg.a.mf(Lb),ea);Boolean.parse(Ta.AppendOriginQueryParam||"false")&&(ea+="&org=backstage");ea+="&"+he.AFrameworkApplication.kcc();
he.AFrameworkApplication.Owa&&(ea+="&"+he.AFrameworkApplication.Cbc());this.IK.iDb.El(ea,1,null,null,!1,2,function(xc){K.IK.$ba("CreateNewActor.GetTemplateListJson",xc.data);K.CHj(xc.data.ke)},function(xc){K.IK.$ba("CreateNewActor.GetTemplateListJson",xc.data);K.BHj()},null,void 0,void 0,void 0,void 0,"5");this.Klb=!1}return this.eSc};oc.prototype.CHj=function(K){this.eSc=K;this.Klb=!1;this.sHb();if(he.AFrameworkApplication.ta&&he.AFrameworkApplication.ta.Qa.q_&&Qg.c()){K=he.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
var ea=he.AFrameworkApplication.Oka;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.eSc,!0,K&&ea))}};oc.prototype.BHj=function(){this.RWb=this.Klb=!0;this.sHb();he.AFrameworkApplication.ta&&he.AFrameworkApplication.ta.Qa.q_&&Qg.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));Ke.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};oc.prototype.eZh=function(K){for(var ea=0,Ta=0;Ta<K.length;Ta++)if("ST"===
K[Ta].ImageType){ea=Ta;break}var Lb=K.length?K[ea]:null;K=Lb?Lb.Url||"":"";var xc,qd=Ta=ea=!1;if(Lb&&(xc=Lb.AspectRatio))xc=parseFloat(xc),1>xc?ea=!0:1.5<xc?Ta=!0:1===xc&&(qd=!0);else switch(xc={},Ed.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(xc.Url=K,xc)),this.IK.kca){case 3:ea=!0;break;case 2:Ta=!0;break;case 5:qd=!0}return{returnValue:K,U7h:ea?"95by123":Ta?"123by69":qd?"100by100":"123by95"}};oc.prototype.iHh=function(K){var ea=this.AQg(K,this.Zlc,this.Zlc.GGa||"1056925771");
K=ea.returnValue;if(ea.axc){this.XQb=K;ea=(new Date).getTime()-this.dbe;var Ta={};Ed.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(Ta.ElapsedMsSinceMenuOpened=ea,Ta))}return K};oc.prototype.Nvb=function(K,ea){Ed.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Oo||3!==K.state?2===K.state&&(Ed.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.qRc=!0,this.sHb()):(this.Oo=K,ea||this.sHb(),he.AFrameworkApplication.ta&&
he.AFrameworkApplication.ta.Qa.q_&&Qg.c()&&Qg.d("setFileMenuHostInformation")&&(K=Object.assign(new nc,{hostUrl:this.Oo.aS,hostName:this.Oo.boa,folderUrl:he.AFrameworkApplication.breadcrumbFolderUrl,folderName:he.AFrameworkApplication.breadcrumbFolderName}),Ed.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(K))))};oc.prototype.AQg=function(K,ea,Ta){var Lb=!1;var xc=this.Hff(),qd="";if(this.IK.supportsGetMoreInfoForPersonalStorage)if(this.qRc)qd=
cf.tue(ea),this.qRc=!1,Ed.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");else if(this.Oo)if(xc)qd=cf.DQg(ea,this.Oo);else if(this.Oo.dci)Lb=!0,this.Klb=!1,qd=cf.BQg(ea,this.Oo),Ed.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{Lb=!0;qd=cf.tue(ea);var Jd={};Ed.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",(Jd.PersonalFileStorageUrlIsSet=
!!this.Oo.aS,Jd.StorageServiceDisplayNameIsSet=!!this.Oo.boa,Jd))}else qd=cf.CQg(ea.Bi),Ed.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner");xc&&(xc=qd,ea=cf.zQg(ea,Ta,!qd),K=this.wRg(K,Ta),Lb=K.axc,qd=xc+(ea+K.returnValue));return{returnValue:cf.dkh(qd),axc:Lb}};oc.prototype.wRg=function(K,ea){var Ta=!1;if(!this.Axc)return Ta=!0,Ed.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",axc:Ta};var Lb="",xc="",qd="MenuTemplate";
if(this.RWb)Lb=cf.Due(),this.RWb=!1,Ed.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(K){try{var Jd=Sys.Serialization.JavaScriptSerializer.deserialize(K,!0);Lb=this.vRg(Jd,ea);Ed.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");he.AFrameworkApplication.krf&&"OneDrive"===this.Cla&&(xc=cf.xQg(this.wCi,he.AFrameworkApplication.krf))}catch(De){ea={},Ed.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",
(ea.JsonToConvert=K,ea)),Lb=cf.Due()}Ta=!0}else qd="MenuLoading",Lb=cf.xRg(),Ed.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:cf.yRg(qd,Lb)+xc,axc:Ta}};oc.prototype.vRg=function(K,ea){for(var Ta=this,Lb="",xc=[],qd=0;qd<K.length;qd++){var Jd=K[qd],De="";if(Jd){var Ve=Jd.Title,sg=Jd.AssetId,mh=Jd.Thumbnails;sg&&Ve&&mh&&(Jd=void 0,De=this.eZh(mh),Jd=De.U7h,De=De.returnValue,Lb+=cf.epb("jbtnNewTemplate"+qd,Ve,null,Jd,null,De,ea,sg))}xc[qd]=De}K=
new Rg.a(4,1,5E3,function(){Ta.Rvi(xc)},106);this.IK.Xlc.Sg(K);return Lb};oc.prototype.sHb=function(){this.ALc=!0;this.IK.crf.Uv(this.Zlc.gub);this.ALc=!1};Ek.Object.defineProperties(oc.prototype,{PP:{configurable:!0,enumerable:!0,get:function(){switch(this.IK.kca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},IK:{configurable:!0,enumerable:!0,get:function(){return this.f2.value}},Zlc:{configurable:!0,enumerable:!0,get:function(){return this.xib.value}},
vCi:{configurable:!0,enumerable:!0,get:function(){return this.ADa.value}},wCi:{configurable:!0,enumerable:!0,get:function(){return this.osg.value}},Cla:{configurable:!0,enumerable:!0,get:function(){return this.Fqa.value}},Axc:{configurable:!0,enumerable:!0,get:function(){return this.Lvg.value}}});Object(ve.a)(oc,"CreateNewActor",null,[]);var ji=b(1383),Uh=ji.a;Am(Dd,Uh);Dd.prototype.mme=function(){this.fU(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.fU(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.fU(2,CommonUIStrings.l_Open);this.fU(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.fU(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.fU(5,CommonUIStrings.l_VoicedLoadingText)};Dd.xUi=function(K){return Dd.instance.fa(K)};Ek.Object.defineProperties(Dd,{instance:{configurable:!0,enumerable:!0,get:function(){return Dd.Ma||(Dd.Ma=new Dd)}}});Dd.Ma=null;Object(ve.a)(Dd,"MruActorIntlHelper",ji.a,[]);var sh;(function(K){K[K.success=0]="success";K[K.failure=1]="failure";K[K.spinner=2]="spinner";K[K.none=
3]="none"})(sh||(sh={}));Object(ve.b)("DisplayState",sh);var Jh=b(41);bg.prototype.cBi=function(K,ea){this.EWa=K;ea||this.bNf()};bg.prototype.o8i=function(){this.Uw.c9a.Te(Sf.a.hqc,uh.a.frame,Object(rf.a)(this,this.hqc,"populateMruMenu"),96)};bg.prototype.hqc=function(K,ea,Ta,Lb,xc){return 1!==Ta&&xc?this.EYi(xc):32};bg.prototype.EYi=function(K){this.Jkh();this.Ikh();K.PopulationXML=cf.ekh(this.WQb+this.bGc);return 32};bg.prototype.Jkh=function(){var K=3,ea=!1;if(this.WQb&&this.uxg===this.EWa.mJj)K=
{},Ed.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",(K.CacheRefresh="Not Dirty",K)),K=this.uMc;else{var Ta={};Ed.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(Ta.CacheRefresh="Starting",Ta));Ta=this.Uw.Gw();this.EWa=this.bBi.Az("File Open opened",!0);if(this.WQb&&2!==this.uMc&&3!==this.EWa.state)ea=!0;else{K=this.XWh(this.EWa);he.AFrameworkApplication.ta&&he.AFrameworkApplication.ta.Qa.q_&&Qg.c()&&K&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(K,
!0));var Lb=this.jHh(this.EWa);K=Lb.nCi;this.WQb=Lb.returnValue}Ta=this.Uw.Gw()-Ta;Lb={};Ed.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(Lb.CacheRefresh="Complete",Lb.ElapsedMs=Ta,Lb))}2!==K&&(Ta={},Ta=(Ta.DisplayState=sh[K],Ta),1!==K&&(Ta.IsStale=ea),Ed.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Ta));this.uMc=K};bg.prototype.XWh=function(K){try{var ea=Jh.c(K.bxd)}catch(Ta){ea=null,Ed.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
Ta)}return ea};bg.prototype.Ikh=function(){if(this.bTc){Ed.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var K=this.kxi();this.bTc=K.aWj;this.bGc=K.returnValue}else Ed.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");K={};Ed.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(K.WaitingOnLinkInfo=this.bTc,K.NotDisplayingLink=!this.bGc,K))};bg.prototype.jHh=function(K){if(1===K.state||0===K.state){K={};Ed.ULS.sendTraceTag(5849635,
202,50,"Open menu XML built {0}",(K.Display="Spinner",K));K=2;var ea=cf.rue(this.Hja(2),this.Hja(5))}else 3===K.state&&K.bxd?(ea=this.yQg(K.bxd),K=0):(K={},Ed.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(K.Display="Server Error",K)),ea=cf.kpb(this.Hja(1),this.Hja(2)),K=1);return{returnValue:ea,nCi:K}};bg.prototype.yQg=function(K){var ea=this.ECb.GGa||"2155708348";if(K.length){var Ta=cf.jpb("lblRecentDocuments",this.Hja(3));for(var Lb=0,xc=0;xc<K.length;xc++){var qd=K[xc];"FileName"in
qd&&"DocumentUrl"in qd&&"Path"in qd&&(Ta+=cf.epb("MruButton"+xc,qd.FileName.toString(),qd.Path.toString(),null,this.ECb.$ja,this.ECb.Ixb,ea,qd.DocumentUrl.toString()),qd.IsPinned&&Lb++)}Ta=cf.tha("RecentDocumentsMenuSection",cf.pqf,this.Hja(2),Ta);ea={};Ed.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(ea.Display="MRU List",ea.TotalDocuments=K.length,ea.NumPinnedDocuments=Lb,ea))}else Ta=cf.kpb(this.Hja(0),this.Hja(2)),K={},Ed.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",
(K.Display="Empty MRU",K));return Ta};bg.prototype.kxi=function(){var K=!0;var ea=this.TOg,Ta=this.SOg;if(ea&&Ta||!this.Uw.supportsGetMoreInfoForPersonalStorage)K=!1;else{var Lb=this.Mbc.Az("File Open",!1);3===Lb.state&&(ea=Lb.aS,Ta=Lb.boa,K=!1)}Ta=Ta?String.format(this.Hja(4),Ta):null;return{returnValue:cf.APg(this.ECb.GGa,Ta,ea),aWj:K}};bg.prototype.bNf=function(){this.Uw.crf.Uv(this.ECb.gub)};Ek.Object.defineProperties(bg.prototype,{Uw:{configurable:!0,enumerable:!0,get:function(){return this.f2.value}},
Hja:{configurable:!0,enumerable:!0,get:function(){return this.nj.value}},ECb:{configurable:!0,enumerable:!0,get:function(){return this.fog.value}},TOg:{configurable:!0,enumerable:!0,get:function(){return this.klg.value}},SOg:{configurable:!0,enumerable:!0,get:function(){return this.jlg.value}},Mbc:{configurable:!0,enumerable:!0,get:function(){return this.ADa.value}},bBi:{configurable:!0,enumerable:!0,get:function(){return this.Uog.value}}});Object(ve.a)(bg,"MruRenderer",null,[]);var Dh=b(243),Og=
b(976);Hf.prototype.G0a=function(){!this.Oo&&this.Mxd.supportsGetMoreInfoForPersonalStorage?this.Mbc.Az("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};Hf.prototype.Nvb=function(K){if(!this.Oo&&3===K.state)this.Oo=K;else if(2===K.state){this.Sfe?Ed.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.Mbc.Az("NewDocumentFromStream",!0),this.Sfe=!0);return}this.createNewDocumentFromStream()};Hf.prototype.createNewDocumentFromStream=function(){this.O2d=
(new Date).getTime();var K=this.xzh.a4c;if(null===K)this.VWa(null);else{var ea=this.GUb.menuItemId,Ta=this.GUb.LI,Lb=this.GUb.nFj,xc=this.GUb.Czh;this.Xpa="streamBase64"===Lb?xc.length/1024:0;Ed.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.PP,this.Xpa);var qd=(new Date).getTime();K=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",K,lg.a.mf(this.Cla),lg.a.mf(ea),lg.a.mf(this.PP),lg.a.mf(he.AFrameworkApplication.lcid.toString()),
lg.a.mf(qd.toString()),lg.a.mf(Ta),lg.a.mf(he.AFrameworkApplication.canary),he.AFrameworkApplication.oj,lg.a.mf(Lb));K+="&"+he.AFrameworkApplication.kcc();he.AFrameworkApplication.Owa&&(K+="&"+he.AFrameworkApplication.Cbc());(ea=this.Oo?this.Oo.aS:null)&&(K+="&DestinationUrl="+lg.a.mf(ea));this.Mxd.iDb.El(K,2,xc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(rf.a)(this,this.qCi,"newDocumentFromStreamSuccessHandler"),Object(rf.a)(this,this.pCi,"newDocumentFromStreamFailureHandler"),
null,void 0,void 0,void 0,void 0,"31")}};Hf.prototype.qCi=function(K){if(K&&K.data&&K.data.ke){var ea=Jh.d(K.data.ke);var Ta=ea.dv;ea.returnValue?Ta.StatusCode!==Dh.a.kP&&Ta.StatusCode!==Dh.a.Drb?(Ed.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.PP,this.Xpa,Ta.StatusCode),this.VWa(null)):Ta.NewDocumentUrl&&""!==Ta.NewDocumentUrl?(K=(new Date).getTime()-this.O2d,Ed.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.PP,this.Xpa,K),this.wsg(Ta.NewDocumentUrl)):(Ed.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.PP,this.Xpa),this.VWa(null)):(Ta={},Ed.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.PP,this.Xpa,(Ta.ResponseData=Og.a.Meb(K.data.ke),Ta)),this.VWa(null))}else Ed.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.PP,this.Xpa),this.VWa(null)};Hf.prototype.pCi=function(K){K&&K.data&&Ed.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.PP,this.Xpa,K.data.status);this.VWa(null)};Ek.Object.defineProperties(Hf.prototype,{PP:{configurable:!0,enumerable:!0,get:function(){switch(this.Mxd.kca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},xzh:{configurable:!0,enumerable:!0,
get:function(){return this.xib.value}},Cla:{configurable:!0,enumerable:!0,get:function(){return this.Fqa.value}},Mxd:{configurable:!0,enumerable:!0,get:function(){return this.f2.value}},Mbc:{configurable:!0,enumerable:!0,get:function(){return this.ADa.value}}});Object(ve.a)(Hf,"NewDocumentFromStreamOperation",null,[]);jf.prototype.create=function(K,ea,Ta){return new Hf(K,ea,Ta,this.xib,this.Fqa,this.f2,this.Tog)};Object(ve.a)(jf,"NewDocumentFromStreamOperationFactory",null,[808]);var oi=b(85),$h=
b(566),Ch=b(55);Ue.prototype.ei=function(K){K.register(jf,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").Hc().Oc(function(){return new jf(new zg.a(function(){return he.AFrameworkApplication.ta.Qa.led()}),new zg.a(function(){return he.AFrameworkApplication.Cla}),new zg.a(function(){return K.Kh("Common.INewAndOpenCommonHelpers")}),new zg.a(function(){return K.Kh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};
Ue.prototype.init=function(){var K=this;he.AFrameworkApplication.ga.sv(function(){K.Zxb()})};Ue.prototype.Zxb=function(){var K=$h.a.ar(oi.a.instance.lc("Common.INewAndOpenCommonHelpers")),ea=$h.a.ar(oi.a.instance.lc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));he.AFrameworkApplication.Cla&&Ch.Task.WAA.call(null,K,ea).continueWith(function(){var Lb=new oc(new zg.a(function(){return K.result}),new zg.a(function(){return he.AFrameworkApplication.ta.Qa.led()}),new zg.a(function(){return ea.result}),
new zg.a(function(){return he.AFrameworkApplication.ta.Qa.med().GGa||"1959943459"}),new zg.a(function(){return he.AFrameworkApplication.Cla}),new zg.a(function(){return he.AFrameworkApplication.Fji}));Lb.Qg();Lb.sHb()});if(he.AFrameworkApplication.BLf){var Ta=$h.a.ar(oi.a.instance.lc("Common.IEventEmitter<Common.IMruResult>"));Ch.Task.WAA.call(null,K,ea,Ta).continueWith(function(){var Lb=new bg(new zg.a(function(){return K.result}),new zg.a(function(){return Dd.xUi}),new zg.a(function(){return he.AFrameworkApplication.ta.Qa.med()}),
new zg.a(function(){return he.AFrameworkApplication.wUi}),new zg.a(function(){return he.AFrameworkApplication.vUi}),new zg.a(function(){return ea.result}),new zg.a(function(){return Ta.result}),he.AFrameworkApplication.ga);Lb.o8i();Lb.bNf()})}};Ue.prototype.dispose=function(){};Ek.Object.defineProperties(Ue.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(ve.a)(Ue,"UXPackageManager",null,[4,5,3]);var Gh=b(133),Oi=Gh.StandardDialog;Am(ce,Oi);
ce.prototype.displayError=function(K){this.bA(K,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)};ce.prototype.N6c=function(K){this.bA(K,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(ve.a)(ce,"ErrorDialog",Gh.StandardDialog,[771]);var Di=b(161);Rd.prototype.yWe=function(){Ed.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var K=new Di.a;K.setResult("api.onedrive.com");return K.task};Object(ve.a)(Rd,"OneDriveConsumerEndpointHelper",
null,[762]);var nh=b(52),Vg=b(391),li=b(232);ad.prototype.b4a=function(){this.XWa||(this.XWa=this.l$a?li.a.create(this.l$a,null,null,null,!1):null);return this.XWa};ad.prototype.setup=function(K){var ea=this;this.qEa=K;this.VQc||this.TQc?this.VQc&&this.qEa&&this.qEa(!0):(K=this.b4a())?(this.TQc=!0,K.i8a.continueWith(function(Ta){ea.NOi(Ta)}),Vg.a.xia(K)):(Ed.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.qEa(!1))};ad.prototype.VAd=
function(K){Ed.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",K.exception?K.exception.toString():"No error detail.")};ad.prototype.NOi=function(K){this.TQc=!1;if(K.ig)this.VAd(K),this.qEa(!1);else try{this.VQc=!0,Ed.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Rld(),Ed.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.qEa(!0)}catch(ea){Ed.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",ea.toString()),this.qEa(!1)}};
ad.prototype.startPicker=function(K){this.s6=K;this.XDa?Ed.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(Ed.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(rf.a)(this,this.rzd,"onApiReady")))};ad.prototype.rzd=function(K){K?this.Fjc():this.si()};ad.prototype.si=function(){this.Js().displayError(nh.a.VTi)};ad.prototype.onSuccess=function(K){Ed.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");
this.s6&&this.s6(!0,K)};ad.prototype.dispose=function(){this.XWa&&this.XWa.dispose()};Ek.Object.defineProperties(ad.prototype,{Spe:{configurable:!0,enumerable:!0,get:function(){return this.GQb}},ga:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(ve.a)(ad,"AOneDriveFilePickerApiManager",null,[86,3]);Am(Ec,ad);Ec.prototype.start=function(K,ea){this.Lh=K;this.startPicker(ea)};Ec.prototype.Rld=function(){var K={},ea={};K=1===this.Spe||2===this.Spe?(K.client_id=this.ga.appSettings.UploadToSkyDriveClientId,
K):(ea.client_id=this.ga.appSettings.UploadToSkyDriveClientId,ea.env="INT",ea);WL.init(K)};Ec.prototype.startPicker=function(K){this.s6=K;!this.XDa&&this.m2.ULa?(Ed.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(rf.a)(this,this.rzd,"onApiReady"))):(Ed.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Uvg())};Ec.prototype.Fjc=function(){try{Ed.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Lh).then(Object(rf.a)(this,
this.onSuccess,"onSuccess"),Object(rf.a)(this,this.r6,"onFailure"))}catch(K){Ed.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",K,K.stack),this.si()}};Ec.prototype.r6=function(K){if(K&&K.error){if("user_canceled"===K.error.code){Ed.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}Ed.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",K.error.code,K.error.message)}else Ed.ULS.sendTraceTag(17909060,352,50,
"File Dialog returned with no response");this.s6&&this.s6(!1,K);this.si()};Ek.Object.defineProperties(Ec.prototype,{l$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiUrl")}}});Object(ve.a)(Ec,"OneDriveFilePickerApiManagerV5",ad,[]);Am(Yb,ad);Yb.prototype.start=function(K,ea){var Ta=this;this.aTb=ea;var Lb=this.Fng.yWe();Lb.continueWith(function(){Ed.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");Ta.Gce=Lb.result;
Ta.startPicker(function(xc,qd){Ta.qAc();K(xc,qd)})},3);Lb.continueWith(function(){Ed.ULS.sendTraceTag(24134242,352,15,Lb.exception.message);Ta.qAc()},5)};Yb.prototype.Rld=function(){var K=this;this.options.success=function(ea){var Ta={};Ta.data=ea;K.onSuccess(Ta)};this.options.error=function(ea){var Ta={};Ta.error=ea;K.r6(Ta)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Gce;this.options.advanced.iframeParentDiv=this.aTb};Yb.prototype.Fjc=
function(){try{Ed.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.qAc(),OneDrive.open(this.options)}catch(K){Ed.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",K.message),this.si()}};Yb.prototype.r6=function(K){this.s6&&this.s6(!1,K);this.si()};Yb.prototype.qAc=function(){this.aTb.style.visibility="hidden"===this.aTb.style.visibility?"":"hidden"};Ek.Object.defineProperties(Yb.prototype,{l$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});
Object(ve.a)(Yb,"OneDriveFilePickerApiManagerV7",ad,[]);Am(bb,ad);bb.prototype.start=function(K,ea,Ta,Lb){this.options.advanced.iframeParentDiv=Ta;this.options.advanced.endpointHint=Lb;this.options.cancel=ea;this.vkg.ra("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(K)};bb.prototype.startPicker=
function(K){this.s6=K;this.XDa?Ed.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(Ed.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(rf.a)(this,this.rzd,"onApiReady")))};bb.prototype.Rld=function(){var K=this;this.options.success=function(ea){var Ta={};Ta.data=ea;K.onSuccess(Ta)};this.options.error=function(ea){var Ta={};Ta.error=ea;K.r6(Ta)}};bb.prototype.Fjc=function(){try{Ed.ULS.sendTraceTag(23881879,216,50,
"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(K){Ed.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",K.message,K.stack),this.si()}};bb.prototype.VAd=function(K){Ed.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",K.exception?K.exception.toString():"No error detail.");Vg.a.k$i(this.l$a);this.XWa=null};bb.prototype.si=function(){this.Js().N6c(nh.a.Rij)};bb.prototype.r6=function(K){this.s6&&
this.s6(!1,K)};Ek.Object.defineProperties(bb.prototype,{l$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});Object(ve.a)(bb,"OneDriveFilePickerApiManagerV72",ad,[]);Object(ve.a)(Ka,"IExtraData",null,[]);Am(Se,bb);Se.prototype.Fjc=function(){try{Ed.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?
this.options.qosExtradata.olsSessionId:"",he.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(K){Ed.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",K.message,K.stack),this.si()}};Ek.Object.defineProperties(Se.prototype,{l$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});Object(ve.a)(Se,"OneDriveFilePickerApiOpenManagerV72",bb,[]);Ne.prototype.yWe=function(){this.am=new Di.a;Ed.ULS.sendTraceTag(24134235,
352,50,"Sending initial request for OneDrive for Business Endpoint");this.GNd();return this.am.task};Ne.prototype.GNd=function(K){K=void 0===K?null:K;var ea=String.format("GetMoreInfoHandler.ashx?{0}",he.AFrameworkApplication.THa);this.Mg.K9(ea,1,null,K,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(rf.a)(this,this.pSh,"getMoreInfoSucceeded"),Object(rf.a)(this,this.nSh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};Ne.prototype.nSh=function(K){if(K.data.httpStatus===Dh.a.sGb&&"X-NewKey"in
K.data.responseHeaders){Ed.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var ea={};ea["X-Key"]=K.data.responseHeaders["X-NewKey"];this.GNd(ea)}else 0<this.WPc?(Ed.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.WPc),this.WPc--,this.GNd()):(Ed.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.am.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};
Ne.prototype.pSh=function(K){"PersonalFileStorageUrl"in K.data.responseHeaders&&""!==K.data.responseHeaders.PersonalFileStorageUrl?(Ed.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.am.setResult(K.data.responseHeaders.PersonalFileStorageUrl)):(Ed.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.am.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(ve.a)(Ne,"OneDriveForBusinessEndpointHelper",
null,[762]);var wh=b(624);We.prototype.init=function(){};We.prototype.dispose=function(){};We.prototype.ei=function(K){var ea=this;this.tb=K;this.tb.register(Ec,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").Hc().Oc(function(){return new Ec(wh.a.instance,he.AFrameworkApplication.ga,he.AFrameworkApplication.f2a,he.AFrameworkApplication.limitedEdit,he.AFrameworkApplication.L3f,function(){return new ce})});he.AFrameworkApplication.Ggf?
this.tb.register(762,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Hc().Oc(function(){return new Rd}):this.tb.register(762,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Hc().Oc(function(){return new Ne(he.AFrameworkApplication.Jd)});this.tb.register(Yb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").Hc().Oc(function(){return new Yb(he.AFrameworkApplication.ga,he.AFrameworkApplication.f2a,he.AFrameworkApplication.limitedEdit,function(){return new ce},
ea.tb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.tb.register(bb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").Hc().Oc(function(){return new bb(he.AFrameworkApplication.ga,he.AFrameworkApplication.f2a,he.AFrameworkApplication.limitedEdit,function(){return new ce})});this.tb.register(Se,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").Hc().Oc(function(){return new Se(he.AFrameworkApplication.ga,he.AFrameworkApplication.f2a,
he.AFrameworkApplication.limitedEdit,function(){return new ce})})};We.main=function(){zf.a.instance.hj(new We)};Ek.Object.defineProperties(We.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});Object(ve.a)(We,"PackageManager",null,[4,5]);var Hi=Gh.StandardDialog;Am(Sd,Hi);Sd.prototype.displayError=function(K,ea,Ta){this.tA=ea;this.YWa=Ta;Ed.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",K,Ta);K=this.a0c(K);
0===K?(this.jc=6,this.Dc(0,CommonUIStrings.l_DialogClose)):(this.jc=0,this.Dc(1,CommonUIStrings.l_DialogClose));0===K&&Ed.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.bA(nh.a.Qij,this.Sdd(K),this.RMh(K,ea),Object(rf.a)(this,this.ILd,"retryDialogHandler"),!0)};Sd.prototype.ILd=function(K){1===K?(Ed.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.tA?this.La.ve(Sf.a.rJb,2,[this.tA,this.YWa]):this.La.processAction(Sf.a.rJb,2)):Ed.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")};Sd.prototype.a0c=function(K){return 0>K||6<K?(Ed.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",K),0):K};Sd.prototype.RMh=function(K,ea){K=this.a0c(K);return this.sib?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ea),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][K]:
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ea),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][K]};Sd.prototype.Sdd=function(K){K=this.a0c(K);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][K]};Object(ve.a)(Sd,"ErrorRetryDialog",Gh.StandardDialog,[881]);Gd.prototype.create=function(){return new Sd(this.La,this.sib)};Object(ve.a)(Gd,"ErrorRetryDialogFactory",null,[876]);var lh=b(149),kg=b(42),Fg=lh.a;Am(Ic,Fg);Ic.prototype.YHe=function(K,ea){this.pL(1,!!K&&K!==ea);this.hJ=document.getElementById(Ic.xSe);kg.a.addHandler(this.hJ,"change",Object(rf.a)(this,this.jnc,"onFileNameChange"));kg.a.addHandler(this.hJ,"input",
Object(rf.a)(this,this.jnc,"onFileNameChange"));this.hJ.focus()};Ic.prototype.D9b=function(K){return this.sib?(new RegExp("["+this.m8b('\\/:*?"<>|')+"]")).test(K):(new RegExp("["+this.m8b('\\/:*?"<>|#{}%~&')+"]")).test(K)};Ic.prototype.m8b=function(K){return K.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")};Ic.prototype.qid=function(){var K=lg.a.Gq(he.AFrameworkApplication.jm.hn);this.pL(1,!!this.hJ&&""!==this.hJ.value&&this.hJ.value!==K)};Ic.prototype.jnc=function(){var K=this;this.hJ&&window.setTimeout(function(){K.qid()},
0)};Ic.prototype.C9b=function(K,ea){if(1!==K)Ed.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{K=ea[Ic.xSe];ea=Ic.PEf in ea?ea[Ic.PEf]:!1;Ed.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",lg.a.Jrc(K),ea);var Ta=lg.a.C4(he.AFrameworkApplication.fileName);(K=K?K.trim():null)&&""!==K&&""!==Ta||1===this.ta.state?this.D9b(K)?this.Js.create().displayError(1,K,ea):this.zga.Zna(K+Ta,ea,
this.Lh):this.Js.create().displayError(2,K,ea)}};Ic.prototype.dispose=function(){this.hJ&&(kg.a.removeHandler(this.hJ,"change",Object(rf.a)(this,this.jnc,"onFileNameChange")),kg.a.removeHandler(this.hJ,"input",Object(rf.a)(this,this.jnc,"onFileNameChange")),this.hJ=null);Fg.prototype.dispose.call(this)};Ek.Object.defineProperties(Ic.prototype,{ta:{configurable:!0,enumerable:!0,get:function(){return this.df}}});Ic.xSe="txtFileName";Ic.PEf="chkOverwrite";Object(ve.a)(Ic,"FileNameDialogBase",lh.a,[]);
Ek.Object.defineProperties(Ib,{gg:{configurable:!0,enumerable:!0,get:function(){return lh.a.cp(Ib.xk,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});Ib.xk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(ve.a)(Ib,"FileNameDialogHtml",null,[]);Am(Da,Ic);Da.prototype.zQ=function(K,ea){var Ta=lg.a.Gq(he.AFrameworkApplication.jm.hn),Lb={};ea=(Lb.txtFileName=K||Ta,Lb.lblFolderName=CommonUIStrings.l_ToCurrentFolder,Lb.chkOverwrite=ea,Lb);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(rf.a)(this,this.C9b,"fileNameDialogHandler"),ea);this.YHe(K,Ta)};Object(ve.a)(Da,"FileNameDialog",Ic,[880]);zh.prototype.create=function(){return new Da(this.vb,this.La,this.df,this.XX,this.Js,this.zga)};Object(ve.a)(zh,
"FileNameDialogFactory",null,[875]);var xi=b(740);Mf.prototype.Qg=function(){2===he.AFrameworkApplication.ta.Qa.Sj?he.AFrameworkApplication.Ib.Te(Sf.a.rJb,uh.a.frame,Object(rf.a)(this,this.PUf,"saveAsToHostActionDispatcher"),4):he.AFrameworkApplication.Ib.fc(Sf.a.rJb,uh.a.frame,Object(rf.a)(this,this.PUf,"saveAsToHostActionDispatcher"))};Mf.prototype.PUf=function(K,ea,Ta,Lb,xc){return ea.contextId!==uh.a.frame||K!==Sf.a.rJb?2:this.vb.ra("SaveAsToHostBrsIsEnabled")?1===Ta?xi.SessionStatusManager.instance.Swb||
he.AFrameworkApplication.r5?8:32:2===Ta?(Ed.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),K=this.BIc.create(),xc&&Object.getType(xc)===Array&&2===xc.length?K.zQ(xc[0],!!xc[1]):K.zQ(null,!1),32):8:8};Object(ve.a)(Mf,"SaveAsToHostActor",null,[]);var Ng=b(80);wg.prototype.ULb=function(){1!==this.df.state&&(this.Cm=this.Zkb(),this.Cm.message=CommonUIStrings.l_CommentProgressTooltip,this.Cm.jc=5,this.Cm.qv=!1,this.Cm.PAa(CommonUIStrings.l_DefaultDialogTitle,
null,null))};wg.prototype.DS=function(K){K=void 0===K?0:K;1!==this.df.state&&this.Js.create().displayError(K,lg.a.Gq(this.tA),this.YWa)};wg.prototype.dQa=function(){var K=this.vb.appSettings.BreadcrumbFolderUrl;Ed.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");Oe.a.jf(K,Oe.a.NX(3),void 0,"UploadToHostManager.RedirectToFolder")};wg.prototype.cQa=function(K){var ea=!1,Ta=!1;this.vb&&(ea=this.vb.ra("SaveACopyIsEnabledForUiHost"),Ta=this.vb.ra("UiHostSupportsDocRebootFeatures"));
Ed.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",K,ea,Ta);if(ea&&Ta){Ed.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Lb={};Lb[Df.a.ZPa]="1";Lb[Df.a.documentUrl]=K;Lb[Df.a.reason]=qh.a.saveAs;he.AFrameworkApplication.HV().execute(function(xc){xc.Hj(Zg.a.Wta,Lb)})}else ea&&!Ta&&he.AFrameworkApplication.Bba?Oe.a.jf(K,Oe.a.NX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):
Oe.a.jf(K,Oe.a.NX(3),void 0,"UploadToHostManager.RedirectToEditUrl")};wg.prototype.Zna=function(K,ea,Ta){Ta=void 0===Ta?null:Ta;Ed.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.L8d&&!this.L8d()&&this.Mg&&(this.Dh&&(this.yga=this.Dh.Gc("DialogShown","SaveAsToHostUploadTime")),this.ULb(),this.YWa=ea,this.tA=K,(this.Lh=Ta)&&"true"===this.Lh.SkipSaveToHost?this.Y8b():this.IQ())};wg.prototype.IQ=function(){var K=this;32!==this.La.processAction(Sf.a.ZQa,1)?(Ed.ULS.sendTraceTag(18989378,
219,15,"The save file change is not supported, this operation may exist data losting."),this.Y8b()):this.La.ve(Sf.a.ZQa,2,[function(){Ed.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");K.Y8b()},function(ea,Ta){Ed.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");K.DS(Ta)}])};wg.prototype.jTi=function(K){this.xIa();this.rDa=!1;if(K&&K.data&&K.data.ke){var ea=Jh.d(K.data.ke);var Ta=ea.dv;if(ea.returnValue)if(Ta.StatusCode!==
Dh.a.kP&&Ta.StatusCode!==Dh.a.Drb)Ed.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),K={},K.FailureReason=Ta.StatusCode.toString(),K.ExtraInfo=Ta.ExtraInfo,this.tda(K),this.DS(parseInt(Ta.ExtraInfo));else{Ed.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.zKd();try{Ta.NewDocumentUrl&&""!==Ta.NewDocumentUrl?this.cQa(Ta.NewDocumentUrl):this.dQa()}catch(Lb){Ed.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",Lb.toString())}this.$Fb()}else Ta=
{},Ed.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(Ta.ResponseData=Og.a.Meb(K.data.ke),Ta)),K={},this.tda((K.FailureReason="Failed to deserialize response",K)),this.DS()}else Ed.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),K={},this.tda((K.FailureReason="null response",K)),this.DS()};wg.prototype.iTi=function(K){if(5!==K.data.status&&12!==K.data.status||this.rDa){var ea={};Ed.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(ea.Status=K.data.status,ea.HttpStatus=K.data.httpStatus,ea));ea={};this.tda((ea.FailureReason=K.data.httpStatus.toString(),ea));this.xIa();this.DS();this.$Fb()}else Ed.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.rDa=!0,this.Lh&&"true"===this.Lh.SkipSaveToHost?this.Y8b():this.IQ()};wg.prototype.xIa=function(){this.Cm&&(this.Cm.close(),this.Cm=null)};wg.prototype.$Fb=function(){this.yga&&(this.yga.stop(),this.yga=null)};wg.prototype.zKd=function(){this.Lh&&
"VersionHistory"===this.Lh.SaveEntryPoint&&this.La.processAction(Sf.a.Gtc,2)};wg.prototype.tda=function(K){this.Lh&&"VersionHistory"===this.Lh.SaveEntryPoint&&this.La.ve(Sf.a.BKd,2,K)};wg.prototype.Y8b=function(){var K=this.lFa+this.zfa;K=Ng.a.Dl(K,"qs",lg.a.mf(he.AFrameworkApplication.oj));K=Ng.a.Dl(K,"n",lg.a.mf((new Date).getTime().toString()));K=Ng.a.Dl(K,"ov",lg.a.mf(this.YWa.toString()));K=Ng.a.Dl(K,"fn",lg.a.mf(this.tA));this.Lh&&this.Lh.FileDownloadUrl&&(K=Ng.a.Dl(K,"furl",lg.a.mf(this.Lh.FileDownloadUrl)));
this.Mg.El(K,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(rf.a)(this,this.jTi,"onUploadFinished"),Object(rf.a)(this,this.iTi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(ve.a)(wg,"UploadToHostManager",null,[766]);var Sh=b(992);se.prototype.init=function(){he.AFrameworkApplication.ga.sv(Object(rf.a)(this,this.EB,"onFullAppSettingsReady"))};se.prototype.EB=function(){he.AFrameworkApplication.ga.ra("SaveAsToHostBrsIsEnabled")&&this.tb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Qg()};
se.prototype.ei=function(K){this.tb=K;this.tb.register(Gd,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Oc(function(){return new Gd(he.AFrameworkApplication.ga,he.AFrameworkApplication.Ib)}).Hc();this.tb.register(wg,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Oc(function(){return new wg(he.AFrameworkApplication.Ib,he.AFrameworkApplication.ga,he.AFrameworkApplication.Jd,function(){return he.AFrameworkApplication.Pg},
function(){return(new Sh.a).create()},K.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),he.AFrameworkApplication.ta,he.AFrameworkApplication.ta.JD)}).Hc();this.tb.register(zh,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Oc(function(){return new zh(he.AFrameworkApplication.ga,he.AFrameworkApplication.Ib,he.AFrameworkApplication.ta,he.AFrameworkApplication.ta.Qa,K.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),K.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Hc();
this.tb.register(Mf,"Common.App.SaveAsToHost.SaveAsToHostActor").Oc(function(){return new Mf(he.AFrameworkApplication.ga,K.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),K.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Hc()};se.prototype.dispose=function(){};se.main=function(){zf.a.instance.hj(new se)};Ek.Object.defineProperties(se.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(ve.a)(se,"SaveAsToHostPackage",null,[4,5]);
var Gi=Gh.StandardDialog;Am(re,Gi);re.prototype.displayError=function(K,ea){this.qIe(K,ea,nh.a.Sij)};re.prototype.qIe=function(K,ea,Ta){Ed.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Ta);this.bA(Ta,K,ea,null)};re.prototype.N6c=function(K,ea){Ed.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.bA(nh.a.Uij,K,ea,null,!0)};Object(ve.a)(re,"ErrorDialog",Gh.StandardDialog,[350]);Ek.Object.defineProperties(hg,{gg:{configurable:!0,
enumerable:!0,get:function(){return lh.a.cp(hg.xk,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});hg.xk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(ve.a)(hg,"FileNameDialogHtml",null,[]);var ag=b(13),pi=b(86),Th=b(91);Am(df,Ic);df.prototype.zQ=function(K){var ea=lg.a.Gq(he.AFrameworkApplication.jm.hn),Ta=he.AFrameworkApplication.breadcrumbFolderName,Lb=he.AFrameworkApplication.breadcrumbBrandName,xc={};xc=(xc.txtFileName=K||ea,xc);var qd=CommonUIStrings.L_SaveAs;2===he.AFrameworkApplication.ta.Qa.Sj&&(qd=CommonUIStrings.L_SaveACopy);this.initializeAndShow(qd,Object(rf.a)(this,this.C9b,"fileNameDialogHandler"),xc);this.YHe(K,ea);this.sIa.style.width=
"450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");he.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost")||(this.Zy=document.getElementById("anotherFolder"),K=document.getElementById("folderLocation"),this.BQc=Th.a.kqe(K,this.Zy,"anotherFolderDescribedBy"),this.Zy.className="WACButton WACDialogButtonNormal",K=!1,Ta&&Ta.length?(this.ale(this.Zy,this.BQc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Lb,Ta)),
K=this.aAg(Lb,Ta)):this.ale(this.Zy,this.BQc,CommonUIStrings.l_CurrentOnlineFolder),this.YAg(this.Zy),this.cAg(this.Zy),K?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Zy,"SaveToAnotherLocationTwo"),Ed.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Zy,"SaveToAnotherLocationOne"),kg.a.addHandler(this.Zy,ag.a.click,Object(rf.a)(this,this.HBd,"onSaveToAnotherLocationClick")),
kg.a.addHandler(this.Zy,ag.a.Yb,Object(rf.a)(this,this.BBf,"onSaveToAnotherLocationKeyDown")))};df.prototype.aAg=function(K,ea){var Ta=!1;var Lb=document.getElementById("currentLocation");Lb.innerText="";var xc=this.N_e(Lb,K),qd=this.N_e(Lb,ea),Jd=255,De=255;255<xc+qd&&(Jd=Math.max(238,408-xc),De=Math.max(170,408-qd),Ta=!0);this.vCg(Lb,K,De,ea,Jd);return Ta};df.prototype.N_e=function(K,ea){var Ta=document.createElement("div");Ta.innerText=ea;Ta.style.visibility="hidden";K.appendChild(Ta);ea=Ta.clientWidth;
K.removeChild(Ta);return ea};df.prototype.vCg=function(K,ea,Ta,Lb,xc){ea&&(this.Zke(K,ea,Ta),this.nCg(K));Lb&&this.Zke(K,Lb,xc)};df.prototype.Zke=function(K,ea,Ta){var Lb=document.createElement("div");Lb.innerText=ea;Lb.title=ea;Lb.className="SaveToAnotherFolderBreadcrumb";Lb.style.maxWidth=Ta.toString()+"px";K.appendChild(Lb)};df.prototype.nCg=function(K){var ea=document.createElement("span");ea.id="FolderSeparator";var Ta=document.createElementNS("http://www.w3.org/2000/svg","svg");Ta.setAttribute("class",
"SeparatorCaret");var Lb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Lb.setAttribute("points","1 4 1 11 5 7.5");Ta.appendChild(Lb);ea.appendChild(Ta);K.appendChild(ea)};df.prototype.ale=function(K,ea,Ta){Ta=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Ta);ea&&(ea.innerText=Ta);K.tabIndex=0;K.setAttribute(Th.a.Td,Th.a.Ws)};df.prototype.cAg=function(K){var ea=document.createElement("span");ea.id="anotherFolderText";ea.innerText=this.cSg;ea.className="AnotherFolderTextSpan";
K.appendChild(ea)};df.prototype.YAg=function(K){var ea=document.createElement("span");ea.className="cui-img-cont-float cui-img-16by16 ";this.cqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.cqa.setAttribute("class","FolderIconSVG");var Ta=document.createElementNS("http://www.w3.org/2000/svg","path");Ta.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.cqa.appendChild(Ta);ea.appendChild(this.cqa);
K.appendChild(ea)};df.prototype.BBf=function(K){!K||K.keyCode!==pi.a.di&&K.keyCode!==pi.a.n1||this.HBd(K)};df.prototype.HBd=function(){if(this.hJ){var K=lg.a.C4(he.AFrameworkApplication.fileName),ea=this.hJ.value;this.hide();ea&&""!==ea&&""!==K||1===this.ta.state?(""!==K&&(ea+=K),this.D9b(ea)?this.Js.create().displayError(1,ea,!1):this.zlb.start(ea,this.Ysg)):this.Js.create().displayError(2,ea,!1)}};df.prototype.LVg=function(K){this.Zy&&this.cqa&&(K?(this.Zy.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Zy,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.cqa,"DisabledFolderIconSVG")):(this.Zy.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Zy,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.cqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Zy,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.cqa,"DisabledFolderIconSVG"))))};df.prototype.qid=function(){Ic.prototype.qid.call(this);this.LVg(!!this.hJ&&""!==this.hJ.value)};df.prototype.dispose=function(){this.Zy&&
(kg.a.removeHandler(this.Zy,ag.a.click,Object(rf.a)(this,this.HBd,"onSaveToAnotherLocationClick")),kg.a.removeHandler(this.Zy,ag.a.Yb,Object(rf.a)(this,this.BBf,"onSaveToAnotherLocationKeyDown")),this.Zy=null);Ic.prototype.dispose.call(this)};Object(ve.a)(df,"FileNameDialog",Ic,[374]);var xh=b(895),Ea=b(616),ua=b(202),Ab=b(1113),Xd=b(134);Object(ve.a)(Qf,"SaveAsDialogInput",null,[]);Object(ve.a)(Vf,"SaveLocation",null,[]);var oe=b(356);ig.prototype.YLh=function(){var K=new xh.a(Ea.a.Pk());K.ia("type",
"currentHost");return Object.assign(new Vf,{folderName:this.Zv.breadcrumbFolderName,friendlyPath:this.Zv.breadcrumbBrandName,properties:K})};ig.prototype.hmi=function(K){return!!K&&"ClassicMru"===K.type&&!!K.service_info&&!!K.service_info.service_id&&-1!==K.service_info.service_id.indexOf("SHAREPOINT")};ig.prototype.oXh=function(){if(!this.KMc||!this.eFa)return null;var K=this.KMc.value.Az("SaveAsToSharePointDialog",!1);if(!K||3!==K.state||!K.qqf)return null;K=K.qqf;for(var ea=new ua.a,Ta=0,Lb=0,
xc=0;xc<K.length;xc++){var qd=K[xc];if(this.hmi(qd)&&(Ta++,qd.sharepoint_info)){var Jd=qd.url,De=qd.sharepoint_info.site_url,Ve=qd.title;qd=Ab.b(qd,he.AFrameworkApplication.isRtl);if(Jd&&De&&Ve&&qd){Lb++;var sg=new xh.a(Ea.a.Pk());sg.ia("type","SharePoint");sg.ia("siteUrl",De);sg.ia("folderUrl",Jd);Lb++;ea.add(Object.assign(new Vf,{folderName:Ve,friendlyPath:qd,properties:sg}))}}}xc=new Map;xc.set("NumPlaces",K.length.toString());xc.set("NumSharepointPlaces",Ta.toString());xc.set("placesWithMetadata",
Lb.toString());Ke.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",xc);0<Ta&&(Lb?.5>1*Lb/Ta&&Ke.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Ke.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return ea};ig.prototype.QMh=function(){var K=new ua.a;K.add(this.YLh());var ea=this.oXh();ea&&K.addRange(ea);return Object.assign(new Qf,{enableMoreLocations:!he.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost"),
fileName:this.tA,extension:lg.a.C4(this.Zv.hn),saveLocations:K.toArray(),scenario:"SaveToSharePoint"})};ig.prototype.NMh=function(){return{inputPropsCallback:Object(rf.a)(this,this.QMh,"getDialogInput")}};ig.prototype.zQ=function(K){this.tA=K;this.tA||(this.tA=String.format(CommonUIStrings.l_SaveACopy_Filename,lg.a.Gq(this.Zv.hn)));K={};K=(K.id="SaveAsDialog",K.bodyControls=this.NMh(),K);var ea=CommonUIStrings.L_SaveAs;2===this.df.Qa.Sj&&(ea=CommonUIStrings.L_SaveACopy);var Ta=new lh.a(!1,!1,!0);
Ta.jc=1;Ta.Pe="SaveAsDialog";Ta.Dc(1,CommonUIStrings.l_SaveButtonLabel);Ta.initializeAndShow(ea,Object(rf.a)(this,this.Oij,"saveAsDialogHandler"),K)};ig.prototype.Mzj=function(K,ea){K&&""!==K&&""!==ea||1===this.df.state?this.gmi()?this.Csi(K,ea):(""!==ea&&(K+=ea),this.zlb.start(K,this.Lh)):(Ed.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Js.create().displayError(2,K,!1))};ig.prototype.Csi=function(K,ea){var Ta=this;Ke.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);var Lb=this.GXa.ADe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.GXa.ned(Lb).then(function(xc){if(xc&&0<xc.length){var qd=xc[0][Df.a.vXi];xc=xc[0][Df.a.gGf];if(""!==qd&&""!==xc)Ta.eFa.Zna(xc,K+ea,qd,Ta.Lh),Ke.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{Ta.Js.create().displayError(0,K,!1);var Jd=Xd.a.Xr();Jd&&(Jd.set("SiteUrlAvailable",""===qd?"false":"true"),Jd.set("FolderUrlAvailable",""===xc?"false":
"true"));Ke.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new oe.a,{extendedProperties:Jd}))}}else Ta.Js.create().displayError(0,K,!1),Ke.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(xc){"Canceled"===xc?((xc=Xd.a.Xr())&&xc.set("IsCanceled","true"),Ke.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new oe.a,{extendedProperties:xc}))):Ke.Health.instance.recordKpiFailure("SaveACopySFP",
xc,!1,!1,null)})};ig.prototype.gmi=function(){return this.GXa?this.GXa.Lqd():(Ed.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};ig.prototype.Oij=function(K,ea){if(ea&&1===K){K=ea.fileName;var Ta=lg.a.C4(this.Zv.hn);ea.moreLocationsSelected&&this.Mzj(K,Ta);if(ea.locationCallback){var Lb=ea.locationCallback();Lb?Lb.properties&&"currentHost"===Lb.properties.oa("type")?this.zga.Zna(K+Ta,!1,this.Lh):Lb.properties&&"SharePoint"===Lb.properties.oa("type")?(ea=Lb.properties.oa("siteUrl"),
Lb=Lb.properties.oa("folderUrl"),this.eFa.Zna(Lb,K+Ta,ea,this.Lh)):Ed.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):Ed.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else Ed.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(ve.a)(ig,"ReactSaveAsDialog",null,[374]);Rf.prototype.create=function(K){return this.df&&this.df.Qa.vv?new ig(this.Hfe,this.Js,this.zga,he.AFrameworkApplication.jm,this.df,this.Crg,this.eFa,this.GXa,K):new df(this.vb,
this.La,this.df,this.XX,this.Js,this.zga,this.Hfe,K)};Object(ve.a)(Rf,"FileNameDialogFactory",null,[349]);bf.prototype.start=function(K){var ea=this;if(!this.dEf)if(he.AFrameworkApplication.breadcrumbFolderUrl&&he.AFrameworkApplication.breadcrumbFolderUrl.length)this.zkb=he.AFrameworkApplication.breadcrumbFolderUrl;else return Ed.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.Oo),!1;var Ta=this.ttg();Ta.fAj();var Lb=Ta.VTh();if(!Lb)return Ed.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.yib.start(function(xc,qd){Ta.hide();K(xc,qd)},function(){ea.Hzd(Ta)},Lb,this.zkb);return!0};bf.prototype.Hzd=function(K){K.hide();Ed.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")};bf.prototype.oTh=function(K){K=K.toLowerCase();K.endsWith("/")||(K+="/");var ea=K.indexOf("/documents/");return-1!==ea?K.substring(0,
ea+1)+"_layouts/15/onedrive.aspx":""};bf.prototype.Nvb=function(K){this.Oo||3!==K.state||(this.Oo=K)};Ek.Object.defineProperties(bf.prototype,{dEf:{configurable:!0,enumerable:!0,get:function(){this.zkb||(this.ADa.value.Az("Save As",!0),this.Oo&&this.Oo.aS&&this.Oo.aS.length&&(this.zkb=this.oTh(this.Oo.aS)));return this.zkb}}});Object(ve.a)(bf,"OneDriveFilePickerHelper",null,[348]);var yf=lh.a;Am(He,yf);He.prototype.fAj=function(){this.rHc="FilePickerDialog";this.gg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";
this.Pe="PickerDialog-MsoSp";this.showDialog("",null)};He.prototype.VTh=function(){return document.getElementById("FilePickerDiv")};He.prototype.IO=function(){};He.prototype.SPa=function(){};Object(ve.a)(He,"PickerDialog",lh.a,[331]);var Pg=b(1046),Af=b(24);ue.prototype.Qg=function(){var K=this,ea=this.yib.b4a();ea?Af.a.uB||this.vb.ra("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Te(Sf.a.saveToSharePoint,uh.a.frame,Object(rf.a)(this,this.jVf,"saveToSharePointActionDispatcher"),64):(ea.i8a.continueWith(function(Ta){Ta.ig&&
K.yib.VAd(Ta)}),this.B1b()):Ed.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};ue.prototype.B1b=function(){Vg.a.PHd(Object(rf.a)(this,this.jVf,"saveToSharePointActionDispatcher"));Vg.a.o8c([new Pg.a(Sf.a.saveToSharePoint,uh.a.frame,0)],this.yib.b4a())};ue.prototype.jVf=function(K,ea,Ta,Lb,xc){return ea.contextId!==uh.a.frame||K!==Sf.a.saveToSharePoint?2:this.t7a&&(this.sOc.dEf||this.cwe)?1===Ta?xi.SessionStatusManager.instance.Swb||he.AFrameworkApplication.r5?
8:this.Ilg()?32:8:2===Ta?(Ed.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(xc&&xc.SaveEntryPoint&&"VersionHistory"===xc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.cwe?(Ed.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.BIc.create(xc).zQ(null)):(Ed.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.zlb.start(null,xc)),32):8:8};Ek.Object.defineProperties(ue.prototype,
{t7a:{configurable:!0,enumerable:!0,get:function(){return this.vb.ra("SaveToAnotherFolderBrsIsEnabled")}},cwe:{configurable:!0,enumerable:!0,get:function(){return this.vb.ra("UserCanWriteRelative")}}});Object(ve.a)(ue,"SaveToSharePointActor",null,[]);td.prototype.start=function(K,ea){var Ta=this;Ed.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Obe=K;this.Lh=ea;this.sOc.start(function(Lb,xc){Ta.V0i(Lb,xc)})||this.iSd()};td.prototype.V0i=function(K,ea){if(K)this.onSuccess(ea);else this.r6(ea)};
td.prototype.iSd=function(){1!==this.df.state&&this.Js().N6c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};td.prototype.onSuccess=function(K){Ed.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(K&&K.data&&K.data.value&&K.data.value.length&&K.data.value[0].sharePoint){var ea=K.data.value[0].sharePoint.url;K=K.data.value[0].sharePoint.listUrl;var Ta=null;if(ea&&(Ta=K?this.JXh(K):this.IXh(ea))){this.eFa.Zna(ea,
this.Obe,Ta,this.Lh);return}Ed.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!ea,!Ta)}Ed.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.iSd()};td.prototype.IXh=function(K){K.endsWith("/")||(K+="/");for(var ea=0,Ta=0;Ta<K.length;Ta++)if("/"===K.charAt(Ta)&&5===++ea)return K.substr(0,Ta);return null};td.prototype.JXh=function(K){K.endsWith("/")&&(K=K.substring(0,K.length-1));var ea=K.lastIndexOf("/");
return-1!==ea?K.substring(0,ea):null};td.prototype.r6=function(K){Ed.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");K&&K.error?Ed.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",K.error.errorCode,K.error.message):Ed.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.iSd()};Object(ve.a)(td,"SaveToSharePointManager",null,[769]);jd.prototype.execute=function(K,ea){if(!he.AFrameworkApplication.Pg&&he.AFrameworkApplication.Jd){var Ta=
this.lFa+this.zfa;Ta=Ng.a.Dl(Ta,"fu",lg.a.mf(this.T8));Ta=Ng.a.Dl(Ta,"su",lg.a.mf(this.gwg));Ta=Ng.a.Dl(Ta,"fn",lg.a.mf(this.tA));Ta=Ng.a.Dl(Ta,"n",lg.a.mf((new Date).getTime().toString()));this.Lh&&this.Lh.FileDownloadUrl&&(Ta=Ng.a.Dl(Ta,"furl",lg.a.mf(this.Lh.FileDownloadUrl)));Ta=Ta+"&"+this.uPc;this.OVa&&this.OVa.length?Ta=Ng.a.Dl(Ta,"fnn",lg.a.mf(this.OVa)):Ed.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");Ed.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
he.AFrameworkApplication.Jd.El(Ta,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,K,ea,null,void 0,void 0,void 0,void 0,"9")}};Object(ve.a)(jd,"SharePointSaveAsCaller",null,[814]);Fc.prototype.create=function(K,ea,Ta,Lb){return new jd(this.mFa,this.tA,K,ea,Ta,he.AFrameworkApplication.oj,this.zfa,Lb)};Object(ve.a)(Fc,"SharePointUploadCallerFactory",null,[770]);var ch=b(898);pg.prototype.Zna=function(K,ea,Ta,Lb){this.ZEc=!1;Ed.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.ULb();this.T8=K;Lb&&Lb.SaveEntryPoint&&(this.xQc=Lb.SaveEntryPoint);this.JCa=this.LSc.create(K,ea,Ta,Lb);Lb&&"true"===Lb.SkipSaveToHost?this.IQ():this.nDh()};pg.prototype.nDh=function(){function K(){Ed.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");ea.IQ()}var ea=this;32!==this.La.ve(Sf.a.ZQa,2,[function(){Ed.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");ea.IQ()},K])&&K()};pg.prototype.IQ=
function(){Ed.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.JCa.execute(Object(rf.a)(this,this.BQi,"onSaveToSharePointUploadFinished"),Object(rf.a)(this,this.AQi,"onSaveToSharePointUploadFailed"))};pg.prototype.BQi=function(K){if(K&&K.data&&K.data.ke){var ea=Jh.d(K.data.ke);var Ta=ea.dv;if(ea.returnValue)if(Ta.StatusCode!==Dh.a.kP&&Ta.StatusCode!==Dh.a.Drb)Ed.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
K.data.status,Ta.StatusCode),Ta.StatusCode!==Dh.a.YRf&&this.OIe(K.data.status)||(this.tda(Ta.StatusCode.toString()),this.Syj(Ta.StatusCode));else{Ed.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.zKd();try{Ta.NewDocumentUrl?this.cQa(Ta.NewDocumentUrl):this.dQa()}catch(Lb){Ed.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",Lb.toString())}}else Ta={},Ed.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(Ta.ResponseData=Og.a.Meb(K.data.ke),
Ta)),this.f7b()||(this.tda("Failed to deserialize response"),this.SLb())}else Ed.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.f7b()||(this.tda("Unknown"),this.SLb())};pg.prototype.AQi=function(K){K&&K.data?this.OIe(K.data.status)||(Ed.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.tda(ch.a[K.data.status]),this.SLb()):(Ed.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.f7b()||(this.tda("Unknown"),this.SLb()))};pg.prototype.f7b=
function(){if(!this.ZEc)return Ed.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.ZEc=!0,this.IQ(),!0;Ed.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};pg.prototype.OIe=function(K){Ed.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",K);return this.f7b()};pg.prototype.dQa=function(){Ed.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Oe.a.jf(this.T8,Oe.a.NX(3),void 0,"UploadToSharePointManager.RedirectToFolder")};
pg.prototype.cQa=function(K){var ea=!1,Ta=!1;he.AFrameworkApplication.ga&&(ea=he.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Ta=he.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));Ed.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",K,ea);if(ea&&Ta){Ed.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Lb={};Lb[Df.a.ZPa]="1";Lb[Df.a.documentUrl]=K;Lb[Df.a.reason]=
qh.a.saveAs;he.AFrameworkApplication.HV().execute(function(xc){xc.Hj(Zg.a.Wta,Lb)})}else Oe.a.jf(K,Oe.a.NX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};pg.prototype.ULb=function(){this.df&&1===this.df.state||(this.Cm=this.Zkb(),this.Cm.message=CommonUIStrings.l_CommentProgressTooltip,this.Cm.jc=5,this.Cm.qv=!1,this.Cm.PAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};pg.prototype.xIa=function(){this.Cm&&(this.Cm.close(),this.Cm=null)};pg.prototype.SLb=function(){this.si(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)};pg.prototype.Qzj=function(){this.si(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};pg.prototype.Yyj=function(){var K=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.si(CommonUIStrings.l_SaveAsFileTooLargeTitle,K,nh.a.Pij)};pg.prototype.si=function(K,ea,Ta){Ta=void 0===Ta?nh.a.Tij:Ta;Ed.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",K,ea);this.xIa();1!==this.df.state&&
this.Js().qIe(K,ea,Ta)};pg.prototype.Syj=function(K){Ed.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",K);switch(K){case Dh.a.Hag:this.Qzj();break;case Dh.a.YRf:this.Yyj();break;default:this.SLb()}};pg.prototype.zKd=function(){"VersionHistory"===this.xQc&&this.La.processAction(Sf.a.Gtc,2)};pg.prototype.tda=function(K){if("VersionHistory"===this.xQc){var ea={};this.La.ve(Sf.a.BKd,2,(ea.FailureReason=K,ea))}};Object(ve.a)(pg,"UploadToSharePointManager",null,[768]);Dg.prototype.init=
function(){};Dg.prototype.dispose=function(){};Dg.prototype.ei=function(K){var ea=this;this.tb=K;this.GNc=$h.a.ar(K.lc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.LNc=$h.a.ar(K.lc("Common.IEventEmitter<Common.IMruResult>"));this.mra=$h.a.ar(K.lc("Common.App.SharedFilePicker.ISharedFilePicker"));Ch.Task.WAA.call(null,this.GNc,this.LNc,this.mra).continueWith(function(){ea.P6i()})};Dg.prototype.P6i=function(){var K=this;this.tb.register(Fc,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Oc(function(){return new Fc(he.AFrameworkApplication.ga)}).Hc();
this.tb.register(pg,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Oc(function(){return new pg(he.AFrameworkApplication.Ib,K.tb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),function(){return(new Sh.a).create()},function(){return new re},he.AFrameworkApplication.ta)}).Hc();this.tb.register(td,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Oc(function(){return new td(K.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
function(){return new re},K.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),he.AFrameworkApplication.ta)}).Hc();this.tb.register(bf,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Oc(function(){return new bf(K.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new zg.a(function(){return K.GNc.result}),he.AFrameworkApplication.ta,function(){return new He})}).Hc();this.tb.register(Rf,
"Common.App.SaveToSharePoint.FileNameDialogFactory").Oc(function(){return new Rf(he.AFrameworkApplication.ga,he.AFrameworkApplication.Ib,he.AFrameworkApplication.ta,he.AFrameworkApplication.ta.Qa,K.tb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),K.tb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),K.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new zg.a(function(){return K.LNc.result}),K.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
K.mra?K.mra.result:null)}).Hc();this.tb.register(ue,"Common.App.SaveToSharePoint.SaveToSharePointActor").Oc(function(){return new ue(he.AFrameworkApplication.ga,he.AFrameworkApplication.Ib,K.tb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),K.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),K.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),K.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return he.AFrameworkApplication.ta.cUg})}).Hc();
he.AFrameworkApplication.ga.ra("SaveToAnotherFolderBrsIsEnabled")&&this.tb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Qg()};Dg.main=function(){zf.a.instance.hj(new Dg)};Ek.Object.defineProperties(Dg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(ve.a)(Dg,"PackageManager",null,[4,5]);var Xg=Gh.StandardDialog;Am(hh,Xg);hh.prototype.displayError=function(K){this.bA(K,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)};Object(ve.a)(hh,"ErrorDialog",Gh.StandardDialog,[873]);Fe.default=0;Object(ve.a)(Fe,"SaveToCloudErrorCodes",null,[]);tg.prototype.start=function(K){this.Lh=K;if("SharePointOnlineConsumer"===this.vb.Ua("FileSource")){var ea=oi.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(ea){ea.start(null,K);return}}this.m2.ULa?(Ed.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.zTg()):(Ed.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),
this.showSignInDialog())};tg.prototype.showSignInDialog=function(){this.$vg.create().zQ()};tg.prototype.si=function(){this.Js().displayError(Fe.default)};tg.prototype.zTg=function(){try{Ed.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");var K={},ea=(K.client_id=this.vb.appSettings.UploadToSkyDriveClientId,K.env="INT",K);if(1===this.GQb||2===this.GQb)K={},ea=(K.client_id=this.vb.appSettings.UploadToSkyDriveClientId,K);K={};var Ta=(K.mode="save",K.lightbox="grey",K);WL.init(ea);Ed.ULS.sendTraceTag(6590562,
216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(Ta).then(Object(rf.a)(this,this.onSuccess,"onSuccess"),Object(rf.a)(this,this.r6,"onFailure"))}catch(Lb){Ed.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Lb,Lb.stack),this.si()}};tg.prototype.onSuccess=function(K){Ed.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");K&&K.data&&K.data.folders&&this.qmb.Zna(K.data.folders[0].id,K.data.folders[0].urls.viewInBrowser,
null,this.Lh)};tg.prototype.r6=function(K){if(K&&K.error){if("user_canceled"===K.error.code){Ed.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}Ed.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",K.error.code,K.error.message)}else Ed.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.si()};Object(ve.a)(tg,"SaveToCloudManager",null,[871]);of.prototype.t7a=function(){return this.vb.ra("SaveToCloudStorageUIIsEnabled")};
of.prototype.dWe=function(){return Sf.a.saveToCloudStorage};of.prototype.B1b=function(){Vg.a.PHd(Object(rf.a)(this,this.hVf,"saveToCloudActionDispatcher"));Vg.a.o8c([new Pg.a(Sf.a.saveToCloudStorage,uh.a.frame,0)],this.Hce.b4a())};of.prototype.Qg=function(){var K=this,ea=this.Hce.b4a();ea?(ea.O9(function(){K.oae.setResult(!0)}),this.B1b()):Ed.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};of.prototype.xMf=function(){Ed.ULS.sendTraceTag(6590597,
216,50,"User clicked on SaveToOneDrive button")};of.prototype.hVf=function(K,ea,Ta,Lb,xc){var qd=this;return ea.contextId!==uh.a.frame||K!==this.dWe()?2:this.t7a()?1===Ta?xi.SessionStatusManager.instance.Swb||he.AFrameworkApplication.r5?8:32:2===Ta?(this.xMf(),xc&&xc.FileDownloadUrl&&Ed.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Dh&&(this.$Vb=this.Dh.Gc("DialogShown","SaveToOneDriveReponseTime")),this.oae.task.continueWith(function(){qd.$Vb&&(qd.$Vb.stop(),
qd.$Vb=null);qd.dvg.start(xc)}),32):8:8};Object(ve.a)(of,"SaveToCloudStorageActor",null,[872]);var vh=b(260),ci=Gh.StandardDialog;Am(gf,ci);gf.prototype.zQ=function(){this.m2.EYa(Object(rf.a)(this,this.BCf,"onSignIn"));this.yk(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(rf.a)(this,this.qbi,"inputHandler"))};gf.prototype.qbi=function(K){0===K?(Ed.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.J6()};gf.prototype.mWg=
function(){var K="2";if(this.XX)switch(this.XX.Sj){case 3:K="0";break;case 2:K="3";break;case 1:K="1"}return K};gf.prototype.hide=function(){this.m2.VHb(Object(rf.a)(this,this.BCf,"onSignIn"));ci.prototype.hide.call(this)};gf.prototype.J6=function(){var K=new vh.QueryStringBuilder("Signin.aspx");K.Xi("prompt","1");K.Xi("cbcxt",this.mWg());he.AFrameworkApplication.vYa(K);Oe.a.jf(K.toString(),"LoginWindow",void 0,"SignInDialog")};gf.prototype.BCf=function(){this.Nq&&this.hide();Ed.ULS.sendTraceTag(7143885,
216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(Sf.a.saveToCloudStorage,2)};Object(ve.a)(gf,"SignInDialog",Gh.StandardDialog,[877]);ze.prototype.create=function(){return new gf(this.La,this.m2,this.XX)};Object(ve.a)(ze,"SignInDialogFactory",null,[870]);od.prototype.execute=function(K,ea){if(!he.AFrameworkApplication.Pg&&he.AFrameworkApplication.Jd){var Ta=this.lFa+this.zfa;Ta=Ng.a.Dl(Ta,"fo",lg.a.mf(this.OSb));Ta=Ng.a.Dl(Ta,"fn",lg.a.mf(this.tA));
Ta=Ng.a.Dl(Ta,"qs",lg.a.mf(this.uPc));Ta=Ng.a.Dl(Ta,"n",lg.a.mf((new Date).getTime().toString()));this.Lh&&this.Lh.FileDownloadUrl&&(Ta=Ng.a.Dl(Ta,"furl",lg.a.mf(this.Lh.FileDownloadUrl)));this.OVa&&(Ta=Ng.a.Dl(Ta,"fnn",lg.a.mf(this.OVa)));he.AFrameworkApplication.Jd.El(Ta,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,K,ea,null)}};Object(ve.a)(od,"SkyDriveUploadCaller",null,[878]);yd.prototype.create=function(K,ea,Ta){return new od(this.mFa,this.tA,ea,K,he.AFrameworkApplication.oj,
this.zfa,Ta)};Object(ve.a)(yd,"SkydriveUploadCallerFactory",null,[869]);Rc.prototype.ULb=function(){this.df&&1===this.df.state||(this.Cm=this.Zkb(),this.Cm.message=CommonUIStrings.l_CommentProgressTooltip,this.Cm.jc=5,this.Cm.qv=!1,this.Cm.PAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};Rc.prototype.xIa=function(){this.Cm&&(this.Cm.close(),this.Cm=null)};Rc.prototype.DS=function(){1!==he.AFrameworkApplication.ta.state&&this.Js().displayError(Fe.default)};Rc.prototype.dQa=function(){Ed.ULS.sendTraceTag(6590599,
216,50,"Redirecting to OneDrive Folder.");Oe.a.jf(this.T8,Oe.a.NX(3),void 0,"UploadToCloudManager.RedirectToFolder")};Rc.prototype.cQa=function(K){var ea=!1,Ta=!1;he.AFrameworkApplication.ga&&(ea=he.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Ta=he.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));Ed.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",K,ea);if(ea&&Ta){Ed.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
var Lb={};Lb[Df.a.ZPa]="1";Lb[Df.a.documentUrl]=K;he.AFrameworkApplication.HV().execute(function(xc){xc.Hj(Zg.a.Wta,Lb)})}else Oe.a.jf(K,Oe.a.NX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};Rc.prototype.Zna=function(K,ea,Ta,Lb){Ta=void 0===Ta?null:Ta;Lb=void 0===Lb?null:Lb;Ed.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Dh&&(this.yga=this.Dh.Gc("DialogShown","SaveToOneDriveUploadTime"));this.ULb();this.T8=ea;this.JCa=this.LSc.create(K,Ta,Lb);this.Lh=Lb;this.IQ()};Rc.prototype.IQ=
function(){Ed.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.JCa.execute(Object(rf.a)(this,this.zQi,"onSaveToCloudUploadFinished"),Object(rf.a)(this,this.yQi,"onSaveToCloudUploadFailed"))};Rc.prototype.zQi=function(K){this.xIa();this.rDa=!1;if(K&&K.data&&K.data.ke){var ea=Jh.d(K.data.ke);var Ta=ea.dv;if(ea.returnValue)if(Ta.StatusCode!==Dh.a.kP&&Ta.StatusCode!==Dh.a.Drb)Ed.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.DS();
else{Ed.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Ta.NewDocumentUrl&&""!==Ta.NewDocumentUrl?this.cQa(Ta.NewDocumentUrl):this.dQa()}catch(Lb){Ed.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",Lb.toString())}this.$Fb()}else Ta={},Ed.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",(Ta.ResponseData=Og.a.Meb(K.data.ke),Ta)),this.DS()}else Ed.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),
this.DS()};Rc.prototype.yQi=function(K){5!==K.data.status&&12!==K.data.status||this.rDa?(Ed.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",K.data.status),this.xIa(),this.DS(),this.$Fb()):(Ed.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.rDa=!0,this.IQ())};Rc.prototype.$Fb=function(){this.yga&&(this.yga.stop(),this.yga=null)};Object(ve.a)(Rc,"UploadToCloudManager",null,[785]);cc.prototype.init=function(){he.AFrameworkApplication.ga.ra("SaveToCloudStorageUIIsEnabled")&&
this.tb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Qg()};cc.prototype.dispose=function(){};cc.prototype.ei=function(K){this.tb=K;this.tb.register(ze,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Oc(function(){return new ze(he.AFrameworkApplication.Ib,wh.a.instance,he.AFrameworkApplication.ta.Qa)}).Hc();this.tb.register(yd,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Oc(function(){return new yd(he.AFrameworkApplication.ga)}).Hc();
this.tb.register(of,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Oc(function(){return new of(K.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),K.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),he.AFrameworkApplication.ga,he.AFrameworkApplication.ta.JD)}).Hc();this.tb.register(Rc,"Common.App.SaveToCloudStorage.UploadToCloudManager").Oc(function(){return new Rc(K.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new Sh.a).create()},
function(){return new hh},he.AFrameworkApplication.ta,he.AFrameworkApplication.ta.JD)}).Hc();this.tb.register(tg,"Common.App.SaveToCloudStorage.SaveToCloudManager").Oc(function(){return new tg(K.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),wh.a.instance,K.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),he.AFrameworkApplication.ga,he.AFrameworkApplication.f2a,function(){return new hh})}).Hc()};cc.main=function(){zf.a.instance.hj(new cc)};Ek.Object.defineProperties(cc.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(ve.a)(cc,"PackageManager",null,[4,5]);Ek.Object.defineProperties(Cb,{gg:{configurable:!0,enumerable:!0,get:function(){return lh.a.cp(Cb.xk,CommonUIStrings.l_SaveACopyFileName)}}});Cb.xk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(ve.a)(Cb,"FileNameDialogHtml",null,[]);var Ih=lh.a;Am(ya,Ih);ya.prototype.zQ=function(K,ea,Ta){this.OSb=K;this.T8=Ta;K={};ea=(K.txtFileName=lg.a.Gq(he.AFrameworkApplication.jm.hn),K.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,ea),K);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(rf.a)(this,this.C9b,"fileNameDialogHandler"),ea);Ed.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};
ya.prototype.C9b=function(K,ea){1!==K?Ed.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(K=ea.txtFileName.trim(),Ed.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),ea=lg.a.C4(he.AFrameworkApplication.fileName),K&&""!==K&&""!==ea&&(K+=ea),this.qmb.Zna(this.OSb,this.T8,K,this.Lh))};Object(ve.a)(ya,"FileNameDialog",lh.a,[879]);Ee.prototype.create=function(K){return new ya(this.La,this.XX,this.qmb,K)};Object(ve.a)(Ee,"FileNameDialogFactory",
null,[874]);var Ae=Gh.StandardDialog;Am(nf,Ae);nf.prototype.displayError=function(K){Ed.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",K);this.bA(K,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(rf.a)(this,this.ILd,"retryDialogHandler"))};nf.prototype.ILd=function(K){1===K?(Ed.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(Sf.a.saveACopy,2)):Ed.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(ve.a)(nf,"RetryDialog",Gh.StandardDialog,[873]);Am(ge,of);ge.prototype.t7a=function(){return this.vb.ra("SaveACopyBrsIsEnabled")};ge.prototype.dWe=function(){return Sf.a.saveACopy};ge.prototype.B1b=function(){Vg.a.PHd(Object(rf.a)(this,this.hVf,"saveToCloudActionDispatcher"));Vg.a.o8c([new Pg.a(Sf.a.saveACopy,uh.a.frame,0)],this.Rsg.b4a())};ge.prototype.xMf=function(){Ed.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(ve.a)(ge,"SaveACopyActor",of,
[]);Am(Mc,tg);Mc.prototype.onSuccess=function(K){K&&K.data&&K.data.folders?(Ed.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.eog.create(this.Lh).zQ(K.data.folders[0].id,K.data.folders[0].name,K.data.folders[0].urls.viewInBrowser)):(Ed.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.si())};Mc.prototype.r6=function(K){K&&K.error&&"user_canceled"===K.error.code&&Ed.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");
tg.prototype.r6.call(this,K)};Mc.prototype.si=function(){Ed.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");tg.prototype.si.call(this)};Object(ve.a)(Mc,"SaveACopyManager",tg,[]);Am(wd,Rc);wd.prototype.wqd=function(){return!!this.Lh&&!!this.Lh.SaveEntryPoint&&"VersionHistory"===this.Lh.SaveEntryPoint.toString()};wd.prototype.DS=function(){Ed.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");if(this.wqd()){var K={};this.La.ve(Sf.a.BKd,2,(K.FailureReason="Unknown",
K))}Rc.prototype.DS.call(this)};wd.prototype.dQa=function(){Ed.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.wqd()&&this.La.processAction(Sf.a.Gtc,2);Rc.prototype.dQa.call(this)};wd.prototype.cQa=function(K){Ed.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",K);this.wqd()&&this.La.processAction(Sf.a.Gtc,2);Rc.prototype.cQa.call(this,K)};wd.prototype.IQ=function(){var K=this;this.Lh&&"true"===this.Lh.SkipSaveToHost?Rc.prototype.IQ.call(this):
32!==this.La.processAction(Sf.a.ZQa,1)?(Ed.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),Rc.prototype.IQ.call(this)):this.La.ve(Sf.a.ZQa,2,[function(){Ed.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Rc.prototype.IQ.call(K)},function(){Ed.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");K.DS()}])};Object(ve.a)(wd,"SaveACopyUploadToCloudManager",
Rc,[]);Lc.prototype.init=function(){he.AFrameworkApplication.ga.sv(Object(rf.a)(this,this.EB,"onFullAppSettingsReady"))};Lc.prototype.EB=function(){he.AFrameworkApplication.ga.ra("SaveACopyBrsIsEnabled")&&this.tb.resolve("Common.App.SaveACopy.SaveACopyActor").Qg()};Lc.prototype.dispose=function(){};Lc.prototype.ei=function(K){this.tb=K;this.tb.register(wd,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Oc(function(){return new wd(he.AFrameworkApplication.Ib,K.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
function(){return(new Sh.a).create()},function(){return new nf(he.AFrameworkApplication.Ib)},he.AFrameworkApplication.ta,he.AFrameworkApplication.ta.JD)}).Hc();this.tb.register(Ee,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Oc(function(){return new Ee(he.AFrameworkApplication.Ib,he.AFrameworkApplication.ta.Qa,K.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).Hc();this.tb.register(ge,"Common.App.SaveACopy.SaveACopyActor").Oc(function(){return new ge(K.resolve("Common.App.SaveACopy.SaveACopyManager"),
K.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),he.AFrameworkApplication.ga,he.AFrameworkApplication.ta.JD)}).Hc();this.tb.register(Mc,"Common.App.SaveACopy.SaveACopyManager").Oc(function(){return new Mc(K.resolve("Common.App.SaveACopy.FileNameDialogFactory"),K.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),wh.a.instance,K.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),he.AFrameworkApplication.ga,he.AFrameworkApplication.f2a,function(){return new nf(he.AFrameworkApplication.Ib)})}).Hc()};
Lc.main=function(){zf.a.instance.hj(new Lc)};Ek.Object.defineProperties(Lc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(ve.a)(Lc,"PackageManager",null,[4,5]);var zi;(function(K){K[K.myFiles=0]="myFiles";K[K.recent=1]="recent";K[K.currentFolder=2]="currentFolder";K[K.yourPhone=3]="yourPhone"})(zi||(zi={}));Object(ve.b)("SharedFilePickerLandingLocation",zi);ac.prototype.b2a=function(K){this._initialized||(K.io(Zg.a.fMf),K.Rl(Zg.a.fMf,Object(rf.a)(this,
this.KPi,"onReceivedPickerResponse")),this._initialized=!0)};ac.prototype.ned=function(K){var ea=this;return this.oLa=new Promise(function(Ta,Lb){var xc={};xc[Df.a.uXi]=K;ea.oab=function(qd,Jd){""===Jd?(Ed.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Ta(qd)):("Canceled"===Jd?Ed.ULS.sendTraceTag(572548164,306,50,Jd):Ed.ULS.sendTraceTag(556901065,306,10,Jd),Lb(Jd))};ea.xkd.execute(function(qd){ea.b2a(qd);qd.Hj(Zg.a.BUi,xc)})})};ac.prototype.KPi=function(K){this.oab(K.Values[Df.a.olj],
void 0===K.Values[Df.a.HDd]||null===K.Values[Df.a.HDd]?"":K.Values[Df.a.HDd])};ac.prototype.Lqd=function(){return he.AFrameworkApplication.ga.ra("UiHostCommonFilePicker")};ac.prototype.ADe=function(K,ea,Ta,Lb,xc,qd,Jd){var De=void 0===De?null:De;var Ve={};Ve[Df.a.alj]=K;Ve[Df.a.titleText]=ea;Ve[Df.a.EIg]=Ta;Ve[Df.a.FIg]=Lb;Ve[Df.a.GIg]=!1;Ve[Df.a.Ffh]=!0;Ve[Df.a.Jzh]=xc;Ve[Df.a.yXi]=qd;Ve[Df.a.xXi]=zi[Jd];Qg.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Ve[Df.a.zXi]="Dark");De&&
(null!=De.nWc&&(Ve[Df.a.nWc]=De.nWc),null!=De.rld&&(Ve[Df.a.rld]=De.rld));return Ve};Object(ve.a)(ac,"SharedFilePickerManager",null,[767]);Of.prototype.ei=function(K){this.tb=K;K.register(ac,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").Hc().Oc(function(){return new ac(K.lc("Postmessage.IHostPostmessenger"))})};Of.prototype.init=function(){var K=this;he.AFrameworkApplication.ga.sv(function(){K.Zxb()})};Of.prototype.Zxb=function(){this.tb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};
Of.prototype.dispose=function(){};Of.main=function(){zf.a.instance.hj(new Of)};Ek.Object.defineProperties(Of.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(ve.a)(Of,"SharedFilePickerPackage",null,[4,5]);var ph=b(1336),yg=b(1047);Me.prototype.$ke=function(K){var ea=!1;K&&(K.n3c(),K.QRg&&(ea=!1));return ea};Me.prototype.K4g=function(){var K=he.AFrameworkApplication.ta.Qa;K=new ph.a(K.Sj,yg.a.Gcc(),!1,1===K.qca);this.$ke(K)&&Ed.ULS.sendTraceTag(17571982,
306,50,"ChromeExtBannerDisplayed")};Me.prototype.Z4b=function(K,ea,Ta,Lb,xc,qd){K=new ph.a(K,Ta,Lb,ea,xc,qd);this.$ke(K)&&Ed.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};Me.prototype.P$g=function(){var K=he.AFrameworkApplication.ta.Qa,ea=he.AFrameworkApplication.ga,Ta=K.Sj,Lb=1===K.qca;if(ea.ra(yg.a.M_h(Ta))){var xc=yg.a.Gcc(),qd=8<Af.a.s5a;if(2!==Ta||2!==xc||!Lb){ea=ea.ra(yg.a.N_h(Ta));var Jd=K.IUf(),De=function(){return K.Px};ea&&!yg.a.jpd(yg.a.cdd(Ta))&&this.Z4b(Ta,Lb,xc,qd,De,Jd)}}};
Me.prototype.init=function(){var K=he.AFrameworkApplication.ga,ea=K.ra("WildFireChromeExtensionEnabled");K=K.ra("WildFireChromeExtensionBar")&&ea;yg.a.Dxc&&K&&!yg.a.jpd(yg.a.aye)?this.K4g():(document.body&&yg.a.uxj&&this.P$g(),he.AFrameworkApplication.Ib.fc(Sf.a.btd,uh.a.frame,Object(rf.a)(this,this.btd,"launchWildFireBusinessBar")))};Me.prototype.btd=function(K,ea,Ta,Lb,xc){if(1===Ta)return 32;if(!xc)return 8;this.Z4b(xc.app,xc.mode,xc.platform,xc.useTwoButton,null,null);return 32};Me.prototype.dispose=
function(){};Me.prototype.ei=function(){};Me.main=function(){zf.a.instance.hj(new Me)};Ek.Object.defineProperties(Me.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(ve.a)(Me,"PackageManager",null,[4,5]);var na=b(228),sb=b(1321),Wb=na.a;Am(vg,Wb);vg.prototype.create=function(){this.Eb(this.$.da.Aa(5)||new sb.a(this.$,!this.$.jba))};vg.ka=function(K){K.da.Ga(4,new vg(K))};Object(ve.a)(vg,"BusinessBarManagerFactory",na.a,[]);var Dc=b(11),nb;"undefined"==
typeof nb&&(nb={});window.MSOJS=nb;nb.tgb=function(){function K(){return Jd()&&(Kj()||3<=(Zh()?uk("version/"):0))}function ea(){return 0<=window.navigator.userAgent.indexOf("Windows")}function Ta(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function Lb(){oj||(oj=!0,fj=xc("Windows Phone"))}function xc(Zf){Zf=(new RegExp(Zf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var rh=-1;return null!=Zf&&2<=Zf.length&&(rh=parseFloat(Zf[1]),isNaN(rh)&&(rh=-1)),rh}function qd(){return"function"==
typeof navigator.msLaunchUri&&!Ta()&&!Bj()&&!De()}function Jd(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function De(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function Ve(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function sg(){return Ve()?8==window.document.documentMode:!1}function mh(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Zh(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}
function Ci(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Bj(){var Zf=window.navigator.userAgent.toLowerCase();return 0<=Zf.indexOf("android")&&0<=Zf.indexOf("chrome")}function Kj(){return 3<=(mh()?uk("firefox/"):0)}function uk(Zf){var rh=window.navigator.userAgent.toLowerCase(),si=rh.indexOf(Zf),ii,Wi;return 0<=si?(ii=si+Zf.length,Wi=rh.length,parseInt(rh.substring(ii,Wi))):0}function Lj(Zf,rh,si,ii,Wi){if(ii&&null!=rh)rh();else if(qd())navigator.msLaunchUri(Zf,
rh,si);else if(!(Ci()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&Jd())||De())ia(Zf,rh,si);else if(Ci()&&Wi)a:{try{window.open(Zf,"_self")}catch(nj){null!=si&&si();break a}null!=rh&&rh()}else G(Zf,rh,si)}function G(Zf,rh,si){var ii=document.getElementById("OICLinkTag"),Wi;null==ii&&(ii=document.createElement("a"),ii.id="OICLinkTag",ii.style.visibility="hidden",ii.href="",ii.target=0==(Cg.Options&gk.SupportsTopTargetNavigation)||
Cg.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(ii),null!=ii.addEventListener&&ii.addEventListener("click",function(nj){null!=nj.stopPropagation&&nj.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Wi=function(nj){var $i=document.createEvent("MouseEvent");return $i.initMouseEvent(nj,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),$i},Wi.prototype=Event.prototype,window.MouseEvent=Wi),ii.href=Zf,ii.dispatchEvent(new MouseEvent("click"))}catch(nj){null!=si&&si();return}null!=
rh&&rh()}function ia(Zf,rh,si){var ii=document.getElementById("OICFrame");null==ii&&(ii=document.createElement("iframe"),ii.className="ObjectInDialog",ii.style.visibility="hidden",ii.src="about:blank",document.body.appendChild(ii),ii.id="OICFrame");try{ii.contentWindow.location.href=Zf}catch(Wi){null!=si&&si();return}null!=rh&&rh()}function eb(Zf){return 0!=(Zf.Options&gk.SkipProtocolHandler)||sg()}function Fb(Zf){return Zf===Wj.ReadOnly||Zf===Wj.ReadWrite}function Oc(Zf,rh,si,ii){var Wi,nj;try{if(Wi=
new ActiveXObject(Fj),Wi)return nj=Wi.ViewDocument3(window.self,Zf,rh,ii),nj?(ej(Dk.O14ActiveX),gj.None):gj.Failed}catch($i){}if(gk.O14Only===(si&gk.O14Only))return Cg.DescriptiveUnattemptedEnums?gj.O14AttemptFailure:gj.Unattempted;try{if(Wi=new ActiveXObject(ul),Wi)return nj=Wi.ViewDocument3(window.self,Zf,rh,ii),nj?(ej(Dk.O12ActiveX),gj.None):gj.Failed}catch($i){}if(gk.O12UpOnly===(si&gk.O12UpOnly))return Cg.DescriptiveUnattemptedEnums?gj.O12UpOnlyFail:gj.Unattempted;try{if(Wi=new ActiveXObject(vl),
Wi)return nj=Fb(rh)?Wi.ViewDocument2(window.self,Zf,ii):Wi.EditDocument2(window.self,Zf,ii),nj?(ej(Dk.O11ActiveX),gj.None):gj.Failed}catch($i){}return Cg.DescriptiveUnattemptedEnums?gj.ActiveXUnattempted:gj.Unattempted}function Tc(Zf,rh,si,ii,Wi){var nj,$i,rk;Zf==Cj.Visio&&si==Wj.ReadWrite&&(si=Wj.WriteOnly);Zf=Wi;(ii=ii||Ta()&&!(Lb(),8<=fj))||(nj="",nj+=Fb(si)?k+H:Y,nj+=za,Zf+=Qd(nj));Zf+=Qd(rh);Cg.NewTelemetryDataIsEnabled&&($i=-1!==Zf.indexOf("?")?"&":"?",$i+=Cg.SessionOrigin?"OR="+Cg.SessionOrigin+
"&":"",$i+=Cg.ClickTime?"CT="+Cg.ClickTime+"&":"",$i+=Cg.CorrelationId?"CID="+Cg.CorrelationId:"",$i="?"!=$i?$i:"",$i="&"!=$i.slice(-1)?$i:$i.slice(0,-1),Zf+=Qd($i),Cg.CorrelationIdForWinClient&&(Zf+=Qd(Cg.CorrelationIdForWinClient)));rh=window.location.href;si=Pb;ii=rh.toLowerCase().indexOf("&"+si+"=");var ak;si=-1==ii?void 0:(rk=ii+(si.length+2),ak=rh.indexOf("&",rk),-1==ak)?rh.substr(rk):rh.substring(rk,ak);if(null!=si&&"undefined"!=typeof si){rk="";try{rk=decodeURIComponent(si)}catch(ol){}0<rk.length&&
RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(rk)&&(Zf+=Va,Zf+=rk)}return Zf}function Md(Zf,rh,si,ii,Wi,nj){var $i=yi(Zf),rk;return null==$i?(tj(Cg.DescriptiveUnattemptedEnums?gj.ProtocolHandlerIsNull:gj.Unattempted,Cg.Application),!1):(rk=Tc(Zf,rh,si,ii,$i),Lj(rk,Je,kf,Wi,nj),!0)}function Qd(Zf){if(Jd()&&Ci()){var rh="";try{rh=decodeURI(Zf)}catch(si){}if(rh==Zf)return encodeURI(Zf)}return Zf}function Je(){ej(Dk.ProtocolHandler)}function kf(){Cg.Options|=gk.SkipProtocolHandler;
Rj(Cg,ld,ef)}function xf(){null!=Jf&&Jf(Dk.RoamingProtocolHandler)}function og(){null!=Kg&&Kg(gj.ControlNeeded)}function Ug(){var Zf=document.getElementById(Al),rh;if(null==Zf){if(rh=xl,Jd()&&3<=(Zh()?uk("version/"):0)&&kh(wl,!0)&&(rh=wl),!kh(rh,!0))if(Jd()&&kh(zl,!0))rh=zl;else return null;Zf=document.createElement("object");Zf.id=Al;Zf.type=rh;Zf.style.width="0px";Zf.style.height="0px";Zf.style.setProperty("visibility","hidden","");document.body.appendChild(Zf);Zf=document.getElementById(Al)}return Zf}
function kh(Zf,rh){var si=window.navigator.mimeTypes,ii;return null==si?!1:(ii=si[Zf],ii)?rh&&!ii.enabledPlugin?!1:!0:!1}function Yi(Zf){try{if(null!=new ActiveXObject(Zf))return!0}catch(rh){}return!1}function Ah(Zf){switch(Zf){case Cj.OneNote:return Cl;default:return""}}function yi(Zf){if(Zf!=Cj.OneNote&&Ta()&&!(Lb(),8<=fj))return"office:";switch(Zf){case Cj.Excel:return"ms-excel:";case Cj.OneNote:return"onenote:";case Cj.PowerPoint:return"ms-powerpoint:";case Cj.Visio:return"ms-visio:";case Cj.Word:return"ms-word:";
case Cj.Project:return"ms-project:";case Cj.Publisher:return"ms-publisher:";case Cj.Infopath:return"ms-infopath:";case Cj.Access:return"ms-access:";default:return""}}function Ki(Zf){switch(Zf){case Cj.Excel:return"root\\office15\\excel.exe";case Cj.PowerPoint:return"root\\office15\\powerpnt.exe";case Cj.Visio:return"root\\office15\\visio.exe";case Cj.Word:return"root\\office15\\winword.exe";case Cj.Project:return"root\\office15\\winproj.exe";case Cj.Publisher:return"root\\office15\\mspub.exe";case Cj.Infopath:return"root\\office15\\infopath.exe";
case Cj.Access:return"root\\office15\\msaccess.exe";default:return null}}function Rj(Zf,rh,si){if(Cg=Zf,ld=rh,ef=si,Zf.DocumentUrl){var ii=si=rh=Zf.DocumentUrl;try{ii=decodeURIComponent(Zf.DocumentUrl)}catch(ol){}try{si=encodeURI(Zf.DocumentUrl)}catch(ol){}Cg.NewTelemetryDataIsEnabled||(rh=rh+""+Zf.CorrelationIdForWinClient,ii+=Zf.CorrelationIdForWinClient,si+=Zf.CorrelationIdForWinClient);Zf.Mode===Wj.ReadWrite&&gk.CheckoutRequired===(Zf.Options&gk.CheckoutRequired)&&(Zf.Mode=Wj.ForceCheckout);gk.HostIsEditOnly===
(Zf.Options&gk.HostIsEditOnly)&&(Zf.Mode=Wj.WriteOnly);if(eb(Zf)?0:Jd()&&(Zf.Application==Cj.OneNote||kh(yl,!1)||kh(hl,!1))||qd()||Bj()||!(K()||Kj()||"ActiveXObject"in window&&!Ta()||Ci())||15<=fk())Md(Zf.Application,Zf.EncodeUrl?si:rh,Zf.Mode,Zf.Application==Cj.OneNote,Zf.SilentExternalHandler,Zf.NavigateUsingWindowOpen);else{var Wi;if(Wi=sg())a:{var nj=Zf.EncodeUrl?rh:ii,$i=Zf.Mode,rk=Ah(Zf.Application);try{Wi=(new ActiveXObject(qk)).ViewDocument3(window.self,nj,$i,rk);break a}catch(ol){}Wi=!1}if(Wi)ej(Dk.O15ActiveX);
else{if(K()||Kj()){var ak=Zf.EncodeUrl?rh:ii;ii=Zf.Mode;Wi=Ah(Zf.Application);nj=Ug();if(null==nj)ak=Cg.DescriptiveUnattemptedEnums?gj.PluginIsNull:gj.Unattempted;else{$i=!1;try{$i=nj.ViewDocument3(window.self,ak,ii,Wi)}catch(ol){}if(!$i)try{$i=Fb(ii)?nj.ViewDocument2(window.self,ak,Wi):nj.EditDocument2(window.self,ak,Wi)}catch(ol){}ak=$i?(ej(Dk.NpapiPlugin),gj.None):gj.Failed}}else{try{ak=new ActiveXObject(Bl),null!=ak&&ak.SaveSSOCreds()}catch(ol){}ak=Oc(Zf.EncodeUrl?rh:ii,Zf.Mode,Zf.Options,Ah(Zf.Application))}if(ak!=
gj.None){if(ii=Zf.CouldUseRoamingApps)Wg||(Wg=!0,wi=xc("Windows NT")),ii=6.1<=wi&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(Ve()||Kj()||Ci());if(ii&&Zf.Application!=Cj.OneNote){if(!nb.tgb.JXj()){tj(gj.ControlNeeded,Cg.Application);return}if(Zf.RoamingAppsLauncher){"undefined"==typeof Zf.RoamingAppsLauncher||null==Zf.RoamingAppsLauncher?tj(Cg.DescriptiveUnattemptedEnums?gj.RoamingLauncherIsNull:gj.Unattempted,Cg.Application):"undefined"==typeof Zf.RoamingBitsUrl||null==Zf.RoamingBitsUrl?nb.tgb.WXj(Zf.DocumentUrl,
Zf.RoamingAppsLauncher,Zf.Application,Zf.ApplicationParameters,ld,ef):nb.tgb.xig(Zf.DocumentUrl,Zf.RoamingAppsLauncher,Zf.RoamingApplicationExe,Zf.ApplicationParameters,Zf.RoamingPlatform,Zf.RoamingBitsUrl,ld,ef);return}if(!Zf.ContinueIfLauncherIsNull){tj(gj.LauncherNeeded,Cg.Application);return}}gk.NoProtocolHandlerFallback==(Zf.Options&gk.NoProtocolHandlerFallback)||eb(Zf)||Ve()||Jd()&&!(Cg.DescriptiveUnattemptedEnums?ak>=gj.O14Unattempted&&ak<=gj.DocumentUrlIsNull:ak==gj.Unattempted)?tj(ak,Cg.Application):
Md(Zf.Application,Zf.EncodeUrl?si:rh,Zf.Mode,Zf.Application==Cj.OneNote,Zf.SilentExternalHandler,Zf.NavigateUsingWindowOpen)}}}}else tj(Cg.DescriptiveUnattemptedEnums?gj.DocumentUrlIsNull:gj.Unattempted,Cg.Application)}function ej(Zf){null!=ld&&ld(Zf)}function tj(Zf,rh){"undefined"==typeof rh&&(rh=null);null!=ef&&ef(Zf,rh)}function fk(){var Zf=0;if(K()||Kj()||Ci()){var rh=Ug();try{null!=rh&&(Zf=rh.GetOfficeVersion())}catch(si){}}else Yi(qk)?Zf=15:Yi(Fj)?Zf=14:Yi(ul)?Zf=12:Yi(vl)&&(Zf=11);return Zf}
function pk(){return Jd()&&(kh(xl,!0)||kh(wl,!0))}var qk="SharePoint.OpenDocuments.5",Fj="SharePoint.OpenDocuments.4",ul="SharePoint.OpenDocuments.3",vl="SharePoint.OpenDocuments.2",xl="application/x-sharepoint",wl="application/x-sharepoint-webkit",yl="application/x-sharepoint-protocolhandler",hl="application/x-sharepoint-webkit-protocolhandler",zl="application/officelive",Al="npSharePointPlugin",Bl="IDBHO.IDBHOCtrl",Cl="OneNote.Notebook",k="ofv|",H="ofc|",Y="ofe|",za="u|",Va="|f|",Pb="wdlor",Ac=
"",id="",Ld="",ld,ef,Jf,Kg,Cg,Wg,wi,oj,fj,Wj={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},gk={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},gj={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,
RoamingLauncherIsNull:12,DocumentUrlIsNull:13},Dk={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Cj={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Wj,OpenDocumentOptions:gk,OpenDocumentFailureType:gj,OpenDocumentControl:Dk,OfficeApplication:Cj,EditDocumentInClient:Rj,EditDocumentInClientParams:function(){this.DocumentUrl=
"";this.Options=this.Mode=0;this.Application=Cj.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},
OfficeVersionInstalled:fk,IsO14MacPluginInstalled:pk,OfferOfficeInDialog:function(){return ea()&&11>=fk()},OfferOfficeNoIntrusive:function(){return ea()&&15>fk()},OfferMacOffice:function(){return Jd()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!pk()},InstallRoamingControl:function(){mh()?window.InstallTrigger.install({Office:{URL:id}}):ia(Ld,null,null)},CanUseRoamingControl:function(){var Zf,rh,si;if(qd())return!0;if(Ci())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),
!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(mh())return Zf=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Zf),rh=document.createEvent("Events"),rh.initEvent("RoamingOfficeInstalled",!0,!1),Zf.dispatchEvent(rh),!!Zf.getAttribute("installed");if(Ve())try{return si=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),si.HrExists()}catch(ii){}return!1},InitUrls:function(Zf,rh,si){Ac=Zf;id=si;Ld=rh},LaunchRoamingApps:function(Zf,rh,si,ii,Wi,nj){nb.tgb.xig(Zf,
rh,Ki(si),ii,"x86",Ac,Wi,nj)},LaunchRoamingApps2:function(Zf,rh,si,ii,Wi,nj,$i,rk){var ak="",ol;if(null!=ii&&(ak+=" "+ii),null!=Zf&&(ak+=' "'+Zf+'"'),qd()||Ci())Jf=$i,Kg=rk,$i='office: "'+(nj+'" "')+(si+'" "ROAMING"'),$i+=' "'+rh+'"',$i+=' "'+Wi+'"',$i+=" "+ak,Lj($i,xf,og,!1,!1);else if(mh())Zf=document.createElement("RoamingExtensionElement"),Zf.setAttribute("cabUrl",nj),Zf.setAttribute("app",si),Zf.setAttribute("licensingEntitlements",rh),Zf.setAttribute("platform",Wi),Zf.setAttribute("args",ak),
document.documentElement.appendChild(Zf),rh=document.createEvent("Events"),rh.initEvent("RoamingOfficeLaunch",!0,!1),Zf.dispatchEvent(rh),null!=$i&&$i(Dk.RoamingFFExtension);else if(Ve()){if(ol=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=ol)try{ol.HrConfigureSingle(nj,si,rh,Wi,ak),null!=$i&&$i(Dk.RoamingActiveX)}catch(Gl){}}else null!=rk&&rk(gj.Failed)},ShouldShowDialog:function(){return!Ta()},NavigateToUrlUsingClickingOnATag:G,OpenDocumentWithProtocolHandler:Md,OpenDocumentWithProtocolHandlerNoCallBack:function(Zf,
rh,si,ii){var Wi=yi(Zf),nj;return null==Wi?(tj(Cg.DescriptiveUnattemptedEnums?gj.ProtocolHandlerNoCallbackIsNull:gj.Unattempted,Cg.Application),!1):(nj=Tc(Zf,rh,si,ii,Wi),Lj(nj,null,null,!1,!1),!0)}}}();nb.ClientUtils=nb.tgb;var Yc=b(906),ee=b(51),ye=b(36),lf=b(186);fh.prototype.Zc=function(){return!1};fh.prototype.executeCommand=function(K,ea,Ta){return 2!==this.Di.ve(Sf.a.newDocument,2,Ta)?Ch.Task.Sa(!0):lf.a(ea.command)};fh.prototype.Lc=function(K,ea){return 1056925771===ea.command};fh.prototype.jd=
function(K,ea,Ta){K=!0;switch(ea){case "PopulateNewMenu":this.Di&&this.Di.ve(Sf.a.iqc,2,Ta);break;default:K=!1}return K};Object(ve.a)(fh,"CreateNewCommandHandler",null,[429]);var Ef=Yc.a;Am(dh,Ef);dh.prototype.Nd=function(){var K=this,ea=ee.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),Ta=ee.GetServiceTaskFactory.create(this.$.da,165,this.la,this.ub);ye.TaskExtensions.Ba(ye.TaskExtensions.ye([ea,Ta],this.la),function(){K.Cd([new fh(he.AFrameworkApplication.Ib)])},this.la,3)};dh.ka=function(K){Yc.a.fe(87,
new dh(K))};Object(ve.a)(dh,"CreateNewCommandHandlerFactory",Yc.a,[]);var O=b(1317),da=b(962),Pa=b(275),rb=b(206),d=b(300),A=b(5),S=b(159),ja=b(102),Ua=b(79),kc=b(75),tb=b(387),$c=b(175),zd=b(59),qe=b(84),Te=b(336),qf=b(650);rg.prototype.kse=function(){};rg.prototype.U6c=function(){this.Wsg?Oe.a.downloadFile(this._url):Oe.a.jf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};rg.prototype.dispose=function(){};Object(ve.a)(rg,"OpenUrlInTabDialogDownloadBehavior",null,[41,
3]);var la=b(257),ab=Gh.StandardDialog;Am(Cf,ab);Cf.prototype.vXc=function(){this.$l&&(this.TVa||(this.TVa=Object(rf.a)(this,this.gFi,"onActionButtonClicked"),this.Vy.pa(ag.a.click,this.WB,this.TVa)),this.UVa||(this.UVa=Object(rf.a)(this,this.hFi,"onActionButtonKeyUp"),this.pe.pa(ag.a.Ud,this.WB,this.UVa)));ab.prototype.vXc.call(this)};Cf.prototype.gFi=function(K){this.jRe(K);return!0};Cf.prototype.hFi=function(K){return this.uif(K,Object(rf.a)(this,this.jRe,"executeDismissActionButtonFromArgs"))};
Cf.prototype.jRe=function(K){this.$l&&this.$l.submit();this.xua(K.Lb)};Cf.prototype.$td=function(){};Cf.prototype.hJe=function(){this.slf();this.$l?this.$l.submit():this.fSb.U6c();return!0};Cf.prototype.Ijc=function(){return!1};Cf.prototype.dispose=function(){this.fSb.dispose();this.bib&&(he.AFrameworkApplication.ta.DX.za(ag.a.click,this.bib,Object(rf.a)(this,this.hJe,"downloadLinkClicked")),this.bib=null);this.mY&&(he.AFrameworkApplication.ta.DX.za(ag.a.click,this.mY,Object(rf.a)(this,this.Ijc,"learnMoreLinkClicked")),
this.mY=null);this.Vy&&this.TVa&&(this.Vy.za(ag.a.click,this.WB,this.TVa),this.TVa=null);this.pe&&this.UVa&&(this.pe.za(ag.a.Ud,this.WB,this.UVa),this.UVa=null);ab.prototype.dispose.call(this)};Cf.prototype.fLf=function(){this.$l&&(document.body.appendChild(this.$l),this.$l.submit(),document.body.removeChild(this.$l))};Cf.prototype.Aw=function(K){1===K&&(this.$td(),this.$l?Cf.Fu&&this.fLf():this.fSb.U6c());this.dispose()};Ek.Object.defineProperties(Cf.prototype,{R8e:{configurable:!0,enumerable:!0,
get:function(){return null}},UVd:{configurable:!0,enumerable:!0,get:function(){return null}},jOa:{configurable:!0,enumerable:!0,get:function(){return null}},zBb:{configurable:!0,enumerable:!0,get:function(){return null}},d8a:{configurable:!0,enumerable:!0,get:function(){return null}},Gpf:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_Open}},F4c:{configurable:!0,enumerable:!0,get:function(){return null}},XVc:{configurable:!0,
enumerable:!0,get:function(){return null}},woe:{configurable:!0,enumerable:!0,get:function(){return null}}});Ek.Object.defineProperties(Cf,{Fu:{configurable:!0,enumerable:!0,get:function(){return he.AFrameworkApplication.ta.Qa.vv&&he.AFrameworkApplication.ta.Qa.Cff}},txb:{configurable:!0,enumerable:!0,get:function(){return Cf.H7d},set:function(K){Cf.H7d=K}}});Cf.H7d=!1;Object(ve.a)(Cf,"ADialogWithLinkToResource",Gh.StandardDialog,[]);var ec=b(440),Vc=b(331),Kc=b(15);Am(Gg,Cf);Gg.prototype.qlf=function(){Ed.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};Gg.prototype.slf=function(){Ed.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};Gg.prototype.Ijc=function(){ec.Redirect.showHelp(Vc.a.BEi);return!0};Ek.Object.defineProperties(Gg.prototype,{jOa:{configurable:!0,enumerable:!0,get:function(){return Kc.a.instance.Wa(411)}},Pjc:{configurable:!0,enumerable:!0,get:function(){return Kc.a.instance.Wa(412)}},
Ojc:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},zBb:{configurable:!0,enumerable:!0,get:function(){return"#"}},d8a:{configurable:!0,enumerable:!0,get:function(){return Kc.a.instance.Wa(413)}},Gpf:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(ve.a)(Gg,"DownloadACopyAsOdsDialog",Cf,[]);ug.prototype.kse=function(K){this.dialog=K};ug.prototype.U6c=function(){this.YEi.jEf(-1059172980)};ug.prototype.dispose=function(){this.zb.aIb(this.Ovf)};Object(ve.a)(ug,
"DownloadACopyAsOdsDialogDownloadBehavior",null,[41,3]);Object(ve.a)(Wf,"MacroRecorderWorkbookCalculationModeSetPayload",null,[445]);Object(ve.a)(wf,"MacroRecorderWorkbookRecalculatedPayload",null,[445]);var Fd=b(195),te=b(109),hf=b(1),Yf=b(323);Ek.Object.defineProperties(vf,{jUi:{configurable:!0,enumerable:!0,get:function(){return vf.iUi}}});vf.iUi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(ve.a)(vf,"OpenInAppDialogCopyHtml",null,[]);var mg=b(156),cg=Yf.a;Am(Ze,cg);Ze.prototype.openUrl=function(K,ea){var Ta=document.getElementById("link");Ta||(Ta=document.createElement("a"),Ta.id="link",Ta.style.visibility="hidden",Ta.href="",document.body.appendChild(Ta));Ta.target=ea;Ta.href=K;Ta.click()};Ze.prototype.jEc=function(){var K=this;Ed.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.Va(this.$.da,21,137,1),function(ea){var Ta=
{};Ta.OpenInAppUrl=K.Lla;Ta.StoreUrl=K.um;ea.result.Hj("UI_OpenInMobileApp",Ta)},this.$.la)};Ze.prototype.kUi=function(){Ed.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};Ze.prototype.hh=function(){this.gg=lh.a.cp(vf.jUi,Kc.a.instance.fa(664),Kc.a.instance.fa(665),he.AFrameworkApplication.VC,mg.getImageClass(he.AFrameworkApplication.ga.Ua("AppIcon")),Kc.a.instance.fa(666));this.Pe="OpenInAppDialog";this.jc=5;this.initializeAndShow("",this.kUi.bind(this),null);this.$z(this.eI)};
Ze.prototype.Iv=function(K){cg.prototype.Iv.call(this,K);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.eI=document.getElementById("LinkToInstall");Fd.a.instance.pa(ag.a.click,this.eI,this.WDb);te.KeyInputManager.instance.pa(ag.a.Ud,this.eI,this.vya)};Ze.prototype.dispose=function(){this.eI&&(Fd.a.instance.za(ag.a.click,this.eI,this.WDb),te.KeyInputManager.instance.za(ag.a.Ud,this.eI,this.vya),this.eI=null);cg.prototype.dispose.call(this)};Ek.Object.defineProperties(Ze.prototype,
{Cc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(ve.a)(Ze,"OpenInAppDialogCopy",Yf.a,[]);Td.prototype.jEc=function(){var K=this;Ed.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.Va(this.$.da,21,137,1),function(ea){var Ta={};Ta[Df.a.pEf]=K.Lla;Ta[Df.a.um]=K.um;ea.result.Hj("UI_OpenInMobileApp",Ta)},this.$.la)};Td.prototype.hh=function(){Ed.ULS.sendTraceTag(523534412,0,
50,"initializeAndShowDialog: React Edit in app dialog opened.");var K=new Gh.StandardDialog;K.jc=0;K.Dc(1,Kc.a.instance.fa(670));K.yk(Kc.a.instance.fa(668),Kc.a.instance.fa(669),0,this.Lig)};Object(ve.a)(Td,"OpenInAppDialogReact",null,[]);var Sg=b(28),$g=b(30),ti=b(370),Hh=b(10),Lg=b(291),Tg=b(22),Vh=b(43),fi=b(258),Gj=b(492),Zi=b(395),Sj=b(49),oh=b(6),Li=b(145),Ai=b(1171),Ri=b(81),ki=b(34),Pi=b(377),Ni=b(261);Od.prototype.WQ=function(K,ea){K=$g.a.gd(12,1,671,0,0,0,"Blank");K.Description=String.format(Kc.a.instance.fa(672),
ea);return K};Od.prototype.$$b=function(K){switch(K){case 1:case 2:return 0;default:return 2}};Object(ve.a)(Od,"ReloadCloseConfirmation",null,[722]);var be=b(154),V=b(651),Ga=b(66),Bb=rb.a;Am(Bd,Bb);Bd.prototype.Zc=function(){return!1};Bd.prototype.executeCommand=function(K,ea,Ta,Lb){var xc=this,qd=this.h7b,Jd=this.$,De=ea.command,Ve=this.openInExcelOperation,sg=this.$.Mb,mh=Ta.SourceControlId;Jd.Uk.Zle(De);Ve.Gwc(ea.startTime.getTime().toString());K=null;switch(De){case 1455037301:this.$.y5?Ve.FBe():
Ve.D2c();break;case -2044628748:case 2004484710:this.$.y5?Ve.FBe():Ve.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===mh?(this.aCb("CellLongPress"),Ed.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.aCb("PencilIcon"),Ed.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();
break;case -2028960985:Ve.m5f();break;case -1059172980:new Gg(Ve.Fue(De),new ug(Ve,Jd.zb));break;case -1285148982:this.clientWorkflow.ud.activityState[ki.a.$Tc]=!0;this.NAc(!1);break;case -75280711:this.NAc(!1);break;case -455164169:this.NAc(!0);break;case -1388494670:this.$.da.$a(400,function(G){G.byi();xc.NAc(!1)});break;case 810888577:he.AFrameworkApplication.uk=(new Date).getTime();Ed.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",he.AFrameworkApplication.uk);
break;case -1804063550:case -974518828:ea=0;A.a.qCd in Ta&&(ea=Ta[A.a.qCd]);Ve.jEf(De,ea);break;case -1339961039:ea=!1;Ta&&A.a.WIb in Ta&&(ea=Ta[A.a.WIb]);this.reloadWorkbook(!1,ea);break;case -8805455:var Zh=this.workbookContext;Jd.isEditMode||(Bd.jze(Jd),K=ye.TaskExtensions.Ba(this.cK.value,function(G){G=G.result;var ia=G.isEnabled();ia&&qf.a(G,Zg.a.copyAndEdit,zd.a.Fg.SXe(),xc.$.ea.Zg.get(2))?Ed.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):
ia&&he.AFrameworkApplication.Ydg?(ia={},ia[O.a.iFd]=he.AFrameworkApplication.userSessionId,ia[he.AFrameworkApplication.nAi]=Sg.a.Ta.Wb.getTime().toString(),Ed.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),G.Hj(Zg.a.editMode,ia)):qd.CopyAndEditUrl?xc.f3g():(xc.xc.supportsEditing||Zh.EditUrl)&&xc.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Jd.isEditMode&&(Bd.jze(Jd),
this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var Ci=Jd.na.ua.hc(),Bj=-1355155015===De?1:0,Kj=function(){return new wf(Bj)};K=tb.a(this.$.userOperationManager,function(G,ia,eb){return qe.V(Jd.na.ua,Bj,null,G,ia,eb,null,Ci)},function(G){return new $c.a(128,0,G,void 0,Kj)},ea);Tg.g(Jd).rg.dH(!1);break;case -1158102843:K=Tg.g(Jd).rg.recalcSheet(ea);Tg.g(Jd).rg.dH(!1);break;case -988468372:if(hf.EwaSettings.ma(302))if(Lb=parseInt(Ta[Ua.a.ld],10),0<=Lb&&3>Lb)this.setCalculationMode(ea,
Lb);else return Ed.ULS.sendTraceTag(537162652,0,10,"SetCalculationMode , unexpected menuItemId: {0}",Ta[Ua.a.ld]),lf.a(De);break;case 257398710:S.a.ntw(qd.ReportAbuseUrl,Jd);break;case 1800405051:this.Vij();break;case -48469327:this.saveACopy();break;case 214430355:ea=!1;Ta&&A.a.E7c in Ta&&(ea=Ta[A.a.E7c]);if(!this.Cwj(ea,Ta))break;he.AFrameworkApplication.r5?this.businessBar.eg(40,null):this.businessBar.eg(ea?22:23,null);break;case 1389557314:K=ye.TaskExtensions.Ba(this.cK.value,function(G){qf.a(G.result,
Zg.a.Kzh,null,xc.$.ea.Zg.get(6))||S.a.ntw(qd.FileVersionUrl,Jd)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:mh===sg+A.a.lif?Ve.Mqi():Ve.Lqi();break;case 512141517:mh===sg+A.a.kif?Ve.Xqi():Ve.Wqi();break;case -1224038235:var uk=da.a.On in Ta?!Ta[da.a.On]:ja.j(Jd.ea.workbookContext.Options);Ta[da.a.Description]=uk?Kc.a.instance.fa(573):Kc.a.instance.fa(574);K=tb.a(this.$.userOperationManager,function(G,ia,eb){var Fb=xc.$.na.ua,Oc=Fb.Na(9,null);Oc.isReadOnlyRecommended=
!uk;return qe.i(Fb,"SetReadOnlyRecommended",Oc,G,ia,eb,null,0)},function(G){return new $c.a(129,0,G)},ea);break;case 1118926154:if(this.$.isEditMode){var Lj=new Di.a;this.$.da.$a(53,function(G){G?(G.Vm.Gqi(xc.$.Mb+A.a.Xrd),Lj.setResult(!0)):Ed.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});K=Lj.task}break;case -1698025133:Ve.openInBrowser();break;case 520859864:K=ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.Va(this.$.da,393,394,Lb.Dja()),
function(G){G.result||Ed.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:K=lf.a(De)}return K||Ch.Task.Sa(!0)};Bd.prototype.aCb=function(K){if(hf.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(Hh.HelperMethods.n_){var ea=new Map;ea.set("EntryPoint",K);Ke.Health.instance.recordKpiUsage(Zi.a.hUi,0,Gj.a.Yzi,ea)}else Ed.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};
Bd.prototype.showOpenInAppDialog=function(){he.AFrameworkApplication.isMobileMode&&(this.$.ya.IsMeetingLiveSession&&hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(Ed.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new Td(this.$)).hh()):hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(Ed.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),
(new Ze(this.$)).hh()):(Ed.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),he.AFrameworkApplication.showOpenInAppDialog()))};Bd.prototype.Cwj=function(K,ea){var Ta=this;return he.AFrameworkApplication.isMobileMode&&!kc.a(this.$.ya,30)?(this.showOpenInAppDialog(),Ed.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.aCb("CellDoubleTap"),
Ed.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):he.AFrameworkApplication.khc&&(K&&ti.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(Ed.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",ti.d(this.workbookContext.WorkbookFileName)?
"xls":"csv",this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""),!1):Pa.a.any([25,26,30,31,55,32],function(Lb){return Ta.businessBar.mMa(Lb)})?(Ed.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):ea&&A.a.n1i in ea&&!K?!1:!0};Bd.prototype.Lc=function(K,ea){K=!1;switch(ea.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:K=
!0;break;case 520859864:K=hf.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case -1285148982:case -75280711:case -455164169:K=hf.EwaSettings.ma(109);break;case -1388494670:K=hf.EwaSettings.ma(109);break;case 810888577:K=hf.EwaSettings.ma(271);break;case -1224038235:K=this.$.ea.amIAlone;break;case -988468372:K=hf.EwaSettings.ma(302);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:K=!0,Ed.ULS.shipAssertTag(537162642,0,this.$.uka,
"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return K};Bd.prototype.jd=function(){return!1};Bd.prototype.Vij=function(){var K=this;if(this.sc){var ea=this.$;Vh.a(ea).wt(new fi.a(oh.a.wz,5,function(){ea.sI(!1,!0);var Ta=K.clientWorkflow.ud.activityState;Ta[Ni.a.hr]=oh.a.Dda;Ta[Li.a.aU]=2;Ta[ki.a.Ss]=ea.isEditMode;Ta[Li.a.Fga]=!1}))}};Bd.prototype.saveACopy=function(){var K=this;if(this.sc){var ea=this.$;Vh.a(ea).wt(new fi.a(oh.a.wz,5,function(){ea.sI(!1,
!1);var Ta=K.clientWorkflow.ud,Lb=Ta.activityState;Lb[Ni.a.hr]=oh.a.GUf;Lb[V.a.MYb]=K.xc.hasUnsupportedFeaturesForEdit;Lb[Li.a.Fga]=!1;Ta.Lt($g.a.raa(K.businessBar.T7c,[-502303485]))}))}};Bd.prototype.NAc=function(K){var ea=this;Vh.a(this.$).wt(new fi.a(oh.a.qna,2,function(){ea.$.sI(!0,!0);var Ta=Ga.a(ea.$).ud,Lb=ea.$.isEditMode;Lb=$g.a.gd(1,1,0,0,0,Lb?-315732528:-2087635043,Lb?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Lb.ForceVersionUpgrade=K;Ta.Lt([Lb]);Ta=Ga.a(ea.$).ud.activityState;
Ta[Ni.a.hr]=oh.a.qna;Ta[ki.a.Ss]=ea.$.isEditMode;Ta[Li.a.Fga]=!1}))};Bd.prototype.closeWorkbook=function(){var K=this;if(this.sc){var ea=this.$;zd.a.Fg.cxc("2145659238")?ye.TaskExtensions.Ba(this.cK.value,function(Ta){Ta.result.Hj(Zg.a.sSe,{})},this.la,3):Vh.a(ea).wt(new fi.a(oh.a.wz,5,function(){ea.sI(!0,!1);var Ta=K.clientWorkflow.ud.activityState;Ta[Li.a.EY]=!1;Ta[Li.a.Fga]=!1;K.xc.inViewerFromWebPart?(Te.a.XFd(ea,K.clientWorkflow.ud),ea.Uk.cz("InViewerFromWebPart"),Ta[Ni.a.hr]=oh.a.Q_):(Ta[Ni.a.hr]=
oh.a.Jk,ea.Pd&32?Ta[Li.a.aU]=0:(Ta[Li.a.aU]=1,Ta[Li.a.BYb]=new Ai.a),Ta[be.a.yke]=!0)}))}};Bd.prototype.f3g=function(){var K=this,ea=this.xc.vbaRemovedDuringConversion;Ed.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",ea);var Ta=this.$;ea?Vh.a(Ta).wt(new fi.a(oh.a.wz,5,function(){var Lb=$g.a.gd(3,0,0,1235,0,1069271157,"XLSMacroFailure");K.clientWorkflow.ud.Lt([Lb]);K.clientWorkflow.ud.activityState[Ni.a.hr]=oh.a.Eeb})):he.AFrameworkApplication.hideHeader?
Hh.HelperMethods.jf(this.h7b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):S.a.ntw(this.h7b.CopyAndEditUrl,Ta)};Bd.prototype.reloadWorkbookInEditMode=function(){var K=this;if(this.sc)if(hf.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&zd.a.Fg.cW&&zd.a.Fg.GHd(),he.AFrameworkApplication.khc&&!he.AFrameworkApplication.Oka)Hh.HelperMethods.jf(this.$.ipb(!0),d.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var ea=
this.$,Ta=!1,Lb=this.xc.hasUnsupportedFeaturesForEdit,xc=this.workbookContext.FileWasRepaired;ti.d(this.workbookContext.WorkbookFileName)?(Ta=!0,Ed.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",Lb)):ti.a(this.workbookContext.WorkbookFileName)&&(Ta=!0,Ed.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var qd=ea.Yf.get(59);qd=!(ea.ea.xc.supportsEditing&&
qd);if(Ta&&!Lb||qd&&(Ta||Lb)){var Jd=qd?Lb?-2066104278:816071846:hf.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&kc.a(this.$.ya,25)&&!this.$.dAb?765011943:-213064907;Ta=function(){var De=$g.a.b_a([Jd]);K.clientWorkflow.ud.Lt(De);K.clientWorkflow.ud.activityState[Ni.a.hr]=oh.a.Eeb}}else Ta=function(){ea.sI(!0,!1);var De=K.clientWorkflow.ud,Ve=De.activityState;Ve[Li.a.aU]=1;Ve[Pi.a.GYb]=qh.a.vlc;Ve[ki.a.Ss]=!0;Ve[V.a.MYb]=K.xc.hasUnsupportedFeaturesForEdit;Ve[Li.a.Fga]=
!!K.workbookContext.EditUrl;Ve[Ri.a.z2]=K.workbookContext.EditUrl;if(!K.h7b.CopyAndEditUrl){var sg=[hf.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&kc.a(K.$.ya,25)&&!K.$.dAb?-943219229:1821390342];De.Lt($g.a.raa(K.businessBar.T7c,sg))}xc&&!Lb?(ti.b(K.workbookContext.WorkbookFileName)&&hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConverterOdfFileRepairEnabled",!1)?(De=$g.a.b_a([-425642652]),Ed.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):
De=$g.a.b_a([108482388]),K.clientWorkflow.ud.Lt(De),Ve[Ni.a.hr]=oh.a.VUf):K.$.ea.P6e?(Ed.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Sj.b().NTd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Ve[Ni.a.hr]=oh.a.RFb):Ve[Ni.a.hr]=K.$.ea.Xgc?oh.a.DBb:oh.a.Eeb};Vh.a(ea).wt(new fi.a(oh.a.wz,5,Ta))}};Bd.prototype.reloadWorkbookInViewMode=function(){var K=
this;if(this.sc){hf.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&zd.a.Fg.cW&&zd.a.Fg.GHd();var ea=this.$;Af.a.Eh&&Tg.g(ea).rc.textBox.blur();Vh.a(ea).wt(new fi.a(oh.a.wz,5,function(){ea.sI(!ea.ea.isNamedObjectViewMode,!1);var Ta=K.clientWorkflow.ud.activityState;Ta[Ni.a.hr]=oh.a.Nha;Ta[Li.a.aU]=1;Ta[Li.a.EY]=!0;Ta[ki.a.Ss]=!1;Ta[ki.a.Tmb]=!0;Ta[Pi.a.GYb]=qh.a.vlc}))}};Bd.prototype.reloadWorkbook=function(K,ea){var Ta=this;if(this.sc){var Lb=this.$;Lb.NQ&65536&&
Vh.a(Lb).wt(new fi.a(oh.a.wz,5,function(){Lb.sI(K,!0);var xc=Ta.clientWorkflow.ud.activityState;xc[Ni.a.hr]=oh.a.Kk;xc[ki.a.cUc]=Ta.workbookContext.NovMode;ea||(xc[Li.a.aU]=1,xc[Li.a.BYb]=new Od)}))}};Bd.prototype.setCalculationMode=function(K,ea){function Ta(){return new Wf(ea)}var Lb=this;Ed.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",ea);var xc=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=ea;return tb.a(this.$.userOperationManager,
function(qd,Jd,De){var Ve=Lb.$.na.ua;qd=Lg.b(qd,Bd.$Qi(Lb.$,xc));Jd=Lg.a(Jd,Bd.ZQi(Lb.$,xc));var sg=Ve.Na(9,null);sg.calc_type=ea;return qe.i(Ve,"SetCalculationOptions",sg,qd,Jd,De,null,0)},function(qd){return new $c.a(197,0,qd,void 0,Ta)},K)};Bd.jze=function(K){K.zb&&0<K.zb.ZR&&K.zb.p$c(function(ea){ea.Ut()})};Bd.$Qi=function(K,ea){return function(Ta){$g.a.oh(Ta.Errors)&&(K.ea.workbookContext.CalcMode=ea,Ed.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",
ea,$g.a.Wc(Ta.Errors)))}};Bd.ZQi=function(K,ea){return function(){K.ea.workbookContext.CalcMode=ea;Ed.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",ea)}};Ek.Object.defineProperties(Bd.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.sc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},h7b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},
clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return Ga.a(this.$)}},xc:{configurable:!0,enumerable:!0,get:function(){return this.$.xc}}});Object(ve.a)(Bd,"FileOperationsCommandHandler",rb.a,[429]);var gc=b(157),dd=Yc.a;Am(uc,dd);uc.prototype.Nd=function(){var K=this,ea=this.$,Ta=[],Lb=ee.GetServiceTaskFactory.create(ea.da,56,this.la,this.ub);Ta.push(Lb);var xc=ee.GetServiceTaskFactory.Va(ea.da,5,4,this.ub);Ta.push(xc);ye.TaskExtensions.Ba(Ch.Task.WAA.apply(null,Ta),function(){gc.b(Lb)&&
K.Cd([new Bd(ea,Lb.result,new zg.a(function(){return ee.GetServiceTaskFactory.create(ea.da,137,K.la,K.ub)}),xc.result)])},this.la,0)};uc.ka=function(K){Yc.a.fe(94,new uc(K))};Object(ve.a)(uc,"FileOperationsCommandHandlerFactory",Yc.a,[]);var sd=b(46),ie;(function(K){K[K.url=0]="url";K[K.ref=1]="ref";K[K.mailto=2]="mailto"})(ie||(ie={}));Object(ve.b)("HyperlinkSelectionState",ie);var Ce=b(980),af=b(9),ff=b(647),fg=b(87),Ig=Ce.a;Am(dc,Ig);dc.prototype.p_e=function(K,ea){switch(ea){case 2:return K.startsWith("mailto:")?
K:"mailto:"+K;case 1:return String.format("{0}{1}",af.a.hHf,this.xRh(K));default:return K}};dc.prototype.Kx=function(){var K=this,ea=this.$;this.location=this.p_e(this.Qxd,this.Pxd);try{this.location=fg.a.fg(this.location)}catch(xc){Ed.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}Ed.ULS.sendTraceTag(555755667,0,50,"Committing {0} link",ie[this.Pxd]);this.cellValue=this.Oxd.length?this.Oxd:this.Qxd;ea.Ky();var Ta=ea.na.ua.hc(),Lb=sd.s(this.selectedRange);return function(xc,qd,Jd){return qe.c(ea.na.ua,
Lb,K.cellValue,K.location,K.removeHyperLink,!1,123,xc,qd,Jd,K.hM.range,Ta)}};dc.prototype.Zi=function(){var K=this,ea=sd.s(this.selectedRange);return function(){return new ff.a(ea,K.cellValue,K.location)}};dc.prototype.fyh=function(){var K=this.hM.cell.r5a;this.hM.cell.Twb?K&&K.startsWith("mailto:")?(this.Pmb=2,K=K.substr(7)):this.Pmb=0:this.Pmb=1;return K};dc.prototype.DLa=function(){hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.Wyb=this.hM.cba:this.Wyb=!!this.hM.mKa(64)||
!!this.hM.mKa(128)};dc.prototype.tm=function(){if(this.Wyb){this.y1a=this.hM.text;var K=this.fyh();K&&(this.QTc=K);this.Hm=Kc.a.instance.fa(823);this.Zqb=this.QTc===this.y1a}else this.hM.text?(this.y1a=this.hM.text,this.Zqb=!1):(this.y1a="",this.Zqb=!0),this.Pmb=0,this.Hm=Kc.a.instance.fa(822);this.hM.IH&&(this.Zqb=!1,this.RHe=!0,hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.y1a=this.hM.formulaBarText))};dc.prototype.vBi=function(K){return this.ea.Hb.rj(K)};
dc.prototype.KYe=function(K,ea){return K?null:Kc.a.instance.fa(ea)};dc.prototype.xRh=function(K){var ea=sd.Z(K,this.ea.xa);var Ta=ea.sheetName;var Lb=ea.range;ea.returnValue&&Lb&&(K=sd.x(Lb,Ta||this.sheetName,!1));return K};Ek.Object.defineProperties(dc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},Gu:{configurable:!0,enumerable:!0,get:function(){return 526}}});dc.HUj="validateLinkValues";dc.mOg="bodyProps";dc.Zeh="disableDisplayText";dc.Qfh="displayTextValue";
dc.rzg="activeLinkOption";dc.szg="activeLinkValue";dc.m3g="copyLinkValueToDisplay";dc.Kri="linkValue";dc.mlj="selectedLink";dc.Pfh="displayText";Object(ve.a)(dc,"HyperlinkDialog",Ce.a,[]);Rb.prototype.Zc=function(){return!1};Rb.prototype.Lc=function(K,ea){return 1===K&&-1583422759===ea.command};Rb.prototype.jd=function(){return!1};Rb.prototype.executeCommand=function(){this.wzj();return Ch.Task.Sa(!0)};Rb.prototype.wzj=function(){var K=sd.v(this.gridView.ha.sa.qd,this.$),ea=Tg.e(this.gridView);(!hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||
this.$.Cq([this.gridView.ha.sa.qd],!0))&&ea&&new dc(this.$,K,ea)};Object(ve.a)(Rb,"ShowHyperlinkCommandHandler",null,[429]);var ah=Yc.a;Am(fb,ah);fb.prototype.Nd=function(){this.Cd([new Rb(this.$,Tg.g(this.$))])};fb.ka=function(K){Yc.a.fe(105,new fb(K))};Object(ve.a)(fb,"ShowHyperlinkCommandHandlerFactory",Yc.a,[]);var bh=b(21),me=b(1194);oa.create="Create";oa.activate="Activate";oa.close="Close";oa.remove="Delete";oa.duplicate="Duplicate";Object(ve.a)(oa,"Actions",null,[]);var $e=Ch.Task;Am(fe,$e);
fe.prototype.ML=function(){this.e0d=$g.a.gd(3,2,0,1635,0,-1244327602,"MsFormDeleteConfirmation");this.kj=Vh.a(this.Cf.$).si(this.e0d).G();this.kj.isCompleted||(this._state=2,this.kj.NN(this.moveNext));return this.IDc};fe.prototype.IDc=function(){this.g0d=this.kj.Az();0===this.g0d&&(this.Cf.$.workbookContext.Options=Hh.HelperMethods.BO(!1,this.Cf.$.workbookContext.Options,2048),this.Cf.deleteMsFormMetaDataSheet());this._state=3;this.vRa(!0)};fe.prototype.dispose=function(){};Object(ve.a)(fe,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",
Ch.Task,[3]);fc.action="Action";fc.YBh="FlexPane";fc.A$b="formId";fc.id="id";fc.title="Title";fc.rPb="XlWorkbookId";fc.$Dh="Fragment";fc.host="Host";fc.oKj="TopView";fc.w2="auth_pvr";Object(ve.a)(fc,"Parameters",null,[]);ke.prototype.Zc=function(K,ea){switch(ea){case -105284469:return!ja.i(this.$.kg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};ke.prototype.executeCommand=function(K,ea){K=ye.TaskExtensions.hl();ea=ea.command;switch(ea){case -105284469:this.insertMsForm();
break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:K=this.deleteMsForm();break;default:K=lf.a(ea)}return K};ke.prototype.Lc=function(K,ea){if(!this.$.ea.Zg.get(61))return!1;K=!1;switch(ea.command){case -105284469:K=ja.i(this.$.kg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:K=this.hasMsForm}return K};ke.prototype.jd=function(){return!1};ke.prototype.insertMsForm=
function(){var K=lg.a.Gq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),ea={},Ta={};ea[fc.action]=oa.create;ea[fc.w2]=this.w2;Ta[fc.action]=oa.create;Ta[fc.rPb]=encodeURIComponent(this.mPb);Ta[fc.host]=this.wo;Ta[fc.title]=encodeURIComponent(K);this.vCb(ea,Ta);this.$.workbookContext.Options=Hh.HelperMethods.BO(!1,this.$.workbookContext.Options,2048)};ke.prototype.editMsForm=function(){var K={},ea={};K[fc.w2]=this.w2;ea[fc.A$b]=this.Jlc;ea[fc.rPb]=encodeURIComponent(this.mPb);ea[fc.host]=
this.wo;this.vCb(K,ea)};ke.prototype.previewMsForm=function(){var K={},ea={};K[fc.w2]=this.w2;ea[fc.A$b]=this.Jlc;ea[fc.rPb]=encodeURIComponent(this.mPb);ea[fc.host]=this.wo;ea[fc.oKj]="Preview";this.vCb(K,ea)};ke.prototype.sendMsForm=function(){var K={},ea={};K[fc.w2]=this.w2;ea[fc.A$b]=this.Jlc;ea[fc.YBh]="SendForm";ea[fc.rPb]=encodeURIComponent(this.mPb);ea[fc.host]=this.wo;this.vCb(K,ea)};ke.prototype.deleteMsForm=function(){return new fe(this)};ke.prototype.deleteMsFormMetaDataSheet=function(){var K=
this;this.$.userOperationManager.Zt(new $c.a(158,0,function(ea,Ta,Lb){return xd(K.$.na.Rw,K.uV.pub,Lg.b(ea,function(){K.Vch()}),Ta,Lb,null)}))};ke.prototype.Vch=function(){var K={},ea={};K[fc.action]=oa.remove;K[fc.w2]=this.w2;ea[fc.action]=oa.remove;ea[fc.host]=this.wo;ea[fc.A$b]=encodeURIComponent(this.Jlc);ea[fc.rPb]=encodeURIComponent(this.mPb);this.vCb(K,ea)};ke.prototype.vCb=function(K,ea){var Ta=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",Lb="",xc="";if(ea){for(var qd in ea){var Jd=qd,
De=ea[qd];xc+=xc.length?"&":"";xc+=Jd+"="+De}K||(K={});K[fc.$Dh]=encodeURIComponent(xc)}if(K)for(var Ve in K)ea=Ve,xc=K[Ve],Lb+=Lb.length?"&":"?",Lb+=ea+"="+xc;window.open(Ta+Lb,"_blank")};Ek.Object.defineProperties(ke.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return ja.c(this.$.kg)}},Jlc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},mPb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},w2:{configurable:!0,
enumerable:!0,get:function(){return bh.a.contains(this.$.Xu.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}}});Object(ve.a)(ke,"MsFormCommandHandler",null,[429]);var Kh=Yc.a;Am(le,Kh);le.prototype.Nd=function(){var K=this,ea=ee.GetServiceTaskFactory.create(this.$.da,203,this.la,this.ub);ye.TaskExtensions.Ba(ye.TaskExtensions.ye([ea],this.la),function(){K.Cd([new ke(K.$)])},this.la,3)};le.ka=function(K){K.ea.Zg.get(61)&&Yc.a.fe(215,new le(K))};Object(ve.a)(le,"MsFormCommandHandlerFactory",
Yc.a,[]);var Ph=na.a;Am(Nd,Ph);Nd.prototype.create=function(){var K=this;ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.create(this.$.da,164,this.la,this.ub),function(){K.Eb(new Ue)},this.la,3)};Object(ve.a)(Nd,"NewAndOpenUXFactory",na.a,[]);Nc.prototype.executeCommand=function(K,ea,Ta){K=2;switch(ea.command){case Sf.a.openUrlInNewTab:K=this.Di.ve(Sf.a.openUrlInNewTab,2,Ta);break;case Sf.a.cPa:K=this.Di.ve(Sf.a.cPa,2,Ta)}return 2!==K?Ch.Task.Sa(!0):lf.a(ea.command)};Nc.prototype.Lc=function(K,ea){return ea.command===
Sf.a.openUrlInNewTab||ea.command===Sf.a.cPa};Nc.prototype.jd=function(K,ea,Ta){return"PopulateMruMenu"===ea?(this.Di.ve(Sf.a.hqc,2,Ta),!0):!1};Nc.prototype.Zc=function(){return!1};Object(ve.a)(Nc,"OpenFromMruCommandHandler",null,[429]);var Tf=Yc.a;Am(lc,Tf);lc.prototype.Nd=function(){var K=this,ea=ee.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),Ta=ee.GetServiceTaskFactory.create(this.$.da,165,this.la,this.ub);ye.TaskExtensions.Ba(ye.TaskExtensions.ye([ea,Ta],this.la),function(){K.Cd([new Nc(K.$,
he.AFrameworkApplication.Ib)])},this.la,3)};lc.ka=function(K){Yc.a.fe(88,new lc(K))};Object(ve.a)(lc,"OpenFromMruCommandHandlerFactory",Yc.a,[]);var Qi=b(90),T=b(83),ra=b(250),hb=b(719),Eb=b(1155),sc=ra.a;Am(dg,sc);dg.prototype.execute=function(K){var ea=Object(T.a)(6,K.Ke);if(!ea.uka)return Ed.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.Lmd(K),this.zh(oh.a.idle),1;this.iCb||(this.iCb=new Eb.DownloadACopyOperation(this.Hkc,
ea));this.iCb.mhh();Ed.ULS.shipAssertTag(537154817,0,3!==Ga.a(ea).wi.au,"The current activity should not be closed.");return 1};dg.prototype.Lmd=function(K){var ea=Object(T.a)(6,K.Ke),Ta=new hb.a(ea);this.subscribe(K,this.vBd,function(Lb){Ta.add_disposing(Lb)});Ed.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Ta.initialize();Ta.kf()};dg.prototype.dispose=function(){Qi.a.Ha(this.iCb);this.iCb=null;sc.prototype.dispose.call(this)};
Object(ve.a)(dg,"DownloadAForkedCopyActivity",ra.a,[]);var vb=na.a;Am(Mg,vb);Mg.prototype.create=function(){var K=this;ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){K.Eb(new dg(oh.a.G1a,oh.a.Jk,!0))},this.la)};Object(ve.a)(Mg,"DownloadACopyPreDatalossActivityFactory",na.a,[]);var Wc=na.a;Am(Gf,Wc);Gf.prototype.create=function(){var K=this;ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){K.Eb(new dg(oh.a.unmergeableDownloadCopy,
oh.a.zoa))},this.la)};Object(ve.a)(Gf,"DownloadAForkedCopyActivityFactory",na.a,[]);qg.prototype.Qg=function(){this.La.fc(Sf.a.tryMacOffice,uh.a.frame,Object(rf.a)(this,this.TSi,"onTryMacOffice"));this.La.fc(Sf.a.aag,uh.a.frame,Object(rf.a)(this,this.yDf,"onTryMacOfficeFromViewer"));this.La.fc(Sf.a.$$f,uh.a.frame,Object(rf.a)(this,this.yDf,"onTryMacOfficeFromViewer"))};qg.prototype.TSi=function(K,ea,Ta,Lb,xc){if(1===Ta)return 32;xc?(K=xc.SourceControlId,"btnjTryMacOfficeForWordEditor"===K?Oe.a.jf(Ng.a.OZ(12),
"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===K&&Oe.a.jf(Ng.a.OZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Jjf();return 32};qg.prototype.yDf=function(K,ea,Ta){if(1===Ta)return 32;switch(K){case Sf.a.aag:Oe.a.jf(Ng.a.OZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Sf.a.$$f:Oe.a.jf(Ng.a.OZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};qg.prototype.Jjf=function(){var K=void 0===K?null:K;
var ea=0;K&&(ea=K);Oe.a.jf(2===ea?"https://go.microsoft.com/fwlink/?LinkId=331579":qg.axi,"_blank",void 0,"LaunchMacTrialWindow")};Ek.Object.defineProperties(qg.prototype,{oxc:{configurable:!0,enumerable:!0,get:function(){return this.Kqg&&Af.a.isMac&&!Af.a.oki&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},vwj:{configurable:!0,enumerable:!0,get:function(){return this.oxc}}});Ek.Object.defineProperties(qg,{axi:{configurable:!0,enumerable:!0,get:function(){return Ng.a.zH("522401")}}});Object(ve.a)(qg,
"MacOfficeOffer",null,[378]);pf.prototype.Qg=function(){this.La.fc(Sf.a.tryOffice,uh.a.frame,Object(rf.a)(this,this.USi,"onTryOffice"));this.La.fc(Sf.a.tryOfficeThroughTellMe,uh.a.frame,Object(rf.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.fc(Sf.a.dag,uh.a.frame,Object(rf.a)(this,this.eag,"tryOfficeThroughViewer"));this.La.fc(Sf.a.cag,uh.a.frame,Object(rf.a)(this,this.eag,"tryOfficeThroughViewer"))};pf.prototype.USi=function(K,ea,Ta,Lb,xc){if(this.JXb&&1===Ta)return this.isFreemiumUpsellEnabled&&
this.pLb?32:8;2===Ta&&(xc?(K=xc.SourceControlId,"btnjTryOfficeForWordEditor"===K?Oe.a.jf(Ng.a.OZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===K?Oe.a.jf(Ng.a.OZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Gjc()):this.Gjc());return 32};pf.prototype.tryOfficeThroughTellMe=function(K,ea,Ta,Lb,xc){if(this.JXb&&1===Ta)return this.isFreemiumUpsellEnabled&&this.pLb?32:8;2===Ta&&(xc?(K=xc.SourceControlId,Oe.a.jf(Ng.a.zH("862405")+this.NTh(K),"_blank",
void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Oe.a.jf(Ng.a.zH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};pf.prototype.eag=function(K,ea,Ta){if(this.JXb&&1===Ta)return this.isFreemiumUpsellEnabled&&this.pLb?32:8;if(2===Ta)switch(K){case Sf.a.dag:Oe.a.jf(Ng.a.OZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Sf.a.cag:Oe.a.jf(Ng.a.OZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};pf.prototype.Gjc=function(K){K=void 0===K?null:K;var ea=
0;K&&(ea=K);Oe.a.jf(pf.yRh(ea),"_blank",void 0,"LaunchOfficeOffer")};pf.prototype.NTh=function(K){var ea=0;switch(K){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":ea=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":ea=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":ea=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":ea=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":ea=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":ea=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":ea=
7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":ea=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":ea=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":ea=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":ea=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":ea=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":ea=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":ea=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":ea=
20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":ea=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":ea=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":ea=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":ea=29}return 0===ea?"":String.format("&pc={0:D}",ea)};pf.yRh=function(K){if(Af.a.Eh)switch(K){case 1:return Ng.a.zH("393806");case 2:return Ng.a.zH("393810");case 3:return Ng.a.zH("393809");case 5:return Ng.a.zH("393805")}else if(Af.a.np)switch(K){case 1:return Ng.a.zH("521979");
case 3:return Ng.a.zH("521980");case 5:return Ng.a.zH("521978");case 2:return Ng.a.zH("522490")}else{if(2===K)return Ng.a.zH("517778");if(1===K)return Ng.a.OZ(30)}return Ng.a.zH("522402")};Ek.Object.defineProperties(pf.prototype,{ysf:{configurable:!0,enumerable:!0,get:function(){return this.pLb}},DEi:{configurable:!0,enumerable:!0,get:function(){return this.pLb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},pLb:{configurable:!0,enumerable:!0,get:function(){return this.Nqg&&!Af.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,
enumerable:!0,get:function(){var K=!1;this.oFc&&(K=this.oFc.isFreemiumUpsellEnabled());return K}}});Object(ve.a)(pf,"OfficeTrialExperience",null,[356]);je.prototype.ei=function(K){K.register(pf,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").Hc().Oc(function(){return new pf(he.AFrameworkApplication.Ib,he.AFrameworkApplication.Hzb,he.AFrameworkApplication.lcid)});K.register(qg,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").Hc().Oc(function(){return new qg(he.AFrameworkApplication.Ib,
he.AFrameworkApplication.ahc,he.AFrameworkApplication.lcid)})};Object(ve.a)(je,"OpenInClientConfiguration",null,[5]);var Zd=b(1403),uf=b(38),If=b(1303),ng=b(230);Ek.Object.defineProperties(Ye,{gg:{configurable:!0,enumerable:!0,get:function(){return lh.a.cp(Ye.xk,CommonUIStrings.l_OICLaunchDialogTitle)}}});Ye.xk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(ve.a)(Ye,"OICLaunchDialogHtml",null,[]);var gg=lh.a;Am(ud,gg);ud.prototype.I9a=function(){this.FCa=xe("BtnRichClient",this.uq.ssb,this.uq.Pxb,this.uq.fld,CommonUIStrings.l_OICLaunchRichClient,Object(rf.a)(this,this.uBf,"onRichClientButtonClick"),Qe);document.getElementById("OICLaunchRichClient").appendChild(this.FCa);jg(this.FCa);this.ZUa=xe("BtnReturn",this.uq.ssb,this.uq.Pxb,this.uq.k9e,CommonUIStrings.l_OICReturnToOnlineClient,Object(rf.a)(this,this.rBf,"onReturnButtonClick"),Qe);document.getElementById("OICReturnToApp").appendChild(this.ZUa);
jg(this.ZUa)};ud.prototype.rBf=function(){this.hide();this.uq.Tbb();return!0};ud.prototype.uBf=function(){Ed.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();he.AFrameworkApplication.Ib.processAction(Sf.a.LQa,2);return!0};ud.prototype.XEi=function(){this.uq.Tbb()};ud.prototype.dispose=function(){this.Kpa||(this.FCa&&(ng.a.instance.za(ag.a.click,this.FCa,Object(rf.a)(this,this.uBf,"onRichClientButtonClick")),te.KeyInputManager.instance.za(ag.a.Ud,this.FCa,Qe)),this.ZUa&&
(ng.a.instance.za(ag.a.click,this.ZUa,Object(rf.a)(this,this.rBf,"onReturnButtonClick")),te.KeyInputManager.instance.za(ag.a.Ud,this.ZUa,Qe)),gg.prototype.dispose.call(this),this.Kpa=!0)};Object(ve.a)(ud,"OICLaunchDialog",lh.a,[]);Ek.Object.defineProperties(Ge,{gg:{configurable:!0,enumerable:!0,get:function(){return lh.a.cp(Ge.xk,CommonUIStrings.l_OICDialogTitle)}}});Ge.xk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(ve.a)(Ge,"ProtocolLaunchingDialogV2Html",null,[]);var Wh=lh.a;Am(Yd,Wh);Yd.prototype.I9a=function(){var K=document.getElementById("Issues");if(K){mf("",this.uq.ssb,this.uq.Pxb,this.uq.fld,K);var ea=document.createElement("span");ea.className="WACDialogSectionTitle";ea.innerText=5===this.uq.nEf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;K.appendChild(ea);jg(K);K.style.display="none"}he.AFrameworkApplication.ta.Qa.Nhd?(this.YUa=xe("GiveFeedback",this.uq.ssb,
this.uq.Pxb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(rf.a)(this,this.pnc,"onGiveFeedbackClick"),Object(rf.a)(this,this.Axf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.YUa),jg(this.YUa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===he.AFrameworkApplication.ta.Qa.editMode||he.AFrameworkApplication.$eh?document.getElementById("ButtonEdit").style.display="none":(this.$ea=xe("Edit",this.uq.ssb,this.uq.Pxb,
"",2===he.AFrameworkApplication.ta.Qa.Sj?4===he.AFrameworkApplication.ta.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===he.AFrameworkApplication.ta.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(rf.a)(this,this.ewf,"onEditClick"),Object(rf.a)(this,this.jwf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.$ea),jg(this.$ea));0===he.AFrameworkApplication.ta.Qa.editMode&&
!he.AFrameworkApplication.Hzb&&K&&(K.style.display="none")};Yd.prototype.oUe=function(){return this.opa?(this.$z(this.opa),!0):!1};Yd.prototype.mUe=function(){return this.$ea?(this.$z(this.$ea),!0):!1};Yd.prototype.jwf=function(K){return this.Dzd(K,0)};Yd.prototype.Axf=function(K){return this.Dzd(K,2)};Yd.prototype.pBf=function(K){return this.Dzd(K,1)};Yd.prototype.Dzd=function(K,ea){var Ta=!1;if(K.Ca.keyCode===pi.a.di||K.Ca.keyCode===pi.a.Moa)K.Lb.click(),Ta=!0;else if(K.Ca.keyCode===Sys.UI.Key.down||
K.Ca.keyCode===Sys.UI.Key.up)switch(ea){case 1:Ta=this.mUe();break;case 0:Ta=this.oUe()}return Ta};Yd.prototype.ewf=function(){this.hide();4===he.AFrameworkApplication.ta.Qa.editMode?(Ed.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.uq.Tbb()):(Ed.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.uq.nid());return!0};Yd.prototype.pnc=function(){Ed.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.uq.p5e();return!0};Yd.prototype.ooc=
function(){Ed.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";he.AFrameworkApplication.Ib.processAction(Sf.a.LQa,2);return!0};Yd.prototype.TFd=function(){this.uq.Tbb()};Yd.prototype.switchToBackupMode=function(){var K=document.getElementById("ProtocolLaunchingDialogTitle");if(K){K.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(K=document.getElementById("Issues"))K.style.display="block";(K=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!K.children.length&&(this.opa=xe("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(rf.a)(this,this.ooc,"onRetryOICClick"),Object(rf.a)(this,this.pBf,"onRetryOICKeyUp")),K.appendChild(this.opa),jg(this.opa),this.$ea||this.oUe())}};Yd.prototype.dispose=function(){this.Kpa||(this.$ea&&(ng.a.instance.za(ag.a.click,this.$ea,Object(rf.a)(this,this.ewf,"onEditClick")),te.KeyInputManager.instance.za(ag.a.Ud,this.$ea,Object(rf.a)(this,this.jwf,"onEditKeyUp"))),this.YUa&&(ng.a.instance.za(ag.a.click,
this.YUa,Object(rf.a)(this,this.pnc,"onGiveFeedbackClick")),te.KeyInputManager.instance.za(ag.a.Ud,this.YUa,Object(rf.a)(this,this.Axf,"onGiveFeedbackKeyUp"))),this.opa&&(ng.a.instance.za(ag.a.click,this.opa,Object(rf.a)(this,this.ooc,"onRetryOICClick")),te.KeyInputManager.instance.za(ag.a.Ud,this.opa,Object(rf.a)(this,this.pBf,"onRetryOICKeyUp"))),Wh.prototype.dispose.call(this),this.Kpa=!0)};Object(ve.a)(Yd,"ProtocolLaunchingDialog",lh.a,[]);var di=b(456),uj=Gh.StandardDialog;Am(Jc,uj);Jc.prototype.pnc=
function(K){Ed.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.Awf(K)};Jc.prototype.ooc=function(){Ed.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");he.AFrameworkApplication.Ib.processAction(Sf.a.LQa,2)};Jc.prototype.TFd=function(K){Jc.q6e?3===K?this.mTf():2===K||0===K?this.continueEditing():1===K&&this.YYg():2===K?this.mTf():(1===K||0===K)&&this.continueEditing()};Jc.prototype.YYg=function(){Ed.ULS.sendTraceTag(577783557,211,50,"Closing the document");he.AFrameworkApplication.Ib.ve(Sf.a.close,
2,di.a)};Jc.prototype.mTf=function(){Ed.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(rf.a)(this,this.ooc,"onRetryOICClick"),0)};Jc.prototype.continueEditing=function(){4===he.AFrameworkApplication.ta.Qa.editMode||he.AFrameworkApplication.ga.ra("WordConsumptionViewToEditRedirectIsEnabled")&&1===he.AFrameworkApplication.ta.mode?(Ed.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.uq.Tbb()):(Ed.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),
this.uq.nid())};Ek.Object.defineProperties(Jc,{q6e:{configurable:!0,enumerable:!0,get:function(){return he.AFrameworkApplication.ga.ra("OICDialogThreeActions")&&32===he.AFrameworkApplication.Ib.processAction(Sf.a.close,1)}}});Object(ve.a)(Jc,"StandardProtocolLaunchingDialog",Gh.StandardDialog,[]);Object(ve.a)(eg,"EditDocumentInClientParams",null,[]);Be.I7c=function(K,ea,Ta,Lb,xc,qd,Jd,De,Ve,sg,mh,Zh,Ci,Bj,Kj,uk){Jd=void 0===Jd?!1:Jd;De=void 0===De?!1:De;Ve=void 0===Ve?"":Ve;sg=void 0===sg?!1:sg;mh=
void 0===mh?!1:mh;Zh=void 0===Zh?!1:Zh;Ci=void 0===Ci?"":Ci;Bj=void 0===Bj?"":Bj;Kj=void 0===Kj?"":Kj;uk=void 0===uk?!1:uk;var Lj=new eg;Lj.DocumentUrl=K;Lj.Mode=ea;Lj.Options=Ta;Lj.Application=Lb;Lj.SilentExternalHandler=Jd;Lj.EncodeUrl=De;Lj.CorrelationIdForWinClient=Ve;Lj.NavigateUsingWindowOpen=sg;Lj.DescriptiveUnattemptedEnums=mh;Lj.NoBrowserModalDialogs=Zh;Lj.SessionOrigin=Ci;Lj.CorrelationId=Bj;Lj.ClickTime=Kj;Lj.NewTelemetryDataIsEnabled=uk;MSOJS.ClientUtils.EditDocumentInClient(Lj,xc,qd)};
Object(ve.a)(Be,"ClientUtils",null,[]);var qj=b(187),Ag=b(519),Eg=b(176),Jj=b(1029),Fi=b(77);Lf.prototype.Gwc=function(K,ea,Ta,Lb){ea=void 0===ea?"":ea;Lb=void 0===Lb?!1:Lb;this.WD=(void 0===Ta?"":Ta)||Eg.a.create().toString();this.BWb=ea||Ag.a.f0e();Lb&&(K=((new Date).getTime()-parseFloat(K)).toString());this.kRb=K};Lf.prototype.Ygj=function(K,ea,Ta){return ea.contextId!==uh.a.frame?2:1===Ta?32:this.LQa()};Lf.prototype.hGj=function(){return!(2===this.application&&he.AFrameworkApplication.ga.ra("IsEmbeddedScenario"))};
Lf.prototype.closeApplication=function(){this.FUd||this.bxh()};Lf.prototype.Tbb=function(){this.kGj||this.qxh()};Lf.prototype.aMf=function(K){this.zTj&&Af.a.Eh?new ud(this):this.s3b(K)};Lf.prototype.s3b=function(K){K=this.oqi(K);var ea=K.returnValue;Ed.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===ea,K.xBa);return ea};Lf.prototype.xGa=function(K,ea,Ta,Lb,xc,qd){this.eVa=K;this.v5d=ea;this.Ufa=qd;this.application=Ta;this.bC=Lb;he.AFrameworkApplication.downloadCopyOnOpenInClient?this.Gjf():
he.AFrameworkApplication.limitedEdit&&!he.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?he.AFrameworkApplication.L3f():this.qNg(xc)};Lf.prototype.LQa=function(){this.WEi&&this.jti();return this.s3b(this.Gib)};Lf.prototype.$Wf=function(){var K=new Jj.a(Zg.a.openInClient);K.Values["ui-language"]=he.AFrameworkApplication.lcid.toString();K.Values[O.a.R4c]=he.AFrameworkApplication.userSessionId;return this.Ufa.value.send(K)?32:8};Lf.prototype.jti=function(){Ke.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new oe.a,{inStaging:!0}))};Lf.prototype.Emj=function(K){var ea=new Jj.a(Zg.a.KVj);ea.Values["ui-language"]=he.AFrameworkApplication.lcid.toString();ea.Values[O.a.R4c]=he.AFrameworkApplication.userSessionId;ea.Values[Df.a.JVj]=K;this.Ufa.value.send(ea)};Lf.prototype.oqi=function(K){this.Gib=K;this.Emj(5===this.bC?Lf.nUi:Lf.pUi);return 5===this.bC?this.nqi():this.sqi()};Lf.prototype.nqi=function(){this.Mjf();return{returnValue:32,xBa:"HostEditUrl,"}};
Lf.prototype.sqi=function(){var K,ea=K="";he.AFrameworkApplication.ime&&(ea="|f|"+he.AFrameworkApplication.userSessionId);var Ta=he.AFrameworkApplication.ga.ra("IsAssignmentMode")&&he.AFrameworkApplication.ga.ra("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||he.AFrameworkApplication.isUnifiedHostMode||Af.a.Nka,Lb=he.AFrameworkApplication.ga.ra("UnattemptedEnumIsEnabled"),xc=he.AFrameworkApplication.ga.ra("NoBrowserModalDialogs");if(he.AFrameworkApplication.Ib.$lc){var qd=he.AFrameworkApplication.Ib.TZ(3588168074);
qd&&this.Gwc(qd.TriggerTime,qd.sessionOrigin,qd.correlationId,!0)}if(he.AFrameworkApplication.nHf){K+="NewOrder,";qd=8;this.Ufa&&this.Ufa.value&&this.Ufa.value.isEnabled()&&he.AFrameworkApplication.mZd&&(K+="Post,",qd=this.$Wf());if(32===qd)return{returnValue:qd,xBa:K};Ed.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return he.AFrameworkApplication.jm.m$a?(Ed.ULS.shipAssertTag(5566816,211,!!he.AFrameworkApplication.jm.m$a),K+="HostUrl,",{returnValue:he.AFrameworkApplication.ta.Z8a(he.AFrameworkApplication.jm.m$a),
xBa:K}):this.eVa?(Ed.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",he.AFrameworkApplication.userSessionId),K+="DocUrl,",Be.I7c(this.eVa,this.bC,this.options,this.application,Object(rf.a)(this,this.iwf,"onEditInClientSuccess"),Object(rf.a)(this,this.hwf,"onEditInClientFailure"),this.n4f,he.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),ea,Ta,Lb,xc,this.BWb,this.WD,this.kRb,he.AFrameworkApplication.Ib.$lc),{returnValue:32,xBa:K}):{returnValue:8,xBa:K}}K+="OldOrder,";
if(!this.eVa&&he.AFrameworkApplication.jm.m$a)return this.Ufa&&this.Ufa.value&&this.Ufa.value.isEnabled()&&he.AFrameworkApplication.mZd?(K+="Post,",ea=this.$Wf()):(Ed.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),ea=8),32!==ea?(Ed.ULS.shipAssertTag(22595484,211,!!he.AFrameworkApplication.jm.m$a),K+="HostUrl,",{returnValue:he.AFrameworkApplication.ta.Z8a(he.AFrameworkApplication.jm.m$a),xBa:K}):{returnValue:ea,xBa:K};Ed.ULS.sendTraceTag(22595485,211,
15,"Try to open doc in rich client, SessionId {0}",he.AFrameworkApplication.userSessionId);K+="DocUrl,";Be.I7c(this.eVa,this.bC,this.options,this.application,Object(rf.a)(this,this.iwf,"onEditInClientSuccess"),Object(rf.a)(this,this.hwf,"onEditInClientFailure"),this.n4f,he.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),ea,Ta,Lb,xc,this.BWb,this.WD,this.kRb,he.AFrameworkApplication.Ib.$lc);return{returnValue:32,xBa:K}};Lf.prototype.iRf=function(K){he.AFrameworkApplication.Zm.setDw(8981,K)};Lf.prototype.iwf=
function(K){this.iRf(K);Ed.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===K&&MSOJS.ClientUtils.ShouldShowDialog()?(this.o7f||this.Mjf(),this.Nui()):this.FUd||this.closeApplication()};Lf.prototype.hwf=function(K,ea){ea=void 0===ea?0:ea;Ed.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",K,ea);if(5===K)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{var Ta=!!this.v5d&&!this.Gib,Lb=0;1===K&&(Lb=2);6<=K&&13>=K&&
(Lb=1,1===ea&&(this.FUd=!0));this.$zc.DEi?(Ed.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",Lb),If.a.instance.R7g(this.Gib?Object(rf.a)(this,this.Tsf,"oicErrorDialogHandlerCloseForced"):Object(rf.a)(this,this.Usf,"oicErrorDialogHandlerNoCloseForced"),Ta?Object(rf.a)(this,this.Eyf,"onLaunchDownload"):null,this.MHe(!1)?Object(rf.a)(this,this.h7h,"iHaveOfficeButtonHandler"):null,Lb,ea)):(Ed.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",
Lb),If.a.instance.P7g(this.Gib?Object(rf.a)(this,this.Tsf,"oicErrorDialogHandlerCloseForced"):Object(rf.a)(this,this.Usf,"oicErrorDialogHandlerNoCloseForced"),Ta?Object(rf.a)(this,this.Eyf,"onLaunchDownload"):null,Lb))}};Lf.prototype.Nui=function(){try{var K=[Object.assign(new Fi.a,{name:"CorrelationId",string:this.WD}),Object.assign(new Fi.a,{name:"SessionOrigin",string:this.BWb}),Object.assign(new Fi.a,{name:"ClickTime",string:this.kRb}),Object.assign(new Fi.a,{name:"ProtocolHandlerFinishedTimestamp",
double:(new Date).getTime()})];qj.a("OpenInClientCompleted",!0,0,K)}catch(ea){Ed.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+ea.toString())}};Lf.prototype.Mjf=function(){he.AFrameworkApplication.ta&&he.AFrameworkApplication.ta.Qa.vv&&he.AFrameworkApplication.ga.ra("StandardProtocolDialogIsEnabled")?new Jc(this):new Yd(this)};Lf.prototype.Tsf=function(){this.closeApplication()};Lf.prototype.Usf=function(){this.Tbb()};Lf.prototype.Eyf=function(){this.Gjf()};Lf.prototype.h7h=function(){return this.MHe(!0)};
Lf.prototype.MHe=function(K){var ea=(Af.a.m_||Af.a.XH)&&!!he.AFrameworkApplication.D6b;ea&&K&&(Oe.a.jf(he.AFrameworkApplication.D6b,"_blank",void 0,"OpenInClient"),this.closeApplication());return ea};Ek.Object.defineProperties(Lf.prototype,{nEf:{configurable:!0,enumerable:!0,get:function(){return this.bC}},options:{configurable:!0,enumerable:!0,get:function(){var K=0;he.AFrameworkApplication.afj&&(K|=1);he.AFrameworkApplication.openInClientEditOnly&&(K|=4);this.hGj()&&(K|=64);return K}},ssb:{configurable:!0,
enumerable:!0,get:function(){return he.AFrameworkApplication.VC}},Pxb:{configurable:!0,enumerable:!0,get:function(){return he.AFrameworkApplication.Kxb}},k9e:{configurable:!0,enumerable:!0,get:function(){return""}},fld:{configurable:!0,enumerable:!0,get:function(){return""}},o7f:{configurable:!0,enumerable:!0,get:function(){return he.AFrameworkApplication.ga.ra("OneNoteMobileViewerIsEnabled")}},$zc:{configurable:!0,enumerable:!0,get:function(){return this.rce||(this.rce=oi.a.instance.resolve("Common.IOfficeTrialExperience"))}},
WEi:{configurable:!0,enumerable:!0,get:function(){return!!he.AFrameworkApplication.ga&&he.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}}});Lf.pUi="OpenInDesktop";Lf.nUi="OpenInBrowser";Object(ve.a)(Lf,"AOpenInClientOperation",null,[]);var mj=b(208),Xh=b(212),Dj=b(119),vk=b(47),Hj=b(44),xk=b(197),Xj=b(95),Yj=b(35),mi=b(523),th=b(1249),Rh=b(652);Am(pe,Lf);pe.prototype.g0g=function(){this.aMf(this.zUe)};pe.prototype.h2g=function(){var K=this,
ea=this.$;ye.TaskExtensions.Ba(this.cK.value,function(Ta){K.xGa(ea.workbookContext.ClientUrl,he.AFrameworkApplication.W3,1,ea.isEditMode?2:0,!0,new zg.a(function(){return Ta.result}))},this.la,3)};pe.prototype.nid=function(){0!==zd.a.Fg.editMode&&(this.$.zb.Kz=!1)};pe.prototype.p5e=function(){var K={};K[A.a.v9b]=!1;K[A.a.oV]="OpenInExcel";this.$.Xd(802602464,Ua.a.Ub,8,K)};pe.prototype.D2c=function(){var K=this;if(this.ea.sc){var ea=this.$;ea.isEditMode&&ye.TaskExtensions.Ba(this.cK.value,function(Ta){K.xGa(ea.workbookContext.ClientUrl,
he.AFrameworkApplication.W3,1,2,!1,new zg.a(function(){return Ta.result}))},this.la,3)}};pe.prototype.FBe=function(){var K=this;this.ea.sc&&ye.TaskExtensions.Ba(this.cK.value,function(ea){K.xGa(K.$.workbookContext.ClientUrl,he.AFrameworkApplication.W3,1,K.$.isEditMode?2:0,!1,new zg.a(function(){return ea.result}))},this.la,3)};pe.prototype.Gwc=function(K){Lf.prototype.Gwc.call(this,K)};pe.prototype.openInExcelClient=function(){var K=this;this.ea.sc&&(this.$.isEditMode||ye.TaskExtensions.Ba(this.cK.value,
function(ea){K.xGa(K.$.workbookContext.ClientUrl,he.AFrameworkApplication.W3,1,0,!1,new zg.a(function(){return ea.result}))},this.la,3))};pe.prototype.openInBrowser=function(){var K=this;this.ea.sc&&ye.TaskExtensions.Ba(this.cK.value,function(ea){K.xGa(K.$.workbookContext.ClientUrl,he.AFrameworkApplication.W3,1,5,!1,new zg.a(function(){return ea.result}))},this.la,3)};pe.prototype.downloadFile=function(K){var ea=this.Fue(K);this.xaa.downloadFile(ea,K);this.Lti()};pe.prototype.Lti=function(){he.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",
!1)&&null!=this.lga&&this.lga.execute(function(K){return K.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})};pe.prototype.jEf=function(K,ea){ea=void 0===ea?0:ea;if(this.ea.sc){var Ta=this.$;Ga.a(Ta).VLa?this.kEf(K,Ta):0<ea?this.dEj(K,Ta,ea):this.y2f(Ta)}};pe.prototype.xGa=function(K,ea,Ta,Lb,xc,qd){this.$.zb.Kz=!hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||!this.$.xc.inWebPart;this.zUe=xc;this.t3b=null;this.e7c=
!1;this.vNg(K,ea,Lb,xc,qd)};pe.prototype.s3b=function(K){var ea=this.$.xc;Ed.ULS.sendTraceTag(537154775,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",ea.inEmbedView,ea.inWebPart,ea.isDivSyndicated,this.$.isEditMode?mj.a.edit:mj.a.view);return pe.Aef()?(this.S2b(),Be.I7c(this.eVa,this.bC,this.options,1,this.ZIi,this.YIi,!1,he.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled")),32):Lf.prototype.s3b.call(this,K)};pe.prototype.bxh=function(){this.lSf();
var K=this.$;if(!this.ea.xc.inWebPart&&this.ea.sc&&!K.isEditMode){var ea=new Xj.a(2145659238,Ua.a.Ub,this.$.ed,0,null);this.zze=vk.a.instance.create(function(){K.Ka.Xb(ea)},0,Hj.a.qUi)}};pe.prototype.dispose=function(){this.ea&&this.ea.Dk(this.od);Qi.a.zc([this.Pa,this.zze,this.Fm]);this.$=this.ea=null};pe.prototype.qxh=function(){this.lSf()};pe.prototype.Gjf=function(){var K=this;vk.a.instance.create(function(){K.$.Ka.Xb(new Xj.a(-2028960985,Ua.a.Ub,0,30,null))},0,Hj.a.rUi,!0,!0)};pe.prototype.qNg=
function(K){var ea=this.$,Ta=Ga.a(this.$).ud.activityState;Ta[mi.a.zke]=!0;ea.isEditMode&&this.ea.sc?(this.S2b(),Vh.a(ea).wt(new fi.a(oh.a.wz,5,function(){ea.sI(!1);Ta[Ni.a.hr]=oh.a.U2b;Ta[mi.a.Bzg]=K;Ta[Li.a.Tad]=!0;ea.isEditMode&&(Ta[Li.a.aU]=1,Ta[Li.a.EY]=!0,Ta[be.a.KYb]=!0,Ta[be.a.dUc]=!0);Ta[mi.a.Cke]=1455037301}))):this.aMf(K)};pe.prototype.m5f=function(){var K=he.AFrameworkApplication.W3;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.Z8a(K,!0)){var ea=this.$.ea.xc;Ed.ULS.sendTraceTag(537154773,
0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",K,ea.inEmbedView,ea.inWebPart,ea.isDivSyndicated,this.$.isEditMode?mj.a.edit:mj.a.view)}}else this.xaa.downloadFile(K,-2028960985);this.e7c=!0;this.S2b()};pe.prototype.Lqi=function(){this.$zc.ysf&&this.$zc.Gjc(1)};pe.prototype.Mqi=function(){this.$zc.ysf&&Hh.HelperMethods.jf(Ng.a.OZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};pe.prototype.Wqi=function(){Hh.HelperMethods.jf(Ng.a.OZ(31),"_blank",
void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};pe.prototype.Xqi=function(){Hh.HelperMethods.jf(Ng.a.OZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};pe.prototype.Fue=function(K){var ea=new Sys.StringBuilder,Ta=this.$.workbookContext,Lb=this.$.ya;ea.append(this.$.Lda);ea.append(Lb.FileHandlerRelativeUri);ea.append("?id=");ea.append(encodeURIComponent(Xh.a.THb(Ta.WorkbookUri,"sc")));this.$.ea.sc&&(ea.append("&sessionId="),ea.append(encodeURIComponent(this.$.ea.sessionId)));
switch(K){case -974518828:ea.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:ea.append("&workbookType=FullWorkbook");break;case -1059172980:ea.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:ea.clear()}Dj.a.hZa(ea,Lb);return ea.toString()};pe.prototype.O0g=function(){Zd.a.instance.TWg();var K=this.$.ya;MSOJS.ClientUtils.InitUrls(K.RoamingAppsX86RootUrl,K.RoamingAppsControlInstallerUrl,K.RoamingAppsFirefoxExtensionUrl)};pe.prototype.lSf=function(){var K=
this.$;this.ea.sc||Te.a.XFd(K,Ga.a(K).ud);this.S2b();this.t3b&&this.t3b(this,this.e7c);K.frame.Bt.im(this.$.frame.Oaa());K.frame.DX.im(this.$.frame.Oaa());K.zb.Kz=!1;Tg.g(K).focus()};pe.prototype.vNg=function(K,ea,Ta,Lb,xc){var qd=this.$;he.AFrameworkApplication.ta&&!pe.Aef()&&(qd.frame.Bt.sn(qd.frame.Oaa()),qd.frame.DX.sn(qd.frame.Oaa()));Lf.prototype.xGa.call(this,K,ea,1,Ta,Lb,xc)};pe.prototype.S2b=function(){var K=this.$;Ga.a(K).wi.activityName===oh.a.openInExcelClient&&Ga.a(K).ud.IJ()};pe.prototype.Uyj=
function(){var K=$g.a.gd(1,0,681,682,0,1341525452,"OpenInExcelActiveXError");Vh.a(this.$).Bs([K])};pe.prototype.dEj=function(K,ea,Ta){var Lb=this,xc=null,qd=window.setTimeout(function(){Ga.a(ea).Isc(xc);Lb.y2f(ea)},Ta);xc=function(){Ga.a(ea).VLa&&(Ga.a(ea).Isc(xc),window.clearTimeout(qd),Lb.kEf(K,ea))};Ga.a(ea).hVc(xc)};pe.prototype.y2f=function(K){var ea=$g.a.gd(1,1,0,696,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");Vh.a(K).Bs([ea])};pe.prototype.kEf=function(K,ea){var Ta=this;Vh.a(ea).wt(new fi.a(oh.a.wz,
5,function(){ea.sI(!1);var Lb=Ga.a(ea).ud,xc=Lb.activityState;xc[Ni.a.hr]=oh.a.gJe;xc[V.a.MYb]=ea.ea.xc.hasUnsupportedFeaturesForEdit;xc[Rh.a.YTc]=K;Lb.Lt($g.a.raa(Ta.businessBar.T7c,[1437034227]))}))};pe.Aef=function(){return 1<zd.a.getRegisteredEwaInstances().length};Ek.Object.defineProperties(pe.prototype,{k9e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},la:{configurable:!0,enumerable:!0,get:function(){this.Fm=this.Fm||new xk.a;return this.Fm.token}},fld:{configurable:!0,
enumerable:!0,get:function(){return"excel32"}},o7f:{configurable:!0,enumerable:!0,get:function(){return this.ea.xc.inWebPart}}});Object(ve.a)(pe,"OpenInExcelOperation",Lf,[806,3]);var ih=na.a;Am(Kd,ih);Kd.prototype.create=function(){var K=this;if(this.$.da.Aa(55))this.Eb(this.$.da.Aa(55));else{var ea=ee.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),Ta=ee.GetServiceTaskFactory.Va(this.$.da,5,4,this.ub);ye.TaskExtensions.Ba(Ch.Task.WAA(ea,Ta),function(){K.Eb(new pe(K.$,new zg.a(function(){return ee.GetServiceTaskFactory.create(K.$.da,
137,K.la,K.ub)}),Ta.result))},this.la,3)}};Kd.N0g=function(){Kd.Wsf||(Kd.Wsf=!0,(new je).ei(oi.a.instance),oi.a.instance.resolve("Common.IOfficeTrialExperience").Qg(),oi.a.instance.resolve("Common.IMacOfficeOffer").Qg())};Kd.Wsf=!1;Object(ve.a)(Kd,"OpenInClientFactory",na.a,[]);var vj=b(113),$f=b(412),Pf=vj.a;Am(de,Pf);de.prototype.execute=function(K){var ea=Object(T.a)(6,K.Ke);ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.create(ea.da,56,ea.la,0),function(Ta){ea.downloadCopyOnOpenInClient?(K.activityState[$f.a.Ake]=
!0,Ta.result.m5f()):Ta.result.h2g()},ea.la,3);return 1};Object(ve.a)(de,"OpenInExcelClientActivity",vj.a,[]);var Ei=na.a;Am(Xe,Ei);Xe.prototype.create=function(){var K=this;ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){K.Eb(new de(oh.a.openInExcelClient,oh.a.idle))},this.la)};Object(ve.a)(Xe,"OpenInExcelClientActivityFactory",na.a,[]);var ri=ra.a;Am(Pe,ri);Pe.prototype.initialize=function(K){ri.prototype.initialize.call(this,K)};Pe.prototype.execute=
function(K){this.xi=K;K=Object(T.a)(6,this.xi.Ke);this.srb(K);return 1};Pe.prototype.WI=function(K){ri.prototype.WI.call(this,K)};Pe.prototype.srb=function(){var K=this;this.subscribe(this.xi,this.HWi,function(ea){K.kDd.add_disposing(ea)})};Pe.prototype.SFb=function(K){this.unsubscribe(function(ea){K.remove_disposing(ea)});this.xi.activityState[ki.a.A2]=0};Object(ve.a)(Pe,"PasswordProtectedFileActivity",ra.a,[]);var Qh=b(388),Fk=Qh.a;Am(Ff,Fk);Ff.prototype.Fab=function(K){this.Ipa=K};Ff.prototype.y3=
function(){var K={};K[Qh.a.description]=Kc.a.instance.fa(1936);K[Qh.a.rma]=Kc.a.instance.fa(1932);K[Qh.a.AFf]=Kc.a.instance.fa(1954);K[Qh.a.yFf]=Kc.a.instance.fa(1955);K[Qh.a.zFf]=Kc.a.instance.fa(1933);K[Qh.a.tld]=Kc.a.instance.fa(1939);K[Qh.a.Ase]=Kc.a.instance.fa(1634);K[Qh.a.aVj]=Kc.a.instance.Wa(25);K[Qh.a.Zeg]=Object(rf.a)(this,this.aUa,"verifySubmittedPassword");return K};Ff.prototype.kta=function(){var K={};K[Yf.a.Yx]=this.Cc;K[Qh.a.Yob]=this.y3();return K};Ff.prototype.hh=function(){this.jc=
1;this.initializeAndShow(this.Hm,this.L4i,this.kta())};Ek.Object.defineProperties(Ff.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PasswordDialog"}},jsb:{configurable:!0,enumerable:!0,get:function(){return this.Ipa}},Hm:{configurable:!0,enumerable:!0,get:function(){return Kc.a.instance.fa(1935)}}});Object(ve.a)(Ff,"PasswordProtectedFilePasswordInputDialog",Qh.a,[]);var Bi=b(292);Am(Kf,Ff);Kf.prototype.Fab=function(K,ea){Ff.prototype.Fab.call(this,K,ea);Ed.ULS.sendTraceTag(537154755,
0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",K)};Kf.prototype.aUa=function(K,ea){this.passwordToModify=K;var Ta={};Ta.FileModifyPassword=lg.a.mf(K);qe.ob(this.$.na.ua,Ta,this.nTi(ea),this.mTi(ea),null,null)};Kf.prototype.y3=function(){var K=Ff.prototype.y3.call(this);K[Qh.a.tld]=Kc.a.instance.fa(1940);K[Qh.a.description]=Kc.a.instance.Wa(24);return K};Kf.prototype.hh=function(){Sj.b().l8c("PasswordToModifyDialogShown");Ed.ULS.sendTraceTag(557446529,
0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");Ff.prototype.hh.call(this)};Kf.prototype.nTi=function(K){var ea=this;return function(Ta){$g.a.nh(Ta.Errors,[-2019873242])&&ea.N6b(ea.krb());if(!Ta||Bi.a(Ta))if(0<ea.DLd)ea.ZKf(K);else{Ed.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",$g.a.Wc(Ta.Errors));ea.$.ea.Fp(Ta.Errors);ea.hide();return}ea.H9d=Ta.Result;ea.shc&&
(Sj.b().NTd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),Ed.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));K(ea.shc?0:1)}};Kf.prototype.mTi=function(K){var ea=this;return function(){0<ea.DLd?ea.ZKf(K):(Ed.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),
K(3))}};Kf.prototype.ZKf=function(K){--this.DLd;this.aUa(this.passwordToModify,K)};Kf.prototype.krb=function(){return $g.a.gd(1,0,1633,1634,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};Ek.Object.defineProperties(Kf.prototype,{shc:{configurable:!0,enumerable:!0,get:function(){return this.H9d}},Hm:{configurable:!0,enumerable:!0,get:function(){return Kc.a.instance.fa(1937)}}});Object(ve.a)(Kf,"PasswordProtectedFileModifyPasswordInputDialog",Ff,[]);Am(tf,Pe);tf.prototype.srb=function(K){this.kDd=
new Kf(K);Pe.prototype.srb.call(this,K)};tf.prototype.SFb=function(K,ea){var Ta=K.jsb,Lb=K.shc,xc=K.passwordToModify;Pe.prototype.SFb.call(this,K,ea);this.xi.Txa([2001366804]);switch(Ta){case 1:Lb?(ea=Object(T.a)(6,this.xi.Ke),this.xi.activityState[ki.a.Qke]=lg.a.mf(xc),this.xi.activityState[ki.a.sYa]=!0,K.passwordToModify="",this.zh(ea.isEditMode?oh.a.Uj:this.EM)):Ed.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.Ap();break;case 0:this.xi.activityState[ki.a.Ss]=!1;this.zh(this.VJ);this.Ap();break;default:Ed.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",Ta)}};Object(ve.a)(tf,"PasswordProtectedFileModifyActivity",Pe,[]);var yk=na.a;Am(rd,yk);rd.prototype.create=function(){this.Eb(new tf(this.activityName,this.EM,this.VJ))};rd.ka=function(K){K.da.Ga(434,new rd(oh.a.RFb,oh.a.Eeb,oh.a.cHa,K))};Object(ve.a)(rd,"PasswordProtectedFileModifyActivityFactory",
na.a,[]);Am(xb,Ff);xb.prototype.aUa=function(K,ea){this.password=K;ea(0)};xb.prototype.y3=function(){var K=Ff.prototype.y3.call(this);this.Lhf&&(K[Qh.a.zlh]=1);return K};xb.prototype.hh=function(){Ed.ULS.sendTraceTag(537154722,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",this.Lhf);Ff.prototype.hh.call(this);Vh.a(this.$).Noe()};Object(ve.a)(xb,"PasswordProtectedFileOpenPasswordInputDialog",Ff,[]);Am(Hd,Pe);Hd.prototype.srb=function(K){var ea=
$g.a.nh(this.xi.errors,[1217361942]);this.kDd=new xb(K,ea);K.Efc||K.FHe();Pe.prototype.srb.call(this,K)};Hd.prototype.SFb=function(K,ea){var Ta=K.password;K.password="";var Lb=K.jsb;Pe.prototype.SFb.call(this,K,ea);this.xi.activityState[ki.a.hUc]=lg.a.mf(Ta);this.xi.activityState[ki.a.sYa]=!0;this.xi.Txa([110414285,1217361942]);Ed.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",Lb);switch(Lb){case 1:this.zh(this.EM);
this.Ap();break;case 0:this.zh(this.VJ),this.Ap()}};Object(ve.a)(Hd,"PasswordProtectedFileOpenActivity",Pe,[]);var Yk=na.a;Am(Bc,Yk);Bc.prototype.create=function(){this.Eb(new Hd(this.activityName,this.EM,this.VJ))};Bc.ka=function(K){K.da.Ga(386,new Bc(oh.a.Fpc,oh.a.Uj,oh.a.Jk,K))};Object(ve.a)(Bc,"PasswordProtectedFileOpenActivityFactory",na.a,[]);var Mj=b(398),zk=Mj.a;Am($d,zk);$d.prototype.LO=function(K,ea){this.Ipa=K;zk.prototype.LO.call(this,K,ea)};$d.prototype.Gr=function(){zk.prototype.Gr.call(this);
this.jc=9;var K=this.pRh();this.Dc(1,Kc.a.instance.fa(1632));this.Dc(2,Kc.a.instance.fa(976));this.yk(Kc.a.instance.fa(702),fg.a.fg(K),this.icon,this.MO)};$d.prototype.pRh=function(){return String.format(Kc.a.instance.fa(703))};Ek.Object.defineProperties($d.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},jsb:{configurable:!0,enumerable:!0,get:function(){return this.Ipa}}});Object(ve.a)($d,"LegacySharedWorkbookDialog",Mj.a,[]);var Gk=ra.a;Am(ae,Gk);ae.prototype.initialize=
function(K){Gk.prototype.initialize.call(this,K)};ae.prototype.execute=function(K){this.xi=K;this.y5g();return 1};ae.prototype.WI=function(K){Gk.prototype.WI.call(this,K)};ae.prototype.y5g=function(){var K=Object(T.a)(6,this.xi.Ke),ea=$g.a.b_a([-573864504]);ea[0].HelpDescription=Kc.a.instance.fa(705);ea[0].HelpTopicId=Vc.a.vri;var Ta=new $d(K,ea[0]);this.subscribe(this.xi,this.tri,function(Lb){Ta.add_disposing(Lb)})};Object(ve.a)(ae,"LegacySharedWorkbookActivity",ra.a,[]);var rj=na.a;Am(vd,rj);vd.prototype.create=
function(){this.Eb(new ae(this.activityName,this.EM,this.VJ))};vd.ka=function(K){K.da.Ga(460,new vd(oh.a.DBb,oh.a.Eeb,oh.a.cHa,K))};Object(ve.a)(vd,"LegacySharedWorkbookActivityFactory",na.a,[]);jc.prototype.Zc=function(){return!1};jc.prototype.Lc=function(K,ea){if(!hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(ea.command){case 642419866:return!0;case 588342182:return this.presentModeManager.Hz;default:return!1}};jc.prototype.executeCommand=function(K,
ea){K=ye.TaskExtensions.hl();ea=ea.command;switch(ea){case 642419866:this.presentModeManager.Xxc(!this.presentModeManager.Hz);this.presentModeManager.wh("TogglePresentMode");break;case 588342182:this.presentModeManager.h7a=!this.presentModeManager.h7a;this.presentModeManager.x3f(this.presentModeManager.h7a,"TogglePresentModeOverlay");this.presentModeManager.wh("TogglePresentModeOverlay");break;default:K=lf.a(ea)}return K};jc.prototype.jd=function(){return!1};Object(ve.a)(jc,"PresentModeCommandHandler",
null,[429]);var Zj=Yc.a;Am(pd,Zj);pd.prototype.Nd=function(){var K=this;ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.Va(this.$.da,423,424,this.ub),function(ea){K.Cd([new jc(K.$,ea.result)])},this.la,3)};pd.ka=function(K){Yc.a.fe(420,new pd(K))};Object(ve.a)(pd,"PresentModeCommandHandlerFactory",Yc.a,[]);var gi=b(126),N=b(112);Hc.Hqh="ewa-presentMode-overlay";Hc.Iqh="ewa-presentMode-panel-container";Hc.Jqh="ewa-presentMode-rowHdrParent-container";Object(ve.a)(Hc,"CssClassNames",null,[]);var Fa=b(19),
Hb=b(153),mc=b(303),cd=b(131),Le=b(121),Qc=b(466),Id=b(12),Xf=b(99),Nf=b(359),gh=b(132),Yg=b(442),Lh=b(271),Yh=b(254),Bh=b(188);Ub.prototype.dispose=function(){this.$=this.JEd=this.KEd=this.Qca=this.DPa=null};Ub.prototype.E$h=function(){var K=this;window.requestAnimationFrame(function(){K.Qca=document.createElement("div");K.$.uw.insertBefore(K.Qca,K.$.uw.lastChild);K.Qca.id=K.$.Mb+A.a.j$b;K.Qca.classList.add(Hc.Iqh);K.KEd=document.getElementById(K.$.Mb+A.a.A5c);K.JEd=[K.$.zE];K.isInitialized=!0});
this.DPa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.DPa.initializePresentModeFloatie()};Ub.prototype.LYh=function(){var K={};K.PollingCountPerCaller=N.a.toJSON(this.dqc);K.PollingDurationPerCaller=N.a.toJSON(this.eqc);return K};Ub.prototype.hSd=function(K){this.isInitialized?K?(this.DPa.showPresentModeFloatie(this.Qca,this.KEd,this.JEd),this.wh("ShowOrHideFloatiePanel"),this.T7i()):(this.DPa.hidePresentModeFloatie(),this.yOj()):Ed.ULS.sendTraceTag(537154326,
0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};Ub.prototype.wh=function(K){this.CGf=Hh.HelperMethods.$b();this.APa=K;this.ese=Bh.AsyncMethodContext.$u(this.Pl,100,Hj.a.A_i+K,this.ese)};Ub.prototype.Wf=function(K,ea){if(ea)return!1;K=Id.DOMElementExtensions.Km(this.Qca.querySelectorAll(Id.DOMElementExtensions.sr));if(!K)return Ed.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),
!1;K.focus();return!0};Ub.prototype.ph=function(K){return Id.DOMElementExtensions.Ff(this.uc,K)};Ub.prototype.Cj=function(){};Ub.prototype.Rj=function(){};Ub.prototype.T7i=function(){var K=this;Lh.a(this.$).$h(this);this.$.da.$a(15,function(ea){K.ewaAccessibilityManager=ea;K.ewaAccessibilityManager.mode=5});te.KeyInputManager.instance.pa(ag.a.Yb,this.uc,this.onKeyDown)};Ub.prototype.yOj=function(){Lh.a(this.$).Vz(this);Tg.g(this.$).M0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=
0);te.KeyInputManager.instance.za(ag.a.Yb,this.uc,this.onKeyDown)};Ub.prototype.njj=function(){var K=Hh.HelperMethods.$b()-this.CGf,ea=this.eqc[this.APa]?this.eqc[this.APa]:0;this.eqc[this.APa]=ea>K?ea:K;this.dqc[this.APa]=this.dqc[this.APa]?this.dqc[this.APa]+1:1};Ek.Object.defineProperties(Ub.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return this.Qca}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){this.DPa.updatePresentModeFloatieShyState(2);return!!this.Qca}},we:{configurable:!0,
enumerable:!0,get:function(){return Yh.a.OHf}}});Object(ve.a)(Ub,"PresentModeFloatieManager",null,[868,444,3]);var jh=b(7),hj=b(60);Object(ve.a)(nd,"OverlayCavityInfo",null,[]);Object(ve.a)(ed,"OverlayContainerInfo",null,[]);Object(ve.a)(ne,"PresentModeOverlayProps",null,[]);Xc.prototype.nai=function(){var K=this;this.LEd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(function(){K.m_a=Array(5);for(var ea,Ta,Lb=1;4>=Lb;Lb++)ea=document.createElement("div"),
Id.DOMElementExtensions.setVisible(ea,!1),ea.id=String.format("{0}-{1}","PresentModeOverlay",Lb),Id.DOMElementExtensions.toggleCssClass(ea,Hc.Hqh,!0),Ta=K.gridView.Tf(Lb).domElement,Ta.insertBefore(ea,Ta.firstChild),K.m_a[Lb]=ea})};Xc.prototype.w3f=function(K){K&&this.ORj();for(var ea=1;4>=ea;ea++)this.aff(ea)&&Id.DOMElementExtensions.setVisible(this.m_a[ea],K);Id.DOMElementExtensions.toggleCssClass(this.$.kr,"ewr-presentMode-overlay",K)};Xc.prototype.ORj=function(){for(var K=this.lTg(),ea,Ta=1;4>=
Ta;Ta++)ea=Ta,K[ea]&&this.LEd.showOverlayWithCavity(this.m_a[ea],K[ea])};Xc.prototype.dispose=function(){this.LEd=this.m_a=this.gridView=this.$=null};Xc.prototype.lTg=function(){for(var K,ea,Ta=Tg.g(this.$).rtl,Lb,xc=Array(5),qd=1;4>=qd;qd++)ea=qd,this.aff(qd)&&(K=this.gridView.Tf(qd),Lb=this.gridView.ha.Oa.m5?this.POh(qd,K,Ta):this.HPh(qd,K,Ta),K=this.a8g(K),xc[ea]=this.u8g(this.m_a[ea].id,K,Lb));return xc};Xc.prototype.aff=function(K){return this.gridView.rb.eR(K)};Xc.prototype.a8g=function(K){return Object(jh.a)(new ed,
{width:K.zn.width,height:K.zn.height})};Xc.prototype.u8g=function(K,ea,Ta){return Object(jh.a)(new ne,{containerId:K,overlayContainerInfo:ea,overlayCavityInfos:Ta?[Ta]:null})};Xc.prototype.POh=function(K,ea,Ta){var Lb=Tg.g(this.$).ha.Oa.oc;if(!Lb)return Ed.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;var xc=Lb.extension.SOh(K);K=xc.ZBa;Lb=xc.rotation;var qd=xc.translateX;var Jd=xc.translateY;return xc.returnValue?
(xc=K.x-ea.zn.x,Object(jh.a)(new nd,{left:(Ta?ea.zn.width-(xc+K.width):xc)-3+1,top:K.y-ea.zn.y-3+1,width:K.width+5,height:K.height+5,angle:Lb,translateX:qd,translateY:Jd})):null};Xc.prototype.HPh=function(K,ea,Ta){K=this.gridView.Cb.Vub(this.gridView.ha.sa.activeRange,K)||hj.a.h4;if(!K.Me(ea.zn))return null;var Lb=K.x-ea.zn.x;return Object(jh.a)(new nd,{left:Ta?ea.zn.width-(Lb+K.width)-2:Lb-3,top:K.y-ea.zn.y-3,width:K.width+5,height:K.height+5})};Object(ve.a)(Xc,"PresentModeOverlayRenderer",null,
[867,3]);var Nj=Qh.a;Am(bd,Nj);bd.prototype.hide=function(){Nj.prototype.hide.call(this);gi.a.Kv(A.a.C3f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};Ek.Object.defineProperties(bd.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(ve.a)(bd,"PresentModeWelcomeDialog",Qh.a,[]);md.requestFullscreen=function(K){K.webkitRequestFullscreen?K.webkitRequestFullscreen():K.msRequestFullscreen?K.msRequestFullscreen():K.mozRequestFullScreen?
K.mozRequestFullScreen():K.requestFullscreen?K.requestFullscreen():Ed.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};md.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():Ed.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};Ek.Object.defineProperties(md,
{AEh:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},BEh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?
"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},Ohi:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(ve.a)(md,"FullscreenUtils",null,[]);qc.prototype.Xxc=function(K){var ea=this;this.Hz!==K&&(this.K9d=K,this.h7a=this.Hz,this.Iaf(),this.wLb=this.k2f(),window.requestAnimationFrame(function(){Id.DOMElementExtensions.toggleCssClass(ea.$.kr,
"ewr-presentMode-transition",!0);$addHandler(ea.o2a,"transitionend",ea.uoa);ea.Wzj(!K);ea.sVi();Id.DOMElementExtensions.toggleCssClass(ea.$.kr,"ewr-presentMode-on",K);ea.Vzj(K);Hb.b(ea.$).u3f(ea.Hz);Hb.c(ea.$).u3f(ea.Hz);ea.$.Vza();ea.FPa.w3f(ea.wLb);if(ea.Hz){ea.AZa();gi.a.get(A.a.C3f)?ea.Rca.hSd(ea.Hz):ea.yqc=new bd(ea.$,ea.Rca);var Ta=Yg.b(ea.$);Ta&&(ea.LLd=Ta.$7c(!1));ea.NHf=Hh.HelperMethods.$b()}else ea.Rca.hSd(K),ea.LLd&&(Ta=Yg.b(ea.$))&&(Ta.$7c(!0),ea.LLd=!1),ea.r6b(),ea.bvi()}))};qc.prototype.x3f=
function(K,ea){this.mSd=K;this.xea(ea)};qc.prototype.wh=function(K){this.Rca.wh(K)};qc.prototype.dispose=function(){this.r6b();this.FPa&&(this.FPa.dispose(),this.FPa=null);this.gridView=this.$=null};qc.prototype.Wzj=function(K){var ea=this.$.da.Aa(25);void 0===ea||null===ea?Ed.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):K?ea.Rxc():ea.Xdc()};qc.prototype.sVi=function(){var K=this;Id.DOMElementExtensions.toggleCssClass(document.getElementById(he.AFrameworkApplication.x2a),
Fa.a.fq,this.Hz);Id.DOMElementExtensions.toggleCssClass(this.$.kr,"ewr-presentMode-on",this.Hz);this.Zzj(this.Hz);this.gridView.Mod=!this.Hz;this.dSj();this.$.da.$a(32,function(ea){ea.zSj(K.Hz)});Le.b(this.$,function(ea){ea.Acg(K.Hz)})};qc.prototype.Zzj=function(K){if(this.wGb)if(K){if(K=Object(T.a)(Xf.a,this.$.qa))Id.DOMElementExtensions.toggleCssClass(this.$.kr,"ewr-presentMode-on-headers-off",!K.headersVisible),Id.DOMElementExtensions.toggleCssClass(this.$.kr,"ewr-presentMode-on-rtl",Tg.g(this.$).rtl);
this.EBc(0)}else this.$.kr.classList.remove("ewr-presentMode-on-headers-off"),this.$.kr.classList.remove("ewr-presentMode-on-rtl"),this.EBc(1)};qc.prototype.EBc=function(K){var ea=Object(T.a)(Xf.a,this.$.qa);if(ea){var Ta=parseInt(this.$.uw.style.right,10);if(1===K||2===K){if(isNaN(Ta)||Ta<this.T0a)return;Ta-=this.T0a}if(0===K||2===K)K=ea.headersVisible,ea=Tg.g(this.$).rtl,K=K?ea?0:32:12,Ta=isNaN(Ta)?K:Ta+K,this.T0a=K;this.$.uw.style.right=Hh.HelperMethods.nc(Ta);this.vBe=Ta}};qc.prototype.dSj=function(){var K=
document.getElementById(this.$.Mb+A.a.T5b).parentNode;Id.DOMElementExtensions.toggleCssClass(K,Hc.Jqh,this.Hz)};qc.prototype.initialize=function(K){this.FPa=new Xc(K);this.FPa.nai();this.Rca=new Ub(K);this.Rca.E$h();this.o2a=document.getElementById("MainApp");this.dVe=this.aKi;$addHandler(this.o2a,md.AEh,this.dVe);$addHandler(this.o2a,md.BEh,this.bKi);this.wGb||(this.wGb=document.createElement("div"),this.wGb.className="ewa-presentMode-right-frame",this.$.zE.appendChild(this.wGb));this.uoa=this.r$i};
qc.prototype.AZa=function(){this.gridView.ha.S2(this.Dp);this.gridView.ha.IY(this.Kg);this.gridView.wc.ml(this.gj);this.gridView.wc.mo(this.ug);this.gridView.nE(this.Bp);this.gridView.view.Vs(this.Tw);this.gridView.cVc(this.PDb);this.gridView.Ea.PG(this.Sm);this.gridView.Ea.Us(this.zf);this.$.xa.Bg(this.gi);this.$.xa.Nra(this.EF);this.$.xa.Oga(this.ZEb);this.$.QA(this.fj);this.$.nl(this.zd);var K=Object(T.a)(Nf.a,this.$.xa);K=El(K.items);for(var ea=K.next();!ea.done;ea=K.next())ea.value.Hnb(this.Jya)};
qc.prototype.r6b=function(){this.gridView&&(this.gridView.ha.f7(this.Dp),this.gridView.ha.$W(this.Kg),this.gridView.wc.fl(this.gj),this.gridView.wc.Dn(this.ug),this.gridView.UF(this.Bp),this.gridView.view.Xq(this.Tw),this.gridView.$Id(this.PDb),this.gridView.Ea.tI(this.Sm),this.gridView.Ea.Vq(this.zf));if(this.$){this.$.xa.Xg(this.gi);this.$.xa.Kza(this.EF);this.$.xa.Pma(this.ZEb);this.$.zD(this.fj);this.$.Sl(this.zd);var K=Object(T.a)(Nf.a,this.$.xa);K=El(K.items);for(var ea=K.next();!ea.done;ea=
K.next())ea.value.IJd(this.Jya)}};qc.prototype.k2f=function(){if(!this.Hz||!this.h7a)return!1;if(1===this.gridView.ha.Ue){var K=this.$.qa.activeRange.isSingle,ea=1===this.$.qa.selectedRanges.length&&!K,Ta=this.gridView.isEditing,Lb=this.Eqd;ea||Ed.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",K);return this.mSd&&ea&&!Ta&&!Lb}return this.mSd};qc.prototype.Vzj=function(K){K?md.requestFullscreen(this.o2a):
md.exitFullscreen()};qc.prototype.xea=function(K,ea,Ta){var Lb=this;Ta=void 0===Ta?!1:Ta;void 0!==ea&&ea||(this.wLb=this.k2f());Ed.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",K,this.wLb,Ta);if(this.jOb&&Ta)Ed.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",this.iOb),window.cancelAnimationFrame(this.iOb),this.iOb=0;else if(this.jOb){Ed.ULS.sendTraceTag(543023558,
0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",K);return}Ta?this.CYd(Hh.HelperMethods.$b(),K):(this.iOb=window.requestAnimationFrame(function(xc){Lb.CYd(xc,K)}),this.jOb=!0)};qc.prototype.CYd=function(K,ea){var Ta=this,Lb=Hh.HelperMethods.$b();if(Lb-K>this.Wjj)this.iOb=window.requestAnimationFrame(function(qd){Ta.CYd(qd,ea)}),this.jOb=!1,Ed.ULS.sendTraceTag(537154319,0,50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",Lb-
K);else{this.FPa.w3f(this.wLb);this.jOb=!1;var xc=Hh.HelperMethods.$b();K=Hh.HelperMethods.$b()-K;Lb=xc-Lb;this.ajj(K,ea);Ed.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",Lb,K)}};qc.prototype.Iaf=function(){var K=this;tb.a(this.$.userOperationManager,function(ea,Ta,Lb){var xc=K.$.na.ua,qd=K.Hz,Jd=xc.Na(41,null);Jd.shouldEnablePresentMode=qd;return qe.i(xc,"SetPresentMode",Jd,ea,Ta,Lb,null,0)},function(ea){return new $c.a(252,
0,ea)},null)};qc.prototype.bVf=function(){var K=Qc.a(this.gridView.Ue);1!==this.gridView.Ue||this.$.qa.activeRange.isSingle||(K="Range");this.nvc[K]=this.nvc[K]?this.nvc[K]+1:1};qc.prototype.ajj=function(K,ea){var Ta=this.opc[ea]?this.opc[ea]:0;this.opc[ea]=Ta>K?Ta:K;this.npc[ea]=this.npc[ea]?this.npc[ea]+1:1};qc.prototype.bvi=function(){var K={},ea=Hh.HelperMethods.$b()-this.NHf;K.PresentModeDuration=ea;K.SelectionCountPerObject=N.a.toJSON(this.nvc);K.OverlayCountPerCaller=N.a.toJSON(this.npc);K.OverlayDurationPerCaller=
N.a.toJSON(this.opc);ea=this.Rca.LYh();for(var Ta in ea)K[Ta]=ea[Ta];gh.b(this.$).Vd(cd.a.z_i,K,void 0,!0)};Ek.Object.defineProperties(qc.prototype,{Hz:{configurable:!0,enumerable:!0,get:function(){return this.K9d}}});Object(ve.a)(qc,"PresentModeManager",null,[764,3]);var bk=b(256),yj=na.a;Am(Wd,yj);Wd.prototype.create=function(){var K=this,ea=ee.GetServiceTaskFactory.Va(this.$.da,283,284,1);ye.TaskExtensions.Ba(ea,function(){ye.TaskExtensions.Ba(bk.c(ea.result.Jn.loadScript("presentMode")),function(){var Ta=
K.$.da.Aa(423);Ta||(Ta=new qc(K.$),K.$.da.Ga(423,Ta));K.Eb(Ta)},K.$.la,3)},this.$.la,3)};Wd.ka=function(K){K.da.Ga(424,new Wd(K))};Object(ve.a)(Wd,"PresentModeManagerFactory",na.a,[]);var ij=b(178),ck=b(160),Ii=b(729),jj=b(88),Tj=b(31);we.lrh="ewa-resizehdr-row-hidden";we.krh="ewa-resizehdr-col-hidden";Object(ve.a)(we,"CssClassNames",null,[]);var zj=b(64),hk=b(25),mk=b(150),Oj=b(54),yh=b(72),Kk=b(259),Hk=b(389);Object(ve.a)(Ad,"HeaderEventCachedInfo",null,[]);Ob.prototype.WBe=function(K){K=Hh.HelperMethods.NDd(K);
return Math.max(0,Math.min(Ob.apf,K))};Ob.prototype.NBe=function(K){return this.UXi(K)};Ob.prototype.JZg=function(K){return Math.round(this.w7c*K+2*this.yYe()+1)};Ob.prototype.UXi=function(K){return Math.max(0,Math.min(Ob.Kof,(Math.max(0,Math.min(af.a.Ykc,K))-2*this.yYe()-1)/this.w7c))};Ob.prototype.yYe=function(){return Math.floor(Math.max((this.w7c+3)/4,2))};Ob.prototype.Jbc=function(K,ea){return ea?K?Ob.apf:af.a.dwd:K?Ob.Kof:af.a.Ykc};Ob.apf=409;Ob.Kof=255;Object(ve.a)(Ob,"ResizeHeadersConverter",
null,[]);var Aj=b(33),dk=jj.a;Am(Zc,dk);Zc.prototype.sya=function(K,ea){K=new Sys.UI.DomEvent(K);K=Ii.a.create(ag.a.qha,this.domElement,K,2);K=Aj.a(this.grid.$).je(K);this.yHf(ea,K.clientPoint.x,K.clientPoint.y,!1);ea=this.cyc();this.Bcd(this.JSa,ea,!0);this.lY&&this.x$e();this.Xza||(ea=this.domElement.ownerDocument.body,ea.addEventListener(ag.a.qha,this.Oxf),ea.addEventListener(ag.a.EGa,this.Qxf),this.Xza=!0)};Zc.prototype.aMi=function(K,ea){this.yHf(ea,K.clientX,K.clientY,!0);K=this.grid;ea=this.pgd(K);
ea=sd.r(ea,K.$);K.Cb.Nh([this.isRow?13:14]);K.Cb.lSa();this.NHb();var Ta={};K.$.Xd(this.isRow?146338636:1391094586,Ua.a.Ub,30,(Ta.autoFitRanges=ea,Ta))};Zc.prototype.dispose=function(){this.C0c();this.grid.ha&&(this.grid.ha.aX(this.Kg),this.grid.ha.f7(this.Dp));this.grid.cx(this.Kg);Vh.a(this.grid.$)&&Vh.a(this.grid.$).vg.Qma(this.HF);ng.a.instance.za(ag.a.kk,this.domElement,this.tca);ij.a.instance.za(ag.a.$d,this.domElement.ownerDocument.body,this.dEb);ck.a.instance.za(ag.a.De,this.domElement.ownerDocument.body,
this.dEb);Af.a.rp||(ij.a.instance.za(ag.a.pointerDown,this.domElement,this.RN),ij.a.instance.za(ag.a.vh,this.domElement,this.VR));this.Xza&&(ij.a.instance.za(ag.a.vh,this.domElement.ownerDocument.body,this.B9a),ck.a.instance.za(ag.a.yg,this.domElement.ownerDocument.body,this.B9a),this.Xza=!1);this.rG&&(ij.a.instance.za(ag.a.pointerDown,this.rG,this.RN),ng.a.instance.za(ag.a.kk,this.rG,this.tca),this.C0c(),this.rG=null);this.OSf&&(Id.DOMElementExtensions.Af(Zc.Rbb),Zc.Rbb=null);this.tf=null;dk.prototype.dispose.call(this)};
Zc.prototype.q7i=function(){ng.a.instance.pa(ag.a.kk,this.domElement,this.tca);ij.a.instance.pa(ag.a.$d,this.domElement.ownerDocument.body,this.dEb);ck.a.instance.pa(ag.a.De,this.domElement.ownerDocument.body,this.dEb);Af.a.rp||(ij.a.instance.pa(ag.a.pointerDown,this.domElement,this.RN),ij.a.instance.pa(ag.a.vh,this.domElement,this.VR))};Zc.prototype.ilh=function(){if(!Zc.Rbb){document.getElementById(Zc.NSf);this.OSf=!0;var K=Zc.Rbb=document.createElement("div");this.grid.$.frame.Oaa().appendChild(K);
K.id=Zc.NSf;K.className=Tj.a.mrh;Id.DOMElementExtensions.setVisible(K,!1)}};Zc.prototype.fLe=function(){this.Xza&&(this.grid.iq?(this.domElement.removeEventListener(ag.a.qha,this.Oxf),this.domElement.removeEventListener(ag.a.EGa,this.Qxf)):(ij.a.instance.za(ag.a.vh,this.domElement.ownerDocument.body,this.B9a),ck.a.instance.za(ag.a.yg,this.domElement.ownerDocument.body,this.B9a)),this.Xza=!1);this.lY=!1;this.ahj();this.RId();Hk.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};Zc.prototype.ahj=
function(){this.grid.Cb.Nh([this.isRow?13:14]);this.grid.Cb.lSa()};Zc.prototype.Pxf=function(K,ea){if(!this.lY)return!1;this.grid.iq||hf.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")||yh.g(ea);ea=this.isRow;if(!this.grid.iq&&!this.Y0){this.Y0=document.createElement("div");this.Y0.style.cssText="position: relative; width: inherit; height: inherit;"+(ea?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Ta=this.fm.bK();Ta.nextSibling;)this.Y0.appendChild(Ta.nextSibling);
Ta.parentNode.appendChild(this.Y0)}Ta=ea?K.y-this.O7a.y:(this.rtl?-1:1)*(K.x-this.O7a.x);var Lb=ea?K.y-this.JSa.y:(this.rtl?-1:1)*(K.x-this.JSa.x),xc=this.fm.tja();if(xc===af.a.O5a)return!1;Ta&&(0<this.ql||0<xc+Lb)&&xc+Lb<=this.Mof&&(this.ql=this.cyc(Lb),this.Bcd(K,this.ql,!1),this.grid.iq?this.ql>=Zc.j7e?(this.PKd=!0,this.fm.setCellExtent(this.ql)):this.PKd&&(this.PKd=!1,this.fm.setCellExtent(Zc.j7e)):(Id.DOMElementExtensions.JTa(this.fm.bK(),!ea,Math.max(this.xJb+Lb,0)),this.Y0.style[ea?"top":this.rtl?
"right":"left"]=Math.max(Lb,-this.xJb)+"px"),Id.DOMElementExtensions.JTa(this.fm.tf.domElement,!ea,(ea?this.fm.tf.XP:this.fm.tf.YP)+Math.max(Lb,-this.xJb)),this.O7a=new Sys.UI.Point(K.x,K.y),Id.DOMElementExtensions.setVisible(this.rG,!1));return!0};Zc.prototype.Bcd=function(K,ea,Ta){this.bN&&Ta&&(Ed.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.RId());this.bN||Ta||Ed.ULS.sendTraceTag(537154050,
2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.Aud&&this.Aud(function(){var Lb={};return Lb.Location="canvas",Lb});this.bN?this.YVe(ea):(this.bN=document.createElement("div"),this.bN.id=this.z5h,this.YVe(ea),this.bN.className=Tj.a.Dph,ea=document.getElementById(this.grid.$.Mb+A.a.zqf),ea.insertBefore(this.bN,ea.firstChild),K=Aj.a(this.grid.$).Aja(K),this.bN.style.left=(this.rtl?Math.max(K.x-this.bN.offsetWidth,0):K.x-Math.max(K.x+
this.bN.offsetWidth-ea.offsetWidth,0)).toString()+"px",ea=document.getElementById(A.a.lGa),this.bN.style.top=(K.y-(he.AFrameworkApplication.ta&&he.AFrameworkApplication.ta.Qa.Wg?0:ea.offsetHeight)-this.bN.offsetHeight).toString()+"px")};Zc.prototype.RId=function(){Id.DOMElementExtensions.Af(this.bN);this.bN=null};Zc.prototype.YVe=function(K){var ea=new Ob(this.grid.$.workbookContext.DxDigitNormal);ea=this.isRow?ea.WBe(K).toFixed(2):ea.NBe(K).toFixed(2);this.bN.innerText=String.format("{0} {1} ({2} {3})",
this.isRow?this.v5h:this.E5h,ea,K.toString(),this.y5h)};Zc.prototype.zHf=function(K,ea){var Ta;if(-1!==this.grid.ha.selectionType||2===K.yb&&K.Ca.button!==Sys.UI.MouseButton.leftButton||!this.Krd(Ta=this.Oed(K))||!this.Rff)return!1;yh.g(K.Ca);this.JSa=this.O7a=new Sys.UI.Point(K.clientPoint.x,K.clientPoint.y);this.HSg(Ta,ea);if(!this.fm)return!1;this.lY=!0;this.lli(this.fm,Ta)&&this.y9h();return this.AHf(ea)};Zc.prototype.yHf=function(K,ea,Ta,Lb){this.lY=!0;this.fm=K;this.JSa=this.O7a=new Sys.UI.Point(ea,
Ta);!this.hX&&this.fm&&(this.hX=this.fm.getRange());this.AHf(Lb)};Zc.prototype.AHf=function(K){var ea={};gh.b(this.grid.$).Vd(cd.a.Vfj,(ea.IsResizingHiddenHeader=this.sWa,ea.IsAutoFitting=K,ea.NumberOfSelectedRanges=this.grid.ha.sa.JK,ea.Location="canvas",ea));this.xJb=this.grid.iq?this.GNh():this.$dd();this.offset=this.fm.Xaa();this.ql=this.fm.tja();if(this.ql===af.a.O5a)return!1;Hk.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0};Zc.prototype.lli=function(K,ea){var Ta=
this.fm.bK();if(!Ta)return Ed.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;Ta=Ta.nextSibling;if(!Ta)return!1;K=K.getRange();Ta=this.tf.bva(Ta).getRange();if(!K||!Ta)return Ed.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;var Lb=hf.EwaSettings.isChangeGateEnabled("OfficeVSO:6101474_EnableUnhideRowByMouseDrag");K=Lb&&this.isRow?K.bottom:K.right;Ta=Lb&&this.isRow?Ta.bottom:Ta.right;return K+1!==Ta&&K!==Ta&&this.Krd(ea,!0)};Zc.prototype.y9h=
function(){var K=this.fm.bK(),ea=this.tf.bva(K.nextSibling);Zc.mli(ea,this.isRow)?(this.fm=ea,this.hX=this.fm.getRange()):(this.VAg(K),this.fm=ea,K=this.fm.getRange(),this.hX=this.isRow?new hk.Range(K.top-1,K.left,K.top-1,K.right,!1,!0):new hk.Range(K.top,K.left-1,K.bottom,K.left-1,!1,!0),this.sWa=!0)};Zc.prototype.VAg=function(K){var ea=this.tf.bva(K.nextSibling),Ta=Zc.A6g(ea,this.isRow,this.rtl);Ta&&K.parentNode.insertBefore(Ta,ea.bK())};Zc.prototype.pgd=function(K){var ea=this.hX,Ta=K.ha.sa.selectedRanges;
if(K.ha.sa.xsb(ea))if(this.isRow){if(Pa.a.all(Ta,function(Lb){return Lb.isRow}))return Ta}else if(Pa.a.all(Ta,function(Lb){return Lb.ef}))return Ta;return[ea]};Zc.prototype.GNh=function(){return this.fm.tja()-Zc.Zcc};Zc.prototype.$dd=function(){var K=this.fm.bK().style;return Math.max(0,Math.min(this.Mof,0|parseInt(this.isRow?K.height:K.width,10)))};Zc.prototype.cyc=function(K){K=void 0===K?0:K;var ea=this.grid,Ta=this.tf.zj.paneType;Ta=this.isRow?3===Ta?[3,2]:[1,4]:4===Ta?[2,4]:[1,3];var Lb=ea.view.visibleArea.bottomRight,
xc=this.fm.tja();xc===af.a.O5a&&(xc=0);K=this.sWa?Math.max(this.$dd(),0):Math.max(xc+K,0);Lb=this.isRow?new hj.a(0,this.offset,Lb.x,K):new hj.a(this.offset,0,K,Lb.y);xc=[this.isRow?13:14];ea.Cb.wj(hk.Range.hd(1,1),xc,!1);ea.Cb.Fn(xc,Lb,Ta);return K};Zc.prototype.C0c=function(){this.hX=this.JSa=this.O7a=null;if(this.Y0){var K=this.Y0.parentNode;if(K)for(K.removeChild(this.Y0);this.Y0.firstChild;)K.appendChild(this.Y0.firstChild);this.Y0=null}this.fm=null;Id.DOMElementExtensions.setVisible(Zc.Rbb,!1);
this.lY=!1;this.RId();Id.DOMElementExtensions.setVisible(this.rG,!1)};Zc.prototype.Oed=function(K){if(Id.DOMElementExtensions.Fz(K.Lb,"a"))return null;var ea=this.ohf(K.Ca);if(ea&&this.grid.ha.sa.Ig){var Ta=this.grid.ha.sa.qd;Ta=this.tf.hs(hk.Range.hd(Ta.bottom,Ta.right))}else Ta=this.tf.bva(K.Lb);if(!Ta)return null;var Lb=Ta.bK(),xc=new Sys.UI.Bounds(Lb.offsetLeft,Lb.offsetTop,Lb.offsetWidth,Lb.offsetHeight),qd=Id.DOMElementExtensions.getBoundingClientRect(K.Lb);qd=new Sys.UI.Point(K.clientPoint.x-
qd.x,K.clientPoint.y-qd.y);this.isRow&&!ea&&(qd.y+=Hh.HelperMethods.QC(K.Lb,Lb,this.rtl).y);return new Ad(Lb,qd,xc,Ta.getRange(),Math.max(Zc.Vzi,Math.min(Zc.Qyi,(this.isRow?xc.height:xc.width)*Zc.egj)),ea,!this.isRow&&0<Lb.getElementsByTagName("input").length)};Zc.prototype.Krd=function(K,ea){ea=void 0===ea?!1:ea;if(!K||this.grid.isEditing)return!1;if(K.nhf)return!0;var Ta=K.COa,Lb=K.Qbb,xc=this.tf.zj.paneType,qd=this.grid.Tf(xc).Gh,Jd=!!qd&&qd.top===K.Gjd.top,De=!!qd&&qd.left===K.Gjd.left;xc=!!qd&&
qd.bottom===K.Gjd.bottom&&(3===xc||2===xc);this.isRow?(De=K.QCb.y,K=De<=Lb&&!Jd,Ta=De>=Ta.height-Lb-(xc?Zc.tEh:0),ea=ea?K:Ta||K):(xc=K.C4h,Jd=this.rtl,qd=K.QCb.x,K=qd<=Lb&&(!De||Jd)&&(!xc||!Jd),Ta=qd>=Ta.width-Lb&&(!Jd||!De)&&(!xc||Jd),ea=ea?Jd?Ta:K:K||Ta);return ea};Zc.prototype.HSg=function(K,ea){var Ta=this.isRow;if(K.nhf)this.fm=this.tf.bva(K.Pva);else if(Ta&&K.QCb.y<=K.Qbb&&K.COa.height>K.Qbb||!Ta&&K.COa.width>K.Qbb&&(!this.rtl&&K.QCb.x<=K.Qbb||this.rtl&&K.QCb.x>=K.COa.width-K.Qbb)){if(this.fm=
K.Pva.previousSibling?this.tf.bva(K.Pva.previousSibling):this.fRh(),ea&&K.Pva.classList.contains(Ta?Tj.a.RQe:Tj.a.QQe)&&(K=this.tf.bva(K.Pva)))K=K.getRange(),this.hX=Ta?new hk.Range(K.top-1,K.left,K.top-1,K.right,!1,!0):new hk.Range(K.top,K.left-1,K.bottom,K.left-1,!1,!0)}else this.fm=this.tf.bva(K.Pva);!this.hX&&this.fm&&(this.hX=this.fm.getRange())};Zc.prototype.fRh=function(){var K=this.isRow?1:0;return(K=this.tf.zj.uG(this.tf.zj.Ea.Vg(this.grid.$.qa,zj.a.CM(this.tf.position.X+K-1,this.tf.position.Y-
K,this.tf.position.PaneType))))?K.eRh():null};Zc.prototype.x$e=function(){var K=this.fgj;Id.DOMElementExtensions.setVisible(K,!0);K.style.cursor=this.isRow?Tj.a.XNe:Tj.a.DMe;this.cyc()};Zc.prototype.Akh=function(K){var ea={};this.grid.$.Xd(this.isRow?745189930:-445963340,Ua.a.Ub,30,(ea.resizeRowColumnParameters=K,ea))};Zc.prototype.w$g=function(){var K=document.createElement("div");K.className=Tj.a.ksh;var ea=document.createElement("div");ea.className=Fa.a.rw;K.appendChild(ea);var Ta=document.createElement("img");
Ta.src=Oj.a.We(0);Ta.className=this.isRow?Fa.a.jrh:Fa.a.erh;ea.appendChild(Ta);this.tf.WA.domElement.parentNode.insertBefore(K,this.tf.WA.domElement);this.grid.iq?K.addEventListener(ag.a.pha,this.cMi):(ij.a.instance.pa(ag.a.pointerDown,K,this.RN),ng.a.instance.pa(ag.a.kk,K,this.tca));Id.DOMElementExtensions.setVisible(K,!1);this.rG=K};Zc.prototype.NHb=function(){this.C0c();this.rG&&(this.tf.WA.domElement.parentNode.removeChild(this.rG),this.rG=null)};Zc.prototype.ohf=function(K){return Id.DOMElementExtensions.Ff(this.rG,
K.target)};Zc.prototype.Kpb=function(){this.lY&&(this.fLe(),Id.DOMElementExtensions.JTa(this.fm.bK(),!this.isRow,this.xJb),this.NHb(),this.sWa=!1)};Zc.prototype.odf=function(){return hf.EwaSettings.ma(684)};Zc.prototype.d9e=function(K){(K=K.Ca.rawEvent)&&K.detail===Zc.Kkj&&(K.type===ag.a.lq?(this.lY=!1,this.QXc=!0):K.type===ag.a.lI&&(this.lY=!0,this.QXc=!1))};Zc.w6g=function(K,ea){return new Zc(K,ea)};Zc.lPd=function(K,ea,Ta){if(ea)for(K.ColumnWidth=-1,K.RowHeight=Ta,K=El(K.SheetMultiRange.Ranges),
ea=K.next();!ea.done;ea=K.next())ea=ea.value,ea.FirstColumn=0,ea.LastColumn=0;else for(K.RowHeight=-1,K.ColumnWidth=Ta,K=El(K.SheetMultiRange.Ranges),ea=K.next();!ea.done;ea=K.next())ea=ea.value,ea.FirstRow=0,ea.LastRow=0};Zc.mli=function(K,ea){if(!K||!K.bK())return Ed.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;var Ta=K.getRange();K=K.bK().style;if(!Ta||!K)return Ed.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;K=ea?K.height:K.width;return(ea?
Ta.top:Ta.left)===(ea?af.a.Hh:af.a.Qh)&&K===Zc.zgg};Zc.A6g=function(K,ea,Ta){if(!K)return Ed.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Lb=K.bK();if(!Lb||!Lb.style)return Ed.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;K=document.createElement("div");var xc=Lb.style;K.style.top=ea?xc.top:Zc.zgg;ea||(Ta?K.style.right=xc.right:K.style.left=xc.left);K.classList.add(ea?we.lrh:we.krh);K.classList.add(ea?Tj.a.Btb:Tj.a.Atb);Ta=document.createElement("div");
Ta.classList.add(ea?Tj.a.DQe:Tj.a.b$c);Lb=ea?Number.parseInvariant(Lb.innerText):hk.Range.c0a(Lb.innerText);Ta.innerText=ea?(Lb-1).toString():hk.Range.CU(Lb-1);K.appendChild(Ta);return K};Ek.Object.defineProperties(Zc.prototype,{Y6a:{configurable:!0,enumerable:!0,get:function(){return this.lY}},Rff:{configurable:!0,enumerable:!0,get:function(){var K=(new mk.a(this.grid.$.xa)).me(this.isRow?16:8),ea=this.grid.$.zb.Kz,Ta=this.grid.Mi,Lb=Vh.a(this.grid.$).Mq();return K&&!ea&&!Ta&&!Lb}},fgj:{configurable:!0,
enumerable:!0,get:function(){this.ilh();return Zc.Rbb}}});Zc.Vzi=0;Zc.Qyi=5;Zc.Zcc=1;Zc.j7e=1;Zc.tEh=3;Zc.egj=.1;Zc.NSf="ewa-rszrbg";Zc.zgg="0px";Zc.Kkj=2;Zc.Rbb=null;Object(ve.a)(Zc,"HeaderResizeBehavior",jj.a,[761]);var Lk=na.a;Am(Ud,Lk);Ud.prototype.create=function(){this.Eb(Zc.w6g)};Ud.ka=function(K){K.da.Ga(136,new Ud)};Object(ve.a)(Ud,"HeaderResizeBehaviorFactory",na.a,[]);var ik=b(444),Uj=b(562),Mk=b(70);Object(ve.a)(hd,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[445]);Object(ve.a)(pc,
"MacroRecorderSheetRowsColumnsResizedPayload",null,[445]);var cl=Qh.a;Am(Vb,cl);Vb.prototype.GV=function(K,ea){var Ta={};return Ta[Vb.d5]=this.Cc,Ta[Vb.yli]=this.isRow,Ta[Vb.W9h]=K,Ta[Vb.V9h]=ea,Ta[Vb.zii]=this.kAb,Ta[Vb.bfd]=this.Gvb,Ta};Vb.prototype.gTg=function(){var K=this.BHh();try{return this.aMh(K)}finally{K&&K.dispose()}};Vb.prototype.d4g=function(K){var ea={};ea.SheetMultiRange=sd.r(this.gridView.ha.sa.selectedRanges,this.$);Vb.lPd(ea,this.isRow,K);K={};this.$.Xd(this.isRow?745189930:-445963340,
Ua.a.Ub,8,(K.resizeRowColumnParameters=ea,K))};Vb.prototype.s3e=function(K,ea){return bh.a.u5(K)?ea?this.P2g(K):this.R2g(K):Vb.rba};Vb.prototype.R2g=function(K){return Math.floor(parseFloat(K))};Vb.prototype.P2g=function(K){K=parseFloat(K);return 0>K?Vb.rba:K?this.isRow?Hh.HelperMethods.bYi(K):this.Utc.JZg(K):0};Vb.prototype.S2g=function(K){return K===Vb.rba?"":this.isRow?this.Utc.WBe(K).toString():this.Utc.NBe(K).toFixed(2)};Vb.prototype.Q2g=function(K){return K===Vb.rba?"":K.toString()};Vb.prototype.aMh=
function(K){if(!K||!K.$$mn()||!K.to)return Vb.rba;var ea=Object(T.a)(473,K.to);if(!ea)return Vb.rba;for(ea=this.isRow?ea.cyb:ea.Lld;K.$$mn();){var Ta=Object(T.a)(473,K.to);if(Ta&&(this.isRow?Ta.cyb:Ta.Lld)!==ea)return Vb.rba}return ea};Vb.prototype.BHh=function(){for(var K=[],ea=El(this.gridView.ha.sa.selectedRanges),Ta=ea.next();!Ta.done;Ta=ea.next()){Ta=Ta.value.clone();var Lb=this.gridView.Tf(this.gridView.rb.sj(Ta));Lb=Ta.Me(Lb.Gh);if(!Lb)return null;this.isRow?Ta.right=Ta.left=Lb.left:Ta.top=
Ta.bottom=Lb.top;K.push(Ta)}return K.length?this.gridView.Q$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",K):null};Vb.prototype.cfd=function(K){if(!bh.a.u5(K))return 1;K=this.s3e(K,this.kAb);return!K&&this.kli()?3:this.aoi(K)?0:2};Vb.prototype.kli=function(){var K=this.gridView.ha.sa.selectedRanges;return this.isRow&&sd.P(K)||!this.isRow&&sd.O(K)};Vb.prototype.tcd=function(K){var ea="";switch(K){case 0:ea="";break;case 1:ea=Kc.a.instance.fa(767);break;case 2:K=this.kAb;ea=String.format(Kc.a.instance.Ab(99),
0,this.Jbc(K));break;case 3:ea=Kc.a.instance.fa(768)}return ea};Vb.prototype.aoi=function(K){return 0<=K&&K<=this.Jbc(!1)};Vb.prototype.Jbc=function(K){return this.Utc.Jbc(K,this.isRow)};Vb.lPd=function(K,ea,Ta){if(ea)for(K.ColumnWidth=Vb.rba,K.RowHeight=Ta,K=El(K.SheetMultiRange.Ranges),ea=K.next();!ea.done;ea=K.next())ea=ea.value,ea.FirstColumn=0,ea.LastColumn=0;else for(K.RowHeight=Vb.rba,K.ColumnWidth=Ta,K=El(K.SheetMultiRange.Ranges),ea=K.next();!ea.done;ea=K.next())ea=ea.value,ea.FirstRow=0,
ea.LastRow=0};Ek.Object.defineProperties(Vb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},kAb:{configurable:!0,enumerable:!0,get:function(){return Vb.X9d},set:function(K){Vb.X9d=K}}});Vb.d5="id";Vb.yli="isRow";Vb.W9h="initialSizeInPx";Vb.V9h="initialSizeInDefaultUnits";Vb.zii="isInitialUnitsDefaultUnits";Vb.bfd="getInputErrorIfInvalid";Vb.pBj="size";Vb.kgi="isDefaultUnits";Vb.rba=-1;Vb.X9d=!0;Object(ve.a)(Vb,"ResizeHeadersDialog",Qh.a,[]);var Nk=b(354),
jk=b(567),sk=b(63);Na.prototype.Zc=function(K,ea){K=!0;switch(ea){case -445963340:case 1391094586:K=this.me(8);break;case 745189930:case 146338636:K=this.me(16)}return!K};Na.prototype.executeCommand=function(K,ea,Ta){var Lb=ye.TaskExtensions.hl();var xc=Tg.g(this.$);K=Eg.a.create().toString();var qd=ea.command;switch(qd){case 1391094586:case 146338636:var Jd=1391094586===qd;(K=Ta.autoFitRanges)&&K.Ranges&&K.Ranges.length||(K=sd.r(xc.ha.sa.selectedRanges,this.$));Lb=this.sgh(Jd?1:0,K,ea);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Jd=
-445963340===qd||-706918724===qd||369708605===qd;if(-445963340===qd||745189930===qd)Jd=ik.a(ea.command),xc.Ji.K7(16,K,Jd),Ta=Ta.resizeRowColumnParameters;else{var De=xc.ha.sa.selectedRanges;if(-706918724===qd&&6===ea.Ye&&sd.O(De)){Ed.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===qd&&6===ea.Ye&&sd.P(De)){Ed.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");
break}xc=369708605===qd||1542466017===qd?-2:0;Ta={};Ta.SheetMultiRange=sd.r(De,this.$);if(Jd)for(Lb=El(Ta.SheetMultiRange.Ranges),qd=Lb.next();!qd.done;qd=Lb.next())qd=qd.value,qd.FirstRow=0,qd.LastRow=0;else for(Lb=El(Ta.SheetMultiRange.Ranges),qd=Lb.next();!qd.done;qd=Lb.next())qd=qd.value,qd.FirstColumn=0,qd.LastColumn=0;Ta.RowHeight=Jd?-1:xc;Ta.ColumnWidth=Jd?xc:-1}Lb=this.Mgh(Ta,ea,K);break;case 957527587:case 2040891415:new Vb(this.$,ea)}return Lb};Na.prototype.IZg=function(K){hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",
!1)&&ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.Va(this.$.da,426,427,1),function(ea){ea.result.m$f(K)},this.$.la,3)};Na.prototype.Lc=function(K,ea,Ta,Lb){if(K=!!Ta&&!!Lb&&1===Lb.Nx)switch(ea.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:K=!1}return K};Na.prototype.jd=function(){return!1};Na.prototype.tui=function(K){Ed.ULS.sendTraceTag(537154004,0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",
K.success,Object(jk.c)(K)?void 0:K.reason)};Na.prototype.me=function(K){return(new mk.a(this.$.xa)).me(K)};Na.prototype.sgh=function(K,ea,Ta){function Lb(){return new hd(Jd,ea)}var xc=this,qd=this.$.na.ua.hc(),Jd=0===K;return tb.a(this.$.userOperationManager,function(De,Ve,sg){var mh=xc.$.na.ua;De=Lg.b(De,xc.sHi);var Zh={yfi:!Jd,x0b:ea},Ci=mh.Na(41,qd);Ci.isRow=Jd;Ci.autoFitRanges=ea;return qe.i(mh,"AutoFit",Ci,De,Ve,sg,Zh,0)},function(De){return new $c.a(135,0,De,void 0,Lb)},Ta)};Na.prototype.Mgh=
function(K,ea,Ta){function Lb(){return new pc(K)}function xc(mh,Zh,Ci){qd.$.Ky();sd.i(Jd,",",qd.$,!1);if(hf.EwaSettings.isChangeGateEnabled("OfficeVSO:6347490_ResizeImportByGend")){var Bj=qd.$.na.ua;mh=Lg.b(mh,qd.fBf);var Kj=Bj.Na(41,void 0===sg?null:sg);Kj.resizeRowColumnParameters=K;Zh=qe.i(Bj,"ResizeRowsColumns",Kj,mh,Zh,Ci,Ta,0)}else Bj=qd.$.na.ua,mh=Lg.b(mh,qd.fBf),Kj=Bj.Na(41,void 0===sg?null:sg),Kj.resizeRowColumnParameters=K,Zh=qe.i(Bj,"ResizeRowsColumns",Kj,mh,Zh,Ci,Ta,0);return Zh}var qd=
this,Jd=sd.g(K.SheetMultiRange.Ranges),De=ea.command;if(745189930===De||-445963340===De){Ed.ULS.shipAssertTag(537154002,0,this.$.activeItemName===K.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");var Ve=Tg.g(this.$);De=745189930===De;Ve=this.Ug.Bzj(Ve,Jd,De?K.RowHeight:K.ColumnWidth,De);this.tui(Ve);Object(jk.c)(Ve)&&Tg.g(this.$).Ji.U0(Ta,Mk.BasicTelemetryCalculator.iR)}var sg=this.$.na.ua.hc({lla:!0,kka:3});return Ve&&Object(jk.c)(Ve)?hf.EwaSettings.qc()?
tb.a(this.$.userOperationManager,xc,function(mh){return new $c.a(136,0,mh,64,Lb)},ea):tb.a(this.$.userOperationManager,xc,function(mh){return new Uj.a(136,0,mh,void 0,Lb)},ea):tb.a(this.$.userOperationManager,xc,function(mh){return new $c.a(136,0,mh,void 0,Lb)},ea)};Object(ve.a)(Na,"ResizeCommandHandler",null,[429]);var Ij=Yc.a;Am(wa,Ij);wa.prototype.Nd=function(){var K=this,ea=ee.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub);ye.TaskExtensions.Ba(ea,function(){K.Cd([new Na(K.$,ea.result)])},
this.la,3)};wa.ka=function(K){Yc.a.fe(113,new wa(K))};Object(ve.a)(wa,"ResizeCommandHandlerFactory",Yc.a,[]);kd.prototype.Zc=function(){return!1};kd.prototype.executeCommand=function(K,ea,Ta){K=2;switch(ea.command){case -309686558:K=this.Di.ve(Sf.a.saveACopy,2,Ta);break;case 617689800:K=this.Di.ve(Sf.a.saveToCloudStorage,2,Ta);break;case -1244760097:K=this.Di.ve(Sf.a.saveToSharePoint,2,Ta)}return 2===K&&ea?lf.a(ea.command):Ch.Task.Sa(!0)};kd.prototype.Lc=function(K,ea){K=!1;switch(ea.command){case -1244760097:case -309686558:case 617689800:K=
!0,Ed.ULS.shipAssertTag(537153984,0,this.$.uka,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return K};kd.prototype.jd=function(){return!1};Object(ve.a)(kd,"SaveToHostCommandHandler",null,[429]);var il=Yc.a;Am(zc,il);zc.prototype.Nd=function(){var K=this;ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){K.Cd([new kd(K.$,he.AFrameworkApplication.Ib)])},this.la,3);he.AFrameworkApplication.Ib.fc(Sf.a.ZQa,uh.a.frame,
this.mDh)};zc.ka=function(K){Yc.a.fe(267,new zc(K))};Object(ve.a)(zc,"SaveToHostCommandHandlerFactory",Yc.a,[]);vc.prototype.Zc=function(K){switch(K){case -309686558:return 8===this.Di.processAction(Sf.a.saveACopy,1,null);case 617689800:return 8===this.Di.ve(Sf.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.Di.ve(Sf.a.saveToSharePoint,1,null)}return!1};vc.prototype.dispose=function(){this.$=null};Object(ve.a)(vc,"SaveToHostManager",null,[712,3]);var Rk=na.a;Am(Za,Rk);Za.prototype.create=
function(){this.Eb(this.$.da.Aa(393)||new vc(this.$,he.AFrameworkApplication.Ib))};Za.ka=function(K){K.da.Ga(394,new Za(K))};Object(ve.a)(Za,"SaveToHostManagerFactory",na.a,[]);var pl=vj.a;Am(ub,pl);ub.prototype.execute=function(K){var ea=Object(T.a)(6,K.Ke);Ed.ULS.shipAssertTag(537153921,0,$g.a.gob(K.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");ea.sI(!0,!0);K.activityState[ki.a.FYb]=ea.ea.sessionId;K.activityState[ki.a.Smb]=!0;K.activityState[ki.a.LYb]=
!0;Ed.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(ve.a)(ub,"SessionReloadActivity",vj.a,[]);var jl=na.a;Am(Zb,jl);Zb.prototype.create=function(){this.Eb(new ub(oh.a.xcb,oh.a.Kk))};Zb.ka=function(K){K.da.Ga(142,new Zb)};Object(ve.a)(Zb,"SessionReloadActivityFactory",na.a,[]);var Zk=b(56),Hg=b(277),wj=b(110),ql=b(45),Ji=b(253),Wk=b(114),Ok=vj.a;Am(Jb,Ok);Jb.prototype.execute=function(K){var ea=Object(T.a)(6,K.Ke);K.activityState[ki.a.Gra]=
!0;var Ta=Jb.FXh(K);if(Jb.mvj(K,Ta))return Jb.dyi(K),Ta=50,0<K.errors.length&&(Ta=15),Ed.ULS.sendTraceTag(537153891,0,Ta,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",$g.a.Wc(K.errors)),K.activityState[ki.a.Gra]=!1,this.zh(oh.a.idle),3;switch(Ta){case 1:case 3:this.hbi(K,Ta);break;case 2:this.gbi(K);break;case 0:K.activityState[ki.a.tYa]=null}Ed.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",
Ta,this.activityName,this.U_,ea.ea.W7);var Lb=Yj.a.zg(K.activityState,Wk.a.Heb);Ed.ULS.shipAssertTag(40502925,0,!Lb||Lb&&(1===Ta||3===Ta),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",Lb,Ta);ea=ea.Uk.reloadCount;return 0!==Ta&&0<ea?(Lb=Hg.a.wva(ea,200),Ed.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",Ta,ea,Lb,this.activityName),vk.a.instance.create(function(){Jb.IJ(K)},Lb,Hj.a.wnj),
1):3};Jb.prototype.hbi=function(K,ea){Ed.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var Ta=Object(T.a)(6,K.Ke);K.activityState[ki.a.Smb]=!0;Ta.Efc||ql.PageLoadTrackingInfo.instance.Lj("ReopenOnLoad");!Jb.isEditMode(K)&&$g.a.gob(K.errors)&&(Ed.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),K.activityState[ki.a.FYb]=Ta.ea.sessionId,K.activityState[ki.a.LYb]=
!0);K.Rvd();3===ea?(Ta.ea.Hg()||Ta.ea.GDi(),Ta.sI(!0,!0),this.zh(this.qKj),K.activityState[ki.a.Gke]=Ta.workbookContext.CalcMode):(hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===ea&&Ta.sI(!0,!0),K.activityState[ki.a.$Tc]=!1,this.zh(this.jyc))};Jb.prototype.gbi=function(K){Ed.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");K.activityState[ki.a.tYa]=null;K.Rvd();this.zh(this.hBj);K=Object(T.a)(6,
K.Ke);K.Efc||(ql.PageLoadTrackingInfo.instance.Lj("RefreshOnLoad"),K.AIb())};Jb.IJ=function(K){K.IJ()};Jb.FXh=function(K){var ea=Object(T.a)(6,K.Ke),Ta=ea.ea,Lb=Jb.isEditMode(K),xc=$g.a.nh(K.errors,Lb?Jb.Bvd:Jb.Cvd),qd=$g.a.nh(K.errors,Lb?Jb.dof:Jb.eof),Jd=ea.kR,De=ea.Uk.reloadCount,Ve=ea.ya.MaxConsecutiveSilentReloadAllowed,sg=ea.Uk.L6e(),mh=$g.a.Wc(K.errors),Zh=$g.a.Wc(K.qza),Ci=0<$g.a.LM(function(uk){return!uk.triggerSilentReopenOnly},K.errors).length,Bj=xc,Kj=Yj.a.zg(K.activityState,Wk.a.Heb);
Kj&&(Bj=!0);xc={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:Lb,isSilentReopenError:xc,isSilentRefreshError:qd};xc.reloadSequenceCount=ea.Uk.kQa;xc.reloadCount=De;xc.maxReloads=Ve;xc.stopSilentReloads=sg;xc.errorNames=mh;xc.processedErrorNames=Zh;xc.isClientDirty=Jd;xc.errorsForSilentReopenOnly=Ci;xc.triggerSilentReloadAfterTokenRefresh=Kj;xc.IsReopenDisabled=ea.MMa;Jd=Zk.a.Kc(xc);Ed.ULS.sendTraceTag(21837004,0,50,Jd);if(!sg){if(Bj&&(Lb?Jb.dvj(K):Jb.fvj(K)))return Ji.a.j1f(K,ea)?
3:ea.MMa?2:1;if(qd&&(Lb||!Ta.Lab))return 2}return 0};Jb.mvj=function(K,ea){for(var Ta=El(K.errors),Lb=Ta.next();!Lb.done;Lb=Ta.next())if(Lb=Lb.value,-1337545025===Lb.MessageId||-238814601===Lb.MessageId)return!1;return $g.a.LM(function(xc){return!xc.triggerSilentReopenOnly},K.errors).length?3!==ea:!1};Jb.dyi=function(K){var ea=$g.a.LM(function(Lb){return!Lb.triggerSilentReopenOnly},K.errors);ea=El(ea);for(var Ta=ea.next();!Ta.done;Ta=ea.next())K.nla(Ta.value)};Jb.isEditMode=function(K){var ea=Object(T.a)(6,
K.Ke);return ea.ea.sc?ea.tv&&!!(ea.Pd&64):Yj.a.zg(K.activityState,ki.a.Ss)};Jb.fvj=function(K){var ea=Object(T.a)(6,K.Ke),Ta=$g.a.raa(K.errors,Jb.Cvd);if(wj.b(Ta,function(Lb){return Lb.ForceVersionUpgrade}))return!1;K=$g.a.gob(K.errors);return!ea.ea.Lab||K?!0:!1};Jb.dvj=function(K){K=$g.a.raa(K.errors,Jb.Bvd);return!wj.b(K,function(ea){return ea.ForceVersionUpgrade})};Jb.Cvd=null;Jb.Bvd=null;Jb.eof=null;Jb.dof=null;Object(ve.a)(Jb,"SessionReloadSilentActivity",vj.a,[]);var dl=na.a;Am(Mb,dl);Mb.prototype.create=
function(){this.Eb(new Jb(this.activityName,this.EM,oh.a.Kk,oh.a.vj,oh.a.DNb))};Mb.ka=function(K){K.da.Ga(143,new Mb(oh.a.qna,oh.a.B0b));K.da.Ga(144,new Mb(oh.a.Nvc,oh.a.dPa));K.da.Ga(145,new Mb(oh.a.Ovc,oh.a.sCd));K.da.Ga(154,new Mb(oh.a.ycb,oh.a.dP))};Object(ve.a)(Mb,"SessionReloadSilentActivityFactory",na.a,[]);ib.prototype.getSheetName=function(){return this.sheetName};ib.prototype.getValue=function(){return this.value};Object(ve.a)(ib,"MacroRecorderSheetOptionToggledPayload",null,[445]);sa.prototype.Zc=
function(){return!1};sa.prototype.executeCommand=function(K,ea){function Ta(){return new ib(Lb.SheetName,sg)}var Lb={};this.$.Bj(Lb);K=ea.command;var xc=Object(T.a)(Xf.a,this.$.xa.getItemByName(Lb.SheetName));if(!xc)return lf.a(K);switch(K){case 705559150:case -1411193626:var qd=16;var Jd=!xc.hideGridLines;var De=Qa;var Ve=183;var sg=xc.hideGridLines;break;case -2052321504:case 515737500:qd=4;Jd=!xc.headersVisible;De=qb;Ve=184;sg=!xc.headersVisible;break;case -1478455630:qd=2;Jd=!xc.displayRtl;De=
Oa;Ve=185;sg=!xc.displayRtl;Tg.g(this.$).Ea.APj(Jd);break;default:return lf.a(K)}xc.Upb(qd,Jd);var mh=this.$.na.ua;return tb.a(this.$.userOperationManager,function(Zh,Ci,Bj){return De(mh,Lb.SheetName,sg,Lg.b(Zh,function(Kj){sa.dFb(Kj,xc,qd,Jd)}),Lg.a(Ci,function(){sa.mEb(xc,qd,Jd)}),Bj,null)},function(Zh){return new $c.a(Ve,0,Zh,void 0,Ta)},ea)};sa.prototype.Lc=function(K,ea){K=!1;switch(ea.command){case -1411193626:case 515737500:case -1478455630:K=!0;break;case 705559150:case -2052321504:K=Hk.a(this.$)}return K};
sa.prototype.jd=function(){return!1};sa.dFb=function(K,ea,Ta,Lb){$g.a.lr(K.Errors)&&ea.Upb(Ta,!Lb)};sa.mEb=function(K,ea,Ta){K.Upb(ea,!Ta)};Object(ve.a)(sa,"SheetOptionsToggleCommandHandler",null,[429]);var kl=Yc.a;Am(ba,kl);ba.prototype.Nd=function(){this.Cd([new sa(this.$)])};ba.ka=function(K){Yc.a.fe(100,new ba(K))};Object(ve.a)(ba,"SheetOptionsToggleCommandHandlerFactory",Yc.a,[]);var $k=b(214),aj=$k.a;Am(I,aj);I.prototype.initialize=function(){var K=this.$.Mb+"iframeDialog_frame",ea=this.$.Mb+
"iframeDialog";var Ta=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',K,this.mZe(ea));this.Qb.style.margin=Hh.HelperMethods.nc(0);this.Qb.style.marginBottom=Hh.HelperMethods.nc(-2);this.Qb.innerHTML=Ta;this.dKc=document.getElementById(K);this.domElement.id=ea;this.onResize(null,Sys.EventArgs.Empty);Af.a.Ugc&&vk.a.instance.create(this.Mkh,50,Hj.a.f7h,!0,!0);aj.prototype.initialize.call(this)};I.prototype.dispose=function(){this.$&&this.$.zD(this.onResize);
aj.prototype.dispose.call(this)};I.prototype.setFocus=function(){Id.DOMElementExtensions.setFocus(this.rLa)};I.prototype.onHide=function(){this.rLa.contentWindow.close();Id.DOMElementExtensions.Af(this.rLa);this.dKc=null;aj.prototype.onHide.call(this)};I.prototype.mQj=function(K){var ea=this.domElement.style;ea.width=Hh.HelperMethods.nc(K.x);ea.marginLeft=Hh.HelperMethods.nc(-K.x/2)};I.prototype.kQh=function(){var K=Id.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*
K.width),this.FGe.x),Math.min(Math.floor(.9*K.height),this.FGe.y))};Ek.Object.defineProperties(I.prototype,{rLa:{configurable:!0,enumerable:!0,get:function(){return this.dKc}}});Object(ve.a)(I,"IFrameDialog",$k.a,[]);Am($a,I);$a.prototype.mZe=function(K){var ea=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);Xh.a.eh(ea,A.a.Tmh,K);kc.a(this.$.ya,34)&&Xh.a.eh(ea,A.a.EMe,"1");kc.a(this.$.ya,35)&&Xh.a.eh(ea,A.a.FMe,"1");return ea.toString()};$a.prototype.onShow=function(){Ed.ULS.sendTraceTag(537151690,
0,50,"EmbeddingDialog.OnShow: the dialog is being shown");I.prototype.onShow.call(this)};Ek.Object.defineProperties($a.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(ve.a)($a,"EmbeddingDialog",I,[]);jb.B0f="FrameDialog_ShareFromEdit";jb.view="FrameDialog_View";jb.fze="FrameDialog_CloseAndRefresh";jb.kuj="FrameDialog_ShareFromView";jb.edit="FrameDialog_Edit";jb.F6i="FrameDialog_RefreshGrid";jb.bZg="FrameDialog_CloseMe";jb.pze="FrameDialog_CloseMeError";
jb.ready="FrameDialog_Ready";jb.aYi="FrameDialog_PleaseClose";jb.GH="GotoRange";Object(ve.a)(jb,"PostMessageConstants",null,[]);var Sk=b(105);Object(ve.a)(Uc,"SessionUpdateContext",null,[]);Am(hc,I);hc.prototype.jFg=function(K){this.addHandler(hc.ktd,K)};hc.prototype.dbj=function(K){this.removeHandler(hc.ktd,K)};hc.prototype.dispose=function(){Qi.a.Ha(this.M0a);this.M0a=null;I.prototype.dispose.call(this)};hc.prototype.initialize=function(){I.prototype.initialize.call(this);var K=Ng.a.Uaa(this.$.ya.FormLightBoxUrl),
ea=this.M0a=new O.a(this.rLa.contentWindow,K);ea.isEnabled()&&ea.zFa(K)&&(this.Jma(jb.B0f,this.Ooc),this.Jma(jb.view,this.Ooc),this.Jma(jb.fze,this.Ooc),this.Jma(jb.kuj,this.lRi),this.Jma(jb.edit,this.$Ii),this.Jma(jb.F6i,this.Ooc),this.Jma(jb.ready,this.GPi),this.Jma(jb.bZg,this.Ouf),this.Jma(jb.pze,this.Ouf))};hc.prototype.close=function(K){K===this.closeAction&&this.$df&&this.M0a.send(new Jj.a(jb.aYi))||I.prototype.close.call(this,K)};hc.prototype.mZe=function(){return this.yDe(this.Ihc)};hc.prototype.yDe=
function(K){var ea=this.$.ya,Ta=new Sys.StringBuilder(ea.FormLightBoxUrl);Xh.a.eh(Ta,A.a.JDh,this.$.ea.sessionId);Xh.a.eh(Ta,A.a.HDh,K?A.a.IDh:A.a.GDh);Dj.a.hZa(Ta,ea);return Ta.toString()};hc.prototype.zdg=function(K){this.rLc=!1;this.rLa.src=this.yDe(K);this.L9d=K};hc.prototype.Jma=function(K,ea){this.M0a.io(K);this.M0a.Rl(K,ea)};hc.prototype.Bnc=function(K){var ea=this.$.ea.xa.getItemByName(K.GH.SheetName);ea&&0===ea.Py&&Tg.g(this.$).Gg(K.GH,null,null,null,20,Sk.a.rDh)};Ek.Object.defineProperties(hc.prototype,
{Cc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},$df:{configurable:!0,enumerable:!0,get:function(){return this.rLc}},Ihc:{configurable:!0,enumerable:!0,get:function(){return this.L9d}}});hc.tch=900;hc.Wbh=1200;hc.ktd="lightBoxReady";Object(ve.a)(hc,"FormDialog",I,[491]);var Ak;(function(K){K[K.comment=10]="comment";K[K.range=12]="range";K[K.table=13]="table";K[K.chart=14]="chart"})(Ak||(Ak={}));Object(ve.b)("NavigationType",Ak);var tk=b(1079),kj=b(116),Xk=b(622),el=b(1148),Bk=
b(294),al=b(936),Ck=al.a;Am(zb,Ck);zb.prototype.initialize=function(){var K="<div class='"+kj.a.vo+"'>\r\n\t<div class='"+kj.a.UMe+"'>\r\n\t\t<div class='"+Fa.a.Yye+"'>\r\n\t\t\t<img src='{0}' class='"+Fa.a.XPe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+kj.a.YMe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";K=String.format(K,Oj.a.We(13),Kc.a.instance.fa(25),Kc.a.instance.fa(this.message));this.Qb.innerHTML=K;this.addButton(0,this.ZEi);this.addButton(1);Ck.prototype.initialize.call(this)};
zb.prototype.Kx=function(){return this.t_d};Ek.Object.defineProperties(zb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"WebMethodConfirmationDialog"}},Gu:{configurable:!0,enumerable:!0,get:function(){return 1005}},Usa:{configurable:!0,enumerable:!0,get:function(){return this.operationFlags}}});Object(ve.a)(zb,"WebMethodConfirmationDialog",al.a,[]);var Pk=tk.a;Am(Gc,Pk);Gc.prototype.dispose=function(){this.CTa&&this.CTa.mda(this.CDf);Qi.a.zc([this.textBox,this.fRa,this.CTa]);this.CTa=
this.fRa=this.textBox=null;Pk.prototype.dispose.call(this)};Gc.prototype.initialize=function(){var K="<div class='"+kj.a.vo+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+kj.a.qtb+"'>\r\n\t<input type='text' id='{1}' class='"+kj.a.MC+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";K=String.format(K,Kc.a.instance.fa(1242),"sfd_input","sfd_unshare",Fa.a.fq,Kc.a.instance.fa(1243));this.Qb.innerHTML=K;this.textBox=new Bk.a(this.getElementById("sfd_input"));
this.fRa=new el.a(this.textBox.domElement);this.CTa=Xk.a.create(this.getElementById("sfd_unshare"));this.CTa.O2(this.CDf);this.textBox.text=Kc.a.instance.fa(736);this.textBox.enabled=!1;this.textBox.readOnly=!Af.a.Eh;this.addButton(1,10);Pk.prototype.initialize.call(this)};Gc.prototype.rha=function(){var K=this;return function(ea,Ta,Lb){var xc=K.$.na.ua.hc(),qd=K.$.na.ua;ea=K.ija(ea);Ta=K.Jaa(Ta);xc=qd.Na(1,xc);return qe.i(qd,"ShareForm",xc,ea,Ta,Lb,null,0)}};Gc.prototype.Ay=function(K,ea,Ta){this.textBox.text=
K.Result;this.textBox.enabled=!0;Id.DOMElementExtensions.setVisible(this.CTa.domElement,!0);Pk.prototype.Ay.call(this,K,ea,Ta)};Gc.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(K){}Pk.prototype.setFocus.call(this)};Ek.Object.defineProperties(Gc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(ve.a)(Gc,"ShareFormDialog",tk.a,[]);var bl=b(720),Tk=b(142),ll=b(265),Ik=b(16),wk=rb.a;Am(Xb,wk);Xb.prototype.Zc=
function(K,ea){K=this.$.workbookContext.FullDocumentInfo;switch(ea){case 353606613:case -1099009678:case 192430811:return!hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 869186573:return ea=ll.a()&&this.$.ea.Zg.get(5),!K.FileSharingUrl&&!ea;case -1570751769:case 1986648902:return 131072!==(this.$.NQ&131072);case 330035228:return!(this.$2a(!0)&&this.sDc);case -509039657:return!(this.$2a()&&this.sDc);case 1334518759:return!(this.$2a()&&
this.sDc&&this.Yve())}return!1};Xb.prototype.executeCommand=function(K,ea,Ta){K=this.$.workbookContext.FullDocumentInfo;var Lb=Sf.a.workflow,xc=ye.TaskExtensions.hl(),qd=ea.command;if(qd===Lb||-266099===qd)return this.o4h(ea,Lb,K);switch(qd){case 1986648902:this.P_f();break;case -1570751769:this.a2h(ea);break;case 869186573:ea=Sf.a.juj;xc=he.AFrameworkApplication.ga.ra("ShareMenuIsEnabled");Lb=null;(hf.EwaSettings.ma(563)||xc)&&Ta&&"CopyLink"===Ta.SourceControlId?(Lb={},Lb[Df.a.XKb]="copy",ea=Sf.a.A0f):
xc&&Ta&&"ManageAccess"===Ta.SourceControlId?(Lb={},Lb[Df.a.XKb]="manageAccess",ea=Sf.a.luj):Ta&&"LinkToComment"===Ta.SourceControlId&&(Lb={},Lb[Df.a.XKb]="copy",Lb[Df.a.C0f]=Ta.navId,ea=Sf.a.A0f);xc=this.Q3f(K,Lb);qj.c(ea);break;case -1099009678:xc=this.XPd(12,K);break;case 192430811:xc=this.XPd(13,K);break;case 353606613:xc=this.XPd(14,K);break;case -59906385:case 1197060601:this.D3h(ea,K);break;case 1305810481:this.l5e(!1,ea);break;case 330035228:this.l5e(!0,ea);break;case -509039657:this.deleteForm();
break;case 1334518759:ea.Vyb=!0;this.shareForm();break;case 710925581:zd.a.Fg.cxc("710925581")&&(xc=ye.TaskExtensions.Ba(this.cK.value,function(Jd){Jd.result.Hj(Zg.a.conversation,{})},this.la,3));break;case 327119921:this.R1h();break;default:xc=lf.a(qd)}return xc};Xb.prototype.Lc=function(K,ea){K=!1;ea=ea.command;if(ea===Sf.a.workflow)return!0;switch(ea){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:K=
!0;break;case 353606613:case -1099009678:case 192430811:K=hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode}return K};Xb.prototype.jd=function(K,ea,Ta){if("PopulateFormMenu"===ea){ea=this.sDc?this.Yve()?Xb.wxh:Xb.xxh:Xb.uCi;K=this.Ra.Pc();for(var Lb=0;Lb<ea.length;Lb++)K.buttons.push(this.Ra.Bb(ea[Lb]));ea=this.Ra.Yp("Forms.Flyout");ea.Ec.push(K);Ta.MenuItems=ea.oC();return!0}return!1};Xb.prototype.o4h=function(K,ea,Ta){return this.xMd&&
K.command===ea?(this.vMd(K,-266099),ye.TaskExtensions.L4()):ye.TaskExtensions.Ba(this.cK.value,function(Lb){qf.a(Lb.result,Zg.a.workflow,null,Ta.WorkflowPostMessage)||Hh.HelperMethods.jf(Ta.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)};Xb.prototype.Yve=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Zg.get(26)};Xb.prototype.R1h=function(){var K=Eg.a.create().toString();Ed.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+
K);var ea=this.$.frame,Ta=ea.Z8a,Lb=this.$,xc=new vh.QueryStringBuilder(he.AFrameworkApplication.ga.Ua("TeamsMeetingShareEndpoint"));xc.Xi("deeplinkId",K);xc.Xi("lm","deeplink");K=xc.Xi;var qd={};var Jd=new vh.QueryStringBuilder(he.AFrameworkApplication.ga.Ua("TeamsAppSharingUrl"));Jd.Xi("auth","2");Jd.Xi("flight","officeunihost");Jd.Xi("source","TEAMS-ELECTRON.meetingStage.deeplink");var De={};De.fileType=lg.a.C4(Lb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);De.objectUrl=Lb.workbookContext.FullDocumentInfo.WorkbookPath;
De.baseUrl=Lb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;Lb=Lb.workbookContext.WorkbookFileVersionId;for(var Ve=decodeURIComponent(Lb);Lb!=Ve;)Lb=Ve,Ve=decodeURIComponent(Lb);0>Lb.indexOf("{")||0>Lb.indexOf("}")?(Ed.ULS.sendTraceTag(528250338,306,15,"Decoded fileId does not match expected format. Decoded id: "+Lb),Lb=""):Lb=Lb.substring(Lb.indexOf("{")+1,Lb.indexOf("}")).toLowerCase();De.fileId=Lb;De=Jh.c(Jh.c(De));Jd.Xi("subEntityId",De.substring(1,De.length-1));qd.appSharingUrl=Jd.toString();
qd.appId=he.AFrameworkApplication.ga.Ua("TeamsAppId");qd=JSON.stringify(qd);K.call(xc,"appContext",qd);Ta.call(ea,xc.toString(),!0)};Xb.prototype.a2h=function(K){this.xMd?this.vMd(K,1986648902):this.P_f()};Xb.prototype.l5e=function(K,ea){!K&&this.$.ya.SurveyRedirectUrl?this.o1i():(K=new hc(this.$,K,ea),K.initialize(),K.kf())};Xb.prototype.D3h=function(K,ea){var Ta=this;this.xMd&&1197060601===K.command?this.vMd(K,-59906385):ye.TaskExtensions.Ba(this.cK.value,function(Lb){Lb=Lb.result;Lb&&qf.a(Lb,Zg.a.replyWithChanges,
null,Ta.$.ea.Zg.get(8))||(Lb=new Sys.StringBuilder(ea.ReplyWithChangesUrl),Xh.a.eh(Lb,di.e,di.d),S.a.ntw(Lb.toString(),Ta.$))},this.la,3)};Xb.prototype.vMd=function(K,ea){var Ta=this,Lb=Ga.a(this.$).ud.activityState,xc=new Xj.a(ea,K.method,K.mode,K.Ye,K.tabName);Vh.a(this.$).wt(new fi.a(oh.a.wz,5,function(){Lb[Ni.a.hr]=oh.a.JUf;Lb[bl.a.WTc]=xc;Ta.$.Uk.cz("SocialSharingSaveBeforeCommand");Ta.$.Uk.Zle(xc.command)}))};Xb.prototype.P_f=function(){var K=this,ea=this.$.ya.DocumentHostInfo;ea.HostEmbeddedViewUrl||
this.Ove?this.I2f():this.$.Yf.get(53)&&ye.TaskExtensions.Ba(this.cK.value,function(Ta){K.fNj(Ta.result)||S.a.ntw(ea.FileEmbedCommandUrl,K.$)},this.la,3)};Xb.prototype.fNj=function(K){return K.isEnabled()&&(this.Nve||(this.Nve=K.Rl(Zg.a.Mve,this.rGi)))?K.Hj(Zg.a.mzh,null):!1};Xb.prototype.I2f=function(){if(Af.a.rp)S.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var K=new $a(this.$);K.initialize();K.kf()}};Xb.prototype.deleteForm=function(){var K=this.$,ea=new zb(K,1247,1248,1240,function(Ta,Lb,
xc){var qd=K.na.ua.hc(),Jd=K.na.ua;qd=Jd.Na(9,qd);qd.surveyId=null;return qe.i(Jd,"DeleteSurvey",qd,Ta,Lb,xc,null,0)});ea.initialize();ea.kf()};Xb.prototype.shareForm=function(){var K=this,ea=this.$.workbookContext.FullDocumentInfo;if(this.$.ea.Zg.get(26)){var Ta=new Gc(this.$);Ta.initialize();Ta.kf()}else ye.TaskExtensions.Ba(this.cK.value,function(Lb){var xc={};qf.a(Lb.result,Zg.a.shareForm,(xc[Df.a.nGj]=K.$.workbookContext.SurveyTitle,xc),K.$.ea.Zg.get(10))||S.a.ntw(ea.ShareFormCommandUrl,K.$)},
this.la,3)};Xb.prototype.o1i=function(){var K=this.$;K.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var ea=new Sys.StringBuilder(K.ya.SurveyRedirectUrl);Xh.a.eh(ea,"startupDialog","FormEdit");var Ta=Ga.a(this.$),Lb=Ta.ud.activityState;Lb[Ri.a.z2]=ea.toString();Lb[Ri.a.iM]=Ri.a.wxd;this.$.Uk.cz("SocialSharingEnvironmentChange");Vh.a(K).wt(new fi.a(oh.a.wz,5,function(){var xc=$g.a.gd(3,2,1292,1293,1294,554412057,"FossEnvironmentUnsupported");Ta.ud.Lt([xc]);Lb[Ni.a.hr]=
oh.a.Dbg}))};Xb.prototype.$2a=function(K){return(this.$.ea.isEditMode||(void 0===K?!1:K))&&this.$.ea.Zg.get(25)&&ll.a()};Xb.prototype.pXh=function(K){var ea=void 0===ea?null:ea;var Ta=Tg.g(this.$).ha;var Lb=this.$.xa.qa?sk.d(this.$.xa.qa):null;if(!Lb)return Ed.ULS.sendTraceTag(537151649,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",Ak[K]),null;14===K?ea=this.OWh(Ta):12===K?(ea=Ta.hia,ea=bh.a.contains(ea,"!",!0)?ea.split("!")[1]:ea):13===K&&
(Ta=Ta.sa.selectedRanges,Ta[0]&&(Ta=Tg.g(this.$).Rb.Qj(Ta[0])))&&(ea=Ta.jj);if(!ea)return Ed.ULS.sendTraceTag(537151648,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",Ak[K]),null;Ta={};Ta[Df.a.XKb]="copy";Ta[Df.a.C0f]=this.LNh(K,ea,Lb);Ed.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",Ak[K],ea,
Lb);return Ta};Xb.prototype.OWh=function(K){if(K.Oa.m5&&(K=K.Oa.oc.floatingObject)&&0===K.type){var ea=K.id.split(".");if(1<ea.length)return ea[1];Ed.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",K.id)}return null};Xb.prototype.LNh=function(K,ea,Ta){K=btoa(K+"_"+ea+"_"+Ta);K=K.replace(RegExp("\\+","g"),"-");K=K.replace(RegExp("\\/","g"),"_");return K=K.replace(RegExp("\\=+$","g"),"")};Xb.prototype.Q3f=function(K,ea){var Ta=
this;return ye.TaskExtensions.Ba(this.cK.value,function(Lb){qf.a(Lb.result,Zg.a.sharing,ea,Ta.$.ea.Zg.get(5))?Ed.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",ea?ea[Df.a.XKb]:""):Hh.HelperMethods.jf(K.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)};Xb.prototype.XPd=function(K,ea){if(!hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;
var Ta=this.pXh(K);if(Ta)return this.Q3f(ea,Ta);Ed.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",Ak[K]);return null};Ek.Object.defineProperties(Xb.prototype,{sDc:{configurable:!0,enumerable:!0,get:function(){return ja.b(this.$.kg)}},xMd:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.ea.sih||this.$.kR)}}});Xb.uCi=[103];Xb.wxh=[107,104,105,106];Xb.xxh=[104,105];Xb.EVg=[new Ik.a(oh.a.nze,
554412057,0,0,1295),new Ik.a(oh.a.idle,554412057,0,1)];Object(ve.a)(Xb,"SocialSharingCommandHandler",rb.a,[429]);var fl=Yc.a;Am(Wa,fl);Wa.prototype.Nd=function(){var K=this,ea=new zg.a(function(){return ee.GetServiceTaskFactory.create(K.$.da,137,K.la,K.ub)});ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub),function(Ta){K.Cd([new Xb(K.$,Ta.result,ea)])},this.la,3)};Wa.ka=function(K){Yc.a.fe(114,new Wa(K))};Object(ve.a)(Wa,"SocialSharingCommandHandlerFactory",Yc.a,
[]);Object(ve.a)(wb,"MacroRecorderRangeCustomSortedPayload",null,[445]);var rl=b(1162),sl=b(1163),ml=b(1008),tl=b(960),gl=b(213);Kb.prototype.show=function(){var K=new Gh.StandardDialog;K.jc=11;K.Dc(1,Kc.a.instance.fa(2079));K.Dc(2,Kc.a.instance.fa(2080));K.G3f(Kc.a.instance.fa(2078),Kc.a.instance.Wa(647),this.Aw)};Kb.prototype.RNa=function(K){Ed.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",K)};Object(ve.a)(Kb,"ExpandSortSelectionDialog",null,[]);yc.isValid=function(K){return Array.contains(yc.Hxh,
K.Position)?!0:(Ed.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",K.Position),!1)};yc.Hxh=[0,.5,1];Object(ve.a)(yc,"FillGradientStopExtension",null,[]);Object(ve.a)(Qb,"GradientLine",null,[]);Ja.isValid=function(K){if(!(K.Degree.toString()in Ja.Fxh))return Ed.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",K.Degree),!1;if(!K.GradientStops)return Ed.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),
!1;if(K.GradientStops.length<Ja.Qzi||K.GradientStops.length>Ja.yyi)return Ed.ULS.shipAssertTag(537159827,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",K.GradientStops.length),!1;K=El(K.GradientStops);for(var ea=K.next();!ea.done;ea=K.next())if(!yc.isValid(ea.value))return!1;return!0};Ja.Qzi=2;Ja.yyi=3;var ok={};Ja.Fxh=(ok["0"]=new Qb(0,0,1,0),ok["180"]=new Qb(1,0,0,0),ok["90"]=new Qb(0,0,0,1),ok["270"]=new Qb(0,1,0,0),ok["45"]=new Qb(0,0,1,1),ok["225"]=new Qb(1,1,
0,0),ok["135"]=new Qb(1,0,0,1),ok["315"]=new Qb(0,1,1,0),ok);Object(ve.a)(Ja,"FillGradientExtension",null,[]);var X=Mj.a;Am(pb,X);pb.prototype.LO=function(K,ea){if(1===K){var Ta=sd.v(this.HCb,this.$);Tg.g(this.$).Gg(Ta,null,null,null,0,Sk.a.BCj)}Ta={};Ta=(Ta.DialogButton=K,Ta.Location="dialog",Ta);gh.b(this.$).Vd(cd.a.DCj,Ta,null,!0);X.prototype.LO.call(this,K,ea)};pb.prototype.Gr=function(){X.prototype.Gr.call(this);var K=this.ACj();this.jc=1;this.Dc(1,Kc.a.instance.fa(2190));this.yk(Kc.a.instance.fa(2191),
fg.a.fg(K),1,this.MO)};pb.prototype.ACj=function(){return String.format(Kc.a.instance.Ab(166),this.HCb.toString())};pb.prototype.zcd=function(){var K=this.error.Description.split("_");return new hk.Range(Number.parseInvariant(K[1])+1,Number.parseInvariant(K[2])+1,Number.parseInvariant(K[3])+1,Number.parseInvariant(K[4])+1,!0,!1)};Ek.Object.defineProperties(pb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(ve.a)(pb,"SortMergedCellsErrorDialog",
Mj.a,[]);var Ba=b(639),db=b(707),$b=ml.a;Am(Tb,$b);Tb.prototype.dispose=function(){this.jgc||(this.jgc=!0,this.N1b(),this.I6=null,hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(this.ecb.dispose(),this.ecb=null));$b.prototype.dispose.call(this)};Tb.prototype.JFh=function(K){var ea=this;return function(Ta){if(Bi.b(Ta,-901005882))Ga.a(ea.$).ud.kE(-901005882),ea.QFd();else if(Bi.b(Ta,-569193796))Ga.a(ea.$).ud.kE(-569193796),ea.hide(),new pb(ea.$,Ta.Errors[0]);else if(Bi.a(Ta))Ed.ULS.sendTraceTag(529105665,
0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),ea.hide();else{Ta=Ta.Result;ea.$.Bj(Ta.SortRange);var Lb=hf.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");Ta&&Db(Ta)&&rc(Ta)&&ob(Ta,Lb)?K(Ta):ea.N6b(Tb.krb())}}};Tb.prototype.tGh=function(K,ea){var Ta=this;return function(Lb,xc){if(Ta.jgc)Ed.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");
else if(!Lb||Bi.a(Lb))Ed.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",$g.a.Wc(Lb.Errors)),Ta.$.ea.Fp(Lb.Errors),Ta.hide();else{Lb=Lb.Result;var qd=K.RangeType,Jd=K.HeaderRowSize,De=K.SortTopToBottom;Lb&&bc(Lb,K.ConditionType)&&Cd(Lb,qd,Jd,De)?(Lb.ColumnInfo.ColumnOffset=xc,void 0!==Lb.HeaderColumnInfo&&null!==Lb.HeaderColumnInfo&&(Lb.HeaderColumnInfo.ColumnOffset=xc),ea(Lb,K.ConditionType,K.SortTopToBottom)):(Ed.ULS.sendTraceTag(529105633,
0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),Ta.N6b(Tb.krb()))}}};Tb.prototype.Ewj=function(K){return!!this.namedSheetViewPublic&&(0===K||3===K)};Tb.prototype.r6g=function(K){var ea={};ea.SelectedRange=this.selectedRange;ea.ActiveCell=this.cpc;ea.SortInfoMode=K;ea.ExpandSortSelection=this.ITg;ea.ExpandSortSelectionSupported=!0;return ea};Tb.prototype.kta=function(K){var ea={};ea[Yf.a.Yx]=this.Cc;ea.fromAutoFilter=K.FromAutoFilter;
ea.gridRTL=Tg.g(this.$).rtl;ea.activeCell=K.ActiveCell;ea.selectedRange=K.SelectedRange;ea.invokeGetSortInfo=this.jdi;ea.invokeGetSortConditionColorsOrIcons=this.idi;ea.highlightSortRange=this.A6h;ea.getColorName=this.getColorName;return ea};Tb.prototype.Goa=function(K,ea){K=sd.D(K);this.ha.sa.qd.equals(K)||this.ha.updateSelection(K,sd.C(ea),0,void 0,void 0,void 0,!0)};Tb.prototype.QFd=function(){var K=this;(new Kb(function(ea){var Ta={};Ta.ActiveCell=K.cpc;Ta.SelectedRange=K.selectedRange;Ta.ExpandSelection=
ea;Ta.FromAutoFilter=!1;ea={};K.$.Xd(-207540907,Ua.a.Ub,8,(ea.SortCommandData=Ta,ea))})).show()};Tb.prototype.N1b=function(){if(void 0!==this.I6&&null!==this.I6)for(var K=El(this.I6),ea=K.next();!ea.done;ea=K.next())this.$.na.ua.Neb(ea.value.Qt)};Tb.vKf=function(K,ea){var Ta={};K.Xd(1659552324,Ua.a.Ub,8,(Ta.CustomSortCommandData=ea,Ta))};Tb.krb=function(){return $g.a.gd(1,0,26,0,1,-1517197771,"CustomSortValidationError")};Ek.Object.defineProperties(Tb.prototype,{Cc:{configurable:!0,enumerable:!0,
get:function(){return"CustomSortDialog"}},ha:{configurable:!0,enumerable:!0,get:function(){return Tg.g(this.$).ha}}});Object(ve.a)(Tb,"CustomSortDialog",ml.a,[]);var Cc=b(1251);tc.prototype.getSelection=function(){return this.selection};Object(ve.a)(tc,"MacroRecorderRangeAutoFilterClearedPayload",null,[445]);Object(ve.a)(wc,"MacroRecorderRangeFilterReappliedPayload",null,[445]);var fd=b(981),gd=b(982),Sc=b(144),Pc=b(1252),Pd=b(229),Vd=b(37);gb.prototype.Zc=function(K,ea){return!this.rqd(K,ea)};gb.prototype.executeCommand=
function(K,ea,Ta){var Lb=null;K=ea.command;switch(K){case -864298118:Lb=this.ygh(ea,Ta);break;case -1010737776:Lb=this.Z6c(!0,ea,Ta);break;case 2123420468:Lb=this.Z6c(!1,ea,Ta);break;case -1089513346:Ta=this.eYe(Ta);if(!this.mAb([sd.D(Ta.SortOptions.SelectedRange)]))return ye.TaskExtensions.hl();Lb=this.JIe(ea,Ta);break;case -1032691499:case -764711886:case -2016161444:Lb=this.z1i(ea);break;case -207540907:case -1677817820:Lb=this.gridView.Rb.Gka(this.gridView.ha.sa.activeCell)?this.p1i():this.m1i(ea,
Ta);break;case 1659552324:Lb=this.JIe(ea,this.eYe(Ta));break;case 368460465:Lb=this.Ogh(ea);break;case 529856798:Lb=this.tgh(ea);break;case 644342024:Lb=this.Jgh(ea)}return Lb||lf.a(K)};gb.prototype.Lc=function(K,ea){if(K=1===K)switch(ea.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:break;case -1032691499:case -764711886:case -2016161444:K=hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",
!1);break;default:K=!1}return K};gb.prototype.jd=function(){return!1};gb.prototype.ha=function(){return this.$&&this.gridView?this.gridView.ha:null};gb.prototype.sNf=function(K){K?this.gridView.Nt(this.onContentReady):this.gridView.cx(this.onContentReady);this.Pbf=K};gb.prototype.Jxj=function(K){return!!this.sortOptions&&bh.a.equals(this.sjf,K.hia,!0)};gb.prototype.rqd=function(K,ea){var Ta=Tg.g(this.$).ha.sa.selectedRanges;return(new mk.a(this.$.xa)).Nm(K,ea,Ta,this.gridView)};gb.prototype.Z6c=function(K,
ea,Ta){var Lb={OperationType:0};Lb.IsAscending=K;Lb.HasHeader=!0;Lb.GuessHeader=!0;Lb.SortTopToBottom=!0;Lb.ExpandSortSelectionSupported=!0;Ta&&void 0!==Ta[gb.zSa]&&null!==Ta[gb.zSa]?(Ta=Ta[gb.zSa],Lb.ActiveCell=Ta.ActiveCell,Lb.SelectedRange=Ta.SelectedRange,Lb.ExpandSortSelection=Ta.ExpandSelection):(Lb.ActiveCell=sd.o(this.ha().sa.activeCell,this.$),Lb.SelectedRange=sd.v(this.ha().sa.qd,this.$),Lb.ExpandSortSelection=null);return this.mAb([sd.D(Lb.SelectedRange)])?this.gridView.Rb.Gka(sd.D(Lb.SelectedRange))?
this.Ggh(K):this.Mmd(Lb,ea):ye.TaskExtensions.hl()};gb.prototype.ygh=function(K,ea){var Ta=null,Lb=this.ha();Lb&&(this.Jxj(Lb)?this.mAb(Lb.sa.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Ta=this.Mmd(this.sortOptions,K)):Ta=this.Z6c(!0,K,ea));return Ta};gb.prototype.mAb=function(K){return hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&(hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||
this.$.isEditMode)?this.$.isEditMode?this.$.Cq(K,!0,1):this.$.YWc(K,!0,1):!0};gb.prototype.Ggh=function(K){this.$Th(K);return Ch.Task.Sa(!0)};gb.prototype.tQg=function(K){if(hf.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var ea=this.gridView.Rb.Qj(this.ha().sa.qd,!1);if(ea){var Ta=ea.name;ea=ea.usedRange;ea=this.ha().sa.activeCell.left-ea.left;return new sl.a(Ta,ea,K.IsAscending)}}return new rl.a(K)};gb.prototype.Mmd=function(K,ea){function Ta(){return Lb.tQg(K)}
var Lb=this;this.gridView.rg.dH(!1);return this.p8c(function(xc,qd,Jd){return Sb(Lb.$.na.ua,K,Lg.b(xc,Lb.ORi),qd,Jd,K)},function(xc){return new $c.a(141,0,xc,void 0,Ta)},ea,this.Dwj(K))};gb.prototype.Dwj=function(K){if(!this.namedSheetViewPublic)return!1;var ea=this.ha().sa.qd,Ta=sd.v(this.ha().sa.qd,this.$),Lb=this.gridView.Rb.Vwa(ea,!0),xc=this.ha().sa.Jba()&&this.gridView.Rb.zff(Ta),qd=this.gridView.Rb.Gki(Ta);K=(ea.G5||ea.s_)&&!ea.isSingle&&(null==K.ExpandSortSelection?!1:K.ExpandSortSelection)&&
this.gridView.Rb.zff(Ta);return Lb||xc||qd||K};gb.prototype.p1i=function(){return this.$.Xd(-1556797033,Ua.a.Ub,8,null)};gb.prototype.m1i=function(K,ea){K=8===K.Ye&&ea&&void 0!==ea[gb.zSa]&&null!==ea[gb.zSa]?ea[gb.zSa]:19===K.Ye&&ea&&void 0!==ea[Ua.a.Cg]&&null!==ea[Ua.a.Cg]?Zk.a.mi(ea[Ua.a.Cg]):this.u5g();if(!this.mAb([sd.D(K.SelectedRange)]))return ye.TaskExtensions.hl();Tg.g(this.$).rg.dH(!1);var Ta=null;(ea=ea.TopCellAddress)&&(Ta=sd.o(ea,this.$));new Tb(this.$,K,this.namedSheetViewPublic,Ta);
return Ch.Task.Sa(!0)};gb.prototype.eYe=function(K){return K[gb.zah]};gb.prototype.JIe=function(K,ea){function Ta(Ve){return new $c.a(187,0,Ve,void 0,Lb)}function Lb(){return new wb(ea.SortOptions)}function xc(Ve,sg,mh){return Sb(De.$.na.ua,ea.SortOptions,Lg.b(Ve,Jd),Lg.a(sg,qd),mh,De.sortOptions)}function qd(){ea.ShouldRestoreSelection&&De.Goa(ea.SelectedRange,ea.OriginalActiveCell);Ed.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",
K.Ye)}function Jd(Ve){hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&De.M6e(Ve)?De.y5e(Ve.Errors[0]):(ea.ShouldRestoreSelection&&De.Goa(ea.SelectedRange,ea.OriginalActiveCell),Ed.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",K.Ye),De.ELj(ea))}var De=this;return hf.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?this.p8c(xc,Ta,null,ea.ShouldPromptNamedSheetViewTeachingDialog):
tb.a(this.$.userOperationManager,xc,Ta,null)};gb.prototype.Goa=function(K,ea){K=sd.D(K);Tg.g(this.$).ha.sa.qd.equals(K)||Tg.g(this.$).ha.updateSelection(K,sd.C(ea),0,void 0,void 0,void 0,!0)};gb.prototype.u5g=function(){var K={};K.ActiveCell=sd.o(this.ha().sa.activeCell,this.$);K.SelectedRange=sd.v(this.ha().sa.qd,this.$);K.FromAutoFilter=!1;K.ExpandSelection=null;return K};gb.prototype.Ogh=function(K){function ea(){return new Cc.a(Lb)}var Ta=this,Lb=this.Naa();if(!Lb)return Ch.Task.Sa(!1);var xc=
this.$.na.ua.hc();return hf.EwaSettings.qc()?tb.a(this.$.userOperationManager,function(qd,Jd,De){return qe.kb(Ta.$.na.ua,Lb,fd.a.zva(Sc.a.IZa,gd.a.toggleAutoFilter,qd),Jd,De,null,xc)},function(qd){return new $c.a(516,0,qd,64,ea)},K):tb.a(this.$.userOperationManager,function(qd,Jd,De){return qe.kb(Ta.$.na.ua,Lb,fd.a.zva(Sc.a.IZa,gd.a.toggleAutoFilter,qd),Jd,De,null,xc)},function(qd){return new Uj.a(516,0,qd,void 0,ea)},K)};gb.prototype.tgh=function(K){function ea(){return new tc(Lb)}var Ta=this,Lb=
this.Naa();if(!Lb)return Ch.Task.Sa(!1);var xc=this.gridView.Rb.Qj(this.ha().sa.qd,!0);xc&&Ed.ULS.sendTraceTag(537151574,0,50,"DoClearAutoFilter for namedObject: Type : {0}",xc.type.toString());var qd=this.$.na.ua.hc();xc=hf.EwaSettings.qc()?function(Jd){return new $c.a(517,0,Jd,64,ea)}:function(Jd){return new Uj.a(517,0,Jd,void 0,ea)};return this.p8c(function(Jd,De,Ve){var sg=Ta.$.na.ua;Jd=fd.a.zva(Sc.a.nsa,gd.a.clearAutoFilter,Jd);var mh=sg.Na(41,void 0===qd?null:qd);mh.selectedRange=Lb;return qe.i(sg,
"ClearAutoFilter",mh,Jd,De,Ve,null,0)},xc,K)};gb.prototype.p8c=function(K,ea,Ta,Lb){var xc=this;return this.namedSheetViewPublic&&(void 0===Lb||Lb)?this.namedSheetViewPublic.OAa().continueWith(function(qd){qd.result&&tb.a(xc.$.userOperationManager,K,ea,Ta)}):tb.a(this.$.userOperationManager,K,ea,Ta)};gb.prototype.Jgh=function(K){function ea(){return new wc(Lb)}var Ta=this,Lb=this.Naa();if(!Lb)return Ch.Task.Sa(!1);var xc=this.$.na.ua.hc();return hf.EwaSettings.qc()?tb.a(this.$.userOperationManager,
function(qd,Jd,De){return ic(Ta.$.na.ua,Lb,fd.a.zva(Sc.a.nsa,gd.a.VKf,qd),Jd,De,null,xc)},function(qd){return new $c.a(518,0,qd,64,ea)},K):tb.a(this.$.userOperationManager,function(qd,Jd,De){return ic(Ta.$.na.ua,Lb,fd.a.zva(Sc.a.nsa,gd.a.VKf,qd),Jd,De,null,xc)},function(qd){return new Uj.a(518,0,qd,void 0,ea)},K)};gb.prototype.M6e=function(K){return Bi.b(K,-569193796)};gb.prototype.y5e=function(K){Ga.a(this.$).ud.kE(-569193796);new pb(this.$,K)};gb.prototype.QFd=function(K){var ea=this;(new Kb(function(Ta){var Lb=
{};Lb.ActiveCell=K.ActiveCell;Lb.SelectedRange=K.SelectedRange;Lb.ExpandSelection=Ta;Ta={};ea.$.Xd(K.IsAscending?-1010737776:2123420468,Ua.a.Ub,8,(Ta[gb.zSa]=Lb,Ta))})).show()};gb.prototype.MAj=function(){var K=this.ha();K.updateSelection(this.Ayc,K.sa.activeCell,0,void 0,void 0,void 0,!0);this.sNf(!0)};gb.prototype.Naa=function(){var K=this.ha();if(!K)return Ed.ULS.shipAssertTag(537151573,0,!!K,"SelectionManger is null"),null;this.gridView.rg.dH(!1);return sd.v(K.sa.qd,this.$)};gb.prototype.pKb=
function(){this.Fc&&this.Fc.Uo&&(this.$f=this.Fc.Uo,this.Db=this.Fc.Sac())};gb.prototype.$Th=function(K){var ea=this;if(this.$.isEditMode&&(this.Fc=this.gridView.Rb.jp(this.gridView.ha.sa.activeCell))){this.activeCell=sd.o(this.gridView.ha.sa.activeCell,this.$);if(this.Fc&&this.Fc.Uo){var Ta=this.Fc.Uo.CurrentCol;if(this.Fc.Uo.CurrentRow===this.activeCell.FirstRow&&Ta===this.activeCell.FirstColumn){this.pKb();this.applyPivotSort(K);return}}this.$.na.ua.hc();Ta=new $c.a(228,0,function(Lb,xc,qd){return qe.C(ea.$.na.ua,
ea.activeCell,Lg.b(Lb,ea.oLi),Lg.a(xc,ea.nLi),qd,K)},16);this.$.userOperationManager.ic(Ta,null)}};gb.prototype.applyPivotSort=function(K){var ea=this;if(this.Fc&&this.Db&&this.activeCell&&this.$f){var Ta=8===this.$f.CellArea,Lb=1===this.$f.CellArea||2===this.$f.CellArea;(Ta||Lb)&&8!==this.$f.CellType&&4!==this.$f.CellType&&(Ta?tb.a(this.$.userOperationManager,function(xc,qd,Jd){return qe.e(ea.$.na.ua,ea.activeCell,K?1:2,ea.Db.Caption,xc,qd,Jd,null)},function(xc){return new $c.a(1015,0,xc,void 0,
null)},null):(Ta=1===this.$f.CellArea?1:2,this.$.ma(701)?S.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Fc.externalSourceIndex,this.Db.Index.toString(),this.Db.Caption,this.Fc.isOlap?"":this.Db.Caption,Ta,K):S.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Fc.externalSourceIndex,this.Db.Index.toString(),K)))}};gb.prototype.ELj=function(K){K.SortOptions.SortConditions.some(function(ea){return 0===ea.SortConditionType})&&(K.TopCellAddress?
K=sd.C(K.TopCellAddress):(K=K.OriginalActiveCell,K=new hk.Range(K.FirstRow+1,K.FirstColumn+1,K.FirstRow+1,K.FirstColumn+1,!0,!1)),this.CL(K))};gb.prototype.CL=function(K){Vd.a.Fba(this.$)&&ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.Va(this.$.da,430,431,1),function(ea){ea.result.qea(K);Ed.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};gb.prototype.WWd=function(K){hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",
!1)&&ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.Va(this.$.da,476,475,0),function(ea){ea.result.WWd(K,0);Ed.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.la,3)};gb.prototype.z1i=function(K){var ea=this.gridView.ha.sa;if(!this.mAb(this.gridView.ha.sa.selectedRanges))return ye.TaskExtensions.hl();ea={OperationType:2,IsAscending:!0,HasHeader:!0,GuessHeader:!0,SortTopToBottom:!0,ExpandSortSelectionSupported:!0,ActiveCell:sd.o(ea.activeCell,
this.$),SelectedRange:sd.v(ea.qd,this.$),SortConditions:[this.H8g(K)],IsCaseSensitive:!1,SortInfoMode:0,ExpandSortSelection:null};return this.Mmd(ea,K)};gb.prototype.H8g=function(K){var ea=this.gridView.kc(this.gridView.ha.sa.activeCell),Ta=new Pc.a;Ta.IsAscending=!0;switch(K.command){case -1032691499:K=Pd.a.fp(ea.backgroundColor);Ta.SortColor=K.QS();Ta.SortConditionType=1;break;case -764711886:Ta.SortColor=ea.Tze;Ta.SortConditionType=2;break;case -2016161444:ea.Vwb?(Ta.SortIcon=ea.cell.ajc,Ta.SortIconSet=
ea.bjc):(Ta.SortIcon=gb.P0d,Ta.SortIconSet=gb.P0d);Ta.SortConditionType=3;break;default:Ed.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return Ta};gb.P0d=-1;gb.zah="CustomSortCommandData";gb.zSa="SortCommandData";Object(ve.a)(gb,"SortCommandHandler",null,[429]);var Ie=Yc.a;Am(Ia,Ie);Ia.prototype.Nd=function(){var K=this;ye.TaskExtensions.Ba(ee.GetServiceTaskFactory.Va(this.$.da,309,310,this.ub),
function(ea){K.Cd([new gb(K.$,ea.result)])},this.$.la,3)};Ia.ka=function(K){Yc.a.fe(160,new Ia(K))};Object(ve.a)(Ia,"SortCommandHandlerFactory",Yc.a,[]);ha.prototype.R9g=function(K,ea){new pb(K,ea)};Object(ve.a)(ha,"SortUtil",null,[534]);var sf=na.a;Am(La,sf);La.prototype.create=function(){var K=this.$.da.Aa(446);K||(K=new ha(this.$),this.$.da.Ga(446,K));this.Eb(K)};La.ka=function(K){K.da.Ga(447,new La(K))};Object(ve.a)(La,"SortUtilFactory",na.a,[]);mb.prototype.executeCommand=function(K,ea,Ta){return 2!==
this.Di.ve(Sf.a.tryOfficeThroughTellMe,2,Ta)?Ch.Task.Sa(!0):lf.a(ea.command)};mb.prototype.Lc=function(K,ea){return 215809929===ea.command};mb.prototype.jd=function(){return!1};mb.prototype.Zc=function(){return!1};Object(ve.a)(mb,"TryOfficeThroughTellMeCommandHandler",null,[429]);var Bf=Yc.a;Am(Ra,Bf);Ra.prototype.Nd=function(){this.Cd([new mb(he.AFrameworkApplication.Ib)])};Ra.ka=function(K){Yc.a.fe(207,new Ra(K))};Object(ve.a)(Ra,"TryOfficeThroughTellMeCommandHandlerFactory",Yc.a,[]);var Bg=b(179);
Ha.TM=function(){return lh.a.cp(Ha.xk,Bg.a.Wa(434))};Ha.xk="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(ve.a)(Ha,"NamedSheetViewTeachingDialogHtml",null,[]);var xg=Yf.a;Am(Xa,xg);Xa.prototype.hh=function(){this.jc=
4;this.stopwatch=this.$.Ob.Gc("UserAction",this.Cc);var K=Kc.a.instance.fa(1874);this.gg=Ha.TM();this.Zo=new Di.a;this.initializeAndShow(K,this.DBi,{});return this.Zo.task};Xa.prototype.Iv=function(K){xg.prototype.Iv.call(this,K);this.Dc(1,Kc.a.instance.fa(1876));this.Dc(2,Kc.a.instance.Wa(447))};Xa.prototype.J_i=function(){this.$.ea.Slc=!1};Xa.prototype.Kui=function(K){var ea={};ea.a=this.$.ya.UserSessionId;ea.b="NamedSheetViewTeachingDialogClose";ea.c=K;ea.e=!0;this.stopwatch&&(this.stopwatch.stop(),
ea.d=this.stopwatch.Bc);Sj.b().Qe(53,ea,!0)};Ek.Object.defineProperties(Xa.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(ve.a)(Xa,"NamedSheetViewTeachingDialog",Yf.a,[]);var Nh=b(162);qa.prototype.OAa=function(){if(this.exj()){if(hf.EwaSettings.ma(587)){this.$.xa.qa.Yd.nRd=!0;var K=new Di.a;this.$.Ka.Xb(new Xj.a(-2050946363,Ua.a.Ub,2,0,null)).continueWith(function(ea){K.setResult(!gc.a(ea)&&ea.result)});return K.task}return(new Xa(this.$)).hh()}return Ch.Task.Sa(!0)};
qa.prototype.exj=function(){var K=this.$.xa.qa;return this.$.ea.k9a&&this.$.ea.Slc&&!K.Yd.qy&&this.$.ea.IM&&!Nh.e(this.$)};Object(ve.a)(qa,"NamedSheetViewPublic",null,[536]);var Oh=na.a;Am(Aa,Oh);Aa.prototype.create=function(){this.Eb(this.$.da.Aa(309)||new qa(this.$))};Aa.ka=function(K){K.da.Ga(310,new Aa(K))};Object(ve.a)(Aa,"NamedSheetViewPublicFactory",na.a,[]);var Eh=b(1382),Si=b(1069),Ti=b(629);Object(ve.a)(Nb,"NamedSheetViewTeachingCalloutContent",null,[]);Ek.Object.defineProperties(lb.prototype,
{f8f:{configurable:!0,enumerable:!0,get:function(){return this.Yhe}},x1i:{configurable:!0,enumerable:!0,get:function(){return this.f8f<this.h8f.count?this.h8f.oa(this.Yhe++):null}}});Object(ve.a)(lb,"NamedSheetViewTeachingCalloutList",null,[]);var Ui=b(1253);kb.prototype.K9h=function(K){var ea=this;this.g8f=K;var Ta=Object(jh.a)(new ua.a,{});kb.phi(K)?(Ta.add(new Nb(Kc.a.instance.Wa(436),Kc.a.instance.Wa(437),Kc.a.instance.fa(1904),function(){ea.fI(2,"Continue");ea.RJ(!0)},Kc.a.instance.fa(1905),
function(){ea.RJ();ea.fI(1,"ExitGuide")},Ui.a())),1===K&&Ta.add(new Nb(Kc.a.instance.fa(1906),Kc.a.instance.Wa(439),Kc.a.instance.fa(1904),function(){ea.fI(2,"FirstEnterTempViewContinueSecond");ea.RJ(!0)},Kc.a.instance.fa(1905),function(){ea.RJ();ea.fI(1,"FirstEnterTempViewExitGuideSecond")},Ui.a())),Ta.add(new Nb(Kc.a.instance.Wa(440),Kc.a.instance.Wa(441),Kc.a.instance.fa(1904),function(){ea.fI(2,"FirstEnterExitCalloutContinue");ea.RJ(!0)},Kc.a.instance.fa(1905),function(){ea.RJ();ea.fI(1,"FirstEnterExitCalloutGuide")},
kb.S_e())),Ta.add(new Nb(Kc.a.instance.fa(1907),Kc.a.instance.Wa(438),Kc.a.instance.fa(1908),function(){ea.p3f();ea.RJ();ea.fI(1,"LearnMore")},Kc.a.instance.fa(1909),function(){ea.RJ();ea.fI(1,"Done")},kb.R_e()))):2===K?Ta.add(new Nb(Kc.a.instance.fa(1906),Kc.a.instance.Wa(439),Kc.a.instance.fa(1903),function(){ea.RJ();ea.fI(1,"EnterTempViewAfterPersistedView")},null,null,Ui.a())):3===K&&(Ta.add(new Nb(Kc.a.instance.Wa(436),Kc.a.instance.fa(1915),Kc.a.instance.fa(1904),function(){ea.fI(2,"AutoOptInExitCalloutContinue");
ea.RJ(!0)},Kc.a.instance.fa(1905),function(){ea.RJ();ea.fI(1,"AutoOptInExitGuide")},kb.S_e())),Ta.add(new Nb(Kc.a.instance.fa(1906),Kc.a.instance.Wa(439),Kc.a.instance.fa(1904),function(){ea.fI(2,"Continue");ea.RJ(!0)},Kc.a.instance.fa(1905),function(){ea.RJ();ea.fI(1,"ExitGuide")},Ui.a())),Ta.add(new Nb(Kc.a.instance.fa(1907),Kc.a.instance.Wa(438),Kc.a.instance.fa(1908),function(){ea.p3f();ea.RJ();ea.fI(1,"LearnMore")},Kc.a.instance.fa(1909),function(){ea.RJ();ea.fI(1,"Done")},kb.R_e())));this.kVd=
new lb(Ta)};kb.prototype.p3f=function(){var K=new Xj.a(-859308420,Ua.a.Ub,this.$.ed,9,null),ea={};ea=(ea[Ua.a.Cg]="HelpID=SheetViews",ea.InputMethod=Ua.a.Ub,ea[Ua.a.ld]=A.a.NV,ea.ShouldCanvasTakeFocus=!0,ea);this.$.Ka.Xb(K,ea)};kb.prototype.show=function(K){this.K9h(K);this.ydb()};kb.prototype.Jqj=function(K){this.z_b=K};kb.prototype.ydb=function(){var K=this,ea=this.kVd.x1i;if(ea){var Ta=Object(jh.a)(new Eh.a,{label:ea.V_i,onExecute:ea.primaryButtonAction}),Lb=null;ea.nWf&&(Lb=Object(jh.a)(new Eh.a,
{label:ea.nWf,onExecute:ea.secondaryButtonAction}));ea=Object(jh.a)(new Si.a,{target:ea.targetObject,content:ea.body,title:ea.title,showCloseIcon:!0,primaryButtonProps:Ta,secondaryButtonProps:Lb,useTeachingStyles:!0});ea=this.z_b.callout(ea);Ta=Object(jh.a)(new Ti.a,{onShow:function(){K.fI(0)}});this.Rzc=this.z_b.addNotification(ea,Ta);this.WWc||(this.$.Pqd=!0)}};kb.prototype.dismiss=function(){this.RJ();this.fI(1,"DismissedByOthers")};kb.prototype.RJ=function(K){K=void 0===K?!1:K;this.Rzc&&(this.WWc||
(this.$.Pqd=!1),this.z_b.removeNotification(this.Rzc),this.Rzc=null);K&&this.ydb()};kb.prototype.fI=function(K,ea){var Ta={};Ta.a=this.$.ya.UserSessionId;Ta.b=this.g8f;Ta.c=this.kVd.f8f;Ta.d=K;Ta.e=void 0===ea?null:ea;0===K?this.stopwatch=this.$.Ob.Gc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Ta.f=this.stopwatch.Bc,this.stopwatch=null),2===K&&(this.stopwatch=this.$.Ob.Gc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));Sj.b().Qe(52,Ta,!0)};kb.R_e=
function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};kb.S_e=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};kb.phi=function(K){return 0===K||1===K};Object(ve.a)(kb,"NamedSheetViewTeachingCallout",null,[535]);var bj=na.a;Am(Gb,bj);Gb.prototype.create=function(){var K=this.$.da.Aa(322);K||(K=new kb(this.$),hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.da.Ga(322,K));this.Eb(K)};Gb.ka=function(K){K.da.Ga(323,
new Gb(K))};Object(ve.a)(Gb,"NamedSheetViewTeachingCalloutFactory",na.a,[]);var Vi=b(96),pj=b(182),sj=b(1254),eh=b(57),ui=b(1143),cj=Gh.StandardDialog;Am(Sa,cj);Sa.prototype.zQ=function(){this.jc=5;this.width=40;var K=document.createElement("span");K.id=this.ni("DirectPrintHeaderContent");var ea=document.createElement("span");ea.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(ea,"DirectPrintHeader");this.HP=document.createElement("iframe");this.HP.name="pdfObjectFrame";
this.HP.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.HP.onload=Object(rf.a)(this,this.h0i,"printablePdfLoaded");if(this.tWb&&0<this.tWb.count){var Ta=Ng.a.Ufd(this.gVb,this.tWb),Lb=Ng.a.NId(this.gVb,this.tWb);this.$l=document.createElement("form");this.$l.id="printPreviewPostForm";this.$l.method="POST";this.$l.target=this.HP.name;this.$l.action=Lb;Ta=El(Ta);for(Lb=Ta.next();!Lb.done;Lb=Ta.next()){Lb=Lb.value;var xc=document.createElement("input");xc.type="hidden";xc.name=Lb.key;xc.value=Lb.value;
this.$l.appendChild(xc)}}else this.HP.setAttribute("src",this.gVb);Sys.UI.DomElement.addCssClass(this.HP,pj.a.lce);this.wpg?(Sys.UI.DomElement.addCssClass(this.HP,"DirectPrintPdfObjectHidden"),ea.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Th.a.yh(this.HP,Th.a.mC,Th.a.Mj)):(Sys.UI.DomElement.addCssClass(this.HP,"DirectPrintPdfObject"),this.en.push(this.HP));K.appendChild(ea);K.appendChild(document.createElement("br"));K.appendChild(this.HP);this.$l&&K.appendChild(this.$l);K.appendChild(document.createElement("br"));
K.appendChild(this.k1g(this.$l?"#":this.gVb));this.Ulb.start();this.ICb(CommonUIStrings.l_AppTitle,null,null,null,null,K);this.rX(this.ni("DirectPrintHeaderContent"));this.$l&&this.$l.submit();this.g6g();Ed.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};Sa.prototype.k1g=function(K){var ea=document.createElement("span"),Ta=document.createElement("span");Ta.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;ea.appendChild(Ta);he.AFrameworkApplication.ga&&(2===he.AFrameworkApplication.ta.Qa.Sj&&
he.AFrameworkApplication.ga.ra("PPTDisableDirectPrintDialogDownloadPDFLink")||1===he.AFrameworkApplication.ta.Qa.Sj&&he.AFrameworkApplication.ga.ra("XLODisableDirectPrintDialogOpenPDFLink"))?(K=document.createElement("span"),2===he.AFrameworkApplication.ta.Qa.Sj?K.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===he.AFrameworkApplication.ta.Qa.Sj&&(K.innerText=CommonUIStrings.l_InternalError_Directive,Ed.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),
this.Vpa=K,ea.appendChild(document.createElement("br")),ea.appendChild(K)):(Ta=document.createElement("a"),Ta.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,Ta.href=K,Ta.target="_blank",Ta.id="PrintPDFLink",Ta.className="AllowBrowserClick",this.Vpa=Ta,ea.appendChild(document.createElement("br")),ea.appendChild(Ta),this.$l&&kg.a.addHandler(Ta,"click",Object(rf.a)(this,this.Goc,"onSubmit")),this.AP.pa(ag.a.click,this.Vpa,Object(rf.a)(this,this.jJe,"downloadPDFLinkClicked"),null));this.en.push(this.Vpa);
return ea};Sa.prototype.Goc=function(K){this.$l&&(this.$l.target="_blank",this.$l.submit());K.preventDefault()};Sa.prototype.g6g=function(){if(0<this.en.length){var K=new sj.a(this.en),ea=Vi.FocusManager.instance().VQ();ea&&(this.Vpa.focus(),ea.ff=K,ea.I_=!0)}};Sa.prototype.jJe=function(){Ed.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};Sa.prototype.$td=function(){Ed.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};
Sa.prototype.h0i=function(){Ed.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Ulb&&this.Ulb.stop()};Sa.prototype.dispose=function(){this.Vpa&&(this.AP.za(ag.a.click,this.Vpa,Object(rf.a)(this,this.jJe,"downloadPDFLinkClicked")),this.Vpa=null);eh.a.w0(this.HP);this.HP=null;cj.prototype.dispose.call(this)};Object(ve.a)(Sa,"DirectPrintDialog",Gh.StandardDialog,[592]);Ca.prototype.XMh=function(K,ea,Ta){return new Sa(this.AP,K,ea,void 0===Ta?null:Ta)};Object(ve.a)(Ca,"DirectPrintDialogFactory",
null,[582]);Am(fa,Cf);fa.prototype.qlf=function(){Ed.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};fa.prototype.slf=function(){he.AFrameworkApplication.Zm.Vxb(9540);Ed.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")};fa.prototype.$td=function(){Ed.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};Ek.Object.defineProperties(fa.prototype,{R8e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},UVd:{configurable:!0,enumerable:!0,
get:function(){return fa.RTa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},jOa:{configurable:!0,enumerable:!0,get:function(){return fa.RTa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},XVc:{configurable:!0,enumerable:!0,get:function(){var K=[];Array.add(K,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Cf.txb){var ea=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==he.AFrameworkApplication.ta.Qa.AFe&&(ea=he.AFrameworkApplication.ta.Qa.AFe);Array.add(K,ea)}return fa.RTa?
K:null}},Pjc:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},Ojc:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},F4c:{configurable:!0,enumerable:!0,get:function(){return he.AFrameworkApplication.xHe?"UIFontDialogTextLarge":null}}});Ek.Object.defineProperties(fa,{RTa:{configurable:!0,enumerable:!0,get:function(){return!!he.AFrameworkApplication.ta&&
he.AFrameworkApplication.ta.Qa.vv&&he.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Af.a.XC||Af.a.xf||Af.a.Gf||Af.a.QMa)&&!he.AFrameworkApplication.isUnifiedHostMode&&he.AFrameworkApplication.ga.ra("ShouldHostDefaultToNativeBrowserPrintExperience")},set:function(){}}});Object(ve.a)(fa,"PrintDialogWithLinkToPdf",Cf,[]);ta.z6c=",";Object(ve.a)(ta,"DirectPrintBrsSettings",null,[]);Object(ve.a)(va,"DirectPrintProbeResults",null,[]);xa.prototype.start=function(){};xa.prototype.g2i=
function(){var K=Array(this.GC.TSa.length);if(void 0!==this.pkb&&null!==this.pkb)for(var ea=0;ea<this.GC.TSa.length;ea++)K[ea]=this.GC.TSa[ea]in this.pkb&&this.Aqg(this.pkb[this.GC.TSa[ea]]);return K};xa.prototype.h2i=function(){for(var K=Array(this.GC.USa.length),ea=!(void 0===this.WNc||null===this.WNc),Ta=0;Ta<this.GC.USa.length;Ta++){var Lb=this.GC.USa[Ta];K[Ta]=ea&&Lb in this.WNc?!0:this.grg(Lb)}return K};xa.prototype.yYh=function(){for(var K=this.g2i(),ea=Array(K.length),Ta=0;Ta<K.length;Ta++)ea[Ta]=
K[Ta]?this.iyh(this.pkb[this.GC.TSa[Ta]]):null;return ea};xa.prototype.iyh=function(K){if(void 0===K||null===K)return null;K=K.enabledPlugin;return void 0===K||null===K?null:K.name};xa.prototype.NUh=function(){for(var K=this.yYh(),ea=this.h2i(),Ta={},Lb={},xc=0;xc<this.GC.TSa.length;xc++)Ta[this.GC.TSa[xc]]=K[xc];for(K=0;K<this.GC.USa.length;K++)Lb[this.GC.USa[K]]=ea[K];return new va(Ta,Lb)};xa.prototype.Txj=function(){return this.org||!this.GC.isEnabled||he.AFrameworkApplication.isUnifiedHostMode?
!1:this.XFj()};xa.prototype.Fxc=function(){if(null!=this.MXb)return this.MXb;var K=xa.scf(this.GC);return this.MXb=this.GC.tcf&&K||this.lfi()};xa.prototype.lfi=function(){return Af.a.pp&&this.GC.mfi&&Af.a.cye>=this.GC.gXg?!0:!1};xa.prototype.XFj=function(){if(!this.hrg(this.GC))return!1;var K=N.a.xhd(this.mPc.value.f7f);K=El(K);for(var ea=K.next();!ea.done;ea=K.next())if(ea=ea.value,void 0!==ea&&null!==ea)return!0;K=N.a.xhd(this.mPc.value.USa);K=El(K);for(ea=K.next();!ea.done;ea=K.next())if(ea.value)return!0;
return!1};xa.prototype.M4h=function(){var K=N.a.xhd(this.mPc.value.f7f);K=El(K);for(var ea=K.next();!ea.done;ea=K.next())if(Pa.a.contains(this.GC.$7h,ea.value))return!0;return!1};xa.prototype.E3f=function(K){var ea=void 0===ea?!1:ea;var Ta=void 0===Ta?null:Ta;he.AFrameworkApplication.ta&&he.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")?this.fae(K,Ta):this.Txj()?this.Hfh(K,this.M4h()&&!ea,Ta):this.fae(K,Ta)};xa.prototype.Hfh=function(K,ea,Ta){Ta=void 0===Ta?null:Ta;var Lb=
this.vwg.Gc("UserAction","OpenDirectPrintDialog");this.xVa.XMh(K,ea,Ta).zQ();Lb.stop()};xa.Pgf=function(K){try{return new ActiveXObject(K),!0}catch(ea){Ed.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",K)}return!1};xa.ucf=function(K){return void 0===K||null===K?!1:!(void 0===K.enabledPlugin||null===K.enabledPlugin)};xa.create=function(K){var ea=new ta(he.AFrameworkApplication.ga.appSettings),Ta=null;try{Ta=window.navigator.mimeTypes}catch(sg){Ed.ULS.sendTraceTag(573923532,
328,15,"Failed to get Window.Navigator.mimeTypes")}var Lb=null;try{Lb=window.navigator.plugins}catch(sg){Ed.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var xc=xa.ucf,qd=xa.Pgf;K=K.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var Jd=he.AFrameworkApplication.ta.JD,De=xa.Qgf,Ve=!!he.AFrameworkApplication.ta&&he.AFrameworkApplication.ta.Qa.vv&&!he.AFrameworkApplication.ga.ra("PrintDialogFallbackLinkEnabled");return new xa(ea,Ta,Lb,xc,qd,K,Jd,De,function(sg,
mh){return new fa(sg,!1,mh,!0,Ve)},he.AFrameworkApplication.kMa)};xa.Qgf=function(K){return Af.a.pp||Af.a.xf&&K.Gii||K.tcf&&xa.scf(K)?!0:!1};xa.scf=function(K){var ea=Af.a.Nsb;if(ea){var Ta=ea.split(".");if(2===Ta.length)return ea=parseInt(Ta[0]),Ta=parseInt(Ta[1]),ea>K.Hwd||ea===K.Hwd&&Ta>=K.Ppf}return!1};Ek.Object.defineProperties(xa.prototype,{GC:{configurable:!0,enumerable:!0,get:function(){return this.jng}}});Object(ve.a)(xa,"DirectPrintManager",null,[532]);pa.prototype.ei=function(K){var ea=
this;this.tb=K;K.register(Ca,"Common.App.DirectPrint.DirectPrintDialogFactory").Hc().Oc(function(){return new Ca(he.AFrameworkApplication.ta.DX)});K.register(532,"Common.App.DirectPrint.IDirectPrintManager").Hc().Oc(function(){return xa.create(ea.tb)})};pa.prototype.init=function(){this.g5d=this.tb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.g5d.start()};pa.prototype.dispose=function(){};Ek.Object.defineProperties(pa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});
Object(ve.a)(pa,"PackageManager",null,[4,5]);var dj=b(638),Pj=tk.a;Am(ma,Pj);ma.prototype.setFocus=function(){this.yw.checked?Id.DOMElementExtensions.setFocus(this.yw):Id.DOMElementExtensions.setFocus(this.getButton(0).get_element())};Ek.Object.defineProperties(ma.prototype,{Rd:{configurable:!0,enumerable:!0,get:function(){return this.qRb}}});ma.z5b="printCurrentSelection";Object(ve.a)(ma,"BasePrintDialog",tk.a,[]);var hi=b(236);Am(R,ma);R.prototype.initialize=function(){Ed.ULS.sendTraceTag(537154316,
0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.L$h();this.xYa(1188);this.addButton(1);ma.prototype.initialize.call(this)};R.prototype.rha=function(){var K=this;return function(ea,Ta,Lb){var xc=K.$.na.ua,qd=K.Um;ea=K.ija(ea);Ta=K.Jaa(Ta);var Jd=K.Rd,De=xc.Na(1,null);De.printOptions=qd;return qe.i(xc,"ValidatePrint",De,ea,Ta,Lb,Jd,0)}};R.prototype.commit=function(){this.J_g();return!0};R.prototype.Ay=function(K,ea,Ta){var Lb,xc=K.Result;if(xc&&ea){var qd=0,Jd=0;(null===
(Lb=xc.SelectedRanges)||void 0===Lb?0:Lb.Ranges)&&0<xc.SelectedRanges.Ranges.length&&xc.SelectedRanges.Ranges[0]&&(qd=Math.min(R.Q0f(xc.SelectedRanges.Ranges[0]),65535));xc.UsedRange&&(Jd=Math.min(R.Q0f(sd.j(sd.D(xc.UsedRange))),65535));hi.h(ea,qd);hi.i(ea,Jd)}this.Um=xc;ma.prototype.Ay.call(this,K,ea,Ta)};R.prototype.setFocus=function(){this.dtb.checked?Id.DOMElementExtensions.setFocus(this.dtb):ma.prototype.setFocus.call(this)};R.prototype.L$h=function(){this.Qb.innerHTML=R.ZZi(this.$.ea.isNamedObjectViewMode);
this.yw=Id.DOMElementExtensions.getElementById(this.Qb,ma.z5b);this.dtb=Id.DOMElementExtensions.getElementById(this.Qb,"printEntireItem");0!==this.Um.Type&&this.Um.UseSelection?(this.yw.checked=!0,this.dtb.disabled=!this.Um.SheetName):(this.dtb.checked=!0,this.yw.disabled=0===this.Um.Type||!Tg.g(this.$).ha.sa.Ig)};R.prototype.J_g=function(){Ed.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var K=new Sys.StringBuilder;this.DGh(K);var ea=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",
Af.a.Gf?0:1);Hh.HelperMethods.jf(K.toString(),"",ea,"PrintDialog.PrintViewUrl")||Ed.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};R.prototype.DGh=function(K){var ea=this.$.ya;K.append(this.$.Lda+ea.LayoutsRelativeUri+"/xlprintview.aspx?");Xh.a.eh(K,A.a.D1i,this.Um.SessionId);Xh.a.eh(K,A.a.F1i,this.yw.checked?"1":"0");if(0===this.Um.Type)Xh.a.eh(K,A.a.A1i,this.Um.ObjectId);else{if(!this.Um.UsedRangeTooBig){var Ta=sd.D(this.Um.UsedRange);
(Ta=sd.x(Ta,this.Um.SheetName))&&Xh.a.eh(K,A.a.G1i,Ta)}1===this.Um.Type?Xh.a.eh(K,A.a.B1i,this.Um.ObjectId):(Ta=sd.B(this.Um.SelectedRanges.Ranges[0]),Ta=sd.x(Ta,this.Um.SheetName),Xh.a.eh(K,A.a.C1i,Ta))}Dj.a.hZa(K,ea);Xh.a.eh(K,A.a.E1i,this.Um.Title)};R.ZZi=function(K){return String.format("<div class='"+kj.a.vo+"'>{0}</div>\r\n\t<div class='"+kj.a.e9c+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",
Kc.a.instance.fa(1189),ma.z5b,Kc.a.instance.fa(1192),"printEntireItem",K?Kc.a.instance.fa(1191):Kc.a.instance.fa(1190))};R.Q0f=function(K){return(K.LastColumn-K.FirstColumn+1)*(K.LastRow-K.FirstRow+1)};Ek.Object.defineProperties(R.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(ve.a)(R,"HtmlPrintDialog",ma,[]);var ei=b(618),Mh=b(65),ai=b(1256),lj=b(978),Mi=b(305),vi=b(1074),bi=b(938);J.prototype.getSheetName=function(){return this.sheetName};J.prototype.getPrintSettings=
function(){return this.printSettings};Object(ve.a)(J,"MacroRecorderSheetPrintSettingsSavedPayload",null,[445]);Am(D,ma);D.prototype.initialize=function(){this.G7&&hf.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&D.Q6g(this.Qb);this.Ne?this.bBe(1003,null):(this.cl(),this.xYa(1003));ma.prototype.initialize.call(this)};D.prototype.dispose=function(){this.FNj();ma.prototype.dispose.call(this)};D.prototype.close=function(K){Ed.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",
this.i0,0===K?"with":"without");this.ojj();if(this.vs){var ea=this.ZLh();!this.$Sd&&!this.kaa.checked&&this.$.isEditMode&&this.vjd(ea)&&this.fjj(ea)}ma.prototype.close.call(this,K)};D.prototype.rha=function(){var K=this;return function(ea,Ta,Lb){return Z(K.$.na.ua,K.$.xa.qa.name,K.locale,K.ija(ea),K.Jaa(Ta),Lb,null)}};D.prototype.Ay=function(K,ea,Ta){this.vs=K.Result;this.zJb=this.vs.ScalingWidth;this.yJb=this.vs.ScalingHeight;this.Wad();this.s$h();ma.prototype.Ay.call(this,K,ea,Ta)};D.prototype.cl=
function(){Ed.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.M$h();ma.prototype.cl.call(this)};D.prototype.commit=function(){this.I_g();return!0};D.prototype.setFocus=function(){this.Ne?$k.a.XAc(this.Uca):this.Uca.checked?Id.DOMElementExtensions.setFocus(this.Uca):ma.prototype.setFocus.call(this)};D.prototype.abi=function(){switch(this.cO.Vv){case 1:this.Uca.checked=!0;break;case 0:this.yw.disabled?this.Uca.checked=!0:this.yw.checked=
!0;break;case 2:this.kaa.checked=!0;break;default:Ed.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.cO.Vv),this.cO.Vv=1,this.Uca.checked=!0}};D.prototype.ojj=function(){this.cO.Vv=this.CZc();this.G7&&(this.cO.ignorePrintArea=this.x5a.checked)};D.prototype.Wad=function(){if(100!==this.vs.ScalingPercent||this.vs.FitToPage&&(1<this.vs.ScalingWidth||1<this.vs.ScalingHeight))this.$Sd=!0,this.vs.ScalingWidth=D.X5c,this.vs.ScalingHeight=D.W5c,this.vs.ScalingPercent=
D.c6b,this.vs.FitToPage=D.Q5c;this.vs.PaperSize.toString()in this.$Cd||(this.$Sd=!0,this.vs.PaperSize=this.vs.PaperSize===D.aNg?34:D.asb)};D.prototype.s$h=function(){this.oza=this.vs.IsLandscape?2:1;this.h0=this.vs.FitToPage?1===this.vs.ScalingWidth&&1===this.vs.ScalingHeight?1:this.vs.ScalingWidth||1!==this.vs.ScalingHeight?2:3:0;this.zma=this.vs.PaperSize;this.Z7c(this.kaa.checked?!0:!1);this.yOd(this.kaa.checked?!0:!1)};D.prototype.Z$h=function(){this.Bec.disabled=this.yw.checked;this.GGb=this.x5a.checked=
this.cO.ignorePrintArea};D.prototype.u9g=function(K){this.gAa=document.createElement("select");this.gAa.style.width=224+Mh.a.gf;this.gAa.style.height=32+Mh.a.gf;this.gAa.setAttribute(A.a.rE,"scalingElementId");this.fAa=new bi.a(this.gAa,!0);for(var ea=0,Ta=D.scalingOptions.length;ea<Ta;++ea){var Lb=Kc.a.instance.fa(D.Mjj[ea]);this.fAa.kM(Lb,D.scalingOptions[ea].toString(),!1)}K.appendChild(this.gAa)};D.prototype.oEe=function(K){this.Xya=document.createElement("select");this.Xya.style.width=224+Mh.a.gf;
this.Xya.style.height=32+Mh.a.gf;this.Xya.setAttribute(A.a.rE,"paperSizeElementId");this.Wya=new bi.a(this.Xya,!0);for(var ea=0,Ta=D.paperSizeOptions.length;ea<Ta;++ea){var Lb=Kc.a.instance.fa(D.KVi[ea]);this.Wya.kM(Lb,D.paperSizeOptions[ea].toString(),!1)}K.appendChild(this.Xya)};D.prototype.ZLh=function(){var K={};K.IsLandscape=2===this.oza;K.PaperSize=this.zma;K.ScalingWidth=this.zJb;K.ScalingHeight=this.yJb;K.ScalingPercent=100;K.FitToPage=0===this.h0?!1:!0;return K};D.prototype.JHa=function(){var K=
new Sys.StringBuilder;K.append(vi.a(this.$,"Pdf",!0));this.lia.Fxc()&&Xh.a.eh(K,af.a.deg,"1");Xh.a.eh(K,af.a.cGd,""+this.P6);Xh.a.eh(K,af.a.LJf,this.$.xa.qa.name);0===this.P6&&(Xh.a.eh(K,af.a.KJf,this.selectedRange),Xh.a.eh(K,af.a.EJf,this.activeCell));Xh.a.eh(K,af.a.FJf,""+this.oza);Xh.a.eh(K,af.a.GJf,""+this.zma);Xh.a.eh(K,af.a.JJf,""+this.h0);Xh.a.eh(K,af.a.IJf,"1");Xh.a.eh(K,af.a.DJf,this.GGb?"1":"0");Xh.a.eh(K,af.a.HJf,"1");Ed.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",
K.toString());return K.toString()};D.prototype.uyb=function(){var K=this,ea=null;Ed.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.ic(new $c.a(223,0,function(Ta,Lb,xc){Ta=new Mi.a(Ta,null,Lb,xc,null,!0,!1,"GetFileCopyFileHandler","");Ta.correlationID=Eg.a.create().toString();ea=Ta;he.AFrameworkApplication.Jd.K9(K.JHa(),1,null,null,D.kad,!1,2,K.rAd,K.qAd,ea,void 0,void 0,void 0,12E4);return Ch.Task.Sa(!0)},
16),null)};D.prototype.M$h=function(){Ed.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.YZi(this.Qb);this.Z7c(!0);this.yOd(!0);this.yw=Id.DOMElementExtensions.getElementById(this.Qb,ma.z5b);this.Uca=Id.DOMElementExtensions.getElementById(this.Qb,"printActiveSheet");this.kaa=Id.DOMElementExtensions.getElementById(this.Qb,"printEntireWorkbook");this.G7&&(this.Bec=Id.DOMElementExtensions.getElementById(this.Qb,"ignorePrintAreaCheckboxButtonId"),
this.x5a=new lj.a(this.Bec));this.fxc()&&(this.yw.disabled=!0,this.Um.SheetName=this.sheetName);this.abi();this.G7&&this.Z$h();this.Q7i()};D.prototype.fxc=function(){return!!this.Um.ObjectId||!Tg.g(this.$).ha.sa.Ig};D.prototype.Q7i=function(){ei.a.instance.pa(ag.a.change,this.Uca,this.x9a);ei.a.instance.pa(ag.a.change,this.kaa,this.x9a);ei.a.instance.pa(ag.a.change,this.yw,this.x9a);ei.a.instance.pa(ag.a.change,this.oxa,this.Qmc);ei.a.instance.pa(ag.a.change,this.U$a,this.Qmc);ei.a.instance.pa(ag.a.change,
this.Xya,this.suf);ei.a.instance.pa(ag.a.change,this.gAa,this.tuf);this.G7&&this.x5a.onb(this.ruf)};D.prototype.FNj=function(){ei.a.instance.za(ag.a.change,this.Uca,this.x9a);ei.a.instance.za(ag.a.change,this.kaa,this.x9a);ei.a.instance.za(ag.a.change,this.yw,this.x9a);ei.a.instance.za(ag.a.change,this.oxa,this.Qmc);ei.a.instance.za(ag.a.change,this.U$a,this.Qmc);ei.a.instance.za(ag.a.change,this.Xya,this.suf);ei.a.instance.za(ag.a.change,this.gAa,this.tuf);this.G7&&this.x5a.lda(this.ruf)};D.prototype.YZi=
function(K){K.classList.add(ai.a.Y_i);if(!this.Ne){document.getElementById("ewaDialogTitle").classList.add(ai.a.printDialogTitle);var ea=document.getElementById("ewaDialogCloseButtonLink");ea.style.top=32+Mh.a.gf;this.rtl?ea.style.left=32+Mh.a.gf:ea.style.right=32+Mh.a.gf}ea=D.qz(ai.a.Z_i);K.appendChild(ea);var Ta=D.qz(ai.a.kab,1196);Ta.style.marginBottom=12+Mh.a.gf;Ta.id="whatToPrintTitleElementId";ea.appendChild(Ta);Ta=D.qz(ai.a.jab);ea.appendChild(Ta);D.vrb(Ta,this.rtl,"printActiveSheet",1200,
"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");ea.appendChild(document.createElement("BR"));Ta=D.qz(ai.a.jab);ea.appendChild(Ta);D.vrb(Ta,this.rtl,"printEntireWorkbook",1193,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");ea.appendChild(document.createElement("BR"));Ta=D.qz(ai.a.jab);ea.appendChild(Ta);D.vrb(Ta,this.rtl,ma.z5b,
1192,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.G7?(Ta=D.qz(ai.a.kab,1225),Ta.style.marginTop=24+Mh.a.gf,Ta.id="printAreaElementId",ea.appendChild(Ta),hf.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(Ta.style.marginBottom=12+Mh.a.gf,Ta=D.qz(kj.a.f9c),Ta.id="ignorePrintAreaCheckboxWarpperId",Id.DOMElementExtensions.setVisible(Ta,!0),ea.appendChild(Ta),ea=this.getElementById("ignorePrintAreaCheckboxButtonId"),
Id.DOMElementExtensions.setVisible(ea,!0),Ta.appendChild(ea),ea=this.getElementById("ignorePrintAreaCheckboxLabelId"),Id.DOMElementExtensions.setVisible(ea,!0),Ta.appendChild(ea)):(Ta=D.qz(ai.a.jab),ea.appendChild(Ta),D.I4g(Ta,this.rtl))):(Ta=D.qz(ai.a.kab,1198),Ta.style.marginTop=24+Mh.a.gf,Ta.id="paperSizeElementId",ea.appendChild(Ta),Ta=D.qz(ai.a.mFd),this.oEe(Ta),ea.appendChild(Ta));ea=D.qz(ai.a.$_i);K.appendChild(ea);K=D.qz(ai.a.kab,1197);K.style.marginBottom=12+Mh.a.gf;K.id="orientationTitleElementId";
ea.appendChild(K);K=D.qz(ai.a.jab);ea.appendChild(K);D.vrb(K,this.rtl,"portraitRadioButtonId",1203,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId","orientationTitleElementId");ea.appendChild(document.createElement("BR"));K=D.qz(ai.a.jab);ea.appendChild(K);D.vrb(K,this.rtl,"landscapeRadioButtonId",1202,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.G7&&(K=D.qz(ai.a.kab,1198),K.style.marginTop=12+
Mh.a.gf,K.id="paperSizeElementId",ea.appendChild(K),K=D.qz(ai.a.mFd),this.oEe(K),ea.appendChild(K));K=D.qz(ai.a.kab,1199);K.style.marginTop=(this.G7?10:74)+Mh.a.gf;K.id="scalingElementId";ea.appendChild(K);K=D.qz(ai.a.mFd);this.u9g(K);ea.appendChild(K);this.Ne||document.getElementById("buttonarea").classList.add(ai.a.X_i);this.oxa=Id.DOMElementExtensions.getElementById(this.Qb,"landscapeRadioButtonId");this.U$a=Id.DOMElementExtensions.getElementById(this.Qb,"portraitRadioButtonId")};D.prototype.I_g=
function(){var K=this;Ed.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.P6=this.CZc();2!==this.P6&&(this.oza=this.yve(),this.Wya&&(this.zma=D.paperSizeOptions[this.Wya.selectedIndex]),this.fAa&&(this.h0=D.scalingOptions[this.fAa.selectedIndex]));if(this.$.zwa&&hf.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var ea=this.$.na.ua.hc();this.$.userOperationManager.ic(new $c.a(133,0,function(Ta,
Lb,xc){var qd={};qd.WhatToPrint=K.P6;qd.UseNamedAction=K.lia.Fxc();qd.SelectedSheetName=K.$.xa.qa.name;qd.ActiveCell=K.activeCell;qd.SelectedRanges=[K.selectedRange];qd.IsPdfDocumentRequired=!1;qd.Orientation=K.oza;qd.PaperSize=K.zma;qd.Scaling=K.h0;qd.RichValuesEnabled=!0;K.G7&&(qd.IgnorePrintArea=K.GGb);return W(K.$.na.ua,qd,Lg.b(K.bEb,Ta),Lb,xc,ea)},16),null)}else this.uyb()};D.prototype.Z7c=function(K){this.U$a.disabled=K;this.oxa.disabled=K;this.Wya.Yn.disabled=K;this.fAa.Yn.disabled=K};D.prototype.yOd=
function(K){K?(this.oxa.checked=!1,this.U$a.checked=!1,this.Wya.selectedIndex=-1,this.fAa.selectedIndex=-1):(2===this.oza?this.oxa.checked=!0:this.U$a.checked=!0,this.Wya.selectedIndex=this.$Cd[this.zma.toString()],this.fAa.selectedIndex=this.h0)};D.prototype.fjj=function(K){var ea=this;Ed.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var Ta=this.$.xa.qa.name,Lb=this.$.na.ua.hc();this.$.userOperationManager.ic(new $c.a(226,
0,function(xc,qd,Jd){return ka(ea.$.na.ua,Ta,K,xc,qd,Jd,Lb)},void 0,function(){return new J(Ta,K)}),null)};D.prototype.vjd=function(K){return this.vs.IsLandscape!==K.IsLandscape||this.vs.PaperSize!==K.PaperSize||this.vs.FitToPage!==K.FitToPage||this.vs.ScalingHeight!==K.ScalingHeight||this.vs.ScalingWidth!==K.ScalingWidth?!0:!1};D.prototype.yve=function(){return this.oxa&&this.oxa.checked?2:1};D.prototype.CZc=function(){return this.yw.checked?0:this.Uca.checked?1:this.kaa.checked?2:1};D.qz=function(K,
ea){K=void 0===K?null:K;ea=void 0===ea?0:ea;var Ta=document.createElement("div");K&&(Ta.className=K);0!==ea&&(Ta.innerHTML=Kc.a.instance.fa(ea));return Ta};D.Q6g=function(K){var ea=document.createElement("input");ea.setAttribute("type","checkbox");ea.className=kj.a.MMe;ea.id="ignorePrintAreaCheckboxButtonId";ea.setAttribute("name","ignorePrintAreaCbName");ea.style.height=16+Mh.a.gf;ea.style.width=16+Mh.a.gf;Id.DOMElementExtensions.setVisible(ea,!1);var Ta=Kc.a.instance.fa(1225),Lb=Kc.a.instance.fa(1226);
ea.setAttribute(A.a.Pt,Ta+Mh.a.space+Lb);K.appendChild(ea);ea=document.createElement("label");ea.setAttribute("for","ignorePrintAreaCheckboxButtonId");ea.id="ignorePrintAreaCheckboxLabelId";ea.innerHTML=Lb;ea.setAttribute(A.a.RP,"true");ea.style.position="relative";ea.style.marginLeft=15+Mh.a.gf;Id.DOMElementExtensions.setVisible(ea,!1);K.appendChild(ea)};D.I4g=function(K,ea){var Ta=document.createElement("input");Ta.setAttribute("type","checkbox");Ta.id="ignorePrintAreaCheckboxButtonId";Ta.setAttribute("name",
"ignorePrintAreaCbName");Ta.setAttribute(A.a.rE,"printAreaElementId"+Mh.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");Ta.style.height=16+Mh.a.gf;Ta.style.width=16+Mh.a.gf;ea?Ta.style.marginRight=0+Mh.a.gf:Ta.style.marginLeft=0+Mh.a.gf;K.appendChild(Ta);ea=document.createElement("label");ea.setAttribute("for","ignorePrintAreaCheckboxButtonId");ea.setAttribute(A.a.RP,"true");ea.style.position="relative";ea.style.marginLeft=15+Mh.a.gf;K.appendChild(ea);K=D.qz(ai.a.uIf,1226);K.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";
ea.appendChild(K)};D.vrb=function(K,ea,Ta,Lb,xc,qd,Jd,De){var Ve=document.createElement("input");Ve.setAttribute("type","radio");Ve.id=Ta;Ve.setAttribute("name",xc);Ve.setAttribute(A.a.rE,De+Mh.a.space+Jd);Ve.style.height=16+Mh.a.gf;Ve.style.width=16+Mh.a.gf;ea?Ve.style.marginRight=0+Mh.a.gf:Ve.style.marginLeft=0+Mh.a.gf;K.appendChild(Ve);ea=document.createElement("label");ea.setAttribute("for",Ta);ea.style.position="relative";K.appendChild(ea);K=mg.createClusteredImage(32,32,qd,ai.a.g0i,!0,Kc.a.instance.fa(Lb));
Lb=D.qz(ai.a.uIf,Lb);Lb.id=Jd;Lb.setAttribute(A.a.RP,"true");Jd=D.qz(ai.a.f0i);Jd.appendChild(Lb);ea.appendChild(Jd);ea.appendChild(K)};Ek.Object.defineProperties(D.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PdfPrintDialog"}}});D.X5c=1;D.W5c=0;D.c6b=100;D.asb=9;D.Q5c=!0;D.aNg=13;D.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];D.KVi=[1205,1206,1213,1207,1208,1209,1210,1211,1204,1214,1215,1216,1217,1218,1219,1220];D.scalingOptions=[0,1,2,3];D.Mjj=[1221,1222,1223,
1224];D.kad=["Content-Type"];Object(ve.a)(D,"PdfPrintDialog",ma,[]);Ek.Object.defineProperties(F.prototype,{Vv:{configurable:!0,enumerable:!0,get:function(){return this.P6},set:function(K){0<=K&&2>=K?this.P6=K:(Ed.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.P6=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.$7d},set:function(K){K||!K?this.$7d=K:Ed.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});
Object(ve.a)(F,"PdfPrintDialogBrowserSessionState",null,[]);var Fh=b(1432);Object(ve.a)(aa,"MacroRecorderPrintAreaSetPayload",null,[445]);Object(ve.a)(U,"MacroRecorderPageBreakInsertedPayload",null,[445]);Object(ve.a)(ca,"MacroRecorderPageBreakRemovedPayload",null,[445]);L.prototype.getSheetName=function(){return this.sheetName};Object(ve.a)(L,"MacroRecorderPageBreaksAllResetPayload",null,[445]);P.prototype.getSheetName=function(){return this.sheetName};Object(ve.a)(P,"MacroRecorderPrintAreaClearedPayload",
null,[445]);var kk=b(169),ek=b(293);Object(ve.a)(Q,"PageBreaksInformation",null,[]);Object(ve.a)(M,"RowColBreak",null,[]);Object(ve.a)(z,"SharedRange",null,[]);var nl=b(170);B.prototype.executeCommand=function(K,ea,Ta,Lb,xc,qd,Jd){xc=void 0===xc?null:xc;qd=void 0===qd?null:qd;Jd=void 0===Jd?null:Jd;this.VWd();this.ribbonCommandInfo=ea;this.ADj(ea.command);K=Lg.b(xc,this.tLj);Ed.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",ea.command);switch(ea.command){case 78661008:return this.Q5e(ea,
K,qd,Jd,!1);case 275604654:return this.Q5e(ea,K,qd,Jd,!0);case -13332329:return this.Q4e(ea,K,qd,Jd);case -837651977:return this.I2h(ea,K,qd,Jd);case -1778266776:return this.B3h(ea,K,qd,Jd);case 845325699:return this.L5e(ea,K,qd,Jd)}return lf.a(ea.command)};B.prototype.Lc=function(K,ea){switch(ea.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===K;case 845325699:case -13332329:return!0}return!1};B.prototype.k_f=function(K,ea,Ta){var Lb=Tg.g(this.$),xc=Lb.Ea,qd=sd.r(Lb.ha.sa.selectedRanges,
this.$);if((xc=xc.hF())&&xc.length){xc=El(xc);for(var Jd=xc.next();!Jd.done;Jd=xc.next()){Jd=Jd.value;var De=Jd.Ef;if(De){for(var Ve=sd.j(Jd.uf),sg=[],mh=El(qd.Ranges),Zh=mh.next();!Zh.done;Zh=mh.next()){var Ci=Zh.value;Ci.FirstRow>Ve.LastRow+1||Ci.LastRow<Ve.FirstRow||Ci.FirstColumn>Ve.LastColumn+1||Ci.LastColumn<Ve.FirstColumn||(Zh=this.CUh(Ve,Ci,De),Ci=this.BUh(Ve,Ci,De),sg.push(Object(jh.a)(new z,{FirstRow:Zh.FirstRow,FirstColumn:Ci.FirstColumn,LastRow:Zh.LastRow,LastColumn:Ci.LastColumn})))}0<
sg.length&&!Ta?De.setPrintArea(sg):0<sg.length&&Ta?De.addToPrintArea(sg):!Ta&&De.hasPrintArea()&&De.clearPrintArea();!De.isDirty()&&De.hasPageLayout()&&De.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Jd.ae,4)}}this.INb(Lb,K,ea)}};B.prototype.cYg=function(K,ea){var Ta=Tg.g(this.$),Lb=Tg.g(this.$).Ea.hF();if(Lb&&Lb.length){Lb=El(Lb);for(var xc=Lb.next();!xc.done;xc=Lb.next()){xc=xc.value;var qd=xc.Ef;qd&&(qd.clearPrintArea(),!qd.isDirty()&&qd.hasPageLayout()&&qd.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+
xc.ae,4))}this.INb(Ta,K,ea)}};B.prototype.Ibi=function(K,ea){var Ta=Tg.g(this.$),Lb=Ta.Ea,xc=sd.o(Ta.ha.sa.activeCell,this.$);if(xc){var qd=Lb.hF();if(qd&&qd.length){Lb=null;for(var Jd=El(qd),De=Jd.next();!De.done;De=Jd.next()){De=De.value;var Ve=De.Ef;if(Ve){var sg=sd.j(De.uf);if(!(xc.FirstRow>sg.LastRow||xc.FirstRow<sg.FirstRow||xc.FirstColumn>sg.LastColumn||xc.FirstColumn<sg.FirstColumn)&&(Lb=this.b8g(Ve,sg,xc),Ve.insertPageBreak(Lb),!Ve.isDirty()&&Ve.hasPageLayout()&&Ve.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+
De.ae,4),Lb))break}}if(!Lb)for(qd=El(qd),De=qd.next();!De.done;De=qd.next())if(Lb=De.value,Jd=Lb.Ef)Lb=sd.j(Lb.uf),Lb=this.nEe(Jd,Lb,xc),Jd.insertPageBreak(Lb);this.INb(Ta,K,ea)}}};B.prototype.f$i=function(K,ea){var Ta=Tg.g(this.$),Lb=Ta.Ea,xc=sd.o(Ta.ha.sa.activeCell,this.$);if(xc&&(Lb=Lb.hF())&&Lb.length){Lb=El(Lb);for(var qd=Lb.next();!qd.done;qd=Lb.next()){qd=qd.value;var Jd=qd.Ef;if(Jd){var De=sd.j(qd.uf);(De=this.nEe(Jd,De,xc))&&Jd.removePageBreak(De);!Jd.isDirty()&&Jd.hasPageLayout()&&Jd.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+
qd.ae,4)}}this.INb(Ta,K,ea)}};B.prototype.dfj=function(K,ea){var Ta=Tg.g(this.$),Lb=Ta.Ea.hF();if(Lb&&Lb.length){Lb=El(Lb);for(var xc=Lb.next();!xc.done;xc=Lb.next()){xc=xc.value;var qd=xc.Ef;qd&&(qd.resetAllPageBreak(),!qd.isDirty()&&qd.hasPageLayout()&&qd.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+xc.ae,4))}this.INb(Ta,K,ea)}};B.prototype.Q5e=function(K,ea,Ta,Lb,xc){if(!xc){var qd=this.$.Hb.getItemByName("PRINT_AREA");if(qd&&(Ed.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",
qd.type),2===qd.type))return this.pdi(),Ch.Task.Sa(!0)}qd=Tg.g(this.$).ha.sa;var Jd=sd.r(qd.selectedRanges,this.$);if(1===Jd.Ranges.length&&!xc){if(qd.Jba())return this.Q3h(K,Jd,ea,Ta,Lb,xc),Ch.Task.Sa(!0);if(sd.R(Jd.Ranges[0]))return this.$.xa.qa.hasPrintArea?this.Q4e(K,ea,Ta,Lb):Ch.Task.Sa(!0)}this.k_f(K.command,Lb,xc);return this.Kaf(K,ea,Ta,Jd,xc)};B.prototype.Q4e=function(K,ea,Ta,Lb){this.cYg(K.command,Lb);return this.bdi(K,ea,Ta)};B.prototype.I2h=function(K,ea,Ta,Lb){this.Ibi(K.command,Lb);
return this.mdi(K,ea,Ta)};B.prototype.B3h=function(K,ea,Ta,Lb){var xc=sd.r(Tg.g(this.$).ha.sa.selectedRanges,this.$);if(sd.R(xc.Ranges[0]))return this.L5e(K,ea,Ta,Lb);this.f$i(K.command,Lb);return this.qdi(K,ea,Ta)};B.prototype.L5e=function(K,ea,Ta,Lb){this.dfj(K.command,Lb);return this.tdi(K,ea,Ta)};B.prototype.Kaf=function(K,ea,Ta,Lb,xc){function qd(){return new aa(Lb,xc)}function Jd(Ve,sg,mh){Ve=Lg.b(Ve,ea);sg=Lg.a(sg,Ta);var Zh=De.Na(1,null);Zh.selectedRanges=Lb;Zh.addToPrintArea=xc;return qe.i(De,
"SetPrintArea",Zh,Ve,sg,mh,null,0)}var De=this.$.na.ua;return hf.EwaSettings.qc()?tb.a(this.$.userOperationManager,Jd,function(Ve){return new $c.a(241,0,Ve,64,qd)},K):tb.a(this.$.userOperationManager,Jd,function(Ve){return new Uj.a(241,0,Ve,void 0,qd)},K)};B.prototype.bdi=function(K,ea,Ta){function Lb(){return new P(qd)}function xc(De,Ve,sg){De=Lg.b(De,ea);Ve=Lg.a(Ve,Ta);var mh=Jd.Na(1,null);mh.sheetName=qd;return qe.i(Jd,"ClearPrintArea",mh,De,Ve,sg,null,0)}var qd=this.$.xa.qa.name,Jd=this.$.na.ua;
return hf.EwaSettings.qc()?tb.a(this.$.userOperationManager,xc,function(De){return new $c.a(243,0,De,64,Lb)},K):tb.a(this.$.userOperationManager,xc,function(De){return new Uj.a(243,0,De,void 0,Lb)},K)};B.prototype.mdi=function(K,ea,Ta){function Lb(){return new U(De)}function xc(Ve,sg,mh){var Zh=qd.$.na.ua;Ve=Lg.b(Ve,ea);sg=Lg.a(sg,Ta);var Ci=Zh.Na(9,null);Ci.sheetCell=De;return qe.i(Zh,"InsertPageBreak",Ci,Ve,sg,mh,null,0)}var qd=this,Jd=Tg.g(this.$),De=sd.o(Jd.ha.sa.activeCell,this.$);return hf.EwaSettings.qc()?
tb.a(this.$.userOperationManager,xc,function(Ve){return new $c.a(244,0,Ve,64,Lb)},K):tb.a(this.$.userOperationManager,xc,function(Ve){return new Uj.a(244,0,Ve,void 0,Lb)},K)};B.prototype.qdi=function(K,ea,Ta){function Lb(){return new ca(De)}function xc(Ve,sg,mh){var Zh=qd.$.na.ua;Ve=Lg.b(Ve,ea);sg=Lg.a(sg,Ta);var Ci=Zh.Na(9,null);Ci.sheetCell=De;return qe.i(Zh,"RemovePageBreak",Ci,Ve,sg,mh,null,0)}var qd=this,Jd=Tg.g(this.$),De=sd.o(Jd.ha.sa.activeCell,this.$);return hf.EwaSettings.qc()?tb.a(this.$.userOperationManager,
xc,function(Ve){return new $c.a(245,0,Ve,64,Lb)},K):tb.a(this.$.userOperationManager,xc,function(Ve){return new Uj.a(245,0,Ve,void 0,Lb)},K)};B.prototype.tdi=function(K,ea,Ta){function Lb(){return new L(Jd)}function xc(De,Ve,sg){var mh=qd.$.na.ua;De=Lg.b(De,ea);Ve=Lg.a(Ve,Ta);var Zh=mh.Na(9,null);Zh.sheetName=Jd;return qe.i(mh,"ResetAllPageBreaks",Zh,De,Ve,sg,null,0)}var qd=this,Jd=this.$.xa.qa.name;return hf.EwaSettings.qc()?tb.a(this.$.userOperationManager,xc,function(De){return new $c.a(246,0,
De,64,Lb)},K):tb.a(this.$.userOperationManager,xc,function(De){return new Uj.a(246,0,De,void 0,Lb)},K)};B.prototype.CUh=function(K,ea,Ta){if(!K||!ea||!Ta)return null;var Lb=new z;Lb.FirstRow=ea.FirstRow===K.LastRow+1?Ta.getRowIndex(K.LastRow+1)+1:ea.FirstRow<K.FirstRow?0:Ta.getRowIndex(ea.FirstRow+1);Lb.LastRow=ea.FirstRow===K.LastRow+1||ea.LastRow>K.LastRow?Ta.getRowIndex(K.LastRow+1)+1:Ta.getRowIndex(ea.LastRow+1);return Lb};B.prototype.BUh=function(K,ea,Ta){if(!K||!ea||!Ta)return null;var Lb=new z;
Lb.FirstColumn=ea.FirstColumn===K.LastColumn+1?Ta.getColumnIndex(K.LastColumn+1)+1:ea.FirstColumn<K.FirstColumn?0:Ta.getColumnIndex(ea.FirstColumn+1);Lb.LastColumn=ea.FirstColumn===K.LastColumn+1||ea.LastColumn>K.LastColumn?Ta.getColumnIndex(K.LastColumn+1)+1:Ta.getColumnIndex(ea.LastColumn+1);return Lb};B.prototype.b8g=function(K,ea,Ta){if(!ea||!Ta||!K)return null;var Lb=K.getPrintArea();if(!Lb||!Lb.length)return null;var xc=K.getRowIndex(Ta.FirstRow+1),qd=K.getColumnIndex(Ta.FirstColumn+1),Jd=null,
De=null;Lb=El(Lb);for(var Ve=Lb.next();!Ve.done;Ve=Lb.next())if(Ve=Ve.value,xc>=Ve.FirstRow&&xc<=Ve.LastRow&&qd>=Ve.FirstColumn&&qd<=Ve.LastColumn){if(Ta.FirstRow===Ve.FirstRow&&Ta.FirstColumn===Ve.FirstColumn)return new Q;xc>Ve.FirstRow&&(Jd=Object(jh.a)(new M,{Index:xc-1,Min:Ve.FirstColumn-1,Max:Math.min(Ve.LastColumn,K.getColumnIndex(ea.LastColumn+1))}));qd>Ve.FirstColumn&&(De=Object(jh.a)(new M,{Index:qd-1,Min:Ve.FirstRow-1,Max:Math.min(Ve.LastRow,K.getRowIndex(ea.LastRow+1))}));break}return Jd||
De?Object(jh.a)(new Q,{Row:Jd?[Jd]:null,Col:De?[De]:null}):null};B.prototype.q9g=function(K,ea,Ta){if(!ea||!Ta||!K)return null;var Lb=null;Ta.FirstRow>ea.FirstRow&&Ta.FirstRow<=ea.LastRow?Lb=Object(jh.a)(new M,{Index:K.getRowIndex(Ta.FirstRow+1)-1,Min:-1,Max:-1}):Ta.FirstRow===ea.LastRow+1&&(Lb=Object(jh.a)(new M,{Index:K.getRowIndex(ea.LastRow+1),Min:-1,Max:-1}));return Lb};B.prototype.O4g=function(K,ea,Ta){if(!ea||!Ta||!K)return null;var Lb=null;Ta.FirstColumn>ea.FirstColumn&&Ta.FirstColumn<=ea.LastColumn?
Lb=Object(jh.a)(new M,{Index:K.getColumnIndex(Ta.FirstColumn+1)-1,Min:-1,Max:-1}):Ta.FirstColumn===ea.LastColumn+1&&(Lb=Object(jh.a)(new M,{Index:K.getColumnIndex(ea.LastColumn+1),Min:-1,Max:-1}));return Lb};B.prototype.nEe=function(K,ea,Ta){if(!Ta||!K||!ea)return null;var Lb=this.q9g(K,ea,Ta);K=this.O4g(K,ea,Ta);return Lb||K?Object(jh.a)(new Q,{Row:Lb?[Lb]:null,Col:K?[K]:null}):null};B.prototype.pdi=function(){var K=new Gh.StandardDialog;K.jc=0;K.Dc(1,Kc.a.instance.fa(4));K.yk(Kc.a.instance.fa(571),
Kc.a.instance.fa(572),1,null)};B.prototype.ADj=function(K){if(this.Gva.xb(K)&&(Hh.HelperMethods.n_&&(this.wFb=this.$.Ob.Gc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.NKa.xb(K)&&this.NKa.remove(K),this.NKa.add(K,Eg.a.create().toString()),Tg.g(this.$).Ji)){var ea=Sj.b()?Sj.b().ri(K):"";Tg.g(this.$).Ji.K7(this.Gva.oa(K),this.NKa.oa(K),ea)}};B.prototype.iWg=function(K){if(this.wFb&&K){var ea=this.wFb.Bc;this.wFb.stop();this.wFb=null;switch(K){case "SetPrintArea":this.Ypb(ea,1700,K);break;
case "ClearPrintArea":this.Ypb(ea,1500,K);break;case "InsertPageBreak":this.Ypb(ea,1500,K);break;case "RemovePageBreak":this.Ypb(ea,1600,K);break;case "ResetAllPageBreaks":this.Ypb(ea,1700,K)}}};B.prototype.Ypb=function(K,ea,Ta){K>ea&&(ea=Object(jh.a)(new ek.a,{extendedProperties:new Map}),ea.extendedProperties.set("OperationName",Ta),ea.extendedProperties.set("OperationExecutionTime",K.toString()),Ke.Health.instance.recordQosError(kk.a.kCj,[Sc.a.fCj],!1,!0,!0,!1,ea))};B.prototype.Q3h=function(K,
ea,Ta,Lb,xc,qd){var Jd=this,De=new Gh.StandardDialog,Ve=new Fh.a(Kc.a.instance.fa(569),Kc.a.instance.fa(570),Kc.a.instance.fa(6),Kc.a.instance.fa(5));De.jc=1;De.Dc(1,Ve.confirmButton);De.Dc(0,Ve.cancelButton);De.yk(Ve.title,Ve.body,3,function(sg){1===sg&&(Jd.k_f(K.command,xc,qd),Jd.Kaf(K,Ta,Lb,ea,qd))})};B.prototype.INb=function(K,ea,Ta){Ta();this.NKa.xb(ea)&&K.Ji.U0(this.NKa.oa(ea),Mk.BasicTelemetryCalculator.iR)};B.prototype.VWd=function(){this.Xpd&&this.$.Xd(-1753588160,-1,0,null)};Object(ve.a)(B,
"PrintAreaBreakManager",null,[619]);var Jk=b(409);E.prototype.equals=function(K){return K?this.orientation===K.orientation&&this.Eca===K.Eca&&this.D0===K.D0&&this.margin===K.margin&&this.sheetPrintOptions===K.sheetPrintOptions&&this.H1a===K.H1a&&this.NoColor===K.NoColor:!1};E.mCe=function(K,ea){K&&ea&&(ea.Vv=K.Vv,ea.orientation=K.orientation,ea.Eca=K.Eca,ea.D0=K.D0,ea.margin=K.margin,ea.ignorePrintArea=K.ignorePrintArea,ea.sheetPrintOptions=K.sheetPrintOptions,ea.H1a=K.H1a,ea.NoColor=K.NoColor)};
Object(ve.a)(E,"PrintSettingsContainer",null,[]);var xj=b(158),Vj=b(357),Qj=b(1023),qi=b(991),Ej=b(738);Object(ve.a)(y,"PrintSettingMarginOption",null,[]);Object(ve.a)(t,"PrintSettingMarginValue",null,[]);Object(ve.a)(u,"PrintSettingOption",null,[]);v.prototype.dispose=function(){};v.prototype.$vb=function(K){if(!K)return null;var ea=new t;ea.left=K.Left;ea.right=K.Right;ea.top=K.Top;ea.bottom=K.Bottom;ea.header=K.Header;ea.footer=K.Footer;return ea};v.prototype.e4c=function(K){Ed.ULS.shipAssertTag(537154186,
0,6===K.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");var ea={};ea.Top=K[0];ea.Bottom=K[1];ea.Left=K[2];ea.Right=K[3];ea.Header=K[4];ea.Footer=K[5];return ea};v.prototype.vai=function(){this.rje=[Object(jh.a)(new u,{printSettingOptionKey:1,printSettingOptionText:this.Ym.fa(1200)}),Object(jh.a)(new u,{printSettingOptionKey:2,printSettingOptionText:this.Ym.fa(1193)}),Object(jh.a)(new u,{printSettingOptionKey:0,printSettingOptionText:this.Ym.fa(1192)})];
this.Qce=[Object(jh.a)(new u,{printSettingOptionKey:1,printSettingOptionText:this.Ym.fa(1203)}),Object(jh.a)(new u,{printSettingOptionKey:2,printSettingOptionText:this.Ym.fa(1202)})];this.gde=[Object(jh.a)(new u,{printSettingOptionKey:1,printSettingOptionText:this.Ym.fa(1205)}),Object(jh.a)(new u,{printSettingOptionKey:5,printSettingOptionText:this.Ym.fa(1206)}),Object(jh.a)(new u,{printSettingOptionKey:6,printSettingOptionText:this.Ym.fa(1213)}),Object(jh.a)(new u,{printSettingOptionKey:7,printSettingOptionText:this.Ym.fa(1207)}),
Object(jh.a)(new u,{printSettingOptionKey:8,printSettingOptionText:this.Ym.fa(1208)}),Object(jh.a)(new u,{printSettingOptionKey:9,printSettingOptionText:this.Ym.fa(1209)}),Object(jh.a)(new u,{printSettingOptionKey:11,printSettingOptionText:this.Ym.fa(1210)}),Object(jh.a)(new u,{printSettingOptionKey:12,printSettingOptionText:this.Ym.fa(1211)}),Object(jh.a)(new u,{printSettingOptionKey:13,printSettingOptionText:this.Ym.fa(1212)}),Object(jh.a)(new u,{printSettingOptionKey:3,printSettingOptionText:this.Ym.fa(1204)})];
this.Kfe=[Object(jh.a)(new u,{printSettingOptionKey:0,printSettingOptionText:this.Ym.fa(1221)}),Object(jh.a)(new u,{printSettingOptionKey:1,printSettingOptionText:this.Ym.fa(1222)}),Object(jh.a)(new u,{printSettingOptionKey:2,printSettingOptionText:this.Ym.fa(1223)}),Object(jh.a)(new u,{printSettingOptionKey:3,printSettingOptionText:this.Ym.fa(1224)})];this.Rae=[Object(jh.a)(new y,{printSettingOption:Object(jh.a)(new u,{printSettingOptionKey:0,printSettingOptionText:this.Ym.fa(1227)}),marginValue:this.$vb(this.normal)}),
Object(jh.a)(new y,{printSettingOption:Object(jh.a)(new u,{printSettingOptionKey:1,printSettingOptionText:this.Ym.fa(1228)}),marginValue:this.$vb(this.wide)}),Object(jh.a)(new y,{printSettingOption:Object(jh.a)(new u,{printSettingOptionKey:2,printSettingOptionText:this.Ym.fa(1229)}),marginValue:this.$vb(this.narrow)}),Object(jh.a)(new y,{printSettingOption:Object(jh.a)(new u,{printSettingOptionKey:3,printSettingOptionText:this.Ym.fa(1230)}),marginValue:this.$vb(this.O6)})]};v.prototype.oai=function(){this.normal=
this.e4c(this.VCi);this.narrow=this.e4c(this.IBi);this.wide=this.e4c(this.vWj)};Ek.Object.defineProperties(v.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.rje}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.Qce}},paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.gde}},scalingOptions:{configurable:!0,enumerable:!0,get:function(){return this.Kfe}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.Rae}}});
v.sch=1;v.fch=1;v.asb=9;v.kch=2;v.dch=0;v.Xbh=!1;v.Tbh=!1;v.jIa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(ve.a)(v,"PrintSettingsManagerBase",null,[3]);var lk=b(125);n.prototype.getSheetName=function(){return this.sheetName};Object(ve.a)(n,"MacroRecorderSheetPrintOptionsSavedPayload",null,[445]);Am(w,v);w.prototype.gdi=function(K){var ea=this;this.hdi(function(Ta){K&&(Ta=ea.HUh(Ta),K(Ta))})};w.prototype.zMd=function(K,ea){if(K){var Ta=new F(K.Vv,K.ignorePrintArea);
this.ejj(Ta);!ea||this.E4f?Ed.ULS.sendTraceTag(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",ea?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"):(ea=this.JUh(K.D0),ea.IsLandscape=2===K.orientation,ea.PaperSize=K.Eca,this.isUniversalPrintEnabled&&(ea.NoColor=K.NoColor),ea.PageMargin=this.dgd(K.margin),ea.SheetPrintOptions=v.jIa,ea.SheetPrintOptions.PrintGrid=K.sheetPrintOptions.PrintGrid,ea.SheetPrintOptions.HorizontalCenter=
K.sheetPrintOptions.HorizontalCenter,ea.SheetPrintOptions.VerticalCenter=K.sheetPrintOptions.VerticalCenter,ea.SheetPrintOptions.PrintHeaders=K.sheetPrintOptions.PrintHeaders,this.djj(ea))}else Ed.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};w.prototype.dgd=function(K){var ea={};0===K?ea=this.normal:1===K?ea=this.wide:2===K?ea=this.narrow:3===K&&(ea=this.O6);return ea};w.prototype.xdi=function(K){var ea=this;if(K){Ed.ULS.sendTraceTag(537154197,
0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Ta=function(){return new n(ea.$.xa.qa.name,K)},Lb=this.$.na.ua,xc=this.$.na.ua.hc(),qd=function(Jd,De,Ve){var sg=ea.$.xa.qa.name;Jd=Lg.b(ea.uBd,Jd);De=Lg.a(ea.GBd,De);var mh=Lb.Na(1,null);mh.sheetName=sg;mh.printOptions=K;return qe.i(Lb,"SetPrintOptions",mh,Jd,De,Ve,xc,0)};Ta=hf.EwaSettings.qc()?new $c.a(598,0,qd,64,Ta):new Uj.a(598,0,qd,void 0,Ta);this.$.userOperationManager.ic(Ta,null)}else Ed.ULS.sendTraceTag(537154198,
0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};w.prototype.dispose=function(){this.Od||(this.Od=!0,this.$.userOperationManager.Cr(this.JF),this.zY())};w.prototype.ejj=function(K){this.cO.Vv=K.Vv;this.cO.ignorePrintArea=K.ignorePrintArea};w.prototype.hdi=function(K){function ea(De,Ve,sg){return Z(xc.$.na.ua,xc.sheetName,xc.locale,Lg.b(De,Lb),Lg.a(Ve,Ta),sg,qd)}function Ta(De){De=Dj.a.pg(De.data);Ed.ULS.sendTraceTag(537154194,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",
$g.a.Wc(De));K(null)}function Lb(De){Bi.a(De)?Ed.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",$g.a.Wc(De.Errors)):(Ed.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),K(De.Result))}var xc=this,qd=this.$.na.ua.hc();var Jd=hf.EwaSettings.qc()?new $c.a(247,0,ea,80):new Uj.a(247,0,ea,16);Jd=this.$.userOperationManager.ic(Jd,null);this.zv.add(Jd)};w.prototype.djj=
function(K){var ea=this;Ed.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var Ta=this.$.na.ua.hc();this.$.userOperationManager.ic(new $c.a(226,0,function(Lb,xc,qd){return ka(ea.$.na.ua,ea.sheetName,K,Lg.b(Lb,ea.xQi),Lg.a(xc,ea.wQi),qd,Ta)},void 0,function(){return new J(ea.sheetName,K)}),null)};w.prototype.wki=function(K){return this.Zbf(K)||!this.bff(K.PaperSize)};w.prototype.Wad=function(K){this.Zbf(K)&&(Ed.ULS.sendTraceTag(537154192,
0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),K.ScalingWidth=w.X5c,K.ScalingHeight=w.W5c,K.ScalingPercent=w.c6b,K.FitToPage=w.Q5c);this.bff(K.PaperSize)||(Ed.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",K.PaperSize.toString()),K.PaperSize=w.asb);return K};w.prototype.FUh=function(K){if(K.FitToPage){if(1===K.ScalingWidth&&1===K.ScalingHeight)return 1;
if(!K.ScalingWidth&&1===K.ScalingHeight)return 3}else return 0;return 2};w.prototype.EUh=function(K){return this.Hpd(K,this.normal)?0:this.Hpd(K,this.wide)?1:this.Hpd(K,this.narrow)?2:3};w.prototype.Hpd=function(K,ea){return K.Left===ea.Left&&K.Right===ea.Right&&K.Top===ea.Top&&K.Bottom===ea.Bottom&&K.Header===ea.Header&&K.Footer===ea.Footer};w.prototype.JUh=function(K){var ea={};ea.ScalingPercent=w.c6b;ea.FitToPage=0!==K;2===K?(ea.ScalingWidth=1,ea.ScalingHeight=0):3===K?(ea.ScalingWidth=0,ea.ScalingHeight=
1):1===K&&(ea.ScalingWidth=1,ea.ScalingHeight=1);return ea};w.prototype.bff=function(K){return this.JVi.contains(K.toString())};w.prototype.Zbf=function(K){return 100!==K.ScalingPercent||K.FitToPage&&(1<K.ScalingWidth||1<K.ScalingHeight)};w.prototype.F2g=function(){for(var K=new Ej.a(Ea.a.Pk()),ea=0;ea<this.paperSizeOptions.length;ea++)K.add(this.paperSizeOptions[ea].printSettingOptionKey.toString());return K};w.prototype.HUh=function(K){var ea=null;if(K){var Ta=this.cO.Vv,Lb=this.cO.ignorePrintArea;
this.wki(K)&&(this.E4f=!0,K=this.Wad(K));ea=new E;ea.Vv=Ta;ea.ignorePrintArea=Lb;ea.orientation=K.IsLandscape?2:1;ea.Eca=K.PaperSize;ea.D0=this.FUh(K);ea.sheetPrintOptions=v.jIa;ea.sheetPrintOptions.PrintGrid=K.SheetPrintOptions.PrintGrid;ea.H1a=K.Draft;this.isUniversalPrintEnabled&&(ea.NoColor=K.NoColor);ea.sheetPrintOptions.HorizontalCenter=K.SheetPrintOptions.HorizontalCenter;ea.sheetPrintOptions.VerticalCenter=K.SheetPrintOptions.VerticalCenter;ea.sheetPrintOptions.PrintHeaders=K.SheetPrintOptions.PrintHeaders;
ea.margin=this.EUh(K.PageMargin);hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&Ed.ULS.sendTraceTag(553965398,0,50,"PageMargin received : {0}",ea.margin);3===ea.margin&&(this.O6={},this.O6.Left=K.PageMargin.Left,this.O6.Right=K.PageMargin.Right,this.O6.Top=K.PageMargin.Top,this.O6.Bottom=K.PageMargin.Bottom,this.O6.Header=K.PageMargin.Header,this.O6.Footer=K.PageMargin.Footer)}return ea};w.prototype.zY=function(){if(this.zv){for(var K=El(this.zv),ea=K.next();!ea.done;ea=
K.next())ea=ea.value,this.$&&this.$.userOperationManager&&(ea.operation&&Ed.ULS.sendTraceTag(537154187,0,50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",lk.a(ea.operation.operationName)),this.$.userOperationManager.oIa(ea)),this.zv.remove(ea);this.zv=null}};w.X5c=1;w.W5c=0;w.c6b=100;w.asb=9;w.Q5c=!0;Object(ve.a)(w,"PrintSettingsManager",v,[]);Object(ve.a)(h,"PrintSettingsTaskPaneCallbacks",null,[]);Object(ve.a)(r,"SelectedPrintSettings",null,[]);Object(ve.a)(m,
"PrintOperationCallbacks",null,[]);Object(ve.a)(l,"PrintPreviewPaneCallbacks",null,[]);var nk=b(1255);Object(ve.a)(f,"UniversalPrintAppSettings",null,[]);var Qk=b(393);e.prototype.iGg=function(K){this.Pa.addHandler("ppocek",K)};e.prototype.Rbj=function(K){this.Pa.removeHandler("ppocek",K)};e.prototype.jAj=function(K,ea){this.Afj();this.$.userOperationManager.Vu(this.JF);this.Um=K;this.Pa.raiseEvent("ppocek");this.Um.SelectedRanges&&this.Um.SelectedRanges.Ranges&&0<this.Um.SelectedRanges.Ranges.length&&
this.Um.SelectedRanges.Ranges[0]&&(this.selectedRange=sd.B(this.Um.SelectedRanges.Ranges[0]).toString());Ed.ULS.shipAssertTag(537154268,0,!this.Av,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.Av=new w(this,this.$,ea,this.$.xa.qa.name,Kc.a.instance,this.isUniversalPrintEnabled);Ed.ULS.shipAssertTag(537154267,0,!this.wg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.wg=new qi.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);
this.wg.Zfh();this.wg.lAj();this.wg.AFg(this.Kzf)};e.prototype.TRh=function(){this.Av.O6&&4<=this.Av.marginDetailedOptions.length&&(this.Av.marginDetailedOptions[3].marginValue=this.Av.$vb(this.Av.O6));return this.Av.marginDetailedOptions};e.prototype.fxc=function(){return!!this.Um&&!!this.Um.ObjectId||!Tg.g(this.$).ha.sa.Ig};e.prototype.KUh=function(){var K=Object(jh.a)(new r,{selectedWhatToPrint:v.sch,selectedOrientation:v.fch,selectedPaperSize:v.asb,selectedScaling:v.kch,selectedMargin:v.dch,selectedIgnorePrintArea:v.Xbh,
selectedPrintGridlines:v.jIa.PrintGrid,selectedDraft:v.Tbh,selectedHorizontalCenter:v.jIa.HorizontalCenter,selectedVerticalCenter:v.jIa.VerticalCenter,selectedRowAndColumnHeadings:v.jIa.PrintHeaders});this.OH?(K.selectedWhatToPrint=this.OH.Vv,K.selectedOrientation=this.OH.orientation,K.selectedPaperSize=this.OH.Eca,K.selectedScaling=this.OH.D0,K.selectedMargin=this.OH.margin,K.selectedIgnorePrintArea=this.OH.ignorePrintArea,K.selectedPrintGridlines=this.OH.sheetPrintOptions.PrintGrid,K.selectedDraft=
this.OH.H1a,this.isUniversalPrintEnabled&&(K.selectedColor=this.OH.NoColor?0:1),K.selectedHorizontalCenter=this.OH.sheetPrintOptions.HorizontalCenter,K.selectedVerticalCenter=this.OH.sheetPrintOptions.VerticalCenter,K.selectedRowAndColumnHeadings=this.OH.sheetPrintOptions.PrintHeaders):Ed.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return K};e.prototype.Z0e=function(){var K=this;return Object(jh.a)(new l,{onBackToSheet:function(){K.Qla()}})};
e.prototype.GUh=function(){var K=this;return Object(jh.a)(new nk.a,{backActionButtonText:Kc.a.instance.fa(1180),printPreviewPaneCallbacks:this.Z0e(),logger:new Jk.a,disableTellMeControl:!0,printOperationCallbacks:Object(jh.a)(new m,{onClosePreviewer:function(){K.Qla()},getGraphServiceAuthorizationToken:this.hac(),onLocalPrint:function(){K.xAf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object(jh.a)(new f,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.Fei()?
"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})};e.prototype.IUh=function(){var K=this;return Object(jh.a)(new h,{onSettingChange:function(ea){K.nPi(ea)},onPrint:function(){K.xAf()}})};e.prototype.nPi=function(K){this.i0++;K?(this.wg&&this.wg.cBj(),this.wk.Vv=K.selectedWhatToPrint,this.wk.D0=K.selectedScaling,this.wk.orientation=K.selectedOrientation,this.wk.Eca=K.selectedPaperSize,this.wk.margin=K.selectedMargin,this.isUniversalPrintEnabled&&
(this.wk.NoColor=!K.selectedColor),this.wk.ignorePrintArea=K.selectedIgnorePrintArea,this.Wqj(K.selectedPageStart,K.selectedPageEnd),this.Av&&this.W4h(this.wk,K)?(this.wk.sheetPrintOptions=v.jIa,this.wk.sheetPrintOptions.PrintGrid=K.selectedPrintGridlines,this.wk.sheetPrintOptions.HorizontalCenter=K.selectedHorizontalCenter,this.wk.sheetPrintOptions.VerticalCenter=K.selectedVerticalCenter,this.wk.sheetPrintOptions.PrintHeaders=K.selectedRowAndColumnHeadings,this.Av.xdi(this.wk.sheetPrintOptions)):
this.uyb()):Ed.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};e.prototype.Qla=function(){this.g6a&&(this.LMb=!0);Ed.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",this.i0);this.wAf();this.kye()};e.prototype.xAf=function(){Ed.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",
this.i0);hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&Ed.ULS.sendTraceTag(543024129,0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.wk.margin,this.OH.margin);if(this.useMSPdfViewer)this.qIf();else if(this.N6a)try{this.wg.printPdf(),this.d1c()}catch(K){Ed.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.qIf()}else this.lia.E3f(this.JHa(!0)),this.d1c()};
e.prototype.qIf=function(){var K=this.JHa(!0);this.d1c();Hh.HelperMethods.jf(K,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};e.prototype.dispose=function(){Qi.a.Ha(this.Pa)};e.prototype.uyb=function(){var K=this;if(this.$.zwa)this.ddi();else{this.zY();this.sTf();var ea=null;this.P$h();Ed.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var Ta=function(Lb,xc,qd){Lb=new Mi.a(Lb,null,xc,qd,null,!0,!1,"GetFileCopyFileHandler",
"");Lb.correlationID=Eg.a.create().toString();ea=Lb;K.Tba=K.l3.K9(K.JHa(K.N6a?!1:!0,K.xei?"Base64":"Pdf"),1,null,null,e.kad,!1,2,K.rAd,K.qAd,ea,void 0,void 0,void 0,12E4);Lb.requestId=K.Tba;Ed.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",K.Tba);return Ch.Task.Sa(!0)};this.qNa=hf.EwaSettings.qc()?this.$.userOperationManager.ic(new $c.a(223,0,Ta,80),null):this.$.userOperationManager.ic(new Uj.a(223,0,Ta,16),null)}};e.prototype.d1c=
function(){this.wAf();this.kye()};e.prototype.uBd=function(K){$g.a.lr(K.Errors)?this.wg.showErrorMessageForPrintOptions(Kc.a.instance.fa(1231)):(Ed.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.uyb(),this.wg&&this.wg.hideErrorMessageForPrintOptions())};e.prototype.GBd=function(K){this.wg&&this.wg.showErrorMessageForPrintOptions(Kc.a.instance.fa(1231));K=Dj.a.pg(K.data);Ed.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",
$g.a.Wc(K))};e.prototype.ddi=function(){function K(Lb,xc,qd){var Jd={};Jd.WhatToPrint=ea.wk.Vv;Jd.UseNamedAction=ea.lia.Fxc();Jd.SelectedSheetName=ea.$.xa.qa.name;Jd.ActiveCell=ea.activeCell;Jd.SelectedRanges=[ea.selectedRange];Jd.IsPdfDocumentRequired=!1;Jd.Orientation=ea.wk.orientation;Jd.PaperSize=ea.wk.Eca;Jd.Scaling=ea.wk.D0;Jd.RichValuesEnabled=!0;Jd.IgnorePrintArea=ea.wk.ignorePrintArea;Jd.Preview=!0;ea.isUniversalPrintEnabled&&(Jd.NoColor=ea.wk.NoColor);ea.h1f()&&(Jd.PaginationStartPage=ea.Uya,
Jd.PaginationEndPage=ea.mma,Jd.OutputTotalPdfPageCount=!0);var De=ea.Av.dgd(ea.wk.margin);De&&(Jd.PageMargin={},Jd.PageMargin.Top=De.Top,Jd.PageMargin.Bottom=De.Bottom,Jd.PageMargin.Left=De.Left,Jd.PageMargin.Right=De.Right,Jd.PageMargin.Header=De.Header,Jd.PageMargin.Footer=De.Footer);ea.P7a=W(ea.$.na.ua,Jd,Lg.b(ea.$Hi,Lb),Lg.a(ea.ZHi,xc),qd,Ta);return ea.P7a}var ea=this;Ed.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");
this.zY();var Ta=this.$.na.ua.hc();hf.EwaSettings.qc()?this.qNa=this.$.userOperationManager.ic(new $c.a(133,0,K,80),null):this.qNa=this.$.userOperationManager.ic(new Uj.a(133,0,K,16),null)};e.prototype.kye=function(){this.$.userOperationManager.Cr(this.JF);this.zY();this.sTf();Ed.ULS.shipAssertTag(537154261,0,!!this.wg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.wg&&(this.wg.tbj(this.Kzf),this.wg.hgh(),this.wg=null);this.Um=null;this.Av&&(this.Av.dispose(),
this.Av=null);this.g3a=this.JFb=null;this.zLc=!1;this.Pa&&this.Pa.raiseEvent("ppocek")};e.prototype.Vvj=function(){return this.$.isEditMode&&!!this.OH&&!!this.wk&&2!==this.wk.Vv&&this.vjd()};e.prototype.zMd=function(){Ed.ULS.shipAssertTag(537154260,0,!!this.Av,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.Av&&this.Av.zMd(this.wk,this.Vvj())};e.prototype.JHa=function(K,ea){ea=void 0===ea?"Pdf":ea;var Ta=new Sys.StringBuilder;Ta.append(vi.a(this.$,ea,!0));Xh.a.eh(Ta,
af.a.cGd,""+this.wk.Vv);K&&this.lia.Fxc()&&Xh.a.eh(Ta,af.a.deg,"1");Xh.a.eh(Ta,af.a.LJf,this.$.xa.qa.name);0===this.wk.Vv&&(Xh.a.eh(Ta,af.a.KJf,this.selectedRange),Xh.a.eh(Ta,af.a.EJf,this.activeCell));Xh.a.eh(Ta,af.a.FJf,""+this.wk.orientation);Xh.a.eh(Ta,af.a.GJf,""+this.wk.Eca);Xh.a.eh(Ta,af.a.JJf,""+this.wk.D0);Xh.a.eh(Ta,af.a.IJf,"1");Xh.a.eh(Ta,af.a.DJf,this.wk.ignorePrintArea?"1":"0");Xh.a.eh(Ta,af.a.HJf,"1");this.MJg(Ta);this.isUniversalPrintEnabled&&Xh.a.eh(Ta,af.a.a2i,this.wk.NoColor?"1":
"0");this.LJg(Ta);bh.a.equals(ea,"Pdf",!0)&&(Ta.append("&#toolbar=0"),Ta.append("&zoom=100"));K=Ta.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");Ed.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url {0}",K);return K};e.prototype.Wqj=function(K,ea){K||ea?(this.Myb=!0,this.Uya=K,this.mma=ea):this.ESf()};e.prototype.MJg=function(K){this.h1f()&&(Xh.a.eh(K,af.a.c2i,""+this.Uya),Xh.a.eh(K,af.a.b2i,""+this.mma),Xh.a.eh(K,af.a.d2i,"1"),Ed.ULS.sendTraceTag(537154258,
0,50,"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",this.Uya,this.mma))};e.prototype.h1f=function(){return null!=this.Uya&&0<this.Uya&&null!=this.mma&&0<this.mma};e.prototype.LJg=function(K){if(this.Av&&this.wk){var ea=this.Av.dgd(this.wk.margin);ea&&Xh.a.eh(K,af.a.$1i,""+ea.Top+" "+ea.Bottom+" "+ea.Left+" "+ea.Right+" "+ea.Header+" "+ea.Footer)}};e.prototype.bEb=function(K,ea,Ta,Lb){this.wg&&(Ed.ULS.shipAssertTag(537154255,0,!!this.$.xa.qa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),
this.$.xa.qa&&(this.N6a?(Lb||(Lb=this.JHa(!1)),this.wg.ssi(Lb)):this.dAj()))};e.prototype.vjd=function(){return!this.OH.equals(this.wk)};e.prototype.wAf=function(){!this.LMb&&0<this.i0&&(this.Ypd?this.zMd():Ed.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));Ed.ULS.shipAssertTag(537154250,0,!!this.wg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.wg&&this.wg.f6h();this.VWd()};
e.prototype.si=function(){Ed.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.wg){var K=this.cAa(Kc.a.instance.fa(1));this.Rna(K,1)}else K=$g.a.gd(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),hf.EwaSettings.Iz()?new Vj.a(this.$,K):(new xj.ErrorDialog(this.$,K)).kf()};e.prototype.kAj=function(K){K?(0===K.Vv&&this.fxc()&&(Ed.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",
this.Um.ObjectId?"floatingObject":"discontinuousRange"),K.Vv=1),E.mCe(K,this.OH),E.mCe(K,this.wk),Ed.ULS.shipAssertTag(537154248,0,!!this.wg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.wg&&(this.Ypd=!0,this.wg.mAj(),this.uyb())):(Ed.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.si())};e.prototype.Y_c=function(K,ea,Ta){K>ea&&(ea=Object(jh.a)(new ek.a,{extendedProperties:new Map}),ea.extendedProperties.set("WtpSelectedValue",
Ta),ea.extendedProperties.set("FullyRenderedPdfLoadTime",K.toString()),Ke.Health.instance.recordQosError(kk.a.iCj,[Sc.a.M4f],!1,!0,!0,!1,ea))};e.prototype.zY=function(){this.qNa&&(0<this.Tba||this.P7a)&&(Ed.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.Tba),this.$.userOperationManager.oIa(this.qNa),this.P7a?Dj.a.Du(this.P7a.Qt):this.l3.Du(this.Tba),this.dLd())};e.prototype.dLd=function(){this.P7a=this.qNa=null};e.prototype.P$h=
function(){this.rKd&&this.wk&&(this.g3a=this.$.Ob.Gc("UserAction",(1===this.wk.Vv?"ActiveSheet":0===this.wk.Vv?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))};e.prototype.ESf=function(){this.Myb=!1;this.Uya=1;this.mma=this.pFd};e.prototype.cAa=function(K){if(K)return K.replace("&#39;","'");Ed.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return K};e.prototype.dAj=function(){Ed.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");
if(this.Lzb)if(this.thc)Ed.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{var K=this.cAa(Kc.a.instance.fa(1185));this.Rna(K,2)}else K=this.cAa(Kc.a.instance.fa(1186)),this.Rna(K,3)};e.prototype.Rna=function(K,ea,Ta){this.wg.bA(K,ea,void 0===Ta?null:Ta)};e.prototype.$$h=function(){this.thc=this.Txe();this.Lzb=this.HWg();this.N6a=this.IWg();Ed.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentBrowser : {0}, isPdfPreviewSupportedInCurrentHost: {1}, isPdfPreviewSupportedInPreviewer: {2}",
this.thc,this.Lzb,this.N6a)};e.prototype.Afj=function(){this.M7a=null;this.dLd();this.ESf();this.JFb=this.$.Ob.Gc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.qa.activeCell.toString();this.i0=0;this.Ypd=this.g6a=this.LMb=!1;this.zLc=!0};e.prototype.Wxj=function(){var K=this.ani()||this.khf()&&hf.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!0:!1;Ed.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",K);return K};e.prototype.Txe=
function(){return!Af.a.uB};e.prototype.nWg=function(){var K=15;Af.a.XH&&Af.a.Nsb&&(K=parseFloat(Af.a.Nsb));return this.Txe()&&14<K&&this.Lzb};e.prototype.HWg=function(){return this.khf()&&!hf.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!1:!0};e.prototype.ani=function(){return Af.a.XC||he.AFrameworkApplication.isUnifiedHostMode};e.prototype.IWg=function(){return this.thc&&this.Lzb};e.prototype.khf=function(){return!this.$.Yf.get(111)};e.prototype.sTf=function(){this.M7a&&
(URL.revokeObjectURL(this.M7a),this.M7a=null)};e.prototype.D4g=function(K){var ea=K.data.ke;K=this.$.Ob.Gc("UserAction","PrintPreviewBlobFileCreation");var Ta=window.self.atob(ea);ea=new Uint8Array(ea.length);for(var Lb=0;Lb<Ta.length;Lb++)ea[Lb]=Ta.charCodeAt(Lb)&255;Ta=new Blob([ea],{type:"application/pdf"});this.M7a=URL.createObjectURL(Ta);Ed.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",K.Bc,Ta.size);
K.stop();return this.M7a+"#toolbar=0&zoom=100"};e.prototype.d6i=function(K){if(this.rKd&&$g.a.nh(K,e.WWi)){var ea=Object(jh.a)(new ek.a,{extendedProperties:new Map});ea.extendedProperties.set("ErrorMessageIdName",K[0].MessageIdName);Ke.Health.instance.recordQosError(kk.a.oIf,[Sc.a.pIf],!1,!0,!0,!1,ea)}};e.prototype.W4h=function(K,ea){return K.sheetPrintOptions.PrintGrid!==ea.selectedPrintGridlines||K.sheetPrintOptions.HorizontalCenter!==ea.selectedHorizontalCenter||K.sheetPrintOptions.VerticalCenter!==
ea.selectedVerticalCenter||K.sheetPrintOptions.PrintHeaders!==ea.selectedRowAndColumnHeadings};e.prototype.VWd=function(){this.Xpd&&this.$.Xd(-1753588160,-1,0,null)};e.prototype.Fei=function(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};e.prototype.getToken=function(){Ed.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.Uyd.US("Print",this.graphServiceEndpoint).then(function(K){return K?
(K.IsSuccess||Ed.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",K.ErrorCode,K.ErrorMessage),Ed.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"),K):Object(jh.a)(new Qj.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(K){var ea=new Qj.a;Object.getType(K)===Object.getType(ea)?ea=K:(ea.ErrorMessage=K.toString(),
ea.ErrorCode="exception");return Promise.resolve(ea)})};e.prototype.hac=function(){var K=this;return function(){var ea=Promise.resolve("");try{if(K.Uyd&&K.Uyd.V5a())return K.getToken().then(function(Ta){return Ta.IsSuccess?Promise.resolve(Ta.Token):ea},function(){return ea})}catch(Ta){Ed.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",Ta)}return ea}};e.prototype.onNotifyPrintJobStatus=function(K,ea){K=Qk.a.az.notificationBar.P$(K,
!1);"pending"==ea&&(K.displayTimeoutSeconds=3);if(hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactToast",!1))switch(ea){case "failure":K.image=1;break;case "success":K.image=3;break;default:K.image=0}else K.image=0;Qk.a.az.notificationBar.lE(K)};Ek.Object.defineProperties(e.prototype,{vki:{configurable:!0,enumerable:!0,get:function(){return this.zLc}}});e.WWi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,
1348242499,2030854436,-1831476778];e.kad=["Content-Type","Total-Pdf-PageCount"];Object(ve.a)(e,"PrintPreviewManager",null,[620,3,621]);c.prototype.Zc=function(){return!1};c.prototype.executeCommand=function(K,ea,Ta,Lb){var xc=ea.command;return 1588554917===xc?(ea.Vyb=!0,Hk.a(this.$)&&this.$.da.Aa(423).Xxc(!1),this.Hgh(ea)?Ch.Task.Sa(!0):lf.a(xc)):this.mIf.executeCommand(K,ea,Ta,Lb,this.TOi,this.SOi,this.mLj)};c.prototype.Lc=function(K,ea){return 1588554917===ea.command?(Ed.ULS.shipAssertTag(537154305,
0,this.$.uka,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.mIf.Lc(K,ea)};c.prototype.jd=function(){return!1};c.prototype.Hgh=function(K){return this.$.ea.sc?this.Igh(K):!1};c.prototype.Igh=function(K){Ed.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var ea=this.$.Ob.Gc("UserAction","DoPrintHtml"),Ta=this.$,Lb=this.ea.isNamedObjectViewMode?Ta.Hb.qa.sheetName:Ta.xa.qa.name,xc=this.ea.isNamedObjectViewMode,qd=!xc;Ta=this.DUh(Ta,Lb,
qd);var Jd=!0;!hf.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.zwa&&(Jd=!1);qd?Jd?dj.a(this.$)?Ed.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.vD.jAj(Ta,this.cO),Ed.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):((new D(this.$,Kc.a.instance.fa(1194),3,Ta,K,this.lia,Lb,this.cO)).kf(),Ed.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",
ea.Bc)):((new R(this.$,Kc.a.instance.fa(1194),3,Ta,K)).kf(),Ed.ULS.sendTraceTag(591196514,0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",ea.Bc,xc));ea.stop();this.Iid();return!0};c.prototype.DUh=function(K,ea,Ta){var Lb={};Lb.SessionId=this.ea.sessionId;Lb.UsedRangeTooBig=!1;var xc=Tg.g(K),qd=xc.ha,Jd=qd.Ue;if(sk.e(K.qa))Lb.Type=0,Lb.ObjectId=K.qa.name,Lb.UseSelection=!1;else if(sk.g(K.qa))Lb.Type=1,Lb.ObjectId=K.qa.wLa,Lb.UseSelection=
!0;else if(2===Jd||4===Jd||64===Jd)xc=qd.Oa.oc.floatingObject,Lb.Type=1,Lb.SheetName=ea,Lb.ObjectId=xc.id,Lb.UseSelection=!0;else if(Ta&&Jd&470)Lb.ObjectId=qd.Oa.oc.floatingObject.id,Lb.SheetName=ea;else if(sk.i(K.qa)){Lb.Type=2;Lb.SheetName=ea;if(qd.sa.Ig)if(Ta=qd.sa.qd,Lb.SelectedRanges=sd.q(Ta,K),20<Ta.uM)Lb.UseSelection=!0;else{ea=0;xc=xc.vk("PrintCommandHandler.DoPrintHtml",Ta);try{for(xc.$$rst();xc.$$mn()&&2>ea;)xc.$$cu().text&&ea++;Lb.UseSelection=2<=ea}finally{xc&&xc.dispose()}}else Lb.UseSelection=
!1,Lb.SelectedRanges=sd.q(qd.sa.activeRange,K);this.ea.isNamedObjectViewMode&&(Lb.UsedRange=sd.v(K.qa.usedRange,K))}Lb.Title=K.workbookContext.WorkbookFileName;return Lb};c.prototype.Iid=function(){Tg.g(this.$);if(!this.q1f){this.dRc=!0;var K=this.$.Ob.Gc("UserAction","HandlePageLayoutRendering");this.DLj();Ed.ULS.sendTraceTag(537154274,0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",K.Bc);K.stop()}};c.prototype.DLj=function(){for(var K=Tg.g(this.$).Ea,ea=K.hF(),
Ta=!1,Lb=0,xc=0;xc<ea.length;xc++){var qd=ea[xc],Jd=qd.Ef;Jd&&Jd.hasPageLayout()&&(Ta=!0,Jd.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+qd.ae,4),Lb++)}Ta&&(Ed.ULS.sendTraceTag(537154273,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",ea.length,Lb),K.Cyd())};Ek.Object.defineProperties(c.prototype,{q1f:{configurable:!0,enumerable:!0,get:function(){return this.dRc}}});Object(ve.a)(c,"PrintCommandHandler",
null,[429,609]);var Uk=Yc.a;Am(a,Uk);a.prototype.Nd=function(){var K=this,ea=he.AFrameworkApplication.ga.appSettings,Ta=this.$.ya.DirectPrintSetting;ea.DirectPrintIsEnabled=Ta.DirectPrintIsEnabled.toString();ea.DirectPrintProbeIsEnabled=Ta.DirectPrintProbeIsEnabled.toString();ea.DirectPrintEnabledForInternetExplorer=Ta.DirectPrintEnabledForInternetExplorer.toString();ea.DirectPrintSupportedMimeTypes=Ta.DirectPrintSupportedMimeTypes;ea.DirectPrintSupportedPlugins=Ta.DirectPrintSupportedPlugins;ea.DirectPrintImmersivePreviewPlugins=
Ta.DirectPrintImmersivePreviewPlugins;ea.DirectPrintMinimalSupportedEdgeVersion=Ta.DirectPrintMinimalSupportedEdgeVersion;ea.DirectPrintEnabledForEdge=Ta.DirectPrintEnabledForEdge.toString();ea=new ta(ea);var Lb=null;Ta=null;try{Ta=window.navigator.mimeTypes}catch(Jd){Ed.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}var xc=null;try{xc=window.navigator.plugins}catch(Jd){Ed.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}Lb=new xa(ea,Ta,xc,xa.ucf,
xa.Pgf,new Ca(he.AFrameworkApplication.ta.DX),he.AFrameworkApplication.ta.JD,xa.Qgf,function(Jd,De){return new fa(Jd,!1,De)},!1);if(hf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.Yf.get(116)){var qd=ee.GetServiceTaskFactory.Va(this.$.da,349,350,this.ub);ye.TaskExtensions.Ba(qd,function(){var Jd=new c(K.$,Lb,qd.result);K.Cd([Jd])},this.$.la)}else this.Cd([new c(this.$,Lb,null)])};a.ka=function(K){Yc.a.fe(73,new a(K))};Object(ve.a)(a,"PrintCommandHandlerFactory",
Yc.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Re.a.Ki(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Type.registerNamespace("CADWLTR");Jg.main();Type.registerNamespace("Common.App.NewAndOpen.UX");zf.a.instance.hj(new Ue);Type.registerNamespace("Common.App.OneDriveFilePickerApi");We.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SaveAsToHost");se.main();Type.registerNamespace("Common.App.SaveToSharePoint");Dg.main();Type.registerNamespace("Common.App.SaveToCloudStorage");cc.main();Type.registerNamespace("Common.App.SaveACopy");
Lc.main();Type.registerNamespace("Common.App.SharedFilePicker");Of.main();Type.registerNamespace("Common.App.WildFire");Me.main();Dc.a.Fa(vg.ka);Dc.a.Fa(dh.ka);Dc.a.Fa(uc.ka);Re.a.Ki(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}");
Dc.a.Fa(fb.ka);Re.a.Ki(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){Dc.a.Fa(function(K){le.ka(K)})})();(function(){Dc.a.Fa(function(K){K.da.Ga(165,new Nd(K))})})();Dc.a.Fa(lc.ka);(function(){Dc.a.Fa(function(K){K.da.Ga(57,new Xe(K));K.da.Ga(60,new Gf(K));K.da.Ga(63,new Mg(K))})})();Dc.a.Fa(Bc.ka);Dc.a.Fa(rd.ka);Dc.a.Fa(vd.ka);Re.a.Ki(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}");
(function(){Dc.a.Fa(function(K){Wd.ka(K);pd.ka(K)})})();Re.a.Ki('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}');
Re.a.Ki(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(function(){Dc.a.Fa(function(K){Ud.ka(K);wa.ka(K)})})();Dc.a.Fa(zc.ka);Dc.a.Fa(Za.ka);(function(){Dc.a.Fa(function(K){Zb.ka(K);Mb.ka(K)})})();Dc.a.Fa(ba.ka);Dc.a.Fa(Wa.ka);(function(){Dc.a.Fa(function(K){Ia.ka(K);La.ka(K)})})();Dc.a.Fa(Ra.ka);(function(){Dc.a.Fa(function(K){Aa.ka(K);Gb.ka(K)})})();Type.registerNamespace("Common.App.DirectPrint");zf.a.instance.hj(new pa);Dc.a.Fa(a.ka)},919:function(x,
C,b){function a(U,aa){var F=ca.call(this,document.createElement("div"))||this;F.Qx=null;F.gT=null;F.v8=null;F.Vba=null;F.R2b=null;F.Sje=null;F.qpe=null;F.fkf=null;F.i5a=!1;F.pv=!1;F.VZ=!1;F.Ova=!1;F.jHi=function(D){F.eD(D)};F.pHi=function(D){13===D.keyCode&&F.eD(D)};F.izd=function(D){F.Fo(D.yb);return!0};F.pzd=function(D){F.W_(D.yb);return!0};F.Fnc=function(D){F.ama(D.yb?D.yb:0);return!0};F.kHi=function(D){F.eD(D.Ca);return!0};F.Oig=function(D){D=void 0===D?null:D;F.Fo(D.inputMethod?D.inputMethod:
0);return!0};F.Pig=function(D){D=void 0===D?null:D;F.W_(D.inputMethod?D.inputMethod:0);return!0};F.z1=U;F.LC=aa;F.TXc=aa.FGa.toString();F.title=aa.title;F.message=aa.message;F.set_visibilityMode(1);return F}b.d(C,"a",function(){return a});x=b(0);var c=b(7),e=b(14),f=b(90),l=b(230),m=b(13),r=b(109),h=b(203),w=b(86);C=b(242);var n=b(1242),v=b(19),u=b(5),t=b(334),y=b(54),E=b(12),B=b(72),z=b(15),M=b(22),Q=b(87),P=b(1106),L=b(1),ca=C.a;Am(a,ca);a.prototype.dispose=function(){f.a.zc([this.R2b,this.gT,this.v8]);
this.pv&&this.gT&&(l.a.instance.za(m.a.click,this.gT.domElement,this.izd),r.KeyInputManager.instance.Sv(this.domElement,this.Sje));this.VZ&&this.v8&&(l.a.instance.za(m.a.click,this.v8.domElement,this.pzd),r.KeyInputManager.instance.Sv(this.domElement,this.qpe));this.Ova&&this.Vba&&(l.a.instance.za(m.a.click,this.Vba,this.Fnc),r.KeyInputManager.instance.Sv(this.domElement,this.fkf));this.Vba=this.Qx=this.z1=this.v8=this.gT=null;ca.prototype.dispose.call(this)};a.prototype.update=function(){};a.prototype.FPj=
function(){this.lEe(!0)};a.prototype.n3c=function(){this.lEe(!1)};a.prototype.O8g=function(){var U=this;this.message=Q.a.fg(this.message);this.title=Q.a.fg(this.title);h.UISurfaces.tfd().then(function(aa){aa.initializeMessageBarInStore();var F=Object(c.a)(new P.a,{messageTitle:U.title,message:U.message,isMultiline:!1,messageBarType:U.LC.SRg,closeable:!U.i5a,dismissButtonAriaLabel:z.a.instance.fa(10),onDismiss:U.kHi});if(U.Ova){var D={};F.linkProps=(D.type="AppLinkProps",D.text=U.linkText,D.onExecute=
U.Fnc,D)}U.pv&&(D={},F.firstActionButtonProps=(D.type="AppButtonProps",D.label=U.actionButton,D.onExecute=U.Oig,D));U.VZ&&(D={},F.secondActionButtonProps=(D.type="AppButtonProps",D.label=U.gGa,D.onExecute=U.Pig,D));aa.createNewMessageBar(U.domElement,F);return null},function(aa){e.ULS.sendTraceTag(524075914,0,10,"Business Bar could not be initialized",aa);return null});this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)};a.prototype.mEe=function(U){var aa="<div class='"+
n.a.imh+"' id='{0}'><div class='"+n.a.gmh+"'><a class='"+n.a.omh+"' title='{1}'><span class='"+v.a.P2b+" "+n.a.kmh+"' id='{2}'>";this.Qk.length&&(aa+="<img class='{3}' src='{4}'/>");aa+="</span></a><span class='"+n.a.nmh+"' id='{5}'>{6}</span><span class='"+n.a.mmh+"' id='message'>{7}</span><a id='link' href='#' class='"+n.a.lmh+"'>{8}</a><span class='"+n.a.xMe+"'><button type='button' id='action' class='"+n.a.wMe+"'>{9}</button></span><span class='"+n.a.xMe+"'><button type='button' id='altAction' class='"+
n.a.wMe+"'>{10}</button></span></div><a class='"+n.a.jmh+"' tabindex='0' role='button'><span id='close' class='"+v.a.rw+"'><img class='"+v.a.O9c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";U||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var F=this.businessBar.$.Mb;U=F+"ewaBusinessBarEntryBody"+this.TXc;var D=F+"ewaBusinessBarEntryTitle"+this.TXc;F=F+"ewaBusinessBarEntryIcon"+this.TXc;this.domElement.className=n.a.hmh;this.domElement.innerHTML=
String.format(aa,U,this.alt,F,this.Qk,y.a.We(0),D,this.title,this.message,this.linkText,this.actionButton,this.gGa,y.a.We(13),z.a.instance.fa(789));E.DOMElementExtensions.zu(this.domElement,u.a.esa,D,U);this.Vba=$get("link",this.domElement);E.DOMElementExtensions.setVisible(this.Vba,this.Ova);this.Ova&&(l.a.instance.pa(m.a.click,this.Vba,this.Fnc),this.fkf=r.KeyInputManager.instance.xs(this.Vba,this.Fnc,w.a.di,w.a.n1));this.gT=new t.a(E.DOMElementExtensions.getElementById(this.domElement,"action"));
this.gT.isVisible=this.pv;this.v8=new t.a(E.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.v8.isVisible=this.VZ;this.pv&&(l.a.instance.pa(m.a.click,this.gT.domElement,this.izd),this.Sje=r.KeyInputManager.instance.xs(this.gT.domElement,this.izd,w.a.di,w.a.n1),this.VZ&&(l.a.instance.pa(m.a.click,this.v8.domElement,this.pzd),this.qpe=r.KeyInputManager.instance.xs(this.gT.domElement,this.pzd,w.a.di,w.a.n1)));this.Qx=$get("close",this.domElement);this.R2b=this.he.Zd(this.Qx);this.R2b.ka("click",
this.jHi);this.R2b.ka("keydown",this.pHi);E.DOMElementExtensions.setVisible(this.Qx,!this.i5a)};a.prototype.lEe=function(U){63==this.LC.FGa?this.mEe(U):L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.O8g():this.mEe(U)};a.prototype.Fo=function(){e.ULS.sendTraceTag(21517968,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",this.LC.hash,this.LC.J8c);M.g(this.businessBar.$).Jp(!0)};a.prototype.W_=function(){e.ULS.sendTraceTag(537170257,
0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.LC.hash);M.g(this.businessBar.$).Jp(!0)};a.prototype.ama=function(){e.ULS.sendTraceTag(537170256,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.LC.hash);M.g(this.businessBar.$).Jp(!0)};a.prototype.eD=function(U){e.ULS.sendTraceTag(21517971,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",this.LC.hash,this.LC.J8c);this.set_visible(!1);this.businessBar.removeEntry(this.TRg);B.g(U)};Ek.Object.defineProperties(a.prototype,
{TRg:{configurable:!0,enumerable:!0,get:function(){return this.LC.FGa}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.z1}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.LC?this.LC.actionButton:""}},gGa:{configurable:!0,enumerable:!0,get:function(){return this.LC?this.LC.gGa:""}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.LC?this.LC.link:""}},Qk:{configurable:!0,enumerable:!0,get:function(){return this.LC?this.LC.Qk:""}},alt:{configurable:!0,
enumerable:!0,get:function(){return this.LC?this.LC.alt:""}}});Object(x.a)(a,"BusinessBarEntry",C.a,[])},991:function(x,C,b){function a(R,Z,W,ka){var ma=J.call(this)||this;ma.OF=null;ma.wD=null;ma.GW=null;ma.Zw=null;ma.HGb=null;ma.VK=null;ma.Xjc=null;ma.QBb=null;ma.PBb=!1;ma.Hwa=!0;ma.Jpc=null;ma.ewaAccessibilityManager=null;ma.oFd=null;ma.nFd=null;ma.rFd=null;ma.Xnd=!1;ma.hyf=function(){n.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",
ma.PBb);ma.PBb&&(ma.p6h(),ma.VK.style.visibility="visible",ma.Xjc?ma.Xjc.stop():n.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),ma.raiseEvent(a.vDb,new h(1)),ma.GOd(),ma.PBb=!1)};ma.$=R;ma.vD=Z;ma.A8g();ma.useMSPdfViewer=W;ma.isUniversalPrintEnabled=ka;return ma}function c(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function e(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=
this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}function f(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}function l(R){this.wg=R}function m(R){this.wg=R}function r(R){this.wg=R}function h(R){var Z=P.call(this)||this;Z.c0i=R;
return Z}b.r(C);x=b(0);var w=b(7),n=b(14),v=b(4);b(24);var u=b(409),t=b(38),y=b(51),E=b(12),B=b(128),z=b(1),M=b(15),Q=b(22),P=Sys.EventArgs;Am(h,P);Object(x.a)(h,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var L=b(271),ca=b(254);r.prototype.$h=function(){L.a(this.wg.$).YM(this.we)||L.a(this.wg.$).$h(this)};r.prototype.f8=function(){L.a(this.wg.$).YM(this.we)&&L.a(this.wg.$).Vz(this)};r.prototype.ph=function(R){return E.DOMElementExtensions.Ff(this.uc,R)};r.prototype.Cj=function(){this.wg.$.frame.Re.fk(this.wg.$.frame.Re.WE)};
r.prototype.Rj=function(){};r.prototype.Wf=function(R,Z){return Z?!1:(this.wg.enterPrintPreviewHeaderFocusTrapZone(),!0)};Ek.Object.defineProperties(r.prototype,{we:{configurable:!0,enumerable:!0,get:function(){return ca.a.rIf}},uc:{configurable:!0,enumerable:!0,get:function(){var R=b(991).PrintPreviewPane;return document.getElementById(R.a0i)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(x.a)(r,"PrintPreviewHeaderKeyboardAccessibleSection",null,[444]);m.prototype.$h=
function(){L.a(this.wg.$).YM(this.we)||L.a(this.wg.$).$h(this)};m.prototype.f8=function(){L.a(this.wg.$).YM(this.we)&&L.a(this.wg.$).Vz(this)};m.prototype.ph=function(R){return E.DOMElementExtensions.Ff(this.uc,R)};m.prototype.Cj=function(){this.wg.$.frame.Re.fk(this.wg.$.frame.Re.WE)};m.prototype.Rj=function(){};m.prototype.Wf=function(R,Z){return Z?!1:(this.wg.useMSPdfViewer?(R=document.getElementById(b(991).PrintPreviewPane.mDd))&&E.DOMElementExtensions.setFocus(R,!0):E.DOMElementExtensions.setFocus(this.wg.VK),
!0)};Ek.Object.defineProperties(m.prototype,{we:{configurable:!0,enumerable:!0,get:function(){return ca.a.sIf}},uc:{configurable:!0,enumerable:!0,get:function(){var R=b(991).PrintPreviewPane;return this.wg.useMSPdfViewer?document.getElementById(b(991).PrintPreviewPane.mDd):document.getElementById(R.MFf)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(x.a)(m,"PrintPreviewKeyboardAccessibleSection",null,[444]);l.prototype.$h=function(){L.a(this.wg.$).YM(this.we)||
L.a(this.wg.$).$h(this)};l.prototype.f8=function(){L.a(this.wg.$).YM(this.we)&&L.a(this.wg.$).Vz(this)};l.prototype.ph=function(R){return E.DOMElementExtensions.Ff(this.uc,R)};l.prototype.Cj=function(){this.wg.$.frame.Re.fk(this.wg.$.frame.Re.WE)};l.prototype.Rj=function(){};l.prototype.Wf=function(R,Z){return Z?!1:(this.wg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};Ek.Object.defineProperties(l.prototype,{we:{configurable:!0,enumerable:!0,get:function(){return ca.a.vIf}},uc:{configurable:!0,enumerable:!0,
get:function(){var R=b(991).PrintPreviewPane;return document.getElementById(R.qFd)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(x.a)(l,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[444]);Object(x.a)(f,"MSPdfViewerFileUrl",null,[]);Object(x.a)(e,"PrintSettingsTaskPaneProps",null,[]);Object(x.a)(c,"ViewerPaneProps",null,[]);var U=b(1255),aa=b(396),F=b(5),D=b(1256);b.d(C,"PrintPreviewPane",function(){return a});var J=t.a;Am(a,J);a.prototype.AFg=function(R){this.addHandler(a.vDb,
R)};a.prototype.tbj=function(R){this.removeHandler(a.vDb,R)};a.prototype.lAj=function(){this.v8g()};a.prototype.mAj=function(){var R=this.$.Ob.Gc("UserAction","createSettingsPaneStopwatch"),Z=document.getElementById(a.qFd);this.B8g();var W=this.C8g();this.wD.createPrintSettingsTaskPane(Z,W);R.stop();this.PBb=!1;if(this.isUniversalPrintEnabled&&this.Zw){R="A4";switch(W.selectedPrintSettingsValues.selectedPaperSize){case 8:R="A3";break;case 9:R="A4";break;case 11:R="A5";break;case 12:R="JIS B4";break;
case 13:R="JIS B5";break;case 5:R="North America Legal";break;case 1:R="North America Letter";break;case 6:R="North America Invoice";break;case 7:R="North America Executive";break;case 3:R="North America Ledger"}this.OF.setDocumentSettings({mediaSize:R,orientation:2===W.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===W.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.XHd()};a.prototype.setPageRangeSettings=function(R,Z,W,ka,ma){this.wD&&
(this.wD.setPageRangeSettings(R,Z,W,ka,ma),this.ZZf(String.format(M.a.instance.Ab(196),ka,ma,R)))};a.prototype.f6h=function(){this.Zw&&(this.Zw.style.display="none")};a.prototype.hgh=function(){this.dispose();this.QXd();this.BNj();this.OF&&this.OF.closePrintPreviewPane();this.GW=this.wD=this.OF=this.Zw=null};a.prototype.ssi=function(R){n.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.QBb=this.$.Ob.Gc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||
n.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.GW.renderPdf(R)):this.VK&&((this.Xjc=this.$.Ob.Gc("UserAction","loadPdfStopwatch"))||n.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.PBb=!0,this.VK.src&&this.VK.src===R?this.hyf(null):this.VK.src=R);if(this.isUniversalPrintEnabled&&this.Zw){var Z=aa.b(this.$.workbookContext);this.OF.setFileUrl(R,Z)}};a.prototype.onPdfLoad=function(){this.QBb?
(n.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.QBb.Bc,this.Hwa),this.QBb.stop()):n.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.vDb,new h(1));this.hideWaitCursor();this.GOd()};a.prototype.printPdf=function(){E.DOMElementExtensions.setFocus(this.VK);this.VK.contentWindow.print()};a.prototype.cBj=function(){this.showSpinner();this.showWaitCursor();this.ZZf("")};
a.prototype.p6h=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.bA=function(R,Z,W){this.Zw&&this.GW&&(this.Xnd=!1,this.GW.showErrorDetails(Z,R,void 0===W?null:W),this.vD.g6a=!0,this.VK&&(this.VK.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.eki(Z)&&(this.Xnd=!0,this.WOi()))};a.prototype.hidePreviewError=function(){this.vD.g6a=!1;this.GW.hidePreviewError();this.enablePrintButton()};a.prototype.Zfh=function(){(this.HGb=document.getElementById(a.tIf))&&this.HGb.parentNode&&
this.HGb.parentNode.removeChild(this.HGb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.wD&&this.wD.hideErrorMessageForPrintOptions()};a.prototype.showErrorMessageForPrintOptions=function(R){this.wD&&this.wD.showErrorMessageForPrintOptions(R)};a.prototype.showSpinner=function(){this.vD.g6a||z.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.Xnd?this.hidePreviewError():this.VK&&(this.VK.style.visibility="hidden");this.GW&&this.GW.showSpinner()};
a.prototype.hideSpinner=function(){this.GW&&this.GW.hideSpinner()};a.prototype.enablePrintButton=function(){this.wD&&this.wD.enablePrintButton();this.isUniversalPrintEnabled&&this.Zw&&this.OF.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.wD&&this.wD.disablePrintButton();this.isUniversalPrintEnabled&&this.Zw&&this.OF.updatePrintButtonEnableDisableState(!1)};a.prototype.showWaitCursor=function(){this.wD&&this.wD.showWaitCursor();this.isUniversalPrintEnabled&&
this.Zw&&this.OF.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.wD&&this.wD.hideWaitCursor();this.isUniversalPrintEnabled&&this.Zw&&this.OF.updatePrintButtonEnableDisableState(!0)};a.prototype.y8g=function(){if(this.Zw)n.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.Zw=document.createElement("div"),this.Zw.id=a.tIf,this.Zw.classList.add(a.d0i),this.$.kr.insertBefore(this.Zw,
this.$.kr.firstChild),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Qa.Wg){var R=document.getElementById(F.a.lGa);R&&(this.Zw.style.top=R.clientHeight+"px",this.Zw.style.height="calc(100% - "+R.clientHeight+"px)")}};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.OF.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=function(){this.OF.enterPrintSettingsTaskPaneFocusTrapZone()};a.prototype.MYi=function(){var R=this;this.$.da.$a(15,
function(Z){R.ewaAccessibilityManager=Z;R.ewaAccessibilityManager.mode=3})};a.prototype.A8g=function(){this.rFd=new l(this);this.oFd=new m(this);this.nFd=new r(this)};a.prototype.XHd=function(){this.rFd.$h();this.oFd.$h();this.nFd.$h();this.MYi()};a.prototype.QXd=function(){this.rFd.f8();this.oFd.f8();this.nFd.f8();Q.g(this.$).M0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)};a.prototype.jO=function(){this.Jpc=B.a.instance.Zd(this.VK);this.Jpc.ka("load",this.hyf)};a.prototype.BNj=
function(){this.Jpc&&this.VK&&this.Jpc.detach("load")};a.prototype.GOd=function(){this.isUniversalPrintEnabled?this.$Yf(a.b0i,a.zCi):this.$Yf(a.qFd,a.nIf)};a.prototype.$Yf=function(R,Z){this.Hwa&&(R=document.getElementById(R))&&(Z=E.DOMElementExtensions.getElementById(R,Z))&&(this.Hwa=!1,Z.focus())};a.prototype.WOi=function(){this.vD.g6a=!1;this.enablePrintButton();this.GOd()};a.prototype.v8g=function(){var R=this;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:6068952_FixJSCrahInPrintPreview")){var Z=
y.GetServiceTaskFactory.Va(this.$.da,283,284,0).result.Jn;Z.loadScript("excel-print-preview-sprite").then(function(){Z.loadScript("printPreviewer").then(function(){Z.loadScript("excelPrintPreviewer").then(function(){R.tEe()})},function(){n.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},function(){n.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}else y.GetServiceTaskFactory.Va(this.$.da,
283,284,0).result.Jn.loadScript("excelPrintPreviewer").then(function(){R.tEe()})};a.prototype.tEe=function(){var R=this,Z=this.$.Ob.Gc("UserAction","createEmptyPreviewerStopwatch");this.y8g();this.z8g();this.isUniversalPrintEnabled?this.OF.createEmptyPrintPreviewPaneAsync(this.Zw,this.sEe()).then(function(){Z.stop();R.aBe();R.OF.updatePrintButtonEnableDisableState(!1)}):(this.OF.createEmptyPrintPreviewPane(this.Zw,this.sEe()),Z.stop(),this.aBe())};a.prototype.aBe=function(){var R=this.$.Ob.Gc("UserAction",
"createPdfPreviewPaneStopwatch"),Z=document.getElementById(a.mDd);this.useMSPdfViewer&&(Z.tabIndex=0);this.i8g();this.h8g(Z);R.stop();this.raiseEvent(a.vDb,new h(0))};a.prototype.z8g=function(){this.OF||(this.OF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.OF||n.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};a.prototype.B8g=function(){this.wD||(this.wD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());
this.wD||n.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};a.prototype.i8g=function(){this.GW||(this.GW=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.GW||n.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};a.prototype.h8g=function(R){this.GW.createPrintPreviewPane(R,this.M$g());this.useMSPdfViewer||
(this.VK=E.DOMElementExtensions.getElementById(this.Zw,a.MFf),this.VK.title=M.a.instance.fa(1182),this.jO())};a.prototype.C8g=function(){var R="en-US";var Z=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?R=this.$.ya.DataCultureTag:n.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(w.a)(new e,{whatToPrintOptions:this.vD.Av.whatToPrintOptions,orientationOptions:this.vD.Av.orientationOptions,
paperSizeOptions:this.vD.Av.paperSizeOptions,scalingOptions:this.vD.Av.scalingOptions,marginDetailedOptions:this.vD.TRh(),selectedPrintSettingsValues:this.vD.KUh(),printSettingsTaskPaneCallbacks:this.vD.IUh(),logger:new u.a,shouldDisableCurrentSelection:this.vD.fxc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:Z,dataCultureTag:R,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.sEe=function(){return this.isUniversalPrintEnabled?this.vD.GUh():Object(w.a)(new U.a,{backActionButtonText:M.a.instance.fa(1180),
printPreviewPaneCallbacks:this.vD.Z0e(),logger:new u.a,disableTellMeControl:!0})};a.prototype.M$g=function(){var R=this;return this.useMSPdfViewer?Object(w.a)(new c,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.w7g(),onPdfLoad:function(){R.onPdfLoad()}}):Object(w.a)(new c,{useMSPdfViewer:!1})};a.prototype.w7g=function(){return Object(w.a)(new f,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};
a.prototype.ZZf=function(R){this.Zw&&this.OF.setAdditionalHeaderText(R)};a.eki=function(R){return 3===R||2===R};a.tIf="PrintPreviewerContainer";a.qFd="printSettingsTaskPaneId";a.mDd="previewId";a.MFf="printpreviewiframe";a.a0i="printPreviewHeaderId";a.nIf="printButton";a.b0i="printPreviewPaneId";a.zCi="printButtonId";a.d0i=D.a.Zw;a.vDb="pppnosu";Object(x.a)(a,"PrintPreviewPane",t.a,[631])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kmhv.js.map/ccfac60cb20a4ea26e2a058b6f77700b/EwaDS.kmhv.js.map