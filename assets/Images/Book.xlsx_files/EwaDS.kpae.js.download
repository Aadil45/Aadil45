(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1017:function(x,C,b){function a(Z,W,ka){this.QQb=null;this.QF={};this.HRb=this.zx=null;m.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=Z;this.m4d=a.J5c;this.n4d=a.borderStyleSolidLine;this.Ug=W;this.Ra=ka;y.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.cV=new c(this.$,this.Ug);this.ZC=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1);m.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}","296")}function c(Z,W){var ka=this;this.zGb=this.ribbonCommandInfo=this.cellFormat=this.Tr=this.Cb=this.ha=null;this.Yrc=!1;this.aIf=this.ELa=this.iIf=this.Y7d=this.mza=this.wma=null;this.T0b=this.cua=this.hIf=0;this.borderStyle=this.VZa=this.borderColor=null;this.vB=!1;this.y5b=this.eab=null;this.z0=function(){if(!ka.vB||J.g(ka.$).Ez)ka.vB=!1,J.g(ka.$).Ez=!1,ka.cua=0,J.g(ka.$).rg.Mo(w.a.P4),
1===ka.$.Ka.xH()&&(J.g(ka.$).IV(B.a.clone(ka.iIf),ka.hIf,ka.$.qa?ka.$.qa.sheetName:null,null,ka.aIf.clone(),null,null,0,D.a.Ehh,!0),J.g(ka.$).kSa(!0)),ka.Tv(),ka.JXd(),ka.vm(),ka.Yrc=!1,ka.wma=null,ka.mza=null,ka.Tr&&(ka.Tr.cancel(),ka.Tr.dispose()),m.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=function(ma){try{if(ma=ka.je(ma),J.g(ka.$).Ez=!0,ka.wma={},ka.mza={},ka.eab=null,ka.fpb(ka.T0b),2===ma.yb){var pa=J.g(ka.$).ha.Vn(ma.clientPoint,
ma.Lb,5,void 0,void 0,!1);pa&&(ka.ELa=pa,ka.y5b=pa,ka.l7i())}}catch(xa){J.g(ka.$).Ez=!1}return!0};this.Sh=function(ma){try{ma=ka.je(ma);var pa=J.g(ka.$).ha.Vn(ma.clientPoint,ma.Lb,5,void 0,void 0,!1),xa=J.g(ka.$).Ea.gs(pa);if(!ka.zGb||xa&&(xa.mK!==ka.zGb.mK||xa.lK!==ka.zGb.lK))if(ka.vB=!0,ka.zGb=xa,pa){var va=new L.Range(ka.ELa.top,ka.ELa.left,ka.ELa.top,ka.ELa.left,!0,!1);va.union(pa);va=J.g(ka.$).ha.aVh(va);ka.X0b(pa);ka.cTf(ka.eab,va);if(ka.bottomRightCorner(va.bottom,va.right))return m.ULS.sendTraceTag(537159515,
0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;var ta=new L.Range(va.top,va.left,va.bottom+1,va.right+1,!0,!1),fa=J.g(ka.$).Q$("DrawBorderBehavior.OnPointerMove",[ta]);if(ka.wma&&ka.mza)for(;fa.$$mn();){var Ca=fa.$$cu(),Sa=Ca.cell.getRange().toString();Sa in ka.wma&&1!==ka.cua||(ka.wma[Sa]=Ca,ka.mza[Sa]=Ca.cell.SM())}ka.eab=ta;ka.y5b=va;J.g(ka.$).IV([va],0,ka.$.qa.sheetName,null,va.topLeft,null,null,0,D.a.Bhh,!0);ka.Ug.Tda(J.g(ka.$),-1690267012,
ka.cellFormat,!0,null,[va])}return!0}catch(Gb){return J.g(ka.$).Ez=!1}};this.Of=function(ma){ma=ka.je(ma);(ma=J.g(ka.$).ha.Vn(ma.clientPoint,ma.Lb,5,void 0,void 0,!1))?ka.vB&&(ka.X0b(ma),ka.ELa.union(ma),3===ka.cua?ka.fpb(0):ka.fpb(ka.T0b),J.g(ka.$).IV([ka.ELa],0,ka.$.qa.sheetName,null,null,null,null,0,D.a.Chh,!0),ka.Ug.formatCells(-1690267012,ka.cellFormat,ka.ribbonCommandInfo)):(3===ka.cua?ka.fpb(0):ka.fpb(ka.T0b),J.g(ka.$).IV([ka.y5b],0,ka.$.qa.sheetName,null,null,null,null,0,D.a.Dhh,!0),ka.Ug.formatCells(-1690267012,
ka.cellFormat,ka.ribbonCommandInfo));ka.vB=!1;ka.JXd();ka.wma=null;ka.mza=null;return!0};this.onKeyDown=function(ma){ma=ka.je(ma);if(ka.vB||Array.contains([17,16,18,20],ma.Ca.keyCode))return!0;ka.z0();return!1};this.onKeyUp=function(ma){ma=ka.je(ma);if(ma.Ca.keyCode===z.a.IL&&ka.vB)return ka.vB=!1,ka.cTf(ka.eab,ka.y5b,!0),ka.JXd(),!0;if(ka.vB||ma.Ca.keyCode===z.a.m8||ma.Ca.keyCode===z.a.X0d||ma.Ca.keyCode===z.a.W0d||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],ma.Ca.keyCode)||ma.Ca.keyCode===
z.a.Cjg||ma.Ca.keyCode===z.a.yjg||ma.Ca.keyCode===z.a.ujg)return!0;ka.z0();return!1};this.JN=function(ma,pa){J.g(ka.$).Ez&&!Array.contains(ka.H7h,pa.Rd.command)&&(m.ULS.sendTraceTag(537159512,0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",pa.Rd),ka.z0())};this.$=Z;this.Ug=W}function e(Z){Z.JNf()}function f(){this.iconName=this.title=this.key=null}function l(Z,W,ka,ma,pa,xa,va,ta){this.flg=Z;this.glg=W;this.elg=ka;this.Aga=ma;this.zwg=pa;this.Hsg=xa;this.Kjb=va;this.Frg=
ta}b.r(C);x=b(0);var m=b(14),r=b(1024),h=b(934),w=b(5),n=b(79),v=b(54),u=b(229),t=b(35),y=b(1),E=b(15);l.xPg=function(){return new l("BorderStyleSolidLine",1916,1,"1","",1,8,0)};l.tPg=function(){return new l("BorderStyleDashedLine",1917,3,"1","5,3",1,8,0)};l.uPg=function(){return new l("BorderStyleDottedLine",1918,4,"1","1,1",1,8,0)};l.wPg=function(){return new l("BorderStyleMediumLine",1919,2,"2","",1,8,0)};l.yPg=function(){return new l("BorderStyleThickLine",1920,5,"3","",1,8,0)};l.vPg=function(){return new l("BorderStyleDoubleLine",
1921,6,"1","",2,8,3)};Ek.Object.defineProperties(l.prototype,{Qte:{configurable:!0,enumerable:!0,get:function(){return this.flg}},R0b:{configurable:!0,enumerable:!0,get:function(){return this.glg}},Pte:{configurable:!0,enumerable:!0,get:function(){return this.elg}},width:{configurable:!0,enumerable:!0,get:function(){return this.Aga}},rFj:{configurable:!0,enumerable:!0,get:function(){return this.zwg}},oEi:{configurable:!0,enumerable:!0,get:function(){return this.Hsg}},lineHeight:{configurable:!0,enumerable:!0,
get:function(){return this.Kjb}},Fri:{configurable:!0,enumerable:!0,get:function(){return this.Frg}}});Object(x.a)(l,"BorderLineStyleProperties",null,[]);Object(x.a)(f,"BorderLineStyleProps",null,[]);e.prototype.getBorderLineStyleProps=function(){var Z=b(1017).BorderFormatManager.UZa,W=Array(Object.keys(Z).length),ka=0,ma;for(ma in Z){var pa=ma,xa=Z[ma];W[ka]=new f;W[ka].key=pa;pa=xa;W[ka].title=E.a.instance.fa(pa.R0b);W[ka].iconName=pa.Qte;ka++}return W};Object(x.a)(e,"BorderMenuController",null,
[849]);var B=b(275),z=b(86),M=b(178),Q=b(13),P=b(109),L=b(25),ca=b(47),U=b(44),aa=b(213),F=b(10),D=b(105),J=b(22),R=b(33);c.prototype.dzg=function(Z){m.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=J.g(this.$).ha;this.Cb=J.g(this.$).Cb;this.ribbonCommandInfo=Z;this.iIf=B.a.clone(this.ha.sa.selectedRanges);this.hIf=this.ha.sa.rB;this.aIf=this.ha.sa.activeCell.clone();this.Cb&&this.Cb.Yjd();this.Cv();this.Ck()};c.prototype.dispose=function(){this.z0();
this.zGb=this.ribbonCommandInfo=this.cellFormat=null};c.prototype.fpb=function(Z){var W=b(1017).BorderFormatManager;this.cellFormat={};var ka={};this.borderColor=this.borderColor||W.J5c;var ma=u.a.sH(this.borderColor,!1);ka.Color=[ma,ma,ma,ma];y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.VZa&&(ka.ThemeBorderColor=[this.VZa,this.VZa,this.VZa,this.VZa],ka.ColorTypeOption=1);ma=b(1017).BorderFormatManager.UZa;this.borderStyle=this.borderStyle||W.borderStyleSolidLine;
W=ma[this.borderStyle].Pte;ka.LineStyle=[W,W,W,W];this.cellFormat.BorderFormat=ka;this.cellFormat.ValidMembers=128;this.cellFormat.Border=Z};c.prototype.Cv=function(){for(var Z=El(J.g(this.$).yn),W=Z.next();!W.done;W=Z.next())M.a.instance.pa(Q.a.pointerDown,W.value.domElement,this.onPointerDown);P.KeyInputManager.instance.pa(Q.a.Yb,document.documentElement,this.onKeyDown);P.KeyInputManager.instance.pa(Q.a.Ud,document.documentElement,this.onKeyUp)};c.prototype.l7i=function(){for(var Z=El(J.g(this.$).yn),
W=Z.next();!W.done;W=Z.next())W=W.value,M.a.instance.pa(Q.a.vh,W.domElement,this.Sh),M.a.instance.pa(Q.a.$d,W.domElement,this.Of);M.a.instance.pa(Q.a.$d,document.documentElement,this.Of);M.a.instance.pa(Q.a.Fy,document.documentElement,this.Of);this.Yrc=!0};c.prototype.Tv=function(){try{for(var Z=El(J.g(this.$).yn),W=Z.next();!W.done;W=Z.next())M.a.instance.za(Q.a.pointerDown,W.value.domElement,this.onPointerDown);P.KeyInputManager.instance.za(Q.a.Yb,document.documentElement,this.onKeyDown);P.KeyInputManager.instance.za(Q.a.Ud,
document.documentElement,this.onKeyUp)}catch(ka){J.g(this.$).Ez=!1,m.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",ka)}};c.prototype.JXd=function(){if(this.Yrc)try{this.Yrc=!1;for(var Z=El(J.g(this.$).yn),W=Z.next();!W.done;W=Z.next()){var ka=W.value;M.a.instance.za(Q.a.vh,ka.domElement,this.Sh);M.a.instance.za(Q.a.$d,ka.domElement,this.Of)}M.a.instance.za(Q.a.$d,document.documentElement,this.Of);M.a.instance.za(Q.a.Fy,
document.documentElement,this.Of)}catch(ma){J.g(this.$).Ez=!1,m.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",ma)}};c.prototype.Ck=function(){this.$.xa.Bg(this.z0);J.g(this.$).rc.ml(this.z0);J.g(this.$).nE(this.z0);this.$.Ka.Ora(this.JN)};c.prototype.vm=function(){this.$.xa.Xg(this.z0);J.g(this.$).rc.fl(this.z0);J.g(this.$).UF(this.z0);this.$.Ka.Mza(this.JN)};c.prototype.cTf=function(Z,W,ka){ka=void 0===ka?!1:ka;
if(Z&&this.wma&&this.mza)for(Z=J.g(this.$).Q$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[Z]);Z.$$mn();){var ma=Z.$$cu().cell.getRange();if(ka||!W.contains(ma)||1===this.cua){ma=ma.toString();var pa=t.a.Nc(this.wma,ma);if(pa){var xa=t.a.Nc(this.mza,ma);this.setBorders(pa,xa);delete this.wma[ma];delete this.mza[ma]}}}};c.prototype.setBorders=function(Z,W){var ka=Z.cell,ma=ka.getRange();ka.osc();ma.right!==this.eab.right&&(ka=new L.Range(ma.top,ma.left-1,ma.bottom,ma.left-1,!0,!1),J.g(this.$).Ea.gs(ka).mQa(3));
ma.bottom!==this.eab.bottom&&(ka=new L.Range(ma.top-1,ma.left,ma.top-1,ma.right,!0,!1),J.g(this.$).Ea.gs(ka).mQa(1));if(null===W||void 0===W?0:W.Borders.length){var pa={};ka=0;for(var xa=Array(4),va=Array(4),ta=0;4>ta;ta++)xa[ta]=1,va[ta]=0;W=El(W.Borders);for(ta=W.next();!ta.done;ta=W.next()){ta=ta.value;var fa=ta.BorderPosition;xa[fa]=ta.BorderLineStyle;var Ca=new aa.a(ta.Color.Red,ta.Color.Green,ta.Color.Blue);va[fa]=Ca.QS();ka|=F.HelperMethods.x3a(ta.BorderPosition)}pa.LineStyle=xa;pa.Color=va;
pa={BorderFormat:pa};pa.Border=ka;this.Ug.lrj(Z,pa,ma)}};c.prototype.X0b=function(Z){var W=this,ka=new L.Range(Math.max(1,Z.top-1),Math.max(1,Z.left-1),Z.bottom+1,Z.right+1,!1,!1);J.g(this.$).p_(ka)||this.Tr&&this.Tr.vp||(this.Tr=ca.a.instance.create(function(){J.g(W.$).nt(ka,60,D.a.zhh)},40,U.a.Ahh))};c.prototype.bottomRightCorner=function(Z,W){return 1048576<=Z||16384<=W?!0:!1};c.prototype.je=function(Z){return R.a(this.$).je(Z)};Ek.Object.defineProperties(c.prototype,{H7h:{configurable:!0,enumerable:!0,
get:function(){return this.Y7d||(this.Y7d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(x.a)(c,"DrawBorderBehavior",null,[3]);b.d(C,"BorderFormatManager",function(){return a});a.prototype.K4e=function(Z,W){m.ULS.sendTraceTag(537159564,0,50,"HandleBorderCommand : Begin handling, Command being executed: {0}",W.command.toString());var ka=
{},ma={};var pa=u.a.sH(this.B3,!1);ma.Color=[pa,pa,pa,pa];this.ZC&&this.uta&&(ma.ThemeBorderColor=[this.uta,this.uta,this.uta,this.uta],ma.ColorTypeOption=1);Z=-600086683===W.command?"OutsideBorders":Z[n.a.ld];ma.LineStyle=t.a.Nc(a.mHf,Z);ma.LineStyle?m.ULS.sendTraceTag(537159562,0,50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",Z):(pa=a.UZa[this.RHa].Pte,ma.LineStyle=[pa,pa,pa,pa],m.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",
this.RHa));pa=t.a.ao(a.vOg,Z,0);m.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",Z,this.B3);ka.BorderFormat=ma;4!==pa&&8!==pa||!this.$.qa.displayRtl||(pa=4===pa?8:4);ka.ValidMembers=128;ka.Border=pa;this.Ug.formatCells(-1690267012,ka,W);m.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",W.command.toString());return!0};a.prototype.fid=function(Z,
W,ka){m.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",Z.toString(),this.B3);if(this.ZC){if((W.SqmControlId||"").includes("ThemeColorPicker")){var ma=this.themesManager.getThemeColor(W.Color);var pa=ma.themeIndex;var xa=ma.mBa;ma.returnValue?(this.HRb={},this.uta.ThemeColorIndex=pa,this.uta.ThemeColorRow=xa):this.HRb=null}else this.HRb=null;this.cV.VZa=this.uta}this.m4d=-1803452024===Z?a.J5c:W.Color;this.cV.borderColor=this.B3;this.QKe(ka);
this.$.Bf();m.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",Z.toString(),this.B3);return!0};a.prototype.h3h=function(Z){m.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var W=this.Ra.Yp(),ka=this.Ra.Pc();W.Ec.push(ka);var ma=this.Ra.dB("StyleDashGallery",1,"Size120by20");ka.buttons.push(ma);ka=a.UZa;for(var pa in ka){var xa=pa,va=ka[pa],ta=E.a.instance.fa(va.R0b);ma.Mt(xa,-2118943501,"QueryBorderStyle",
va.R0b,xa,xa,void 0,void 0,ta)}m.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");Z.MenuItems=W.oC();m.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};a.prototype.K1h=function(Z,W){m.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",this.RHa);Z=Z[n.a.ld];if(a.Lni(Z))this.n4d=Z,m.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.RHa);else return m.ULS.sendTraceTag(537159553,
0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",Z),!0;this.cV.borderStyle=this.RHa;this.QKe(W);this.$.Bf();m.ULS.sendTraceTag(40944220,0,50,"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.RHa);return!0};a.prototype.kid=function(Z){m.ULS.sendTraceTag(537159552,0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",Z.command.toString());this.FTc(Z,64,this.B3,86,1);return!0};a.prototype.lid=function(Z){m.ULS.sendTraceTag(537159523,
0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",Z.command.toString());this.FTc(Z,112,this.B3,87,2);return!0};a.prototype.X4e=function(Z){m.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",Z.command.toString());this.FTc(Z,112,"white",88,3);return!0};a.prototype.k3h=function(Z){this.Tpj(this.xOg,Z,Z.MenuItemId?Z.MenuItemId:a.borderStyleSolidLine)};a.prototype.Tpj=function(Z,W,ka){ka in Z?(Z=Z[ka],m.ULS.sendTraceTag(537159521,
0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",ka),this.Vpj(W,Z)):m.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",ka)};a.prototype.v3h=function(Z,W){var ka=Z[n.a.ld];return"DrawBorder"===ka?this.kid(W):"DrawBorderGrid"===ka?this.lid(W):"EraseBorder"===ka?this.X4e(W):this.K4e(Z,W)};a.prototype.JNf=function(){this.QQb||this.zPg()};a.prototype.mJh=function(){return new e(this)};a.prototype.zPg=function(){this.QQb=
{};var Z=0,W=a.UZa,ka={},ma;for(ma in W){ka.Lea=W[ma];var pa=ka.Lea.Qte;E.a.instance.fa(ka.Lea.R0b);var xa=function(va){return function(){return appChrome.buildBorderStyleIconNew(va.Lea.rFj,va.Lea.width,va.Lea.oEi,va.Lea.lineHeight,va.Lea.Fri)}}(ka);this.QQb[pa]=pa;this.Yab(pa,xa);Z++;ka={Lea:ka.Lea}}};a.prototype.Yab=function(Z,W){if(!(Z in this.QF)){var ka={};W=W();ka[Z]=W;appChrome.api.registerIconProvider(function(){return ka});this.QF[Z]=!0}return Z};a.prototype.Vpj=function(Z,W){Z.MenuItemId&&
(Z[r.a.On]=Z.MenuItemId===this.RHa,Z[h.a.Icon]=W)};a.prototype.FTc=function(Z,W,ka,ma,pa){m.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.tWg(Z,pa)?(m.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.cV.z0()):(J.g(this.$).Ez&&this.cV.z0(),v.a.current&&(ma=String.format(w.a.zta,v.a.current.kp(ma)),J.g(this.$).rg.Mo(ma)),this.cV.T0b=W,this.cV.borderColor=
ka,J.g(this.$).Ez=!0,this.cV.dzg(Z),this.cV.cua=pa)};a.prototype.QKe=function(Z){if(Z)switch(this.cV.cua){case 2:this.lid(Z);break;default:this.kid(Z)}};a.prototype.tWg=function(Z,W){return this.cV.cua===W&&-236759591!==Z.command&&-2118943501!==Z.command?!0:!1};a.Lni=function(Z){return Z?Z in a.mHf||Z in a.UZa:!1};Ek.Object.defineProperties(a.prototype,{RHa:{configurable:!0,enumerable:!0,get:function(){return this.n4d}},B3:{configurable:!0,enumerable:!0,get:function(){return this.m4d}},uta:{configurable:!0,
enumerable:!0,get:function(){return this.HRb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.zx||(this.zx=this.$.da.Aa(422));return this.zx}},xOg:{configurable:!0,enumerable:!0,get:function(){this.JNf();return this.QQb}}});Ek.Object.defineProperties(a,{UZa:{configurable:!0,enumerable:!0,get:function(){var Z={};return a.x2d||(a.x2d=(Z.BorderStyleSolidLine=l.xPg(),Z.BorderStyleDashedLine=l.tPg(),Z.BorderStyleDottedLine=l.uPg(),Z.BorderStyleMediumLine=l.wPg(),Z.BorderStyleThickLine=
l.yPg(),Z.BorderStyleDoubleLine=l.vPg(),Z))}},vOg:{configurable:!0,enumerable:!0,get:function(){var Z={};return a.w2d||(a.w2d=(Z.NoBorder=0,Z.BottomBorder=1,Z.TopBorder=2,Z.LeftBorder=4,Z.RightBorder=8,Z.OutsideBorders=64,Z.AllBorders=112,Z.ThickOutsideBorders=64,Z.InsideBorders=48,Z.InsideHorizontalBorders=16,Z.InsideVerticalBorders=32,Z.BottomDoubleBorder=1,Z.ThickBottomBorder=1,Z.TopBottomBorder=3,Z.TopThickBottomBorder=3,Z.TopDoubleBottomBorder=3,Z))}},mHf:{configurable:!0,enumerable:!0,get:function(){var Z=
{};return a.Ode||(a.Ode=(Z.ThickOutsideBorders=[2,2,2,2],Z.BottomDoubleBorder=[1,6,1,1],Z.ThickBottomBorder=[1,2,1,1],Z.TopBottomBorder=a.cch,Z.TopThickBottomBorder=[1,2,1,1],Z.TopDoubleBottomBorder=[1,6,1,1],Z))}}});a.w2d=null;a.x2d=null;a.Ode=null;a.J5c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.cch=[1,1,1,1];Object(x.a)(a,"BorderFormatManager",null,[791])},1048:function(x,C,b){function a(B,z,M){window.performance.measure(B,z,M);z=window.performance.getEntriesByName(B);z.length||w.ULS.sendTraceTag(537167063,
0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",B);return z[z.length-1]?z[z.length-1].duration:-1}function c(){if(n.a.cpb){var B=a("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),z=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),M=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");w.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",
B,z,M)}}function e(B,z){y.HelperMethods.OYc&&window.performance.mark(z)}function f(B){B=E.g(B).ha.sa;return B.Ig&&(B.qd.isRow||B.qd.ef)}function l(B){return B.Rb.Gka(B.ha.sa.activeCell)}function m(B,z,M,Q,P){B=Q.vk("ContextMenuHelper.FindFirstCellInViewportArea",B,z,M);try{for(B.$$rst();B.$$mn();){var L=B.$$cu();if(L&&r(L,Q,P))return L.cell}}finally{B&&B.dispose()}return null}function r(B,z,M){var Q=z.rtl,P=M.isChromeRtl;B=B.cell;return(M=E.g(M).$J(B))?(M=M.topLeft,Q=M.x+=Q===P?B.offsetWidth:0,P=
M.y+=B.offsetHeight,z.view.visibleArea.contains(new u.a(Q,P,0,0))):!1}function h(B,z){var M=B.kc(null);if((null===M||void 0===M?0:M.cell.mk)&&r(M,B,z))return B.getCellBounds(M.cell);M=B.ha.sa.activeCell;return(z=m(new t.Range(M.top,M.left,v.a.Hh,M.left,!1,!1),2,!0,B,z)||m(new t.Range(1,M.left,M.top,M.left,!1,!1),2,!1,B,z)||m(new t.Range(M.top,M.right,M.top,v.a.Qh,!1,!1),1,!0,B,z)||m(new t.Range(M.top,1,M.top,M.right,!1,!1),1,!1,B,z)||null)&&z.mk?B.getCellBounds(z):Sys.UI.DomElement.getBounds(B.e5a.uc)}
b.d(C,"i",function(){return"ContextMenuPerf.A"});b.d(C,"b",function(){return"ContextMenuPerf.B"});b.d(C,"d",function(){return"ContextMenuPerf.C1"});b.d(C,"a",function(){return"ContextMenuPerf.C2"});b.d(C,"c",function(){return"ContextMenuPerf.D"});b.d(C,"e",function(){return h});b.d(C,"f",function(){return l});b.d(C,"g",function(){return f});b.d(C,"h",function(){return e});b.d(C,"j",function(){return c});var w=b(14),n=b(332),v=b(9),u=b(60),t=b(25),y=b(10),E=b(22)},1049:function(x,C,b){function a(){}
b.d(C,"a",function(){return a});x=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.yMg="AutoFill";a.Whj="RowOperations";a.MZg="ColumnOperations";a.wVj="ViewModeRowOperations";a.vVj="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.auj="ShapeStyle";a.hCh="FloatingObjectClipboard";a.mGf="PivotTableCopyDelete";a.oGf="PivotTableFieldListActions";a.Xwe="CellFloatie";a.Xtj="ShapeFloatie";a.contextMenu="ContextMenu";a.U0h="GridContextMenu";a.FXi=
"PivotTableContextMenu";a.iCh="FloatingObjectContextMenu";a.tVg="CellRTEFloatie";a.x0f="ShapeRTEFloatie";Object(x.a)(a,"FloatieGroupIdentifiers",null,[])},1050:function(x,C,b){function a(v,u,t){var y=n.call(this,u)||this;y.zR=!1;y.Vjc=!1;y.FNa=null;y._selectedRowListBox=null;y.Sn=null;y.nyf=function(E){return y.onItemClick(E)};y.TAd=function(E){h.g(E.Ca);y.raiseEvent(a.B4a);y.raiseEvent(a.pOd);return!0};y.onScroll=function(E){h.g(E);y.mGd();y.raiseEvent(a.B4a)};y.onBlur=function(E){h.g(E);y.mGd()};
y.onPointerDown=function(){y.mGd();y.raiseEvent(a.B4a);y.raiseEvent(a.yPa);return!1};y.yEb=function(E){var B=E.Ca;if(B.button===Sys.UI.MouseButton.leftButton||B.button===Sys.UI.MouseButton.rightButton||m.EwaSettings.isChangeGateEnabled("OfficeVSO:6154487_EnableTouchInputInDVDropDown")&&B.type.includes("touch"))y.Vk=y.Cac(B),y.onPointerDown(E);y.raiseEvent(a.Rrd);return!1};y.wb=v;y.GBb=t;y.ZAa(!0);return y}b.d(C,"a",function(){return a});x=b(0);var c=b(90),e=b(230),f=b(13),l=b(178);C=b(242);var m=
b(1),r=b(12),h=b(72),w=b(22),n=C.a;Am(a,n);a.prototype.N9=function(v){this.get_events().addHandler(a.B4a,v)};a.prototype.nda=function(v){this.get_events().removeHandler(a.B4a,v)};a.prototype.xZb=function(v){this.get_events().addHandler(a.Qkd,v)};a.prototype.Rsc=function(v){this.get_events().removeHandler(a.Qkd,v)};a.prototype.Gnb=function(v){this.get_events().addHandler(a.pOd,v)};a.prototype.pIb=function(v){this.get_events().removeHandler(a.pOd,v)};a.prototype.MYa=function(v){this.get_events().addHandler(a.yPa,
v)};a.prototype.sbb=function(v){this.get_events().removeHandler(a.yPa,v)};a.prototype.pVc=function(v){this.get_events().addHandler(a.Rrd,v)};a.prototype.nJd=function(v){this.get_events().removeHandler(a.Rrd,v)};a.prototype.dispose=function(){this.R7(!1);this.ZAa(!1);c.a.zc([this.FNa]);this.FNa=null;n.prototype.dispose.call(this)};a.prototype.Cac=function(v){return r.DOMElementExtensions.ped(v.target,"tr",!0)};a.prototype.BB=function(v){if(v){if(!this.Vk){var u=this.Sn;if(!u||!u.rows.length)return;
this.Vk=u.rows[0];0<v?v--:v++}u=this.Vk;for(var t=0,y=Math.abs(v);t<y;t++)if(0>v){if(!u.previousSibling)break;u=u.previousSibling}else{if(!u.nextSibling)break;u=u.nextSibling}u&&(this.Vk=u)}};a.prototype.inb=function(v,u){r.DOMElementExtensions.toggleCssClass(v,this.GBb.ListTableClassInTouch,u)};a.prototype.R7=function(v){var u=this.Sn;u&&(v&&!this.Vjc?(e.a.instance.pa(f.a.click,u,this.nyf),e.a.instance.pa(f.a.kk,u,this.TAd),l.a.instance.pa(f.a.pointerDown,u,this.yEb),this.Vjc=!0):this.Vjc&&(e.a.instance.za(f.a.click,
u,this.nyf),e.a.instance.za(f.a.kk,u,this.TAd),l.a.instance.za(f.a.pointerDown,u,this.yEb),this.Vjc=!1))};a.prototype.sBa=function(v){var u=null;v&&(u=r.DOMElementExtensions.Pj(v,this.GBb.ListCellClass))&&u.classList.toggle(this.GBb.ListCellSelectedClass);return u};a.prototype.ZAa=function(v){this.dg&&(v&&!this.zR?(this.FNa=this.he.Zd(this.dg),this.FNa.ka("scroll",this.onScroll),this.FNa.ka("blur",this.onBlur),l.a.instance.pa(f.a.pointerDown,this.domElement,this.onPointerDown),this.zR=!0):this.zR&&
(c.a.Ha(this.FNa),this.FNa=null,l.a.instance.za(f.a.pointerDown,this.domElement,this.onPointerDown),this.zR=!1))};a.prototype.onItemClick=function(v){return this.TAd(v)};a.prototype.Yuc=function(v){if(v){var u=v.offsetTop,t=this.dg.scrollTop;u<t?this.ZVf(!0):u+v.offsetHeight>t+this.dg.clientHeight&&this.ZVf(!1)}};a.prototype.ZVf=function(v){this.dg.scrollTop=v?this.Vk.offsetTop:this.Vk.offsetTop+this.Vk.offsetHeight-this.dg.clientHeight};a.prototype.mGd=function(){w.g(this.$).isEditing&&this.raiseEvent(a.Qkd)};
Ek.Object.defineProperties(a.prototype,{Vk:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(v){this.sBa(this._selectedRowListBox);v?(this._selectedRowListBox=v,this.sBa(this._selectedRowListBox),this.Yuc(v)):this._selectedRowListBox=null}},A_:{configurable:!0,enumerable:!0,get:function(){return this.GBb.ListCellClass}},Xba:{configurable:!0,enumerable:!0,get:function(){return this.GBb.ListTableClass}},hI:{configurable:!0,enumerable:!0,get:function(){return 8}},
yCb:{configurable:!0,enumerable:!0,get:function(){return 5}},Tjc:{configurable:!0,enumerable:!0,get:function(){return 24}},Sjc:{configurable:!0,enumerable:!0,get:function(){return 35}},dg:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});a.B4a="GotFocus";a.Qkd="IgnoreBlur";a.pOd="SetCell";a.yPa="PointerDown";a.Rrd="ItemPointerDown";Object(x.a)(a,"ListBox",C.a,[845,3])},1116:function(x,C,b){function a(r,h){var w=
m.call(this,h.textBox.domElement)||this;w.JXc=null;w.SFi=function(){w.tzd()};w.fwf=function(n,v){w.ug(n,v)};w.kwf=function(n,v){w.gj(n,v)};w.wb=r;w.dJ=h;h.QY&&(h.QY.add(w),h.ml(w.kwf),h.mo(w.fwf));return w}b.d(C,"a",function(){return a});x=b(0);var c=b(90);C=b(88);var e=b(47),f=b(44),l=b(72),m=C.a;Am(a,m);a.prototype.dispose=function(){var r=this.dJ;if(null===r||void 0===r?0:r.QY)r.QY.remove(this),r.fl(this.kwf),r.Dn(this.fwf);c.a.Ha(this.JXc);this.dJ=null;m.prototype.dispose.call(this)};a.prototype.Wh=
function(r,h){switch(h){case -1470715894:case -1231471547:this.BU(!1);break;default:if(this.RFd(r,h))return l.g(r),!0;a.Eji(h)||this.BU(!1)}return!1};a.prototype.BU=function(){c.a.Ha(this.JXc);this.JXc=e.a.instance.create(this.SFi,10,f.a.Mri)};a.prototype.gj=function(){this.BU(!1)};a.Eji=function(r){switch(r){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};Ek.Object.defineProperties(a.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Ya:{configurable:!0,
enumerable:!0,get:function(){return this.dJ}}});Object(x.a)(a,"ListAutoCompleteBehavior",C.a,[830,3])},1259:function(x,C,b){function a(n){var v=w.call(this,document.createElement("div"))||this;v.tIa=!1;v.uIa=!1;v.Nta=!1;v.Lta=!1;v.Mta=!1;v.zR=!1;v.dJ=null;v.visible=void 0;v.qnc=function(u,t){v.tt(u,t)};v.vLa=function(){v.Ya.textBox.kK=!0};v.Hya=function(){v.fz(!0)};v.Ktf=function(){v.Ya.textBox.focus()};v.Rh=function(){m.g(v.$).inRangePicker||(v.isListVisible=!1)};v.$=n;m.g(n)&&m.g(n).ha&&m.g(v.$).ha.zJ(v.Rh);
v.Hk=e.a.h5();v.n6a=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1);return v}b.d(C,"a",function(){return a});x=b(0);C=b(242);var c=b(5),e=b(37),f=b(1),l=b(10),m=b(22),r=b(33),h=b(4),w=C.a;Am(a,w);a.prototype.get_visible=function(){return this.n6a?void 0!==this.visible?this.visible:this.visible=w.prototype.get_visible.call(this):w.prototype.get_visible.call(this)};a.prototype.set_visible=function(n){if(!this.n6a)return w.prototype.set_visible.call(this,
n);if(this.visible===n)return n;this.visible=n;return w.prototype.set_visible.call(this,n)};a.prototype.tt=function(){this.JBa(!1);this.St.tt()};a.prototype.dispose=function(){this.$&&m.g(this.$)&&m.g(this.$).ha&&m.g(this.$).ha.lO(this.Rh);this.$=null;w.prototype.dispose.call(this)};a.prototype.Wh=function(n,v,u){n=!1;if((this.O0a||(void 0===u?0:u))&&!this.Mwa()&&this.get_visible()&&this.isListVisible)switch(this.Hk&&this.wBc(v),v){case 1872288872:this.isListVisible=!1;n=!0;break;case -798660877:this.St.BB(1);
n=!0;break;case 137938150:this.St.BB(-1);n=!0;break;case 2091832999:this.St.BB(this.hI-1);n=!0;break;case 742457698:this.St.BB(-(this.hI-1));n=!0;break;case 125627505:n=this.fz(!1);break;case 267796030:e.a.h5()&&(n=this.fz(!1))}return n};a.prototype.JBa=function(n){if(this.isListVisible||n){var v=m.g(this.$);n=v.domElement;var u=this.dJ.textBox.domElement,t=r.a(this.$).Ei(u.offsetHeight),y=r.a(this.$).Ei(u.offsetTop),E=r.a(this.$).Ei(u.offsetWidth);u=r.a(this.$).Ei(u.offsetLeft);v=v.Dj;var B=h.AFrameworkApplication.ta&&
h.AFrameworkApplication.ta.Qa.Wg,z=$get(this.$.Mb+c.a.S_a,this.$.domElement);B&&(z=document.getElementById("EditorContainer"));var M=new Sys.UI.Point(v?this.St.G$b:0,v?this.VDh:a.q1h);t=z.offsetTop+M.y+(e.a.jN(this.$)&&v?0:t+y);this.$.wba||(y=$get(c.a.lGa,this.$.domElement),t+=y&&!B?y.offsetHeight:0);y=this.domElement;y.style.top=l.HelperMethods.nc(t);u=z.offsetLeft+u+M.x;!e.a.jN(this.$)&&this.$.isChromeRtl?y.style.right=l.HelperMethods.nc(v?this.St.G$b:n.offsetLeft+n.offsetWidth-u-E):y.style.left=
l.HelperMethods.nc(u)}};a.prototype.OSa=function(n){this.St&&(n&&!this.zR?(this.St.N9(this.Ktf),this.St.xZb(this.vLa),this.St.Gnb(this.Hya),this.zR=!0):this.zR&&(this.St.nda(this.Ktf),this.St.Rsc(this.vLa),this.St.pIb(this.Hya),this.zR=!1))};a.prototype.wBc=function(n){switch(n){case -798660877:case 137938150:case 2091832999:case 742457698:this.tIa=!0;break;case 125627505:this.Nta=!0;break;case 267796030:e.a.h5()&&(this.Lta=!0)}};Ek.Object.defineProperties(a.prototype,{hI:{configurable:!0,enumerable:!0,
get:function(){return this.St.hI}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.St.isListVisible},set:function(n){this.St.isListVisible=n}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.dJ},set:function(n){(this.dJ=n)&&this.dJ.j_d.add(this)}},VDh:{configurable:!0,enumerable:!0,get:function(){return e.a.jN(this.$)?-5:-40}}});a.G$b=0;a.q1h=1;Object(x.a)(a,"AutoCompleteControl",C.a,[780])},1260:function(x,C,b){function a(e,f,l,m){f=void 0===f?0:f;l=void 0===
l?"":l;m=void 0===m?"":m;var r=c.call(this)||this;r.length=e;r.selectedIndex=f;r.dG=l;r.description=m;return r}b.d(C,"a",function(){return a});x=b(0);var c=Sys.EventArgs;Am(a,c);Object(x.a)(a,"ListEventArgs",Sys.EventArgs,[])},1261:function(x,C,b){function a(y,E){y=t.call(this,y,E,new u.a(f.a.listItem,f.a.HBb,f.a.MBb,f.a.NBb))||this;y.adc=!1;y.Fq=null;y.Elb=null;y.TUe=!1;y.visible=void 0;y.ZAa(!0);y.TUe=w.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");y.n6a=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",
!1);return y}b.d(C,"a",function(){return a});x=b(0);var c=b(14),e=b(24);C=b(1050);var f=b(983),l=b(5),m=b(79),r=b(37),h=b(12),w=b(1),n=b(115),v=b(22),u=b(1115),t=C.a;Am(a,t);a.prototype.Xxa=function(){var y=460,E=v.g(this.$),B=E.domElement,z=this.kTa.style,M=this.dg.offsetTop+this.Vk.offsetHeight*this.Vk.sectionRowIndex-this.dg.scrollTop;z.width="auto";z.whiteSpace="nowrap";z.position=e.a.Ugc?"relative":"absolute";var Q=B.offsetLeft+B.offsetWidth-(this.domElement.offsetLeft+this.dg.offsetLeft+this.dg.offsetWidth+
3);B=this.domElement.offsetLeft-3-(B.offsetLeft+this.G$b);y=Math.min(this.kTa.offsetWidth,y,Math.max(Q,B));h.DOMElementExtensions.Kr(this.kTa,y);z.whiteSpace="";z.position="absolute";M+3>this.dg.offsetTop+this.dg.offsetHeight||M<this.dg.offsetTop||(y=this.dg.offsetLeft-3-this.kTa.offsetWidth,z=this.dg.offsetLeft+this.dg.offsetWidth+3,h.DOMElementExtensions.updatePosition(this.kTa,B>Q!==E.rtl?y:z,M,!1))};a.prototype.BB=function(y){t.prototype.BB.call(this,y);this.Xxa()};a.prototype.tt=function(){this.Xxa()};
a.prototype.Tra=function(){var y=this.Sn,E=this.dg,B=3===m.a.Ub||e.a.rp,z=B?this.yCb:this.hI;this.isListVisible=!0;E.style.height="auto";this.tGa.set_visible(!0);this.inb(y,B);this.Fq.length>z?(h.DOMElementExtensions.XI(E,Math.floor(E.offsetHeight*z/this.Fq.length)),E.style.overflowY="auto"):(E.style.height="auto",E.style.overflowY="hidden");h.DOMElementExtensions.Kr(E,y.offsetWidth+(this.Fq.length>z?n.a.xu:0))};Ek.Object.defineProperties(a.prototype,{G$b:{configurable:!0,enumerable:!0,get:function(){if(r.a.jN(this.$)){var y=
document.getElementById(this.$.Mb+l.a.SUe);return!this.TUe||y?h.DOMElementExtensions.getBoundingClientRect(y).x:0}y=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(l.a.mxd):document.getElementById(this.$.Mb+l.a.mxd+"-"+l.a.Fqf);c.ULS.shipAssertTag(537170323,0,!!y||this.$.kN,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return y?y.offsetWidth:0}},xe:{configurable:!0,enumerable:!0,get:function(){return this.Elb},
set:function(y){this.Elb=y}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.n6a?void 0!==this.visible?this.visible&&0<this.Fq.length:(this.visible=h.DOMElementExtensions.isVisible(this.dg))&&0<this.Fq.length:h.DOMElementExtensions.isVisible(this.dg)&&0<this.Fq.length},set:function(y){this.n6a&&this.visible===y||(h.DOMElementExtensions.setVisible(this.dg,y),h.DOMElementExtensions.setVisible(this.kTa,y),this.n6a&&(this.visible=y));var E=v.g(this.$).view;y?this.adc||(E.Vs(this.tGa.qnc),
this.adc=!0):(Array.clear(this.Fq),this.adc&&(E.Xq(this.tGa.qnc),this.adc=!1))}}});Object(x.a)(a,"AutoCompleteListBox",C.a,[])},1308:function(x,C,b){function a(bc,Kb,ic,wb){var Wa=Cd.call(this,bc,"PopulateGridContextMenu",1247109494,-2064931494,a.c1h,!0,!1,a.bJb,Kb,ic,!0,wb)||this;Wa.LAa=!1;Wa.Uva=!1;Wa.zZ=!1;Wa.refresh=!1;Wa.expandCollapse=!1;Wa.xic=!1;Wa.TDe=!0;Wa.grid=Gb.g(bc);Wa.glc=!0;Wa.$fc=Ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1);if(Wa.$fc){var Xb=
Nb.GetServiceTaskFactory.Va(Wa.$.da,309,310,3),Gc=Nb.GetServiceTaskFactory.create(Wa.$.da,18,Wa.la,3);va.TaskExtensions.Ba(va.TaskExtensions.ye([Xb,Gc],Wa.la),function(){Wa.$.da.$a(268,function(zb){Wa.E4a=new c(bc,Xb.result,Gc.result,zb)})},Wa.la,3)}return Wa}function c(bc,Kb,ic,wb){this.MWc=this.seb=this.ueb=0;this.$=bc;this.gridView=Gb.g(this.$);this.namedSheetViewPublic=Kb;this.Ug=ic;this.instantaneousSupportInformationManager=wb;this.IMa=ob.a.dnd()}function e(bc){this.ranges=null;this.ranges=
bc}function f(bc,Kb,ic,wb,Wa,Xb,Gc,zb){this.$=Kb;this.Ra=ic;this.yl=wb;this.selectedRanges=Wa;this.grid=Xb;this.Oy=zb;this.pba=Gc;this.Yra=w.a.all(Wa,function(hc){return hc.isRow});this.Vga=w.a.all(Wa,function(hc){return hc.ef});this.qDb=w.a.all(Wa,function(hc){return!hc.isRow&&!hc.ef});Kb=Xb.Rb.Zgd(Wa);this.L4b=!!Kb;this.bRf=!!Kb&&Kb.hasActiveFilter;this.menuSection=ic.Pc();bc.Ec.push(this.menuSection);this.jka=this.Yra||this.Vga?this.menuSection:ic.Pc();this.Jta=this.Yra||this.Vga?this.menuSection:
ic.Pc()}b.r(C);x=b(0);var l=b(14),m=b(287),r=b(93),h=b(39),w=b(275),n=b(611),v=b(4),u=b(83),t=b(438),y=b(929),E=b(9),B=b(31),z=b(19),M=b(60),Q=b(5),P=b(998),L=b(1240),ca=b(1049),U=b(15),aa=b(37);f.prototype.qcd=function(){this.SFh();this.wFh();var bc=this.Oy.c7a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Ra.Bb(bc?149:148))};f.prototype.XFh=function(){var bc=0;this.L4b?this.pba.Nm(942362098)?bc=this.Oy.Nm(this.yl,942362098,this.selectedRanges,this.grid)?161:169:this.bRf&&(bc=
this.Oy.Nm(this.yl,-1113896058,this.selectedRanges,this.grid)?177:181):this.pba.Nm(-1113896058)&&(bc=this.Yra?this.Oy.Nm(this.yl,-1113896058,this.selectedRanges,this.grid)?49:116:this.Oy.Nm(this.yl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==bc&&this.jka.buttons.push(this.Ra.Bb(bc))};f.prototype.TFh=function(){var bc=0;this.L4b?this.pba.Nm(622604322)&&(bc=this.grid.rtl?this.Oy.Nm(this.yl,622604322,this.selectedRanges,this.grid)?191:192:this.Oy.Nm(this.yl,622604322,this.selectedRanges,
this.grid)?162:170):this.pba.Nm(1415868706)&&(bc=aa.a.Ezb()&&this.grid.rtl?this.Vga?this.Oy.Nm(this.yl,1415868706,this.selectedRanges,this.grid)?288:289:this.Oy.Nm(this.yl,1415868706,this.selectedRanges,this.grid)?290:291:this.Vga?this.Oy.Nm(this.yl,1415868706,this.selectedRanges,this.grid)?50:117:this.Oy.Nm(this.yl,1415868706,this.selectedRanges,this.grid)?178:182);0!==bc&&this.jka.buttons.push(this.Ra.Bb(bc))};f.prototype.RFh=function(){this.pba.Nm(1035996630)&&(this.Oy.Nm(this.yl,1035996630,this.selectedRanges,
this.grid)?(this.jka.buttons.push(this.Ra.Bb(this.grid.rtl?187:165)),this.jka.buttons.push(this.Ra.Bb(166))):(this.jka.buttons.push(this.Ra.Bb(this.grid.rtl?188:173)),this.jka.buttons.push(this.Ra.Bb(174))))};f.prototype.SFh=function(){var bc=b(1308).GridContextMenu,Kb=null;this.qDb&&(Kb=this.Ra.ww("ContextMenu.InsertCells",null,U.a.instance.fa(349),1896159024),Kb.menu.Ec.push(this.jka));bc.UFh(this.jka,this.Ra,this.$);this.XFh();this.TFh();this.RFh();Kb&&0<this.jka.buttons.length&&this.menuSection.buttons.push(Kb)};
f.prototype.yFh=function(){var bc=0;this.L4b?this.pba.Nm(1405456548)?bc=this.Oy.Nm(this.yl,1405456548,this.selectedRanges,this.grid)?163:171:this.bRf&&(bc=this.Oy.Nm(this.yl,1554436520,this.selectedRanges,this.grid)?179:183):this.pba.Nm(1554436520)&&(bc=this.Yra?this.Oy.Nm(this.yl,1554436520,this.selectedRanges,this.grid)?51:118:this.Oy.Nm(this.yl,1554436520,this.selectedRanges,this.grid)?179:183);0!==bc&&this.Jta.buttons.push(this.Ra.Bb(bc))};f.prototype.xFh=function(){var bc=0;this.L4b?this.pba.Nm(284490184)&&
(bc=this.Oy.Nm(this.yl,284490184,this.selectedRanges,this.grid)?164:172):this.pba.Nm(674605324)&&(bc=this.Vga?this.Oy.Nm(this.yl,674605324,this.selectedRanges,this.grid)?52:119:this.Oy.Nm(this.yl,674605324,this.selectedRanges,this.grid)?180:184);0!==bc&&this.Jta.buttons.push(this.Ra.Bb(bc))};f.prototype.vFh=function(){this.pba.Nm(1035996630)&&(this.Oy.Nm(this.yl,1035996630,this.selectedRanges,this.grid)?(this.Jta.buttons.push(this.Ra.Bb(this.grid.rtl?189:167)),this.Jta.buttons.push(this.Ra.Bb(168))):
(this.Jta.buttons.push(this.Ra.Bb(this.grid.rtl?190:175)),this.Jta.buttons.push(this.Ra.Bb(176))))};f.prototype.wFh=function(){var bc=null;this.qDb&&(bc=this.Ra.ww("ContextMenu.DeleteCells",null,U.a.instance.fa(412),-1554384558),bc.menu.Ec.push(this.Jta));this.yFh();this.xFh();this.vFh();bc&&0<this.Jta.buttons.length&&this.menuSection.buttons.push(bc)};Object(x.a)(f,"CellsContextMenuGenerator",null,[]);Object(x.a)(e,"MacroRecorderRangeHyperlinkRemovedPayload",null,[445]);var F=b(590),D=b(25),J=b(102),
R=b(79),Z=b(75),W=b(46),ka=b(175),ma=b(84),pa=b(702),xa=b(150),va=b(36),ta=b(617),fa=b(621),Ca=b(1),Sa=b(186),Gb=b(22),kb=b(389),lb=b(33),Nb=b(51),Aa=b(247),qa=b(21),Xa=b(29),Ha=b(1251),Ra=b(1114),mb=b(131),La=b(562),ha=b(387),Ia=b(167),gb=b(158),Sb=b(357),wc=b(95),tc=b(30),Tb=b(292),pb=b(291),cb=b(132),ob=b(981),rc=b(982),Db=b(144),Ja=b(41),Qb=b(55),yc;(function(bc){bc[bc.none=0]="none";bc[bc.once=1]="once";bc[bc.twice=2]="twice"})(yc||(yc={}));Object(x.b)("ToggleState",yc);c.prototype.ugh=function(){var bc=
this.wV(),Kb={};bc=(Kb.CommandValueId=Ja.c(bc),Kb);Kb=new wc.a(-2058042992,2,this.$.ed,19,null);l.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Xb(Kb,bc)};c.prototype.Kgh=function(){var bc=new wc.a(644342024,2,this.$.ed,19,null);l.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.Xb(bc)};c.prototype.zgh=function(){var bc=this.gridView.ha.sa.activeCell,
Kb=this.$.da.Aa(66).Eg,ic=this.$.da.Aa(66).Qub(bc);return Kb||ic?this.Bgh(Kb,ic,bc):this.Agh(bc)};c.prototype.Bgh=function(bc,Kb,ic){if(this.hWg(bc,Kb,ic))return l.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Qb.Task.Sa(!1);if(null!=bc&&bc.hasAutoFilter||null!=Kb&&Kb.h_a.every(function(wb){return 0!=wb.length}))return this.ueb=yc.none,this.KWc();this.ueb=yc.once;return this.g7b(yc.once)};c.prototype.Agh=function(bc){var Kb=
W.v(this.gridView.ha.sa.qd,this.$);Kb=this.gridView.$.xa.getItemByName(Kb.SheetName);var ic=W.D(Kb.P0);if(this.gWg(ic,bc))return l.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Qb.Task.Sa(!1);if(Kb.hasAutoFilter){if(ic&&ic.contains(this.gridView.ha.sa.activeCell))return this.ueb=yc.none,this.KWc();this.ueb=yc.twice;return this.g7b(yc.twice)}this.ueb=yc.once;return this.g7b(yc.once)};c.prototype.g7b=function(bc){function Kb(zb){Tb.a(zb)?
l.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}",tc.a.Wc(zb.Errors)):(l.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),bc===yc.twice?wb.g7b(yc.once):wb.KWc())}function ic(){return new Ha.a(Wa)}var wb=this,Wa=W.v(this.gridView.ha.sa.qd,this.$);if(!Wa)return Qb.Task.Sa(!1);this.seb||(this.seb=Date.now());var Xb=new wc.a(368460465,2,this.$.ed,19,null),Gc=this.$.na.ua.hc();return Ca.EwaSettings.qc()?
ha.a(this.$.userOperationManager,function(zb,hc,Uc){return ma.kb(wb.$.na.ua,Wa,pb.b(zb,Kb),hc,Uc,null,Gc)},function(zb){return new ka.a(516,0,zb,64,ic)},Xb):ha.a(this.$.userOperationManager,function(zb,hc,Uc){return ma.kb(wb.$.na.ua,Wa,pb.b(zb,Kb),hc,Uc,null,Gc)},function(zb){return new La.a(516,0,zb,void 0,ic)},Xb)};c.prototype.hWg=function(bc,Kb,ic){return null!=bc&&Ia.d(bc)&&ic.top===bc.usedRange.top||null!=Kb&&Kb.eba&&ic.top===Kb.top?(this.drc(this.$,224),!0):null!=bc&&Ia.g(bc)&&ic.top===bc.usedRange.bottom?
(this.drc(this.$,225),!0):!1};c.prototype.gWg=function(bc,Kb){if(bc&&bc.contains(Kb)&&Kb.top===bc.top||!bc&&this.eVg(Kb.top,Kb.left))return this.drc(this.$,226),!0;bc=new D.Range(Kb.top,Kb.left,Kb.top+1,Kb.left+1,!1,!1);return this.gridView.Rb.JMa(bc)?(this.drc(this.$,227),!0):!1};c.prototype.drc=function(bc,Kb){Kb=tc.a.gd(1,1,751,Kb,0,147079615,"ContextMenuFilterByCellValueError");Ca.EwaSettings.Iz()?new Sb.a(bc,Kb):(bc=new gb.ErrorDialog(bc,Kb),bc.initialize(),bc.kf())};c.prototype.KWc=function(){function bc(zb){var hc=
{};hc=(hc.ToggleFilterOperationCount=Kb.ueb,hc.ApplyFilterTime=Kb.MWc?Date.now()-Kb.MWc:-1,hc.ToggleAndApplyFilterTime=Kb.seb?Date.now()-Kb.seb:-1,hc.FilterByValueType=wb.AutoFilterType,hc);l.ULS.sendTraceTag(527500295,0,50,"GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : {0}",JSON.stringify(hc));Kb.seb&&(Kb.seb=0);ob.a.uxc(zb)&&(hc=ob.a.jac(zb),Kb.IMa?ob.a.xQa(rc.a.filterByCellValue,hc.MessageIdName,Db.a.nsa,!0,ob.a.isSessionEndingError(hc.MessageId)):l.ULS.sendTraceTag(527500294,0,10,
"GridContextMenuFilter::ApplyFilterByValue failed with FilterException -{0}",hc.MessageIdName));Tb.a(zb)?l.ULS.sendTraceTag(527500292,0,50,"GridContextMenuFilter::ApplyFilterByValue service call failed with errors : {}",tc.a.Wc(zb.Errors)):(l.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),cb.b(Kb.$).Vd(mb.a.exf,Kb.lm(),void 0,!0),zb={},zb.FirstRow=Kb.uOh(),zb.FirstColumn=wb.Column,-1!==zb.FirstRow&&(zb=W.C(zb),Kb.CL(zb)))}var Kb=this;this.MWc=Date.now();
var ic=this.u_h();if(!ic)return l.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Qb.Task.Sa(!1);var wb=this.wV(),Wa={FirstRow:0};Wa.FirstColumn=wb.Column;Wa.SheetName=wb.SheetName;cb.b(this.$).Vd(mb.a.ztf,this.lm(),void 0,!0);var Xb=this.m3c(wb,Wa),Gc=new ka.a(208,0,function(zb,hc,Uc){return ma.a(Kb.$.na.ua,Xb,ic,pb.b(zb,bc),hc,Uc,null,null)},6,function(){return new Ra.a(ic,Xb)});this.namedSheetViewPublic?this.namedSheetViewPublic.OAa().continueWith(function(zb){zb.result&&
Kb.$.userOperationManager.ic(Gc,null)}):this.$.userOperationManager.ic(Gc,null);return Qb.Task.Sa(!0)};c.prototype.CL=function(bc){aa.a.Fba(this.$)&&va.TaskExtensions.Ba(Nb.GetServiceTaskFactory.Va(this.$.da,430,431,1),function(Kb){Kb.result.qea(bc);l.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.la,3)};c.prototype.lm=function(){var bc={};return bc.Location="contextMenu",bc};c.prototype.wV=function(){var bc=
0,Kb=this.gridView.ha.sa.activeCell;var ic=this.$.da.Aa(66).Eg;var wb=this.$.da.Aa(66).Qub(Kb);if(ic){var Wa="Table";bc=ic.objectId}else wb?(Wa="Table",bc=wb.id):Wa="Sheet";ic=Kb.left;Kb={};Kb.AutoFilterType=Wa;Kb.Column=ic;Kb.Id=bc;Wa={};this.$.Bj(Wa);Wa.FirstRow=0;Wa.FirstColumn=Kb.Column;bc=this.$.ea.isNamedObjectViewMode;Kb.NamedObjectView=bc;Kb.SheetName=bc?Wa.NamedObjectName:Wa.SheetName;Kb.ItemListOptions=null;return Kb};c.prototype.eVg=function(bc,Kb){bc=D.Range.hd(bc,Kb);return this.gridView.Ea.k$(bc,
this.$.qa.name)&&(bc=this.gridView.Ea.$3a(bc))&&bc.autoFilterMenu?!0:!1};c.prototype.u_h=function(){var bc=null,Kb=this.gridView.kc(this.gridView.ha.sa.activeCell);if(!Kb)return null;var ic=Kb.cell.zTd;var wb=this.instantaneousSupportInformationManager.Oeb(ic,!1).category;if(1===Kb.Hu.type)if(3===wb){if(!Kb.cell.m9a)return l.ULS.sendTraceTag(527500290,0,15,"GridContextMenuFilter::GetValueForFilter() for category : {0}. NumFmt is null. ",wb),null;bc=(Kb.cell.m9a.Start+Kb.cell.m9a.End).trim()}else if(!wb&&
(qa.a.u0a(Kb.Hu.value,"E")||qa.a.u0a(Kb.originalText,"E"))){bc=this.Ug.IUe(Kb.Hu.value,ic,1,Number.POSITIVE_INFINITY,Kb.cell.R$);if(!bc.success)return l.ULS.sendTraceTag(527500289,0,50,"GridContextMenuFilter::GetValueForFilter() for category : {0}. Failed to acquire formatted value",wb),null;bc=bc.xz}bc||(bc=Kb.originalText);return Xa.a.h0c(bc)?["[Blanks]"]:["i"+bc.trim()]};c.prototype.uOh=function(){var bc=this.gridView.ha.sa.activeCell,Kb=this.$.da.Aa(66).Eg,ic=this.$.da.Aa(66).Qub(bc);if(Kb)return Kb.usedRange.top;
if(null!=ic)return ic.top;Kb=this.$.xa.getItemByName(this.$.qa.sheetName);return(Kb=W.D(Kb.P0))&&Kb.contains(bc)?Kb.top:-1};c.prototype.m3c=function(bc,Kb){var ic={};ic.Location=Kb;ic.FieldId=bc.Id.toString();ic.DataSourceIndex=-1;ic.FilterType=bc.AutoFilterType;ic.AnchorType=0;ic.ChartId=null;ic.AnchorValue1=-1;ic.AnchorValue2=-1;ic.Property=bc.RichProperty;return ic};Object(x.a)(c,"GridContextMenuFilter",null,[]);b.d(C,"GridContextMenu",function(){return a});var Cd=y.a;Am(a,Cd);a.prototype.dispose=
function(){Cd.prototype.dispose.call(this);this.grid=null};a.prototype.Zc=function(bc,Kb){bc=!this.rqd(bc,Kb);if(!bc)switch(Kb){case -1977666927:bc=null==this.E4a||this.Bvj();break;case 1549396389:bc=null==this.E4a||!this.Zei();break;case 2045563128:case 1803952894:bc=null==this.E4a||!this.$.isEditMode&&!this.$ei()}return bc};a.prototype.rqd=function(bc,Kb){var ic=this.grid.ha.sa.selectedRanges;return(new xa.a(this.$.xa)).Nm(bc,Kb,ic,this.grid)};a.prototype.executeCommand=function(bc,Kb,ic){var wb=
Kb.command;bc=null;switch(wb){case -1396319072:if(Kb=this.grid.kc(null))m.a.instance.YZc(!0),r.EventHandlerManager.instance.Dbd(),a.bUi(Kb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.sa.selectedRanges,Kb);break;case 324156914:bc=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(ic);break;case -1977666927:bc=this.E4a.ugh();break;case 1549396389:bc=this.E4a.Kgh();break;case 1803952894:bc=this.E4a.zgh();break;default:bc=Sa.a(wb)}return bc||va.TaskExtensions.L4()};
a.prototype.Lc=function(bc,Kb,ic){bc=!1;switch(Kb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:bc=!0;break;case 1441131127:bc=!!ic}return bc};a.prototype.iZ=function(bc){bc=void 0===bc?!1:bc;var Kb=!1,ic=!1,wb=0;Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(wb=h.a.Ce());var Wa=this.Ra.Yp(this.menuId),Xb=this.grid.ha.sa,Gc=Xb.Ig,zb=Gc&&Xb.qd.ef,hc=Gc&&Xb.qd.isRow;Xb=Xb.selectedRanges;var Uc=
w.a.all(Xb,function(ba){return ba.ef}),jb=w.a.all(Xb,function(ba){return ba.isRow}),$a=W.O(Xb),I=W.P(Xb);this.hff(zb,hc)?(Kb=!0,this.zGh(Wa)):this.$.isEditMode?kb.a(this.$)?this.AGh(Wa,zb,hc):(this.zFh(Wa,!(hc||zb||!this.xic)),this.VFh(Wa,Xb,bc),this.LFh(Wa,Uc,jb,$a,I),this.WVe(Wa,Gc,zb,hc),this.SGh(Wa),this.AVe(Wa,zb,hc),this.qGh(Wa,Gc,zb,hc,Xb),this.CFh(Wa),this.AFh(Wa,Xb),this.bGh(Wa),this.NGh(Wa,Gc),Ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.PFh(Wa)):
(ic=!0,kb.a(this.$)?this.QVe(Wa):this.hHh(Wa,Gc,zb,hc,Xb));Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(bc=h.a.Ce()-wb,l.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",bc,Kb,ic,this.TDe));this.TDe=!1;return Wa};a.prototype.gKa=function(bc){var Kb=[];if(kb.a(this.$))return Kb;if(3===bc){bc=this.grid.ha.sa;var ic=bc.Ig,wb=ic&&bc.qd.ef,Wa=ic&&bc.qd.isRow,
Xb=!1,Gc=!1,zb=!1;this.$.isMobileMode&&(Gc=bc.selectedRanges,Xb=W.O(Gc),Gc=W.P(Gc));if(ic){var hc=Gb.e(this.grid);hc&&hc.range.contains(bc.qd)&&this.YV(hc)&&(zb=!0)}this.$.isEditMode?this.hff(wb,Wa)?Array.addRange(Kb,[ca.a.mGf,ca.a.oGf]):wb||Wa?(Kb.push(ca.a.clipboard),Wa?Kb.push(ca.a.Whj):wb&&Kb.push(ca.a.MZg)):(Array.addRange(Kb,[ca.a.edit,ca.a.clipboard]),zb?Kb.push(ca.a.hyperlink):Kb.push(ca.a.color),ic&&Kb.push(ca.a.yMg)):(Kb.push(ca.a.copy),zb&&Kb.push(ca.a.openHyperlink),!Wa||this.$.isMobileMode&&
Gc?!wb||this.$.isMobileMode&&Xb||Kb.push(ca.a.vVj):Kb.push(ca.a.wVj));Kb.push(ca.a.U0h)}else 2===bc&&Kb.push(ca.a.Xwe);return Kb};a.prototype.hff=function(bc,Kb){return(this.LAa||this.Uva||this.zZ||this.refresh||this.expandCollapse)&&!(bc||Kb)};a.prototype.showGridContextMenu=function(bc){this.expandCollapse=this.refresh=this.zZ=this.Uva=this.LAa=!1;var Kb=this.$,ic=ta.a(Kb).uKa(),wb=this.grid.ha.sa,Wa=wb.Ig,Xb=Wa&&wb.qd.ef;wb=Wa&&wb.qd.isRow;if(ic&&!Xb&&!wb){Xb=fa.a(Kb);if(null===Xb||void 0===Xb?
0:Xb.RQd)this.LAa=Xb=J.f(Kb.kg),this.Uva=!Xb;Xb=Kb.xc;this.zZ=ic.supportsBIExplore&&!!P.a(Kb)&&Xb.U2(32768);Xb.allowInteractivity&&(Kb=this.grid.kc(null),(null===Kb||void 0===Kb?0:Kb.cell)&&(Kb.cell.NZc||Kb.cell.c2f)&&(this.expandCollapse=!0),Xb.allowManualDataRefresh&&(this.refresh=!0))}Kb=null;ic=1;Xb=Object(u.a)(n.a,bc.eventArgs);bc=Object(u.a)(L.a,bc.creationParams);wb=this.wLh();bc?(Kb=bc.clientPoint,ic=bc.inputMethod):Xb&&1!==Xb.yb?(Kb=new Sys.UI.Point(Xb.clientPoint.x,Xb.clientPoint.y),ic=
Xb.yb):wb&&(Kb=new Sys.UI.Point(wb.x+(this.$.isChromeRtl?0:wb.width),wb.y+wb.height));R.a.Ub=ic;this.xic=3===ic;bc=B.a.ytb;this.Ip(Kb,!Xb||Xb.Ca.target.className!==bc,ic)};a.prototype.removeHyperlinksFromRange=function(bc,Kb){var ic=this;if(!Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Cq(bc,!0)){var wb=W.r(bc,this.$),Wa=this.$.na.ua.hc();this.$.userOperationManager.ic(new ka.a(125,0,function(Xb,Gc,zb){ic.$.Ky();return ma.c(ic.$.na.ua,
wb,"","",!0,!1,127,Xb,Gc,zb,null,Wa)},void 0,function(){return new e(wb)}),Kb);this.grid.rg.dH(!1)}};a.prototype.wLh=function(){var bc=this.grid.kc(null);if((null===bc||void 0===bc?0:bc.cell.mk)&&this.lef(bc))return this.grid.getCellBounds(bc.cell);bc=this.grid.ha.sa.activeCell;return(bc=this.T9b(new D.Range(bc.top,bc.left,E.a.Hh,bc.left,!1,!1),2,!0)||this.T9b(new D.Range(1,bc.left,bc.top,bc.left,!1,!1),2,!1)||this.T9b(new D.Range(bc.top,bc.right,bc.top,E.a.Qh,!1,!1),1,!0)||this.T9b(new D.Range(bc.top,
1,bc.top,bc.right,!1,!1),1,!1)||null)&&bc.mk?this.grid.getCellBounds(bc):Sys.UI.DomElement.getBounds(this.grid.e5a.uc)};a.prototype.lef=function(bc){var Kb=this.grid.rtl,ic=this.$.isChromeRtl;bc=bc.cell;var wb=Gb.g(this.$).$J(bc);return wb?(wb=wb.topLeft,Kb=wb.x+=Kb===ic?bc.offsetWidth:0,ic=wb.y+=bc.offsetHeight,this.grid.view.visibleArea.contains(new M.a(Kb,ic,0,0))):!1};a.prototype.T9b=function(bc,Kb,ic){bc=this.grid.vk("GridContextMenu.FindFirstCellInViewportArea",bc,Kb,ic);try{for(bc.$$rst();bc.$$mn();){var wb=
bc.$$cu();if(wb&&this.lef(wb))return wb.cell}}finally{bc&&bc.dispose()}return null};a.prototype.zGh=function(bc){var Kb=this.Ra,ic=Kb.Pc();this.refresh&&ic.buttons.push(Kb.Bb(100));this.zZ&&ic.buttons.push(Kb.Bb(99));this.LAa?ic.buttons.push(Kb.Bb(59)):this.Uva&&ic.buttons.push(Kb.Bb(58));if(this.expandCollapse){var wb=Kb.ww("ContextMenu.PivotExpandCollapse",null,U.a.instance.fa(1133),589118293);var Wa=Kb.Pc();Wa.buttons.push(Kb.Bb(243));Wa.buttons.push(Kb.Bb(244));Wa.buttons.push(Kb.Bb(245));Wa.buttons.push(Kb.Bb(246));
wb.menu.Ec.push(Wa);wb&&0<Wa.buttons.length&&ic.buttons.push(wb)}bc.Ec.push(ic)};a.prototype.WVe=function(bc,Kb,ic,wb){if(Kb&&!ic&&!wb){Kb=this.Ra.Pc();this.$fc&&!this.$.kN&&this.vcd(Kb);this.Dcd(Kb);this.WGh(Kb);if(Ca.EwaSettings.ma(485)&&Gb.g(this.$).ha.sa.nK()&&Gb.g(this.$).ha.sa.r_)switch(Ca.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Kb.buttons.push(this.Ra.Bb(237));break;case 2:Kb.buttons.push(this.Ra.Bb(238));break;
default:Kb.buttons.push(this.Ra.Bb(236))}bc.Ec.push(Kb)}};a.prototype.Dcd=function(bc){if(!Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:6172529_FixAllowSort")||this.$.xc.allowSorting)if(!Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||!this.$.isMobileMode||(new xa.a(this.$.xa)).me(2048)){var Kb=this.Ra.Pc();Kb.buttons.push(this.Ra.Bb(223));Kb.buttons.push(this.Ra.Bb(224));Ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",
!1)&&(Kb.buttons.push(this.Ra.Bb(292)),Kb.buttons.push(this.Ra.Bb(293)),Kb.buttons.push(this.Ra.Bb(294)));this.$.isMobileMode||Kb.buttons.push(this.Ra.Bb(225));var ic=this.Ra.ww("ContextMenu.sort",null,U.a.instance.fa(228),-864298118);ic.menu.Ec.push(Kb);bc.buttons.push(ic)}};a.prototype.vcd=function(bc){var Kb=this.Ra.ww("ContextMenu.filter",null,U.a.instance.fa(1923),2045563128),ic=this.Ra.Pc(),wb=this.WPh(),Wa=this.Ra.Bb(234);Wa.label=wb;ic.buttons.push(Wa);ic.buttons.push(this.Ra.Bb(235));wb=
this.Ra.Pc();wb.buttons.push(this.Ra.Bb(233));Kb.menu.Ec.push(ic);Kb.menu.Ec.push(wb);bc.buttons.push(Kb)};a.prototype.WGh=function(bc){if(Gb.g(this.$).ha.sa.nK()){var Kb=this.Ra.Pc();Kb.buttons.push(this.Ra.Bb(232));Ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(Kb.buttons.push(this.Ra.Bb(285)),Kb.buttons.push(this.Ra.Bb(286)));var ic=this.Ra.ww("ContextMenu.table",null,U.a.instance.fa(1922),-697806646);ic.menu.Ec.push(Kb);bc.buttons.push(ic)}};
a.prototype.LVe=function(bc,Kb,ic,wb,Wa){if(Kb){var Xb=W.K(Wa),Gc=Gb.e(this.grid);if(Gc&&!ic&&!wb){ic=new xa.a(this.$.xa);if(Gc.range.contains(Xb)&&this.YV(Gc)){(Kb=!Gc.wMa&&!ic.uj)&&this.$.isEditMode&&bc.buttons.push(this.Ra.Bb(45));Gc.cba&&bc.buttons.push(this.Ra.Bb(53));Kb&&this.$.isEditMode&&bc.buttons.push(this.Ra.Bb(47));return}!Gc.wMa&&this.$.isEditMode&&(Gc=ic.me(128),bc.buttons.push(this.Ra.Bb(Gc?46:121)))}}this.V3i(Wa)&&bc.buttons.push(this.Ra.Bb(48));(Gc=this.$.xa.qa)&&Gc.Yd&&(Gc=Gc.Yd.qy||
Gc.Yd.tK,!Kb||this.$.kN||!Ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||Gc||(Kb=W.K(Wa),this.U3i(Kb)?bc.buttons.push(this.Ra.Bb(276)):Kb.ef||Kb.isRow||bc.buttons.push(this.Ra.Bb(275))))};a.prototype.V3i=function(bc){bc=El(bc);for(var Kb=bc.next();!Kb.done;Kb=bc.next()){Kb=this.grid.getRangeInformation(Kb.value);for(var ic=0;ic<Kb.length;ic++)if(Object(t.a)(F.HyperlinkRange,Kb[ic])){var wb=this.grid.kc(Kb[ic]);
if(wb&&this.YV(wb)&&!wb.wMa)return!0}}return!1};a.prototype.U3i=function(bc){if(Gb.g(this.$).ha.sa.nK()){var Kb=Gb.g(this.$).Rb.Qj(bc);if(Kb&&Kb.usedRange.equals(bc))return!0}return!1};a.prototype.AVe=function(bc,Kb,ic){var wb,Wa;if(1===Gb.g(this.$).ha.Ue&&!Kb&&!ic){Kb=kb.a(this.$);ic=this.Ra;var Xb=ic.Pc(),Gc=this.$.da.Aa(65);(null===(wb=null===Gc||void 0===Gc?void 0:Gc.Rm)||void 0===wb?0:wb.kF)&&!Kb&&Xb.buttons.push(ic.Bb(227));Gc&&Gc.isCommentOperationEnabled(3)&&Xb.buttons.push(ic.Bb(221));(null===
(Wa=null===Gc||void 0===Gc?void 0:Gc.Rm)||void 0===Wa?0:Wa.tjd)&&!Kb&&Xb.buttons.push(ic.Bb(228));(null===Gc||void 0===Gc?0:Gc.hasCommentAtActiveCell)?Gc.uC.isResolved||Xb.buttons.push(ic.Bb(159)):Gc&&Gc.hasCommentAtActiveCell||(Gc&&Gc.Rm&&Gc.Rm.kF?Kb||(Xb.buttons.push(ic.Bb(229)),Xb.buttons.push(ic.Bb(230))):(Xb.buttons.push(ic.Bb(160)),Kb||Xb.buttons.push(ic.Bb(226))));bc.Ec.push(Xb)}};a.prototype.SGh=function(bc){if(Ca.EwaSettings.ma(135)){var Kb=this.Ra,ic=Kb.Pc();ic.buttons.push(Kb.Bb(250));
bc.Ec.push(ic)}};a.prototype.VFh=function(bc,Kb,ic){if(!ic){ic=this.$.Ka.xH();var wb=new xa.a(this.$.xa),Wa=new pa.a(ic,Kb,this.grid);(new f(bc,this.$,this.Ra,ic,Kb,this.grid,Wa,wb)).qcd()}};a.prototype.LFh=function(bc,Kb,ic,wb,Wa){var Xb=(new xa.a(this.$.xa)).me(8),Gc=this.Ra,zb=Gc.Pc();Kb&&zb.buttons.push(Gc.Bb(Xb?152:153));ic&&zb.buttons.push(Gc.Bb(Xb?150:151));Kb&&(wb||zb.buttons.push(Gc.Bb(Xb?109:155)),zb.buttons.push(Gc.Bb(Xb?111:157)));ic&&(Wa||zb.buttons.push(Gc.Bb(Xb?108:154)),zb.buttons.push(Gc.Bb(Xb?
110:156)));bc.Ec.push(zb)};a.prototype.zFh=function(bc,Kb){var ic=this.Ra,wb=ic.Pc();bc.Ec.push(wb);Kb&&wb.buttons.push(ic.Bb(102));wb.buttons.push(ic.Bb(42));wb.buttons.push(ic.Bb(43));Kb=this.wGh(ic);bc.Ec.push(Kb)};a.prototype.wGh=function(bc){var Kb=bc.Pc();Kb.title=U.a.instance.fa(1113);Kb.a4f=!1;Kb.$3f=!1;Kb.j9f=!1;var ic=5,wb=aa.a.Ird(this.$);wb&&(ic=6);bc=bc.dB("PasteOptionsGallery",ic,"Size24by24",Kb.title);Kb.buttons.push(bc);bc.Mt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",
1114,void 0,"Paste_24",1,z.a.Wsh);bc.Mt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1115,void 0,"PasteValues_24",1,z.a.ath);bc.Mt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1116,void 0,"PasteFormulas_24",1,z.a.Ysh);bc.Mt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1117,void 0,"PasteTranspose_24",1,z.a.$sh);bc.Mt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",
1118,void 0,"PasteFormatting_24",1,z.a.Xsh);wb&&bc.Mt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1119,void 0,"PasteLink_24",1,z.a.Zsh);return Kb};a.prototype.hHh=function(bc,Kb,ic,wb,Wa){var Xb,Gc=this.Ra,zb=Gc.Pc();zb.buttons.push(Gc.Bb(43));bc.Ec.push(zb);this.$fc&&!this.$.kN&&(zb=this.Ra.Pc(),this.vcd(zb),bc.Ec.push(zb));Ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.xc.isMobileMode&&this.$.ea.xc.isReadOnlyEditMode&&
!this.$.ya.IsMeetingLiveSession||(zb=this.Ra.Pc(),this.Dcd(zb),bc.Ec.push(zb),l.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));zb=this.$.da.Aa(65);if(null===(Xb=null===zb||void 0===zb?void 0:zb.Rm)||void 0===Xb?0:Xb.kF)Xb=this.Ra.Pc(),Xb.buttons.push(Gc.Bb(229)),bc.Ec.push(Xb);Xb=this.Ra.Pc();this.LVe(Xb,Kb,ic,wb,Wa);bc.Ec.push(Xb);v.AFrameworkApplication.isMobileMode&&
!Z.a(this.$.ya,30)&&(Kb=Gc.Pc(),Kb.buttons.push(Gc.Bb(272)),bc.Ec.push(Kb))};a.prototype.qGh=function(bc,Kb,ic,wb,Wa){var Xb=this.Ra.Pc();this.rGh(Xb);this.LVe(Xb,Kb,ic,wb,Wa);0<Xb.buttons.length&&bc.Ec.push(Xb)};a.prototype.rGh=function(bc){bc.buttons.push(this.Ra.Bb(135))};a.prototype.PFh=function(bc){var Kb=this.Ra.Pc();Kb.buttons.push(this.Ra.Bb(185));bc.Ec.push(Kb)};a.prototype.NGh=function(bc,Kb){Ca.EwaSettings.ma(486)&&Kb&&(Kb=this.Ra.Pc(),Kb.buttons.push(this.Ra.Bb(262)),bc.Ec.push(Kb))};
a.prototype.bGh=function(bc){var Kb=this.grid.ha.sa.selectedRanges;if(Kb&&Kb.length){for(var ic=!1,wb=0;wb<Kb.length;wb++)if(this.grid.Rb.OMa(Kb[wb])){ic=!0;break}if(ic){var Wa=this.Ra;ic=Wa.Pc();wb=Wa.Pc();for(var Xb=1===Kb.length&&(Kb[0].isSingle||this.grid.Rb.hAb(Kb[0])),Gc=!1,zb=!1,hc=!1,Uc=!1,jb=0;jb<Kb.length&&!(Gc&&hc&&zb&&Uc);jb++)!Gc&&this.grid.Rb.Iji(Kb[jb])&&(Gc=!0),!hc&&this.grid.Rb.def(Kb[jb],!1)&&(hc=!0),!zb&&this.grid.Rb.hqd(Kb[jb])&&(zb=!0),!Uc&&this.grid.Rb.bfi(Kb[jb])&&(Uc=!0);Ca.EwaSettings.ma(105)&&
Xb&&!this.grid.Rb.Cfc(Kb[0])&&(Uc?ic.buttons.push(Wa.Bb(217)):ic.buttons.push(Wa.Bb(216)));Uc=Gc;Uc=!(new xa.a(this.$.xa)).uj&&Uc;hc&&(Ca.EwaSettings.ma(131)&&J.l(this.$.kg)&&(Ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1)&&(Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?wb.buttons.push(Wa.Bb(220)):wb.buttons.push(Wa.Bb(Uc?220:271))),zb&&wb.buttons.push(Wa.Bb(Uc?218:269)),Xb&&(this.grid.Rb.hqd(Kb[0])||this.grid.Rb.Cfc(Kb[0]))&&
wb.buttons.push(Wa.Bb(Uc?219:270))),wb.buttons.push(Wa.Bb(Uc?215:268)));0<wb.buttons.length&&(Kb=Wa.ww(Gc?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,U.a.instance.fa(1746),798637440),Kb.menu.Ec.push(wb),ic.buttons.push(Kb));0<ic.buttons.length&&bc.Ec.push(ic)}}};a.prototype.AFh=function(bc,Kb){this.grid.Rb.zcf(Kb)&&(Kb=this.Ra.Pc(),this.grid.ha.sa.Jba()?(Kb.buttons.push(this.Ra.Bb(241)),Kb.buttons.push(this.Ra.Bb(239))):Kb.buttons.push(this.Ra.Bb(240)),
bc.Ec.push(Kb))};a.prototype.YV=function(bc){return bc.cell.hasHyperlink};a.prototype.QVe=function(bc){this.BGh(bc);var Kb=this.Ra.Pc();this.Dcd(Kb);bc.Ec.push(Kb);this.$fc&&(Kb=this.Ra.Pc(),this.vcd(Kb),bc.Ec.push(Kb))};a.prototype.AGh=function(bc,Kb,ic){this.QVe(bc);this.AVe(bc,Kb,ic)};a.prototype.BGh=function(bc){if(this.grid.ha.sa.Ig&&!this.grid.rb.dj){var Kb=this.Ra,ic=Kb.Pc();lb.a(this.$).vRd()?ic.buttons.push(Kb.Bb(265)):ic.buttons.push(Kb.Bb(264));bc.Ec.push(ic)}};a.bUi=function(bc){var Kb=
bc.mKa(a.Jkd);Kb&&Kb.zmd&a.Jkd&&bc.invoke(a.Jkd,null)};a.UFh=function(bc,Kb,ic){if(Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(ic=ic.da.Aa(254),!ic){l.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(ic=ic.da.Aa(254,!0),!ic)return;ic.Yod()&&ic.djf()&&bc.buttons.push(Kb.Bb(212));ic.Yod()&&ic.sjc()&&bc.buttons.push(Kb.Bb(213))};a.prototype.Bvj=
function(){var bc=this.$.da.Aa(66).Eg,Kb=this.grid.ha.sa.activeCell;return null!=bc&&!bc.hasActiveFilter||Aa.c(this.$,Kb)||!this.afi(Kb)};a.prototype.afi=function(bc){var Kb=bc.left,ic=this.ucc();if(null!=ic&&null!=ic.J9b&&Array.contains(ic.J9b,Kb-1))return!0;ic=this.mcc();return null!=ic&&W.D(ic).contains(bc)&&null!=ic.FilteredColumns&&Array.contains(ic.FilteredColumns,Kb-1)?!0:!1};a.prototype.Zei=function(){var bc=this.$.da.Aa(66).Eg,Kb=this.ucc();if(null!=bc)return bc.hasAutoFilter&&bc.hasActiveFilter;
if(null!=Kb)return null!=Kb.J9b&&0<Kb.J9b.length;bc=this.mcc();return null!=bc&&null!=bc.FilteredColumns&&0<bc.FilteredColumns.length};a.prototype.$ei=function(){var bc=this.$.da.Aa(66).Eg,Kb=this.ucc();if(null!=bc&&bc.hasAutoFilter||null!=Kb&&Kb.h_a.every(function(ic){return 0!=ic.length}))return!0;bc=W.D(this.mcc());return null!=bc&&bc.contains(this.grid.ha.sa.activeCell)?!0:!1};a.prototype.ucc=function(){var bc=this.$.da.Aa(66);bc.rn(this.grid.ha.sa.activeCell);return bc.Qub(this.grid.ha.sa.activeCell)};
a.prototype.mcc=function(){return this.$.xa.getItemByName(this.$.qa.sheetName).P0};a.prototype.WPh=function(){var bc=this.grid.ha.sa.activeCell,Kb=0,ic=!1,wb=this.$.da.Aa(66),Wa=this.ucc();wb=wb.Eg;null!=wb?(Kb=wb.usedRange.top,ic=!0):null!=Wa?(Kb=Wa.top,ic=!0):(Wa=this.mcc(),null!=Wa&&W.D(Wa).contains(bc)&&(Kb=Wa.FirstRow+1,ic=!0));return ic?(bc=bc.left,Kb=D.Range.hd(Kb,bc),Kb=this.grid.kc(Kb),ic="",null!=Kb&&(ic=Kb.text),this.JPg(ic,bc)):U.a.instance.fa(221)};a.prototype.JPg=function(bc,Kb){null==
bc||qa.a.Fh(bc.trim())?bc=String.format(U.a.instance.Ab(157),D.Range.CU(Kb)):bc.length>a.O0d?(bc=bc.substring(0,a.O0d),bc=String.format(U.a.instance.Ab(155),bc)):bc=String.format(U.a.instance.Ab(156),bc);return bc};Ek.Object.defineProperties(a.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Q.a.lLf}}});a.bJb="GridContextMenuRootName";a.c1h=Q.a.CBe;a.Jkd=192;a.O0d=26;Object(x.a)(a,"GridContextMenu",
y.a,[])},1309:function(x,C,b){function a(fa,Ca){var Sa=ta.call(this,fa)||this;Sa.VCa=null;Sa.B_c=[];Sa.F4d=null;Sa.Yva=!1;Sa.iec=!1;Sa.sq=null;Sa.mae=null;Sa.wJe=function(){Sa.ZY.sJa(Sa.items,Sa.VCa);Sa.raiseEvent("ACLBUpdated",new u.a(Sa.items.length));Sa.show()};Sa.tableManager=Ca;Sa.domElement.className=n.a.vMe;Sa.domElement.innerHTML=va;U.DOMElementExtensions.setVisible(Sa.domElement,!1);xa.d(Sa.style,Sa.$.isChromeRtl);Sa.Vcf=M.EwaSettings.em();Sa.Swe=$get(l.a7f,Sa.domElement);Sa.ZY=new c(Sa.$,
Sa.Swe,Sa);Sa.OSa(!0);Sa.$.domElement.appendChild(Sa.domElement);Sa.Aob(fa,W.a(fa));Sa.Aob(fa,P.g(fa).rc);Sa.Vcf||Sa.$.da.Ga(1,Sa);Sa.gfi=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1);return Sa}function c(fa,Ca,Sa){fa=J.call(this,fa,Ca)||this;fa.cellAutoCompleteControl=null;fa.jra=null;fa.Byb=M.EwaSettings.em();fa.Byb&&(fa.cellAutoCompleteControl=Sa);fa.Fq=[];return fa}function e(fa,Ca,Sa){var Gb=L.call(this,fa,Ca)||this;Gb.dRb=null;Gb.njc=0;Gb.Y7a=
null;Gb.$0=null;Gb.p6=function(kb,lb){if(kb=Gb.cellAutoCompleteControl.items)if(1===kb.length&&Gb.cellAutoCompleteControl.O0a.length<kb[0].lsa.length&&Gb.cellAutoCompleteControl.Yva&&Q.a.uL(kb[0].lsa,Gb.cellAutoCompleteControl.O0a)&&(lb.newValue=kb[0].lsa),Gb.Ya&&M.EwaSettings.ma(136)){var Nb=-1;1<kb.length?Nb=Gb.cellAutoCompleteControl.rcc(Gb.Ya.text,!0):1===kb.length&&(Gb.cellAutoCompleteControl.Yva||Gb.cellAutoCompleteControl.iec)&&(Nb=0);if(0<=Nb&&kb.length>Nb&&kb[Nb].IXc){var Aa=z.C(kb[Nb].IXc);
Aa&&P.g(Gb.$).Rb.OMa(Aa)&&(lb.ubf=!0,lb.Twe=kb[Nb].IXc)}}};Gb.fFb=function(){Gb.cellAutoCompleteControl.Yva=!1};Gb.Ya.GYa(Gb.p6);Gb.Byb=M.EwaSettings.em();Gb.Byb&&(Gb.dRb=Sa);Gb.$0=Gb.he.Zd(Gb.Ya.textBox.domElement);Gb.$0.ka("mousedown",Gb.fFb);return Gb}function f(fa,Ca){this.Qkg=fa;this.Pkg=Ca}function l(){}b.r(C);x=b(0);var m=b(14),r=b(90),h=b(1259),w=b(9),n=b(983);l.a7f="suggested_cells_list_box";Object(x.a)(l,"CssElementIds",null,[]);var v=b(5),u=b(1260);Ek.Object.defineProperties(f.prototype,
{lsa:{configurable:!0,enumerable:!0,get:function(){return this.Qkg}},IXc:{configurable:!0,enumerable:!0,get:function(){return this.Pkg}}});Object(x.a)(f,"CellAutoCompleteItem",null,[853]);var t=b(4),y=b(83),E=b(1116),B=b(406),z=b(46),M=b(1),Q=b(21),P=b(22),L=E.a;Am(e,L);e.prototype.dispose=function(){this.Ya.YHb(this.p6);L.prototype.dispose.call(this)};e.prototype.BU=function(fa){fa&&!this.cellAutoCompleteControl.isListVisible||L.prototype.BU.call(this,fa)};e.prototype.Wh=function(fa,Ca){this.cellAutoCompleteControl.Ya=
this.Ya;this.njc=fa.keyCode;if(this.Ya.isEditing){var Sa=this.Ya.text;Q.a.equals(this.Y7a,Sa,!1)||(this.Y7a=Sa)}else this.Y7a=null;if(237279923===Ca)return this.cellAutoCompleteControl.isListVisible=!1;M.EwaSettings.ma(136)&&17===this.njc&&this.cellAutoCompleteControl.Yva&&(this.cellAutoCompleteControl.iec=!0);return L.prototype.Wh.call(this,fa,Ca)};e.prototype.tzd=function(){var fa;if(!M.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!t.AFrameworkApplication.Pg)if(this.cellAutoCompleteControl.Ya=
this.Ya,this.cellAutoCompleteControl.Yva=!1,this.Ya.isEditing){var Ca=!Q.a.equals(this.Y7a,this.Ya.text,!0),Sa=this.Ya.cod;Sa||!Ca&&229!==this.njc?Sa&&(this.cellAutoCompleteControl.isListVisible&&(this.cellAutoCompleteControl.isListVisible=!1),null===(fa=this.cellAutoCompleteControl.GNa)||void 0===fa?void 0:fa.cancel()):this.cellAutoCompleteControl.oLg(this.njc)}else this.Y7a=null};e.prototype.gj=function(){};e.prototype.ug=function(){this.bW=!1;this.cellAutoCompleteControl.set_visible(!1);this.Y7a=
null;this.cellAutoCompleteControl.Yva=!1;this.cellAutoCompleteControl.iec=!1;this.cellAutoCompleteControl.GNa&&this.cellAutoCompleteControl.GNa.cancel()};e.prototype.RFd=function(fa,Ca){return this.cellAutoCompleteControl.Wh(fa,Ca)};Ek.Object.defineProperties(e.prototype,{Pyb:{configurable:!0,enumerable:!0,get:function(){return!1}},bW:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(fa){this.cellAutoCompleteControl.isListVisible=fa}},D5a:{configurable:!0,
enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return B.a.C_c}},cellAutoCompleteControl:{configurable:!0,enumerable:!0,get:function(){if(this.Byb)return this.dRb;var fa=b(1309).CellAutoCompleteControl;return this.dRb||(this.dRb=Object(y.a)(fa,this.$.da.Aa(1)))}}});Object(x.a)(e,"CellAutoCompleteListAutoCompleteBehavior",E.a,[]);var ca=b(29);E=b(1261);var U=b(12),aa=b(10),F=b(115),D=b(67),J=E.a;Am(c,J);c.prototype.dispose=function(){J.prototype.dispose.call(this);
this.jra=null};c.prototype.vzc=function(fa){this.R7(!1);var Ca=""+String.format("<table class='{0}' aria-live='polite'><tbody>",this.Xba);for(var Sa=0,Gb=this.Fq.length;Sa<Gb;Sa++){var kb=ca.a.Sf(fa[this.Fq[Sa]].lsa);kb=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",this.A_,c.D_c,v.a.rpe,kb,ca.a.T7b(kb));Ca+=kb}this.dg.innerHTML=Ca+"</tbody></table>";this.Sn=U.DOMElementExtensions.Pj(this.domElement,this.Xba);this.R7(!0);this.Tra()};c.prototype.sJa=function(fa,
Ca){if(fa&&fa.length){var Sa=[];if(Ca)for(var Gb=0,kb=fa.length;Gb<kb;Gb++)Q.a.uL(fa[Gb].lsa,Ca)&&Sa.push(Gb);this.Fq=Sa;this.vzc(fa)}else this.isListVisible=!1,this.jra=null};c.prototype.Xxa=function(){};c.prototype.TSg=function(fa,Ca,Sa){var Gb=Math.min(fa,Math.max(200,Sa));Ca&&fa<Sa&&(Gb+=F.a.xu);U.DOMElementExtensions.Kr(this.dg,Gb);Ca&&(Gb-=F.a.xu);return Gb};c.prototype.Tra=function(){J.prototype.Tra.call(this);var fa=U.DOMElementExtensions.Pj(this.get_element(),this.Xba),Ca=this.Fq.length>
this.hI,Sa=P.g(this.$);if(Sa=Sa.kc(Sa.ha.sa.activeCell))for(fa=this.TSg(fa.offsetWidth,Ca,Sa.width),Ca=this.dg.getElementsByClassName(c.D_c),Sa=0;Sa<Ca.length;Sa++)Ca[Sa].style.maxWidth=aa.HelperMethods.nc(fa);else m.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};c.prototype.onItemClick=function(fa){if(fa=J.prototype.onItemClick.call(this,fa)){var Ca=P.g(this.$);Ca.Jp(!1);Ca.focus()}return fa};Ek.Object.defineProperties(c.prototype,
{Vk:{configurable:!0,enumerable:!0,get:function(){return this.jra},set:function(fa){this.sBa(this.Vk);this.jra=fa;var Ca=this.sBa(this.Vk);this.xe=fa?Ca.innerText:null;this.Yuc(fa)}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(D.a)(c.prototype,this,"isListVisible")},set:function(fa){Object(D.b)(c.prototype,this,"isListVisible",fa);fa||(this.Vk=null)}},kTa:{configurable:!0,enumerable:!0,get:function(){return null}},tGa:{configurable:!0,enumerable:!0,get:function(){return this.Byb?
this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.Aa(1))}}});c.D_c=n.a.gsh;Object(x.a)(c,"CellAutoCompleteListBox",E.a,[]);var R=b(25),Z=b(63),W=b(121),ka=b(188),ma=b(44),pa=b(35),xa=b(259);E=b(19);b.d(C,"CellAutoCompleteControl",function(){return a});var va="<div id='"+l.a7f+"' class='"+n.a.q9c+" "+E.a.$o+"' ></div>",ta=h.a;Am(a,ta);a.prototype.BZb=function(fa){this.addHandler("ACLBUpdated",fa)};a.prototype.Usc=function(fa){this.removeHandler("ACLBUpdated",
fa)};a.prototype.R2=function(fa){this.addHandler("ACLBSelectionChanged",fa)};a.prototype.oda=function(fa){this.removeHandler("ACLBSelectionChanged",fa)};a.prototype.aFg=function(fa){this.addHandler("ACLBMatchedItem",fa)};a.prototype.Uaj=function(fa){this.removeHandler("ACLBMatchedItem",fa)};a.prototype.p6f=function(fa){for(var Ca=0;Ca<fa.length;Ca++){var Sa=fa.charCodeAt(Ca);if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Q.a.isLetter(Sa):
Q.a.fpd(Sa))return!0}return!1};a.prototype.Mwa=function(){return!this.items};a.prototype.dispose=function(){if(this.$){this.OSa(!1);var fa=P.g(this.$);fa&&fa.view.Xq(this.qnc)}r.a.zc([this.ZY,this.GNa]);r.a.zc(this.B_c);this.B_c=this.Swe=this.ZY=this.Ya=null;ta.prototype.dispose.call(this)};a.prototype.Wh=function(fa,Ca){var Sa=!1;if(this.Zvj())switch(Ca){case -798660877:if(1===this.items.length&&this.xe)break;this.St.BB(1);this.raiseEvent("ACLBSelectionChanged",new u.a(this.items.length,this.rcc(this.xe),
this.xe));Sa=this.fz(!1);break;case 137938150:if(1===this.items.length&&this.xe)break;this.St.BB(-1);this.raiseEvent("ACLBSelectionChanged",new u.a(this.items.length,this.rcc(this.xe),this.xe));Sa=this.fz(!1);break;case 2091832999:this.St.BB(this.hI-1);Sa=this.fz(!1);break;case 742457698:this.St.BB(-(this.hI-1));Sa=this.fz(!1);break;case 125627505:this.Ya.textBox.caretPosition=this.Ya.text.length;this.isListVisible=!1;Sa=!0;break;case 267796030:this.fz(!0);break;default:Sa=ta.prototype.Wh.call(this,
fa,Ca)}return Sa};a.prototype.show=function(){this.items&&this.items.length&&(this.ZY.Vk=this.xe?this.St.Sn.rows[this.rcc(this.xe)]:null,this.isListVisible=0<this.ZY.Fq.length,this.JBa(!0),this.ZY.Xxa())};a.prototype.oLg=function(fa){var Ca=!!this.Ya&&!Z.f(this.$.qa);this.iec=this.Yva=!1;this.Ya&&!this.Ya.isEditing?this.set_visible(!1):Ca&&!this.cbh(this.activeCell)&&this.Ezj(fa)};a.prototype.cbh=function(fa){return!!this.dataValidationControl&&this.dataValidationControl.a7c(fa)};a.prototype.fz=function(fa){if(!this.Ya||
!this.isListVisible)return!1;var Ca=this.VCa;if(this.xe){var Sa=U.DOMElementExtensions.KZ(U.DOMElementExtensions.Pj(this.ZY.Vk,c.D_c),v.a.rpe,""),Gb=Sa.substring(Ca.length,Sa.length);fa?this.Ya.text=Sa:this.Ya.insertTextAt(Gb,Ca.length,this.Ya.text.length)}Sa=P.g(this.$);Sa.Dj&&(Sa=Sa.rc,Sa.text=this.Ya.text,Sa.setCaretPosition(this.Ya.textBox.caretPosition));fa?this.isListVisible=!1:this.Ya.textBox.selectRange(Ca.length,this.Ya.text.length);return!0};a.prototype.rcc=function(fa,Ca){Ca=void 0===Ca?
!1:Ca;if(!this.ZY.Sn)return-1;for(var Sa=this.ZY.Sn.children[0],Gb=Sa.children.length,kb,lb=0;lb<Gb;++lb)if(kb=Sa.children[lb],Q.a.equals(kb.innerText.trim(),fa,Ca))return lb;return-1};a.prototype.iAg=function(fa,Ca,Sa,Gb,kb,lb,Nb){var Aa=Sa.originalText.replace(a.Arf,String.fromCharCode(32)),qa=new R.Range(fa.top-1,fa.left,fa.bottom-1,fa.right,!1,!1),Xa=Nb?Nb.rn(Sa.range):null;(!Sa.rF||Sa.range.left===fa.left)&&1<Aa.length&&!Gb.xb(Aa.toUpperCase())&&Q.a.uL(Aa,Ca)&&!Q.a.equals(Aa,Ca,!0)&&!a.DTe(Ca)&&
this.p6f(Aa)&&(!kb&&!Xa||!kb&&Xa.equals(Nb.rn(qa))||kb&&Sa.range.Hd(lb)&&Sa.range.top!==lb.top)&&(fa=Sa.formulaBarText,Q.a.equals(fa,Sa.text,!1)||!fa)&&(fa={},fa.FirstRow=Sa.range.top-1,fa.FirstColumn=Sa.range.left-1,Sa=new f(Aa,fa),Gb.add(Aa.toUpperCase(),Sa))};a.prototype.Ezj=function(fa){this.sq=this.sYh();this.GNa&&this.GNa.cancel();0<this.Ya.text.length&&0!==fa?this.items&&((1<this.items.length||this.isListVisible)&&this.Jhh(),8!==fa&&127!==fa&&46!==fa&&(1===this.items.length?this.ild(!1):this.ZY.Vk&&
this.fz(!1))):this.isListVisible=!1};a.prototype.Jhh=function(){this.isListVisible?this.wJe():this.mae=ka.AsyncMethodContext.$u(this.wJe,500,ma.a.cVg,this.GNa)};a.prototype.ild=function(fa){m.ULS.shipAssertTag(537167966,0,!this.Mwa()&&1===this.items.length,"Invalid Items");var Ca=this.items[0].lsa,Sa=this.Ya.text,Gb=Ca.substring(Sa.length,Ca.length);if(fa&&!Gb.length)this.Ya.text=Ca;else if(!fa&&0<Gb.length)this.Ya.appendText(Gb),this.Ya.textBox.selectRange(Sa.length,this.Ya.text.length);else return;
this.raiseEvent("ACLBMatchedItem",new u.a(this.items.length,0,Ca));this.Yva=!0};a.prototype.sYh=function(){this.sq=null;var fa=new pa.a(!1),Ca=this.activeCell;this.VCa=this.Ya.text.replace(a.Arf,String.fromCharCode(32));var Sa=this.tableManager.rn(Ca),Gb=Ca.Hd(Sa);if(a.DTe(this.VCa)||!this.p6f(this.VCa))return this.items;var kb=new R.Range(1,Ca.left,Ca.top-1,Ca.left,!1,!1),lb=new R.Range(Ca.top+1,Ca.left,w.a.Hh,Ca.left,!1,!1),Nb=P.g(this.$);lb=Nb.vk("CellAutoCompleteControl.GetSuggestedCells",lb);
try{var Aa=Nb.vk("CellAutoCompleteControl.GetSuggestedCells2",kb);try{for(var qa=El([Aa,lb]),Xa=qa.next();!Xa.done;Xa=qa.next())for(var Ha=Xa.value;Ha.$$mn();){var Ra=Ha.$$cu();this.iAg(Ca,this.VCa,Ra,fa,Gb,Sa,this.tableManager)}}finally{Aa&&Aa.dispose()}}finally{lb&&lb.dispose()}this.sq=Array(fa.values.length);for(Ca=0;Ca<this.items.length;Ca++)this.items[Ca]=fa.values[Ca];this.items.sort(function(mb,La){return mb.lsa.localeCompare(La.lsa)});return this.items};a.prototype.Aob=function(fa,Ca){fa&&
Ca&&this.B_c.push(new e(fa,Ca,this.Vcf?this:void 0))};a.prototype.Zvj=function(){return this.gfi?this.O0a&&!this.Mwa()&&this.isListVisible?this.get_visible():!1:this.O0a&&!this.Mwa()&&this.get_visible()&&this.isListVisible};a.DTe=function(fa){fa=0<fa.length?fa.charCodeAt(0):-1;return 35===fa||61===fa||43===fa||45===fa||64===fa};Ek.Object.defineProperties(a.prototype,{St:{configurable:!0,enumerable:!0,get:function(){return this.ZY}},O0a:{configurable:!0,enumerable:!0,get:function(){return this.VCa}},
xe:{configurable:!0,enumerable:!0,get:function(){return this.ZY.xe}},items:{configurable:!0,enumerable:!0,get:function(){return this.sq}},GNa:{configurable:!0,enumerable:!0,get:function(){return this.mae}},activeCell:{configurable:!0,enumerable:!0,get:function(){return P.g(this.$).ha.sa.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.F4d||(this.F4d=this.$.da.Aa(14))}}});Ek.Object.defineProperties(a,{Arf:{configurable:!0,enumerable:!0,get:function(){return a.Ube||
(a.Ube=new RegExp(String.fromCharCode(160),"g"))}}});a.Ube=null;Object(x.a)(a,"CellAutoCompleteControl",h.a,[787,780,788,3])},1439:function(x,C,b){function a(){this.tb=null;this.tx=!1}function c(k,H){var Y=Cl.call(this)||this;Y.eqa=xl.a.kHh;Y.bPc=!!window.PointerEvent;Y.qie=window.hasOwnProperty("ontouchstart");Y.ykb=null;Y.ZVa=null;Y.V8=!1;Y.BT=new fk.a;Y.Skb=new fk.a;Y.Mog=new rb.a;Y.Bpa=null;Y.rmb=!1;Y.p3d=!1;Y.Tee=!1;Y.YMc=!1;Y.qGc=!1;Y.j3d=!1;Y.uJc=!1;Y.bVa=!1;Y.$jb=-1;Y.KRc=null;Y.session=null;
Y.handlers=null;Y.element=null;Y.curRecognizer=null;Y.Wd=di.EventHandlerManager.instance;Y.bPc?(nc.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),Y.ykb=Object(nh.a)(Y,Y.eoc,"onPointerEvent"),Y.ZVa=Eg.a.mHh):Y.qie?(nc.ULS.sendTraceTag(593893140,310,50,"Using touch events"),Y.ykb=Object(nh.a)(Y,Y.Lya,"onTouchEvent"),Y.ZVa=Eg.a.touchEvents):(nc.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),Y.ykb=Object(nh.a)(Y,Y.Pnc,"onMouseEvent"),Y.ZVa=Eg.a.lHh);Y.Dh=H;Y.lfa=k;Vg.AFrameworkApplication.ga&&
(Y.rmb=Vg.AFrameworkApplication.ga.ra("UsePointerCaptureIsEnabled"),Y.p3d=Vg.AFrameworkApplication.ga.ra("ClearCacheOnPrimaryPointerIsEnabled"),Y.Tee=Vg.AFrameworkApplication.ga.ra("ResetHandledBeforeInputHandlerIsEnabled"),Y.YMc=Vg.AFrameworkApplication.ga.ra("LogCoalescedEventsIsEnabled"),Y.qGc=Vg.AFrameworkApplication.ga.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),Y.j3d=Vg.AFrameworkApplication.ga.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),Y.uJc=Vg.AFrameworkApplication.ga.ra("HammerJsPerformanceTimersIsEnabled"),
Y.bVa=Y.rmb&&Vg.AFrameworkApplication.ga.ra("CancelDragFromGestureInputManagerIsEnabled")&&Vg.AFrameworkApplication.ga.ra("UseGestureInputManagerPointerCacheIsEnabled"));return Y}function e(){}function f(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=
this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function l(k,H,Y,za,Va,Pb,Ac,id,Ld){k=Al.call(this,k,Y,za,Pb)||this;k.mhb=H;k.kga=Ac;k.aY=id;k.zYj=Ld;k.Log=Va;return k}function m(){this.GHc=null}function r(){this.cda=this.bWe=null}function h(k){return vl.call(this,k)||this}function w(k){this.$=k}function n(k){var H=ul.call(this)||this;H.$=k;H.Tb();return H}function v(k){var H=this;this.$=k;this.d$=Object.assign({},Yi);this.u4=Object.assign({},Ah);this.SY=Object.assign({},
Ug);this.Job=Object.assign({},kh);this.pna=Object.assign({},Rj);this.RXc=Object.assign({},ej);this.gcd=Object.assign(Object.assign({},yi),{isReactDialog:ee.a.Fef(this.$)});this.Yc=function(){H.gsj();H.$.sendBeaconTraceTag(88392384,50,!1,"{0}",H.getJsonForLogging())};this.L$a=new fk.a;k.Zk(this.Yc)}function u(k){var H=this;this.Npf=k;this.e0=Object.assign({},Ki);this.z7b=[];this.elc=-1;(this.Mpf=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&k&&(this.e0.countAboveThresholds=
{},k.forEach(function(Y){return H.e0.countAboveThresholds[Y]=0}))}function t(k){var H=xf.call(this)||this;H.$=k;H.Tb();return H}function y(k,H,Y,za,Va){var Pb=kf.call(this)||this;Pb.cP=null;Pb.B0=null;Pb.tFa=null;Pb.cvc=null;Pb.$Nc=null;Pb.DXa=null;Pb.hee=0;Pb.SEc=!1;Pb.Kg=function(){Pb.rwa&&(Pb.gridView?1===Pb.gridView.ha.Ue?(Pb.gridView.ha.sa.activeCell.equals(Pb.tFa)||Pb.oN||Pb.ky(),Pb.vob.Zq()):Pb.ky():nc.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};Pb.gj=function(){Pb.ky()};
Pb.zd=function(){Pb.vX()};Pb.Yc=function(){Pb.ky()};Pb.vd=function(){Pb.showCallout()};Pb.rya=function(){if(Pb.rh.Nk&&Pb.rh.Nk.length)if(Pb.gZc)Pb.rh.Jsi||(Pb.SEc=Pb.rh.Nk[0].BlockingDataForExpand),Pb.rh.jOh&&nc.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),Pb.hee=Pb.rh.U4c&&Pb.rh.eVe<Pb.rh.U4c.left-1?Pb.rh.U4c.left-1-Pb.rh.eVe:-1,Pb.showCallout();else if(Pb.gridView.ha.sa.Ig){var Ac=Pb.gridView.ha.sa.activeCell;if(Ac&&Pb.B0){var id=Pb.tableManager.rn(Ac);
Pb.NLc=!!id;var Ld=Pb.gridView.ha.sa.qd;id=Pb.oN&&Pb.B0.Hd(id);var ld=Pb.Whd&&!Pb.oN&&Ld.equals(Pb.selectedRange);id||ld?(nc.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),Pb.A9b=!0,Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!Pb.oN&&Pb.tableManager.uva(Ac)?nc.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?
Pb.oN?Pb.Yh.KAa(Pb.B0,Pb.oN):Pb.Yh.KAa(Ld,Pb.oN):Pb.Yh.KAa(Pb.B0,Pb.oN),Pb.Otc())):nc.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};Pb.fj=function(){Pb.H6a()&&Pb.Yh.hide();1===Pb.gridView.ha.Ue&&Pb.vX()};Pb.PR=function(){var Ac=Pb.gridView.ha.Ue;Pb.gridView.ha.sa.activeCell&&1===Ac&&Pb.vX()};Pb.tt=function(){if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(Pb.oN){if(Pb.B0&&Pb.tFa){var Ac=
Pb.tableManager.rn(Pb.tFa);Ac&&1<Ac.bottom-Ac.top&&(--Ac.bottom,Pb.gridView.w5(Ac)&&Pb.vob.Zq())}}else Pb.gridView.ha.sa.Ig&&Pb.gridView.w5(Pb.gridView.ha.sa.qd)&&Pb.vob.Zq();else Pb.B0&&Pb.tFa&&Pb.oN&&(Ac=Pb.tableManager.rn(Pb.tFa))&&1<Ac.bottom-Ac.top&&(--Ac.bottom,Pb.gridView.w5(Ac)&&Pb.vob.Zq())};Pb.vX=function(){if(Pb.$&&Pb.gridView){if(Pb.A9b&&Pb.oN){var Ac=Pb.gridView.ha.sa.activeCell;Pb.B0=Pb.lTe();var id=!!Pb.cvc&&Pb.cvc.contains(Ac);if(Pb.B0&&(Ac.equals(Pb.tFa)||id)){Pb.Yh.KAa(Pb.B0,Pb.oN);
return}}Pb.A9b=!1;Pb.B0=Pb.lTe();Pb.B0&&Pb.eya&&Pb.gridView&&Pb.gridView.Ea.gs(Pb.eya)?(Pb.gZc=!1,Pb.MZ()):(Pb.rh.$Zc(),Pb.rh.K1b());Pb.A9b||Pb.Yh.hide()}};Pb.$=k;Pb.tableManager=Y;Pb.contextMenuManager=za;Pb.Yh=new E(k,Pb.vd,H,Va);Pb.rh=H.z3c(k,Y);Pb.gZc=!1;Pb.A9b=!1;Pb.Whd=Ke.EwaSettings.ma(136);Pb.NLc=!0;Pb.gridView=Oe.g(Pb.$);Pb.gridView.rc.ml(Pb.gj);Pb.gridView.Nt(Pb.PR);Pb.$.nl(Pb.zd);Pb.$.Zk(Pb.Yc);Pb.$.QA(Pb.fj);Pb.gridView.view.Vs(Pb.tt);Pb.gridView.ha.OP(Pb.Kg);Pb.vob=Vi.a.instance.create(Pb.vX,
250,pj.a.y1i);nc.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");Pb.rh.sZb(Pb.rya);Pb.vX();k.da.Ga(261,Pb);return Pb}function E(k,H,Y,za){var Va=Je.call(this)||this;Va.isMac=Oj.a.isMac;Va.$=k;Va.ariaLiveNotifier=za;Va.Wp=Y.O4b(k,null,H,A.a.hth,Sg.a.We(9),Ae.a.instance.fa(1704),"PulloutPointerDown");return Va}function B(k){var H=Md.call(this)||this;H.Q4b=null;H.$=k;H.Tb();return H}function z(k){var H=Oc.call(this)||this;H.$=k;Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6198510_AddServiceCreatedEvent")&&
H.Tb();return H}function M(){}function Q(k,H,Y,za,Va){Y=void 0===Y?null:Y;za=void 0===za?null:za;Va=void 0===Va?0:Va;k=L.call(this,k,H)||this;k.LNa=null;k.Hec=Y||Sg.a.current.kp(82);k.Skf=Va;k.X4c=za;k.jBg();return k}function P(k,H,Y,za){k=L.call(this,k,H)||this;k.SBb=null;k.lng=Y;k.N5h=za;k.kBg();return k}function L(k,H){k=Fb.call(this,k)||this;k.TBb=null;k.E8h=Math.max(1,H);return k}function ca(k,H,Y,za,Va,Pb,Ac,id){id=void 0===id?"":id;var Ld=ia.call(this)||this;Ld.hwa=null;Ld.x8e=!1;Ld.Blc=null;
Ld.Alc=null;Ld.buttons={};Ld.lMe={};Ld.$=k;Ld.svgIconProvider=H;Ld.eHi=Y;Ld.dld=za;Ld.cld=Va;Ld.altText=Pb;Ld.iGb=Ac;Ld.buttonText=id;return Ld}function U(k,H,Y,za,Va,Pb,Ac,id){function Ld(ef){ci.g(ef)}var ld=uk.call(this,document.createElement("div"))||this;ld.cjf=null;ld.GSd=!1;ld.oSa=null;ld.aNb=null;ld.UN=function(){ld.raiseEvent("OnObjectButtonMouseOver")};ld.SN=function(){ld.raiseEvent("OnObjectButtonMouseOut")};ld.fBj=function(){ld.cke()};ld.vd=function(ef){ld.raiseEvent(ld.iGb,ef);ld.gGb();
return!0};ld.MIi=function(ef){100<De.a(ff.a.Ta,ld.cjf)&&ld.Eid(new Sys.UI.Point(Math.round(ef.clientX),Math.round(ef.clientY)))};ld.ON=function(ef){ci.g(ef.Ca,!1);return!1};ld.rZ=ld.he.lta();ld.set_visible(!1);ld.kic=Va;ld.iGb=Pb;ld.emc=k;ld.J2b=H;ld.kic&&(ld.oSa=Vi.a.instance.create(ld.fBj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));k&&ld.domElement.classList.add(k);ld.f_a=document.createElement("div");ld.domElement.appendChild(ld.f_a);Y&&ld.f_a.classList.add(Y);za&&(ld.f_a.innerHTML=za);Ac&&(ld.aNb=
document.createElement("div"),ld.domElement.appendChild(ld.aNb),ld.aNb.classList.add(id),ld.aNb.innerText=Ac,ld.domElement.style.padding="3px",wk.a.instance.pa(Eg.a.pointerDown,ld.domElement,ld.ON));ld.XZa=new Kj.a(ld.domElement,7);Fi.a.instance.pa(Eg.a.click,ld.domElement,ld.vd);Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&wk.a.instance.pa(Eg.a.pointerDown,ld.domElement,ld.ON);ld.Jc.ka("mouseup",Ld);ld.Jc.ka("click",Ld);ld.Jc.ka("dblclick",Ld);return ld}
function aa(){}function F(k,H,Y,za){var Va=D.call(this,k,H)||this;Va.Q1a=null;Va.Bwf=function(){Va.Lsc(Va.Bwf);if(Va.Nk&&Va.Nk.length&&Va.contextMenuManager){var Pb=Va.contextMenuManager.Ddd("autoFilterRichFieldList"),Ac=window.document.getElementById(Va.Q1a);Pb.Q0(null,Ac,Va,null,!0)}};Va.Rkg=Y;Va.contextMenuManager=za;return Va}function D(k,H){var Y=Bj.call(this)||this;Y.wP=null;Y.qvb=null;Y.jed=null;Y.SIb=null;Y.hUb=!1;Y.s4d=null;Y.CKi=function(za,Va,Pb){nc.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+
Pb);Y.SIb&&Y.SIb.stop();Y.wP=null;Y.raiseEvent("GetFieldInfoListContextOperationFailed")};Y.DKi=function(za){Dh.a(za)||(Y.SIb&&Y.SIb.stop(),Y.hUb=!1,Y.wP=za.Result,Y.wP&&0<Y.wP.length&&nc.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",Y.wP.length),Y.ljb=!0,Y.jGd())};Y.ljb=!1;Y.wb=k;Y.QSb=-1;Y.tableManager=H;return Y}function J(k){var H=mh.call(this)||this;H.firstElement=null;H.Ow=null;H.oMa=!1;H.Hs=null;H.cvj=Oj.a.Gf||Oj.a.uB;H.Cyf=function(Y){var za=
Y.Ca.keyCode;return za===Ni.a.di?H.fJi():za===Ni.a.MD&&Y.Ca.shiftKey?H.yxh(H.firstElement):!1};H.YDf=function(Y){if(!H.oMa||Y.Ca.keyCode!==Ni.a.IL)return!1;J.V7e();qh.Task.delay(1).CWRCC(function(){H.Ow.focus();return!0},H.la);return!0};H.ITi=function(){document.activeElement&&document.activeElement.id===H.Ow.id||(J.V7e(),qh.Task.delay(1).CWRCC(function(){H.Ow.focus();return!0},H.la))};H.Hwf=function(){H.Z9f(H.Ow)};H.Byf=function(Y){Y.stopPropagation();Y.preventDefault();H.oMa&&(H.oMa=!1)};H.$=k;
(k=H.$.ea.xc)&&nc.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",k.Xsa,k.inWebPart?"Classic":"Non Classic",k.inEmbedView?"True (+Modern)":"False (not Modern)");k&&(k.inWebPart||k.inEmbedView)?nc.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",k.inWebPart?"Classic":"Non Classic",k.inEmbedView?
"True (+Modern)":"False (not Modern)"):(H.a6g(),H.Z6g(),Ik.KeyInputManager.instance.pa(Eg.a.Yb,H.$.domElement,H.YDf));H.$.da.Ga(238,H);return H}function R(k,H,Y,za,Va){Va=void 0===Va?null:Va;var Pb=Ve.call(this)||this;Pb.Onb=null;Pb.aPa=null;Pb.kZc=0;Pb.Zoc=null;Pb.oQi=function(){var Ac=Pb.aPa.CYe();nc.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",Pb.ila,Ac);Pb.Zoc=Vi.a.instance.create(Pb.A6,Math.max(Pb.Yue-Ac,0),pj.a.Rje)};Pb.A6=function(){nc.ULS.sendTraceTag(537153860,
0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",Pb.ila,Pb.aPa.CYe(),Pb.S5a);Pb.kZc++;Pb.kZc>Pb.Xue&&nc.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",Pb.ila);Pb.aPa.Lx.C();Pb.uTe()};Pb.qya=function(){Pb.S5a&&nc.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",Pb.ila,Pb.NLa,Pb.S5a);Pb.Cmd()};
Pb.Xyg=k;Pb.Yyg=H;Pb.documentVisibilityObserver=Y;Pb.ila=za;Pb.UO=Va;Y&&Pb.documentVisibilityObserver.snb(Pb.qya);Pb.jZc=!!Y&&Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);Pb.Xue=Ke.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);H=Ke.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);Pb.Yue=k.Jcd(H);k=Ke.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",
1E3);Pb.gSg=Math.max(Pb.Yue-H,0)+k;return Pb}function Z(){this.startTime=ff.a.Ta.Wb;this.Lx=new Si.a}function W(k){var H=xc.call(this)||this;H.$=k;H.Tb();return H}function ka(k,H,Y,za,Va,Pb,Ac){var id=this;this.$=k;this.functionInfoManager=H;this.calcManager=Y;this.pluginScheduler=za;this.formulaAssistanceUIControl=Va;this.formulaAssistanceTelemetryManager=Pb;this.rh=Ac;this.YRa=!0;this.XLa=this.YLa=!1;this.sNa=null;this.rNa=-1;this.Ica=0;this.Rh=function(Ld,ld){id.gridView.isEditing||id.gridView.Mi||
id.tDb(null===ld||void 0===ld?void 0:ld.cell)};this.onFunctionInfoLoaded=function(){id.functionInfoManager.lbb(id.onFunctionInfoLoaded);id.pSj();id.uda()};this.Btf=function(){id.YRa=!1};this.Jtf=function(Ld,ld){var ef=id.Ya;Ld=ef.text;ef=ef.textBox.caretPosition;0<id.Ica&&id.formulaAssistanceTelemetryManager.SY.commitWhileRequestPending++;id.formulaAssistanceTelemetryManager.L7(["argumentAssistanceComputation","argumentAssistanceOverall"]);ld.shouldRequestAutocompleteOnCommit?id.NWf(Ld,ef):id.EKd(Ld,
ef)};this.ug=function(){id.G2&&(id.YLa&&(id.formulaAssistanceTelemetryManager.u4.isCellContentOnlyEqualDuringEditCounter++,id.YLa=!1),id.XLa&&(id.formulaAssistanceTelemetryManager.u4.isCellContentFormulaCounter++,id.XLa=!1));id.YRa=!0;Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&id.F6c()};this.p6=function(Ld,ld){id.lMd(ld.newValue)};this.Pi=function(){id.kcg()};this.kcg=function(){id.pluginScheduler.notifier().setDefinedNamesInfo(id.g6b.MGe)};this.functionInfoManager=
H;this.formulaAssistanceUIControl=Va;this.pluginScheduler=za;this.gridView=Oe.g(this.$);this.Def=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.sba=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.uyd=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.G2=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");this.Def&&(this.g6b=
new Cd(k),this.gridView.Ea.Gx(this.Pi),this.kcg());this.Zpa=new va(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.wfa=new xa(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);k.da.Ga(464,this);this.calcManager=Y;ee.a.XV()&&this.cmd();this.G2&&this.gridView.wc.mo(this.ug);this.sba&&(this.G2||this.gridView.wc.mo(this.ug),this.Zpa.kEg(this.Btf));this.Jnd=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",
!1)}function ma(k,H){var Y=this;this.rh=k;this.$=H;this.rya=function(){Y.z9b.resolve(Y.rh.Nk);Y.Fag();Y.gwf||(Oe.g(Y.$).wc.mo(Y.ug),Y.gwf=!0)};this.jxf=function(){Y.z9b.reject(null);Y.Fag()};this.ug=function(){Y.rh.Lbb();Oe.g(Y.$).wc.Dn(Y.ug);Y.gwf=!1}}function pa(){var k=this;this.promise=new Promise(function(H,Y){k.Eug=H;k.nug=Y})}function xa(k,H,Y){var za=Lb.call(this,xa.QJa())||this;za.$=k;za.formulaAssistanceUIControl=H;za.formulaAssistanceTelemetryManager=Y;za.Ya=null;za.rr=null;za.tIa=!1;za.uIa=
!1;za.Nta=!1;za.Lta=!1;za.Mta=!1;za.Rt=null;za.pX=0;za.Yq=null;za.hw=!1;za.Ffa=!1;za.SAa=!1;za.wSa=!1;za.fMb=!1;za.RNb=Ta.Dismissed;za.onRestoreFocus=function(){};za.dismiss=function(){za.hw=!1;za.Wtd();za.rK&&za.Ya.isEditing&&za.Nma();za.Yq=null;za.formulaAssistanceUIControl&&(za.formulaAssistanceUIControl.dismiss(za.domElement),za.rr.canReceiveFocus=!1,za.RNb=Ta.Dismissed)};za.did=function(){za.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};za.FIi=function(){za.dismiss();Oe.g(za.$).lk.textBox.focus()};
za.lRa=function(){var Va={};za.iEf?Va[Ea.a.oV]="SmartSuggestionsCard":Va[Ea.a.oV]="FunctionAndSmartSuggestionsCard";za.$.Xd(802602464,0,8,Va)};za.ug=function(){za.jzb&&za.kIg()};za.Uzd=function(Va,Pb){za.pfb(Pb);za.uIa=!0};za.kd=function(){za.visible=!1};za.Tzd=function(Va){za.Mta=!0;za.Dqb(Va)};za.gi=function(){za.dismiss()};za.tt=function(){void 0!==za.Yq&&null!==za.Yq&&za.Yq()};za.rr=new Db(za.$,za.formulaAssistanceUIControl,1,ui.a.Nbd,za.did);Oe.g(za.$).view.Vs(za.tt);Oe.g(za.$).ha.SG(za.kd);
za.$.xa.Bg(za.gi);za.jzb=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");za.jzb&&Oe.g(za.$).wc.mo(za.ug);Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&za.$.domElement.appendChild(za.domElement);za.Zii=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents");return za}function va(k,H,Y){var za=ea.call(this,va.QJa())||this;za.$=k;za.formulaAssistanceUIControl=H;za.formulaAssistanceTelemetryManager=
Y;za.W2=0;za.rr=null;za.Yq=null;za.Yka=null;za.hw=!1;za.nR=!1;za.kd=function(){za.visible=!1};za.onCardModeChange=function(Va){za.bOb(Va);1===Va?za.formulaAssistanceTelemetryManager.d$.argumentAssistanceCollapseCounter++:za.formulaAssistanceTelemetryManager.d$.argumentAssistanceExpandCounter++};za.lRa=function(Va){var Pb={};Pb[Ea.a.oV]="ArgumentAssistanceCard";var Ac={};Ac.FunctionName=Va.functionName;Pb[Ea.a.T$c]=Ac;za.$.Xd(802602464,0,8,Pb)};za.tt=function(){void 0!==za.Yq&&null!==za.Yq&&za.Yq()};
za.onDismissClick=function(){za.formulaAssistanceTelemetryManager.d$.argumentAssistanceDismissCounter++;za.dismiss();za.raiseEvent("DC");za.nR&&za.kH.clear();0===za.W2&&za.bOb(1)};za.ug=function(){za.nR&&za.kH.clear()};za.sba=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);za.ROd();za.rr=new Db(za.$,za.formulaAssistanceUIControl,0,ui.a.Kbd);Oe.g(za.$).view.Vs(za.tt);Oe.g(za.$).ha.SG(za.kd);za.nR=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",
!1)&&Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1);za.nR&&(za.kH=new Sb(za.formulaAssistanceUIControl,za.formulaAssistanceTelemetryManager),Oe.g(za.$).wc.mo(za.ug));Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&za.$.domElement.appendChild(za.domElement);return za}function ta(k,H,Y,za,Va,Pb,Ac,id,Ld){var ld=K.call(this,k)||this;ld.functionInfoManager=H;ld.calcManager=za;ld.instantaneousSupportInformationManager=
Va;ld.formulaAssistanceUIControl=Ac;ld.formulaAssistanceTelemetryManager=id;ld.pluginScheduler=Ld;ld.Pdc=!1;ld.rr=null;ld.uGa=null;ld.Eg=null;ld.hW=null;ld.Qrd=null;ld.I5=null;ld.i3a=0;ld.O$b=0;ld.V3=0;ld.$Ie=0;ld.zsb=0;ld.beb=0;ld.t5b=0;ld.sxc=!1;ld.Mia=null;ld.Dpc=null;ld.columnName="";ld.b6c=!1;ld.owe=!1;ld.GJa=[];ld.uQ=null;ld.vSa=[];ld.Yq=null;ld.mcd=null;ld.x8=null;ld.Ffa=!1;ld.SAa=!1;ld.wSa=!1;ld.fMb=!1;ld.YLa=!1;ld.XLa=!1;ld.sNa=null;ld.rNa=0;ld.X1d=null;ld.NCb=0;ld.cnd=!1;ld.onRestoreFocus=
function(){};ld.Ifb=void 0;ld.did=function(){ld.Hk&&ld.raiseEvent(ta.pbd,null)};ld.DSe=function(){ld.Mia=!1;ld.hW=ld.Ya.text;ld.Df.sJa(ld.Rt,ld.hW,!0,ld.columnName,void 0,!1);1===ld.Df.Fq.length&&1===ld.Df.LW.length?(ld.set_visible(!1),ld.owe||ld.ild()):ld.show()};ld.KLi=function(ef){if(Dh.a(ef))-315732528!==ef.Errors[0].MessageId&&nc.ULS.sendTraceTag(537162013,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",he.a.Wc(ef.Errors));else if((ef=
ef.Result)&&ef.length){ld.Eg.QO||(ld.Eg.QO={},ld.Eg.QO.HeadersList=[]);ld.Eg.QO.IsFullTableHeaders=!0;for(var Jf=0;Jf<ef.length;++Jf)ld.Eg.QO.HeadersList[Jf]={},ld.Eg.QO.HeadersList[Jf].Index=Jf,ld.Eg.QO.HeadersList[Jf].Name=ef[Jf];ld.RGf(!0);ld.hW=ld.K2e();ld.Df.sJa(ld.Rt,ld.hW,!0,void 0,void 0,!0);ld.show()}else nc.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};ld.JLi=function(ef){ef=ch.a.pg(ef.data);nc.ULS.sendTraceTag(537162011,
0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",he.a.Wc(ef))};ld.ctf=function(ef,Jf){ld.gridView.isEditing||ld.gridView.Mi||ld.tDb(null===Jf||void 0===Jf?void 0:Jf.cell)};ld.p6=function(ef,Jf){ld.lMd(Jf.newValue)};ld.kd=function(){(Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)||ld.Hk)&&ld.set_visible(!1)};ld.bxf=function(){ld.uGa=null;ld.x8=null};ld.gi=function(){ld.Hk&&ld.x1a()};ld.onFunctionInfoLoaded=
function(){ld.sob()};ld.rya=function(){ld.cka?(ld.x8=null,ld.uGa=null,ld.sob()):ld.rh.Nk&&ld.Yre()};ld.vca=function(){ld.uQ&&Qa(ld.$,ld.uQ.HelpId,ld.uQ.IsDynamicUdf);return!0};ld.x1a=function(){ld.Hk&&ld.Wtd();ld.rK&&ld.Ya.isEditing&&ld.Nma();ld.Yq=null;ld.formulaAssistanceUIControl&&(ld.formulaAssistanceUIControl.dismiss(ld.w0b),ld.rr.canReceiveFocus=!1);ld.cnd=!1};ld.XBf=function(){ld.rK&&ld.Nma();ld.H3f();1===ld.pNd.type&&Ke.EwaSettings.Fb()&&!ld.Ya.text.includes("\n")&&ld.OEd(ld.pNd)};ld.onDismiss=
function(){ld.isListVisible=!1;ld.gridView.lk.textBox.focus()};ld.lRa=function(){var ef={};ld.Df.jic?ef[Ea.a.oV]="SmartSuggestionsCard":ef[Ea.a.oV]="FunctionAndSmartSuggestionsCard";ld.$.Xd(802602464,0,8,ef)};ld.Uzd=function(ef,Jf){ld.Df.odg(Jf);ld.Hk&&(ld.uIa=!0)};ld.Tzd=function(ef){ld.Hk&&(ld.Mta=!0);ld.rK?(ld.xAe(),ld.gridView.lk.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):ef.textEdit?ld.Dqb(ef.textEdit):ld.fz(!0)};ld.fr=Oe.g(k);ld.domElement.className=eh.a.vMe;ld.rh=Pb.z3c(k,
Y);ld.g6b=new Cd(k);ld.Rwg=Y;ta.Ekd||(ta.Ekd=ta.QJa());ld.domElement.innerHTML=ta.Ekd;ld.Tyd=RegExp("\\d+");gh.d(ld.style,ld.$.isChromeRtl);ld.Zia=new gb(ld.$,ld.domElement,ld.functionInfoManager,ld.formulaAssistanceUIControl,ld.formulaAssistanceTelemetryManager,ld.pluginScheduler);H=$get(ib.jcd,ld.domElement);Y=$get(ib.ecd,ld.domElement);za=$get(ib.lcd,ld.domElement);ld.Bog=new qa(ld.$,H,za,Y,ld);ld.rh.sZb(ld.rya);ld.functionInfoManager.HYa(ld.onFunctionInfoLoaded);ld.functionInfoManager.EEg(ld.bxf);
ld.w0b=ld.domElement;ld.Hk&&(ld.$.xa.Bg(ld.gi),ld.Df.FVc(ld.XBf),Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(ld.w0b=document.createElement("div")));ld.OSa(!0);ld.R6f(!0);ld.$.domElement.appendChild(ld.w0b);ld.IQc=0;(Y=Uj.a(k))&&ld.GJa.push(new ha(k,Y,ld,ld.formulaAssistanceTelemetryManager));ld.GJa.push(new ha(k,ld.fr.rc,ld,ld.formulaAssistanceTelemetryManager));ld.tub=ld.GJa[0];ld.Ppb=ld.GJa[ld.GJa.length-1];k.da.Ga(221,ld);ld.instantaneousSupportInformationManager||
ld.$.da.$a(268,function(ef){ld.instantaneousSupportInformationManager=ef});ld.XRe=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);Ke.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===ld.formulaAssistanceTelemetryManager.pna.anyPluginInitialized?nc.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):ld.formulaAssistanceTelemetryManager.pna.anyPluginInitialized||
(ld.NCb=Ke.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));ld.RAa=ee.a.rMa(ld.$);ld.wyc=ee.a.Xqd();ld.uyd=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");ld.G2=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");ee.a.XV()&&ld.cmd();ee.a.jN(ld.$)&&H.classList.add("ewa-fb-refactor");ld.Hk?ld.gridView.ha.SG(ld.kd):ld.gridView.ha.OP(ld.kd);ld.rr=new Db(ld.$,ld.formulaAssistanceUIControl,1,ui.a.Nbd,ld.did);
ld.Jnd=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);ld.Icf=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6279033_logAutocompletionStatistics");ld.$hi=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",!1);ld.Xcf=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1)&&Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6347847_FormulaAssistanceLayoutFix");return ld}function fa(){}
function Ca(){this.caretPosition=this.content=null}function Sa(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function Gb(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function kb(){this.B9=this._name=null}function lb(){this._name=null}function Nb(){this._name=null}function Aa(){this.B9=this._name=null}function qa(k,H,Y,za,Va){k=nk.call(this,k,H)||this;k.jra=null;k.lvc=0;k.eMb=0;k.v3b=null;k.nVe=Y;k.Aub=za;
k.formulaAssistanceControl=Va;k.Fq=[];k.LW=[];k.Hk=ee.a.h5();k.Gef=k.Hk&&Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");return k}function Xa(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.data=this.isPrefixed=this.detail=this.type=null}function Ha(k,H){this.$=k;this.items=H;this.rMa=ee.a.rMa(this.$)}function Ra(k,H){this.H_i=k;this.hrf=H}function mb(){}function La(k){this.index=k}function ha(k,H,Y,za){k=nl.call(this,k,H)||this;
k.formulaAssistanceControl=Y;k.formulaAssistanceTelemetryManager=za;k.hEf=!1;k.bSa=null;k.old=0;k.fGc=null;k.bIa=null;k.vQ=0;k.Dob=H.textBox;k.Hk=ee.a.h5();k.P9i=Ke.EwaSettings.Fb();k.G2=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");return k}function Ia(){this.Oha=this.Rsa=this.Ssa=!1;this.vEf=40;this.sze=41;this.W_a=this.HCd=this.ICd=this.LFb=0;this.vvf=!0;this.kBd=!1;this.ETe=this.bNd=-1}function gb(k,H,Y,za,Va,Pb){var Ac=kk.call(this,gb.QJa(ee.a.h5()))||
this;Ac.$=k;Ac.Nj=H;Ac.functionInfoManager=Y;Ac.formulaAssistanceUIControl=za;Ac.formulaAssistanceTelemetryManager=Va;Ac.pluginScheduler=Pb;Ac.K1a=null;Ac.W2=0;Ac.rr=null;Ac.ZWc=!1;Ac.Yq=null;Ac.Yka=null;Ac.YRa=!0;Ac.nR=!1;Ac.onCardModeChange=function(id){Ac.bOb(id);1===id?Ac.formulaAssistanceTelemetryManager.d$.argumentAssistanceCollapseCounter++:Ac.formulaAssistanceTelemetryManager.d$.argumentAssistanceExpandCounter++};Ac.lRa=function(id){var Ld={};Ld[Ea.a.oV]="ArgumentAssistanceCard";var ld={};
ld.FunctionName=id.functionName;Ld[Ea.a.T$c]=ld;Ac.$.Xd(802602464,0,8,Ld)};Ac.onDismissClick=function(){Ac.formulaAssistanceTelemetryManager.d$.argumentAssistanceDismissCounter++;Ac.YRa=!1;Ac.nsb();Ac.nR&&Ac.kH.clear();0===Ac.W2&&Ac.bOb(1)};Ac.ug=function(){Ac.YRa=!0;Ac.nR&&Ac.kH.clear()};Ac.cKi=function(id){id.button===Sys.UI.MouseButton.leftButton&&id.target&&(ci.g(id),Ac.K1a&&Ac.K1a.Yna(id))};Ac.tt=function(){void 0!==Ac.Yq&&null!==Ac.Yq&&Ac.Yq()};Ac.Hk=ee.a.h5();Ac.sba=Ac.Hk&&Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",
!1);Ac.Hk?(Ac.ROd(),Ac.rr=new Db(Ac.$,Ac.formulaAssistanceUIControl,0,ui.a.Kbd),Ac.sba&&Oe.g(Ac.$).wc.mo(Ac.ug),Ac.nR=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!Ac.formulaAssistanceUIControl,Ac.nR&&(Ac.kH=new Sb(Ac.formulaAssistanceUIControl,Ac.formulaAssistanceTelemetryManager)),Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",
!1)&&Ac.$.domElement.appendChild(Ac.domElement)):(Ac.K1a=new ob(Ac.domElement,Ac.$.zE,void 0,ee.a.jN(Ac.$)),Ac.Jc.ka("mousedown",Ac.cKi),k=$get(ib.jcd,Ac.Nj),Ac.Nj.insertBefore(Ac.domElement,k));Oe.g(Ac.$).view.Vs(Ac.tt);return Ac}function Sb(k,H){this.E$b=k;this.formulaAssistanceTelemetryManager=H;this.un=!1;k={};this.usageCount=(k[Fh.Drag]=0,k[Fh.Move]=0,k);this.lDc=this.E$b.getWindowEdgeBuffer()+1;this.fqf=new tc(this);this.nJe=new wc(this)}function wc(k){this.kH=k;this.un=!1}function tc(k){var H=
this;this.kH=k;this.$Z=this.VQd=this.un=!1;this.onKeyDown=function(Y){return!H.$Z&&Y.keyCode===Ni.a.Moa&&Y.altKey&&Y.ctrlKey?(H.i8b(),Y.stopPropagation(),Y.preventDefault(),!0):!1};this.gNa=function(Y){if(!H.$Z)return!1;if(Y.eventName===Eg.a.Yb){var za=Y.Ca.ctrlKey?1:Y.Ca.shiftKey?50:10;switch(Y.Ca.keyCode){case Ni.a.ZTa:H.d6(0,-za);break;case Ni.a.Koa:H.d6(0,za);break;case Ni.a.Loa:H.d6(-za,0);break;case Ni.a.Afb:H.d6(za,0);break;case Ni.a.IL:case Ni.a.di:H.VQd=!0;break;default:return!1}}Y.eventName===
Eg.a.Ud&&H.VQd&&H.m4(!0);Y.Ca.preventDefault();return!0};this.hGb=function(Y){if(!H.$Z)return!1;Y.Ca.preventDefault();H.m4();return!0};this.onBlur=function(){if(!H.$Z)return!1;H.m4();return!0};this.xr=Ik.KeyInputManager.instance;this.pointerInputManager=wk.a.instance}function Tb(){this.content=null;this.caretPosition=0}function pb(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}function cb(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function ob(k,
H,Y,za){za=void 0===za?!1:za;H=vi.call(this,k,H,!1,void 0===Y?null:Y)||this;H.JRa(za);H.lj=S.a.equals("rtl",k.dir,!0);return H}function rc(k,H){var Y=lj.call(this)||this;Y.Gog=[];Y.ncd={};Y.qVe={};Y.uT=null;Y.U8=[];Y.NJa={};Y.qxf=function(za,Va){nc.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");Y.cxf(za,!!Va&&1!==Va.FilterType,!0)};Y.pxf=function(){nc.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");
Y.uT=null};Y.$wf=function(za){nc.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");Y.CHd(za.gja,!0,!1)};Y.oxf=function(za){nc.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");Y.cxf(za,!0,!1)};Y.kLc=!1;Y.iLc=!1;Y.wb=k;Y.pluginScheduler=H;Y.$.da.Ga(19,Y);return Y}function Db(k,H,Y,za,Va){this.QZc=!1;this.$=k;this.formulaAssistanceUIControl=H;this.OUe=Y;this.Wkj=za;this.h5e=void 0===Va?null:Va}function Ja(k,H,Y){var za=
ei.call(this)||this;za.kcd=k;za.qNd=H;za.MVi=Y;return za}function Qb(k){var H=hi.call(this)||this;H.qNd=k;return H}function yc(k,H){var Y=Pj.call(this)||this;Y.functionName=k;Y.kcd=H;return Y}function Cd(k){this.NGe={};this.$=k}function bc(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}function Kb(k){this.yT=0;this.T8d=!1;this.YVa=this.p$d=null;this.brg=void 0===k?!1:k;this.textEdit=null}function ic(k){var H=this;this.Erb=this.xha=this.calcManager=this.Ya=null;this.D9a=function(){H.j5a(!1,
!1)};this.$=k;this.rub=new Wa(k);this.C$b=new Gc(k);this.D$b=new wb(this);Oe.g(k).rc.mo(this.D9a);this.$.da.Ga(317,this)}function wb(k){this.X7=0;this.Lbd=k}function Wa(k){this.tqa=this.QSa=this.j2a=this.mQ=this.L$=this.Ya=null;this.njd=!1;this.Tc=k}function Xb(){}function Gc(k){var H=this;this.Cyi=30;this.calcManager=null;this.Od=!1;this.bPa=this.YFb=this.K$a=null;this.iD=function(){H.zha.d_()};this.$=k;this.zha=new hc;this.eSf=-1;this.$.ea.QG(this.iD)}function zb(k,H,Y,za,Va,Pb,Ac){Ac=k.Na(1,void 0===
Ac?null:Ac);Ac.getPartialCalcResultsParameters=H;return Jg.i(k,"GetPartialCalcResults",Ac,Y,za,Va,Pb,4)}function hc(){this.JQa={}}function Uc(k){var H=Eh.call(this)||this;H.$=k;H.Tb();return H}function jb(k,H){var Y=this;this.MJa=this.Lua=this.$ia=null;this.MAf=function(za,Va){Y.Y4i(Va.functionName,Va.kcd)};this.OAf=function(za,Va){Y.X4i(Va.kcd,Va.qNd,Va.MVi)};this.NAf=function(za,Va){za=[];Va=El(Va.qNd);for(var Pb=Va.next();!Pb.done;Pb=Va.next())Pb=Pb.value,(!Y.swa||void 0!==Pb&&null!==Pb)&&(Pb=
Pb.trim())&&za.push(Pb);if(!Y.swa||za.length){Va="";for(Pb=0;Pb<za.length;Pb++){var Ac=Y.aZc(za[Pb]),id=jb.fEd(Pb,za.length);Va+=Ac+id;id&&(Va+=Y.ariaLiveNotifier.Fxa)}Y.ariaLiveNotifier.readText(Va)}};this.PAf=function(za,Va){Y.ariaLiveNotifier.$4i(Va.dG,Va.description,Va.selectedIndex.toString(),Va.length.toString())};this.IAf=function(za,Va){Y.ariaLiveNotifier.CLf(Va.description,Va.length)};this.Wwf=function(){Y.ariaLiveNotifier.Iab(Ae.a.instance.fa(878),Ea.a.sZa)};this.Pwf=function(){Y.ariaLiveNotifier.readText(Ae.a.instance.fa(879))};
this.Swf=function(){Y.ariaLiveNotifier.readText(Ae.a.instance.fa(880))};this.$=H;this.ariaLiveNotifier=k;this.$.da.Ga(219,this);this.swa=ee.a.h5()}function $a(k){return Oh.call(this,k)||this}function I(k,H,Y){var za=this;this.$=k;this.Ra=H;this.functionInfoManager=Y;this.JEh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=function(){za.menuId&&Array.contains(za.JEh,
za.menuId)&&za.frame.Uv(za.menuId)};if(this.tB=ee.a.tB(this.$))this.formulaAssistanceManager=this.$.da.Aa(464);this.sM={};this.frame=this.$.frame;this.functionInfoManager.HYa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=k.da.Aa(491)}function ba(k,H){var Y=Nh.call(this,k,Ae.a.instance.fa(1016),void 0,void 0,void 0,Ke.EwaSettings.ma(399))||this;Y.LJa=null;Y.fja=null;Y.KJa=null;Y.Cub=null;Y.kVe=null;Y.eja=null;Y.lVe=null;Y.oVe=null;Y.Ukf=null;Y.Bub=null;Y.Djd=!1;Y.U1b=null;Y.f6=
null;Y.nxb=null;Y.onFunctionInfoLoaded=function(){if(!Y.KJa.count){for(var za=Y.functionInfoManager.dcd,Va=0,Pb=za.length;Va<Pb;++Va)Y.KJa.kM(za[Va],za[Va],!1).className=Cc.a.Gnh;Y.KJa.selectedIndex=0;kg.a.zc([Y.U1b,Y.f6,Y.nxb]);Y.U1b=Y.he.Zd(Y.LJa);Y.f6=Y.he.Zd(Y.fja);Y.nxb=Y.he.Zd(Y.Bub);Y.U1b.ka("change",Y.axf);Y.f6.ka("change",Y.dKi);Y.f6.ka("dblclick",Y.eKi);Y.nxb.ka("click",Y.vca);Y.nxb.ka("keyup",Y.fMi);Kc.DOMElementExtensions.setVisible(Y.fja,!0);Kc.DOMElementExtensions.setVisible(Y.kVe,!1);
Y.$.o5c&&Kc.DOMElementExtensions.setVisible(Y.Ukf,!0)}Y.axf(null);Y.getButton(0).get_element().disabled=!1;Y.LJa.disabled=!1;Y.BRa();Y.Djd=!0};Y.vca=function(){Y.T$&&Qa(Y.$,Y.T$.HelpId,Y.T$.IsDynamicUdf)};Y.fMi=function(za){13!==za.keyCode&&32!==za.keyCode||Y.vca(za)};Y.axf=function(){var za=Y.functionInfoManager.mbc(Y.KJa.xe.value);Y.Qua(za);Y.fja.scrollTop=0;Y.rYf()};Y.dKi=function(){Y.rYf()};Y.eKi=function(za){Y.T$&&(ci.g(za),Y.close(0))};Y.od=function(za,Va){fd.b(Va)&&Y.Ut()};Y.functionInfoManager=
k.da.Aa(19);Y.formulaAssistanceControl=k.da.Aa(221);Y.Mbd=ee.a.tB(Y.$);Y.Mbd&&(Y.formulaAssistanceManager=k.da.Aa(464));Y.JIa=H;Y.v_c=H.textBox.caretPosition;return Y}function sa(k){var H=$b.call(this,k)||this;H.hVe=function(Y,za){if(1===Y){H.hide();Y=new vh.a(-433697611,0,H.$.ed,8,null);var Va={};za=(Va[Re.a.ld]=za.functionName,Va);H.$.Ka.Xb(Y,za)}};H.onFunctionInfoLoaded=function(){H.functionInfoManager.lbb(H.onFunctionInfoLoaded);H.Z9e()};H.Cvb=function(Y){qb(H.$,Y,!1)};H.Kef=function(Y){return!H.functionInfoManager.Fgc(Y)};
H.Hm=Ae.a.instance.fa(1016);H.functionInfoManager=k.da.Aa(19);H.hh();return H}function Oa(k){var H=Qc.a.V_,Y=k.da.Aa(368);Y&&!Oe.g(k).Dj&&(H=Y.zoom);return H}function qb(k,H,Y){if(Y){if(H&&(!H||H.startsWith("http://")||H.startsWith("https://"))){if(k.ma(157)&&(k=k.da.Aa(269))&&k.BBa(H))return;$c.HelperMethods.jf(H,"_blank",Ba.a)}}else $c.HelperMethods.E6(k.sG,"XLWAEndUser_"+H,k.YS)}function Qa(k,H,Y){if(k){var za=k.da.Aa(491);za?za.d$.argumentAssistanceLearnMoreCounter++:nc.ULS.sendTraceTag(523551513,
0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");Y?qb(k,H,Y):(Y=new vh.a(-859308420,Re.a.Ub,k.ed,0,null),za={},H=(za[Re.a.ld]=Ea.a.NV,za[Re.a.Cg]="HelpID="+H,za),k.Ka.Xb(Y,H))}}function ib(){}function Mb(k){var H=X.call(this)||this;H.$=k;H.Tb();return H}function Jb(k){var H=ok.call(this,document.createElement("div"))||this;H.zR=!1;H.cR=!1;H.i1b=!1;H.Ph=null;H.Zh=null;H.ggi=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");
H.hgi=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");H.hpd=!1;H.$pd=!1;H.nnd=!1;H.S5b=[];H.Rh=function(){H.O2f(!1)};H.ROa=function(za,Va){H.show(H.sR,!H.isListVisible,!0,Oj.a.rp||3===Va.yb||3===Re.a.Ub);H.Zzd(null,null)};H.Zzd=function(){H.gridView.setFocus()};H.vLa=function(){H.Ya.textBox.kK=!0};H.tt=function(){H.Wcg()};H.onContentReady=function(){H.O2f(H.isListVisible)};H.Yc=function(){H.ky()};H.Hya=function(){H.uRa()};H.dwf=function(){H.Wcg()};H.$=k;H.gridView=
Oe.g(H.$);H.dJ=H.gridView.rc;var Y="<div id='dv_reader_description' class='"+Hg.a.yNe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+kd.Unh+" "+A.a.fq+"'></div>\r\n<div id='dv_list_box' class='"+kd.anh+" "+A.a.$o+" "+A.a.fq+"'></div>\r\n<div id='dv_prompt_box' class='"+kd.Snh+" "+A.a.fq+"'></div>";H.domElement.className=kd.Tnh;H.domElement.innerHTML=Y;gh.d(H.style,H.isGridRtl);H.dg=$get("dv_list_box",H.domElement);H.j0=$get("dv_prompt_box",H.domElement);H.wsa=$get("dv_list_button",
H.domElement);H.LBb=$get("dv_reader_description",H.domElement);(Y=Uj.a(k))&&H.S5b.push(new Za(k,Y,H));H.S5b.push(new Za(k,H.gridView.rc,H));H.gridView.ha.zJ(H.Rh);H.gridView.Nt(H.onContentReady);H.gridView.wc.oEg(H.dwf);H.$.Zk(H.Yc);Y=H.gridView.Nj;Y.insertBefore(H.domElement,Y.firstChild);H.onContentReady(null,null);k.da.Ga(14,H);return H}function Zb(k,H,Y,za,Va,Pb,Ac,id,Ld,ld){var ef=fl.call(this,document.createElement("a"))||this;ef.Bl=!1;ef.vd=function(Jf){ef.raiseEvent("ClickButton",Jf);return!0};
ef.onKeyDown=function(Jf){ef.raiseEvent("KeyDown",Jf);return!1};ef.Sw=function(){ef.hovered=!0;ef.raiseEvent("PointerOver");return!1};ef.WN=function(){ef.hovered=!1;ef.raiseEvent("PointerOut");return!1};ef.onBlur=function(Jf){ci.g(Jf);ef.focused=!1;ef.raiseEvent("Blur")};ef.onFocus=function(Jf){ci.g(Jf);ef.focused=!0;ef.raiseEvent("Focus")};ef.ckh=id;ef.jfh=Ld;ef.jJ=Zb.Bb(ef.domElement,H,Y,za,Va,Pb,Ac,ld);ef.Jc.ka("contextmenu",function(Jf){ci.g(Jf)});ef.enable();ef.hovered=!1;ef.focused=!1;k.appendChild(ef.domElement);
return ef}function ub(k,H,Y){k=Tk.call(this,k,H,new bl.a(kd.listItem,kd.HBb,kd.MBb,kd.NBb))||this;k.Flb=null;k.xe=null;k.Fda=null;k.nW=null;k.fIa=null;k.INa=0;k.zFb=[];k.vQj=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");k.LBb=Y;return k}function Za(k,H,Y){k=Ck.call(this,k,H)||this;k.dataValidationControl=Y;return k}function vc(k,H,Y){var za=el.call(this,k)||this;za.XE=null;za.jV=null;za.Sff=!1;za.errorMessage=null;za.u7e=null;za.Fm=null;za.aea=null;za.TFe=
function(Va){var Pb=za.$,Ac=za.Sff;za.hide();var id=Oe.g(Pb);id.isEditing&&id.rc.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Va&&Ac&&Uf.TaskExtensions.Ba(id.startEdit(!1,1),function(){var ld=id.rc.textBox;ld.text&&ld.selectRange(0,ld.text.length)},za.la,11,Xf.a.current);if(1===Va&&!Ac){if(Ac=id.kc(null)){id.Ea.WV();var Ld=Object(ag.a)(new Ph.a,{Text:Ac.cell.userInput});id.setCell(Ld,Ac.range,0,63,null)}Pb.Xd(-798660877,Re.a.Ub,8,null)}2===Va&&Uf.TaskExtensions.Ba(id.startEdit(!1,
0),function(){var ld=id.rc.textBox;ld.text&&ld.selectRange(0,ld.text.length)},za.la,11,Xf.a.current)};za.G9a=function(){$c.HelperMethods.E6(za.$.sG,za.error.HelpTopicId,za.$.YS)};za.WLi=function(){za.wxb();za.$.Xd(802602464,2,8,za.jV)};za.vKi=function(){nc.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};za.wKi=function(Va){!Va||Dh.a(Va)?nc.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):
(Va=za.uWh(Va.Result),za.XE.errorInformation=Va,za.bfb(za.UIa,za.hwb(za.TFe),za.XE))};za.oAd=function(){za.show(za.bSb)};za.bMe=Y;za.sqmManager=Xk.a(za.$);za.error=vc.WQ(H,k,Y);za.zb.Zp=za;k=k.da.Aa(14);za.av=k.F3a(za.bMe);za.UIa=za.av&&za.av.UIa?za.av.UIa:Ae.a.instance.fa(1700);za.Roj();za.initializeAndShow(za.UIa,za.TFe,za.XE);return za}function zc(k,H,Y){var za=tk.call(this,k,zc.WQ(H,k,Y))||this;za.kd=function(){za.setFocus()};Oe.g(za.$).ha.SG(za.kd);Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5780477_datavalidationListRule")&&
(k=k.da.Aa(14).F3a(Y))&&k.options&1&&nc.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");return za}function kd(){}function wa(k){var H=kl.call(this)||this;H.$=k;H.Tb();return H}function Na(k,H){var Y=this;this.GZa=null;this.JAf=function(za,Va){1<Va.length&&(za=Ae.a.instance.fa(853),Y.ariaLiveNotifier.CLf(za,Va.length))};this.KAf=function(za,Va){nc.ULS.shipAssertTag(537167961,0,0<=Va.selectedIndex&&
0<=Va.length&&Va.selectedIndex<Va.length,"Invalid ListEventArgs: SelectedIndex/Length");nc.ULS.shipAssertTag(537167960,0,!!Va.dG,"ListEventArgs: SelectedValue should not be null");Y.ariaLiveNotifier.Z4i(Va.dG,Va.selectedIndex+1,Va.length)};this.LAf=function(za,Va){Y.ariaLiveNotifier.VPa(Va.dG)};this.ariaLiveNotifier=k;Ke.EwaSettings.em()||H.Ga(213,this)}function Vb(k){var H=dl.call(this)||this;H.$=k;H.Tb();return H}function pc(k){var H=Ji.call(this)||this;H.$=k;H.Tb();return H}function hd(k,H){var Y=
this;this.uNa=1;this.Dga=[];this.active=!1;this.Tw=function(){var za=Y.gridView.mhd();if(!(0>=za||za===Y.uNa||Y.gridView.oq)){for(var Va=!1,Pb=[],Ac=[],id=Y.Dga.length-1;0<=id;id--){var Ld=Y.Dga[id];if(Y.lhd(Ld)>za||Ld.bottom<za)Pb.push(Ld),Array.removeAt(Y.Dga,id),Va=!0}for(id=Y.tableManager.rangeList.length-1;0<=id;id--){Ld=Y.tableManager.rangeList[id];var ld=Y.lhd(Ld);ld<=za&&Ld.bottom>=za&&!(ld<=Y.uNa&&Ld.bottom>=Y.uNa)&&Ld.eba&&(Ac.push(Ld),Va=!0)}if(Va)for(Ld=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?
Y.gridView.tpc:[Y.gridView.n3],id=El(Ld),Ld=id.next();!Ld.done;Ld=id.next())for(ld=El(Ld.value),Ld=ld.next();!Ld.done;Ld=ld.next()){var ef=El(Ld.value);for(Ld=ef.next();!Ld.done;Ld=ef.next()){for(var Jf=Ld.value,Kg=Jf.Qn,Cg=ql.a(Jf.W4),Wg=Pb.length-1;0<=Wg;Wg--)Ld=Pb[Wg],Y.pAc(Ld,!1,Cg,Kg)&&Array.removeAt(Pb,Wg);for(Wg=Ac.length-1;0<=Wg;Wg--)Ld=Ac[Wg],Y.pAc(Ld,!0,Cg,Kg)&&Y.Dga.push(Ld);Va&&Jf.POd(Cg)}}else nc.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");
Y.uNa=za}};this.Sxf=function(za,Va){Va.isRow||Va.QVc(Y.aLa)};this.Txf=function(za,Va){Va.isRow||(Y.tableManager.rangeList.length||Y.deactivate(),Va.NJd(Y.aLa))};this.aLa=function(za,Va){if(Y.me())Y.activate();else if(za=Y.active,Y.deactivate(),!za){nc.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(Va=Va.eu)&&Y.Q4f(Va.Qn[0],Va.Qn[Va.Qn.length-1],Va.W4,Va.Qn)};this.DAf=function(za,Va){!Y.gridView.oq&&(Y.me()?Y.activate():
(za=Y.active,Y.deactivate(),za||nc.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Va=Va.eu)&&(za=ql.a(Va.W4),Y.Q4f(Va.Qn[0],Va.Qn[Va.Qn.length-1],za,Va.Qn)&&Va.POd(za))};this.Ge=function(){Y.gridView.rb.U4?Y.deactivate():Y.activate()};this.tableManager=k;this.gridView=H;this.$=H.$;k.Pne(this.DAf);H.KEg(this.Sxf);H.LEg(this.Txf);this.$.xa.Bg(this.Ge);this.$.Hb.Bg(this.Ge);this.kre(function(za){za.QVc(Y.aLa)});this.me()&&(this.activate(),
this.Tw(this,null));this.$.da.Ga(68,this)}function Ud(k){return Zk.call(this,k)||this}function Zc(k,H,Y,za,Va,Pb,Ac){var id=this;this.$=k;this.gridView=H;this.Ug=Y;this.HB=za;this.borderFormatManager=Va;this.moreColorsHelper=Pb;this.tbd=Ac;this.YA=null;this.n_a=1461300262;this.zx=this.k_a=this.O8a=this.B$b=null;this.EMi=function(Ld,ld){if(!Dh.a(Ld)&&ld){var ef=!!Ld&&!!Ld.RequestTelemetryData;Oe.g(id.$).Ji.ola(ld,Ld.StateId,ef?Ld.RequestTelemetryData.EcsOperationDuration:0,ef?Ld.RequestTelemetryData.EcsRequestDuration:
0,ef?Ld.RequestTelemetryData.WfeRequestDuration:0)}};this.iqb=function(){if(id.gridView.q6a){var Ld=id.$.da.Aa(254,!0);Ld&&Ld.Dbj(id.iqb);id.gridView.q6a=!1;id.gridView.rg.Mo(Ea.a.P4);id.gridView.ha.$W(id.Jbd);Oe.g(id.$).$.Bf()}};this.Jbd=function(){var Ld=id.B$b;id.B$b=Yf.d(id.$.xa.qa);if(Ld===id.B$b)if(id.gridView.ha.$W(id.Jbd),(Ld=id.$.da.Aa(254,!0))&&Ld.PZc(36,Oe.g(id.$).ha.sa.selectedRanges)){Ld=new vh.a(1804571062,2,2,0,null);var ld={};id.$.Ka.Xb(Ld,(ld[Ea.a.skipClipboardAccess]=!0,ld[Ea.a.q0c]=
!0,ld[Ea.a.isFormatPainter]=!0,ld)).continueWith(function(){id.iqb()})}else id.gridView.rg.dH(!1)};this.Fb=Ke.EwaSettings.Fb();this.nlc=new Ob(this.$,Y);this.ZC=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Om=Ke.EwaSettings.Om();this.ju=ee.a.ju()}function Ob(k,H){this.$=k;this.Ug=H;this.XA=new Pe(Oe.g(this.$).Ea,this.$);this.xff=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.Kyb=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");
this.mpd=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.chc=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.udf=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.Vfi=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.shf=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",
!1);this.Nhc=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");this.Azb=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.dhc=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.kji=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.cgi=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix")}
function Ad(){this.scenario=0;this.OQ=null}function we(){this.PQa=this.BGa=this.BNa=this.mTa=0}function Wd(k,H,Y,za){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=k;this.targetSheetRange=H;this.fillRangeType=Y;this.fillRangeDirection=za}function qc(k,H,Y){var za=sk.call(this,k)||this;za.Hm=null;za.v6c=0;za.zbi=function(Va,Pb){if(0===Va)nc.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");
else{Va={};var Ac="",id=1035996630;switch(Pb.selectedKey){case 0:Ac=1896159024===za.Er?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:Ac=1896159024===za.Er?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===za.Er?(Ac="InsertRows",id=-1113896058):(Ac="DeleteRows",id=1554436520);break;case 3:1896159024===za.Er?(Ac="InsertColumns",id=1415868706):(Ac="DeleteColumns",id=674605324)}nc.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",
Ac);Pb=new vh.a(id,1,2,8,null);Va[Re.a.ld]=Ac;za.$.Ka.Xb(Pb,Va)}};za.Er=H;za.selectedRanges=Y;k=Object(Pa.a)(hb.a,za.$.xa.qa);za.isRtl=k.displayRtl;return za}function md(k,H,Y,za,Va,Pb){var Ac=this;this.m0d=!1;this.n0d=null;this.PDc=0;this.kj=null;this._state=0;this.moveNext=function(){try{for(Ac._state=1;1===Ac._state;)Ac.Qu=Ac.Qu()}catch(id){Ac.dispose(),Ac._state=3}};this.Cf=k;this.mCa=H;this.lCa=this.a0d=Va;this.xPb=Pb;this.Qu=this.ML;this.moveNext()}function bd(k,H,Y,za,Va,Pb,Ac,id){var Ld=this;
this.MDc=0;this.p0d=this.QDc=!1;this.kj=this.r0d=null;this._state=0;this.moveNext=function(){try{for(Ld._state=1;1===Ld._state;)Ld.Qu=Ld.Qu()}catch(ld){Ld.dispose(),Ld._state=3}};this.Cf=k;this.mCa=H;this.Lgg=Va;this.lCa=this.a0d=Pb;this.xPb=Ac;this.$_d=id;this.Qu=this.ML;this.moveNext()}function Xc(k,H,Y,za,Va){this.wUe=0;this.zog=k;this.Aog=H;this.Cwg=Y;this.WWb=za;this.wUe=void 0===Va?0:Va}function ne(k){var H=this;this.menuId=null;this.oub=0;this.cAi="+mn-lt";this.ixi="+mj-lt";this.lPi=function(Y){H.kff=
!0;H.PSg=null;H.$.RC(function(za){za.BPa("FontName_New")});nc.ULS.sendTraceTag(537159511,1,15,String.format("PreviewFont Status is {0}",Y))};this.VJi=function(Y,za,Va){nc.ULS.sendTraceTag(524042310,1,50,"FontDropdownHelper.onFontPreviewRequestComplete: Attempt to request FontUrl method: {0} has succeeded.",Va);H.a_i(Y);H.oub=2;H.VMf()};this.WJi=function(Y,za,Va){nc.ULS.sendTraceTag(524042309,1,10,"FontDropdownHelper.onFontPreviewRequestFailed: Encountered errors for {0}.",Va);H.oub=3;H.VMf()};this.$=
k;this.frame=this.$.frame;this.Kei=!!String.fromCodePoint&&!Oj.a.xf&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.kff=!1;this.PSg=null;this.Om=Ke.EwaSettings.Om();(this.ju=ee.a.ju())&&this.Nej()}function ed(k){this.kv=k}function nd(){}function Ub(k){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=k}function Hc(k){var H=hk.call(this)||this;H.$=k;H.Tb();return H}function pd(k){return Tj.call(this,k)||this}function jc(k,H){var Y=
this;this.J$b=this.OFd=null;this.Xwf=function(){Ke.EwaSettings.ma(666)||Y.Qtc();if(Y.J$b){var za=ck.a(ff.a.Ta.oe,Y.J$b);nc.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",za);Y.J$b=null}Y.zEf()};this.$=k;this.gridView=Oe.g(k);this.BF=H.Crb(this.$.domElement,500,null,null);this.QKa=this.PKa=-1}function vd(k){this.freezeOptions=null;this.freezeOptions=k}function ae(){}function $d(k){var H=Nj.call(this)||
this;H.ekj="formulaAssistance";H.$=k;H.Tb();return H}function Bc(){this.isFeedbackAllowed=!1;this.zoomLevel=0}function Hd(k){var H=hj.call(this)||this;H.$=k;H.Tb();return H}function xb(k){var H=this;this.XA=this.calcManager=this.Ll=this.rSa=null;this.XJi=function(Y,za){if(Y&&!Dh.a(Y)&&za){var Va=!!Y&&!!Y.RequestTelemetryData;Oe.g(H.$).Ji.ola(za.toString(),Y.StateId,Va?Y.RequestTelemetryData.EcsOperationDuration:0,Va?Y.RequestTelemetryData.EcsRequestDuration:0,Va?Y.RequestTelemetryData.WfeRequestDuration:
0)}};this.$=k;this.$.da.$a(268,function(Y){H.Ll=Y});this.uDh=new Ff(Oe.g(this.$).Ea,this.$);this.c3=new de(this.$,Oe.g(this.$),this);this.$.da.$a(266,function(Y){H.calcManager=Y});this.Fb=Ke.EwaSettings.Fb();this.Om=Ke.EwaSettings.Om();this.vAb=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Mrd=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.qK=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6247869_getNumberFormatRefactor");
this.s7a=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);this.yoi=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}function rd(k,H){this.success=k;this.xz=H}function tf(){this.Ueg=this.cWj=!1;this.source=0;this.lwa=this.Khc=!1}function Kf(k,H,Y,za,Va){Y=void 0===Y?null:Y;za=void 0===za?null:za;Va=void 0===Va?null:Va;nc.ULS.shipAssertTag(537162128,0,!!(!!(null!=Y^!(void 0===za||null===za))^!(void 0===Va||null===Va))&&
!(null!=Y&&void 0!==za&&null!==za&&void 0!==Va&&null!==Va),"NumberFormatHolder: holder must contain either an ifmt or a format string!");null!=Y&&0>Y&&(nc.ULS.sendTraceTag(537162127,0,50,"NumberFormatHolder: ifmt is negative, setting it to null..."),Y=null);this.Ll=k;this.Eo=H;this.yog=Y;this.hya=za;this.Hqa=Va}function Ff(k,H){this.XA=null;this.Ea=k;this.B2a=H}function Pe(k,H){this.Ea=k;this.B2a=H}function Xe(k,H,Y){this.success=k;this.xOa=void 0===H?null:H;this.reason=void 0===Y?"":Y}function de(k,
H,Y){var za=this;this.ada=[];this.calcManager=this.ozc=this.lastSetCellInstantaneousOperation=null;this.$=k;this.grid=H;this.Ug=Y;this.Vca=de.AGe;this.$.da.$a(268,function(Va){za.ozc=Va});this.$.da.$a(266,function(Va){za.calcManager=Va});this.vAb=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Mrd=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.xoi=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}
function Kd(k,H,Y,za){this.rangeDelta=k;this.stateId=H;this.isFinished=Y;this.priorityGroup=za}function pe(k,H,Y,za,Va,Pb,Ac,id,Ld,ld,ef,Jf,Kg,Cg,Wg,wi,oj,fj,Wj,gk,gj,Dk,Cj,Zf,rh){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=
this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=
this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=void 0===k?0:k;this.numberOfNonUpdatedCells=void 0===H?0:H;this.numberOfUpdatedCells=void 0===Y?0:Y;this.numberOfCellsUpdatedAlreadyByServer=void 0===za?0:za;this.numberOfCellsSkippedDueToTimeout=void 0===Va?0:Va;this.numberOfCellsWithNoFormattedCell=void 0===Pb?0:Pb;this.numberOfUnsupportedErrorCellTypes=void 0===Ac?0:Ac;this.numberOfUnsupportedBlankCellTypes=void 0===id?0:id;this.numberOfUnsupportedRichCellTypes=void 0===Ld?0:Ld;this.numberOfSkippedCellsDueToMissingLocaleInfo=
void 0===ld?0:ld;this.totalExecutionTime=void 0===ef?0:ef;this.originalProcessingTimeLimit=void 0===Jf?0:Jf;this.newProcessingTimeLimit=void 0===Kg?0:Kg;this.numberOfEditedRecalcedCellsInBatch=void 0===Cg?0:Cg;this.numberOfDependentRecalcedCellsInBatch=void 0===Wg?0:Wg;this.isNewTask=void 0===wi?!1:wi;this.lastSetCellInstantaneousOperation=void 0===oj?"":oj;this.taskId=void 0===fj?0:fj;this.isNewNumberFormatter=void 0===Wj?null:Wj;this.numberOfRecalcedCellsWithFormattedValue=void 0===gk?null:gk;this.numberOfRecalcedCellsWithoutFormattedValue=
void 0===gj?null:gj;this.totalNumberFormatterTime=void 0===Dk?null:Dk;this.newNumberFormatterFinalizeFailures=void 0===Cj?null:Cj;this.numberOfMeasureTextWidthCalls=void 0===Zf?null:Zf;this.numberOfHashFormattedValues=void 0===rh?null:rh}function Lf(){}function Be(k,H,Y,za,Va){this.cQ=void 0===k?0:k;this.cellValue=void 0===H?"":H;this.ifmt=void 0===Y?0:Y;this.priorityGroup=void 0===za?"":za;this.xz=void 0===Va?"":Va}function eg(k){k=Jc(k);if(0===k)return 1;if(1===k)return 2;nc.ULS.sendTraceTag(537162182,
0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}function Jc(k){if(k.priorityGroup===Qe.editCell)return 0;if(k.priorityGroup===Qe.dependentCell)return 1;nc.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}function Yd(k,H){var Y=Jc(H),za=!(void 0===H.rangeDelta.data.format||null===H.rangeDelta.data.format);nc.ULS.shipAssertTag(537162187,0,0===Y||!za,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",
H.priorityGroup);k=Math.max(k.cell.Ak,0);za&&(za=excelOnlineCalc.calc.getCellFormatKind(H.rangeDelta.data.format.format),"number"===za?k=H.rangeDelta.data.format.format:"string"===za?nc.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===za?nc.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):nc.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));
return k}function Ge(k){var H=k.value;switch(k.type){case 2:return void 0===H||null===H?"":H;case 1:return k=parseFloat(H),isNaN(k)?null:k;case 3:return k=parseFloat(H),isNaN(k)?null:1===k;case 4:return k=parseFloat(H),isNaN(k)?null:excelOnlineCalc.calc.errorValue(k);default:return excelOnlineCalc.calc.blankValue}}function ud(k){k=excelOnlineCalc.calc.getCellValueKind(k.rangeDelta.data.value);var H=0;switch(k){case "number":H=1;break;case "string":H=2;break;case "boolean":H=3;break;case "Error":H=
4;break;case "Blank":H=0;break;default:nc.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",k)}return H}function Ye(k,H){k=excelOnlineCalc.calc.getCellValueKind(k.rangeDelta.data.value);switch(k){case "number":case "string":case "boolean":return!0;case "Blank":if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;H.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",
!1))return!0;H.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return H.numberOfUnsupportedRichCellTypes++,!1;default:return nc.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",k),!1}}function mf(k){if(k=k.color){if("String"===Object.getType(k).getName())return Le.a.fp(k);if("Number"===Object.getType(k).getName())return null}else return null;nc.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");
return null}function xe(k){switch(k.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return nc.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}function Qe(){}function jg(k,H,Y,za,Va,Pb,Ac,id,Ld,ld,ef,Jf,Kg){Jf=void 0===Jf?null:Jf;Kg=void 0===Kg?null:Kg;id=mc.call(this,11,0,id,ef)||this;id.tDh=k;id.Ibd=H;id.format=za;id.activeCell=Y;id.ere=Va;id.sGf=Pb;id.nGf=Ac;id.gFa=Ld;id.clientCorrelationId=
ld;id.$lb=Jf;id.tib=Kg;return id}function je(){}function pf(k){var H=Mj.call(this)||this;H.BSb=null;H.$=k;H.Tb();return H}function qg(k){var H=Yk.call(this)||this;H.dIf=0;H.nH=null;H.zZg=function(Y,za){if(1===Y&&H.nH.FileCollectionErrorStateId){Y=H.$.na.ua;var Va=H.nH.MessageId,Pb=H.nH.OriginalEcsServerId,Ac=H.nH.FileCollectionErrorStateId,id=Y.Na(0);id.errorMessageId=Va;id.ecsServerId=Pb;id.fileCollectionErrorStateId=Ac;id.userComment=za;Y.JZc("CollectFile",id,null,null,null,null,0)}H.raiseEvent("fileCollectionComplete",
null,H)};H.$=k;return H}function Gf(k){var H=yk.call(this,!1,!1,Gf.Fu)||this;H.rvd=!1;H.cof=!0;H.mnf=0;H.jc=1;H.Dc(1,CommonUIStrings.l_Send);H.Dc(0,CommonUIStrings.l_NoThanks);H.gg=Mg.oig;H.enf=k;H.Pe=Gf.qSg;return H}function Mg(){}function dg(k){return Fk.call(this,k)||this}function lc(){}function Nc(k,H,Y,za){var Va=Qh.call(this,k)||this;Va.aDb=null;Va.qlc=null;Va.ffc=null;Va.t3=null;Va.ska=!1;Va.disposed=!1;Va.dNa=!1;Va.kh=null;Va.Yzd=function(Pb){nc.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(Va.disposed)nc.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(Dh.a(Pb)){nc.ULS.sendTraceTag(537163267,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",Pb?he.a.Wc(Pb.Errors):null);if(Pb.Errors&&1===Pb.Errors.length){var Ac=Pb.Errors[0].MessageId,id=Va.Odd(Ac);if(id){Va.Kxj(Ac)?Va.Xsj(id):Va.Bs(id);Va.ela("OkInvalidByServer",
Pb.Errors[0].MessageIdName);return}}nc.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",he.a.Wc(Pb.Errors))}Va.ela("OkValid","None");Va.hide()}};Va.p5c=function(Pb){Va.cX(Pb);2!==Pb&&(Va.kh=Va.$.Ob.Gc("UserAction","DataValidationEditTimeToDialogTryClose"));1===Pb?Va.X9a():2===Pb?Va.oya():Va.Pla()};Va.wca=function(){Va.SPj();Va.dNa?Va.Mye():Va.r0c();return Va.ska=!1};Va.selectedRanges=H;Va.aSb=Y;Va.command=
za;3===za&&(Va.ska=!0);Va.jc=2;Va.$v=!1;Va.gg=fb.gg;return Va}function Nd(k,H){this.options=this.cellRange=null;this.cellRange=k;this.options=H}function le(k,H){var Y=Ei.call(this,k)||this;Y.R9=null;Y.mha=null;Y.iUa=null;Y.T9=null;Y.S9=null;Y.wnc=function(){Y.R9.checked?(Y.mha.disabled=!1,Y.iUa.disabled=!1,Y.T9.disabled=!1,Y.S9.disabled=!1):(Y.mha.disabled=!0,Y.iUa.disabled=!0,Y.T9.disabled=!0,Y.S9.disabled=!0);return!1};Y.get_visible=Y.Kja;Y.set_visible=Y.Ena;Y.Bk=H;Y.eka();return Y}function ke(k,
H){var Y=Pf.call(this,k)||this;Y.lba=null;Y.J$e=null;Y.nba=null;Y.mba=null;Y.xnc=function(){Y.lba.checked?(Y.nba.disabled=!1,Y.mba.disabled=!1):(Y.nba.disabled=!0,Y.mba.disabled=!0);return!1};Y.get_visible=Y.Kja;Y.set_visible=Y.Ena;Y.Bk=H;Y.eka();return Y}function xd(){}function fc(k,H,Y,za){var Va=vj.call(this,k)||this;Va.Vtb=null;Va.dNd=null;Va.ska=!1;Va.disposed=!1;Va.dNa=!1;Va.kh=null;Va.CUj=function(Pb,Ac){Va.Xac(Pb);var id=Va.HZd();Pb=id.errorString;var Ld=id.Eq;if(id.returnValue)return Va.ILa(121,
Va.sMh(Va.$,Ac),0,Va.s5,!1),"";Va.ela("OkInvalidByClient",Ld);return Pb};Va.p5c=function(Pb){Va.cX(Pb);Va.kh=Va.$.Ob.Gc("UserAction","DataValidationEditTimeToDialogTryClose");0===Pb&&Va.Pla()};Va.selectedRanges=H;Va.aSb=Y;Va.command=za;3===za&&(Va.ska=!0);Va.jc=2;Va.$v=!1;return Va}function fe(k,H,Y,za,Va,Pb,Ac,id){id=k.Na(9,void 0===id?null:id);id.selectedRanges=H;id.ruleOptions=Y;return Jg.i(k,"CreateOrEditDataValidation",id,za,Va,Pb,Ac,0)}function oa(k,H,Y){var za=Rh.call(this,H)||this;za.ewa=
null;za.Iec=null;za.lU=null;za.RK=null;za.Qya=null;za.Rya=null;za.B5a=null;za.HNa=null;za.q$a=null;za.hPa=null;za.bpc=null;za.BCd=null;za.JBh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];za.Mkj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];za.vnc=function(Va){var Pb=!1;(null===Va||void 0===Va?0:Va.Ca)&&(Va.Ca.keyCode===Ni.a.Moa||Va.Ca.keyCode===Ni.a.di)&&(Pb=za.wca(Va),za.lU.blur(),
za.RK.blur());return Pb};za.wca=function(){var Va=za.lU.selectedIndex,Pb=za.RK.selectedIndex;za.bpc.innerText=za.rvb(Va,Pb);za.BCd.innerText=za.Agd(Va,Pb);switch(Va){case 0:return za.RK.disabled=!0,Kc.DOMElementExtensions.setVisible(za.q$a,!1),Kc.DOMElementExtensions.setVisible(za.hPa,!1),Kc.DOMElementExtensions.setVisible(za.B5a,!1),Kc.DOMElementExtensions.setVisible(za.HNa,!1),za.ewa.disabled=!0,!1;case 3:return za.RK.disabled=!0,Kc.DOMElementExtensions.setVisible(za.q$a,!0),Kc.DOMElementExtensions.setVisible(za.hPa,
!1),Kc.DOMElementExtensions.setVisible(za.B5a,!0),Kc.DOMElementExtensions.setVisible(za.HNa,!0),za.ewa.disabled=!1;case 7:return za.RK.disabled=!0,Kc.DOMElementExtensions.setVisible(za.q$a,!0),Kc.DOMElementExtensions.setVisible(za.hPa,!1),Kc.DOMElementExtensions.setVisible(za.B5a,!1),Kc.DOMElementExtensions.setVisible(za.HNa,!1),za.ewa.disabled=!1;default:za.ewa.disabled=!1,Kc.DOMElementExtensions.setVisible(za.q$a,!0),Kc.DOMElementExtensions.setVisible(za.HNa,!1)}switch(Pb){case 0:case 1:Kc.DOMElementExtensions.setVisible(za.hPa,
!0);break;default:Kc.DOMElementExtensions.setVisible(za.hPa,!1)}za.RK.disabled=!1;za.bpc.disabled=!1;Kc.DOMElementExtensions.setVisible(za.B5a,!1);Kc.DOMElementExtensions.setVisible(za.HNa,!1);return!1};za.get_visible=za.Kja;za.set_visible=za.Ena;za.yR=new rb.a;za.yR.add(Ae.a.instance.fa(1640));za.yR.add(Ae.a.instance.fa(1641));za.yR.add(Ae.a.instance.fa(1644));za.yR.add(Ae.a.instance.fa(1642));za.yR.add(Ae.a.instance.fa(1643));za.yR.add(Ae.a.instance.fa(1645));za.yR.add(Ae.a.instance.fa(1646));za.yR.add(Ae.a.instance.fa(1647));
za.yR.add(Ae.a.instance.fa(1648));za.yR.add(Ae.a.instance.fa(1649));za.yR.add(Ae.a.instance.fa(1650));za.yR.add(Ae.a.instance.fa(1651));za.yR.add("");za.$=k;za.Bk=Y;za.eka();return za}function fb(){}function Rb(k,H){var Y=this;this.SB=this.b1a=this.selectedRanges=null;this.GJe=!1;this.kh=null;this.uKi=function(za){nc.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!za||Dh.a(za)?nc.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):
(Y.b1a=za.Result,Y.s_i())};this.Cxh=function(za){Y.cX("DataValidationEdit.ExpandExisitngDialog",za);Y.SB.c=Rb.kia(za);1===za?Y.HHa(new dc(Y.b1a)):2===za?Y.HHa(new dc):Y.wmf()};this.rVi=function(za){Y.cX("DataValidationEdit.OverrideExisitngDialog",za);Y.SB.c=Rb.kia(za);1===za?Y.HHa(new dc):Y.wmf()};this.$=k;this.q5c=H}function dc(k){this.o5=(k=void 0===k?null:k)?k.IsIgnoreBlank:!0;this.p5=k?k.IsInCellDropDown:!0;this.ZN=k?k.LowerBoundary:"";this.$N=k?k.UpperBoundary:"";this.KB=k?k.ConditionType:0;
this.ruleType=k?k.RuleType:0;this.f_=k?k.IsAlertBlocking:!0;this.kU=k?k.AlertTitle:"";this.jU=k?k.AlertMessage:"";this.TV=k?k.InputMessage:"";this.nF=k?k.InputTitle:"";this.D5=k?k.IsShowErrorAlert:!0;this.E5=k?k.IsShowInputMessage:!0}function uc(k){switch(k){case 0:k="AnyValue";break;case 1:k="WholeNumber";break;case 2:k="Decimal";break;case 3:k="List";break;case 4:k="Date";break;case 5:k="Time";break;case 6:k="TextLength";break;case 7:k="Custom";break;default:k="Unknown"}return k}function Bd(k){switch(k){case 0:k=
"Between";break;case 1:k="NotBetween";break;case 2:k="Equal";break;case 3:k="NotEqual";break;case 4:k="GreaterThan";break;case 5:k="LessThan";break;case 6:k="GreaterThanOrEqual";break;case 7:k="LessThanOrEqual";break;default:k="Unknown"}return k}function Od(k){var H=vk.call(this)||this;H.$=k;H.Tb();return H}function Td(k,H,Y){var za=this;this.oyc={};this.Od=!1;this.xl=function(Va,Pb){za.showContextMenu(void 0===Pb?null:Pb)};this.rvf=function(Va,Pb){Pb.tzi===Td.V0h&&Oe.g(za.$).focus()};this.JN=function(Va,
Pb){Va=za.$.Ka.Maa(Pb.Rd.command);(null===Va||void 0===Va?0:Va.dismissesContextualUI)&&za.O3()};this.o6=function(){za.$.da.ZU(342);Uf.TaskExtensions.Ba(rf.GetServiceTaskFactory.create(za.$.da,338,za.$.la,3),function(Va){Va=Va.result;for(var Pb=El(za.oyc),Ac=Pb.next();!Ac.done;Ac=Pb.next())Ac.value.tNf(Va)},za.$.la)};this.$=k;this.contextMenuController=Y;this.w6d=new Ze(this.$);k.da.Ga(8,this);for(Y=0;Y<H.length;Y++)this.oyc[Td.c2g[Y]]=H[Y];this.ha=Oe.g(k).ha;this.ha.oZb(this.xl);this.$.Ka.KFa(this.rvf);
Ag.a.instance.lsj();Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.Ora(this.JN);Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.N2(this.o6)}function Ze(k){this.ISe=null;this.$=k;this.M8a=new Wf;Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.ISe=new vf(this.$))}function vf(k){var H=
this;this.HZa=null;this.hRd=!1;this.yBb=0;this.$8c=1;this.oMe=0;this.tEb=function(Y){H.TJf(Y.domElement,Y.hashCode)};this.INf=function(Y){for(var za=0;window.performance.now()-Y<H.Ulh&&0<H.HZa.length;)H.Vle(H.HZa.shift()),za++;nc.ULS.sendTraceTag(537167052,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",H.$8c,za,H.HZa.length);0<H.HZa.length?H.yBb=window.requestAnimationFrame(H.INf):(nc.ULS.sendTraceTag(537167051,
1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",H.$8c,window.performance.now()-H.oMe),H.$8c++,H.yBb=0)};this.onPointerDown=function(Y){af.a.slim(Y.Ca.rawEvent);return!1};this.$=k;this.gridView=Oe.g(this.$);this.X8h();this.Ulh=this.$.ya.AutoFilterEventRegistrationTimeLimit}function wf(){this.ae=this.Ose=this.cell=null}function Wf(){this.Ldc={}}function ug(){this.menuModel=null;this.dFe=0}function Gg(){this.dictionary=this.Rd=null}function Cf(k){var H=
qj.call(this)||this;H.Y9e=!1;H.Hld=function(){var Y;(Y=H.$.da.Aa(342))?H.Eb(Y):H.$.RC(function(za){za.Rec().then(function(Va){(Y=H.$.da.Aa(342))?H.Eb(Y):(Y=new rg(H.$,Va),H.Eb(H.$.da.Ga(342,Y)))})})};H.$=k;H.Tb();return H}function rg(k,H){this.Vqb=H;this.$=k}function dh(k){return ng.call(this,k)||this}function fh(k,H,Y,za){k=Zd.call(this,k,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,fh.JIj,!0,!1,fh.bJb,H,Y,!1,za)||this;k.S0a=0;k.Hsa=null;k.oKa=null;k.ZJe=null;return k}function vg(k,H,Y){this.type=
k;this.Y1g=H;this.Er=Y}function Me(k,H,Y,za){return Wc.call(this,k,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",H,Y,!0,za)||this}function Of(k,H,Y,za){k=sc.call(this,k,"PopulateSheetOpsContextMenu",274207288,-1497523576,Eb,!0,!1,"SheetTabContextMenuRootName",H,Y,!1,za)||this;k.Mgc=!1;k.lic=!1;return k}function ac(k,H,Y,za){H=ra.call(this,k,"PopulateRichTextContextMenu",679816325,1151222423,T,!0,!1,T,H,Y,!0,za)||this;H.grid=Oe.g(k);return H}
function Lc(k,H,Y,za){H=Qi.call(this,k,"PopulateTableFieldListContextMenu",-751848458,-1085236154,Tf,!0,!1,"TableFieldListContextMenuRoot",H,Y,!1,za)||this;H.q5b=null;H.Kyd=0;H.yVb=null;H.grid=Oe.g(k);return H}function wd(){}function Mc(k,H,Y,za){var Va=Kh.call(this,k,"PopulatePivotTableContextMenu",-1475408662,1114549926,fg,!0,!1,"PivotTableContextMenuRootName",H,Y,!0,za)||this;Va.Fc=null;Va.activeCell=null;Va.z_d=null;Va.xic=!1;Va.wod=!1;Va.expandCollapse=!1;Va.refresh=!1;Va.zZ=!1;Va.$f=null;Va.hA=
null;Va.w0a=null;Va.Db=null;Va.aab=null;Va.Cba=!1;Va.mLi=function(Pb){Pb&&!he.a.oh(Pb.Errors)&&Va.Fc&&(Va.Fc.Uo=Pb.Result,Va.pKb());Va.showPivotTableContextMenu()};Va.lLi=function(){};Va.YOi=function(){Va.Kbb()};Va.XOi=function(){Va.Kbb()};Va.RFi=function(){Va.Kbb()};Va.QFi=function(){Va.Kbb()};Va.qu=function(){Va.UXd();Va.Cba=!1};Va.Tq=function(){if(Va.Cba){nc.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
var Pb=Va.Fc;Va.grid.Rb.jp(Va.grid.ha.sa.activeCell)!==Pb&&(Va.Kbb(),Va.d6h())}};Va.fhh=new DOMParser;Va.tvj=!0;Va.grid=Oe.g(k);Va.glc=!0;return Va}function ge(k,H,Y,za){return pg.call(this,k,"PopulatePivotContextMenu",2123758504,912277356,H,Y,za)||this}function nf(k,H,Y,za){k=dd.call(this,k,"PopulateFieldWellContextMenu",1374696078,495005930,gc,!0,!1,gc,H,Y,!1,za)||this;k.cell=null;k.xo=null;k.Jo=null;k.externalSourceIndex=-1;k.T_d=-1;k.ASa=0;k.Byc=-1;k.JL=null;k.isOlap=!1;k.$H=!1;k.D2a=!1;return k}
function Ee(k,H,Y,za,Va,Pb,Ac,id,Ld){var ld=Bb.call(this,Va,Ae.a.instance.Ab(61),!0,2,!0)||this;ld.s2f=!0;ld.dje=null;ld.nSa=null;ld.Ofa=null;ld.Urb=null;ld.l5c=null;ld.SRc=null;ld.LFi=function(ef){Uh.a.any(ef.Errors,function(Jf){return-103190598===Jf.MessageId})&&ld.SSa.Egj()};ld.ULi=function(ef){ef&&!Dh.a(ef)&&(ef=ef.Result,ld.l5c.innerHTML=Ae.a.instance.fa(1067)+Lg.a.Sf(ef.ValueFieldSourceName),ld.isOlap&&!ld.$H?(ld.SSa.enabled=!1,ld.Ofa.activeTab=ld.Ofa.yzc-1):(ld.SSa.enabled=!0,ld.Ofa.activeTab=
0),ld.SSa.erj(ef.PivotValueFieldSettingsSummarizeValueByInfo),ld.nSa.frj(ef.PivotValueFieldShowValueAsInitialInfo),ld.kf())};ld.cell=k;ld.Jo=H;ld.externalSourceIndex=Y;ld.Qeg=za;ld.Rd=Pb;ld.Yha=Ac;ld.isOlap=id;ld.$H=Ld;return ld}function ya(k,H,Y){Y=void 0===Y?null:Y;this.cmb=this.kmb=null;this.v1=-1;this.gk=k;this.qga=(void 0===H?null:H)||new rb.a;this.Pwg=Y||new Rc;this.YEa=new rb.a;k=0;H=El(this.qga);for(Y=H.next();!Y.done;Y=H.next()){Y=Y.value;this.Ard(this.v1)||(this.v1=k);var za=k++;this.YEa.add(new Cb(document.createElement("li"),
Y.title,this.R5g(za)))}}function Cb(k,H,Y){this.gk=k;this.Sp=H;this.yGc=Y;this.Dfa=document.createElement("a");V.a.fwc(this.Dfa,this.Sp);Sys.UI.DomElement.addCssClass(this.Dfa,cc.PGj);Sys.UI.DomElement.addCssClass(this.gk,cc.OGj);this.gk.appendChild(this.Dfa);this.Dfa.tabIndex=0;this.vBc();Pi.a.addHandler(this.gk,"click",this.yGc);Pi.a.addHandler(this.gk,"keyup",Object(nh.a)(this,this.e$a,"onTitleKeyUp"))}function cc(){}function Rc(){}function yd(k){k=Ai.call(this,k)||this;k.Cde=null;k.get_visible=
k.Kja;k.set_visible=k.Ena;k.eka();return k}function od(){}function ze(k,H,Y,za,Va,Pb,Ac,id){var Ld=oh.call(this,k)||this;Ld.BF=null;Ld.Q5b=null;Ld.E0b=null;Ld.i2d=null;Ld.j2d=null;Ld.C4d=null;Ld.yvf=function(){var ld=parseInt(Ld.J3.xe.value,10);Ld.eUg(ld)?(Ld.pU.Yn.disabled=!0,Ld.SP.Yn.disabled=!0,Ld.SP.clear(),ze.ibf(ld)?(Ld.pU.Yn.disabled=!1,Ld.$Nb(!0)):ze.jbf(ld)?(Ld.pU.Yn.disabled=!1,Ld.SP.Yn.disabled=!1,Ld.$Nb(!0),Ld.tkf()):Ld.$Nb(!1)):(ld=he.a.gd(1,0,0,1097,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),
Zi.a(Ld.$).Bs([ld]),Ld.J3.Igj())};Ld.WFi=function(){0>Ld.pU.selectedIndex||Ld.SP.Yn.disabled||(Ld.$Nb(!0),Ld.tkf())};Ld.VLi=function(ld){Ld.BF.KSa();Ld.SP.Yn.style.overflowY="scroll";if(ld&&!Dh.a(ld)){ld=ld.Result;Ld.SP.clear();for(var ef=El(ld.BaseItems),Jf=ef.next();!Jf.done;Jf=ef.next())Jf=Jf.value,Ld.SP.kM(Jf.DisplayString,Jf.Id.toString(),Jf.Id===ld.SelectedBaseItem);Ld.$Nb(!1)}};Ld.get_visible=Ld.Kja;Ld.set_visible=Ld.Ena;Ld.$=H;Ld.cell=Y;Ld.Jo=za;Ld.externalSourceIndex=Va;Ld.Rd=Pb;Ld.Yha=Ac;
Ld.Dji=id;Ld.ERj=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");Ld.eka();return Ld}function gf(){}function of(k,H,Y,za,Va){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=k;this.activeCell=H;this.pivotFieldTitle=Y;this.summarizeBy=za;this.showAsValueParameters=Va}function tg(k,H,Y){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=
k;this.baseFieldIndex=H;this.baseItemIndex=Y}function Fe(){}function hh(){}function Dg(k,H,Y,za){return pg.call(this,k,"PopulateFieldListPivotMenu",-1793121409,1378457149,H,Y,za,Hh)||this}function pg(k,H,Y,za,Va,Pb,Ac,id){id=void 0===id?$g:id;var Ld=ti.call(this,k,H,Y,za,id,!0,!1,"PivotFilterMenuRootName",Va,Pb,!1,Ac)||this;Ld.l5b=null;Ld.Nif=null;Ld.ymb=null;Ld.pivotData=null;Ld.Vyd=null;Ld.wmc=null;Ld.EDb=0;Ld.k2b=0;Ld.LY=0;Ld.Hrb=null;Ld.aLi=function(ld,ef){if(ef)if(Dh.a(ld))Ld.Uvd(ef,!1);else if(ld=
ld.Result){Ld.rsb=jd.qfd(ef,Ld.$,Ld.pivotData.cell,Ld.LY);var Jf=Ld.tpf(ld.MenuModel.Sections);Ld.Hrb=Jf;pg.wN.set(Ld.pivotData.cell,ef,Jf,Ld.LY);cg.a(Ld.$).fFj(ld);Ld.Uvd(ef,!0)}};Ld.$Ki=function(ld,ef){Ld.Uvd(ef,!1)};Ld.zf=function(ld,ef){pg.wN.y7b(ef.nd.hash)};Ld.Sm=function(ld,ef){pg.wN.y7b(ef.nd.hash)};Ld.$ca=null;Ld.Wyd=Ld.EDb=-1;Ld.uxe=Ld.k2b=-1;Ld.wpe=Ld.LY=0;Ld.oy=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");pg.wN||(pg.wN=new jd(Ld.$),Oe.g(Ld.$).Ea.Us(Ld.zf),Oe.g(Ld.$).Ea.PG(Ld.Sm),
Oe.g(Ld.$).Ea.Nga(Ld.zf));return Ld}function Fc(){this.cell=null;this.dataSourceIndex=0;this.Jo=this.pivotName=null}function jd(k){this.$=k;this.wN={}}function td(k,H,Y,za){k=te.call(this,k,"PopulateFieldListContextMenu",-1045020714,-170383950,Fd,!0,!1,Fd,H,Y,!1,za)||this;k.xo=null;k.JL=null;k.h_=!1;k.$H=!1;k.isOlap=!1;k.BUd=!1;return k}function ue(k,H,Y,za){k=He.call(this,k,H,Y,za,"PopulateChartContextMenu",-498523270,1640762262,Vc)||this;k.LAa=!1;k.Uva=!1;k.zZ=!1;k.refresh=!1;k.isPivotChart=!1;
return k}function He(k,H,Y,za,Va,Pb,Ac,id,Ld,ld){id=void 0===id?Ea.a.W1g:id;k=Te.call(this,k,void 0===Va?"PopulateFloatingObjectContextMenu":Va,void 0===Pb?-2017893763:Pb,void 0===Ac?1350204367:Ac,id,void 0===Ld?!0:Ld,void 0===ld?!1:ld,id,H,Y,!0,za)||this;k.floatingObject=null;k.yb=0;k.glc=!0;return k}function bf(k,H,Y,za){k=Ua.call(this,k,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,bf.Tyh,!0,!1,bf.bJb,H,Y,!1,za)||this;k.km=null;return k}function Rf(){}function ig(){}function Vf(k,
H){k=Qf.call(this,k,2,0,null)||this;k.Nse=H;return k}function Qf(k,H,Y,za){this.jsg=k;this.Jmg=H;this.Nmg=Y;this.Iwg=za}function df(){}function hg(k,H,Y,za){var Va=O.call(this,k,"PopulateAutoFilterContextMenu",1675506831,1651433993,Ef,!0,!1,"AutoFilterContextMenuRoot",H,Y,!1,za)||this;Va.Hrb=null;Va.sheetName=null;Va.nTa=null;Va.LWc=null;Va.Pkf=!1;Va.G2a=!1;Va.jEd=null;Va.hMb=null;Va.k$c=null;Va.Xbc=null;Va.sPa=null;Va.uFe=null;Va.G$a=null;Va.I4c=null;Va.HN=function(){Va.zyc();Va.$.ea.Wn(Va.HN)};
Va.JKi=function(Pb){function Ac(Cg,Wg,wi){Va.I4c=Jg.t(Va.$.na.ua,ld,Rg.b(Cg,ef),Va.G2a?Rg.a(Wg,Jf):Wg,wi,null,Kg);return Va.I4c}Va.G2a||ph.b(Va.$).Vd(yf.a.kxf,Va.lm(),void 0,!0);var id={};Va.$.Bj(id);var Ld=Va.$.ea.isNamedObjectViewMode,ld=Xd.a.mi(Va.LWc);ld.SheetName=Ld?id.NamedObjectName:id.SheetName;ld.NamedObjectView=Ld;id=!!Pb.searchText;Ld=586;Va.G2a&&(id&&(ld.ItemListOptions=Va.z4g(Pb.searchText),Ld=597),Pb={},ph.b(Va.$).Vd(yf.a.kxf,(Pb.UserOperation=Ld.toString(),Pb),void 0,!0));var ef=Va.AAd(id),
Jf=Va.KKi(),Kg=Va.$.na.ua.hc();Va.uFe=Kg.RequestId;Va.G2a&&Va.Xbc&&!Va.Xbc.dequeueUtcTime&&(Va.$.userOperationManager.oIa(Va.Xbc),Va.qUg());Pb=Ke.EwaSettings.qc()?new Ed.a(Ld,0,Ac,80):new zf.a(Ld,0,Ac,16);Va.Xbc=Va.$.userOperationManager.ic(Pb,null);Va.G$a=Va.I4c;Va.sPa=Va.uFe};Va.onMenuItemClick=function(Pb,Ac,id){ph.b(Va.$).Vd(yf.a.CPi,Va.lm(),void 0,!0);var Ld={};Ac=(Ld.CommandValueId=Ac,Ld.MenuItemId=Ac,Ld.InputMethod=id,Ld.TopCellAddress=Va.nTa,Ld);Ld=new vh.a(Pb,id,Va.$.isEditMode?2:1,19,null);
Va.$.Ka.Xb(Ld,Ac);nc.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",Pb,id)};Va.HFi=function(Pb){if(Pb.checkedItems&&Pb.checkedItems.length){ph.b(Va.$).Vd(yf.a.ztf,Va.lm(),void 0,!0);var Ac=Xd.a.mi(Va.LWc),id={};Va.$.Bj(id);id.FirstRow=0;id.FirstColumn=Ac.Column;var Ld=Va.$.ea.isNamedObjectViewMode;Ac.NamedObjectView=Ld;Ac.SheetName=Ld?id.NamedObjectName:id.SheetName;var ld=function(Kg){if(yg.a.uxc(Kg)){var Cg=yg.a.jac(Kg);Va.IMa?yg.a.xQa(na.a.applyItemFilter,Cg.MessageIdName,
sb.a.nsa,!0,yg.a.isSessionEndingError(Cg.MessageId)):nc.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",Cg.MessageIdName)}Dh.a(Kg)||(nc.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),ph.b(Va.$).Vd(yf.a.exf,Va.lm(),void 0,!0),Kg=Object(ag.a)(new Ib,{isSuccess:!0}),Va.hMb.onApplyFilterByValueFinish(Kg),Va.CL(Va.nTa))},ef=Va.m3c(Ac,id),Jf=new Ed.a(208,0,function(Kg,Cg,Wg){return Jg.a(Va.$.na.ua,
ef,Pb.checkedItems,Rg.b(Kg,ld),Cg,Wg,null,null)},6,function(){return new oe.a(Pb.checkedItems,ef)});Va.q3f(function(){Va.$.userOperationManager.ic(Jf,null)})}else nc.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};Va.oKg=function(Pb){var Ac=ve.o(Va.nTa,Va.$),id=ve.v(Va.nTa,Va.$),Ld=Object(ag.a)(new Th.a,{SortConditionType:Pb.type,RowColOffset:Ac.FirstColumn-id.FirstColumn,SortColor:Pb.color,SortIconSet:Pb.icon.IconSet,
SortIcon:Pb.icon.Icon,IsAscending:!0}),ld={SortOptions:Object(ag.a)(new We,{OperationType:1,ActiveCell:Ac,SelectedRange:id,SortConditions:[Ld],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),SelectedRange:id,OriginalActiveCell:Ac,ShouldRestoreSelection:!1};ld.ShouldPromptNamedSheetViewTeachingDialog=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures");nc.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",
Pb.type);Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?(Pb={},Va.$.Xd(-1089513346,Re.a.Ub,19,(Pb.CustomSortCommandData=ld,Pb))):Va.q3f(function(){var ef={};Va.$.Xd(1659552324,Re.a.Ub,19,(ef.CustomSortCommandData=ld,ef))})};Va.IMa=yg.a.dnd();Va.oy=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return Va}function re(){this.top=this.left=0}function se(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=
null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function wg(){this.autoFilterMenu=this.targetPoint=null}function Mf(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}function zh(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}function Da(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}
function Ib(){this.isSuccess=!1}function Ic(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function Gd(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function Sd(){this.Sections=this.Id=null}function We(){this.ActiveCell=this.SelectedRange=null;this.SortTopToBottom=this.IsCaseSensitive=this.GuessHeader=this.HasHeader=this.IsAscending=!1;this.SortInfoMode=this.OperationType=
0;this.ExpandSortSelection=this.SortConditions=null;this.ExpandSortSelectionSupported=!1}function Ne(){}function Se(k,H,Y,za){var Va=this;this.F2d=this.z1=this.Wi=this.YD=this.A8=null;this.UWb=k;this.Nvg=za;this.UWb.ULa&&(this.Wi=new Hi.a(3,2,5E3,Object(nh.a)(this,this.qMg,"authenticationCheckTask"),2),Vg.AFrameworkApplication.Qi.Sg(this.Wi),this.Qg(H,Y));this.UWb.mnb(function(){Va.Htf()});this.UWb.EYa(function(){Va.Itf()})}function Ka(){}function bb(k){return $h.call(this,k)||this}function Yb(k,
H,Y){var za=oi.call(this)||this;za.ZGi=function(Va,Pb){if(!Dh.a(Va)&&Pb){var Ac=!!Va&&!!Va.RequestTelemetryData;Oe.g(za.$).Ji.ola(Pb.toString(),Va.StateId,Ac?Va.RequestTelemetryData.EcsOperationDuration:0,Ac?Va.RequestTelemetryData.EcsRequestDuration:0,Ac?Va.RequestTelemetryData.WfeRequestDuration:0)}};za.$=k;za.tableManager=H;za.Ug=Y;return za}function Ec(k,H){this.command=0;this.selectedRanges=null;this.command=k;this.selectedRanges=H}function ad(k){return uh.call(this,k)||this}function Rd(k){var H=
Xi.call(this)||this;H.Ltf=function(Y){var za=Oe.g(H.$);if(Y=Y.Result){var Va=ve.D(Y.NewSelection),Pb=ve.D(Y.NewActiveCell);if(Va&&Pb)if(!Y.Committed&&Y.AutoSumFormula){var Ac=za.kc(Pb);Ac&&(za.ha.updateSelection(Va,Pb,60),Va=Pb=ve.D(Y.MarkedArea),za.SJ=2,Ue(za.wc,Ac,Y.AutoSumFormula,!!Va,Y.FormulaMarkStart,Y.FormulaMarkEnd),Va&&Pb&&za.ha.updateSelection(Va,Pb,0),za.wc.Zpd=!1,Uf.TaskExtensions.Ba(rf.GetServiceTaskFactory.create(H.$.da,153,H.la,0),function(id){id.result.a2a(null)},H.la,3))}else za.ha.updateSelection(Va,
Pb,60)}};H.$=k;return H}function ce(k,H){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=k;this.type=H}function Ue(k,H,Y,za,Va,Pb){if(H){var Ac=k.textBox;k.isEditing||k.startEdit(H,!0);k.Zpd=!0;k.text=Y;Ac.caretPosition=Va;Va<Pb&&(za&&k.VAa(),Ac.selectRange(0,Pb+1),Ac.selectRange(Va,Pb))}}function jf(k,H,Y,za,Va,Pb,Ac,id,Ld,ld){ld=k.Na(9,ld);ld.selectedRange=H;ld.activeCell=Y;ld.autoSumType=za;ld.topLeftCell=Va;return Jg.i(k,"AutoSum",ld,Pb,Ac,id,Ld,0)}function Hf(k,H,Y,za,Va,Pb){if(0===
za)return Object(Nf.a)(Bh.UnsupportedZeroResize);if(0>za||0===Y.length)return Object(Nf.a)(Bh.InvalidInput);if(k.c5h())return Object(Nf.a)(Bh.UnsupportedSkeletonInView);var Ac=k.Qf;if(!Ac)return Object(Nf.a)(Bh.NullSPD);var id=Ac.FZe(Y);if(id&&0<id.length)return Object(Nf.a)(id.length.toString()+" "+Bh.UnsupportedHiddenInRange);a:{id=El(Y);for(var Ld=id.next();!Ld.done;Ld=id.next())Ld=Ld.value,Va?Ld.right=Qc.a.Qh:Ld.bottom=Qc.a.Hh;id=k.Q$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",Y);try{for(id.$$rst();id.$$mn();)if(id.to.UCj){var ld=
!0;break a}}finally{id&&id.dispose()}ld=!1}if(ld)return Object(Nf.a)(Bh.UnsupportedMergeCell);if(Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Va&&"undefined"!==typeof gridRenderer)for(ld=El(Y),id=ld.next();!id.done;id=ld.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(id.value.left);k=k.Ea;ld=ji.a.create().toString();Ac.ldg(Y,za,Va);Pb=k.BPj(Va,Pb);H.r6i(Y,Va);k.A2i(Pb,ld,Va?"row":"column");return Object(Nf.d)(za)}b.r(C);var bg=b(557),
Dd=b(0),oc=b(906),nc=b(14),cf=b(206),Jg=b(84),Re=b(79);ce.prototype.q4a=function(){return this.sharedSheetRange};Object(Dd.a)(ce,"MacroRecorderAutoSumPayload",null,[445]);var ve=b(46),zf=b(562),zg=b(387),Ed=b(175),rf=b(51),Uf=b(36),lg=b(158),ni=b(357),he=b(30),Ke=b(1),Qg=b(186),Rg=b(291),Oe=b(22),Df=b(169),Zg=b(628),qh=b(55),Xi=cf.a;Am(Rd,Xi);Rd.prototype.Zc=function(){return!1};Rd.prototype.executeCommand=function(k,H,Y){k=H.command;switch(k){case 1220954656:H=this.GIe(0,H);break;case -1537138325:H=
this.GIe(parseInt(Y[Re.a.ld].toString(),10),H);break;default:H=Qg.a(k)}return H};Rd.prototype.Lc=function(k,H){if(k=1===k)switch(H.command){case 1220954656:case -1537138325:break;default:k=!1}return k};Rd.prototype.jd=function(){return!1};Rd.prototype.GIe=function(k,H){function Y(){return new ce(Ac,k)}var za=this,Va=Oe.g(this.$);Va.rg.dH(!1);if(!Oe.g(this.$).ha.sa.Ig)return nc.ULS.sendTraceTag(537170308,0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",
k,Oe.g(this.$).ha.sa.JK),this.gza(),qh.Task.Sa(!1);var Pb=Va.fK();if(!Pb)return null;var Ac=ve.v(Va.ha.sa.qd,this.$),id=ve.o(Va.ha.sa.activeCell,this.$),Ld=ve.o(Pb,this.$),ld=this.$.na.ua.hc();return this.$.Cq(Va.ha.sa.selectedRanges,!0)?Ke.EwaSettings.qc()?zg.a(this.$.userOperationManager,function(ef,Jf,Kg){return jf(za.$.na.ua,Ac,id,k,Ld,Rg.b(ef,za.Ltf),Jf,Kg,k,ld)},function(ef){return new Ed.a(502,0,ef,64,Y)},H):zg.a(this.$.userOperationManager,function(ef,Jf,Kg){return jf(za.$.na.ua,Ac,id,k,Ld,
Rg.b(ef,za.Ltf),Jf,Kg,k,ld)},function(ef){return new zf.a(502,0,ef,void 0,Y)},H):qh.Task.Sa(!1)};Rd.prototype.gza=function(){Zg.a(Df.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var k=he.a.gd(1,1,751,2142,0,371863010,"DiscontinuousSelectionBlocking");Ke.EwaSettings.Iz()?new ni.a(this.$,k):(k=new lg.ErrorDialog(this.$,k),k.initialize(),k.kf())};Object(Dd.a)(Rd,"AutoSumCommandHandler",cf.a,[429]);var uh=oc.a;Am(ad,uh);ad.prototype.Nd=function(){this.Cd([new Rd(this.$)])};ad.ka=function(k){oc.a.fe(96,
new ad(k))};Object(Dd.a)(ad,"AutoSumCommandHandlerFactory",oc.a,[]);var Sf=b(11),ji=b(176),Uh=b(275),sh=b(38),Jh=b(337);Ec.prototype.cu=function(){return this.command};Object(Dd.a)(Ec,"MacroRecorderRangeOperationAppliedPayload",null,[445]);var Dh=b(292),Og=b(70),oi=sh.a;Am(Yb,oi);Yb.prototype.NDg=function(k){this.addHandler("ekcvc",k)};Yb.prototype.S$i=function(k){this.removeHandler("ekcvc",k)};Yb.prototype.Zc=function(){return!1};Yb.prototype.executeCommand=function(k,H){k=H.command;switch(k){case -730106152:H=
this.hid(H,3);break;case -1228228458:H=this.hid(H,4);break;case -848953656:case 2045211913:if(this.tki()){H=qh.Task.Sa(!0);break}H=this.hid(H,1);break;default:H=Qg.a(k)}return H};Yb.prototype.Lc=function(k,H){if(k=1===k)switch(H.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:k=!1}return k};Yb.prototype.jd=function(){return!1};Yb.prototype.hid=function(k,H){function Y(){return new Ec(H,ld)}function za(Jf,Kg,Cg){Va.$.Ky();return Jg.f(Va.$.na.ua,H,ld,!1,Rg.b(Jf,
Va.ZGi),Kg,Cg,Ld,ef)}var Va=this,Pb=Oe.g(this.$),Ac=Pb.ha.sa.selectedRanges,id=k.command,Ld=ji.a.create().toString();if(!this.$.Cq(Ac,!0)&&-730106152!==id)return qh.Task.Sa(!0);var ld=ve.r(Ac,this.$);this.zzj(id,Pb,Ac,Ld);Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.D2i();var ef=this.$.na.ua.hc({lla:!0,kka:1});return Ke.EwaSettings.qc()?zg.a(this.$.userOperationManager,za,function(Jf){return new Ed.a(508,0,Jf,67,Y)},k):zg.a(this.$.userOperationManager,
za,function(Jf){return new zf.a(508,0,Jf,3,Y)},k)};Yb.prototype.zzj=function(k,H,Y,za){var Va=this;if(-848953656!==k&&2045211913!==k&&-730106152!==k&&-1228228458!==k)nc.ULS.sendTraceTag(537167938,0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",k);else if(!Uh.a.any(Y,function(Ac){return 0<H.getRangeInformation(Ac).length})){var Pb=Uh.a.any(Y,function(Ac){return Va.tableManager.grd(Ac)});if(-730106152!==k&&-1228228458!==k||!Pb)this.BDj(H,k,za,Y),-730106152!==k&&-1228228458!==
k||this.Ug.Tda(H,-730106152,{}),-1228228458!==k&&2045211913!==k&&-848953656!==k||this.Ug.eYg(Y,za),H.Ji.U0(za,Og.BasicTelemetryCalculator.iR)}};Yb.prototype.BDj=function(k,H,Y,za){var Va="";switch(H){case -1228228458:Va="ClearAll";break;case 2045211913:case -848953656:Va="ClearContent";break;case -730106152:Va="ClearFormat";break;default:nc.ULS.sendTraceTag(537167937,0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",H)}H=za.length;za=ve.b(za);k.Ji.K7(15,Y,Va+(", ranges to clear: "+
H+", cells to clear: "+za))};Yb.prototype.D2i=function(){this.raiseEvent("ekcvc",new Jh.a)};Yb.prototype.tki=function(){if(Oe.g(this.$).Ez){var k=this.$.da.Aa(296);return!!k&&k.cV.vB}return!1};Object(Dd.a)(Yb,"ClearCommandHandler",sh.a,[429,797]);var $h=oc.a;Am(bb,$h);bb.prototype.Nd=function(){var k=this,H=rf.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ub),Y=rf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub);Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([H,Y],this.la),function(){var za=
new Yb(k.$,H.result,Y.result);k.Cd([za]);k.$.da.Ga(313,za)},this.la,3)};bb.ka=function(k){oc.a.fe(101,new bb(k))};Object(Dd.a)(bb,"ClearCommandHandlerFactory",oc.a,[]);var Ch=b(632),Gh=b(625),Oi=b(623),Di=b(1201);Ka.prototype.F8g=function(k,H){if(k&&!(1>k.length)&&H){var Y=Object.assign(new Oi.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.e6g(k,Y.ControlList);H.push(Y)}};Ka.prototype.e6g=function(k,H){var Y=Object.assign(new Ch.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,
Menu:Object.assign(new Gh.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(H,Y);H=Object.assign(new Oi.a,{Title:"",ControlList:[]});Array.add(Y.Menu.MenuSectionList,H);this.l8g(k,H.ControlList)};Ka.prototype.l8g=function(k,H){for(var Y=0;Y<k.length;Y++){var za=Object.assign(new Di.a,{ExternalId:String.format("CoauthorPersona_{0}",Y),Command:"336231556",DisplayName:k[Y].userName,LabelText:k[Y].userName,ImageBackColor:k[Y].color,PersonaId:k[Y].email,
IsAnonymous:k[Y].isAnonymous});Array.add(H,za)}};Object(Dd.a)(Ka,"PresenceContextMenuSectionBuilder",null,[183]);var nh=b(82),Vg=b(4),li=b(180),wh=b(624),Hi=b(108),lh=b(133),kg=b(90),Fg=b(85),xi=b(107),Ng=b(27);Se.prototype.Qg=function(k,H){var Y=Vg.AFrameworkApplication.Ib;Y.Te(Ng.a.authenticationLost,xi.a.frame,k,96);Y.Te(Ng.a.Gse,xi.a.frame,H,96);Y.fc(Ng.a.ywe,xi.a.frame,li.ActionManager.V6c);Y.fc(Ng.a.zwe,xi.a.frame,li.ActionManager.V6c);Y.fc(Ng.a.Zsd,xi.a.frame,li.ActionManager.V6c)};Se.prototype.Htf=
function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);Vg.AFrameworkApplication.Ib.processAction(Ng.a.authenticationLost,2)};Se.prototype.Itf=function(){this.sHj();Vg.AFrameworkApplication.Ib.processAction(Ng.a.Gse,2)};Se.prototype.qMg=function(){this.UWb.authenticationCheck()};Se.prototype.sHj=function(){this.YD&&(this.YD.hide(),this.YD.dispose(),this.YD=null);this.A8&&this.businessBar&&(Vg.AFrameworkApplication.Pg||this.businessBar.removeEntry(this.A8),this.A8.dispose(),this.A8=
null)};Se.prototype.showDialog=function(k){kg.a.Ha(this.YD);this.YD=new lh.StandardDialog;this.Nvg||(this.YD.qv=!1,this.YD.jc=0);this.YD.Dc(1,CommonUIStrings.l_SignIn);this.YD.xX(CommonUIStrings.l_DefaultDialogTitle,k,Object(nh.a)(this,this.Aw,"dialogHandler"))};Se.prototype.Aw=function(k){1===k?(wh.a.J6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),Vg.AFrameworkApplication.Ib.processAction(Ng.a.Zsd,2)):(this.IRd(),Vg.AFrameworkApplication.Ib.processAction(Ng.a.zwe,
2))};Se.prototype.IRd=function(){this.businessBar&&this.Lue&&(this.A8=this.Lue.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.A8.closeable=!0,this.A8.addButton(CommonUIStrings.l_SignIn,Se.ORg,""),this.A8.B$=Object(nh.a)(this,this.RRg,"businessBarEntryCloseHandler"),this.businessBar.lE(this.A8,!1))};Se.prototype.RRg=function(){this.hfh();Vg.AFrameworkApplication.Ib.processAction(Ng.a.ywe,2)};Se.prototype.hfh=function(){this.Wi&&(Vg.AFrameworkApplication.Qi.$p(this.Wi),
this.Wi=null)};Se.prototype.dispose=function(){this.Wi=this.YD=this.A8=null};Se.ORg=function(){wh.a.J6();Vg.AFrameworkApplication.Ib.processAction(Ng.a.Zsd,2)};Ek.Object.defineProperties(Se.prototype,{businessBar:{configurable:!0,enumerable:!0,get:function(){return this.z1||(this.z1=Fg.a.instance.Kh("CommonUI.IBusinessBar"))}},Lue:{configurable:!0,enumerable:!0,get:function(){return this.F2d||(this.F2d=Fg.a.instance.Kh("CommonUI.IBusinessBarEntryFactory"))}}});Object(Dd.a)(Se,"SignOutResponseUI",
null,[3]);var Sh=b(255);Ne.prototype.ei=function(k){k.register(Ka,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Hc()};Ne.prototype.init=function(){};Ne.prototype.dispose=function(){kg.a.Ha(Ne.m2);Ne.m2=null};Ne.main=function(){Sh.a.instance.hj(new Ne)};Ek.Object.defineProperties(Ne.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});Ne.m2=null;Object(Dd.a)(Ne,"CommonAppUIPackage",null,[4,5]);var Gi=b(153),
ag=b(7),pi=b(161),Th=b(1252);Object(Dd.a)(We,"SharedSortOptions",null,[]);var xh=b(929),Ea=b(5),ua=b(496),Ab=b(626),Xd=b(56),oe=b(1114),yf=b(131),Pg=b(960),Af=b(150),ch=b(119),Xg=b(213),vh=b(95),ci=b(72),Ih=b(35),Ae=b(15),zi=b(61),ph=b(132),yg=b(981),na=b(982),sb=b(144),Wb=b(49),Dc=b(33),nb=b(443);Object(Dd.a)(Sd,"AutoFilterMenu",null,[]);Object(Dd.a)(Gd,"MenuItem",null,[]);Object(Dd.a)(Ic,"MenuSection",null,[]);Object(Dd.a)(Ib,"ApplyFilterByValueResponse",null,[]);Object(Dd.a)(Da,"FilterByValueItem",
null,[]);Object(Dd.a)(zh,"GetColorsAndIconsResponse",null,[]);Object(Dd.a)(Mf,"GetFilterByValueItemsResponse",null,[]);Object(Dd.a)(wg,"ShowSortFilterMenuParams",null,[]);Object(Dd.a)(se,"SortFilterControllerFactoryParams",null,[]);Object(Dd.a)(re,"TargetPoint",null,[]);var Yc=b(256),ee=b(37),ye=b(162),lf=b(220),Ef=Ea.a.Q1g,O=xh.a;Am(hg,O);hg.prototype.executeCommand=function(k,H,Y){var za=this;k=H.command;switch(k){case 1701016594:return xh.a.dxh(Y),qh.Task.Sa(!0);case 966232027:if(Ke.EwaSettings.em()){var Va=
new pi.a;Uf.TaskExtensions.Ba(rf.GetServiceTaskFactory.Va(this.$.da,8,9,0),function(Pb){za.U5e(H,Y,Pb.result);Va.setResult(!0)},this.la,3).CWCT(function(){Va.setResult(!1)},this.la,5,lf.a.instance);return Va.task}this.U5e(H,Y);return qh.Task.Sa(!0);default:return Qg.a(k)}};hg.prototype.U5e=function(k,H,Y){var za=this,Va=H.domEvent;if(ci.e(Va.rawEvent)&&(ci.g(Va),Va.target)){var Pb=new Af.a(this.$.xa);if(Pb.me(4096)||Pb.me(2048)){var Ac=Xd.a.mi(H[Re.a.Cg]);this.S1f(Ac)&&(this.Pkf?this.otc(Va,Va.target,
Ac,k,Y):(this.jEd=function(){za.S1f(Ac)&&(za.Kai(),za.otc(Va,Va.target,Ac,k,Y),za.G2a=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),za.Pkf=!0)},this.zyc()))}}};hg.prototype.Lc=function(k,H,Y){if(k=!!Y)switch(H.command){case 1701016594:case 966232027:Ke.EwaSettings.em()||ua.a(this.$)||(k=!1,nc.ULS.sendTraceTag(537167137,0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",Wb.b().ri(H.command)));break;default:k=
!1}return k};hg.prototype.WDd=function(k){Array.addRange(k.MenuSectionList,this.Hrb)};hg.prototype.Kai=function(){var k=this;nb.a(function(){k.hMb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(ag.a)(new se,{getFilterByValueItemsRequest:k.JKi,applyFilterByValueRequest:k.HFi,onMenuItemClick:k.onMenuItemClick,autoFilterMenuWidth:hg.Mse,applySortByColorOrIconRequest:k.oKg}))});this.k$c=Fg.a.instance.Kh("Common.IExternalUICommandDefinitionMapping")||new Ab.a(this.$.Mb,
this.$)};hg.prototype.otc=function(k,H,Y,za,Va){ph.b(this.$).Vd(yf.a.otc,this.lm(),void 0,!0);nc.ULS.shipAssertTag(537167135,0,!!Y,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");k=this.MIh(Y,Va);Va=Sys.UI.DomElement.getBounds(H);za=Va.x+Va.width;Va=Va.y;if(this.oy&&!Y.IsHeaderSnapped){if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!xh.a.Hnd(this.$,Y.Cell))return;Y=xh.a.Edd(this.$,Y.Cell,!0);za=Y.x;Va=Y.y}Y=Oe.g(this.$).rtl?new Sys.UI.Point(za-
Dc.a(this.$).ZFa(hg.Mse),Va):new Sys.UI.Point(za,Va);this.HTa(Y,H);Y=Dc.a(this.$).Aja(Y);H=Object(ag.a)(new wg,{targetPoint:Object(ag.a)(new re,{left:Y.x,top:Y.y}),autoFilterMenu:k});this.hMb.showSortFilterMenu(H);this.$.Xd(-544117314,-1,0,null)};hg.prototype.S1f=function(k){return Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")&&k.Cell.SheetName?Oe.g(this.$).t5?k.Cell.SheetName===this.$.qa.name:k.Cell.SheetName===this.$.qa.sheetName:!0};hg.prototype.MIh=
function(k,H){return(k=this.NIh(k,H))?this.NIf(k):null};hg.prototype.NIf=function(k){for(var H=[],Y=El(k.Sections),za=Y.next();!za.done;za=Y.next())za=za.value,Object(ye.e)(this.$)&&Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&za.Title===Ae.a.instance.fa(1912)||(za=this.x0i(za),H.push(za));return Object(ag.a)(new Sd,{Id:k.Id,Sections:H})};hg.prototype.x0i=function(k){for(var H=[],Y=El(k.MenuItems),za=Y.next();!za.done;za=Y.next())if(za=za.value,2===za.Identifier)this.LWc=
za.CommandData;else switch(za.Type){case 3:case 2:H.push(this.v0i(za,2===za.Type));break;case 1:H.push(this.w0i(za))}return Object(ag.a)(new Ic,{MenuItems:H,DisplayType:k.DisplayType,Id:this.kGh(k)})};hg.prototype.w0i=function(k){var H=this.RVe(k);var Y=H.label;var za=H.sLa;H=this.NIf(k.SubMenu);var Va=this.HVe(k);za=this.k$c.hbc(za);Y=Y||k.Label;return Object(ag.a)(new Gd,{Disabled:k.Disabled,Type:k.Type,Identifier:k.Identifier,Id:Va,CommandData:k.CommandData,Label:Y,SubMenu:H,IsChecked:k.IsChecked,
IconName:"MissingIcon_20"===za?null:za})};hg.prototype.v0i=function(k,H){var Y=this.V$b(k,H&&k.IsChecked);H=Y.label;var za=Y.sLa;Y=Y.Er;var Va=this.xcd(k,H);za=this.k$c.hbc(za);return Object(ag.a)(new Gd,{Disabled:k.Disabled,Type:k.Type,Identifier:k.Identifier,Id:Va,RibbonCommand:Y,CommandData:k.CommandData,Label:H||k.Label,SubMenu:null,IsChecked:k.IsChecked,IconName:"MissingIcon_20"===za?null:za})};hg.prototype.NIh=function(k,H){var Y;this.nTa=Y=ve.C(k.Cell);this.sheetName=this.$.qa.sheetName;H=
H||ua.a(this.$);if(k.IsHeaderSnapped)Y=H.I9b.YPh(Y);else{H=Oe.g(this.$).Ea.$3a(Y);if(!H)return this.IMa?yg.a.xQa(na.a.cLf,Df.a.d1h,sb.a.IZa,!0,!1):nc.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",Y,Oe.g(this.$).view.visibleArea),null;Y=H.autoFilterMenu}if(!Y)return this.IMa?yg.a.xQa(na.a.cLf,Df.a.pzi,sb.a.IZa,!0,!1):nc.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),
null;this.rsb=k.Cell.FirstRow+"_"+k.Cell.FirstColumn;return Y};hg.prototype.zyc=function(){var k=this;if(this.$.ea.sh){var H=rf.GetServiceTaskFactory.Va(this.$.da,283,284,1);Uf.TaskExtensions.Ba(H,function(){k.IMa?H.result.Jn.loadScript("sortFilter").then(function(){k.jEd()},function(Y){zi.a.Ek(Y,"AutoFilterContextMenu.SortFilterScriptLoad");yg.a.xQa(na.a.zyc,Df.a.CCj,sb.a.IZa,!1,!1)}):Uf.TaskExtensions.Ba(Yc.c(H.result.Jn.loadScript("sortFilter")),function(){k.jEd()},k.$.la,3)},this.$.la,3)}else this.$.ea.Fl(this.HN)};
hg.prototype.z4g=function(k){var H={};H.SearchText=k;H.Page=1;H.DateNodeType=-1;return H};hg.prototype.qUg=function(){this.sPa&&(nc.ULS.sendTraceTag(537167132,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",this.sPa),Jg.j(this.$.na.ua,this.sPa,null,null,null),this.sPa=null);this.G$a&&(Vg.AFrameworkApplication.Jd.Du(this.G$a.Qt),this.G$a=null)};hg.prototype.AAd=function(k){var H=this;return function(Y){H.sPa=null;H.G$a=
null;if(yg.a.uxc(Y)){var za=yg.a.jac(Y);H.IMa?yg.a.xQa(k?na.a.searchAutoFilterItemList:na.a.getAutoFilterItemList,za.MessageIdName,sb.a.IZa,!0,!0):nc.ULS.sendTraceTag(537167127,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",za.MessageIdName)}if(!Dh.a(Y)){nc.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");Y=Y.Result;za=new Ih.a(!0);var Va=Y.AutoFilterDateNodes?!0:!1;Y.AutoFilterItems&&
za.add("AutoFilterItemsCount",Y.AutoFilterItems.length);Va&&za.add("AutoFilterDateItemsCount",Y.AutoFilterDateNodes.length);za.add("Location","contextMenu");ph.b(H.$).Vd(yf.a.AAd,za.lu,void 0,!0);za=H.G2a?Object(ag.a)(new Mf,{filterByValueItems:H.QBe(Y),hasMoreRecords:Y.ItemListMaxExceeded,searchText:Y.SearchText}):Object(ag.a)(new Mf,{filterByValueItems:H.QBe(Y),hasMoreRecords:Y.ItemListMaxExceeded});H.hMb.onGetFilterByValueItemsFinish(za);!k&&Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6266750_SortByColor")&&
(nc.ULS.shipAssertTag(529063959,0,null!==Y.FontColors&&null!==Y.CellColors&&null!==Y.Icons&&null!==Y.SelectedSortFontColors&&null!==Y.SelectedSortCellColors&&null!==Y.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),Y=Object(ag.a)(new zh,{fontColors:Y.FontColors,cellColors:Y.CellColors,icons:Y.Icons,selectedSortFontColor:0<Y.SelectedSortFontColors.length?Y.SelectedSortFontColors[0]:null,selectedSortCellColor:0<Y.SelectedSortCellColors.length?
Y.SelectedSortCellColors[0]:null,selectedSortIcon:0<Y.SelectedSortIcons.length?Y.SelectedSortIcons[0]:null,getColorName:H.getColorName}),H.hMb.onGetColorsAndIconsFinish(Y))}}};hg.prototype.KKi=function(){var k=this;return function(H){k.sPa=null;k.G$a=null;H=ch.a.pg(H.data);nc.ULS.sendTraceTag(537167125,0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",he.a.Wc(H))}};hg.prototype.QBe=function(k){var H=this.r2g(k),Y=this.y2g(k.AutoFilterItems),za=[],Va=0;k.HasBlanks&&
(k=hg.B3c(Ae.a.instance.fa(778),k.IsBlanksSelected?1:0,Ea.a.Lse),za[Va++]=k);H=El(H);for(k=H.next();!k.done;k=H.next())k=k.value,za[Va++]=k;Y=El(Y);for(k=Y.next();!k.done;k=Y.next())H=k.value,za[Va++]=H;return za};hg.prototype.r2g=function(k){var H=[];if(!k.AutoFilterDateNodes||!k.AutoFilterDateNodes.length)return H;for(var Y=[this.X3a(k.YearKeys,k.YearValues),this.X3a(k.MonthKeys,k.MonthValues),this.X3a(k.DayKeys,k.DayValues),this.X3a(k.HourKeys,k.HourValues),this.X3a(k.MinuteKeys,k.MinuteValues),
this.X3a(k.SecondKeys,k.SecondValues)],za=!1,Va=!1,Pb=0,Ac=null,id=Array(6),Ld=null,ld=El(k.AutoFilterDateNodes),ef=ld.next();!ef.done;ef=ld.next()){ef=ef.value;id[0]&&(Ld.Year!==ef.Year?(za=!0,Pb=0,Ac=null):Ld.Month!==ef.Month?(Va=!0,Pb=1,Ac=id[0]):Ld.Day!==ef.Day?(Pb=2,Ac=id[1]):k.ShowTime&&(Ld.Hour!==ef.Hour?(Pb=3,Ac=id[2]):Ld.Minute!==ef.Minute?(Pb=4,Ac=id[3]):(Pb=5,Ac=id[4])));for(;6>Pb;){switch(Pb){case 0:var Jf=ef.Year;Ld=Y[0].getItem(Jf.toString());break;case 1:Jf=ef.Month;Ld=Y[1].getItem(Jf.toString());
break;case 2:Jf=ef.Day;Ld=Y[2].getItem(Jf.toString());break;case 3:Jf=ef.Hour;Ld=Y[3].getItem(Jf.toString());break;case 4:Jf=ef.Minute;Ld=Y[4].getItem(Jf.toString());break;case 5:Jf=ef.Second;Ld=Y[5].getItem(Jf.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Ld=hg.B3c(Ld,-1!==ef.NodeType&&Pb>=ef.NodeType?1:0,Ac?Ac.key+";"+Jf:Ea.a.MXc+Jf,!1,[]);Ac=Ac?Ac.children:H;Ac=Ac[Ac.length]=Ld;id[Pb]=Ld;switch(Pb){case 5:Pb=6;break;case 2:Pb=k.ShowTime?Pb+1:6;break;
default:Pb++}}Ld=ef}za||(id[0].expanded=!0,Va||(id[1].expanded=!0));return H};hg.prototype.y2g=function(k){var H=[];if(!k)return H;var Y=0;k=El(k);for(var za=k.next();!za.done;za=k.next())za=za.value,H[Y++]=hg.B3c(za.DisplayString,za.Selected?1:0,Ea.a.NXc+za.DisplayString);return H};hg.prototype.X3a=function(k,H){var Y=new Ih.a(!0);if(!k||!H)return Y;for(var za=k.length<H.length?k.length:H.length,Va=0;Va<za;Va++)Y.add(k[Va].toString(),H[Va]);return Y};hg.prototype.m3c=function(k,H){var Y={};Y.Location=
H;Y.FieldId=k.Id.toString();Y.DataSourceIndex=-1;Y.FilterType=k.AutoFilterType;Y.AnchorType=0;Y.ChartId=null;Y.AnchorValue1=-1;Y.AnchorValue2=-1;Y.Property=k.RichProperty;return Y};hg.prototype.CL=function(k){ee.a.Fba(this.$)&&Uf.TaskExtensions.Ba(rf.GetServiceTaskFactory.Va(this.$.da,430,431,1),function(H){H.result.qea(k);nc.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.la,3)};hg.prototype.lm=function(){var k=
{};return k.Location="contextMenu",k};hg.prototype.getColorName=function(k){return Pg.a.pKa(Xg.a.rH(k))};hg.prototype.q3f=function(k){Uf.TaskExtensions.Ba(rf.GetServiceTaskFactory.Va(this.$.da,309,310,3),function(H){H.result.OAa().continueWith(function(Y){Y.result&&k()})},this.$.la,3)};hg.B3c=function(k,H,Y,za,Va){k=void 0===k?null:k;H=void 0===H?0:H;Y=void 0===Y?null:Y;za=void 0===za?!1:za;Va=void 0===Va?null:Va;return Object(ag.a)(new Da,{displayText:k?xh.a.fg(k):k,state:H,key:Y,parent:null,children:Va,
indentationLevel:0,expanded:za})};Ek.Object.defineProperties(hg.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.aLf}}});hg.Mse=268;Object(Dd.a)(hg,"AutoFilterContextMenu",xh.a,[]);var da=b(934),Pa=b(83),rb=b(202),d=b(65),A=b(19);df.ESe=26;df.qad=[229,230,0,98,0,94,93];Object(Dd.a)(df,"Constants",null,[]);Ek.Object.defineProperties(Qf.prototype,{jji:{configurable:!0,enumerable:!0,get:function(){return 3===
this.a5b}},Jmi:{configurable:!0,enumerable:!0,get:function(){return 4===this.a5b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.Iwg}},xpf:{configurable:!0,enumerable:!0,get:function(){return this.jsg}},a5b:{configurable:!0,enumerable:!0,get:function(){return this.Jmg}},Y4c:{configurable:!0,enumerable:!0,get:function(){return this.Nmg}}});Object(Dd.a)(Qf,"FiltersMenuData",null,[]);Am(Vf,Qf);Object(Dd.a)(Vf,"AutoFilterFiltersMenuData",Qf,[]);ig.IHj=[new Qf(99,2,
0,null),new Qf(100,2,1,null),new Qf(0,3,0,null),new Qf(171,2,2,null),new Qf(173,2,4,null),new Qf(0,3,0,null),new Qf(175,2,6,null),new Qf(176,2,7,null),new Qf(0,3,0,null),new Qf(107,0,0,null)];ig.bEi=[new Qf(99,2,0,null),new Qf(100,2,1,null),new Qf(0,3,0,null),new Qf(101,2,8,null),new Qf(102,2,10,null),new Qf(103,2,12,null),new Qf(0,3,0,null),new Qf(104,1,0,null),new Vf(105,1),new Vf(106,2),new Qf(0,3,0,null),new Qf(107,0,0,null)];ig.hbh=[new Qf(99,2,0,null),new Qf(0,3,0,null),new Qf(111,2,10,null),
new Qf(112,2,8,null),new Qf(103,2,12,null),new Qf(0,3,0,null),new Vf(109,8),new Vf(108,9),new Vf(110,10),new Qf(0,3,0,null),new Vf(114,11),new Vf(113,12),new Vf(115,13),new Qf(0,3,0,null),new Vf(116,14),new Vf(117,15),new Vf(118,16),new Qf(0,3,0,null),new Vf(119,17),new Vf(120,18),new Vf(121,19),new Qf(0,3,0,null),new Vf(122,20),new Vf(123,21),new Vf(124,22),new Qf(0,3,0,null),new Vf(125,23),new Qf(126,2,12,[new Vf(127,24),new Vf(128,25),new Vf(129,26),new Vf(130,27),new Qf(0,3,0,null),new Vf(131,
28),new Vf(132,29),new Vf(133,30),new Vf(134,31),new Vf(135,32),new Vf(136,33),new Vf(137,34),new Vf(138,35),new Vf(139,36),new Vf(140,37),new Vf(141,38),new Vf(142,39)]),new Qf(0,3,0,null),new Qf(107,0,0,null)];Object(Dd.a)(ig,"Constants",null,[]);var S=b(21);Rf.prototype.compare=function(k,H){return S.a.compare(k,H,!0)};Object(Dd.a)(Rf,"IgnoreCaseComparer",null,[818]);var ja=b(74),Ua=xh.a;Am(bf,Ua);bf.prototype.executeCommand=function(k,H,Y){k=H.command;switch(k){case -699941697:this.applyAutoFilterFieldList(H,
Y);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");break;case -1494291901:break;default:return Qg.a(k)}return qh.Task.Sa(!0)};bf.prototype.udd=function(k,H){return!k||k.length<=H?(nc.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(k[H],10)};bf.prototype.AFd=function(k,H,Y,za,Va,Pb){var Ac=this.udd(Va,Pb);0>Ac&&nc.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");
switch(df.qad[Ac]){case 98:k=new vh.a(-2058042992,H.method,H.mode,H.Ye,H.tabName);this.km.XG.Ctb(this.$,za,0,k);break;case 229:k=new vh.a(504133448,H.method,H.mode,H.Ye,H.tabName);this.km.XG.Ctb(this.$,za,0,k);break;case 230:k=new vh.a(-798968736,H.method,H.mode,H.Ye,H.tabName);this.km.XG.Ctb(this.$,za,0,k);break;case 234:k=new vh.a(-1677817820,H.method,H.mode,H.Ye,H.tabName);this.km.XG.Ctb(this.$,za,0,k);break;case 94:this.bJf(k,H,za,Y,Va,Pb+1);break;case 93:this.km.XG.Bqi(this.$,za)}};bf.prototype.bJf=
function(k,H,Y,za,Va,Pb){var Ac=this.udd(Va,Pb);0>Ac&&nc.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!za||Ac>=za.length)nc.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(za=za[Ac],za.a5b){case 1:this.km.XG.Vqi(this.$,Y);break;case 2:(Va=Object(Pa.a)(Vf,za))?(k=new vh.a(-2058042992,H.method,H.mode,H.Ye,H.tabName),this.km.XG.Ctb(this.$,Y,Va.Nse,k)):this.km.XG.Ejf(this.$,
k,Y,za.Y4c);break;case 0:this.km.XG.Ejf(this.$,k,Y,za.Y4c);break;case 4:this.bJf(k,H,Y,za.subMenu,Va,Pb+1)}};bf.prototype.applyAutoFilterFieldList=function(k,H){var Y=H[da.a.LI];if(Y)if(Y=Y.split(d.a.bV),3>Y.length)nc.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var za=this.udd(Y,1),Va=this.eKa(za),Pb=this.qpf(za).returnValue;Pb?this.AFd(H,k,Pb,Va,Y,2):nc.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+
za.toString()+d.a.bV)}else nc.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};bf.prototype.Lc=function(k,H){if(k=this.$.isEditMode)switch(H.command){case 216058793:break;case -699941697:break;case -1494291901:k=!0;break;default:k=!1}return k};bf.prototype.Q0=function(k,H,Y){this.$.isEditMode&&((this.km=Object(Pa.a)(861,Y))||nc.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),
this.iZ(),Ua.prototype.Q0.call(this,k,H,null,null,!0))};bf.prototype.u3c=function(){if(!this.km||!this.km.Nk||1!==this.km.Nk.length)return nc.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;var k=this.km.Nk[0],H=new rb.a;H.add(Ae.a.instance.fa(250));H=ja.OBc(ja.concat(H,ja.select(ja.asEnumerable(k.FieldInfoDataList),function(Y){return Y.Name})),function(Y){return Y},new Rf);return ja.toArray(H)};bf.prototype.fieldIndex=function(k){if(!this.km||
!this.km.Nk||1!==this.km.Nk.length||!this.km.Nk[0].FieldInfoDataList)return-1;for(var H=0;H<this.km.Nk[0].FieldInfoDataList.length;++H)if(this.km.Nk[0].FieldInfoDataList[H].Name===k)return H;return-1};bf.prototype.eKa=function(k){return 0>k||!this.km||!this.km.Nk||1!==this.km.Nk.length||!this.km.Nk[0].FieldInfoDataList||this.km.Nk[0].FieldInfoDataList.length<k?null:this.km.Nk[0].FieldInfoDataList[k].Name};bf.prototype.iZ=function(){var k=this,H=this.u3c();if(!H||!H.length)return null;for(var Y=this.Ra,
za=Y.Pc(),Va={},Pb=0;Pb<H.length;Va={fgb:Va.fgb},++Pb){var Ac=H[Pb];Va.fgb=0<Pb?this.fieldIndex(Ac):-1;for(var id=bf.U4f+Va.fgb.toString()+d.a.bV,Ld=null,ld=this.km.XG.I4h(0<Pb?Ac:null),ef=this.E3c(Y,ld,bf.U4f+Va.fgb.toString(),Ac),Jf={},Kg=0;Kg<df.qad.length;Jf={HPb:Jf.HPb,egb:Jf.egb},++Kg){var Cg=df.qad[Kg],Wg=id+Kg.toString();Ld||(Ld=Y.Pc());switch(Cg){case 229:Ld.buttons.push(Y.fd(223,Wg,-699941697,this.km.XG.umi(0<Pb?Ac:null)?A.a.L8b:A.a.$Ia,8,229,!1,null));break;case 230:Ld.buttons.push(Y.fd(224,
Wg,-699941697,this.km.XG.vmi(0<Pb?Ac:null)?A.a.M8b:A.a.aJa,8,230,!1,null));break;case 234:Ld.buttons.push(Y.fd(225,Wg,-699941697,A.a.J8b,1,234,!1,null));break;case 98:Cg=this.QQg(Ac);Wg=Y.GHa(Wg+(ld?".enabled":".disabled"),Cg,-699941697,null,"None",null,!ld,void 0,!0);Wg.zS("Image16by16",8,A.a.s2a);Ld.buttons.push(Wg);break;case 94:Jf.HPb=void 0;Jf.egb=void 0;var wi=function(oj,fj){return function(){var Wj=k.qpf(oj.fgb);fj.HPb=Wj.NSe;fj.egb=Wj.isChecked;return Wj}}(Va,Jf)().returnValue;if(!wi)return null;
Cg=this.E3c(Y,Jf.egb&&ld,Wg,Jf.HPb);Wg=this.XVe(Cg.menu,Y,Wg+d.a.bV,wi,Jf.egb&&ld);Cg.menu.Ec.push(Wg);Ld.buttons.push(Cg);break;case 0:Ld&&(ef.menu.Ec.push(Ld),Ld=null);break;default:Wg=Y.GHa(Wg,Ae.a.instance.fa(Cg),-699941697,null,"None",null,!1,void 0,!0),this.cYf(Wg,ld&&93===Cg&&this.km.XG.filter(),Ae.a.instance.fa(Cg)),Ld.buttons.push(Wg)}}ef.menu.Ec.push(Ld);za.buttons.push(ef)}H=Y.Yp(this.menuId);H.Ec.push(za);return H};bf.prototype.XVe=function(k,H,Y,za,Va){for(var Pb=null,Ac=0;Ac<za.length;++Ac){var id=
za[Ac],Ld=Y+Ac.toString(),ld=!1;switch(id.a5b){case 1:ld=Va&&this.km.XG.Vh.IsTop10;break;case 2:ld=Object(Pa.a)(Vf,id);ld=Va&&this.km.XG.Sfi(ld?ld.Nse:0,id.Y4c);break;case 0:ld=Va&&this.km.XG.Vh.IsCustomSupportedAndNotPresent}Pb||(Pb=H.Pc());if(id.jji)Pb&&(k.Ec.push(Pb),Pb=null);else if(id.Jmi){var ef=Ae.a.instance.fa(id.xpf);ef=this.E3c(H,ld,Ld,ef);ef.menu.Ec.push(this.XVe(ef.menu,H,Ld+d.a.bV,id.subMenu,ld));Pb.buttons.push(ef)}else id=Ae.a.instance.fa(id.xpf),Ld=H.GHa(Ld,id,-699941697,null,"None",
null,!1,void 0,!0),this.cYf(Ld,ld,id),Pb.buttons.push(Ld)}return Pb};bf.prototype.cYf=function(k,H,Y){H?k.zS("Image16by16",8,A.a.uua):k.zS("None",0,null);k.xS(Y);k.label=Y};bf.prototype.E3c=function(k,H,Y,za){return H?k.v3c(Y,this.menuId,za,798637440,8,A.a.uua):k.ww(Y,this.menuId,za,798637440)};bf.prototype.Fh=function(k){return!k||!k.length};bf.prototype.qpf=function(k){var H=0>k?0:this.km.Nk[0].FieldInfoDataList[k].MajorityDataTypeForField;var Y=null;k=this.km.XG.H4h(H);switch(H){case 0:Y=95;H=
ig.IHj;break;case 1:Y=94;H=ig.bEi;break;case 2:Y=96;H=ig.hbh;break;default:return nc.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,NSe:Y,isChecked:k}}Y=Ae.a.instance.fa(Y);return{returnValue:H,NSe:Y,isChecked:k}};bf.prototype.QQg=function(k){!k||this.Fh(k.trim())?k=Ae.a.instance.fa(97):k.length>df.ESe?(k=k.substring(0,df.ESe),k=String.format(Ae.a.instance.Ab(155),k)):k=String.format(Ae.a.instance.Ab(156),k);return k};
Ek.Object.defineProperties(bf.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.bLf}}});bf.Tyh=Ea.a.P1g;bf.bJb="AutoFilterFieldListContextMenuRoot";bf.U4f="ApplyAutoFilterFieldList.";Object(Dd.a)(bf,"AutoFilterFieldListContextMenu",xh.a,[]);var kc=b(611),tb=b(1049),$c=b(10),zd=b(120),qe=b(389),Te=xh.a;Am(He,Te);He.prototype.executeCommand=function(k,H,Y){k=Object(Pa.a)(kc.a,Y.eventArgs);
switch(H.command){case -1372040782:Y=Oe.g(this.$).ha.Oa.oc;nc.ULS.shipAssertTag(537167048,0,!!Y);Y&&(this.floatingObject=Y.floatingObject,this.yb=H.method,H=this.Oac(k),this.Ip(H,!0,k.yb));break;case 848910589:k&&(H=[tb.a.x0f],k=new Sys.UI.Point(k.Ca.clientX,k.Ca.clientY),this.showFloatie(H,new Sys.UI.Bounds(k.x,k.y,0,0),2))}return qh.Task.Sa(!0)};He.prototype.Lc=function(k,H,Y){switch(H.command){case -1372040782:return!!Y&&this.Rgf(k);case 848910589:return k=Oe.g(this.$).ha.Oa.oc,!!Y&&!!k&&k.isEditing;
default:return!1}};He.prototype.Rgf=function(k){switch(k){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};He.prototype.pUc=function(k,H,Y){qe.a(this.$)?Oe.g(this.$).rb.dj||(Dc.a(this.$).vRd()?Y.buttons.push(k.Bb(265)):Y.buttons.push(k.Bb(264))):(this.$.isEditMode&&3===this.yb&&!this.m$b()&&Y.buttons.push(k.Bb(101)),5!==this.floatingObject.type||zd.a.VH(this.floatingObject.Kb)||this.floatingObject.Kb.IsGroup||(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&
this.Bqd()?Y.buttons.push(k.Bb(186)):Y.buttons.push(k.Bb(147))),this.m$b()||this.Bqd()||Y.buttons.push(k.Bb(146)),Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.lFh(Y),this.LGh(Y)),Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&Y.buttons.push(k.Bb(287)),Ke.EwaSettings.ma(167)&&0===this.floatingObject.type&&Y.buttons.push(k.Bb(249)),5===this.floatingObject.type&&Oe.g(this.$).ha.Oa.oc.z5()&&
this.$.Dka&&this.$.bha&&Y.buttons.push(k.Bb(273)))};He.prototype.gKa=function(k){var H=[];if(qe.a(this.$))return H;3===k?(k=!!this.$.Yf.get(5)&&this.floatingObject.zUd(),this.m$b()||(this.$.isEditMode?(k&&H.push(tb.a.hCh),5===Oe.g(this.$).ha.Oa.FC.floatingObject.type&&H.push(tb.a.auj)):k&&H.push(tb.a.copy)),H.push(tb.a.iCh)):2===k&&(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?Oe.g(this.$).ha.Oa.oc&&this.I_e(Oe.g(this.$).ha.Oa.oc,H):this.I_e(Oe.g(this.$).ha.Oa.FC,
H));return H};He.prototype.iZ=function(){var k=this.Ra,H=k.Yp(this.menuId),Y=qe.a(this.$);if(this.$.isEditMode){var za=k.Pc();this.pUc(k,H,za);H.Ec.push(za)}this.$.Yf.get(5)&&this.floatingObject.zUd()&&!this.m$b()&&!Y&&(za=k.Pc(),this.xAg(k,za),H.Ec.push(za));(za=this.$.xa.qa)&&za.Yd&&(za=za.Yd.qy||za.Yd.tK,!Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||this.$.ea.isNamedObjectViewMode||Y||this.$.isMobileMode||za||(Y=k.Pc(),this.rCg(k,
Y),H.Ec.push(Y)));return H};He.prototype.Oac=function(k){var H=Oe.g(this.$).ha.Oa.oc;k=k&&1!==k.yb&&k.clientPoint?k.clientPoint:Sys.UI.DomElement.getLocation(H.domElement);var Y=this.$.domElement,za=Oe.g(this.$).rtl;(H=$c.HelperMethods.QC(H.mg.domElement,Y,za))?(k.y=Math.max(k.y,H.y),k.x=Math.max(k.x,H.x)):nc.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",Vg.AFrameworkApplication.Pg);
return k};He.prototype.Bqd=function(){var k=Oe.g(this.$).ha.Oa.oc;return!!k&&k.isEditing};He.prototype.xAg=function(k,H){if(this.$.isEditMode){H.buttons.push(k.Bb(42));H.buttons.push(k.Bb(43));var Y=this.$.da.Aa(254,!0);(Y&&2===Y.kBb()||Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Bqd())&&H.buttons.push(k.Bb(44))}else H.buttons.push(k.Bb(43))};He.prototype.rCg=function(k,H){H.buttons.push(k.Bb(274))};He.prototype.m$b=function(){return Ke.EwaSettings.ma(471)&&
!!Oe.g(this.$).ha.Oa.No};He.prototype.I_e=function(k,H){5===k.floatingObject.type?Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&k.isEditing?H.push(tb.a.x0f):H.push(tb.a.Xtj):H.push(xh.a.VTe)};He.prototype.lFh=function(k){var H=this.Ra.Pc();H.buttons.push(this.Ra.Bb(282));H.buttons.push(this.Ra.Bb(281));var Y=this.Ra.ww("BringToFront","BringToFrontMenuId",Ae.a.instance.fa(818),-1777747317);Y.menu.Ec.push(H);k.buttons.push(Y)};He.prototype.LGh=function(k){var H=this.Ra.Pc();
H.buttons.push(this.Ra.Bb(284));H.buttons.push(this.Ra.Bb(283));var Y=this.Ra.ww("SendToBack","SendToBackMenuId",Ae.a.instance.fa(819),-1777747317);Y.menu.Ec.push(H);k.buttons.push(Y)};Ek.Object.defineProperties(He.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.jLf}}});Object(Dd.a)(He,"FloatingObjectContextMenu",xh.a,[]);var qf=b(998),la=b(102),ab=b(621),ec=b(563),Vc=Ea.a.S1g;Am(ue,
He);ue.prototype.executeCommand=function(k,H,Y){var za=this.$;this.yb=H.method;H=Y[ue.T_c];if(!(k&68)){if(!H){if(8===k)H=ec.a(za).$c;else{var Va=Oe.g(za).ha.Oa.oc;if(null===Va||void 0===Va?0:Va.floatingObject)H=Va.floatingObject.$c}if(!H)return qh.Task.Sa(!0)}this.isPivotChart=!!(H.Attributes&4)}if(this.isPivotChart||za.isEditMode)if(this.refresh=this.zZ=this.Uva=this.LAa=!1,Va=Oe.g(this.$).ha.Oa.oc,nc.ULS.shipAssertTag(537167107,0,!!Va),Va){this.floatingObject=Va.floatingObject;Va=ab.a(za);if(null===
Va||void 0===Va?0:Va.RQd)this.LAa=Va=la.f(za.kg),this.Uva=!Va;Va=za.xc;this.zZ=!!qf.a(za)&&!!H&&!!(H.Attributes&512)&&!(k&8)&&Va.U2(32768);Va.allowManualDataRefresh&&Va.allowInteractivity&&(this.refresh=!0);k=this.Oac(Object(Pa.a)(kc.a,Y.eventArgs));this.Ip(k,!0)}return qh.Task.Sa(!0)};ue.prototype.Lc=function(k,H,Y){return-149612405===H.command&&!!Y&&this.Rgf(k)};ue.prototype.pUc=function(k,H,Y){this.isPivotChart&&(this.refresh&&Y.buttons.push(k.Bb(100)),this.zZ&&Y.buttons.push(k.Bb(99)),this.LAa?
Y.buttons.push(k.Bb(59)):this.Uva&&Y.buttons.push(k.Bb(58)));He.prototype.pUc.call(this,k,H,Y)};Ek.Object.defineProperties(ue.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.dLf}}});Ek.Object.defineProperties(ue,{T_c:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(Dd.a)(ue,"ChartContextMenu",He,[]);var Kc=b(12),Fd=Ea.a.U1g,te=xh.a;Am(td,te);td.prototype.executeCommand=
function(k,H,Y){k=H.command;switch(k){case 330754562:H=Y.domElement;this.isOlap=Y.isOlap;this.JL=Y.versionkey;this.xo=Y.fieldItem;this.h_=Y.isChart;this.$H=Y.isPpm;this.BUd="supportsImplicitMeasures"in Y?Y.supportsImplicitMeasures:!1;Oe.g(this.$).Jp(!0);k=Kc.DOMElementExtensions.getBounds(H);k=new Sys.UI.Point(k.x+k.width,k.y+k.height/2);this.HTa(k,H);"isKeyboardInput"in Y&&Y.isKeyboardInput?this.Ip(k,!1,1):this.Ip(k,!1);break;case 926905850:this.BUd&&this.xo&&5===this.xo.TypeTag&&!this.xo.IsCollapsible&&
nc.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");ab.a(this.$).lH(this.xo,8,-1,this.JL,H);break;case -67292059:ab.a(this.$).lH(this.xo,1,-1,this.JL,H);break;case 745182485:ab.a(this.$).lH(this.xo,2,-1,this.JL,H);break;case 359279088:ab.a(this.$).lH(this.xo,4,-1,this.JL,H);break;case 547535945:ab.a(this.$).o4i(this.xo);break;default:return Qg.a(k)}return qh.Task.Sa(!0)};td.prototype.Lc=function(k,H,Y){k=!1;switch(H.command){case 330754562:k=!!Y;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:k=
!0}return k};td.prototype.iZ=function(){var k=this.Ra.Yp(this.menuId);this.PYi(k);this.h_||this.isOlap||this.OYi(k);return k};td.prototype.PYi=function(k){var H=this.Ra,Y=H.Pc(),za=!1;Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(za=this.isOlap&&!this.$H&&this.BUd&&5===this.xo.TypeTag&&!this.xo.IsCollapsible);3!==this.xo.TypeTag&&37!==this.xo.TypeTag||this.xo.IsSet?17===this.xo.TypeTag||this.$H?(Y.buttons.push(H.Bb(79)),Y.buttons.push(H.Bb(this.h_?91:80)),
Y.buttons.push(H.Bb(this.h_?92:81)),Y.buttons.push(H.Bb(82))):13===this.xo.TypeTag||this.xo.IsSet?(Y.buttons.push(H.Bb(83)),Y.buttons.push(H.Bb(this.h_?91:80)),Y.buttons.push(H.Bb(this.h_?92:81)),Y.buttons.push(H.Bb(86))):(Y.buttons.push(H.Bb(79)),Y.buttons.push(H.Bb(this.h_?91:80)),Y.buttons.push(H.Bb(this.h_?92:81)),Y.buttons.push(H.Bb(za?82:86))):(Y.buttons.push(H.Bb(83)),Y.buttons.push(H.Bb(this.h_?93:84)),Y.buttons.push(H.Bb(this.h_?94:85)),Y.buttons.push(H.Bb(82)));k.Ec.push(Y)};td.prototype.OYi=
function(k){var H=this.Ra.Pc();H.buttons.push(this.Ra.Bb(78));k.Ec.push(H)};Ek.Object.defineProperties(td.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.IGd}}});Object(Dd.a)(td,"FieldListContextMenu",xh.a,[]);var hf=b(438),Yf=b(63);jd.prototype.get=function(k,H,Y){var za=this.M$f(k,"PivotFilterContextMenuCache.Get");return za&&this.wN[za]?this.wN[za][jd.qfd(H,this.$,k,Y)]:null};jd.prototype.set=
function(k,H,Y,za){var Va=this.M$f(k,"PivotFilterContextMenuCache.Set");Va&&(this.wN[Va]||(this.wN[Va]={}),this.wN[Va][jd.qfd(H,this.$,k,za)]=Y)};jd.prototype.y7b=function(k){k in this.wN&&this.wN[k]&&(this.wN[k]=null)};jd.prototype.M$f=function(k,H){return Yf.f(this.$.qa)?this.$.activeItemName:(k=this.rMj(k,H))?k.ae:null};jd.prototype.rMj=function(k,H){k=ve.C(k);k=Oe.g(this.$).Ea.lva(k,this.$.activeItemName);nc.ULS.shipAssertTag(537167008,0,!!k,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",
H);return k};jd.qfd=function(k,H,Y,za){return Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===za?H.qa.index+"_"+k.id+"_"+Y.FirstRow.toString()+"_"+Y.FirstColumn.toString():H.qa.index+"_"+k.id};Object(Dd.a)(jd,"PivotFilterContextMenuCache",null,[]);Object(Dd.a)(Fc,"ShowPivotFilterData",null,[]);var mg=b(617),cg=b(1345),Sg=b(54),$g=Ea.a.DBe,ti=xh.a;Am(pg,ti);pg.prototype.r$c=function(k,H){var Y=this,za=k.rawEvent,Va=k.cell,Pb=k.requiresConfirmation;mg.a(this.$).Sx(Pb,function(Ac){if(Ac){Ac=
za?new Sys.UI.DomEvent(za):null;Y.pivotData=new Fc;Y.pivotData.pivotName=k.pivotName;Y.pivotData.dataSourceIndex=k.dataSourceIndex;Y.pivotData.cell=Va;Y.pivotData.Jo=k.optionalPivotMenuAnchorParameter;if(Y.pivotData.Jo&&0<Y.pivotData.Jo.AnchorType){Y.wmc=k.objectId;Y.EDb=k.objectVersion;var id=Y.pivotData.Jo.AnchorType;if(4===id||5===id||6===id||11===id||9===id||10===id||8===id)Y.ymb=k.location}else Y.Vyd=Y.wmc=null,Y.Wyd=Y.EDb=-1;Oe.g(Y.$).Jp(!0);Y.$.Bj(Va);Y.Q0(Ac,Ac?Ac.target:k.domElement,Y.pivotData,
H,Y.eMa())}});return!0};pg.prototype.Q0=function(k,H,Y,za){var Va=this;if(Object(hf.a)(Fc,Y)){this.pivotData=Y;this.l5b=H;this.Nif=k;this.k2b=this.pivotData.Jo?this.pivotData.Jo.AnchorValue1:-1;this.LY=this.pivotData.Jo?this.pivotData.Jo.AnchorType:0;var Pb=!1,Ac=null;Ac=pg.wN.get(this.pivotData.cell,H,this.LY);Pb=!!Ac;var id=!0;switch(this.LY){case 4:case 5:case 6:this.$ca=new Sys.UI.Point(this.ymb.x,this.ymb.y);id=!1;break;case 7:var Ld=Sys.UI.DomElement.getBounds(H);id=Ld.x+(0<=Ld.x?0:Ld.width);
Ld=Ld.y+(0<=Ld.y?0:Ld.height);this.$ca=new Sys.UI.Point(0<=id?id:0,0<=Ld?Ld:0);id=!1;break;case 8:case 10:case 9:case 11:this.$ca=new Sys.UI.Point(this.ymb.x,this.ymb.y);break;default:this.$ca=null}Pb&&this.wmc===this.Vyd&&this.EDb===this.Wyd&&this.k2b===this.uxe&&this.LY===this.wpe?(nc.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.Hrb=Ac,this.$ca?(this.HTa(this.$ca,H),this.Ip(this.$ca,this.eMa())):this.oy?(!Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||
xh.a.Hnd(this.$,this.pivotData.cell))&&this.Ip(xh.a.Edd(this.$,this.pivotData.cell,!1),this.eMa()):ti.prototype.Q0.call(this,k,H,Y,za,this.eMa())):1!==pg.iOh(H)&&(id&&(H.parentNode.menuFetchStates=1,this.Coj(H),this.LXf(!0)),this.$.userOperationManager.ic(new Ed.a(126,0,function(ld,ef,Jf){var Kg=Va.$;return Jg.A(Kg.na.ua,Va.pivotData.cell,Va.pivotData.dataSourceIndex,Va.pivotData.pivotName,Kg.domElement.id,Kg.isChromeRtl,Kg.workbookContext.NovMode,Rg.b(ld,Va.aLi),Rg.a(ef,Va.$Ki),Jf,H,Va.pivotData.Jo)},
16),za))}};pg.prototype.WDd=function(k){Array.addRange(k.MenuSectionList,this.Hrb)};pg.prototype.Uvd=function(k,H){k.parentNode.menuFetchStates=2;this.LXf(!1);if(H){if(this.l5b!==k||this.qzi())this.HTa(this.$ca,k),this.Ip(this.$ca,this.eMa());else if(this.oy&&!this.$ca){if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!xh.a.Hnd(this.$,this.pivotData.cell))return;this.Ip(xh.a.Edd(this.$,this.pivotData.cell,!1),this.eMa())}else ti.prototype.Q0.call(this,this.Nif,
k,null,null,this.eMa());this.Vyd=this.wmc;this.Wyd=this.EDb;this.wpe=this.LY;this.uxe=this.k2b}};pg.prototype.eMa=function(){return 8!==this.LY&&9!==this.LY&&10!==this.LY&&11!==this.LY};pg.prototype.qzi=function(){switch(this.pivotData.Jo?this.pivotData.Jo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};pg.prototype.LXf=function(k){var H=this.l5b;if(H){if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var Y=Kc.DOMElementExtensions.KZ(H,
"ewaprevsrc","");Y=!!Y&&"null"!==Y}else Y=!!Kc.DOMElementExtensions.KZ(H,"ewaprevsrc","");k&&Y||!k&&!Y||(k?(H.setAttribute("ewaprevsrc",H.src),H.src=Sg.a.current.kp(77)):(k=Kc.DOMElementExtensions.KZ(H,"ewaprevsrc",""),H.src=k,H.setAttribute("ewaprevsrc",null)))}};pg.prototype.Coj=function(k){this.l5b=k};pg.iOh=function(k){var H=k.parentNode.menuFetchStates;void 0===H&&(k.parentNode.menuFetchStates=0);return H};pg.wN=null;Object(Dd.a)(pg,"PivotFilterContextMenuBase",xh.a,[]);var Hh="FieldList"+Ea.a.DBe;
Am(Dg,pg);Dg.prototype.executeCommand=function(k,H,Y){return this.r$c(Y,H)?qh.Task.Sa(!0):Qg.a(H.command)};Dg.prototype.Lc=function(k,H,Y){return-1065117584===H.command&&!!Y};Ek.Object.defineProperties(Dg.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.hLf}}});Object(Dd.a)(Dg,"FieldListPivotContextMenu",pg,[]);var Lg=b(29),Tg=b(936);Object(Dd.a)(hh,"PivotValueFieldSettingsApplyData",null,
[]);Fe.Oah="dataFieldCustomLabel";Fe.LFe="dataFieldSourceLabel";Fe.FSd="showValueAsSelect";Fe.DSd="showValueAsBaseFieldSelect";Fe.ESd="showValueAsBaseItemSelect";Fe.MZd="valueFieldsSettingsFieldName";Fe.Reg="valueFieldSettingTabs";Object(Dd.a)(Fe,"CssElementIds",null,[]);var Vh=b(116);Object(Dd.a)(tg,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);of.prototype.getActiveCell=function(){return this.activeCell};Object(Dd.a)(of,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[445]);var fi=
b(242);Object(Dd.a)(gf,"PivotValueFieldShowValueAsApplyData",null,[]);var Gj=b(938),Zi=b(43),Sj="<div id='showValueAsControlBody'><label for='"+Fe.FSd+"' class='"+Vh.a.vo+" valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='"+Fe.FSd+"' class='"+Vh.a.MC+"'></select></div><div class='showValueAsControlSelectRegion'><label for='"+Fe.DSd+"'>{1}</label><div><select size=6 id='"+Fe.DSd+"' class='"+Vh.a.MC+"'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='"+
Fe.ESd+"'>{2}</label><div><select size=6 id='"+Fe.ESd+"' class='"+Vh.a.MC+"'></select></div></div></div>",oh=fi.a;Am(ze,oh);ze.prototype.Kja=function(){return this.isVisible};ze.prototype.Ena=function(k){return this.isVisible=k};ze.prototype.setFocus=function(){Kc.DOMElementExtensions.setFocus(this.J3.Yn)};ze.prototype.render=function(k){k.appendChild(this.domElement)};ze.prototype.dispose=function(){kg.a.zc([this.J3,this.pU,this.SP,this.Q5b,this.E0b]);oh.prototype.dispose.call(this)};ze.prototype.frj=
function(k){kg.a.zc([this.Q5b,this.E0b]);this.J3.clear();for(var H=El(k.DataFormatTypes),Y=H.next();!Y.done;Y=H.next())Y=Y.value,this.J3.kM(ze.rMh(Y),Y.toString(),Y===k.SelectedDataFormat);this.Q5b=this.he.Zd(this.J3.domElement);this.Q5b.ka("change",this.yvf);this.pU.clear();H=El(k.BaseFieldList);for(Y=H.next();!Y.done;Y=H.next())Y=Y.value,this.pU.kM(Y.DisplayString,Y.Id.toString(),Y.Id===k.SelectedBaseField);this.E0b=this.he.Zd(this.J3.domElement);this.E0b.ka("change",this.WFi);this.BF=this.Yha.Crb(this.SP.Yn.parentNode,
1E3,null,"",736);this.yvf(null)};ze.prototype.fR=function(k){this.J3.fR(k);this.pU.fR(k);this.SP.fR(k)};ze.prototype.eka=function(){this.domElement.innerHTML=String.format(Sj,Ae.a.instance.fa(1086),Ae.a.instance.fa(1087),Ae.a.instance.fa(1088));this.C4d=new Gj.a(Kc.DOMElementExtensions.getElementById(this.domElement,Fe.FSd),!1);this.i2d=new Gj.a(Kc.DOMElementExtensions.getElementById(this.domElement,Fe.DSd),!1);this.j2d=new Gj.a(Kc.DOMElementExtensions.getElementById(this.domElement,Fe.ESd),!1)};
ze.prototype.eUg=function(k){return this.Dji||!ze.ibf(k)&&!ze.jbf(k)?!0:!!this.pU.count};ze.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var k=this;this.$.userOperationManager.ic(new Ed.a(108,0,function(H,Y,za){var Va=k.$.na.ua,Pb=parseInt(k.pU.xe.value,10);H=Rg.b.call(null,H,k.VLi);var Ac=Jg.nb(Va,k.cell,k.externalSourceIndex,k.Jo);Ac.selectedBaseField=Pb;return Jg.i(Va,"GetPivotValueFieldSettingsShowValueAsBaseItems",Ac,H,Y,za,null,4)},16),this.Rd)};ze.prototype.tkf=function(){this.SP.clear();
this.pU.xe&&(this.BF.UAa(),this.SP.Yn.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};ze.prototype.$Nb=function(k){var H=document.getElementById("WACDialogActionButton");this.ERj&&H&&(H.disabled=k)};ze.rMh=function(k){switch(k){case 0:return Ae.a.instance.fa(1089);case 1:return Ae.a.instance.fa(1090);case 2:return Ae.a.instance.fa(1091);case 3:return Ae.a.instance.fa(1092);case 4:return Ae.a.instance.fa(1093);case 5:return Ae.a.instance.fa(1094);case 6:return Ae.a.instance.fa(1095);
case 7:return Ae.a.instance.fa(1096);case 8:return Ae.a.instance.fa(1098);case 9:return Ae.a.instance.fa(1099);case 10:return Ae.a.instance.fa(1100);case 11:return Ae.a.instance.fa(1101);case 12:return Ae.a.instance.fa(1102);case 13:return Ae.a.instance.fa(1103);case 14:return Ae.a.instance.fa(1104);default:return""}};ze.ibf=function(k){return 11===k||12===k||14===k||13===k||4===k};ze.jbf=function(k){return 1===k||3===k||2===k};Ek.Object.defineProperties(ze.prototype,{title:{configurable:!0,enumerable:!0,
get:function(){return Ae.a.instance.fa(1085)}},Yvb:{configurable:!0,enumerable:!0,get:function(){var k=this.J3.xe?parseInt(this.J3.xe.value,10):-1,H=this.pU.xe?parseInt(this.pU.xe.value,10):-1,Y=this.SP.xe?parseInt(this.SP.xe.value,10):-1;return Object(ag.a)(new gf,{SelectedDataFormat:0<=k?k:-1,SelectedBaseField:H,SelectedBaseItem:Y})}},pU:{configurable:!0,enumerable:!0,get:function(){return this.i2d}},SP:{configurable:!0,enumerable:!0,get:function(){return this.j2d}},J3:{configurable:!0,enumerable:!0,
get:function(){return this.C4d}}});Object(Dd.a)(ze,"ShowValueAsControl",fi.a,[833,3]);Object(Dd.a)(od,"PivotValueFieldSummarizeValueByApplyData",null,[]);var Li="<div id='summarizeValuesByControlBody'><label class='"+(Vh.a.vo+" valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='")+(Vh.a.vo+" summarizeValuesByControlDescription'>{1}</div><div><select class='")+(Vh.a.MC+"' size=6 id='pivotDataFieldSelect' style='width: 100%' "+Ea.a.VG+
"='pivotDataFieldSelectDescription'></select></div></div>"),Ai=fi.a;Am(yd,Ai);yd.prototype.Kja=function(){return this.isVisible};yd.prototype.Ena=function(k){return this.isVisible=k};yd.prototype.setFocus=function(){Kc.DOMElementExtensions.setFocus(this.el.Yn)};yd.prototype.render=function(k){k.appendChild(this.domElement)};yd.prototype.dispose=function(){kg.a.Ha(this.el);Ai.prototype.dispose.call(this)};yd.prototype.focus=function(){Kc.DOMElementExtensions.setFocus(this.el.Yn)};yd.prototype.erj=
function(k){this.el.CTd();for(var H=El(k.AggregationTypes),Y=H.next();!Y.done;Y=H.next()){Y=Y.value;var za=Y===k.SelectedAggregation;this.el.mUc(yd.YHh(Y),Y.toString(),za,"")}this.el.c8c();this.el.Yn.disabled=k.AggregationsDisabled};yd.prototype.Egj=function(){this.el.Fgj()};yd.prototype.eka=function(){this.domElement.innerHTML=String.format(Li,Ae.a.instance.fa(1069),Ae.a.instance.fa(1070));this.Cde=new Gj.a(Kc.DOMElementExtensions.getElementById(this.domElement,yd.iGf),!1)};yd.YHh=function(k){switch(k){case 0:return Ae.a.instance.fa(1072);
case 1:return Ae.a.instance.fa(1073);case 2:return Ae.a.instance.fa(1074);case 3:return Ae.a.instance.fa(1075);case 4:return Ae.a.instance.fa(1076);case 5:return Ae.a.instance.fa(1077);case 6:return Ae.a.instance.fa(1078);case 7:return Ae.a.instance.fa(1079);case 8:return Ae.a.instance.fa(1080);case 9:return Ae.a.instance.fa(1081);case 10:return Ae.a.instance.fa(1082);case 11:return Ae.a.instance.fa(1083);default:return""}};Ek.Object.defineProperties(yd.prototype,{Yvb:{configurable:!0,enumerable:!0,
get:function(){var k=this.el.xe?parseInt(this.el.xe.value,10):-1;return Object(ag.a)(new od,{Aggregation:0<=k?k:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return Ae.a.instance.fa(1084)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.el.Yn.disabled},set:function(k){this.el.Yn.disabled=!k}},el:{configurable:!0,enumerable:!0,get:function(){return this.Cde}}});yd.iGf="pivotDataFieldSelect";Object(Dd.a)(yd,"SummarizeValuesByControl",fi.a,[833,3]);var Ri=b(214),ki=b(493);
Rc.prototype.uGj=function(k,H){k.set_visible(!1);H.set_visible(!0)};Object(Dd.a)(Rc,"DefaultTabSwitchBehaviour",null,[847]);cc.fHj="TabsContainer";cc.QGj="TabTitlesContainer";cc.OGj="TabTitle";cc.PGj="TabTitleText";cc.YUd="TabTitleActive";Object(Dd.a)(cc,"MultitabControlStyles",null,[]);var Pi=b(42),Ni=b(86),be=b(91),V=b(57);Cb.prototype.dispose=function(){Pi.a.removeHandler(this.gk,"keyup",Object(nh.a)(this,this.e$a,"onTitleKeyUp"));Pi.a.removeHandler(this.gk,"click",this.yGc);this.gk=this.Dfa=null};
Cb.prototype.setActive=function(k){k?Sys.UI.DomElement.addCssClass(this.gk,cc.YUd):Sys.UI.DomElement.removeCssClass(this.gk,cc.YUd);this.Dfa&&this.Dfa.setAttribute(be.a.cha,k)};Cb.prototype.e$a=function(k){k.keyCode!==Ni.a.di&&k.keyCode!==Ni.a.Moa||this.yGc(k)};Cb.prototype.vBc=function(){this.gk.setAttribute(be.a.Td,be.a.Sr);this.Dfa.setAttribute(be.a.Pt,this.Sp);this.Dfa.setAttribute(be.a.Td,be.a.nob)};Ek.Object.defineProperties(Cb.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return this.gk}},
title:{configurable:!0,enumerable:!0,get:function(){return this.Sp}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.gk,cc.YUd)},set:function(k){this.setActive(k)}}});Object(Dd.a)(Cb,"TabTitleControl",null,[3]);var Ga=b(39);ya.prototype.xQf=function(){this.kmb=document.createElement("ul");this.kmb.className=cc.QGj;this.cmb=document.createElement("div");this.cmb.className=cc.fHj;for(var k=0;k<this.yzc;++k){var H=this.qga.oa(k),Y=this.YEa.oa(k);
H.set_visible(!1);Y.isActive=!1;var za=document.createElement("div");H.render(za);this.cmb.appendChild(za);this.kmb.appendChild(Y.uc)}this.uc.appendChild(this.kmb);this.uc.appendChild(this.cmb);this.Ard(this.v1)&&(this.YEa.oa(this.v1).isActive=!0,this.qga.oa(this.v1).set_visible(!0))};ya.prototype.dispose=function(){for(var k=0;k<this.yzc;++k)this.qga.oa(k).dispose(),this.YEa.oa(k).dispose();this.YEa=this.qga=this.gk=this.cmb=this.kmb=null};ya.prototype.setFocus=function(){this.qga.oa(this.v1).setFocus()};
ya.prototype.Ard=function(k){return 0<=k&&k<this.yzc};ya.prototype.y7f=function(k){this.v1!==k&&this.Ard(k)&&(this.Pwg.uGj(this.qga.oa(this.v1),this.qga.oa(k)),this.YEa.oa(this.v1).isActive=!1,this.YEa.oa(k).isActive=!0,this.v1=k,this.setFocus())};ya.prototype.R5g=function(k){var H=this;return function(){H.y7f(k)}};Ek.Object.defineProperties(ya.prototype,{yzc:{configurable:!0,enumerable:!0,get:function(){return this.qga.count}},activeTab:{configurable:!0,enumerable:!0,get:function(){return this.v1},
set:function(k){this.y7f(k)}},uc:{configurable:!0,enumerable:!0,get:function(){return this.gk}},visible:{configurable:!0,enumerable:!0,get:function(){return Ga.a.isVisible(this.gk)},set:function(k){this.gk.style.visibility=k?"visible":"hidden"}}});Object(Dd.a)(ya,"MultitabControl",null,[831,3]);var Bb=Tg.a;Am(Ee,Bb);Ee.prototype.dispose=function(){this.l5c=this.Urb=this.nSa=this.SRc=null;kg.a.Ha(this.Ofa);this.Ofa=null;Bb.prototype.dispose.call(this)};Ee.prototype.initialize=function(){var k="<div id='"+
Fe.LFe+"' class='"+Vh.a.vo+"'></div><div id='"+Fe.Oah+"' class='"+Vh.a.vo+"'><label for='"+Fe.MZd+"'>{0}</label><input type='text' id='"+Fe.MZd+"' value='{1}' class='"+Vh.a.MC+" UIFont' /></div><div id='"+Fe.Reg+"'></div>";k=String.format(k,Ae.a.instance.fa(1068),Lg.a.Sf(this.Qeg));this.Qb.innerHTML=k;this.Ne||(this.K2(),this.cl());this.dje=[-103190598];this.t_h();Bb.prototype.initialize.call(this)};Ee.prototype.close=function(k){1===k&&(this.s2f=!1);Bb.prototype.close.call(this,k)};Ee.prototype.QHe=
function(k){this.mR=k;this.domElement.disabled=k;for(var H=["input","option","select"],Y=0,za=H.length;Y<za;++Y)for(var Va=this.domElement.getElementsByTagName(H[Y]),Pb=0;Pb<Va.length;++Pb)Va[Pb].disabled=k};Ee.prototype.cl=function(){this.Urb=document.getElementById(Fe.MZd);this.l5c=Kc.DOMElementExtensions.getElementById(this.Qb,Fe.LFe);var k=Kc.DOMElementExtensions.getElementById(this.Qb,Fe.Reg);this.SRc=new yd(document.createElement("div"));this.nSa=new ze(document.createElement("div"),this.$,
this.cell,this.Jo,this.externalSourceIndex,this.Rd,this.Yha,!this.isOlap);var H;this.Ofa=new ya(k,(H=new rb.a,H.add(this.SSa),H.add(this.nSa),H));this.Ofa.xQf()};Ee.prototype.jqc=function(){var k=new Ee(this.cell,this.Jo,this.externalSourceIndex,this.Qeg,this.$,this.Rd,this.Yha,this.isOlap,this.$H);k.initialize();k.kf()};Ee.prototype.$Ta=function(){var k=new ki.a;if(!this.s2f)return k.isValid=!0,k;this.Urb.value.length?k.isValid=!0:(this.QHe(!0),k.error=he.a.gd(1,0,751,766,0,1783218700,"PivotTableValueFieldNoBlank"),
this.mR=!0,this.Ne||(this.Qx.disabled=!0),k.isValid=!1);return k};Ee.prototype.Y4e=function(){this.mR=!1;this.Ne||(this.Qx.disabled=!1);this.QHe(!1)};Ee.prototype.oya=function(k){var H=new vh.a(2105621672,0,this.$.ed,30,null);this.$.Ka.Xb(H);this.cX(5,k.yb,"Number Format");return!0};Ee.prototype.tm=function(){this.rBa=String.format(Ae.a.instance.Ab(61),null);Bb.prototype.tm.call(this)};Ee.prototype.setFocus=function(){if(this.Ne){var k=Kc.DOMElementExtensions.getElementById(this.Qb,yd.iGf);Ri.a.XAc(k)}else this.Ofa.setFocus()};
Ee.prototype.Zi=function(){var k=this,H=this.nSa.Yvb,Y=new tg(H.SelectedDataFormat,H.SelectedBaseField,H.SelectedBaseItem);return function(){return new of(k.externalSourceIndex,k.cell,k.Urb.value,k.SSa.Yvb.Aggregation,Y)}};Ee.prototype.Kx=function(){var k=this,H=Object(ag.a)(new hh,{PivotValueFieldSummarizeValueByApplyData:this.SSa.Yvb,PivotValueFieldShowValueAsApplyData:this.nSa.Yvb,PivotValueFieldTitle:this.Urb.value});return function(Y,za,Va){var Pb=k.$.na.ua;Y=Rg.b(Y,k.LFi);var Ac=Jg.nb(Pb,k.cell,
k.externalSourceIndex,k.Jo);Ac.pivotValueFieldSettingsApplyData=H;return Jg.i(Pb,"ApplyPivotValueFieldSettings",Ac,Y,za,Va,null,0)}};Ee.prototype.fR=function(k){var H=this;this.$.da.$a(40,function(){H.nSa.fR(k)})};Ee.prototype.t_h=function(){var k=this;this.$.userOperationManager.ic(new Ed.a(123,0,function(H,Y,za){var Va=k.$.na.ua;H=Rg.b.call(null,H,k.ULi);var Pb=Jg.nb(Va,k.cell,k.externalSourceIndex,k.Jo);return Jg.i(Va,"GetPivotValueFieldSettingsInitial",Pb,H,Y,za,null,4)},16),this.Rd)};Ek.Object.defineProperties(Ee.prototype,
{Cc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},Fea:{configurable:!0,enumerable:!0,get:function(){return this.dje}},aDb:{configurable:!0,enumerable:!0,get:function(){return this.Ofa}},SSa:{configurable:!0,enumerable:!0,get:function(){return this.SRc}},Gu:{configurable:!0,enumerable:!0,get:function(){return 560}}});Object(Dd.a)(Ee,"ValueFieldSettingsDialog",Tg.a,[]);var gc=Ea.a.V1g,dd=xh.a;Am(nf,dd);nf.prototype.executeCommand=function(k,H,Y,za){var Va=this;k=H.command;
switch(k){case -1453503574:za=Y.domElement;this.xo=Y.fieldItem;this.T_d=Y.zoneCount;this.ASa=Y.sourceAxis;this.Byc=Y.sourceAxisPos;this.Jo=Y.optionalPivotMenuAnchorParameter;this.JL=Y.versionkey;this.isOlap=Y.isOlap;this.$H=Y.isPpm;this.D2a="fieldItemsupportsImplicitMeasures"in Y?Y.fieldItemsupportsImplicitMeasures:!1;this.cell=Y.cell;this.externalSourceIndex=Y.externalSourceIndex;Oe.g(this.$).Jp(!0);k=Kc.DOMElementExtensions.getBounds(za);var Pb=new Sys.UI.Point(k.x,k.y+k.height);this.$.isChromeRtl&&
(Pb.x+=k.width);this.HTa(Pb,za);"isKeyboardInput"in Y&&Y.isKeyboardInput?this.Ip(Pb,!1,1):this.Ip(Pb,!1);break;case 495005930:ab.a(this.$).Xeh();break;case -1170196828:ab.a(this.$).lH(this.xo,this.ASa,this.Byc-1,this.JL,H);break;case -889576107:ab.a(this.$).lH(this.xo,this.ASa,this.Byc+2,this.JL,H);break;case 2033235475:ab.a(this.$).lH(this.xo,this.ASa,this.T_d,this.JL,H);break;case 389774337:ab.a(this.$).lH(this.xo,this.ASa,0,this.JL,H);break;case -96230454:ab.a(this.$).lH(this.xo,4,-1,this.JL,H);
break;case 74086617:ab.a(this.$).lH(this.xo,1,-1,this.JL,H);break;case 1529312473:ab.a(this.$).lH(this.xo,2,-1,this.JL,H);break;case 563292088:this.D2a&&nc.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");ab.a(this.$).lH(this.xo,8,-1,this.JL,H);break;case -1092351914:ab.a(this.$).lH(this.xo,0,-1,this.JL,H);break;case -2141589616:var Ac=rf.GetServiceTaskFactory.Va(this.$.da,12,477,za.Dja());return Uf.TaskExtensions.Ba(Ac,function(){(new Ee(Va.cell,Va.Jo,Va.externalSourceIndex,
Va.xo.Name,Va.$,H,Ac.result,Va.isOlap,Va.$H)).initialize()},this.la);default:return Qg.a(k)}return qh.Task.Sa(!0)};nf.prototype.Lc=function(k,H,Y){k=!1;switch(H.command){case -1453503574:k=!!Y;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:k=!0}return k};nf.prototype.iZ=function(){var k=this.Ra.Yp(this.menuId);this.WYi(k,this.Byc,this.T_d);this.XYi(k,this.ASa);this.YYi(k);
8===this.ASa&&this.UYi(k);return k};nf.prototype.WYi=function(k,H,Y){var za=this.Ra,Va=za.Pc();H||H!==Y-1?!H&&H<Y-1?(Va.buttons.push(za.Bb(64)),Va.buttons.push(za.Bb(61)),Va.buttons.push(za.Bb(66)),Va.buttons.push(za.Bb(63))):0<H&&H<Y-1?(Va.buttons.push(za.Bb(60)),Va.buttons.push(za.Bb(61)),Va.buttons.push(za.Bb(62)),Va.buttons.push(za.Bb(63))):0<H&&H===Y-1&&(Va.buttons.push(za.Bb(60)),Va.buttons.push(za.Bb(65)),Va.buttons.push(za.Bb(62)),Va.buttons.push(za.Bb(67))):(Va.buttons.push(za.Bb(64)),Va.buttons.push(za.Bb(65)),
Va.buttons.push(za.Bb(66)),Va.buttons.push(za.Bb(67)));k.Ec.push(Va)};nf.prototype.XYi=function(k,H){var Y=this.Ra,za=Y.Pc(),Va=1!==H&&(!this.isOlap||this.$H||8!==H||this.D2a),Pb=2!==H&&(!this.isOlap||this.$H||8!==H||this.D2a),Ac=8!==H&&-2!==this.xo.PivotTableIndex&&(!this.isOlap||this.$H||this.D2a);za.buttons.push(Y.Bb(4===H||this.xo.IsSet||-2===this.xo.PivotTableIndex||this.isOlap&&!this.$H&&8===H&&!this.D2a?72:68));8===this.Jo.AnchorType||10===this.Jo.AnchorType?(za.buttons.push(Y.Bb(Va?95:97)),
za.buttons.push(Y.Bb(Pb?96:98))):(za.buttons.push(Y.Bb(Va?69:73)),za.buttons.push(Y.Bb(Pb?70:74)));za.buttons.push(Y.Bb(Ac?71:75));k.Ec.push(za)};nf.prototype.YYi=function(k){var H=this.Ra.Pc();H.buttons.push(this.Ra.Bb(76));k.Ec.push(H)};nf.prototype.UYi=function(k){var H=this.Ra.Pc();H.buttons.push(this.Ra.Bb(77));k.Ec.push(H)};Ek.Object.defineProperties(nf.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.JGd}}});
Object(Dd.a)(nf,"FieldWellContextMenu",xh.a,[]);var sd=b(1308);Am(ge,pg);ge.prototype.executeCommand=function(k,H,Y){var za=!1,Va=H.command;switch(Va){case 37023044:za=this.r$c(Y,H);break;case 541421805:case -569786022:za=this.Yid(k,H)}return za?qh.Task.Sa(!0):Qg.a(Va)};ge.prototype.Lc=function(k,H,Y){k=!1;switch(H.command){case 37023044:k=!!Y;break;case 541421805:case -569786022:k=!0}return k};ge.prototype.Yid=function(k,H){var Y=8===k,za=this.$,Va=ec.a(za),Pb=Oe.g(za).ha.Oa.oc,Ac=k=null;Y&&Va?(k=
Va.chartId,Ac=Va.$c):!Y&&Pb&&(k=Pb.floatingObject.id,Ac=Pb.floatingObject.$c);return ge.vre(Ac,260)?(Y={},za.Bj(Y),Y.FirstColumn=Y.FirstRow=-1,za={},Ac=(za.rawEvent=null,za.pivotName=null,za.cell=Y,za.requiresConfirmation=ge.vre(Ac,64),za.dataSourceIndex=Ac.ExternalSourceIndex,za),Pb?(Va=Pb.floatingObject,Ac.domElement=Pb.domElement,Ac.objectId=Va.id,Ac.objectVersion=Va.version):Va&&(Ac.domElement=Va.ul,Ac.objectId=Va.chartId,Ac.objectVersion=Va.wxe),Pb={AnchorType:7},Pb.ChartId=k,Pb.AnchorValue1=
-1,Pb.AnchorValue2=-1,Ac.optionalPivotMenuAnchorParameter=Pb,this.r$c(Ac,H)):!1};ge.vre=function(k,H){return(k.Attributes&H)===H};Ek.Object.defineProperties(ge.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.nLf}}});Object(Dd.a)(ge,"PivotFilterContextMenu",pg,[]);var ie=b(1343),Ce=b(1048),af=b(159),ff=b(28),fg=Ea.a.Z1g,Ig=fg+".RemoveField",ah=fg+".Subtotal",bh=fg+".ClearFilter",me=fg+".LayoutSameColumn",
$e=fg+".LayoutNextColumn",Kh=xh.a;Am(Mc,Kh);Mc.prototype.executeCommand=function(k,H,Y){H=H.command;k=null;this.grid=Oe.g(this.$);this.activeCell=ve.o(this.grid.ha.sa.activeCell,this.$);if(this.$.isEditMode&&(this.Fc=this.grid.Rb.jp(this.grid.ha.sa.activeCell),!this.Fc))return nc.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),Uf.TaskExtensions.L4();this.z_d=this.$.na.ua;this.w0a=Object(Pa.a)(kc.a,Y.eventArgs);switch(H){case 671488277:this.hxj()?this.YTh():(this.Kbb(),this.showPivotTableContextMenu());
break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,
5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.LRa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.LRa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.LRa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.LRa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);
break;case 282586693:this.LRa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.LRa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:Y=Number.parseInvariant(Y.MenuItemId.split(".")[2]);this.LRa(11,Y);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Xd(-1556797033,Re.a.Ub,8,null);break;case 1514686611:this.Iqi();
break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:Y=Number.parseInvariant(Y.MenuItemId);this.bYg(Y);break;case 1778578888:Y=Number.parseInvariant(Y.MenuItemId);this.aKg(Y);break;default:k=Qg.a(H)}return k||Uf.TaskExtensions.L4()};Mc.prototype.Lc=function(k,H){k=!1;switch(H.command){case 671488277:k=Ce.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:k=!0;break;case 1600778266:k=!0;break;case -556893687:k=!0;break;case -1966978671:k=
!0;break;case -1951357930:k=!0;break;case -1390365353:case -1457478532:k=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:k=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:k=!0;break;case -1007663920:case 234234584:case 1194992911:k=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:k=
!0}return k};Mc.prototype.hxj=function(){if(!this.$.isEditMode||this.Fc.ugc)return!1;var k=this.s1f(!1);return Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?!this.Fc.isOlap||k:!this.Fc.Dpd()||k};Mc.prototype.Zc=function(k,H){var Y=!1;switch(H){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:Y=this.BS();break;case -1007663920:case 234234584:Y=
this.Jvj()||this.BS();break;case 1194992911:Y=this.Kvj()||this.BS();break;case 1217404289:Y=!ie.j(this.Db.LabelOrDateFilterType)||this.BS();break;case -743135194:Y=!ie.m(this.Db.ValueFilterType)&&!ie.l(this.Db.ValueFilterType)||this.BS();break;case 771421327:Y=0===this.Db.LabelOrDateFilterType&&0===this.Db.ValueFilterType&&!this.Db.HasManualFilter||this.BS();break;case 1015867427:Y=!ie.i(this.Db.LabelOrDateFilterType)||this.BS();break;case 1105960559:Y=!ie.k(this.Db.LabelOrDateFilterType)||this.BS()}return Y||
Kh.prototype.Zc.call(this,k,H)};Mc.prototype.Kbb=function(){this.aab=this.Db=this.$f=null};Mc.prototype.mUd=function(){this.grid.LP(this.Tq);this.$.Ka.KFa(this.qu)};Mc.prototype.UXd=function(){this.grid.cL(this.Tq);this.$.Ka.obb(this.qu)};Mc.prototype.pKb=function(){if(this.Fc&&this.Fc.Uo){this.$f=this.Fc.Uo;this.Db=this.Fc.Sac();if(this.f2f()){var k=this.Fc.kL[4===this.$f.CellType?this.Fc.n5c-1:this.$f.CurrentFieldIndex-1];k&&(this.aab=-2===k.Index?this.Fc.QFe:k.Caption)}this.P9h();this.Db&&8===
this.$f.CellArea&&(this.hA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.Db.DataFieldAggregationType,this.hA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.Db.DataFieldFormatType,this.hA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.Db.BaseFieldIndex,this.hA.PivotValueFieldTitle=this.Db.Caption)}};Mc.prototype.s1f=function(k){return this.Fc?this.Fc.isOlap&&!this.Fc.u7a(!k):!1};Mc.prototype.Rvj=function(){var k=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",
!1);return 1!==this.Db.MeasureType&&(!this.Fc.Jff||k&&2===this.Db.MeasureType)};Mc.prototype.iZ=function(){var k=this.Ra.Yp(this.menuId),H=this.Ra.Pc();if(this.Fc)this.$f&&this.Fc.Uo&&this.$f!==this.Fc.Uo&&nc.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.Db&&this.Db!==this.Fc.Sac()&&nc.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return k;this.pFh(k);if(this.$.isEditMode){this.refresh&&
this.EGh(k);if(this.$f&&this.Db){var Y=this.Ra.Pc();this.TGh(Y);this.EFh(Y);k.Ec.push(Y)}this.zZ&&H.buttons.push(this.Ra.Bb(99));this.$f&&this.Db&&this.aGh(k);if(this.expandCollapse){Y=this.Ra.ww("ContextMenu.PivotExpandCollapse",null,Ae.a.instance.fa(1133),589118293);var za=this.Ra.Pc();za.buttons.push(this.Ra.Bb(243));za.buttons.push(this.Ra.Bb(244));za.buttons.push(this.Ra.Bb(245));za.buttons.push(this.Ra.Bb(246));Y.menu.Ec.push(za);Y&&0<za.buttons.length&&H.buttons.push(Y)}this.$f&&this.FGh(k);
this.$f&&this.Db&&8===this.$f.CellArea&&8!==this.$f.CellType&&(Y=this.Ra.Pc(),this.Rvj()&&this.VGh(Y),3!==this.$f.CellType&&this.QGh(Y),k.Ec.push(Y));!this.Fc.isOlap&&this.$f&&0===this.$f.CellType&&Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.PGh(k);this.kki()?H.buttons.push(this.Ra.Bb(257)):H.buttons.push(this.Ra.Bb(258));this.wod?H.buttons.push(this.Ra.Bb(59)):H.buttons.push(this.Ra.Bb(58))}k.Ec.push(H);return k};Mc.prototype.zRd=function(){return this.Db&&
this.Db.Caption?20<this.Db.Caption.length:!1};Mc.prototype.ked=function(k){return this.Db&&this.Db.Caption?k?this.Db.Caption.substring(0,20)+"...":this.Db.Caption:""};Mc.prototype.mva=function(k){return Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?S.a.hashCode(k).toString():k};Mc.prototype.TGh=function(k){if(this.$f&&this.Db&&4!==this.$f.CellArea){var H=this.Pua(this.vH("PivotTableContextMenu.Sort",this.mva(this.Db.Caption)),-1777747317,0,0!==this.Db.SortInfo,
Ae.a.instance.fa(228)),Y=this.Ra.Pc();Y.buttons.push(this.ie("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.Db.SortInfo,Ae.a.instance.fa(229)));Y.buttons.push(this.ie("PivotTableContextMenu.SortDescending",234234584,0,2===this.Db.SortInfo,Ae.a.instance.fa(230)));1!==this.$f.CellArea&&2!==this.$f.CellArea||Y.buttons.push(this.ie("PivotTableContextMenu.SortByValue",1194992911,0,3===this.Db.SortInfo||4===this.Db.SortInfo,Ae.a.instance.fa(155)));H.menu.Ec.push(Y);H&&0<Y.buttons.length&&
k.buttons.push(H)}};Mc.prototype.EFh=function(k){if(this.$f&&this.Db&&(1===this.$f.CellArea||2===this.$f.CellArea)){var H=this.gxj(),Y=this.Pua(this.vH("PivotTableContextMenu.Filter",this.mva(this.Db.Caption)),-1777747317,0,H,Ae.a.instance.fa(653)),za=this.Ra.Pc(),Va="",Pb=this.zRd(),Ac=String.format(Ae.a.instance.Ab(156),this.ked(Pb));Pb&&(Va=String.format(Ae.a.instance.Ab(156),this.Db.Caption));H=this.mva(this.Db.Caption)+"."+(H?"enabled":"disabled");Va=this.ie(this.vH(bh,H),771421327,0,!1,Ac,"0",
Va,8,A.a.s2a);H=this.mva(this.Db.Caption)+"."+this.Db.LabelOrDateFilterType.toString();this.Db.IsDateField?(Ac=this.Pua(this.vH("PivotTableContextMenu.DateFilter",H),-1777747317,0,0!==this.Db.LabelOrDateFilterType,Ae.a.instance.fa(96)),this.sFh(Ac.menu)):(Ac=this.Pua(this.vH("PivotTableContextMenu.LabelFilter",H),-1777747317,0,0!==this.Db.LabelOrDateFilterType,Ae.a.instance.fa(651)),this.$Fh(Ac.menu));H=this.mva(this.Db.Caption)+"."+this.Db.ValueFilterType.toString();H=this.Pua(this.vH("PivotTableContextMenu.ValueFilter",
H),-1777747317,0,0!==this.Db.ValueFilterType,Ae.a.instance.fa(652));this.gHh(H.menu);Pb=this.Ra.Pc();Pb.buttons.push(this.ie("PivotTableContextMenu.ManualFilter",1514686611,0,this.Db.HasManualFilter,Ae.a.instance.fa(93)));za.buttons.push(Va);za.buttons.push(Ac);za.buttons.push(H);Y.menu.Ec.push(za);Y.menu.Ec.push(Pb);Y&&0<za.buttons.length&&k.buttons.push(Y)}};Mc.prototype.sFh=function(k){k.Ec.push(this.nbc(!0,!1));k.Ec.push(this.vMh());k.Ec.push(this.uMh());k.Ec.push(this.nOh());k.Ec.push(this.qOh());
k.Ec.push(this.oOh());k.Ec.push(this.pOh());k.Ec.push(this.rOh());k.Ec.push(this.sOh());k.Ec.push(this.iMh())};Mc.prototype.hFh=function(k){k.Ec.push(this.nbc(!0,!0));k.Ec.push(this.UUh());k.Ec.push(this.lSh())};Mc.prototype.$Fh=function(k){k.Ec.push(this.nbc(!0,!1));k.Ec.push(this.IYe(!0));k.Ec.push(this.SIh());k.Ec.push(this.sLh());k.Ec.push(this.JXe(!0));k.Ec.push(this.QWe(!0))};Mc.prototype.gHh=function(k){k.Ec.push(this.nbc(!1,!1));k.Ec.push(this.IYe(!1));k.Ec.push(this.JXe(!1));k.Ec.push(this.QWe(!1));
k.Ec.push(this.qZh())};Mc.prototype.qZh=function(){var k=this.Ra.Pc();k.buttons.push(this.ie("PivotTableContextMenu.Top10",-1611233597,0,ie.l(this.Db.ValueFilterType),Ae.a.instance.fa(104)));return k};Mc.prototype.sLh=function(){var k=this.Ra.Pc();this.Db&&(k.buttons.push(this.ie("PivotTableContextMenu.Contains",786260386,0,10===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(654),"10")),k.buttons.push(this.ie("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(655),
"11")));return k};Mc.prototype.SIh=function(){var k=this.Ra.Pc();this.Db&&(k.buttons.push(this.ie("PivotTableContextMenu.BeginsWith",786260386,0,6===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(656),"6")),k.buttons.push(this.ie("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(657),"7")),k.buttons.push(this.ie("PivotTableContextMenu.EndsWith",786260386,0,8===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(658),"8")),k.buttons.push(this.ie("PivotTableContextMenu.DoesNotEndWith",
786260386,0,9===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(659),"9")));return k};Mc.prototype.IYe=function(k){var H=this.Ra.Pc();if(this.Db){var Y=k?ie.c:ie.f;H.buttons.push(this.ie(this.vH("PivotTableContextMenu.Equals",Y),786260386,0,k?4===this.Db.LabelOrDateFilterType:18===this.Db.ValueFilterType,Ae.a.instance.fa(99),k?"4":"18"));H.buttons.push(this.ie(this.vH("PivotTableContextMenu.DoesNotEqual",Y),786260386,0,k?5===this.Db.LabelOrDateFilterType:19===this.Db.ValueFilterType,Ae.a.instance.fa(100),
k?"5":"19"))}return H};Mc.prototype.JXe=function(k){var H=this.Ra.Pc();if(this.Db){var Y=k?ie.c:ie.f;H.buttons.push(this.ie(this.vH("PivotTableContextMenu.GreaterThan",Y),786260386,0,k?12===this.Db.LabelOrDateFilterType:20===this.Db.ValueFilterType,Ae.a.instance.fa(101),k?"12":"20"));H.buttons.push(this.ie(this.vH("PivotTableContextMenu.GreaterThanOrEqualTo",Y),786260386,0,k?13===this.Db.LabelOrDateFilterType:21===this.Db.ValueFilterType,Ae.a.instance.fa(660),k?"13":"21"));H.buttons.push(this.ie(this.vH("PivotTableContextMenu.LessThan",
Y),786260386,0,k?14===this.Db.LabelOrDateFilterType:22===this.Db.ValueFilterType,Ae.a.instance.fa(102),k?"14":"22"));H.buttons.push(this.ie(this.vH("PivotTableContextMenu.LessThanOrEqualTo",Y),786260386,0,k?15===this.Db.LabelOrDateFilterType:23===this.Db.ValueFilterType,Ae.a.instance.fa(661),k?"15":"23"))}return H};Mc.prototype.QWe=function(k){var H=this.Ra.Pc();if(this.Db){var Y=k?ie.c:ie.f;H.buttons.push(this.ie(this.vH("PivotTableContextMenu.Between",Y),786260386,0,k?16===this.Db.LabelOrDateFilterType:
24===this.Db.ValueFilterType,Ae.a.instance.fa(103),k?"16":"24"));H.buttons.push(this.ie(this.vH("PivotTableContextMenu.NotBetween",Y),786260386,0,k?17===this.Db.LabelOrDateFilterType:25===this.Db.ValueFilterType,Ae.a.instance.fa(662),k?"17":"25"))}return H};Mc.prototype.nbc=function(k,H){var Y=this.Ra.Pc();if(this.Db){var za=Ae.a.instance.fa(97),Va=k?this.Db.LabelOrDateFilterType.toString():this.Db.ValueFilterType.toString(),Pb=["PivotTableContextMenu.ClearFilter",this.mva(this.Db.Caption),Va];k=
k?this.Db.IsDateField?H?1015867427:1105960559:1217404289:-743135194;Pb.push(k.toString());Pb=Pb.join(".");za=this.ie(Pb,k,0,!1,za,Va,za,8,A.a.s2a);Y.buttons.push(za)}return Y};Mc.prototype.vMh=function(){var k=this.Ra.Pc();this.Db&&k.buttons.push(this.ie(this.vH("PivotTableContextMenu.Equals",ie.d),786260386,0,26===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(99),"26"));return k};Mc.prototype.uMh=function(){var k=this.Ra.Pc();this.Db&&(k.buttons.push(this.ie("PivotTableContextMenu.Before",786260386,
0,27===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(111),"27")),k.buttons.push(this.ie("PivotTableContextMenu.After",786260386,0,28===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(112),"28")),k.buttons.push(this.ie("PivotTableContextMenu.Between",786260386,0,29===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(103),"29")));return k};Mc.prototype.nOh=function(){var k=this.Ra.Pc();this.Db&&(k.buttons.push(this.ie("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(109),
"30")),k.buttons.push(this.ie("PivotTableContextMenu.Today",1778578888,0,31===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(108),"31")),k.buttons.push(this.ie("PivotTableContextMenu.Yesterday",1778578888,0,32===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(110),"32")));return k};Mc.prototype.qOh=function(){var k=this.Ra.Pc();this.Db&&(k.buttons.push(this.ie("PivotTableContextMenu.NextWeek",1778578888,0,33===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(114),"33")),k.buttons.push(this.ie("PivotTableContextMenu.ThisWeek",
1778578888,0,34===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(113),"34")),k.buttons.push(this.ie("PivotTableContextMenu.LastWeek",1778578888,0,35===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(115),"35")));return k};Mc.prototype.oOh=function(){var k=this.Ra.Pc();this.Db&&(k.buttons.push(this.ie("PivotTableContextMenu.NextMonth",1778578888,0,36===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(116),"36")),k.buttons.push(this.ie("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.Db.LabelOrDateFilterType,
Ae.a.instance.fa(117),"37")),k.buttons.push(this.ie("PivotTableContextMenu.LastMonth",1778578888,0,38===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(118),"38")));return k};Mc.prototype.pOh=function(){var k=this.Ra.Pc();this.Db&&(k.buttons.push(this.ie("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(119),"39")),k.buttons.push(this.ie("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(120),"40")),
k.buttons.push(this.ie("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(121),"41")));return k};Mc.prototype.rOh=function(){var k=this.Ra.Pc();this.Db&&(k.buttons.push(this.ie("PivotTableContextMenu.NextYear",1778578888,0,42===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(122),"42")),k.buttons.push(this.ie("PivotTableContextMenu.ThisYear",1778578888,0,43===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(123),"43")),k.buttons.push(this.ie("PivotTableContextMenu.LastYear",
1778578888,0,44===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(124),"44")));return k};Mc.prototype.sOh=function(){var k=this.Ra.Pc();if(this.Db){k.buttons.push(this.ie("PivotTableContextMenu.YearToDate",1778578888,0,45===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(125),"45"));var H=this.Pua("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,ie.i(this.Db.LabelOrDateFilterType),Ae.a.instance.fa(126));this.hFh(H.menu);k.buttons.push(H)}return k};Mc.prototype.iMh=function(){var k=this.Ra.Pc();
this.Db&&k.buttons.push(this.ie("PivotTableContextMenu.CustomFilter",786260386,0,this.dxj(this.Db.LabelOrDateFilterType),Ae.a.instance.fa(107),"26"));return k};Mc.prototype.UUh=function(){var k=this.Ra.Pc();this.Db&&(k.buttons.push(this.ie("PivotTableContextMenu.Quarter1",1778578888,0,46===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(127),"46")),k.buttons.push(this.ie("PivotTableContextMenu.Quarter2",1778578888,0,47===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(128),"47")),k.buttons.push(this.ie("PivotTableContextMenu.Quarter3",
1778578888,0,48===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(129),"48")),k.buttons.push(this.ie("PivotTableContextMenu.Quarter4",1778578888,0,49===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(130),"49")));return k};Mc.prototype.lSh=function(){var k=this.Ra.Pc();this.Db&&(k.buttons.push(this.ie("PivotTableContextMenu.January",1778578888,0,50===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(131),"50")),k.buttons.push(this.ie("PivotTableContextMenu.February",1778578888,0,51===this.Db.LabelOrDateFilterType,
Ae.a.instance.fa(132),"51")),k.buttons.push(this.ie("PivotTableContextMenu.March",1778578888,0,52===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(133),"52")),k.buttons.push(this.ie("PivotTableContextMenu.April",1778578888,0,53===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(134),"53")),k.buttons.push(this.ie("PivotTableContextMenu.May",1778578888,0,54===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(135),"54")),k.buttons.push(this.ie("PivotTableContextMenu.June",1778578888,0,55===this.Db.LabelOrDateFilterType,
Ae.a.instance.fa(136),"55")),k.buttons.push(this.ie("PivotTableContextMenu.July",1778578888,0,56===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(137),"56")),k.buttons.push(this.ie("PivotTableContextMenu.August",1778578888,0,57===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(138),"57")),k.buttons.push(this.ie("PivotTableContextMenu.September",1778578888,0,58===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(139),"58")),k.buttons.push(this.ie("PivotTableContextMenu.October",1778578888,0,59===this.Db.LabelOrDateFilterType,
Ae.a.instance.fa(140),"59")),k.buttons.push(this.ie("PivotTableContextMenu.November",1778578888,0,60===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(141),"60")),k.buttons.push(this.ie("PivotTableContextMenu.December",1778578888,0,61===this.Db.LabelOrDateFilterType,Ae.a.instance.fa(142),"61")));return k};Mc.prototype.aGh=function(k){var H=this.Ra.Pc();if(this.f2f()){var Y=this.Fc.kL[4===this.$f.CellType?this.Fc.n5c-1:this.$f.CurrentFieldIndex-1];if(Y&&this.aab){var za=this.Ra.ww("ContextMenu.PivotTableLayout",
null,Ae.a.instance.fa(649),-1777747317);var Va=this.Ra.Pc(),Pb=String.format(Ae.a.instance.Ab(161),this.aab),Ac=String.format(Ae.a.instance.Ab(162),this.aab);Va.buttons.push(this.ie($e,-1457478532,0,!Y.IsCompactLayout,Pb));Va.buttons.push(this.ie(me,-1390365353,0,Y.IsCompactLayout,Ac));za.menu.Ec.push(Va);za&&H.buttons.push(za)}}if(1===this.$f.CellArea||2===this.$f.CellArea)this.Db.Caption&&(Y="",Va=this.zRd(),za=String.format(Ae.a.instance.Ab(159),this.ked(Va)),Va&&(Y=String.format(Ae.a.instance.Ab(159),
this.Db.Caption)),1===this.$f.CellArea?(Y=this.Pua("ContextMenu.PivotTableSubtotal",1801458190,0,this.Db.ShowSubtotal,za),za=this.Ra.Pc(),za.buttons.push(this.Ra.Bb(259)),za.buttons.push(this.ie("ContextMenu.PivotTableSubtotalOnTop",671485366,641,this.Db.ShowSubtotal&&this.Db.ShowSubtotalAtTop)),za.buttons.push(this.ie("ContextMenu.PivotTableSubtotalOnBottom",772221736,642,this.Db.ShowSubtotal&&!this.Db.ShowSubtotalAtTop)),Y.menu.Ec.push(za),Y&&0<za.buttons.length&&H.buttons.push(Y)):(Va=Va?this.vH(ah,
this.mva(za)):ah,H.buttons.push(this.ie(Va,1801458190,0,this.Db.ShowSubtotal,za,null,Y)))),H.buttons.push(this.ie("ContextMenu.RepeatItemLabels",-556893687,644,this.Db.RepeatItemLabels));1===this.$f.CellArea&&H.buttons.push(this.ie("ContextMenu.PivotBlankLineAfterEachItem",1600778266,643,this.Db.ShowBlankLineAfterEachItem));k.Ec.push(H)};Mc.prototype.PGh=function(k){var H=this.Ra.Pc();H.buttons.push(this.Ra.Bb(247));k.Ec.push(H)};Mc.prototype.FGh=function(k){var H="",Y="",za=!1;3===this.$f.CellType?
H=Ae.a.instance.fa(646):8===this.$f.CellType?this.Fc&&(H=String.format(Ae.a.instance.Ab(160),this.Fc.QFe)):this.Db&&((za=this.zRd())&&(Y=String.format(Ae.a.instance.Ab(160),this.Db.Caption)),H=String.format(Ae.a.instance.Ab(160),this.ked(za)));if(H){var Va=this.Ra.Pc();za=za?this.vH(Ig,this.mva(H)):Ig;H=this.ie(za,-1951357930,0,!1,H,null,Y,8,A.a.P9c);Va.buttons.push(H);k.Ec.push(Va)}};Mc.prototype.pFh=function(k){var H=this.Ra.Pc();H.buttons.push(this.Ra.Bb(43));this.Db&&this.$f&&this.$.isEditMode&&
(0===this.$f.CellType||4===this.$f.CellType)&&H.buttons.push(this.Ra.Bb(136));k.Ec.push(H)};Mc.prototype.EGh=function(k){var H=this.Ra.Pc();H.buttons.push(this.Ra.Bb(100));k.Ec.push(H)};Mc.prototype.VGh=function(k){var H=2===this.Db.MeasureType&&!this.Db.IsNumeric,Y=this.Ra.ww("ContextMenu.SummarizeValuesBy",null,Ae.a.instance.fa(647),-249874296),za=this.Ra.Pc();za.buttons.push(this.ie("ContextMenu.SummarizeValuesBySum",-1255320719,1072,0===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,
void 0,H));za.buttons.push(this.ie("ContextMenu.SummarizeValuesByCount",1746132849,1073,1===this.Db.DataFieldAggregationType));za.buttons.push(this.ie("ContextMenu.SummarizeValuesByAverage",-771066011,1074,2===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,H));za.buttons.push(this.ie("ContextMenu.SummarizeValuesByMax",835007294,1075,3===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,H));za.buttons.push(this.ie("ContextMenu.SummarizeValuesByMin",929115636,
1076,4===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,H));za.buttons.push(this.ie("ContextMenu.SummarizeValuesByProduct",1935475057,1077,5===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.s1f(!0)||H));2!==this.Db.MeasureType&&(za.buttons.push(this.ie("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1078,6===this.Db.DataFieldAggregationType)),za.buttons.push(this.ie("ContextMenu.SummarizeValuesByStdDeviation",588680636,1079,7===this.Db.DataFieldAggregationType)),
za.buttons.push(this.ie("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1080,8===this.Db.DataFieldAggregationType)),za.buttons.push(this.ie("ContextMenu.SummarizeValuesByVariant",1668427539,1081,9===this.Db.DataFieldAggregationType)),za.buttons.push(this.ie("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1082,10===this.Db.DataFieldAggregationType)));this.Fc&&this.Fc.Dpd()&&za.buttons.push(this.ie("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1083,11===this.Db.DataFieldAggregationType));
Y.menu.Ec.push(za);k.buttons.push(Y)};Mc.prototype.QGh=function(k){var H=this.Ra.ww("ContextMenu.ShowValuesAs",null,Ae.a.instance.fa(648),-1128612833),Y=this.Ra.Pc();Y.buttons.push(this.ie("ContextMenu.ShowValuesAsNoCalculation",-841863025,1089,0===this.Db.DataFieldFormatType));Y.buttons.push(this.ie("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1096,7===this.Db.DataFieldFormatType));Y.buttons.push(this.ie("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1095,6===this.Db.DataFieldFormatType));
Y.buttons.push(this.ie("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1094,5===this.Db.DataFieldFormatType));Y.buttons.push(this.ie("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1099,9===this.Db.DataFieldFormatType));Y.buttons.push(this.ie("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1100,10===this.Db.DataFieldFormatType));if(this.Fc&&this.Fc.kL&&0<this.Fc.kL.length||this.Fc.G$&&0<this.Fc.G$.length){for(var za=this.Pua("ContextMenu.ShowValuesAsPercentOfParentTotal",
-1128612833,1101,11===this.Db.DataFieldFormatType),Va=this.Ra.Pc(),Pb=this.UGh(),Ac=0;Ac<Pb.length;Ac++){var id=Pb[Ac];Va.buttons.push(this.ie("ContextMenu.ShowValuesAsPercentOfParentTotal."+id.Caption,-2031744961,1101,11===this.Db.DataFieldFormatType&&this.Db.BaseFieldIndex===id.Index,id.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+id.Index))}za.menu.Ec.push(Va);Y.buttons.push(za)}H.menu.Ec.push(Y);k.buttons.push(H)};Mc.prototype.showPivotTableContextMenu=function(){this.wod=!0;this.expandCollapse=
this.zZ=this.refresh=!1;var k=this.$,H=Oe.g(k),Y=mg.a(k).uKa();if(Y){var za=ab.a(k);if(null===za||void 0===za?0:za.RQd)this.wod=la.f(k.kg);za=k.xc;this.zZ=Y.supportsBIExplore&&!!qf.a(k)&&za.U2(32768);za.allowInteractivity&&(k=H.kc(null),(null===k||void 0===k?0:k.cell)&&(k.cell.NZc||k.cell.c2f)&&(this.expandCollapse=!0),za.allowManualDataRefresh&&(this.refresh=!0))}k=null;Y=1;this.w0a&&1!==this.w0a.yb?(k=new Sys.UI.Point(this.w0a.clientPoint.x,this.w0a.clientPoint.y),Y=this.w0a.yb):(H=Ce.e(H,this.$))&&
(k=new Sys.UI.Point(H.x+(this.$.isChromeRtl?0:H.width),H.y+H.height));Re.a.Ub=Y;this.xic=3===Y;this.Ip(k,!0,Y);this.Cba=!0;this.mUd()};Mc.prototype.d6h=function(){var k=new vh.a(1114549926,0,this.$.ed,19,null);this.$.Ka.Xb(k)};Mc.prototype.YTh=function(){var k=this;if(this.Fc&&this.Fc.Uo){var H=this.Fc.Uo.CurrentCol;if(this.Fc.Uo.CurrentRow===this.activeCell.FirstRow&&H===this.activeCell.FirstColumn){this.pKb();this.showPivotTableContextMenu();return}}H=new Ed.a(228,0,function(Y,za,Va){return Jg.C(k.$.na.ua,
k.activeCell,Rg.b(Y,k.mLi),Rg.a(za,k.lLi),Va,null)},16);this.$.userOperationManager.ic(H,null)};Mc.prototype.kki=function(){if(ee.a.Ld(this.$)){var k=this.$.da.Aa(441);if(k)return k.ds}else if(k=this.$.da.Aa(346))return k.ds;return!1};Mc.prototype.vH=function(k,H){return k+"."+H};Mc.prototype.performPivotTableOperation=function(k,H){var Y=this,za=ff.a.Ta.Wb;if(!this.Fc||!this.Db&&this.$f&&3!==this.$f.CellType)this.si();else{var Va=this.Fc.isOlap;mg.a(this.$).Sx(Va,function(Pb){Pb&&Y.$.ic(k,function(Ac,
id,Ld){var ld=Y.z_d,ef=Y.activeCell,Jf=Y.Db?Y.Db.Caption:null,Kg=Y.aab;Ac=Rg.b(Ac,Y.YOi);id=Rg.a(id,Y.XOi);var Cg=Y.$.na.ua.hc();Cg=ld.Na(41,void 0===Cg?null:Cg);Cg.activeCell=ef;Cg.operationType=H;Cg.fieldCaption=Jf;Cg.prevFieldCaption=Kg;return Jg.i(ld,"ExecutePivotTableOperation",Cg,Ac,id,Ld,null,0)},za,0,4,229)})}};Mc.prototype.applyValueFieldSettingsToPivotTable=function(k,H){var Y=this;H=void 0===H?!1:H;var za=ff.a.Ta.Wb;this.Fc&&this.Db?(H&&2===this.Db.MeasureType&&nc.ULS.sendTraceTag(537167002,
0,50,"change aggregation type for an implicit measure from right click context menu."),H=this.Fc.isOlap,mg.a(this.$).Sx(H,function(Va){Va&&Y.$.ic(k,function(Pb,Ac,id){var Ld=Y.z_d,ld=Y.activeCell,ef=Y.hA;Pb=Rg.b(Pb,Y.RFi);Ac=Rg.a(Ac,Y.QFi);var Jf=Y.$.na.ua.hc();Jf=Ld.Na(41,void 0===Jf?null:Jf);Jf.activeCell=ld;Jf.pivotValueFieldSettingsApplyData=ef;return Jg.i(Ld,"ApplyValueFieldSettingsToPivotTable",Jf,Pb,Ac,id,null,0)},za,0,4,231)})):this.si()};Mc.prototype.ie=function(k,H,Y,za,Va,Pb,Ac,id,Ld,ld){Va=
void 0===Va?null:Va;Pb=void 0===Pb?null:Pb;Ac=void 0===Ac?null:Ac;id=void 0===id?8:id;Ld=void 0===Ld?null:Ld;ld=void 0===ld?!1:ld;za&&(k+=".Checked");ld&&(k+=".Disabled");this.Ra.mnd(k)&&this.Ra.uId(k);Y=Va||Ae.a.instance.fa(Y);k=this.Ra.GHa(k,Y,H,null,"None",Pb,ld,null);k.$vc(null);Ac&&k.xS(Ac);za?k.zS("Image16by16",3,A.a.maa):Ld?k.zS("Image16by16",id,Ld):k.B2b();return k};Mc.prototype.Pua=function(k,H,Y,za,Va){Y=(void 0===Va?null:Va)||Ae.a.instance.fa(Y);this.Ra.mnd(k)?this.Ra.uId(k):this.Ra.uId(k+
".Checked");za&&(k+=".Checked");this.tvj&&(Y=this.fhh.parseFromString(Y,"text/html").body.innerText);k=this.Ra.v3c(k,null,Y,H,3,A.a.maa);k.j9e=za;!za&&Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&k.B2b();return k};Mc.prototype.P9h=function(){this.hA=Object(ag.a)(new hh,{PivotValueFieldSummarizeValueByApplyData:Object(ag.a)(new od,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(ag.a)(new gf,{SelectedDataFormat:-1,SelectedBaseField:-1,
SelectedBaseItem:-1}),PivotValueFieldTitle:null})};Mc.prototype.LRa=function(k,H){this.hA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=k;this.hA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=H;this.hA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1};Mc.prototype.UGh=function(){var k=[];if(this.Fc&&this.Fc.G$&&0<this.Fc.G$.length)for(var H=El(this.Fc.G$),Y=H.next();!Y.done;Y=H.next())(Y=Y.value)&&k.push(Y);if(this.Fc&&this.Fc.kL&&0<this.Fc.kL.length)for(H=El(this.Fc.kL),Y=
H.next();!Y.done;Y=H.next())(Y=Y.value)&&k.push(Y);k.sort(function(za,Va){return za.Index-Va.Index});return k};Mc.prototype.f2f=function(){if(!this.$f||!this.Fc||!this.Fc.kL)return!1;var k=1===this.$f.CellArea||4===this.$f.CellType&&this.$f.IsRowAxis,H=4===this.$f.CellType?0<this.Fc.n5c:0<this.$f.CurrentFieldIndex;return 1<this.Fc.kL.length&&k&&H};Mc.prototype.gKa=function(k){var H=[];3===k?this.$.isEditMode?Array.addRange(H,[tb.a.mGf,tb.a.oGf,tb.a.FXi]):Array.addRange(H,[tb.a.copy]):2===k&&H.push(tb.a.Xwe);
return H};Mc.prototype.si=function(){var k=he.a.gd(1,0,0,650,0,104573951,"PivotTableContextMenuOperationFailure");Zi.a(this.$).si(k)};Mc.prototype.gxj=function(){return this.Db?0!==this.Db.LabelOrDateFilterType||0!==this.Db.ValueFilterType||this.Db.HasManualFilter:!1};Mc.prototype.dxj=function(k){return 62<=k&&65>=k};Mc.prototype.Iqi=function(){if(this.activeCell&&this.Db&&this.Fc){var k={};k.cell=this.activeCell;k.dataSourceIndex=this.Fc.externalSourceIndex;k.fieldId=this.Db.Index.toString();k.isOlap=
this.Fc.isOlap;k.confirmationRequired=this.Fc.confirmationRequiredForDataOps;this.$.Xd(492140419,Re.a.Ub,19,{showPivotFilterDialogCommandData:k})}};Mc.prototype.bYg=function(k){var H=this;this.activeCell&&this.Db&&this.Fc&&this.$.userOperationManager.ic(new Ed.a(153,0,function(Y,za,Va){return Jg.X(H.$.na.ua,H.activeCell,H.Fc.externalSourceIndex,H.Db.Index.toString(),k,Y,za,Va,null,null)}),null)};Mc.prototype.aKg=function(k){var H=this;!(30>k||61<k)&&this.activeCell&&this.Db&&this.Fc&&this.$.userOperationManager.ic(new Ed.a(152,
0,function(Y,za,Va){return Jg.g(H.$.na.ua,H.activeCell,H.Fc.externalSourceIndex,H.Db.Index.toString(),k,Y,za,Va,null,null)}),null)};Mc.prototype.applyPivotSort=function(k){var H=this;if(this.Fc&&this.Db&&this.activeCell&&this.$f){var Y=1===this.$f.CellArea||2===this.$f.CellArea;8===this.$f.CellArea?zg.a(this.$.userOperationManager,function(za,Va,Pb){return Jg.e(H.$.na.ua,H.activeCell,k,H.Db.Caption,za,Va,Pb,null)},function(za){return new Ed.a(1015,0,za,void 0,null)},null):Y&&(Y=1===this.$f.CellArea?
1:2,this.$.ma(701)?af.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Fc.externalSourceIndex,this.Db.Index.toString(),this.Db.Caption,this.Fc.isOlap?"":this.Db.Caption,Y,1===k):af.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Fc.externalSourceIndex,this.Db.Index.toString(),1===k))}};Mc.prototype.BS=function(){return!this.Fc||!this.Fc.isActionable&&Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadOnlyPivotTable",
!1)};Mc.prototype.Jvj=function(){return(this.$f||this.Fc)&&4!==this.$f.CellType&&(0!==this.$f.CellType||8!==this.$f.CellArea||this.Fc.G$&&this.Fc.G$.length||this.Fc.kL&&this.Fc.kL.length)?!1:!0};Mc.prototype.Kvj=function(){return this.$f&&this.Fc&&(1===this.$f.CellArea||2===this.$f.CellArea)&&this.Fc.TOb&&this.Fc.TOb.length?!1:!0};Ek.Object.defineProperties(Mc.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.oLf}}});
Object(Dd.a)(Mc,"PivotTableContextMenu",xh.a,[]);wd.prototype.compare=function(k,H){return(k||"").localeCompare(H||"",void 0,{numeric:!0,sensitivity:"accent"})};Object(Dd.a)(wd,"DigitsAsNumberComparer",null,[818]);var Ph=b(272),Tf=Ea.a.a2g,Qi=xh.a;Am(Lc,Qi);Lc.prototype.executeCommand=function(k,H,Y){k=H.command;switch(k){case 639960842:this.applyTableFieldList(Y);this.gO.wda();break;case -1085236154:Y=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",
this.Kyd);nc.ULS.sendTraceTag(537166999,0,50,Y);this.gO.wda();break;case 1833782813:this.gO.showCallout();break;default:return Qg.a(k)}return qh.Task.Sa(!0)};Lc.prototype.applyTableFieldList=function(k){var H=k.MenuItemId.toString();Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(H=H.replace("'","''"),H=H.replace("[","'["),H=H.replace("]","']"));var Y=Object(Pa.a)(String,k.SourceControlId),za={};za.PulloutField=H;za.PulloutCardPath=k.SourceCardKeyPath;
za.PulloutCardSourceRow=k.SourceCardRow;za.PulloutCardSourceColumn=k.SourceCardColumn;if(this.gO.oN){nc.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");za.ParameterType=2;k=k.ColumnIndex;if(void 0===k||null===k){if(void 0===Y||null===Y){nc.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");return}k=0<=this.gO.sJf?this.gO.sJf:parseInt(Y.substring(20+H.length+1,Y.length),10);if(isNaN(k)){H=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",
Y);nc.ULS.shipAssertTag(537166997,0,!1,H);return}}za.PulloutRichColumnSourceIndex=k;if(this.yVb.DHg){this.rIg(H,za);return}}else nc.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),za.ParameterType=4,Y=this.gO.selectedRange.right,void 0!==za.PulloutCardSourceColumn&&null!==za.PulloutCardSourceColumn&&(Y=za.PulloutCardSourceColumn+1),za.PulloutRichColumnSourceIndex=Y;this.DOd(H,za)};Lc.prototype.DOd=function(k,H,Y){Y=void 0===Y?0:Y;var za=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",
this.Kyd,H.PulloutRichColumnSourceIndex);nc.ULS.sendTraceTag(537166996,0,50,za);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",H.ParameterType,H.PulloutRichColumnSourceIndex);k=Object(ag.a)(new Ph.a,{Text:k});this.grid.setCell(k,this.gO.eya,0,127,H,Y);this.grid.focus();this.q5b=null;this.gO.wda();this.gO.Gfj()};Lc.prototype.Lc=function(k,H,Y){if(k=this.$.isEditMode&&Ke.EwaSettings.ma(136)&&!!this.gO)switch(H.command){case -1085236154:break;
case 639960842:k=!!Y;break;case 1833782813:k=this.gO.rwa&&this.gO.xBb;break;default:k=!1}return k};Lc.prototype.Q0=function(k,H,Y){this.$.isEditMode&&(this.q5b=this.iGh(Object(Pa.a)(798,Y)),Qi.prototype.Q0.call(this,k,H,null,null,!1))};Lc.prototype.iZ=function(){return this.q5b};Lc.prototype.u3c=function(k){if(!this.gO||!k||!k.Nk)return nc.ULS.shipAssertTag(537166994,0,!!this.gO,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),nc.ULS.shipAssertTag(537166993,0,!!k,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),
k&&nc.ULS.shipAssertTag(537166992,0,!!k.Nk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;var H=new rb.a;k=El(k.Nk);for(var Y=k.next();!Y.done;Y=k.next()){var za=Y.value;Y=new rb.a;Y.add(za.ColumnName);Y.add(za.ColumnIndex.toString());var Va=new rb.a,Pb=null;Pb=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new wd:new Rf;Va=ja.OBc(ja.concat(Va,ja.select(ja.asEnumerable(za.FieldInfoDataList),
function(Ac){return Ac.Name})),function(Ac){return Ac},Pb);za=new rb.a;za.add(ja.toArray(ja.concat(Y,Va)));H=ja.toList(ja.concat(H,za))}return ja.toArray(H)};Lc.prototype.iGh=function(k){var H=this.u3c(k);if(!H||!H.length)return this.q5b=null;var Y=this.Ra;k=Y.Pc();var za=1<H.length;this.Kyd=H.length;H=El(H);for(var Va=H.next();!Va.done;Va=H.next()){var Pb=Va.value;za||(k.title=Pb[0]);Va=Y.Pc();for(var Ac=2,id=Pb.length;Ac<id;++Ac)(za?Va.buttons:k.buttons).push(Y.GHa("ApplyTableFieldList."+Pb[Ac]+
"."+Pb[1],Pb[Ac],639960842,null,"None",Pb[Ac],!1,void 0,!0));za&&(Pb=Y.ww("ApplyTableFieldList."+Pb[0],this.menuId,Pb[0],798637440),Pb.menu.Ec.push(Va),k.buttons.push(Pb))}Y=Y.Yp(this.menuId);Y.Ec.push(k);return Y};Lc.prototype.rIg=function(k,H){var Y=this,za=he.a.gd(12,1,0,894,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(Ke.EwaSettings.Iz()){var Va=new ni.a(this.$,za);Va.MP(function(){2===Va.returnValue&&Y.DOd(k,H,8)})}else{var Pb=new lg.ErrorDialog(this.$,za);Pb.MP(function(){2===Pb.returnValue&&
Y.DOd(k,H,8)});Pb.kf()}};Ek.Object.defineProperties(Lc.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.qLf}},gO:{configurable:!0,enumerable:!0,get:function(){this.yVb||(this.yVb=this.$.da.Aa(261));return this.yVb}}});Object(Dd.a)(Lc,"PulloutFieldListContextMenu",xh.a,[]);var T=Ea.a.sLf,ra=xh.a;Am(ac,ra);ac.prototype.Lc=function(k,H,Y){return-1687037502===H.command&&!!Y&&this.grid.isEditing};
ac.prototype.executeCommand=function(k,H,Y){this.showRichTextFloatie(Y);return qh.Task.Sa(!0)};ac.prototype.gKa=function(){return[tb.a.tVg]};ac.prototype.showRichTextFloatie=function(k){var H=Object(Pa.a)(kc.a,k.eventArgs);H&&(k=this.gKa(H.yb),H=new Sys.UI.Point(H.Ca.clientX,H.Ca.clientY),this.showFloatie(k,new Sys.UI.Bounds(H.x,H.y,0,0),2))};Ek.Object.defineProperties(ac.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},JB:{configurable:!0,enumerable:!0,
get:function(){return Ea.a.sLf}}});Object(Dd.a)(ac,"RichTextContextMenu",xh.a,[]);var hb=b(99),Eb=Ea.a.$1g,sc=xh.a;Am(Of,sc);Of.prototype.executeCommand=function(k,H,Y){if(qe.a(this.$))return qh.Task.Sa(!0);this.$.isEditMode&&(k=Y[Ea.a.V0f],k=k.x&&k.y?new Sys.UI.Point(k.x+(this.$.isChromeRtl?10:-10),k.y):Kc.DOMElementExtensions.getLocation(Y[Ea.a.W0f]),this.Ip(k,!1));return qh.Task.Sa(!0)};Of.prototype.Lc=function(k,H,Y){return-1075099431===H.command&&!!Y};Of.prototype.iZ=function(){var k=this.Ra.Yp(this.menuId),
H=this.$.isEditMode;this.ASj();this.WFh(k,H);this.MFh(k);this.OGh(k);return k};Of.prototype.$Yb=function(k,H,Y,za){k.push(this.Ra.Bb(H?Y:za))};Of.prototype.WFh=function(k,H){var Y=this.Ra,za=Y.Pc();za.buttons.push(Y.Bb(54));this.$Yb(za.buttons,this.lic,127,56);za.buttons.push(Y.Bb(55));H&&this.$Yb(za.buttons,this.lic,126,125);za.buttons.push(Y.Bb(158));this.$.ea.$Kb&&this.$.ya.ExcelSheetProtectionSettingsEnabled&&(H=Object(Pa.a)(hb.a,this.$.qa))&&Yf.p(H)&&this.$.isEditMode&&(za.buttons.push(Y.Bb(277)),
H.isLockPausedInSession?za.buttons.push(Y.Bb(279)):H.uj&&za.buttons.push(Y.Bb(278)));H=Y.ww("ContextMenu.TabColor",null,Ae.a.instance.fa(520),1841703919);Y=Y.r3c(467002767,1549407384,543,-221093529,this.JB);H.menu.Ec.push(Y);za.buttons.push(H);k.Ec.push(za)};Of.prototype.MFh=function(k){var H=this.Ra.Pc();this.$Yb(H.buttons,this.lic,114,112);this.$Yb(H.buttons,!this.Mgc,115,113);k.Ec.push(H)};Of.prototype.OGh=function(k){if(Ke.EwaSettings.ma(486)&&!Yf.e(this.$.xa.qa)){var H=this.Ra,Y=H.Pc();Y.buttons.push(H.Bb(263));
k.Ec.push(Y)}};Of.prototype.ASj=function(){var k=this.$.d3c();var H=k.e3c;k=k.yCe;this.lic=1===H;this.Mgc=0<k};Ek.Object.defineProperties(Of.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.tLf}}});Object(Dd.a)(Of,"SheetOpsContextMenu",xh.a,[]);var vb=b(565),Wc=xh.a;Am(Me,Wc);Me.prototype.Zc=function(k,H){var Y=!0;switch(H){case -231711729:Y=!1;break;case -1909381757:Y=this.ncc();Y=!!Y&&Y.lhi;
break;case 1312363469:Y=!0}return!Y||Wc.prototype.Zc.call(this,k,H)};Me.prototype.executeCommand=function(k,H,Y){if(!this.$.isEditMode)return Uf.TaskExtensions.L4();k=H.command;H=this.ncc();var za=null;switch(k){case 2108047455:H&&H.Sye();break;case -231711729:nc.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:H&&H.K2b();break;case 1312363469:this.showSlicerContextMenu(Y);break;default:za=Qg.a(k)}return za||Uf.TaskExtensions.L4()};Me.prototype.Lc=
function(k,H,Y){k=!1;switch(H.command){case -231711729:case 2108047455:case -1909381757:k=!0;break;case 1312363469:k=!!Y}return k};Me.prototype.iZ=function(){var k=this.Ra.Yp(this.menuId),H=this.Ra.Pc();H.buttons.push(this.Ra.Bb(252));H.buttons.push(this.Ra.Bb(253));H.buttons.push(this.Ra.Bb(254));k.Ec.push(H);H=this.Ra.Pc();this.smi()?H.buttons.push(this.Ra.Bb(266)):H.buttons.push(this.Ra.Bb(267));k.Ec.push(H);return k};Me.prototype.smi=function(){if(ee.a.Ld(this.$)){var k=this.$.da.Aa(439);if(k)return k.ds}else if(k=
this.$.da.Aa(371))return k.ds;return!1};Me.prototype.showSlicerContextMenu=function(k){var H=Object(Pa.a)(kc.a,k.eventArgs);k=this.Oac(Object(Pa.a)(kc.a,k.eventArgs));H=H.yb;Re.a.Ub=H;this.Ip(k,!1,H)};Me.prototype.WVe=function(k){var H=this.Ra.Pc(),Y=this.Ra.Pc();Y.buttons.push(this.Ra.Bb(255));Y.buttons.push(this.Ra.Bb(256));var za=this.Ra.v3c("ContextMenu.SlicerSort",null,Ae.a.instance.fa(2129),-814639094,0,A.a.WOe);za.menu.Ec.push(Y);H.buttons.push(za);k.Ec.push(H)};Me.prototype.wxj=function(k){return Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&
k.Lb.className===A.a.x9c||Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===k.yb};Me.prototype.Oac=function(k){var H=Oe.g(this.$).ha.Oa.oc,Y=k&&1!==k.yb&&k.clientPoint?k.clientPoint:Sys.UI.DomElement.getLocation(H.domElement);if(this.wxj(k)){var za=this.ncc();za&&(k.Lb.className===A.a.x9c&&(Y=$c.HelperMethods.avb(k.Ca)),1===k.yb&&(Y=Dc.a(this.$).Aja(Kc.DOMElementExtensions.getLocation(za.frame))))}else if(k=this.ncc())k=this.nPh(k.frame),(za=$c.HelperMethods.QC(this.$.Lf,
this.$.domElement,Oe.g(this.$).rtl,!1))?(k.x=Dc.a(this.$).Ei(k.x-za.x)+za.x,k.y=Dc.a(this.$).Ei(k.y-za.y)+za.y):nc.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),Y.y+=k.y,Y.x+=k.x;k=this.$.domElement;za=Oe.g(this.$).rtl;H=$c.HelperMethods.QC(H.mg.domElement,k,za);Y.y=Math.max(Y.y,H.y);Y.x=Math.max(Y.x,H.x);return Y};Me.prototype.ncc=function(){var k=Oe.g(this.$).ha.Oa.oc;nc.ULS.shipAssertTag(537166988,0,!!k);return vb.a(this.$).EH(k.floatingObject.id)};Me.prototype.nPh=function(k){var H=
new Sys.UI.Point(k.offsetParent.offsetLeft,k.offsetParent.offsetTop),Y=Oe.g(this.$);if(!Y)return H;var za=Oe.g(this.$).rtl;H=$c.HelperMethods.QC(k,this.$.kr.ownerDocument.body,za);Y.pCe(H);H.x=za?this.$.kr.clientWidth-H.x-k.clientWidth:H.x;k=Y.view.bpb;Y=za?-Y.tS.mca(k.x):k.x;H.x-=Y;H.y-=k.y;return H};Ek.Object.defineProperties(Me.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},JB:{configurable:!0,enumerable:!0,get:function(){return Ea.a.uLf}}});Object(Dd.a)(Me,
"SlicerContextMenu",xh.a,[]);Object(Dd.a)(vg,"TimeSlicerRibbonButtonParameter",null,[]);var Zd=xh.a;Am(fh,Zd);fh.prototype.executeCommand=function(k,H,Y){k=H.command;switch(k){case 2000085697:k=Y.DOMElement;this.Hsa=Y.ChangeLevelCallback;this.oKa=Y.GetLevelLabelCallback;this.S0a=Y.CurrentLevel;var za=Y.DomEvent;ci.g(za);var Va=Y.location;Y=Y.levelLabelText;this.ZJe=Kc.DOMElementExtensions.Fz(document.activeElement,"iframe")&&Y?Y.parentNode:null;Y=Sys.UI.DomElement.getBounds(Y);Y.x=Va.x;Y.y=Va.y;this.Q0(za,
k,Y,H,!0);break;case -649826274:this.Hsa(0);break;case 149600865:this.Hsa(1);break;case -2012435159:this.Hsa(2);break;case -1979934975:this.Hsa(3);break;case 1634477200:Kc.DOMElementExtensions.setFocus(this.ZJe);break;default:return Qg.a(k)}return qh.Task.Sa(!0)};fh.prototype.Lc=function(k,H,Y){k=!1;switch(H.command){case 2000085697:k=!!Y;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:k=!0}return k};fh.prototype.Q0=function(k,H,Y){k=Sys.UI.DomElement.getBounds(H);
Y.x=Dc.a(this.$).Ei(Y.x);Y.y=Dc.a(this.$).Ei(Y.y);k.x=Dc.a(this.$).Ei(k.x);k.y=Dc.a(this.$).Ei(k.y);k=new Sys.UI.Point(k.x+Y.x,k.y+Y.y);this.HTa(k,H);this.showContextMenu(new Sys.UI.Bounds(k.x,k.y-Y.height,Y.width,Y.height))};fh.prototype.iZ=function(){for(var k=this.Ra,H=k.Yp(this.menuId),Y=k.Pc(),za=0;3>=za;za++){var Va=this.oKa(za),Pb=fh.EJh(za);Pb=k.X3g(Pb.Y1g,Pb.Er,this.S0a===za,fh.Xxe);Pb.label=Va;Pb.xS(Va);this.S0a===za?Pb.zS("Image16by16",8,fh.Xxe):Pb.B2b();Y.buttons.push(Pb)}H.Ec.push(Y);
return H};fh.EJh=function(k){var H=null;switch(k){case 0:H=new vg(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:H=new vg(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:H=new vg(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:H=new vg(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return H};Ek.Object.defineProperties(fh.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},JB:{configurable:!0,enumerable:!0,
get:function(){return Ea.a.xLf}}});fh.JIj=Ea.a.b2g;fh.bJb="TimeSlicerLevelMenuRootName";fh.Xxe=A.a.uua;Object(Dd.a)(fh,"TimeSlicerLevelMenu",xh.a,[]);var uf=b(327),If=b(3),ng=oc.a;Am(dh,ng);dh.prototype.Nd=function(){var k=this,H=this.$,Y=lf.a.OHa(Wb.b(),this.la,"Task","IRootUser"),za=Gi.a(H),Va=null;Va=function(id,Ld){za.ZPf(Va);Y.setResult(Ld.X3b)};za.Fne(Va);za.v0e();var Pb=rf.GetServiceTaskFactory.create(H.da,102,H.la,this.ub),Ac=rf.GetServiceTaskFactory.Va(H.da,342,338,this.ub);Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([Y.task,
Pb,Ac],this.la),function(){var id=Pb.result,Ld=Y.task.result,ld=Ac.result;k.Cd([new hg(H,Ld,id,ld),new ue(H,Ld,id,ld),new td(H,Ld,id,ld),new Dg(H,Ld,id,ld),new nf(H,Ld,id,ld),new He(H,Ld,id,ld),new sd.GridContextMenu(H,Ld,id,ld),new ge(H,Ld,id,ld),new Of(H,Ld,id,ld),new fh(H,Ld,id,ld),new Lc(H,Ld,id,ld),new bf(H,Ld,id,ld),new Mc(H,Ld,id,ld),new Me(H,Ld,id,ld),new ac(H,Ld,id,ld)])},H.la,3)};dh.initData=function(){var k=uf.a.C2;k(2000085697,20479,0,0);k(-227942804,If.a.Mc|24576,0,0);k(1634477200,If.a.Mc|
131072,0,0);k(-649826274,4095,0,0);k(149600865,4095,0,0);k(-2012435159,4095,0,0);k(-1979934975,4095,0,0);k(1247109494,If.a.Mc|24576,0,0);k(-2064931494,If.a.Mc|131072,0,0);k(-1396319072,If.a.Ia,128,0);k(-425234874,If.a.Ia,128,0);k(-1253126584,If.a.Ia,0,0);k(274207288,If.a.Mc|24576,0,0);k(-1497523576,If.a.Mc|131072,0,0);k(-498523270,If.a.Mc|24576,64,0);k(1640762262,If.a.Mc|131072,64,0);k(-2017893763,If.a.Mc|24576,0,0);k(1350204367,If.a.Mc|131072,0,0);k(-889576107,If.a.qw,128,0);k(-1170196828,If.a.qw,
128,0);k(389774337,If.a.qw,128,0);k(1529312473,If.a.qw,128,0);k(2033235475,If.a.qw,128,0);k(-96230454,If.a.qw,128,0);k(74086617,If.a.qw,128,0);k(563292088,If.a.qw,128,0);k(-1092351914,If.a.qw,128,0);k(-2141589616,If.a.qw|16384,128,0);k(745182485,If.a.qw,0,0);k(359279088,If.a.qw,128,0);k(-67292059,If.a.qw,128,0);k(926905850,If.a.qw,128,0);k(547535945,If.a.qw,128,0);k(1374696078,If.a.Mc|24576,0,0);k(495005930,If.a.Mc|212992,0,0);k(-1045020714,If.a.Mc|24576,0,0);k(-170383950,If.a.Mc|212992,0,0);k(324156914,
If.a.Ia,0,0);k(-1085236154,If.a.Yu,0,0);k(-751848458,If.a.ol|16384,0,0);k(216058793,If.a.Yu,0,0);k(474690375,If.a.ol|16384,0,0);k(-1920954846,If.a.Mc|24576,0,0);k(723126814,If.a.Mc|131072,0,0);k(2108047455,128,128,0);k(-231711729,128,128,0);k(-1909381757,128,128,0);k(-814639094,128,128,0);k(1701016594,If.a.Mc|3072,128,0);k(-1475408662,If.a.Mc|24576,0,0);k(1114549926,If.a.Mc|131072,32,0)};dh.ka=function(k){oc.a.fe(10,new dh(k))};Object(Dd.a)(dh,"ContextMenuCommandHandlerFactory",oc.a,[]);var gg=b(228),
Wh=b(1435),di=b(93),uj=b(262);rg.prototype.dispose=function(){};rg.prototype.baa=function(){this.Vqb.O3()};rg.prototype.IC=function(){this.Vqb.IC()};rg.prototype.RRd=function(k,H,Y){Ce.h(this.$,Ce.b);this.Vqb.showContextMenu(Object(ag.a)(new Wh.a,{x:H.x,y:H.y}),Y,k);di.EventHandlerManager.instance.Dbd()};rg.prototype.Pxc=function(k,H,Y){Ce.h(this.$,Ce.b);this.Vqb.showFloatie(Object(ag.a)(new Wh.a,{x:H.x,y:H.y}),k,Y);uj.a(function(){di.EventHandlerManager.instance.Dbd()},this.$.la)};rg.prototype.QRd=
function(k,H,Y,za){Ce.h(this.$,Ce.b);this.Vqb.QRd(Object(ag.a)(new Wh.a,{x:H.x,y:H.y}),k,Y,za)};Object(Dd.a)(rg,"ReactContextMenuController",null,[794,3]);var qj=gg.a;Am(Cf,qj);Cf.prototype.dispose=function(){this.Y9e&&this.$&&this.$.ea.Wn(this.Hld);qj.prototype.dispose.call(this)};Cf.prototype.create=function(){this.$.ea.sh?(nc.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.ea.sh),this.Hld(null,null)):(this.Y9e=!0,
this.$.ea.Fl(this.Hld))};Cf.ka=function(k){k.da.Ga(338,new Cf(k))};Object(Dd.a)(Cf,"ContextMenuControllerFactory",gg.a,[]);var Ag=b(160);Object(Dd.a)(Gg,"RibbonCommandParams",null,[]);Object(Dd.a)(ug,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);Wf.prototype.QJh=function(k){return(k=this.Ldc[k.toString()])?k.menuModel:null};Wf.prototype.ESg=function(k,H){this.Ldc[H.toString()]=Object(ag.a)(new ug,{menuModel:k,dFe:$c.HelperMethods.$b()})};Wf.prototype.y7b=function(k){this.Ldc[k.toString()]=null};
Wf.prototype.hZh=function(k){return(k=this.Ldc[k.toString()])?k.dFe:-1};Object(Dd.a)(Wf,"FilterMenuCache",null,[]);var Eg=b(13),Jj=b(195),Fi=b(230);Object(Dd.a)(wf,"AutoFilterEventRegistrationArgs",null,[]);var mj=b(25);vf.prototype.dispose=function(){window.cancelAnimationFrame(this.yBb);this.gridView&&this.gridView.Psc(this.tEb);this.gridView=null};vf.prototype.X8h=function(){if(this.hRd=$c.HelperMethods.P6a)this.HZa=[];this.RBg();this.gridView.vZb(this.tEb)};vf.prototype.RBg=function(){for(var k=
El(this.gridView.yn),H=k.next();!H.done;H=k.next()){H=H.value.XBa;for(var Y in H){var za=H[Y];this.TJf(za.domElement,za.hashCode)}}};vf.prototype.TJf=function(k,H){if(Oe.g(this.$).Ea.sm.C1a(H))if(k){k=k.querySelectorAll('[id^="'+Ea.a.pad+'"]');for(var Y=0;Y<k.length;Y++){var za=k[Y],Va=za.getAttribute(Ea.a.iAh),Pb=za.getAttribute(Ea.a.aAh);nc.ULS.shipAssertTag(537167053,0,!!Va&&!!Pb,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",
za.id,H);Va=mj.Range.hd(parseInt(Va,10),parseInt(Pb,10));za=Object(ag.a)(new wf,{cell:Va,Ose:za,ae:H});this.hRd?(this.HZa.push(za),this.yBb||(this.oMe=window.performance.now(),this.yBb=window.requestAnimationFrame(this.INf))):this.Vle(za)}}else nc.ULS.sendTraceTag(537167054,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",H);else nc.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",
H)};vf.prototype.Vle=function(k){var H=this.gridView.Ea.$3a(k.cell,k.ae);H?this.QBg(k.Ose,H):nc.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",k.ae,k.cell)};vf.prototype.QBg=function(k,H){H.hasAutoFilter?this.Szg(k,H.nad):H.V4?this.OBg(k,H.nad,H.gff):nc.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");
Ag.a.instance.pa(Eg.a.Kf,k,this.onPointerDown);Jj.a.instance.pa(Eg.a.$xa,k,this.onPointerDown)};vf.prototype.Szg=function(k,H){Fi.a.instance.pa(Eg.a.click,k,function(Y){H&&af.a.hrc(Y.Ca.rawEvent,966232027,H,null);return!0})};vf.prototype.OBg=function(k,H,Y){var za=Xd.a.mi(H);Fi.a.instance.pa(Eg.a.click,k,function(Va){Y?af.a.spf(document.getElementById(za.EwaElementId),za.Cell,za.DataSourceIndex,za.FieldId,za.IsOlap,za.RequiresConfirmation,Va.Ca.rawEvent,za.OptionalPivotMenuAnchor):af.a.spfm(Va.Ca.rawEvent,
za.RequiresConfirmation,za.Cell,za.DataSourceIndex,za.PivotName,za.OptionalPivotMenuAnchor);return!1})};Object(Dd.a)(vf,"FilterMenuPointerEventsManager",null,[3]);Ze.prototype.dispose=function(){Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.ISe.dispose();this.$=null};Ze.prototype.YPh=function(k){var H=Oe.g(this.$).Ea.k$(k,this.$.activeItemName);return H&&H.blockPresentInViewportTimeStamp>this.M8a.hZh(k.left)?
H.hs(k).autoFilterMenu:this.M8a.QJh(k.left)};Ze.prototype.dMi=function(k,H,Y){this.M8a&&this.M8a.ESg(k.menuModel[H],Y)};Ze.prototype.eMi=function(k){this.M8a&&this.M8a.y7b(k)};Object(Dd.a)(Ze,"FilterMenuManager",null,[793,3]);var Xh=b(234),Dj=b(183);Td.prototype.Ddd=function(k){return Ih.a.Nc(this.oyc,k)};Td.prototype.dispose=function(){this.Od?nc.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Od=!0,this.$&&(this.$.Sl(Td.zd),this.$.da.ZU(8),
this.ha&&this.ha.Hsc(this.xl),this.$.Ka.obb(this.rvf),Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.Mza(this.JN),Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.x0(this.o6)),this.$=this.ha=null,this.I9b.dispose(),this.oyc=this.w6d=null)};Td.prototype.showContextMenu=function(k,H,Y){H=void 0===H?null:H;Y=void 0===Y?null:Y;this.cxj(k)&&(Ce.h(this.$,Ce.i),k=this.g5g(k,
H,Y),this.$.Ka.Xb(k.Rd,k.dictionary))};Td.prototype.O3=function(){this.contextMenuController?this.contextMenuController.baa():nc.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};Td.prototype.cxj=function(k){return Zi.a(this.$).Mq()?(nc.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),Zi.a(this.$).o0(Dj.a.grid,Xh.a.showContextMenu),!1):!this.$.Ka.vxh&&
(!k||k.Lb!==Oe.g(this.$).domElement&&!S.a.equals(k.Lb.tagName,"INPUT",!0))};Td.prototype.g5g=function(k,H,Y){H=void 0===H?null:H;var za={};Y=(za.eventArgs=k,za.creationParams=void 0===Y?null:Y,za);k=k?k.yb:-1;za=this.ha.Oa.oc;var Va=1441131127;za?(H=za.floatingObject,nc.ULS.shipAssertTag(537167059,0,!!H,"floatingObj shouldn't be null."),Td.Wqd(H)?Va=1312363469:Td.isPivotChart(H)?(Y[ue.T_c]=H?H.$c:null,Va=-149612405):Va=-1372040782):Td.fff(H)?(Y[ue.T_c]=H,Va=-149612405):!Ce.g(this.$)&&Ce.f(Oe.g(this.$))&&
(Va=671488277);H=new vh.a(Va,k,this.$.ed,30,null);return Object(ag.a)(new Gg,{Rd:H,dictionary:Y})};Td.ka=function(k){k.nl(Td.zd)};Td.isPivotChart=function(k){return!!k&&0===k.type&&Td.fff(k.$c)};Td.Wqd=function(k){return!!k&&2===k.type};Td.fff=function(k){return!!k&&!!(k.Attributes&4)};Ek.Object.defineProperties(Td.prototype,{I9b:{configurable:!0,enumerable:!0,get:function(){return this.w6d}}});Td.c2g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Td.V0h="GridContextMenu";Td.zd=function(k){(k=Object(Pa.a)(6,k))&&rf.GetServiceTaskFactory.create(k.da,9,k.la,0)};Object(Dd.a)(Td,"ContextMenuManager",null,[763,3]);var vk=gg.a;Am(Od,vk);Od.prototype.create=function(){var k=this,H=this.$,Y=H.xc;if(Y.allowSelection||Y.allowEdits||Y.allowFiltering||Y.allowSorting||Y.allowPivotSpecificOperations){var za=rf.GetServiceTaskFactory.create(H.da,10,H.la,this.ub),Va=rf.GetServiceTaskFactory.Va(H.da,342,338,this.ub);Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([za,
Va],this.la),function(){k.Eb(ua.a(H)||new Td(H,za.result,Va.result))},this.$.la,3)}else nc.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),H.da.ZU(8),this.Eb(null)};Od.ka=function(k){k.da.Ga(9,new Od(k))};Object(Dd.a)(Od,"ContextMenuManagerFactory",gg.a,[]);dc.prototype.isEqual=function(k){return k?this.o5===k.o5&&this.p5===k.p5&&this.ZN===k.ZN&&this.$N===k.$N&&this.KB===k.KB&&this.ruleType===k.ruleType&&
this.f_===k.f_&&this.kU===k.kU&&this.jU===k.jU&&this.TV===k.TV&&this.nF===k.nF&&this.D5===k.D5&&this.E5===k.E5:(nc.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(Dd.a)(dc,"DataValidationEditDialogState",null,[]);Rb.prototype.Zc=function(){return!1};Rb.prototype.executeCommand=function(k,H){-1728432249!==H.command&&Qg.a(H.command);this.selectedRanges=ve.r(Oe.g(this.$).ha.sa.selectedRanges,this.$);Oe.g(this.$).kSa(!0);this.getDataValidationInitialState();
this.kh=this.$.Ob.Gc("UserAction","DataValidationEditTimeToDialogOpen");this.GJe?nc.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(nc.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.GJe=!0);return qh.Task.Sa(!0)};Rb.prototype.Lc=function(k,H){return-1728432249===H.command};Rb.prototype.jd=function(){return!1};Rb.prototype.getDataValidationInitialState=function(){var k=this,H=this.$.na.ua.hc();zg.a(this.$.userOperationManager,
function(Y,za,Va){return Jg.u(k.$.na.ua,k.selectedRanges,Rg.b(Y,k.uKi),Rg.a(za),Va,H)},function(Y){return new Ed.a(120,0,Y,16)},null)};Rb.prototype.s_i=function(){var k=this.SB={};switch(this.b1a.Command){case 0:var H="CreateNew";break;case 1:H="CreateNewFromRule";break;case 2:H="ExpandExisitng";break;case 3:H="OverrideExisitng";break;default:H="Unknown"}k.a=H;this.kh&&(this.kh.stop(),this.SB.r=this.kh.id);switch(this.b1a.Command){case 0:this.SB.b=!1;this.SB.c="None";this.HHa(new dc);break;case 1:this.SB.b=
!1;this.SB.c="None";this.HHa(new dc(this.b1a));break;case 2:this.SB.b=!0;this.q5c.f4g(this.$,this.Cxh);break;case 3:this.SB.b=!0;this.q5c.h4g(this.$,this.rVi);break;default:nc.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};Rb.prototype.HHa=function(k){this.q5c.HHa(this.$,this.selectedRanges,k,this.b1a.Command);this.awi(k)};Rb.prototype.awi=function(k){Rb.ksb(k,this.SB);this.SB.d=!0;Wb.b().Qe(48,this.SB,!0)};Rb.prototype.wmf=function(){this.SB.d=
!1;Wb.b().Qe(48,this.SB,!0)};Rb.prototype.cX=function(k,H){var Y={};k=(Y.ButtonType=Rb.kia(H),Y.DialogName=k,Y.Location="dialog",Y.NumberOfSelectedRanges=Oe.g(this.$).ha.sa.JK,Y);ph.b(this.$).Vd(yf.a.v6b,k)};Rb.ksb=function(k,H){H.e=uc(k.ruleType);H.f=Bd(k.KB);H.g=!!k.ZN;H.h=!!k.$N;H.i=k.o5;H.j=k.p5;H.k=k.E5;H.l=!!k.nF;H.m=!!k.TV;H.n=k.D5;H.o=k.f_;H.p=!!k.kU;H.q=!!k.jU};Rb.kia=function(k){switch(k){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return nc.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(Dd.a)(Rb,"DataValidationEditCommandHandler",null,[429]);var Hj=b(1008),xk;(function(k){k[k.between=0]="between";k[k.notBetween=1]="notBetween";k[k.equal=2]="equal";k[k.notEqual=3]="notEqual";k[k.greaterThan=4]="greaterThan";k[k.lessThan=5]="lessThan";k[k.greaterThanOrEqual=6]="greaterThanOrEqual";k[k.lessThanOrEqual=7]="lessThanOrEqual"})(xk||(xk={}));Object(Dd.b)("DataValidationRuleConditionType",
xk);var Xj;(function(k){k[k.anyValue=0]="anyValue";k[k.wholeNumber=1]="wholeNumber";k[k.decimal=2]="decimal";k[k.list=3]="list";k[k.date=4]="date";k[k.time=5]="time";k[k.textLength=6]="textLength";k[k.custom=7]="custom"})(Xj||(Xj={}));Object(Dd.b)("DataValidationRuleType",Xj);var Yj=b(149),mi=b(179);Ek.Object.defineProperties(fb,{gg:{configurable:!0,enumerable:!0,get:function(){return Yj.a.cp(fb.xk,"")}},oeh:{configurable:!0,enumerable:!0,get:function(){return Yj.a.cp(fb.seh,mi.a.fa(1638),mi.a.fa(1653),
mi.a.fa(1654),mi.a.fa(1655),mi.a.fa(1656),mi.a.fa(1657),mi.a.fa(1658),mi.a.fa(1659),mi.a.fa(1660),mi.a.fa(1639),mi.a.fa(1663),mi.a.fa(1664),mi.a.fa(1665),mi.a.fa(1666),mi.a.fa(1667),mi.a.fa(1668),mi.a.fa(1669),mi.a.fa(1670),mi.a.fa(1640),mi.a.fa(1641),mi.a.fa(1661),mi.a.fa(1662),mi.a.fa(1652),"255")}},veh:{configurable:!0,enumerable:!0,get:function(){return Yj.a.cp(fb.teh,mi.a.fa(1675),mi.a.fa(1679),mi.a.fa(1680),"255","32")}},zeh:{configurable:!0,enumerable:!0,get:function(){return Yj.a.cp(fb.ueh,
mi.a.fa(1674),mi.a.fa(1677),mi.a.fa(1676),mi.a.fa(1678),mi.a.fa(1679),mi.a.fa(1680),"255","32")}}});fb.y8f=255;fb.xk="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";fb.seh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
fb.teh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
fb.ueh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(Dd.a)(fb,"DataValidationEditDialogHtml",null,[]);var th=b(618),Rh=fi.a;Am(oa,Rh);oa.prototype.wAa=function(k){this.lU.selectedIndex=k.ruleType;this.RK.selectedIndex=k.KB;this.Iec.checked=k.p5;this.ewa.checked=k.o5;this.Qya.value=k.ZN;this.Rya.value=k.$N;this.wca(null)};oa.prototype.tpb=function(k){k.o5=this.ewa.checked;k.p5=this.Iec.checked;k.KB=this.RK.selectedIndex;k.ruleType=this.lU.selectedIndex;k.ZN=this.Qya.value;k.$N=this.Rya.value};oa.prototype.dispose=function(){this.vm();this.Bk=
this.BCd=this.bpc=this.hPa=this.q$a=this.HNa=this.B5a=this.Iec=this.Rya=this.Qya=this.RK=this.lU=this.ewa=null;Rh.prototype.dispose.call(this)};oa.prototype.render=function(k){k.appendChild(this.domElement)};oa.prototype.Kja=function(){return this.isVisible};oa.prototype.Ena=function(k){return this.isVisible=k};oa.prototype.setFocus=function(){};oa.prototype.rvb=function(k,H){return this.r0e(k,H,this.JBh)};oa.prototype.Agd=function(k,H){return 0!==H&&1!==H?"":this.r0e(k,H,this.Mkj)};oa.prototype.eka=
function(){this.domElement.innerHTML=fb.oeh;this.ewa=Kc.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.lU=Kc.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.RK=Kc.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Qya=Kc.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Rya=Kc.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.bpc=Kc.DOMElementExtensions.getElementById(this.domElement,
"operatorInputLableId1");this.BCd=Kc.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.B5a=Kc.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.HNa=Kc.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.q$a=Kc.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.hPa=Kc.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.Iec=Kc.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownCheckboxId");this.Ck()};oa.prototype.r0e=function(k,H,Y){return Y.length<k||Y[k].length<H?(nc.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",k,H),""):this.yR.oa(Y[k][H])};oa.prototype.Ck=function(){th.a.instance.pa(Eg.a.Yb,this.lU,this.vnc);th.a.instance.pa(Eg.a.Yb,this.RK,this.vnc);th.a.instance.pa(Eg.a.change,this.lU,this.wca);th.a.instance.pa(Eg.a.change,this.RK,this.wca);th.a.instance.pa(Eg.a.change,
this.RK,this.Bk);th.a.instance.pa(Eg.a.change,this.lU,this.Bk);th.a.instance.pa(Eg.a.change,this.Qya,this.Bk);th.a.instance.pa(Eg.a.Yb,this.Qya,this.Bk);th.a.instance.pa(Eg.a.change,this.Rya,this.Bk);th.a.instance.pa(Eg.a.Yb,this.Rya,this.Bk)};oa.prototype.vm=function(){th.a.instance.za(Eg.a.Yb,this.lU,this.vnc);th.a.instance.za(Eg.a.Yb,this.RK,this.vnc);th.a.instance.za(Eg.a.change,this.lU,this.wca);th.a.instance.za(Eg.a.change,this.RK,this.wca);th.a.instance.za(Eg.a.change,this.RK,this.Bk);th.a.instance.za(Eg.a.change,
this.lU,this.Bk);th.a.instance.za(Eg.a.change,this.Qya,this.Bk);th.a.instance.za(Eg.a.Yb,this.Qya,this.Bk);th.a.instance.za(Eg.a.change,this.Rya,this.Bk);th.a.instance.za(Eg.a.Yb,this.Rya,this.Bk)};oa.hja=function(){var k;return k=new rb.a,k.add("operatorInputId1"),k.add("operatorInputId2"),k};Ek.Object.defineProperties(oa.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return Ae.a.instance.fa(1671)}},y0g:{configurable:!0,enumerable:!0,get:function(){return this.lU.selectedIndex}}});
Object(Dd.a)(oa,"DataValidationEditConditionsControl",fi.a,[833,3,836]);var ih=b(205),vj=Hj.a;Am(fc,vj);fc.prototype.CSd=function(){var k={};k=(k.RuleType=this.Gd.ruleType,k.RuleOperatorType=this.Gd.KB,k.OperatorInput1=this.Gd.ZN,k.OperatorInput2=this.Gd.$N,k.IsIgnoreBlank=this.Gd.o5,k.IsInCellDropDown=this.Gd.p5,k.IsAlertBlocking=this.Gd.f_,k.AlertTitle=this.Gd.kU,k.AlertMessage=this.Gd.jU,k.InputTitle=this.Gd.nF,k.InputMessage=this.Gd.TV,k.IsShowErrorAlert=this.Gd.D5,k.IsShowInputMessage=this.Gd.E5,
k);this.Dc(2,Ae.a.instance.fa(1637));var H={};k=(H[fc.Yx]=this.Cc,H.validateDialogValues=this.CUj,H.RangePickerController=Oe.g(this.$).rg.dcc(),H.isModal=!1,H.bodyProps=k,H);this.initializeAndShow(Ae.a.instance.fa(1636),this.p5c,k);nc.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};fc.prototype.dispose=function(){this.disposed||(vj.prototype.dispose.call(this),this.disposed=!0)};fc.prototype.hja=function(){return oa.hja()};fc.prototype.sMh=function(k,H){var Y=this;return function(za,
Va,Pb){var Ac=k.na.ua.hc();return fe(Y.$.na.ua,Y.selectedRanges,Y.HQg(),Y.G_a(za,Y.Yzd(H)),Rg.a(Va),Pb,Ac)}};fc.prototype.Yzd=function(k){var H=this;return function(Y){nc.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var za;Dh.a(Y)?(nc.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",Y?he.a.Wc(Y.Errors):null),Y.Errors&&1===Y.Errors.length&&((za=H.Odd(Y.Errors[0].MessageId))?
H.ela("OkInvalidByServer",Y.Errors[0].MessageIdName):(H.ela("OkValid","None"),H.hide()),k(za)),nc.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",he.a.Wc(Y.Errors))):H.hide()}};fc.prototype.HQg=function(){var k={};k.Command=this.command;k.RuleType=this.Gd.ruleType;k.ConditionType=this.Gd.KB;k.IsIgnoreBlank=this.Gd.o5;k.IsInCellDropDown=this.Gd.p5;k.LowerBoundary=this.Gd.ZN;k.UpperBoundary=this.Gd.$N;k.IsAlertBlocking=
this.Gd.f_;k.IsShowErrorAlert=this.Gd.D5;k.IsShowInputMessage=this.Gd.E5;k.AlertTitle=this.Gd.kU;k.AlertMessage=this.Gd.jU;k.InputTitle=this.Gd.nF;k.InputMessage=this.Gd.TV;k.ShouldIgnoreFormulaError=this.dNa;return k};fc.prototype.Odd=function(k){switch(k){case 1173235830:return Ae.a.instance.fa(1686);case 43935303:return Ae.a.instance.fa(1687);case -1323438439:return Ae.a.instance.fa(1689);case 2112020473:return Ae.a.instance.fa(1683);case -219503282:return Ae.a.instance.fa(1684);case 1689335445:return Ae.a.instance.fa(1685);
case 2146493810:return Ae.a.instance.fa(1688);case -2104909922:return String.format(Ae.a.instance.Ab(105),this.Vtb,this.dNd);case -869372599:return String.format(Ae.a.instance.Ab(104),this.Vtb);case -1181828368:return Ae.a.instance.fa(1691);case -758480861:return Ae.a.instance.fa(1692);case -13729088:return Ae.a.instance.fa(1693);case -846654055:return Ae.a.instance.fa(1694);case 751854001:return Ae.a.instance.fa(1695);case -453846397:return Ae.a.instance.fa(1696);case 1102013489:return Ae.a.instance.fa(1697);
case 835813260:return Ae.a.instance.fa(1698);case 1577787509:return Ae.a.instance.fa(1699);case 2083564019:return Ae.a.instance.fa(1690);default:nc.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",k.toString())}return null};fc.prototype.Pla=function(){this.ela("Cancel","None")};fc.prototype.cX=function(k){nc.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog {0} was clicked.",1===k?"Ok":"Cancel");var H={};k=(H.ButtonType=
fc.kia(k),H.DialogName=this.Cc,H.Location="dialog",H.NumberOfSelectedRanges=Oe.g(this.$).ha.sa.JK,H);ph.b(this.$).Vd(yf.a.v6b,k)};fc.prototype.ela=function(k,H){var Y={};fc.ksb(this.Gd,Y);Y.o=k;Y.p=H;Y.n=this.ska;this.kh&&(this.kh.stop(),Y.q=this.kh.id);Wb.b().Qe(49,Y,!0)};fc.prototype.Xac=function(k){this.Gd.ruleType=k.RuleType;this.Gd.KB=k.RuleOperatorType;this.Gd.ZN=k.OperatorInput1;this.Gd.$N=k.OperatorInput2;this.Gd.f_=k.IsAlertBlocking;this.Gd.D5=k.IsShowErrorAlert;this.Gd.kU=k.AlertTitle;this.Gd.jU=
k.AlertMessage;this.Gd.E5=k.IsShowInputMessage;this.Gd.nF=k.InputTitle;this.Gd.TV=k.InputMessage;this.Gd.o5=k.IsIgnoreBlank;this.Gd.p5=k.IsInCellDropDown;this.Vtb=k.firstOperatorLabel;this.dNd=k.secondOperatorLabel};fc.prototype.QOb=function(k,H,Y){var za;var Va=za=null;if(!k)return Y?(za=String.format(Ae.a.instance.Ab(105),this.Vtb,this.dNd),Va="DataValidationEditNoMinMaxError"):(za=String.format(Ae.a.instance.Ab(104),this.Vtb),Va="DataValidationEditNoValueError"),{returnValue:!1,errorString:za,
Eq:Va};if(k.length>fb.y8f)return za=Ae.a.instance.fa(1690),{returnValue:!1,errorString:za,Eq:Va};if(ih.d(k))return{returnValue:!0,errorString:za,Eq:Va};if(1===H||2===H||6===H){if(!S.a.u5(k))return za=Ae.a.instance.fa(1683),{returnValue:!1,errorString:za,Eq:Va};if(1===H&&!S.a.isInteger(k))return za=Ae.a.instance.fa(1684),{returnValue:!1,errorString:za,Eq:Va};if(6===H){if(!S.a.isInteger(k))return za=Ae.a.instance.fa(1684),{returnValue:!1,errorString:za,Eq:Va};if(0>parseInt(k,10))return za=Ae.a.instance.fa(1685),
{returnValue:!1,errorString:za,Eq:Va}}}return{returnValue:!0,errorString:za,Eq:Va}};fc.prototype.HZd=function(){var k=this,H;var Y=H=null;var za=this.Gd.ZN,Va=this.Gd.$N,Pb=Xj[this.Gd.ruleType],Ac=xk[this.Gd.KB];if(0===Pb)return{returnValue:!0,errorString:H,Eq:Y};var id=(0===Ac||1===Ac)&&3!==Pb&&7!==Pb;return!function(){var Ld=k.QOb(za,Pb,id);H=Ld.errorString;Y=Ld.Eq;return Ld}().returnValue||id&&!function(){var Ld=k.QOb(Va,Pb,id);H=Ld.errorString;Y=Ld.Eq;return Ld}().returnValue?{returnValue:!1,
errorString:H,Eq:Y}:id&&(1===Pb||2===Pb||6===Pb)&&!ih.d(za)&&!ih.d(Va)&&parseFloat(za)>parseFloat(Va)?(H=Ae.a.instance.fa(1688),Y="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:H,Eq:Y}):{returnValue:!0,errorString:H,Eq:Y}};fc.kia=function(k){switch(k){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return nc.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}};fc.ksb=function(k,H){H.a=uc(k.ruleType);
H.b=Bd(k.KB);H.c=!!k.ZN;H.d=!!k.$N;H.e=k.o5;H.f=k.p5;H.g=k.E5;H.h=!!k.nF;H.i=!!k.TV;H.j=k.D5;H.k=k.f_;H.l=!!k.kU;H.m=!!k.jU};Ek.Object.defineProperties(fc.prototype,{Gd:{configurable:!0,enumerable:!0,get:function(){return this.aSb}},Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},Z1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.Gd.ruleType}}});Object(Dd.a)(fc,"DataValidationEditDialog",Hj.a,[]);var $f=b(323);xd.bbh="DataValidationDialogPanel";xd.abh=
"DataValidationButtonPanel";xd.$ah="DataValidationButtonClearAll";Object(Dd.a)(xd,"CssClassNames",null,[]);var Pf=fi.a;Am(ke,Pf);ke.prototype.render=function(k){k.appendChild(this.domElement)};ke.prototype.Kja=function(){return this.isVisible};ke.prototype.Ena=function(k){return this.isVisible=k};ke.prototype.setFocus=function(){};ke.prototype.dispose=function(){this.vm();this.Bk=this.nba=this.mba=this.J$e=this.lba=null;Pf.prototype.dispose.call(this)};ke.prototype.eka=function(){this.domElement.innerHTML=
fb.veh;this.lba=Kc.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.J$e=Kc.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.nba=Kc.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.mba=Kc.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.lba.checked=!0;this.Ck();this.xnc(null)};ke.prototype.wAa=function(k){this.nba.value=void 0===k.nF||null===k.nF?"":k.nF;this.mba.value=void 0===
k.TV||null===k.TV?"":k.TV;this.lba.checked=k.E5;this.xnc(null)};ke.prototype.tpb=function(k){k.nF=this.nba.value;k.TV=this.mba.value;k.E5=this.lba.checked};ke.prototype.Ck=function(){th.a.instance.pa(Eg.a.change,this.lba,this.xnc);th.a.instance.pa(Eg.a.change,this.lba,this.Bk);th.a.instance.pa(Eg.a.change,this.nba,this.Bk);th.a.instance.pa(Eg.a.Yb,this.nba,this.Bk);th.a.instance.pa(Eg.a.change,this.mba,this.Bk);th.a.instance.pa(Eg.a.Yb,this.mba,this.Bk)};ke.prototype.vm=function(){th.a.instance.za(Eg.a.change,
this.lba,this.xnc);th.a.instance.za(Eg.a.change,this.lba,this.Bk);th.a.instance.za(Eg.a.change,this.nba,this.Bk);th.a.instance.za(Eg.a.Yb,this.nba,this.Bk);th.a.instance.za(Eg.a.change,this.mba,this.Bk);th.a.instance.za(Eg.a.Yb,this.mba,this.Bk)};Ek.Object.defineProperties(ke.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return Ae.a.instance.fa(1673)}}});Object(Dd.a)(ke,"DataValidationEditInputControl",fi.a,[833,3,835]);var Ei=fi.a;Am(le,Ei);le.prototype.render=function(k){k.appendChild(this.domElement)};
le.prototype.Kja=function(){return this.isVisible};le.prototype.Ena=function(k){return this.isVisible=k};le.prototype.setFocus=function(){};le.prototype.dispose=function(){this.vm();this.Bk=this.T9=this.S9=this.iUa=this.mha=this.R9=null;Ei.prototype.dispose.call(this)};le.prototype.eka=function(){this.domElement.innerHTML=fb.zeh;this.R9=Kc.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.mha=Kc.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.iUa=
Kc.DOMElementExtensions.getElementById(this.domElement,"warningId");this.T9=Kc.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.S9=Kc.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.R9.checked=!0;this.mha.checked=!0;this.Ck();this.wnc(null)};le.prototype.wAa=function(k){this.mha.checked=k.f_;this.iUa.checked=!k.f_;this.T9.value=void 0===k.kU||null===k.kU?"":k.kU;this.S9.value=void 0===k.jU||null===k.jU?"":k.jU;this.R9.checked=k.D5;this.wnc(null)};
le.prototype.tpb=function(k){k.kU=this.T9.value;k.jU=this.S9.value;k.f_=this.mha.checked;k.D5=this.R9.checked};le.prototype.Ck=function(){th.a.instance.pa(Eg.a.change,this.R9,this.wnc);th.a.instance.pa(Eg.a.change,this.R9,this.Bk);th.a.instance.pa(Eg.a.change,this.mha,this.Bk);th.a.instance.pa(Eg.a.change,this.iUa,this.Bk);th.a.instance.pa(Eg.a.change,this.T9,this.Bk);th.a.instance.pa(Eg.a.Yb,this.T9,this.Bk);th.a.instance.pa(Eg.a.change,this.S9,this.Bk);th.a.instance.pa(Eg.a.Yb,this.S9,this.Bk)};
le.prototype.vm=function(){th.a.instance.za(Eg.a.change,this.R9,this.wnc);th.a.instance.za(Eg.a.change,this.R9,this.Bk);th.a.instance.pa(Eg.a.change,this.mha,this.Bk);th.a.instance.pa(Eg.a.change,this.iUa,this.Bk);th.a.instance.za(Eg.a.change,this.T9,this.Bk);th.a.instance.za(Eg.a.Yb,this.T9,this.Bk);th.a.instance.za(Eg.a.change,this.S9,this.Bk);th.a.instance.za(Eg.a.Yb,this.S9,this.Bk)};Ek.Object.defineProperties(le.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return Ae.a.instance.fa(1672)}}});
Object(Dd.a)(le,"DataValidationEditMessagesControl",fi.a,[833,3,834]);Object(Dd.a)(Nd,"MacroRecorderRangeDataValidationChangedPayload",null,[445]);var ri=b(67),Qh=$f.a;Am(Nc,Qh);Nc.prototype.CSd=function(){var k={};k=(k.key=this.Gd,k);this.initializeAndShow(Ae.a.instance.fa(1636),this.p5c,k);nc.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};Nc.prototype.dispose=function(){this.disposed||(this.ffc=this.qlc=this.t3=null,kg.a.Ha(this.aDb),this.aDb=null,ph.b(this.$)&&
ph.b(this.$).ZTd("DataValidationDialogCorellation"),Qh.prototype.dispose.call(this),this.disposed=!0)};Nc.prototype.Iv=function(k){Qh.prototype.Iv.call(this,k);this.Dc(2,Ae.a.instance.fa(1637));k=this.xV(2);var H=this.xV(1),Y=this.xV(0),za=H.parentNode;za.appendChild(k);za.appendChild(H);za.appendChild(Y);k.parentNode.classList.add(xd.abh);k.classList.add(xd.$ah);k=document.getElementById("dataValidationTabsId");H=new oa(this.$,document.createElement("div"),this.wca);Y=new ke(document.createElement("div"),
this.wca);za=new le(document.createElement("div"),this.wca);this.Rai(H,Y,za);var Va;this.aDb=new ya(k,(Va=new rb.a,Va.add(H),Va.add(Y),Va.add(za),Va));this.aDb.xQf();this.kV=document.getElementById("validationErrorMessageId");this.wAa();ph.b(this.$)&&ph.b(this.$).LTd("DataValidationDialogCorellation")};Nc.prototype.IO=function(){Qh.prototype.IO.call(this);document.getElementById(this.ni("WACDialogPanel")).classList.add(xd.bbh)};Nc.prototype.hja=function(){return oa.hja()};Nc.prototype.bed=function(){return"validationErrorMessageId"};
Nc.prototype.Rai=function(k,H,Y){this.t3=k;this.ffc=H;this.qlc=Y};Nc.prototype.Slj=function(){function k(){return new Nd(H.selectedRanges,Y)}var H=this,Y={};Y.IsClearAll=this.ska;Y.Command=this.command;Y.RuleType=this.Gd.ruleType;Y.ConditionType=this.Gd.KB;Y.IsIgnoreBlank=this.Gd.o5;Y.IsInCellDropDown=this.Gd.p5;Y.LowerBoundary=this.Gd.ZN;Y.UpperBoundary=this.Gd.$N;Y.IsAlertBlocking=this.Gd.f_;Y.IsShowErrorAlert=this.Gd.D5;Y.IsShowInputMessage=this.Gd.E5;Y.AlertTitle=this.Gd.kU;Y.AlertMessage=this.Gd.jU;
Y.InputTitle=this.Gd.nF;Y.InputMessage=this.Gd.TV;Y.ShouldIgnoreFormulaError=this.dNa;var za=this.$.na.ua.hc();zg.a(this.$.userOperationManager,function(Va,Pb,Ac){return fe(H.$.na.ua,H.selectedRanges,Y,Rg.b(Va,H.Yzd),Rg.a(Pb),Ac,za)},function(Va){return new Ed.a(121,0,Va,void 0,k)},null)};Nc.prototype.Kxj=function(k){return 1577787509===k};Nc.prototype.Xsj=function(k){this.kV.innerText=k;this.$z(this.xV(0));this.dNa=!0};Nc.prototype.Mye=function(){this.dNa=!1;this.kV.innerText=""};Nc.prototype.Odd=
function(k){switch(k){case 1173235830:return Ae.a.instance.fa(1686);case 43935303:return Ae.a.instance.fa(1687);case -1323438439:return Ae.a.instance.fa(1689);case 2112020473:return Ae.a.instance.fa(1683);case -219503282:return Ae.a.instance.fa(1684);case 1689335445:return Ae.a.instance.fa(1685);case 2146493810:return Ae.a.instance.fa(1688);case -2104909922:return String.format(Ae.a.instance.Ab(105),this.t3.rvb(this.Gd.ruleType,this.Gd.KB),this.t3.Agd(this.Gd.ruleType,this.Gd.KB));case -869372599:return String.format(Ae.a.instance.Ab(104),
this.t3.rvb(this.Gd.ruleType,this.Gd.KB));case -1181828368:return Ae.a.instance.fa(1691);case -758480861:return Ae.a.instance.fa(1692);case -13729088:return Ae.a.instance.fa(1693);case -846654055:return Ae.a.instance.fa(1694);case 751854001:return Ae.a.instance.fa(1695);case -453846397:return Ae.a.instance.fa(1696);case 1102013489:return Ae.a.instance.fa(1697);case 835813260:return Ae.a.instance.fa(1698);case 1577787509:return Ae.a.instance.fa(1699);case 2083564019:return Ae.a.instance.fa(1690);default:nc.ULS.sendTraceTag(537163265,
0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",k.toString())}return null};Nc.prototype.X9a=function(){nc.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.Xac();var k=this.HZd();var H=k.errorString;var Y=k.Eq;if(!k.returnValue)return this.Bs(H),this.ela("OkInvalidByClient",Y),!1;this.Slj();return!0};Nc.prototype.Pla=function(){this.Xac();this.ela("Cancel","None");this.hide()};Nc.prototype.oya=function(){nc.ULS.sendTraceTag(537163235,
0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.dNa?this.Mye():this.r0c();this.nfj();this.ska=!0};Nc.prototype.cX=function(k){var H={};k=(H.ButtonType=Nc.kia(k),H.DialogName=this.Cc,H.Location="dialog",H.NumberOfSelectedRanges=Oe.g(this.$).ha.sa.JK,H);ph.b(this.$).Vd(yf.a.v6b,k)};Nc.prototype.nfj=function(){this.aSb=new dc;this.wAa()};Nc.prototype.wAa=function(){this.qlc.wAa(this.Gd);this.ffc.wAa(this.Gd);this.t3.wAa(this.Gd)};Nc.prototype.Xac=function(){this.t3.tpb(this.Gd);
this.qlc.tpb(this.Gd);this.ffc.tpb(this.Gd)};Nc.prototype.ela=function(k,H){var Y={};Nc.ksb(this.Gd,Y);Y.o=k;Y.p=H;Y.n=this.ska;this.kh&&(this.kh.stop(),Y.q=this.kh.id);Wb.b().Qe(49,Y,!0)};Nc.prototype.QOb=function(k,H){var Y;var za=Y=null;if(!k)return H?(Y=String.format(Ae.a.instance.Ab(105),this.t3.rvb(this.Gd.ruleType,this.Gd.KB),this.t3.Agd(this.Gd.ruleType,this.Gd.KB)),za="DataValidationEditNoMinMaxError"):(Y=String.format(Ae.a.instance.Ab(104),this.t3.rvb(this.Gd.ruleType,this.Gd.KB)),za="DataValidationEditNoValueError"),
{returnValue:!1,errorString:Y,Eq:za};if(k.length>fb.y8f)return Y=Ae.a.instance.fa(1690),{returnValue:!1,errorString:Y,Eq:za};if(ih.d(k))return{returnValue:!0,errorString:Y,Eq:za};if(1===this.Gd.ruleType||2===this.Gd.ruleType||6===this.Gd.ruleType){if(!S.a.u5(k))return Y=Ae.a.instance.fa(1683),{returnValue:!1,errorString:Y,Eq:za};if(1===this.Gd.ruleType&&!S.a.isInteger(k))return Y=Ae.a.instance.fa(1684),{returnValue:!1,errorString:Y,Eq:za};if(6===this.Gd.ruleType){if(!S.a.isInteger(k))return Y=Ae.a.instance.fa(1684),
{returnValue:!1,errorString:Y,Eq:za};if(0>parseInt(k,10))return Y=Ae.a.instance.fa(1685),{returnValue:!1,errorString:Y,Eq:za}}}return{returnValue:!0,errorString:Y,Eq:za}};Nc.prototype.HZd=function(){var k=this,H;var Y=H=null;if(this.ska||0===this.Gd.ruleType)return{returnValue:!0,errorString:H,Eq:Y};var za=(0===this.Gd.KB||1===this.Gd.KB)&&3!==this.Gd.ruleType&&7!==this.Gd.ruleType;return!function(){var Va=k.QOb(k.Gd.ZN,za);H=Va.errorString;Y=Va.Eq;return Va}().returnValue||za&&!function(){var Va=
k.QOb(k.Gd.$N,za);H=Va.errorString;Y=Va.Eq;return Va}().returnValue?{returnValue:!1,errorString:H,Eq:Y}:za&&(1===this.Gd.ruleType||2===this.Gd.ruleType||6===this.Gd.ruleType)&&!ih.d(this.Gd.ZN)&&!ih.d(this.Gd.$N)&&parseFloat(this.Gd.ZN)>parseFloat(this.Gd.$N)?(H=Ae.a.instance.fa(1688),Y="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:H,Eq:Y}):{returnValue:!0,errorString:H,Eq:Y}};Nc.kia=function(k){switch(k){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return nc.ULS.shipAssertTag(537163234,
0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Nc.ksb=function(k,H){H.a=uc(k.ruleType);H.b=Bd(k.KB);H.c=!!k.ZN;H.d=!!k.$N;H.e=k.o5;H.f=k.p5;H.g=k.E5;H.h=!!k.nF;H.i=!!k.TV;H.j=k.D5;H.k=k.f_;H.l=!!k.kU;H.m=!!k.jU};Ek.Object.defineProperties(Nc.prototype,{Gd:{configurable:!0,enumerable:!0,get:function(){return this.aSb}},Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},onCommitDialogHandler:{configurable:!0,enumerable:!0,
get:function(){var k=this;return function(){k.cX(1);k.X9a()}},set:function(k){Object(ri.b)(Nc.prototype,this,"onCommitDialogHandler",k)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},Z1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.t3.y0g}}});Object(Dd.a)(Nc,"DataValidationEditDialogDeprecated",$f.a,[]);lc.prototype.HHa=function(k,H,Y,za){Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new fc(k,H,Y,za)).CSd():
(new Nc(k,H,Y,za)).CSd()};lc.prototype.f4g=function(k,H){var Y=new lh.StandardDialog;Y.jc=3;Y.MAa(k.zb.JZ,Ae.a.instance.fa(1681),H)};lc.prototype.h4g=function(k,H){var Y=new lh.StandardDialog;Y.jc=1;Y.xX(k.zb.JZ,Ae.a.instance.fa(1682),H)};Object(Dd.a)(lc,"DataValidationEditDialogFactory",null,[795]);var Fk=oc.a;Am(dg,Fk);dg.prototype.Nd=function(){this.Cd([new Rb(this.$,new lc)])};dg.ka=function(k){oc.a.fe(245,new dg(k))};Object(Dd.a)(dg,"DataValidationEditCommandHandlerFactory",oc.a,[]);Mg.oig='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(Dd.a)(Mg,"FileUploadDialogHTML",null,[]);var Bi=b(156),yk=Yj.a;Am(Gf,yk);Gf.prototype.si=function(k,H,Y,za,Va){Va=void 0===Va?!0:Va;this.rvd=void 0===za?!1:za;this.Myj(H);this.mnf=k;Va&&Vg.AFrameworkApplication.ZF(k)};Gf.prototype.Myj=function(k){if(Gf.Fu)this.tAj(k);else{var H={};H[Gf.mSg]=k;H[Gf.sSg]=CommonUIStrings.l_SendFileErrorReportMessage;H[Gf.tSg]=CommonUIStrings.l_SendFileErrorReportTextCaption;H[Gf.tZc]="";H[Gf.pSg]=CommonUIStrings.l_UserReportLinkText;H[Gf.n1b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,
Object(nh.a)(this,this.jri,"legacyDialogHandler"),H);this.rX(Gf.ySg)}};Gf.prototype.tAj=function(k){var H={},Y={},za={},Va={},Pb={};k=(Pb.id=this.Pe,Pb.bodyControls=(Va.reportErrorCheckboxProps=this.rvd?(H.label=CommonUIStrings.l_UserReportLinkText,H):null,Va.textAreaProps=this.cof?{}:null,Va.privacyStatementLinkProps=(za.text=CommonUIStrings.l_PrivacyStatement,za.handler=(Y.href=Vg.AFrameworkApplication.Ama,Y.target="_blank",Y),za),Va),Pb.errorMessage=k,Pb.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,
Pb.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,Pb);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(nh.a)(this,this.HGd,"reactDialogHandler"),k)};Gf.prototype.I9a=function(){if(!Gf.Fu){var k=document.getElementById(Gf.vSg);k&&(k.className=Gf.uSg,k.appendChild(Bi.createClusteredImage(32,32,Gf.rSg,null,!0,CommonUIStrings.l_DialogError)));if(k=document.getElementById(Gf.wSg))k.innerText=CommonUIStrings.l_PrivacyStatement,k.href=Vg.AFrameworkApplication.Ama,Pi.a.addHandler(k,
"click",Object(nh.a)(this,this.oPi,"onPrivacyClickHandler"));this.cof||(k=document.getElementById(Gf.tZc))&&k.parentNode&&k.parentNode.removeChild(k);this.rvd||(k=document.getElementById(Gf.oSg))&&k.parentNode&&k.parentNode.removeChild(k)}};Gf.prototype.IO=function(){Gf.Fu||(yk.prototype.IO.call(this),document.getElementById(this.ni("WACDialogPanel")).style.width=String.format("{0}px",400))};Gf.prototype.jri=function(k,H){var Y=H[Gf.tZc]||"",za=!0;void 0!==H[Gf.n1b]&&null!==H[Gf.n1b]&&(za=H[Gf.n1b]);
this.Aw(k,Y,za)};Gf.prototype.HGd=function(k,H){this.Aw(k,H.text||"",H.reportErrorChecked)};Gf.prototype.Aw=function(k,H,Y){this.enf&&(Y&&nc.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.mnf),this.enf(k,H,Y))};Gf.prototype.oPi=function(k){Vg.AFrameworkApplication.Ib.ve(Ng.a.pza,2,k)};Ek.Object.defineProperties(Gf.prototype,{canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Ek.Object.defineProperties(Gf,{Fu:{configurable:!0,enumerable:!0,get:function(){return Vg.AFrameworkApplication.ta.Qa.vv&&
Vg.AFrameworkApplication.ta.Qa.Ski}}});Gf.mSg="WACDialogErrorMessage";Gf.sSg="WACDialogErrorReportMessage";Gf.tSg="WACDialogErrorTextPrompt";Gf.tZc="WACDialogInput";Gf.wSg="WACDialogPrivacyText";Gf.vSg="WACDialogIconPanel";Gf.rSg="CancelRequest_32x32x32";Gf.uSg="WACDialogIcon";Gf.ySg="WACDialogTextPanel";Gf.n1b="WACDialogSendFileCheckbox";Gf.oSg="WACDialogSendFileCheckboxContainer";Gf.pSg="WACDialogSendFileCheckboxText";Gf.qSg="FileUploadErrorDialog";Object(Dd.a)(Gf,"FileUploadErrorDialog",Yj.a,[]);
var Yk=sh.a;Am(qg,Yk);qg.prototype.ZDg=function(k){this.addHandler("fileCollectionComplete",k)};qg.prototype.baj=function(k){this.removeHandler("fileCollectionComplete",k)};qg.prototype.yZg=function(k,H,Y){this.dIf=H;this.nH=k;this.ZDg(Y);Vg.AFrameworkApplication.Ama=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;k=new Gf(this.zZg);Vg.AFrameworkApplication.Ib.fc(Ng.a.pza,xi.a.frame,qg.r0i);k.si(0,"",null,!1,!1)};qg.prototype.L9i=function(k){this.baj(k)};qg.r0i=function(k,H,Y,za,Va){Pi.a.Tt(Va);
Vg.AFrameworkApplication.Ama&&$c.HelperMethods.jf(Vg.AFrameworkApplication.Ama,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(Dd.a)(qg,"FileCollectionOperation",sh.a,[796,3]);var Mj=gg.a;Am(pf,Mj);pf.prototype.create=function(){var k=this;Uf.TaskExtensions.Ba(rf.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){k.Eb(k.lzh)},this.la,3)};pf.prototype.dispose=function(){kg.a.Ha(this.BSb);this.BSb=null;Mj.prototype.dispose.call(this)};pf.ka=function(k){k.da.Ga(125,
new pf(k))};Ek.Object.defineProperties(pf.prototype,{lzh:{configurable:!0,enumerable:!0,get:function(){return this.BSb||(this.BSb=new qg(this.$))}}});Object(Dd.a)(pf,"FileCollectionCommandHandlerFactory",gg.a,[]);var zk=b(1010),Gk=b(190),rj=b(278),Zj=b(1083);je.XEh="GalleryGeneral";je.ZEh="GalleryNumber";je.VEh="GalleryCurrency";je.TEh="GalleryAccounting";je.bFh="GalleryShortDate";je.YEh="GalleryLongDate";je.dFh="GalleryTime";je.$Eh="GalleryPercentage";je.WEh="GalleryFraction";je.aFh="GalleryScientific";
je.cFh="GalleryText";je.VRg="ButtonComma";je.buttonPercentage="ButtonPercentage";je.keyboardNumber="KeyboardNumber";je.keyboardCurrency="KeyboardCurrency";je.keyboardDate="KeyboardDate";je.keyboardTime="KeyboardTime";je.keyboardPercentage="KeyboardPercentage";Object(Dd.a)(je,"RibbonFormatKind",null,[]);var gi=b(307),N=b(717),Fa=b(716),Hb=b(715),mc=gi.a;Am(jg,mc);jg.prototype.a3=function(k){return mc.prototype.a3.call(this,k)||this.tDh.a3(this.Ibd,this.activeCell,this.format,this.ere,this.sGf,this.nGf,
this.p_b,this.gFa,this.clientCorrelationId,this.$lb,this.tib)};jg.prototype.Zi=function(){var k=[];if(this.$cc)for(var H=El(this.$cc),Y=H.next();!Y.done;Y=H.next())k.push(Hb.a(Y.value));else k.push(new Fa.a(this.format,this.Ibd,this.activeCell));return function(){return new N.a(k)}};jg.prototype.reb=function(){var k={OperationType:0};k.FormatCellsMultiRange=this.Ibd;k.ActiveCell=this.activeCell;k.Format=this.format;k.ApplyFormatOnPivotTableValueField=this.ere;k.PivotTableXluid=this.sGf;k.PivotTableFieldCaption=
this.nGf;return k};Ek.Object.defineProperties(jg.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Ke.EwaSettings.qc()?Object(ri.a)(jg.prototype,this,"operationWorkingState"):0}},At:{configurable:!0,enumerable:!0,get:function(){return this.$lb}},taa:{configurable:!0,enumerable:!0,get:function(){return this.tib}},yCc:{configurable:!0,enumerable:!0,get:function(){return this.gFa}}});Object(Dd.a)(jg,"FormatCellsBatchOperation",gi.a,[]);var cd=b(212);Qe.editCell="Edited";
Qe.dependentCell="Dependents";Object(Dd.a)(Qe,"RecalcPriorityGroupType",null,[]);var Le=b(229),Qc=b(9);Object(Dd.a)(Be,"RecalcAccuracyObject",null,[]);Lf.string="String";Lf.blank="Blank";Lf.general="General";Lf.ZBh="Flexible";Object(Dd.a)(Lf,"FormattedUnitKind",null,[]);Object(Dd.a)(pe,"RecalcResultProcessingStatistics",null,[]);Object(Dd.a)(Kd,"RecalcedCellInfo",null,[]);var Id=b(110),Xf=b(62),Nf=b(567);de.prototype.dispose=function(){this.calcManager=this.ozc=this.Ug=this.grid=this.$=null};de.prototype.ZIf=
function(k){var H;if(k&&k.rangeDeltas){for(var Y=this.ada.length,za=0;za<k.rangeDeltas.length;za++)(null===(H=k.rangeDeltas[za])||void 0===H?0:H.data)&&void 0!==k.rangeDeltas[za].data.value&&null!==k.rangeDeltas[za].data.value&&void 0!==k.rangeDeltas[za].range&&null!==k.rangeDeltas[za].range&&this.ada.push(new Kd(k.rangeDeltas[za],k.stateId,k.isFinished,k.priorityGroup));nc.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",
k.stateId,k.priorityGroup,k.isFinished,k.rangeDeltas.length,Y,this.ada.length,this.lastSetCellInstantaneousOperation);!Y&&this.ada.length&&this.SAf(!1,0)}};de.prototype.sad=function(k,H,Y,za,Va,Pb,Ac){if(!H)return Object(Nf.a)("Null");var id=excelOnlineCalc.numfmt.renderCallback(za,function(ld){return gridRenderer.CanvasRendererGlobals.measureTextWidth(ld,Va,!0,Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1))},Ac),Ld=k.renderValue(H,id);if(!excelOnlineCalc.util.isSuccess(Ld))return Object(Nf.a)("Finalize");
za=null;if(Ac=excelOnlineCalc.numfmt.isHashesValue(Ld.value)){if(Ld=k.renderHashesValue(Ld.value,id),!excelOnlineCalc.util.isSuccess(Ld))return Object(Nf.a)("Hashes")}else za=de.FDh(H,Ld.value);id=Ld.value;k=excelOnlineCalc.numfmt.renderedValueToString(id);H=xe(id);id=mf(id);return Object(Nf.d)({text:k,valueType:Y,fontColor:id,Ak:Pb,m9a:za,horizontalAlignment:H,isHashesValue:Ac})};de.prototype.SAf=function(k,H){var Y=this;this.$&&this.grid&&this.calcManager&&this.ozc&&this.calcManager.Eo?(k&&(this.Vca=
this.ozc.aaf),this.U0i(this.grid,this.calcManager.Eo,k,H),!this.Vca&&this.ada.length?qh.Task.delay(0).CWRCT(function(za){Y.SAf(!0,za.id);return!0},null,0,Xf.a.current):qh.Task.Sa(!0)):(nc.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),qh.Task.Sa(!1))};de.prototype.U0i=function(k,H,Y,za){var Va=$c.HelperMethods.$b();for(Y=new pe(this.ada.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,
void 0,this.Vca,void 0,void 0,void 0,Y,void 0,za,!0,0,0,0,0,0,0);0<this.ada.length;){za=$c.HelperMethods.$b()-Va;if(!this.Vca||za>this.Vca){Y.numberOfCellsSkippedDueToTimeout=this.ada.length;break}za=Array.dequeue(this.ada);if(Ye(za,Y)){var Pb=mj.Range.hd(za.rangeDelta.range.row+1,za.rangeDelta.range.column+1);(Pb=k.kc(Pb))?de.OTg(za.stateId,Pb.cell)?(de.lmc(k,Pb,za,Y),this.lKg(H,Pb,za,Y)):Y.numberOfCellsUpdatedAlreadyByServer++:Y.numberOfCellsWithNoFormattedCell++}}za=Math.round($c.HelperMethods.$b()-
Va);this.XSj(za);this.UFj(Y,za);this.vej(Y)};de.prototype.lKg=function(k,H,Y,za){var Va,Pb,Ac,id,Ld=Yd(H,Y),ld=Y.rangeDelta.data.formatted,ef=ud(Y),Jf=Jc(Y);k=this.sad(k,ld,ef,H.cell.hBa,H.cell.R$,Ld,!1);Ld=H.cell.J0d;if(Object(Nf.c)(k))if(this.vAb&&this.Mrd){if(0===Jf||H.text!==k.value.text)this.xoi&&0===Jf&&this.fRd(Ld,k.value)&&(H.cell.formattedText=Ld),this.Ug.lZa(H,k.value),Y=eg(Y),this.Ug.e8c(H,this.lastSetCellInstantaneousOperation,2,Y,!0,!0),za.numberOfUpdatedCells++}else H.text!==k.value.text&&
(this.Ug.lZa(H,k.value),Y=eg(Y),this.Ug.e8c(H,this.lastSetCellInstantaneousOperation,2,Y,!0,!0),za.numberOfUpdatedCells++);else switch(k.reason){case "Null":za.numberOfRecalcedCellsWithoutFormattedValue=(null!==(Va=za.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==Va?Va:0)+1;break;case "Hashes":za.numberOfHashFormattedValues=(null!==(Pb=za.numberOfHashFormattedValues)&&void 0!==Pb?Pb:0)+1;break;case "Finalize":za.newNumberFormatterFinalizeFailures=(null!==(Ac=za.newNumberFormatterFinalizeFailures)&&
void 0!==Ac?Ac:0)+1}Object(Nf.b)(k)&&"Null"!==k.reason&&(za.numberOfRecalcedCellsWithFormattedValue=(null!==(id=za.numberOfRecalcedCellsWithFormattedValue)&&void 0!==id?id:0)+1);za=0===Jf?H.cell.userInput:H.formulaBarText;id=Object(Nf.c)(k)?k.value.text:"";Y=Object(Nf.b)(k)?k.reason:"";nc.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",H.range.top,H.range.left,
k.success,Y,Jf,H.cell.Ak,za?S.a.BJ(za):"null",id?S.a.BJ(id):"null")};de.prototype.XSj=function(k){this.Vca=Math.max(this.Vca-Math.max(k,1),0)};de.prototype.UFj=function(k,H){k.numberOfNonUpdatedCells=this.ada.length;k.totalExecutionTime=H;k.newProcessingTimeLimit=this.Vca;k.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};de.prototype.vej=function(k){k=Sys.Serialization.JavaScriptSerializer.serialize(k);nc.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",
k)};de.FDh=function(k,H){k=k.units;var Y=H.units;if(k.length!==Y.length)return nc.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;H=[];for(var za=-1,Va=0;Va<k.length;Va++)switch(k[Va].kind){case Lf.blank:H.push.apply(H,Id.h(" ",Y[Va].str.length));break;case Lf.string:H.push(k[Va].str);break;case Lf.ZBh:H.push("");za=Va;break;case Lf.general:H.push(Y[Va].str);
break;default:nc.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=za||""===Y[za].str)return null;Y={};Y.Start=H.slice(0,za).join("");Y.Separator=k[za].str;Y.End=H.slice(za+1,H.length).join("");return Y};de.fKh=function(k){return k&&k&&k.du?k.du.DJ:Qc.a.Se};de.OTg=function(k,H){if(!H)return!1;H=de.fKh(H);return H===Qc.a.Se||H===k};de.lmc=function(k,H,Y,za){var Va=Y.rangeDelta.data.value.toString(),Pb=ud(Y),Ac=Yd(H,Y);Va=new Be(Pb,Va,Ac,
Y.priorityGroup);H.cell.lmc(Va,k.Ea.S5);1===Jc(Y)?za.numberOfDependentRecalcedCellsInBatch++:za.numberOfEditedRecalcedCellsInBatch++};de.prototype.fRd=function(k,H){return null==k?!1:!!k.TextRuns&&!!k.Fonts&&k.Text===H.text&&2===H.valueType};de.AGe=20;Object(Dd.a)(de,"CalcResultProcessor",null,[851,3]);Object(Dd.a)(Xe,"GetRibbonNumberFormatResult",null,[]);Pe.prototype.mKb=function(k,H,Y){var za=H.Border;H=H.BorderFormat;var Va=0,Pb=!1;if(0===za)k.cell.osc(),this.pId(k.cell.getRange());else{for(var Ac=
0;3>=Ac;Ac++)Pe.kvj(k,Y,Ac,za)&&(Va|=$c.HelperMethods.x3a(Ac),this.eYd(k.cell.getRange(),Ac,H),Pb=!0);$c.HelperMethods.qR(za,16)&&!ih.c(k,0,Y)&&(Va|=2,this.eYd(k.cell.getRange(),0,H),Pb=!0);$c.HelperMethods.qR(za,32)&&!ih.c(k,2,Y)&&(Va|=4,this.eYd(k.cell.getRange(),2,H),Pb=!0);Pb&&(Y=k.cell.du.uf,$c.HelperMethods.qR(Va,2)&&this.R1f(k,Y,0)&&(Va&=-3),$c.HelperMethods.qR(Va,1)&&this.Q1f(k,Y,1)&&(Va&=-2),$c.HelperMethods.qR(Va,4)&&this.R1f(k,Y,2)&&(Va&=-5),$c.HelperMethods.qR(Va,8)&&this.Q1f(k,Y,3)&&
(Va&=-9),k.cell.setBorders(H,Va,!1))}};Pe.prototype.UQ=function(k,H){k=Pe.oWe(k,H);return k.isValidRange?(k=this.Ea.Tua(k))&&k.length?k:null:null};Pe.prototype.pId=function(k){for(var H=0;3>=H;H++){var Y=Pe.oWe(k,H);if(Y.isValidRange&&(Y=this.Ea.Tua(Y))&&Y.length)for(var za=Pe.s0e(H),Va=0;Va<Y.length;Va++)Y[Va].mQa(za)}};Pe.prototype.eYd=function(k,H,Y){if(k=this.UQ(k,H))for(var za=Pe.s0e(H),Va=$c.HelperMethods.x3a(za),Pb=0;Pb<k.length;Pb++){var Ac=k[Pb];this.Gei(Ac,za)&&Pe.setBorders(Ac,Y,Va,H,za)}};
Pe.prototype.Gei=function(k,H){var Y=k.du.uf,za=k.getRange();za=this.UQ(za,H);var Va=!1,Pb=!1,Ac=!1,id=!1;za&&(Va=Pe.C6a(za,!0),Pb=Pe.C6a(za,!1),id=Pe.npd(za),Ac=1===za.length?!0:!1);switch(H){case 0:return Pe.Xdi(k,Y,id,Pb,Ac);case 1:return Pe.Udi(k,Y,id,Va,Ac);case 2:return Pe.Vdi(k,Y,id,Va,Ac);case 3:return Pe.Wdi(k,Y,id,Pb,Ac)}return!1};Pe.prototype.R1f=function(k,H,Y){if(!k.cell.iN)return!1;var za=k.range,Va=this.UQ(za,Y),Pb=ih.c(k,Y,H),Ac=!1;H=0===Y?za.top<H.top:za.left<H.left;!Pe.Bzb(k.cell)&&
Va&&1!==Va.length&&(Ac=(0===Y?Pe.C6a(Va,!0):Pe.C6a(Va,!1))?!1:!0);return!Pb&&Ac||H?!0:!1};Pe.prototype.Q1f=function(k,H,Y){var za=k.cell,Va=this.UQ(za.getRange(),Y);k=ih.c(k,Y,H);H=!1;if(Va){var Pb=Pe.C6a(Va,!0),Ac=Pe.C6a(Va,!1),id=Pb&&!Ac;Ac=Ac&&!Pb;1!==Y||Pe.xAb(za)?3!==Y||Pe.pzb(za)||Pe.rvj(za,Va,Ac,id)&&(H=!0):Pe.qvj(za,Va,Pb,Ac)&&(H=!0)}return!k&&H||Pe.Bzb(za)?!0:!1};Pe.sPg=function(k,H,Y){var za={};za.LineStyle=Array(4);za.LineStyle[Y]=k.LineStyle[H];za.Color=Array(4);za.Color[Y]=k.Color[H];
return za};Pe.lbf=function(k,H,Y,za,Va){return $c.HelperMethods.qR(k,Va)&&ih.c(H,Y,za)};Pe.kvj=function(k,H,Y,za){return Pe.lbf(za,k,Y,H,$c.HelperMethods.x3a(Y))||Pe.lbf(za,k,Y,H,64)||112===za};Pe.setBorders=function(k,H,Y,za,Va){H=Pe.sPg(H,za,Va);k.setBorders(H,Y,!1)};Pe.oWe=function(k,H){switch(H){case 0:return new mj.Range(k.top-1,k.left,k.top-1,k.right,!1,!1);case 2:return new mj.Range(k.top,k.left-1,k.bottom,k.left-1,!1,!1);case 1:return new mj.Range(k.bottom+1,k.left,k.bottom+1,k.right,!1,!1);
case 3:return new mj.Range(k.top,k.right+1,k.bottom,k.right+1,!1,!1)}return k};Pe.s0e=function(k){switch(k){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};Pe.C6a=function(k,H){for(var Y=0;Y<k.length;Y++){var za=k[Y];if(za.iN)return H?Pe.pzb(za):Pe.xAb(za)}return!1};Pe.Bzb=function(k){var H=k.du.uf,Y=k.getRange();return k.iN&&(Y.top<H.top||Y.bottom>H.bottom||Y.left<H.left||Y.right>H.right)?!0:!1};Pe.npd=function(k){for(var H=0;H<k.length;H++)if(Pe.Bzb(k[H]))return!0;return!1};Pe.qvj=
function(k,H,Y,za){if(!k.iN){if(!Y||Pe.npd(H))return!0}else if(Pe.pzb(k)&&(1===H.length&&Pe.FKg(k,H[0])||!Y))return!0;return za};Pe.rvj=function(k,H,Y,za){if(!k.iN){if(!Y||Pe.npd(H))return!0}else if(Pe.xAb(k)&&(1===H.length&&Pe.GKg(k,H[0])||!Y))return!0;return k.Lka||za};Pe.Xdi=function(k,H,Y,za,Va){var Pb=k.getRange();return Pe.pzb(k)?Pe.Bzb(k)||Va:H.top===Pb.top||!za||Y};Pe.Udi=function(k,H,Y,za,Va){var Pb=k.getRange();return Pe.pzb(k)?H.bottom===Pb.bottom&&Va:za&&!Y||H.bottom===Pb.bottom};Pe.Vdi=
function(k,H,Y,za,Va){var Pb=k.getRange();return Pe.xAb(k)?Pe.Bzb(k)||Va:H.left===Pb.left||!za||Y};Pe.Wdi=function(k,H,Y,za,Va){var Pb=k.getRange();return k.Lka?!1:Pe.xAb(k)?H.right===Pb.right&&Va:za&&!Y||H.right===Pb.right};Pe.pzb=function(k){return 0<k.getRange().right-k.getRange().left};Pe.xAb=function(k){return 0<k.getRange().bottom-k.getRange().top};Pe.GKg=function(k,H){k=k.getRange();H=H.getRange();return k.top===H.top&&k.bottom===H.bottom};Pe.FKg=function(k,H){k=k.getRange();H=H.getRange();
return k.left===H.left&&k.right===H.right};Object(Dd.a)(Pe,"BorderModelAccessorHelper",null,[]);Ff.prototype.Fcb=function(k,H,Y,za,Va,Pb){k&&(k.v7(H,Y,void 0===Va?!1:Va,void 0===Pb?!1:Pb),k.verticalAlignment=za)};Ff.prototype.mKb=function(k,H,Y){this.XA||(this.XA=new Pe(this.Ea,this.B2a));this.XA.mKb(k,H,Y)};Object(Dd.a)(Ff,"FormatCellsActionModelAccessor",null,[850]);Kf.prototype.isValid=function(){return this.Ll&&this.Eo?!(void 0===this.formatString||null===this.formatString):!1};Kf.prototype.oQh=
function(){return null!=this.PQ?this.PQ:this.formatString};Ek.Object.defineProperties(Kf.prototype,{PQ:{configurable:!0,enumerable:!0,get:function(){return this.yog}},formatString:{configurable:!0,enumerable:!0,get:function(){if(this.hya)return this.hya;if(this.Hqa)return this.Hqa.formatString;if(!this.Ll)return null;if(null!=this.PQ){var k=this.PQ;return 0>k?(nc.ULS.shipAssertTag(537162126,0,!1,"NumberFormatHolder.FormatString: ifmt is negative!"),null):(k=this.Ll.pca[k])?this.hya=k.FormatString:
null}return null}},numberFormat:{configurable:!0,enumerable:!0,get:function(){return this.Hqa?this.Hqa:this.Eo&&this.formatString?this.Hqa=this.Eo.createFormat(this.formatString,this.NRg).value:null}},NRg:{configurable:!0,enumerable:!0,get:function(){if(!this.Ll||null==this.PQ||0>this.PQ)return!1;var k=this.Ll.pca[this.PQ];return k?k.Builtin:!1}}});Object(Dd.a)(Kf,"NumberFormatHolder",null,[852]);var gh=b(259);Object(Dd.a)(tf,"FormatCellInstantaneousResult",null,[]);Object(Dd.a)(rd,"FormatStringResult",
null,[]);var Yg=b(1257),Lh=b(568),Yh=b(204),Bh;(function(k){k.InvalidInput="invalid input";k.UnsupportedZeroResize="resizing to 0 - ignore";k.UnsupportedSkeletonInView="skeleton in view - ignore";k.NullSPD="ActiveSheetProcessedData is null";k.UnsupportedHiddenInRange="hiddens in resizeRanges";k.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(Bh||(Bh={}));Object(Dd.b)("InstantaneousRowColumnResizeFailureReason",Bh);var jh=b(326);xb.prototype.dispose=function(){kg.a.zc([this.rSa,
this.c3]);this.$=this.c3=this.rSa=null};xb.prototype.NAa=function(k,H,Y,za,Va,Pb,Ac,id,Ld){return this.Azj(k,H,Y,void 0===Va?!1:Va,void 0===id?0:id,void 0===Pb?"":Pb,void 0===Ld?null:Ld)};xb.prototype.e8c=function(k,H,Y,za,Va,Pb){k.cell.du.rQ|=za;xb.l0g(Oe.g(this.$),k,Y,Va);this.c3.lastSetCellInstantaneousOperation=H;Pb&&Oe.g(this.$).Ji.U0(H,Og.BasicTelemetryCalculator.iR)};xb.prototype.Tda=function(k,H,Y,za,Va,Pb){za=void 0===za?!1:za;Va=void 0===Va?null:Va;var Ac=void 0===Ac?null:Ac;Pb=(void 0===
Pb?null:Pb)||k.ha.sa.selectedRanges;if(!(-1690267012===H&&1<Pb.length)){-1690267012===H&&nc.ULS.shipAssertTag(537162176,0,1===Pb.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",Pb.length);var id=k.Q$("FormatCellsAction.ShowInstantaneousFormatting",Pb);try{id.$$rst();for(var Ld=!1;id.$$mn();){var ld=void 0,ef=id.$$cu().rF?k.LJb(id.$$cu().range):(ld=new rb.a,ld.add(id.$$cu()),ld);ld={};for(var Jf=El(ef),Kg=Jf.next();!Kg.done;ld={Zfb:ld.Zfb},Kg=Jf.next()){var Cg=Kg.value;
if(Oe.g(this.$).Ez&&Cg&&Ac&&-1690267012===H&&(ld.Zfb=Cg.range,ld.Zfb&&Ac.contains(ld.Zfb)&&Uh.a.all(Pb,function(Wg){return function(wi){return!ve.c(wi,Wg.Zfb)}}(ld))))continue;if(!Cg||id.Jb.contains(Cg.range))if(this.i3f(H,Cg,Y,za,Va,id.$$cu().rF),Ld||(k.Ea.WV(),Ld=!0),Va)break}}}finally{id&&id.dispose()}}};xb.prototype.lZa=function(k,H,Y){if(Y=void 0===Y?null:Y)Y.lwa=!0;Y=!H.text;var za=S.a.Qef(H.text),Va,Pb=k.rF?Oe.g(this.$).LJb(k.range):(Va=new rb.a,Va.add(k),Va);Va=El(Pb);for(Pb=Va.next();!Pb.done;Pb=
Va.next())this.jKg(this.$,Pb.value,H.text,H.horizontalAlignment,H.fontColor,H.Ak,k.cell.Ak,Y,za,H.valueType,H.m9a);k.cell.mCc()};xb.prototype.PWi=function(k,H,Y,za,Va){Va=void 0===Va?null:Va;try{var Pb=ve.D(H),Ac=ve.D(Y);if(k.Rb.D6a(Pb)||k.Rb.D6a(Ac))return 8;if(-185374993!==za&&this.wmi(k,Pb,Ac))return 9;if(-185374993!==za&&(k.Rb.x5(Ac)||k.Rb.Szb(Pb)))return 10;if(1804571062!==za&&k.Rb.Gka(Ac))return 11;if(this.ahh(Ac))return 12;if(this.nni(Pb,Ac))return 13;var id=this.$.Ob.Gc("UserAction","PasteInstantaneous");
id.start();Lh.a(id);Va&&Wb.b().OA(id.id,Va.id,"actions","actions");!Pb.isSingle&&Ac.isSingle&&(Ac=xb.expandRange(Pb,Ac),k.ha.updateSelection(Ac,Ac,0));switch(za){case 237279923:case 808159687:if(!this.fXi(Pb,Ac))return 14;this.U2c(k,Pb,Ac,!0,!1);break;case 1804571062:this.U2c(k,Pb,Ac,!0,!1);break;case -185374993:this.U2c(k,Pb,Ac,!1,!0);break;default:return 2}nc.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Ld){return nc.ULS.sendTraceTag(537162145,
0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",JSON.stringify(Ld)),15}};xb.prototype.eYg=function(k,H){k=El(k);for(var Y=k.next();!Y.done;Y=k.next())this.B0c(Y.value,!0,H)};xb.prototype.B0c=function(k,H,Y){Y=void 0===Y?"":Y;if(k){var za=Oe.g(this.$);if(H){if(H=za.vk("FormatCellsAction.ClearRangeInstantaneous",k),k=k.isSingle?null:k,H.$$mn()&&void 0!==H.$$cu()&&null!==H.$$cu())for(za=Object(ag.a)(new Ph.a,{Text:""}),this.NAa(H.$$cu(),za,!1,void 0,ee.a.Rgc(this.$),
Y,void 0,void 0,k);H.$$mn();)void 0!==H.$$cu()&&null!==H.$$cu()&&this.NAa(H.$$cu(),za,!1,void 0,!1,Y)}else this.Tda(za,-1228228458,{},void 0,void 0,[k])}else nc.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};xb.prototype.r6i=function(k,H){if(!H){H=$c.HelperMethods.$b();var Y=Oe.g(this.$),za=Y.Q$("FormatCellsAction.ReformatCells",k);try{za.$$rst();for(var Va=!1;za.$$mn();){var Pb=za.$$cu().cell;if(0===Pb.cQ||2===Pb.cQ)this.updateSpillInformation(Pb,
k),Va||(Y.Ea.WV(),Va=!0)}}finally{za&&za.dispose()}nc.ULS.sendTraceTag(537162143,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",$c.HelperMethods.$b()-H)}};xb.prototype.Adc=function(k,H){if(this.Fb){if(k.formulaBarText)return!S.a.equals(H.Text,k.formulaBarText,!1);var Y=k.cell.formattedText;Y=gh.a(Y,k.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(Y,H).isEqual}return!S.a.equals(H.Text,k.text,!1)};xb.prototype.ADh=
function(k){if(void 0===k||null===k||!this.qK&&(k=new Kf(this.Ll,this.Eo,void 0,k),!k.isValid()))return new rd(!1,"1234.56");k=this.X2a({value:"1234.56",type:1},k,244,"12px sans-serif");return Object(Nf.b)(k)?new rd(!1,"1234.56"):new rd(!0,k.value.text)};xb.prototype.Bzj=function(k,H,Y,za){return Hf(k,this,H,Y,za,!0)};xb.prototype.h3f=function(k,H,Y){if(!this.Adc(H,Y))return Object(Nf.d)("Skip unchanged cell content");H=H.cell;var za=this.qK?H.Ak:new Kf(this.Ll,this.Eo,H.Ak);Y=this.KUe(Y.Text,za,
H.hBa,H.R$,!0);if(Object(Nf.b)(Y))k=Y;else{Y=Y.value;za=Y.text;var Va=Y.valueType;za=H.hasRichValueIcon?"Unsupported rich value icon":H.cT?Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EstimateWrapTextEditResize",!1)&&2==Va&&'normal 11pt "calibri"'===H.R$&&H.uBe(za)>=H.offsetWidth*Math.floor(H.offsetHeight/Qc.a.bsb)?"Unsupported wrapped text with long input":"Unsupported wrapped text":H.zAb||null!=H.loa&&0!==H.loa?"Unsupported rotated text":!0;!0!==za?k=Object(Nf.a)(za):(H.isCellWidthFixed?
za="Skip fixed width cell":(za=Y.valueType,za=0===za?"Skip empty cell value":2===za?"Skip string cell value":H.iN&&!H.qmi?"Skip merged cell":H.hyc?"Skip shrunk to fit":Y.isHashesValue?"Skip hashes cell value":!0),!0!==za?k=Object(Nf.d)(za):(Y=H.uBe(Y.text),Y>H.offsetWidth?(H=[H.getRange().clone()],k=Hf(k,this,H,Y,!1,!1),k=Object(Nf.b)(k)?k:Object(Nf.d)(Y)):k=Object(Nf.d)("Column is wide enough")))}return k};xb.prototype.IUe=function(k,H,Y,za,Va){if(!this.qK&&(H=new Kf(this.Ll,this.Eo,H),!H.isValid()))return new rd(!1,
k);var Pb={};Pb.value=k;Pb.type=Y;Y=this.X2a(Pb,H,za,Va);return Object(Nf.b)(Y)?new rd(!1,k):new rd(!0,Y.value.text)};xb.prototype.updateSpillInformation=function(k,H){var Y=k.getRange(),za=!1;H=El(H);for(var Va=H.next();!Va.done;Va=H.next())if(Y.left===Va.value.left){za=!0;break}k.RPj(za)};xb.prototype.Azj=function(k,H,Y,za,Va,Pb,Ac){var id=void 0;Pb=void 0===Pb?"":Pb;id=void 0===id?1:id;Ac=void 0===Ac?null:Ac;this.vAb&&this.yoi&&(k.cell.J0d=H);var Ld=new tf;Ld.source=0;Ld.lwa=!1;k.cell.fpc=k.cell.Ak;
var ld=H.Text,ef=!ld,Jf=S.a.Qef(ld);S.a.Rn(ld)&&(nc.ULS.shipAssertTag(537162142,0,!((void 0===ld||null===ld)&&void 0!==H.TextRuns&&null!==H.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),H=Object(ag.a)(new Ph.a,{Text:""}),ld="");k.cell.userInput=ld;if(!this.Adc(k,H))return this.vVg(k,Va,ef,Jf,Ld);Y?this.nVg(k,ld,this.$.workbookContext.DefaultHyperlinkStyle,Ld):this.hVg(k,H,ld,ef,Jf,za,Ld,Ac);this.e8c(k,Pb,Va,id,Ld.Khc,Ld.lwa);return Ld};xb.prototype.vVg=
function(k,H,Y,za,Va){Va.Ueg=!0;Va.Khc=!0;Va.lwa=!1;0===H&&Oe.g(this.$).Ea.WV();0===k.cell.Tya&&(Y?k.cell.v7(0,!1):za&&k.cell.v7(1,!1));return Va};xb.prototype.nVg=function(k,H,Y,za){za.lwa=!0;k.insertHyperlink(H,cd.a.Xad(H),Y)};xb.prototype.hVg=function(k,H,Y,za,Va,Pb,Ac,id){id=void 0===id?null:id;Ac.lwa=!1;var Ld=k.cell;this.Ll||(this.Ll=this.$.da.Aa(268));this.LLj(this.Ll,Ld.Ak);za||Va?this.jVg(k,za,Va,Ac):(za=this.qK?Ld.Ak:new Kf(this.Ll,this.Eo,Ld.Ak),za=this.KUe(Y,za,Ld.hBa,Ld.R$,!1),Object(Nf.c)(za)?
(this.fRd(H.TextRuns,H.Fonts)&&this.lVg(k,H,za.value),this.lZa(k,za.value,Ac)):this.vAb&&this.Mrd?this.rVg(k,H.Text,Ac):this.sVg(k,H.Text),H=Object(Nf.c)(za)?za.value.text:"",Va=Object(Nf.b)(za)?za.reason:"",nc.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",k.range.top,k.range.left,za.success,Va,Ld.Ak,S.a.Xga(Ld.userInput),S.a.Xga(H)));Ld.formulaBarText=Y;Pb&&this.nLj(this.Ll,
k,Y,id);Ac.Khc=!0};xb.prototype.jVg=function(k,H,Y,za){za.lwa=!0;k.text="";k.formulaBarText="";k.cell.userInput="";this.V1b(k,null,null,H,Y)};xb.prototype.lVg=function(k,H,Y){H.Text===Y.text&&2===Y.valueType&&(k.cell.formattedText=H)};xb.prototype.rVg=function(k,H,Y){Y&&(Y.lwa=!0);k.text=H;k.formulaBarText=H;this.V1b(k,1)};xb.prototype.sVg=function(k,H){k.text=H;k.formulaBarText=H;this.V1b(k,1)};xb.prototype.V1b=function(k,H,Y,za,Va,Pb){Y=void 0===Y?null:Y;za=void 0===za?!1:za;Va=void 0===Va?!1:Va;
Pb=void 0===Pb?!1:Pb;var Ac=k.horizontalAlignment;Y=null!=Y?Y:k.verticalAlignment;0===k.cell.Tya&&(null!=H||za||Va||Pb)&&(za?Ac=0:Va||Pb?Ac=1:null!=H&&(Ac=H),this.Kua.Fcb(k,Ac,!1,Y,!0))};xb.prototype.LLj=function(k,H){(null===k||void 0===k?0:k.pca)&&H>=xb.GBh&&H>k.pca.length-1&&(nc.ULS.sendTraceTag(537162141,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",H),k.BUe())};xb.prototype.nLj=function(k,H,Y,za){za=void 0===za?null:
za;if(void 0!==k&&null!==k)if(this.Ll.umd)nc.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var Va=this.$.da.Aa(266);Va&&(this.c3.Vca=de.AGe,k&&(this.c3.Vca=k.aaf),Va.dTg(H,Y,Object(nh.a)(this.c3,this.c3.ZIf,"processResults"),za))}};xb.prototype.X2a=function(k,H,Y,za){var Va=this.$.da.Aa(266);if(!Va)return Object(Nf.a)("calcManager is null");if(!Va.Eo)return Object(Nf.a)("calcManager.NumberFormatter is null");if(!this.Ll)return Object(Nf.a)("instantaneousManager is null");
if(this.qK)if("number"===typeof H||"string"===typeof H){var Pb=Va.Rbc(H);if(!Object(Nf.c)(Pb))return Pb;var Ac=Pb.value}else Ac=H;else{if(!H||!H.isValid())return Object(Nf.a)("numberFormatHolder is invalid or null");Ac=Va.Dfd(H);if(null==Ac)return Object(Nf.a)("cellFormat is null")}Pb=Va.Eo;var id=Ge(k);if(void 0===id||null===id)return Object(Nf.a)("cellValue is null");Va=excelOnlineCalc.calc.cellValueToReadOper(Va.config.mathpack,id);if(void 0===Va||null===Va)return Object(Nf.a)("readOper is null");
Va=Pb.applyFormat(Ac,Va,Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(Va)?this.c3.sad(Pb,Va.value,k.type,Y,za,"number"===typeof H?H:-1,!1):Object(Nf.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Va.reason.kind))};xb.prototype.KUe=function(k,H,Y,za,Va){var Pb=this.$.da.Aa(266);if(void 0===Pb||null===Pb)return Object(Nf.a)("calcManager is null");if(void 0===Pb.Eo||null===Pb.Eo)return Object(Nf.a)("calcManager.NumberFormatter is null");
if(void 0===this.Ll||null===this.Ll)return Object(Nf.a)("instantaneousManager is null");if(this.vAb&&!Va)return Object(Nf.a)("No main thread number formatter");if("number"===typeof H||"string"===typeof H){var Ac=Pb.Rbc(H);if(!Object(Nf.c)(Ac))return Ac;var id=Ac.value}else{if(void 0===H||null===H||!H.isValid())return Object(Nf.a)("numberFormatHolder is invalid or null");Ac=Pb.Dfd(H);if(void 0===Ac||null===Ac)return Object(Nf.a)("cellFormat is null")}Ac=Pb.Eo;k=Ac.parseEdit(k,id);if(!excelOnlineCalc.util.isSuccess(k))return Object(Nf.a)("ParseEdit failure: reason="+
k.reason.kind+", features="+k.reason.features);if(k.value.kind===Zj.a.formula)return Object(Nf.a)("Main thread - skipping formula edit");Pb=excelOnlineCalc.numfmt.applyValueEdit(Ac,Pb.localeInfo,id,k.value);if(!excelOnlineCalc.util.isSuccess(Pb))return Object(Nf.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(Pb.reason.kind));k=k.value;nc.ULS.shipAssertTag(537162190,0,k.kind!==Zj.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");k=excelOnlineCalc.numfmt.getValueEditOperKind(k);
id=0;switch(k){case 0:case 128:id=0;break;case 1:id=1;break;case 2:id=2;break;case 4:id=3;break;case 8:id=4;break;case 16:case 32:case 64:case 256:nc.ULS.sendTraceTag(537162189,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",k);break;default:nc.ULS.shipAssertTag(537162188,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",k)}return this.c3.sad(Ac,Pb.value,id,Y,za,"number"===typeof H?H:-1,Va)};xb.prototype.wmi=function(k,
H,Y){if(H.width<Y.width)for(var za=k.vk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new mj.Range(H.top,H.left,H.bottom,H.left,!0,!0));za.$$mn();){var Va=za.$$cu();if(Va&&Va.WKa())return nc.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}if(H.height<Y.height)for(k=k.vk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new mj.Range(H.top,H.left,H.top,H.right,!0,!0));k.$$mn();)if((H=k.$$cu())&&H.$Ka())return nc.ULS.sendTraceTag(537162138,
0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};xb.prototype.U2c=function(k,H,Y,za,Va){for(var Pb=H.SS().FirstRow,Ac=H.SS().LastRow,id=Y.SS().LastRow,Ld=Pb,ld=Y.SS().FirstRow;ld<=id;ld++,Ld++){Ld>Ac&&(Ld=Pb);var ef=H.SS();ef.FirstRow=ef.LastRow=Ld;var Jf=Y.SS();Jf.FirstRow=Jf.LastRow=ld;this.h3g(k,Gk.a.RQ(ef),Gk.a.RQ(Jf),za,Va)}};xb.prototype.fXi=function(k,H){var Y=this.$.da.Aa(266);return void 0!==Y&&null!==Y?(Y.YSg(k,H.topLeft,Object(nh.a)(this.c3,
this.c3.ZIf,"processResults")),!0):!1};xb.prototype.nni=function(k,H){var Y=k.right-k.left+1;k=k.bottom-k.top+1;var za=H.right-H.left+1;H=H.bottom-H.top+1;if(za>Y&&H>k){if(!(za%Y&&H%k))return!0}else if(za===Y&&H>k){if(!(H%k))return!0}else if(za>Y&&H===k&&!(za%Y))return!0;return!1};xb.prototype.ahh=function(k){if(Ke.EwaSettings.ma(103)){k=Oe.g(this.$).o1(k).gridView.getRangeInformation(k);k=El(k);for(var H=k.next();!H.done;H=k.next())if(H=H.value,Object(hf.a)(rj.DynamicArrayRange,H)&&!Object(Pa.a)(rj.DynamicArrayRange,
H).cmc)return!0}return!1};xb.prototype.nCe=function(k,H,Y,za,Va,Pb){H=El(H);for(var Ac=H.next();!Ac.done;Ac=H.next())Ac=Ac.value,Y&&(this.l3g(Ac,Va),Ac.setCell(!0)),za&&(Pb=this.e3h(Va,Ac)),Pb||(k.Ea.WV(),Pb=!0);return Pb};xb.prototype.iPh=function(k,H,Y){H=new mj.Range(H,Y,H,Y,!0,!0);return k.kc(H)};xb.prototype.h3g=function(k,H,Y,za,Va){if(Y){this.rSa&&Y.equals(this.rSa.range)||(kg.a.Ha(this.rSa),this.rSa=k.vk("FormatCellsAction.CopyBetweenRows",Y));Y=this.rSa;Y.$$rst();var Pb=!1;if(Ke.EwaSettings.getBooleanFeatureGate(jh.a.gFe,
!1)){var Ac=H.SS().FirstColumn+1,id=H.SS().LastColumn+1;H=H.SS().FirstRow+1;for(var Ld=Ac;Y.$$mn();){Ld>id&&(Ld=Ac);var ld=this.iPh(k,H,Ld);Ld+=1;var ef=void 0,Jf=Y.$$cu().rF?k.LJb(Y.$$cu().range):(ef=new rb.a,ef.add(Y.$$cu()),ef);ld&&(Pb=this.nCe(k,Jf,za,Va,ld,Pb));ja.lastOrDefault(Jf)}}else for(Ac=k.vk("FormatCellsAction.CopyBetweenRows2",H);Y.$$mn();)Ac.$$mn()||(Ac.$$rst(),Ac.$$mn()),id=Ac.$$cu(),H=void 0,Ld=Y.$$cu().rF?k.LJb(Y.$$cu().range):(H=new rb.a,H.add(Y.$$cu()),H),id&&(Pb=this.nCe(k,Ld,
za,Va,id,Pb)),ja.lastOrDefault(Ld)}else nc.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};xb.prototype.B3f=function(){var k=he.a.gd(1,0,0,650,0,104573951,"PivotTableContextMenuOperationFailure");Zi.a(this.$).si(k)};xb.prototype.Rxi=function(k,H){var Y={ValidMembers:32},za=H.NumberFormat;switch(k){case 1890566896:if(1001===za||1002===za||1003===za){Y.NumberFormat=14;Y.NumberFormatOptions={};switch(za){case 1001:Y.NumberFormatOptions.TimeType=2;break;case 1002:Y.NumberFormatOptions.DateType=
7;break;case 1003:Y.NumberFormatOptions.DecimalPlaces=0}Y.NumberFormatOptions.NumberFormatCategory=this.ZJg(za)}else Y.NumberFormat=za;break;case 1886928607:Y.NumberFormat=13;break;case -992833457:Y.NumberFormat=11;break;case 218524921:Y.NumberFormat=12;break;case 996232352:Y.NumberFormat=14;Y.NumberFormatOptions=Object(ag.a)(new zk.a,{DecimalPlaces:0});Y.NumberFormatOptions.NumberFormatCategory=6;break;default:return H}return Y};xb.prototype.formatCells=function(k,H,Y,za,Va,Pb,Ac){za=void 0===za?
null:za;Va=void 0===Va?null:Va;Pb=void 0===Pb?null:Pb;Ac=void 0===Ac?null:Ac;var id=this.$.Ob.Gc("UserAction","FormatCellsInstantaneous, command = "+Wb.b().ri(k)),Ld=this.$.Ob.$g("UserAction","FormatCellsInstantaneousFrame");Ld.start();Lh.a(Ld);var ld=Wb.b().ri(k),ef=this.$,Jf=Oe.g(ef),Kg=Jf.ha.sa,Cg=Va||Kg.selectedRanges,Wg=Id.g(Cg,function(gk){return gk.uM});ld=String.format("{0}, cellCount={1}",ld,Wg);Oe.g(this.$).Ji.K7(1,id.id,ld);Cg=ve.r(Cg,this.$);Kg=Kg.activeCell;ld=-168056295===Y.command;
var wi=Wg=null;if(ld){wi=Jf.Rb.jp(Kg);if(!wi){this.B3f();return}Wg=wi.Lca.substring(1,wi.Lca.length-1);wi=wi.Sac();if(!wi){this.B3f();return}wi=wi.Caption}Jf.rg.dH(!1,!0);var oj=ve.o(Kg,ef),fj=ef.na.ua.hc({lla:!0,kka:1}),Wj=this.Rxi(Y.command,H);ld||this.Tda(Jf,k,H,!1,za,Va);id.stop();Oe.g(this.$).Ji.U0(id.id,Og.BasicTelemetryCalculator.iR);Y.Vbi=ff.a.Ta.Wb;za=this.$.Ob.Gc("UserAction","FormatCellsUserAction");this.fui(k,Y.taskId,H,Cg,Kg,za.id);Wb.b().OA(id.id,za.id,"actions","actions");Wb.b().OA(Ld.id,
za.id,"actions","actions");Ke.EwaSettings.qc()?ef.userOperationManager.ic(new jg(this,Cg,oj,Wj,ld,Wg,wi,fj,za,id.id,64,Pb,Ac),Y):ef.userOperationManager.ic(new jg(this,Cg,oj,Wj,ld,Wg,wi,fj,za,id.id,0,Pb,Ac),Y)};xb.prototype.a3=function(k,H,Y,za,Va,Pb,Ac,id,Ld,ld,ef){var Jf=this,Kg=this.$;return function(Cg,Wg,wi){Kg.Ky();Cg=[Cg,Jf.XJi];Wg=[Wg];ld&&Cg.push(ld);ef&&Wg.push(ef);return Jg.q(Kg.na.ua,k,H,Y,za,Va,Pb,!1,Rg.b.apply(null,Cg),Rg.a.apply(null,Wg),wi,Ld,Ac,id)}};xb.prototype.i3f=function(k,H,
Y,za,Va,Pb,Ac){Ac=void 0===Ac?null:Ac;if(H&&Y){var id=Y.Font,Ld=Y.HorizontalAlignment,ld=Y.VerticalAlignment;Y.ValidMembers&2||(Ld=H.horizontalAlignment);Y.ValidMembers&1||(ld=H.verticalAlignment);var ef=0!==Ld;xb.bei(k)&&0===Ld&&(Ld=this.IZe(H));var Jf=!1;switch(k){case -394785302:this.Kua.Fcb(H,Ld,ef,0);break;case 1041132226:this.Kua.Fcb(H,Ld,ef,1);break;case -571165336:this.Kua.Fcb(H,Ld,ef,2);break;case -1150205178:case -1142465846:case -286432209:this.Kua.Fcb(H,Ld,ef,ld,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.s7a&&
this.joj(H,Y);break;case 1650812936:this.setFillColor(H,Y,Pb);break;case -287251124:H.bold=id.Bold;break;case -1690267012:Oe.g(this.$).ha.sa.Ig&&(id=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?Ac?Ac:Oe.g(this.$).ha.sa.qd:Oe.g(this.$).ha.sa.qd,this.Kua.mKb(H,Y,id));break;case 1970784898:Y=Le.a.fp(H.color,H.backgroundColor);if(Xg.a.compare(Y,Xg.a.red)&&(S.a.u5(H.text)||S.a.v6e(H.text)))break;id=Xg.a.rH(id.FontColor);H.color=Yh.c(Le.a.nG(id));
break;case -1925065947:H.italic=id.Italic;break;case -1293291468:Y=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");this.Om?(H.EKb(id.FontName,Y,"ShowInstantaneousFormattingOnCell"),H.cZf(id.FontScheme)):H.EKb(id.FontName,Y,"ShowInstantaneousFormattingOnCell");break;case 862890474:case 963349338:H.fontSize=id.FontSize;this.$.Bf();break;case -1077965542:H.fontSize=id.FontSize;break;case 1764140053:H.underline=id.Underline;break;case -1685033574:H.doubleUnderline=
id.DoubleUnderline;break;case -1590502662:H.fontStrikethrough=id.Strikethrough;break;case -848953656:case 2045211913:Jf=H.eqb();break;case 2105621672:id=Object(Pa.a)(Yg.a,Va);if(!id)break;Y=Xg.a.yEh(id.color);H.color=Yh.c(Le.a.nG(Y));this.lre(H,id.hya);break;case -1409276245:this.lre(H,Y.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.iKg(H,Y);break;case -1228228458:H.eqb();H.clearFormat();this.NWc(H,0);Jf=!0;break;case -730106152:H.clearFormat();this.NWc(H,0);break;case 932244020:this.ioj(H,
Y,Pb);break;case -1942512156:case -1920201820:this.$pj(H,Y)}za||(Jf?H.HHb(!0):H.setCell(!0))}else nc.ULS.shipAssertTag(537162135,0,!H,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),nc.ULS.shipAssertTag(537162134,0,!Y,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};xb.prototype.l3g=function(k,H){k&&H?(k.nqb(H),k.T0c(H),this.NWc(k,H.cell.Ak)):nc.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};
xb.prototype.NWc=function(k,H){if(0>H)this.G_({caller:"ApplyNumberFormatIndexOnCell",cell:k,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});else{if(!this.qK&&(H=new Kf(this.Ll,this.Eo,H),!H.isValid())){this.G_({caller:"ApplyNumberFormatIndexOnCell",cell:k,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: invalid number format holder"});return}var Y=this.X2a(k.Hu,H,k.cell.hBa,k.cell.R$);Object(Nf.b)(Y)?this.G_({caller:"ApplyNumberFormatIndexOnCell",cell:k,
kind:"failure",reason:Y.reason}):(this.lZa(k,Y.value),this.qK?this.G_({caller:"ApplyNumberFormatIndexOnCell",cell:k,kind:"success",xz:Y.value,format:H}):this.WBb("ApplyNumberFormatIndexOnCell",k,!0,void 0,Y.value,H))}};xb.prototype.lre=function(k,H){if(void 0===H||null===H)this.G_({caller:"ApplyNumberFormatStringOnCell",cell:k,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{if(!this.qK&&(H=new Kf(this.Ll,this.Eo,void 0,H),!H.isValid())){this.G_({caller:"ApplyNumberFormatStringOnCell",
cell:k,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: invalid number format holder"});return}var Y=this.X2a(k.Hu,H,k.cell.hBa,k.cell.R$);Object(Nf.b)(Y)?this.G_({caller:"ApplyNumberFormatStringOnCell",cell:k,kind:"failure",reason:Y.reason}):(this.lZa(k,Y.value),this.qK?this.G_({caller:"ApplyNumberFormatStringOnCell",cell:k,kind:"success",xz:Y.value,format:H}):this.WBb("ApplyNumberFormatStringOnCell",k,!0,void 0,Y.value,H))}};xb.prototype.iKg=function(k,H){if(H=void 0===H?null:H)if(H=this.iWh(k,
H),H.success){var Y=this.X2a(k.Hu,H.xOa,k.cell.hBa,k.cell.R$);Object(Nf.b)(Y)?this.qK?this.G_({caller:"ApplyNumberFormatCategoryOnCell",cell:k,kind:"failure",reason:Y.reason,format:H.xOa}):this.WBb("ApplyNumberFormatCategoryOnCell",k,!1,Y.reason,void 0,H.xOa):(this.lZa(k,Y.value),this.qK?this.G_({caller:"ApplyNumberFormatCategoryOnCell",cell:k,kind:"success",xz:Y.value,format:H.xOa}):this.WBb("ApplyNumberFormatCategoryOnCell",k,!0,void 0,Y.value,H.xOa))}else this.qK?this.G_({caller:"ApplyNumberFormatCategoryOnCell",
cell:k,kind:"failure",reason:H.reason,format:H.xOa}):this.WBb("ApplyNumberFormatCategoryOnCell",k,!1,H.reason,void 0,H.xOa);else this.G_({caller:"ApplyNumberFormatCategoryOnCell",cell:k,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})};xb.prototype.ZJg=function(k){switch(k){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<k?-1:k};xb.prototype.iWh=function(k,
H){if(!this.Ll||!this.localeInfo||!H)return k=this.Ll?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new Xe(!1,void 0,"GetRibbonNumberFormat: "+k);H=H.NumberFormat;switch(H){case 0:k=je.XEh;break;case 1:k=je.ZEh;break;case 2:k=je.VEh;break;case 3:k=je.TEh;break;case 4:k=je.bFh;break;case 5:k=je.YEh;break;case 6:k=je.dFh;break;case 7:k=je.$Eh;break;case 8:k=je.WEh;break;case 9:k=je.aFh;break;case 10:k=je.cFh;break;case 11:case 12:return this.Ll.BUe(),this.yMh(k,
H);case 13:k=je.VRg;break;case 1006:k=je.buttonPercentage;break;case 1004:k=je.keyboardNumber;break;case 1005:k=je.keyboardCurrency;break;case 1002:k=je.keyboardDate;break;case 1001:k=je.keyboardTime;break;case 1003:k=je.keyboardPercentage;break;case 14:return k="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",nc.ULS.shipAssertTag(537162132,0,!1,k),new Xe(!1,void 0,k);default:return k="GetRibbonNumberFormat: unknown NumberFormatType!",nc.ULS.shipAssertTag(537162131,0,!1,k),new Xe(!1,
void 0,k)}if(!k)return new Xe(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...");k=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,k);if(!k)return new Xe(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format...");if(this.qK)return new Xe(!0,k);k=new Kf(this.Ll,this.Eo,void 0,k);return new Xe(!0,k)};xb.prototype.yMh=function(k,H){if(!this.calcManager||!this.Eo)return H=this.calcManager?"numberFormatter is null":
"calcManager is null",new Xe(!1,void 0,"GetDecimalChangeNumberFormat: "+H);k=k.cell.Ak;if(this.qK){k=this.calcManager.Rbc(k);if(!Object(Nf.c)(k))return new Xe(!1,void 0,"getDecimalChangeNumberFormat: "+k.reason);k=k.value}else if(k=this.calcManager.Dfd(new Kf(this.Ll,this.Eo,k)),!k)return new Xe(!1,void 0,"GetDecimalChangeNumberFormat: currentFormat is null");H=this.Eo.changeFormatDecimals(k,11===H?1:-1);if(!excelOnlineCalc.util.isSuccess(H))return new Xe(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure");
if(void 0===H.value||null===H.value)return new Xe(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result");if(this.qK)return new Xe(!0,H.value);H=new Kf(this.Ll,this.Eo,void 0,void 0,H.value);return new Xe(!0,H)};xb.prototype.G_=function(k){var H=k.caller,Y=k.cell,za=k.format;za=null==za?"null":"number"===typeof za?za:"string"===typeof za?S.a.Xga(za):S.a.Xga(za.formatString);var Va=S.a.Xga(Y.Hu.value)||"null",Pb="success"===k.kind?S.a.Xga(k.xz.text):"null";nc.ULS.sendTraceTag(537162130,
0,50,"FormatCellsAction.LogNumberFormatEdit: {0}",{caller:H,"range.top":Y.range.top,"range.left":Y.range.left,result:k.kind,reason:"success"===k.kind?"":k.reason,value:Va,valueType:Y.Hu.type,ifmt:za,prediction:Pb})};xb.prototype.WBb=function(k,H,Y,za,Va,Pb){za=void 0===za?"":za;Va=void 0===Va?null:Va;Pb=(Pb=void 0===Pb?null:Pb)?Pb.PQ?Pb.PQ.toString():S.a.Xga(Pb.formatString):"null";var Ac=S.a.Xga(H.Hu.value)||"null";Va=Va?S.a.Xga(Va.text)||"null":"null";k=String.format("FormatCellsAction.LogNumberFormatEdit: {{ caller: '{0}', range: '{1}, {2}', success: '{3}', reason: '{4}', value: '{5}', valueType: '{6}', ifmt: '{7}', prediction: '{8}' }}",
k,H.range.top,H.range.left,Y,za,Ac,H.Hu.type,Pb,Va);nc.ULS.sendTraceTag(523297929,0,50,k)};xb.prototype.jKg=function(k,H,Y,za,Va,Pb,Ac,id,Ld,ld,ef){id=void 0===id?!1:id;Ld=void 0===Ld?!1:Ld;var Jf=H.cell;Jf.cQ=void 0===ld?0:ld;ld=H.text;ld!==Y&&(Jf.text=Y);Jf.m9a=void 0===ef?null:ef;ih.e(ld)?H.formulaBarText=ld:H.formulaBarText="";k=Oe.g(k).Rb.Bff(H.range);this.V1b(H,za,null,id,Ld,k);Va&&(H.color=Yh.c(Le.a.nG(Va)));H.cell.Ak=Pb;H.cell.fpc=Ac;H.cell.zTd=Pb};xb.prototype.fui=function(k,H,Y,za,Va,Pb){var Ac=
{};Ac.a=this.$.ya.UserSessionId;Ac.b=H;Ac.c=za.Ranges.length;Ac.d=this.h7g(za.Ranges);Ac.e=Va.toString();Ac.f=k;Ac.h=Pb;1890566896===k?Ac.g=Y.NumberFormat.toString():2105621672===k&&(Ac.g=Y.NumberFormatOptions.NumberFormatCategory.toString());Wb.b().Qe(3,Ac,!0)};xb.prototype.h7g=function(k){for(var H=0,Y=0,za=0,Va=0;Va<k.length;Va++){var Pb=ve.B(k[Va]).uM;H+=Pb;Pb>za&&(za=Pb,Y=Va)}k=ve.B(k[Y]).toString();return"TotalCellCount:"+H+"; Max range:"+k+"; MaxRangeSize:"+za+";"};xb.prototype.ioj=function(k,
H,Y){64===(H.ValidMembers&64)&&this.setFillColor(k,H,Y);16===(H.ValidMembers&16)&&xb.Gpj(k,H);128===(H.ValidMembers&128)&&this.Kua.mKb(k,H,k.range);if(2===(H.ValidMembers&2)||1===(H.ValidMembers&1)){Y=H.VerticalAlignment;H=H.HorizontalAlignment;var za=0!==H;Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!za&&this.IZe(k);this.Kua.Fcb(k,H,za,Y)}};xb.prototype.setFillColor=function(k,H,Y){(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?
k.bba:k.bba&&k.ydc&&!k.Qwb&&!k.Vwb)||(H=-1===H.FillColor?Y?Le.a.nG(Xg.a.white):null:Le.a.nG(Xg.a.rH(H.FillColor)),k.backgroundColor=H?Yh.c(H):null)};xb.prototype.$pj=function(k,H){0!==k.horizontalAlignment&&2!==k.horizontalAlignment||k.v7(1,!1);0<=k.indentation+H.IndentationIncrease&&(k.indentation+=H.IndentationIncrease)};xb.prototype.joj=function(k,H){var Y=k.loa,za=H.TextOrientation;za!==Qc.a.verticalText&&(0>za||180<za)&&nc.ULS.shipAssertTag(523090050,0,!1,"FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server {0}",
za);Y===za||Y===Qc.a.ruc&&za===Qc.a.suc||Y===Qc.a.tuc&&za===Qc.a.uuc?H.TextOrientation=0:k.loa=H.TextOrientation};xb.prototype.IZe=function(k){if(this.qK)var H=k.cell.Ak;else if(H=new Kf(this.Ll,this.Eo,k.cell.Ak),!H.isValid())return 0;k=this.X2a(k.Hu,H,k.cell.hBa,k.cell.R$);return Object(Nf.b)(k)?0:null!=k.value.horizontalAlignment?k.value.horizontalAlignment:0};xb.prototype.lrj=function(k,H,Y){this.XA||(this.XA=new Pe(Oe.g(this.$).Ea,this.$));this.XA.mKb(k,H,Y)};xb.prototype.e3h=function(k,H){var Y=
new Ph.a;if(k.cell.formulaBarText&&k.cell.formulaBarText.startsWith("'"))Y.Text=k.cell.formulaBarText;else{var za=k.cellValue;za&&4!==k.cell.cQ||(za=k.text);Y.Text=za}this.NAa(H,Y,!1,void 0,ee.a.Rgc(this.$));return!0};xb.prototype.fRd=function(k,H){return this.Fb&&!!k&&!!H};xb.l0g=function(k,H,Y,za){za&&H.setCell(!0);0===Y&&k.Ea.WV()};xb.expandRange=function(k,H){H=H.clone();H.height<k.height&&(H.bottom=H.top+k.height-1);H.width<k.width&&(H.right=H.left+k.width-1);return H};xb.bei=function(k){switch(k){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;
default:return!1}};xb.Gpj=function(k,H){H=H.Font;var Y=0!==(H.ValidMembers&16),za=0!==(H.ValidMembers&16),Va=0!==(H.ValidMembers&16);k.bold=0!==(H.ValidMembers&4);k.italic=0!==(H.ValidMembers&8);Y&&(k.underline=Y);za&&(k.doubleUnderline=za);Va&&(k.fontStrikethrough=Va);Y=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");k.EKb(H.FontName,Y,"SetFont");k.fontSize=H.FontSize;Y=Le.a.fp(k.color,k.backgroundColor);Xg.a.compare(Y,Xg.a.red)&&(S.a.u5(k.text)||S.a.v6e(k.text))||
(H=Xg.a.rH(H.FontColor),k.color=Yh.c(Le.a.nG(H)))};Ek.Object.defineProperties(xb.prototype,{Kua:{configurable:!0,enumerable:!0,get:function(){return this.uDh}},Eo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.Eo}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});xb.GBh=36;Object(Dd.a)(xb,"FormatCellsAction",null,[790,
3]);var hj=gg.a;Am(Hd,hj);Hd.prototype.create=function(){this.Eb(new xb(this.$))};Hd.ka=function(k){k.da.Ga(18,new Hd(k))};Object(Dd.a)(Hd,"FormatCellsActionFactory",gg.a,[]);Object(Dd.a)(Bc,"FormulaAssistanceUIContext",null,[]);var Nj=gg.a;Am($d,Nj);$d.prototype.create=function(){var k=this,H=this.$.da.Aa(448);if(H)this.Eb(H);else{var Y=rf.GetServiceTaskFactory.Va(this.$.da,283,284,this.ub);Uf.TaskExtensions.Ba(Y,function(){Uf.TaskExtensions.Ba(Yc.c(Y.result.Jn.loadScript(k.ekj)),function(){H=k.$.da.Aa(448);
if(!H){var za=Object(ag.a)(new Bc,{isFeedbackAllowed:k.$.isFeedbackEnabled});H=k.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(za));k.$.Mxe(function(){var Va={};Va.isFeedbackAllowed=k.$.isFeedbackEnabled;H.updateContext(Va)})}k.Eb(H)},k.$.la,3)},this.$.la,3)}};$d.ka=function(k){k.da.Ga(449,new $d(k))};Object(Dd.a)($d,"FormulaAssistanceUIControlFactory",gg.a,[]);var bk=b(742);Object(Dd.a)(ae,"FreezePanesCommandParameters",null,[]);var yj=b(185),ij=b(411),ck=b(280),Ii=b(304),
jj=b(115);vd.prototype.getSheetName=function(){return this.freezeOptions.SheetName};Object(Dd.a)(vd,"MacroRecorderSheetPaneFrozenPayload",null,[445]);jc.prototype.Zc=function(k,H){var Y=!1;switch(H){case 1844679312:Y=1!==k&&!this.gridView.rb.U4}return Y};jc.prototype.executeCommand=function(k,H){k=this.gridView.rb;var Y=this.gridView.Chd();Vg.AFrameworkApplication.ta.Qa.Jz&&this.$.Kka&&(1844679312===H.command||340334732===H.command||-806625837===H.command)&&bk.ShyRibbon.dQ(1,2);switch(H.command){case 1844679312:return this.setFreezePanes(H,
Y,k.dj);case 340334732:return k.b$b?qh.Task.Sa(!1):this.Jpj(H,Y);case -806625837:return k.oTa?qh.Task.Sa(!1):this.Kpj(H,Y)}return qh.Task.Sa(!1)};jc.prototype.Lc=function(k,H){k=!1;switch(H.command){case 1844679312:case 340334732:case -806625837:case 1745254833:k=!0}return k};jc.prototype.jd=function(){return!1};jc.prototype.setFreezePanes=function(k,H,Y){if(Y)return this.wvc(k,!1,0,0,0,0,H,null);var za=this.gridView.ha.sa;Y=za.activeCell.clone();za=za.activeRange;za.ef&&(nc.ULS.sendTraceTag(537159585,
0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",Y.top,Y.bottom,H.top),Y.top=Y.bottom=H.top);za.isRow&&(nc.ULS.sendTraceTag(537159584,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",Y.left,Y.right,H.left),Y.left=Y.right=H.left);Y.top===H.top&&Y.left===
H.left&&(Y=mj.Range.hd(Y.top+1,Y.left));za=Y.top-1;var Va=Y.left-1,Pb=za-(H.top-1),Ac=Va-(H.left-1);return this.EUj(Y,Pb,Ac)?this.wvc(k,!0,za,Va,Pb,Ac,H,Y):(this.$.Bf(),this.zEf(),qh.Task.Sa(!0))};jc.prototype.Jpj=function(k,H){return this.wvc(k,!0,0,H.left,0,1,H,null)};jc.prototype.Kpj=function(k,H){return this.wvc(k,!0,H.top,0,1,0,H,null)};jc.prototype.EUj=function(k,H,Y){var za=this.gridView.qg(k),Va=this.gridView.view.visibleArea;return!za||Va.topLeft.y>za.bottomRight.y||Va.topLeft.x>za.bottomRight.x||
Va.bottomRight.y<za.bottomRight.y||Va.bottomRight.x<za.bottomRight.x?(nc.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",k,za?za.toString():"null",Va.toString()),k=he.a.gd(1,0,26,1459,0,2105967339,"FreezePaneSelectionNotInViewErr"),Ke.EwaSettings.Iz()?new ni.a(this.$,k):(k=new lg.ErrorDialog(this.$,k),k.initialize(),k.kf()),!1):0>=H&&0>=Y?(nc.ULS.sendTraceTag(537159582,
0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),k=Oe.g(this.$).rtl?1461:1460,H=Oe.g(this.$).rtl?-2131054257:-1953454131,k=he.a.gd(1,0,26,k,0,H,"FreezePaneA1SelectedErr"),Ke.EwaSettings.Iz()?new ni.a(this.$,k):(k=new lg.ErrorDialog(this.$,k),k.initialize(),k.kf()),!1):!0};jc.prototype.wvc=function(k,H,Y,za,Va,Pb,Ac,id){function Ld(){return new vd(ef)}var ld=this;this.OFd=Zi.a(this.$).L9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.LP(this.Xwf);
this.BF.UAa();this.gridView.eEj(H?"":"UnsetFreezePane");this.bsj(k,H,this.gridView.rb);var ef=Object(ag.a)(new ae,{SheetName:this.$.qa.name,Freeze:H,FrozenRows:Va,FrozenColumns:Pb,FirstRow:Y,FirstColumn:za});nc.ULS.sendTraceTag(573101852,0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",H,Va,Pb,Y,za);this.J$b=ff.a.Ta.oe;return zg.a(this.$.userOperationManager,function(Jf,Kg,Cg){if(Ke.EwaSettings.ma(61)){var Wg=window.performance;
Wg.clearMarks();Wg.mark("FreezePanes request sent")}Wg=ld.gridView.Qs;ld.$.ma(695)&&Wg?(Wg=ld.Ilh(ef,Wg,Ac,id),ld.pLj(Wg)):ld.$.Ky();Wg=ld.$.na.ua;var wi=Wg.Na(9,null);wi.freezeSettings=ef;return Jg.i(Wg,"FreezeOrUnfreezePanes",wi,Jf,Kg,Cg,H,0)},function(Jf){return new Ed.a(151,0,Jf,void 0,Ld)},k)};jc.prototype.Ilh=function(k,H,Y,za){nc.ULS.shipAssertTag(537159580,1,!!H,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!k.Freeze)return null;var Va=
Ii.a();Va.State=1;Va.IsEstimated=!0;var Pb=!1,Ac=!1,id=H.yV(mj.Range.hd(Y.top,Y.left)),Ld=k.FrozenRows,ld=k.FrozenColumns;1!==k.FrozenRows||k.FrozenColumns?k.FrozenRows||1!==k.FrozenColumns?(ld=H.yV(mj.Range.hd(k.FirstRow+1,k.FirstColumn+1)),H=H.yV(mj.Range.hd(Y.top,Y.left)),Va.Width=ld.gm-id.gm,Va.Height=ld.Wm-id.Wm,0<k.FrozenRows&&(Va.AbsoluteTop=ld.Wm,Ac=!0),0<k.FrozenColumns&&(Va.AbsoluteLeft=ld.gm,Pb=!0),Ld=ld.lL-H.lL,ld=ld.JJ-H.JJ):(Va.Width=H.jgd(yj.a.hd(Y.top,Y.left)),za=mj.Range.hd(Y.top,
Y.left+1),Va.AbsoluteLeft=id.gm+Va.Width,Pb=!0):(Va.Height=H.igd(yj.a.hd(Y.top,Y.left)),za=mj.Range.hd(Y.top+1,Y.left),Va.AbsoluteTop=id.Wm+Va.Height,Ac=!0);Ac&&(Va.FirstFrozenRow=Y.top,Va.FirstScrollableRow=za.top);Pb&&(Va.FirstFrozenColumn=Y.left,Va.FirstScrollableColumn=za.left);Va.VisibleRows=Ld;Va.VisibleColumns=ld;return Va};jc.prototype.pLj=function(k){var H=this;qh.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){H.$.qa&&H.$.ea&&(H.$.ea.KX(Qc.a.Se,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),
ij.b(H.$.qa,k,-1,void 0,!0))})};jc.prototype.bsj=function(k,H,Y){if(!Ke.EwaSettings.ma(666))switch(k.command){case 1844679312:if(H||-1===this.PKa&&-1===this.QKa)this.PKa=Y.Dx-Y.width+this.gridView.scrollLeft,this.QKa=Y.Ex-Y.height+this.gridView.scrollTop;break;case 340334732:if(H||-1===this.PKa)this.PKa=Y.Dx-Y.width+this.gridView.scrollLeft;break;case -806625837:if(H||-1===this.QKa)this.QKa=Y.Ex-Y.height+this.gridView.scrollTop}};jc.prototype.Qtc=function(){var k=this.gridView.rb;0<k.width?this.gridView.scrollLeft=
jj.a.Y0b(this.gridView.domElement,Oe.g(this.$).rtl,0):-1!==this.PKa&&(this.gridView.scrollLeft=this.PKa,this.PKa=-1);0<k.height?this.gridView.scrollTop=0:-1!==this.QKa&&(this.gridView.scrollTop=this.QKa,this.QKa=-1)};jc.prototype.zEf=function(){this.BF.KSa();kg.a.Ha(this.OFd);this.OFd=null;this.gridView.cL(this.Xwf)};Object(Dd.a)(jc,"FreezePanesCommandHandler",null,[429]);var Tj=oc.a;Am(pd,Tj);pd.prototype.Nd=function(){var k=this;Uf.TaskExtensions.Ba(rf.GetServiceTaskFactory.Va(this.$.da,12,477,
this.ub),function(H){k.Cd([new jc(k.$,H.result)])},this.$.la)};pd.ka=function(k){k.da.Ga(116,new pd(k))};Object(Dd.a)(pd,"FreezePanesCommandHandlerFactory",oc.a,[]);var zj=b(1017),hk=gg.a;Am(Hc,hk);Hc.prototype.create=function(){var k=this,H=rf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub),Y=rf.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub);Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([H,Y],this.la),function(){k.Eb(k.$.da.Aa(296)||k.$.da.Ga(296,new zj.BorderFormatManager(k.$,
H.result,Y.result)))},this.la,3)};Hc.ka=function(k){Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&k.da.Ga(468,new Hc(k))};Object(Dd.a)(Hc,"BorderFormatManagerFactory",gg.a,[]);var mk=b(1032),Oj=b(24),yh=b(96),Kk=b(257),Hk=b(372),Aj=b(368),dk=b(100),Lk;(function(k){k[k.insert=1]="insert";k[k.delete=2]="delete";k[k.rows=4]="rows";k[k.columns=8]="columns";k[k.cellsShiftHorizontal=16]="cellsShiftHorizontal";k[k.cellsShiftVertical=32]="cellsShiftVertical";k[k.insertRows=
5]="insertRows";k[k.insertColumns=9]="insertColumns";k[k.insertCellsShiftRight=17]="insertCellsShiftRight";k[k.insertCellsShiftDown=33]="insertCellsShiftDown";k[k.deleteRows=6]="deleteRows";k[k.deleteColumns=10]="deleteColumns";k[k.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";k[k.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(Lk||(Lk={}));Object(Dd.b)("InsertDeleteCellFlags",Lk);var ik=b(444);Object(Dd.a)(Ub,"MacroRecorderRangeInsertedOrDeletedPayload",null,[445]);var Uj=b(121),Mk=b(267),cl=b(1195);
b(321);nd.xed="GetFontPreviewData";Object(Dd.a)(nd,"FontWebServiceMethods",null,[]);ed.prototype.xed=function(k,H){var Y=this.kv,za=this.kv.hc(),Va=nd.xed;za=Y.Na(5,void 0===za?null:za);return Jg.i(Y,Va,za,k,H,null,null,644)};Object(Dd.a)(ed,"FontServiceManager",null,[]);ne.prototype.IVe=function(k,H,Y,za){za=void 0===za?null:za;var Va=Object(ag.a)(new Gh.a,{Id:"FontDropdownMenu"});Va.MenuSectionList=[];if(this.Om&&this.themesManager){this.themesManager.fad(za);if(null==this.themesManager.AL||this.themesManager.krd)return Va;
za=Object(ag.a)(new Oi.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:Ae.a.instance.fa(1306),ControlList:this.ZYh(k,H,Y)});Va.MenuSectionList.push(za)}za=Object(ag.a)(new Oi.a,{ControlsId:"FontsMenuSectionControl"});this.Om&&(za.Title=Ae.a.instance.fa(1307));za.ControlList=this.YOh(k,H,Y);Va.MenuSectionList.push(za);return Va};ne.prototype.ZYh=function(k,H,Y){var za,Va=[],Pb=Oe.g(this.$).ha.Oa.oc;Pb=5===(null===(za=null===Pb||void 0===Pb?void 0:Pb.floatingObject)||void 0===za?void 0:za.type);
if(this.themesManager.AL){var Ac=this.themesManager.AL.Upf;var id=this.themesManager.AL.pof}else nc.ULS.sendTraceTag(525361436,1,15,"ThemeFonts are Null");null!=id?(za=this.SEe(id,1,Pb,k,H,Y),Va.push(za)):nc.ULS.sendTraceTag(525361435,1,15,"Major Theme Font is Null");null!=Ac?(k=this.SEe(Ac,2,Pb,k,H,Y),Va.push(k)):nc.ULS.sendTraceTag(525361434,1,15,"Minor Theme Font is Null");return Va};ne.prototype.SEe=function(k,H,Y,za,Va,Pb){var Ac=2===H?this.cAi:this.ixi;Y=Y?Ac:Lg.a.nf(k);Ac=Lg.a.nf($c.HelperMethods.xcc(k,
H));k=Lg.a.nf(k);return Object(ag.a)(new cl.a,{MenuItemId:2===H?"MinorThemeFont":"MajorThemeFont",CommandValueId:Y,LabelText:Ac,LabelCss:String.format("font-size:12pt;font-family:{0};",k),Styles:ne.Uvb(k),AriaLabel:Ac,Alt:Ac,Command:za.toString(),CommandPreviewId:Va.toString(),CommandRevertId:Pb.toString()})};ne.prototype.YOh=function(k,H,Y){if(ne.iZc)return ne.iZc.C5c;var za=this.Kei&&!this.kff,Va=!1;ne.T2a||(ne.r$e(),Va=!0);var Pb=this.wDe(k,H,Y,ne.T2a,za,Va);Pb.kxc&&!Va&&(nc.ULS.sendTraceTag(523903238,
1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),ne.r$e(),Pb=this.wDe(k,H,Y,ne.T2a,za,Pb.kxc));this.ju&&!Pb.kxc&&(bg.a.Ki(ne.styles),ne.iZc=Pb);za&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.lPi);return Pb.C5c};ne.prototype.wDe=function(k,H,Y,za,Va,Pb){var Ac=[],id=this.ju&&!Pb;var Ld=id?"msofpNew":"msofp";for(var ld in za){var ef=ld,Jf=za[ld],Kg=Lg.a.nf(ef),Cg;if(id)if(Cg=ne.fea?ne.fea[ef]:null)Cg=Lg.a.nf(Cg);else return nc.ULS.sendTraceTag(523903237,
1,15,"FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for {0}",ef),{kxc:!0,C5c:[]};else Cg=Lg.a.nf($c.HelperMethods.fea[ef]);ef=Lg.a.nf(ef);Va||(Jf=0);Kg=Object(ag.a)(new cl.a,{MenuItemId:Kg,CommandValueId:Kg,LabelText:Va&&0<Jf?Lg.a.nf(String.fromCodePoint(Jf)):Cg,LabelCss:String.format("font-size:12pt;font-family:{0};",Va&&0<Jf?Ld:ef),Styles:ne.Uvb(Va&&0<Jf?Ld:ef),AriaLabel:Cg,Alt:Cg,Command:k.toString(),CommandPreviewId:H.toString(),CommandRevertId:Y.toString()});
Ac.push(Kg)}return{kxc:Pb,C5c:Ac}};ne.prototype.zqj=function(k){this.menuId=k};ne.prototype.yhi=function(){return 2!==this.oub&&3!==this.oub?!1:!0};ne.prototype.Nej=function(){this.oub=1;this.xUe||(this.xUe=new ed(this.$.na.kv));this.xUe.xed(this.VJi,this.WJi)};ne.prototype.a_i=function(k){if(this.Qni(k)){var H=$c.HelperMethods.hca(function(){var Y=k.Result;ne.styles='@font-face{font-family:"msofpNew";font-style:normal;font-weight:normal;src:url(\''+Y.PreviewUrl+"') format('truetype')}";var za=Y.FontFacePropertiesList;
Y=Y.FontNameList;ne.T2a={};ne.fea={};Y.forEach(function(Va,Pb){ne.T2a[Va]=za[Pb].Codepoint;ne.fea[Va]=Va})});10<H&&nc.ULS.sendTraceTag(523903236,1,50,"FontDropdownHelper.prepareFontCodepointMap: Duration for prepareFontCodepointMap the model, duration={0}",H)}};ne.prototype.Qni=function(k){if(!k.Result)return nc.ULS.sendTraceTag(523903235,1,15,"FontDropdownHelper.isValidFontPreviewData: Result in EwaResult is Null."),!1;k=k.Result;return k?k.PreviewUrl?k.FontFacePropertiesList?k.FontNameList?0==k.FontFacePropertiesList.length||
k.FontFacePropertiesList.length!=k.FontNameList.length?(nc.ULS.sendTraceTag(523903202,1,15,"FontDropdownHelper.isValidFontPreviewData: Mismatch in length of FontFacePropertiesList and FontNameList in fontListPreviewData."),!1):!0:(nc.ULS.sendTraceTag(523903203,1,15,"FontDropdownHelper.isValidFontPreviewData: FontNameList in fontListPreviewData is Null."),!1):(nc.ULS.sendTraceTag(523903232,1,15,"FontDropdownHelper.isValidFontPreviewData: FontFacePropertiesList in fontListPreviewData is Null."),!1):
(nc.ULS.sendTraceTag(523903233,1,15,"FontDropdownHelper.isValidFontPreviewData: PreviewUrl in fontListPreviewData is Null."),!1):(nc.ULS.sendTraceTag(523903234,1,15,"FontDropdownHelper.isValidFontPreviewData: fontListPreviewData is Null."),!1)};ne.prototype.VMf=function(){this.menuId&&this.frame.Uv(this.menuId)};ne.r$e=function(){var k={};ne.T2a=(k["Angsana New"]=983046,k["Arial Black"]=983051,k.Arial=983050,k.Batang=983061,k["Book Antiqua"]=983077,k["Browallia New"]=983082,k.Calibri=983085,k.Cambria=
983089,k.Candara=983091,k.Century=983095,k["Comic Sans MS"]=983100,k.Consolas=983101,k.Constantia=983102,k.Corbel=983106,k["Cordia New"]=983107,k["Courier New"]=983109,k.DilleniaUPC=983121,k.Dotum=983123,k.FangSong=983138,k.Garamond=983154,k.Georgia=983156,k.Gulim=983182,k.GungSuh=983186,k.KaiTi=983222,k.JasmineUPC=983218,k["Malgun Gothic"]=983258,k.Mangal=983262,k.Meiryo=983264,k["Microsoft JhengHei"]=983272,k["Microsoft YaHei"]=983284,k.MingLiU=983292,k.MingLiU_HKSCS=983296,k["MS Gothic"]=983245,
k["MS Mincho"]=983247,k["MS PGothic"]=983249,k["MS PMincho"]=983251,k.PMingliU=983322,k["PMingLiU-ExtB"]=983324,k.SimHei=983382,k.SimSun=983384,k["SimSun-ExtB"]=983386,k["Source Sans Pro"]=983396,k.Tahoma=983405,k.THSarabunPSK=983404,k["Times New Roman"]=983415,k["Trebuchet MS"]=983419,k.Verdana=983443,k["Yu Gothic"]=983464,k["Yu Mincho"]=983474,k)};ne.Uvb=function(k){var H={};H["font-family"]=k;H["font-size"]="12pt";return{optionText:H}};Ek.Object.defineProperties(ne.prototype,{themesManager:{configurable:!0,
enumerable:!0,get:function(){this.zx||(this.zx=this.$.da.Aa(422));return this.zx}}});Ek.Object.defineProperties(ne,{e7f:{configurable:!0,enumerable:!0,get:function(){return ne.fea}}});ne.T2a=null;ne.fea=null;ne.iZc=null;ne.styles=null;Object(Dd.a)(ne,"FontDropdownHelper",null,[792]);Xc.NQg=function(k,H){return new Xc(k,H,null,null,null)};Xc.bZc=function(k,H){return new Xc(k,null,H,null,null)};Xc.OQg=function(k,H){return new Xc(k,null,null,H,null)};Xc.MQg=function(k,H,Y){return new Xc(k,null,H,null,
Y)};Ek.Object.defineProperties(Xc.prototype,{FJa:{configurable:!0,enumerable:!0,get:function(){return this.zog}},formattedText:{configurable:!0,enumerable:!0,get:function(){return this.Aog}},style:{configurable:!0,enumerable:!0,get:function(){return this.Cwg}},size:{configurable:!0,enumerable:!0,get:function(){return this.WWb}},Gaa:{configurable:!0,enumerable:!0,get:function(){return this.wUe}}});Object(Dd.a)(Xc,"CachedPreviewCellGroup",null,[]);var Nk=b(66);bd.prototype.ML=function(){var k=this;
this.QDc=!1;if(Dh.b(this.mCa,514846606)){this.QDc=!0;nc.ULS.sendTraceTag(537159430,0,50,"Merge cells with multiple values");Nk.a(this.Cf.$).ud.kE(514846606);if(this.xPb&&this.$_d)window.setTimeout(function(){k.Cf.iaa(k.Cf.gridView,k.lCa,!0,!0)},0);else return this.p0d=Oe.g(this.Cf.$).rtl,this.r0d=he.a.gd(3,2,0,this.p0d?637:636,0,514846606,"MergeCellsLoseData"),this.kj=Zi.a(this.Cf.$).si(this.r0d).G(),this.kj.isCompleted||(this._state=2,this.kj.NN(this.moveNext)),this.JDc;return this.Sfb}return this.s1};
bd.prototype.s1=function(){this.Cf.plf(this.QDc,this.$_d,this.Lgg.scenario,this.xPb);this._state=3};bd.prototype.Sfb=function(){return this.s1};bd.prototype.JDc=function(){this.MDc=this.kj.Az();if(0===this.MDc)return nc.ULS.sendTraceTag(537159429,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.kj=this.Cf.iaa(this.Cf.gridView,this.lCa,!0,!1).g(),this.kj.isCompleted||(this._state=2,this.kj.NN(this.moveNext)),this.KDc;1===this.MDc&&nc.ULS.sendTraceTag(537159428,0,50,"MergeCellsLoseData Dialog: Cancel pressed");
return this.Ufb};bd.prototype.Ufb=function(){return this.Sfb};bd.prototype.KDc=function(){this.kj.Az();return this.Ufb};bd.prototype.dispose=function(){};Object(Dd.a)(bd,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOld",null,[3]);md.prototype.ML=function(){return Dh.b(this.mCa,514846606)?(nc.ULS.sendTraceTag(537159427,0,50,"Merge cells with multiple values"),Nk.a(this.Cf.$).ud.kE(514846606),this.m0d=Oe.g(this.Cf.$).rtl,this.n0d=he.a.gd(3,2,0,this.m0d?637:
636,0,514846606,"MergeCellsLoseData"),this.kj=Zi.a(this.Cf.$).si(this.n0d).G(),this.kj.isCompleted||(this._state=2,this.kj.NN(this.moveNext)),this.Rfb):this.s1};md.prototype.s1=function(){this._state=3};md.prototype.Rfb=function(){this.PDc=this.kj.Az();if(0===this.PDc)return nc.ULS.sendTraceTag(537159426,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.kj=this.Cf.iaa(this.Cf.gridView,this.lCa,!0,this.xPb).g(),this.kj.isCompleted||(this._state=2,this.kj.NN(this.moveNext)),this.Wgg;1===this.PDc&&
nc.ULS.sendTraceTag(537159425,0,50,"MergeCellsLoseData Dialog: Cancel pressed");return this.Tfb};md.prototype.Tfb=function(){return this.s1};md.prototype.Wgg=function(){this.kj.Az();return this.Tfb};md.prototype.dispose=function(){};Object(Dd.a)(md,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOldForNonDataLossCSE",null,[3]);var jk=b(388),sk=jk.a;Am(qc,sk);qc.prototype.hh=function(){1896159024===this.Er?(this.Hm=Ae.a.instance.fa(23),this.v6c=0):(this.Hm=
Ae.a.instance.fa(22),this.v6c=1);var k=this.selectedRanges[0].s_&&!this.selectedRanges[0].G5?0:1;this.jc=1;var H={};k=(H[qc.Yx]=this.Cc,H.dialogToDisplay=this.v6c,H.defaultSelectedKey=k,H.isRtl=this.isRtl,H);this.initializeAndShow(this.Hm,this.zbi,k)};Ek.Object.defineProperties(qc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});Object(Dd.a)(qc,"InsertDeleteCellsDialog",jk.a,[]);Object(Dd.a)(Wd,"MacroRecorderRangeFilledPayload",null,[445]);Object(Dd.a)(we,
"RangeBorders",null,[]);Object(Dd.a)(Ad,"ScenarioInfo",null,[]);Ob.prototype.dispose=function(){this.$=null};Ob.prototype.bgi=function(k,H){return!(void 0===H||null===H)&&!!(H.scenario&16384)&&!this.dgi(k,H)&&this.nbf(H,k)};Ob.prototype.C_e=function(){var k=Ga.a.Ce(),H=Oe.g(this.$),Y=H.ha.sa.selectedRanges,za=0,Va=0,Pb=Y.length,Ac=new Ad;if(1<Pb)return Ac.scenario=4,Ac;this.mpd&&Oe.g(this.$).rtl&&(za|=65536);if(!H.p_(Y[0]))if(this.Kyb)za|=32;else return Ac.scenario=32,Ac;if(H=H.Ea.T3a(Y[0],this.$.activeItemName))for(Ac.vYc=
H,H=El(H),Pb=H.next();!Pb.done;Pb=H.next())if(Va+=1,1<Va){this.Kyb?(za|=256,Ac.scenario=za):Ac.scenario=256;if(!this.Azb)return Ac;break}Va=Oe.g(this.$).Ea.Tua(Y[0]);if(!Va)return Ac.scenario=32768,Ac;H=Va.length;Y=Y[0];Pb=Y.bottom-Y.top+1;for(var id=Y.right-Y.left+1,Ld=new we,ld=0;ld<H;ld++)if(this.xff&&this.bVh(Va[ld],Y,Ld),za=za|(void 0!==Va[ld].text&&null!==Va[ld].text&&""!==Va[ld].text?1:0)|(Va[ld].iN?2:0)|(Va[ld].Mva?8:0)|(Va[ld].Owb?16:0)|(Va[ld].IH?64:0)|(Va[ld].bba?128:0),void 0!==Va[ld].text&&
null!==Va[ld].text&&""!==Va[ld].text||Va[ld].Mva)if(void 0===Ac.OQ||null===Ac.OQ)Ac.OQ=Oe.g(this.$).kc(Va[ld].getRange());else{if(Va[ld].getRange().top<Ac.OQ.range.top||Va[ld].getRange().top==Ac.OQ.range.top&&Va[ld].getRange().left<Ac.OQ.range.left)Ac.OQ=Oe.g(this.$).kc(Va[ld].getRange());za|=16384}this.xff&&(Ld.mTa===id&&(za|=512),Ld.BGa===id&&(za|=2048),Ld.BNa===Pb&&(za|=4096),Ld.PQa===Pb&&(za|=1024),0<Ld.mTa&&Ld.mTa<id||0<Ld.BGa&&Ld.BGa<id||0<Ld.BNa&&Ld.BNa<Pb||0<Ld.PQa&&Ld.PQa<Pb)&&(za|=8192);
!Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||Y.right!==Y.maxColumns&&Y.bottom!==Y.maxRows||(za|=131072);k=Ga.a.Ce()-k;nc.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenario is : {0}",k);Ac.scenario=za;return Ac};Ob.prototype.zpf=function(k,H){var Y=k.command;if(void 0===H||null===H)H=this.C_e();if(!this.nbf(H,Y))return!1;k=Oe.g(this.$).ha.sa.selectedRanges;var za=Oe.g(this.$).Ea.Tua(k[0]);if(!za)return!1;if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&
1===za.length&&!za[0].iN)return-167499203===Y?(za[0].v7(2,!0),!0):!1;za=Oe.g(this.$).ha.sa.rB;var Va=this.$.qa.sheetName,Pb=!0;switch(Y){case -167499203:2===(H.scenario&2)&&this.chc?this.Uag(H.scenario,k,Y):Pb=this.vzi(H,k);break;case 1097660126:(H=this.Apf(H,k))&&0!=H.length||(Pb=!1);break;case 155820588:this.Uag(H.scenario,k,Y);break;default:return!1}Oe.g(this.$).IV(k,za,Va,null,k[0],null,null,0,"MergeCellCommandAction");return this.Azb?Pb:!0};Ob.prototype.nbf=function(k,H){var Y=this.Pei(k,H);
if(!this.udf)return Y;var za=Oe.g(this.$).ha.sa.selectedRanges[0].pB(!1);nc.ULS.sendTraceTag(526149324,0,50,"Merge Cell Command: {0}; Scenario Number: {1}; IsCSEPossible result: {2}; Range: {3}",H.toString(),k.scenario,Y,za);return Y};Ob.prototype.Pei=function(k,H){if(-255094134===H)return!1;var Y=k.scenario;if(this.mpd&&65536===(Y&65536))return!1;if(this.rhf(H,k))return this.Ani(H,k);this.Kyb&&32===(Y&32)&&(Y&=-33);if(256==(Y&256))if(this.zji(k))Y&=-257;else return!1;return 32768===Y||4===Y||128===
(Y&128)||!this.Kyb&&32===Y?!1:-167499203!=H&&1097660126!==H||!this.knd(k)?void 0!==k.OQ&&null!==k.OQ&&k.OQ.cT?!1:0===Y?!0:16384===(Y&16384)?Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(Y&1)&&8!==(Y&8)||!Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.dhc};Ob.prototype.Qgi=function(k){return 131072===(k.scenario&131072)?!0:!1};Ob.prototype.zji=function(k){if(!this.Azb)return!1;var H="Multi block",
Y=!0;this.knd(k)&&(H+=" with border",Y=!1);this.Qgi(k)&&(Y=!1,H+=" with entire row or column selected",16384===(k.scenario&16384)&&(H+=" and a data loss scenario"));Y||nc.ULS.sendTraceTag(523511383,0,50,"CSE for {0}, is not enabled",H);return Y};Ob.prototype.knd=function(k){return 16===(k.scenario&16)||this.fjd(k.scenario)||this.yjd(k.scenario)||this.pjd(k.scenario)||this.Bjd(k.scenario)||8192===(k.scenario&8192)?!0:!1};Ob.prototype.dgi=function(k,H){return this.cgi?this.rhf(k,H):155820588===k};Ob.prototype.rhf=
function(k,H){return 155820588===k||(-167499203===k||1097660126===k)&&2===(H.scenario&2)&&this.chc?!0:!1};Ob.prototype.zni=function(k){return this.Bjd(k.scenario)||this.pjd(k.scenario)||this.fjd(k.scenario)||this.yjd(k.scenario)?!0:!1};Ob.prototype.Ani=function(k,H){if(1097660126===k&&2===(H.scenario&2)||this.Vfi&&void 0!==H.OQ&&null!==H.OQ&&H.OQ.cT)return!1;this.Kyb&&32===(H.scenario&32)&&(H.scenario&=-33);return 32768===H.scenario||4===H.scenario||256===(H.scenario&256)&&this.kji||128===(H.scenario&
128)?!1:2===(H.scenario&2)?this.zni(H)?Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1};Ob.prototype.bVh=function(k,H,Y){var za=k.getRange();if(za.top===H.top)if(k.$Ka)Y.mTa+=za.right-za.left+1;else{var Va=this.XA.UQ(za,0);if(Va){var Pb=El(Va);for(Va=Pb.next();!Va.done;Va=Pb.next())Va=Va.value,Va.UKa&&(Y.mTa+=Va.getRange().right-Va.getRange().left+
1)}}if(za.left===H.left)if(k.WKa)Y.BNa+=za.bottom-za.top+1;else if(Va=this.XA.UQ(za,2))for(Pb=El(Va),Va=Pb.next();!Va.done;Va=Pb.next())Va=Va.value,Va.YKa&&(Y.BNa+=Va.getRange().bottom-Va.getRange().top+1);if(za.bottom===H.bottom)if(k.UKa)Y.BGa+=za.right-za.left+1;else if(Va=this.XA.UQ(za,1))for(Pb=El(Va),Va=Pb.next();!Va.done;Va=Pb.next())Va=Va.value,Va.$Ka&&(Y.BGa+=Va.getRange().right-Va.getRange().left+1);if(za.right===H.right)if(k.YKa)Y.PQa+=za.bottom-za.top+1;else if(k=this.XA.UQ(za,3))for(k=
El(k),Va=k.next();!Va.done;Va=k.next())H=Va.value,H.WKa&&(Y.PQa+=H.getRange().bottom-H.getRange().top+1)};Ob.prototype.s9i=function(k,H){H=El(H.vYc);for(var Y=H.next();!Y.done;Y=H.next()){Y=k.Me(Y.value.uf);Y=Oe.g(this.$).Ea.Tua(Y);for(var za=Y.length,Va=1;Va<za;Va++){var Pb=Oe.g(this.$).kc(Y[Va].getRange());this.dhc?Pb.cell.deleteCellFromModel():(Pb.eqb(),Pb.clearFormat(),Pb.cell.u9i());Pb.HHb(!0)}}};Ob.prototype.VSj=function(k,H){k.backgroundColor=H.backgroundColor;k.color=H.color};Ob.prototype.Ihg=
function(k,H){return{SpansBlocks:!0,OriginRow:k,OriginColumn:H,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}};Ob.prototype.Xzg=function(k,H,Y,za,Va){Y=k.Me(Y.uf);if(!Y)return nc.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),null;var Pb=new mj.Range(k.top,k.left,Y.top,Y.left,!1,!1);if(Y.top==k.top)var Ac=0;else Pb.bottom=Y.top-1,Ac=
H.igd(Pb);Y.left==k.left?Pb=0:(Pb.right=Y.left-1,Pb=H.jgd(Pb));H=this.Ihg(k.top-1,k.left-1);H.OriginDeltaY=Ac;H.OriginDeltaX=Pb;H.Rows=Y.bottom-Y.top;H.Columns=Y.right-Y.left;H.Height=Va;H.Width=za;Y.top==k.top&&Y.left==k.left&&(H.IsOrigin=!0);k=Oe.g(this.$).kc(Y.topLeft);k.cell.HZf(H);return k};Ob.prototype.cPd=function(k,H){var Y=[],za=Oe.g(this.$).Qf;if(!za)return Y;var Va=za.igd(k),Pb=za.jgd(k);if(H.vYc){H=El(H.vYc);for(var Ac=H.next();!Ac.done;Ac=H.next())if(Ac=this.Xzg(k,za,Ac.value,Pb,Va))Y.push(Ac);
else{Y=[];break}}return Y};Ob.prototype.bWh=function(k,H,Y,za){var Va=Y.bottom-Y.top,Pb=Y.right-Y.left,Ac=[],id=za.scenario;if(256===(id&256)){if(Ac=this.cPd(Y,za),!Ac||0==Ac.length)return Ac}else H.cell.cPd(Va,Pb),Ac.push(H);Va=this.h3(this.j5(H),!0,0,id,"merge");if(void 0!==k&&null!==k){Pb=El(Ac);for(var Ld=Pb.next();!Ld.done;Ld=Pb.next()){Ld=Ld.value;var ld=k.cell.formattedText,ef=Object(ag.a)(new Ph.a,{TextRuns:ld.TextRuns,Fonts:ld.Fonts});ef.Text=void 0!==k.cell.originalText&&null!==k.cell.originalText?
k.cell.originalText:void 0!==k.cell.userInput&&null!==k.cell.userInput?k.cell.userInput:ld.Text;Va=this.h3(this.j5(Ld),Va,1,id,"merge");this.Ug.NAa(Ld,ef,!1,null,!0,"MergeCells",void 0,2);Va=this.h3(this.j5(Ld),Va,2,id,"merge");this.mpd?Ld.nqb(k):this.VSj(Ld,k);Va=this.h3(this.j5(Ld),Va,3,id,"merge");Ld.cell.j3g(k.cell);Va=this.h3(this.j5(Ld),Va,4,id,"merge");Ld.cell.mCc(!1);Va=this.h3(this.j5(Ld),Va,6,id,"merge")}}this.s9i(Y,za);this.h3(this.j5(H),Va,5,id,"merge");return Ac};Ob.prototype.pjd=function(k){return 4096===
(k&4096)};Ob.prototype.Bjd=function(k){return 512===(k&512)};Ob.prototype.fjd=function(k){return 2048===(k&2048)};Ob.prototype.yjd=function(k){return 1024===(k&1024)};Ob.prototype.tac=function(k,H){for(var Y=null,za=0;za<k.length;za++)if(k[za].BorderPosition===H){Y=k[za];break}return Y};Ob.prototype.oRh=function(k,H){this.Nhc?(H=this.tac(H.cell.SM().Borders,2))&&k.push(H):(H=H.cell.SM().Borders,1<H.length&&(H=[H[1]]),k=[].concat(Fl(H),Fl(k)));return k};Ob.prototype.rZh=function(k,H){this.Nhc?(H=this.tac(H.cell.SM().Borders,
0))&&k.push(H):(H=H.cell.SM().Borders,1<H.length&&(H=[H[0]]),k=[].concat(Fl(H),Fl(k)));return k};Ob.prototype.oJh=function(k,H){H=this.XA.UQ(H.cell.getRange(),1);if(this.Nhc){if(H=H[0].SM().Borders,H=this.tac(H,0))H.BorderPosition=1,k.push(H)}else{var Y=[];0<H.length&&(Y=H[0].SM().Borders);Y[0].BorderPosition=1;k=[].concat(Fl(Y),Fl(k))}return k};Ob.prototype.mWh=function(k,H){H=this.XA.UQ(H.cell.getRange(),3);if(this.Nhc){if(H=H[0].SM().Borders,H=this.tac(H,2))H.BorderPosition=3,k.push(H)}else{var Y=
[];0<H.length&&(Y=H[0].SM().Borders);Y[0].BorderPosition=3;k=[].concat(Fl(Y),Fl(k))}return k};Ob.prototype.cVh=function(k,H,Y){this.pjd(k.scenario)&&(H=this.oRh(H,Y));this.Bjd(k.scenario)&&(H=this.rZh(H,Y));this.fjd(k.scenario)&&(H=this.oJh(H,Y));this.yjd(k.scenario)&&(H=this.mWh(H,Y));return H};Ob.prototype.LZ=function(k){if(0===k.length)return null;var H=[0,0,0,0],Y=[1,1,1,1],za=0;k.forEach(function(Pb){var Ac=Pb.BorderPosition;Y[Ac]=Pb.BorderLineStyle;var id=new Xg.a(Pb.Color.Red,Pb.Color.Green,
Pb.Color.Blue);H[Ac]=id.QS();za|=$c.HelperMethods.x3a(Pb.BorderPosition)});k={};k.LineStyle=Y;k.Color=H;var Va={};Va.BorderFormat=k;Va.Border=za;return Va};Ob.prototype.V0d=function(k,H,Y){Y=void 0===Y?null:Y;var za=[];za=null!==Y?[].concat(Fl(Y)):this.cVh(H,za,k);H=this.LZ(za);k.cell.osc(k.cell.getRange());this.XA.pId(k.cell.getRange());this.Ug.Tda(Oe.g(this.$),-1690267012,H,!1,null,[k.cell.getRange()])};Ob.prototype.Dki=function(k){return 512===(k.scenario&512)||4096===(k.scenario&4096)||1024===
(k.scenario&1024)||2048===(k.scenario&2048)?!0:!1};Ob.prototype.sZh=function(k){k=this.XA.UQ(k.cell.getRange(),1);return k[0].$Ka?(k=k[0].SM().Borders[0],k.BorderPosition=1,k):null};Ob.prototype.tZh=function(k){k=this.XA.UQ(k.cell.getRange(),3);return k[0].WKa?(k=k[0].SM().Borders[0],k.BorderPosition=3,k):null};Ob.prototype.Q2h=function(k,H,Y,za,Va){H.cell.Qcg();this.Dki(k)?this.V0d(H,k):Va&&(Va=[],null!==Y&&Va.push(Y),null!==za&&Va.push(za),0<Va.length?this.V0d(H,k,Va):(H.cell.osc(H.cell.getRange()),
this.XA.pId(H.cell.getRange())))};Ob.prototype.MQh=function(k,H){return null===k||void 0===k?!0:k.cell.getRange().top===H.topLeft.top&&k.cell.getRange().left===H.topLeft.left&&k.cell.getRange().bottom===H.topLeft.bottom&&k.cell.getRange().right===H.topLeft.right?!0:!1};Ob.prototype.vzi=function(k,H){H=this.Apf(k,H);if(this.Azb&&(!H||0==H.length))return!1;for(var Y=0;Y<H.length;Y++)H[Y].v7(2,!0),this.h3(this.j5(H[Y]),!0,8,k.scenario,"merge");return!0};Ob.prototype.Apf=function(k,H){var Y=k.OQ,za=Oe.g(this.$).kc(H[0]),
Va=null,Pb=null;this.dhc&&(Va=this.sZh(za),Pb=this.tZh(za));var Ac=this.bWh(Y,za,H[0],k);if(this.Azb&&(!Ac||0==Ac.length))return Ac;Oe.g(this.$).Ea.k$(H[0],this.$.activeItemName).Rcg(H[0],!0);this.h3(this.j5(za),!0,9,k.scenario,"merge");if(this.dhc&&this.knd(k))for(H=this.MQh(Y,H[0]),Y=El(Ac),za=Y.next();!za.done;za=Y.next())this.Q2h(k,za.value,Va,Pb,H);return Ac};Ob.prototype.XJg=function(k,H,Y){var za=this;if(!(1>k.Borders.length)){var Va=this.LZ(k.Borders);Y.forEach(function(Pb){Pb=Oe.g(za.$).kc(Pb.getRange());
za.Ug.i3f(-1690267012,Pb,Va,!1,null,!1,H)})}};Ob.prototype.fOj=function(k,H,Y){for(var za=k.length,Va=0;Va<za;Va++){k[Va].cell.mCc();var Pb=k[Va].cell.getRange(),Ac=Oe.g(this.$).Ea.Tua(Pb),id=Ac.length;if(-167499203===H&&this.chc){var Ld=0;2===k[Va].cell.YGd||1===k[Va].cell.cQ?Ld=3:2===k[Va].cell.cQ&&(Ld=1);k[Va].v7(Ld,!1)}for(Ld=1;Ld<id;Ld++)Ac[Ld].attachCellToModel(),Ac[Ld].nqb(k[Va]),-167499203===H&&this.chc&&Ac[Ld].v7(null,!1);this.shf&&Y&&this.XJg(Y[Va],Pb,Ac)}};Ob.prototype.nWe=function(k,H){for(var Y=
null,za=0;za<k.length;za++)if(k[za].BorderPosition===H){Y=k[za];break}return Y};Ob.prototype.nJh=function(k,H){var Y=k.cell.SM();k.UKa()&&k.cell.mQa(1);k.YKa()&&k.cell.mQa(3);k=this.XA.UQ(H,0);if(k[0].UKa){var za=k[0].SM().Borders;za=this.nWe(za,1);za.BorderPosition=0;Y.Borders.push(za);k.forEach(function(Va){Va.mQa(1)})}H=this.XA.UQ(H,2);H[0].YKa&&(k=H[0].SM().Borders,k=this.nWe(k,3),k.BorderPosition=2,Y.Borders.push(k),H.forEach(function(Va){Va.mQa(3)}));return Y};Ob.prototype.Uag=function(k,H,
Y){var za=Oe.g(this.$).Ea.lva(H[0],this.$.activeItemName),Va=Oe.g(this.$).Ea.k$(H[0],this.$.activeItemName),Pb=[];if(void 0!==za&&null!==za&&(H=Oe.g(this.$).sja(H[0],za),void 0!==H&&null!==H)){H=H.$$ge();for(za=[];H.$$mn();){var Ac=H.$$cu();if(Ac.rF){Pb.push(Ac);this.h3(this.j5(Ac),!0,10,k,"unmerge");Ac.cell.UXg();var id=Ac.cell.getRange();this.h3(this.j5(Ac),!1,11,k,"unmerge");Va.Rcg(id,!1);this.shf&&(Ac=this.nJh(Ac,id),za.push(Ac))}}0<Pb.length&&(Va.Ef.resetCellLookup(),this.fOj(Pb,Y,za))}};Ob.prototype.h3=
function(k,H,Y,za,Va){if(!this.udf)return!1;k!==H&&nc.ULS.sendTraceTag(526149323,0,50,"Merge Information for resultant cell is unexpectedly changed at step: {0}; Scenario: {1}; Command: {2}; Expected: {3}; Actual: {4}",Y,za,Va,H?"populated":"empty",k?"populated":"empty");return k};Ob.prototype.j5=function(k){return!!k.cell.cell.Merge};Object(Dd.a)(Ob,"MergeCellCommandAction",null,[]);var Ij=b(105),il=b(492),Rk=b(395),pl=b(907),jl=b(354);Zc.prototype.Cii=function(k){return 1896159024===k||-1554384558===
k||-1113896058===k||1554436520===k||1415868706===k||674605324===k||1035996630===k};Zc.prototype.Zc=function(k,H){return 2054778433===H&&k&1?!mg.a(this.$).Qhc:600686207===H?!1:this.Cii(H)&&Uh.a.any(this.gridView.ha.sa.selectedRanges,function(Y){return Y.ef||Y.isRow})&&!this.ogf&&!this.jgf?!0:this.iic(k,H)};Zc.prototype.executeCommand=function(k,H,Y){return this.Xb(H,Y)};Zc.prototype.Lc=function(k,H,Y){if(k=1===k)switch(H.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:k=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:k=
!!Y;break;case 862825906:case 1532790410:case 46555851:case -1522760979:k=!0;break;default:k=!1}return k};Zc.prototype.jd=function(k,H,Y){switch(H){case "PopulateFontColor":Y.MenuItems=this.HB.Gac(1970784898,-803000997,null,-128950598,2036397036,1688184685,862825906,Y.MenuId);break;case "PopulateFillColor":Y.MenuItems=this.HB.Gac(1650812936,null,87208751,673562736,1457172838,-446735083,1532790410,Y.MenuId);break;case "PopulateBorderColor":Y.MenuItems=this.HB.Gac(-236759591,-1803452024,void 0,void 0,
void 0,void 0,46555851,Y.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.h3h(Y);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.ju&&(this.tbd.zqj(Y.MenuId),!this.tbd.yhi()))return!1;Y.MenuItems=this.tbd.IVe(-1293291468,324978188,-1428968098,Y.MenuId);break;default:return!1}return!0};Zc.prototype.iic=function(k,H){var Y=Oe.g(this.$).ha.sa.selectedRanges;return!(new Af.a(this.$.xa)).Nm(k,H,Y,this.gridView)};Zc.prototype.Xb=function(k,H){var Y=this,za=this.gridView,
Va=k.command,Pb=Uf.TaskExtensions.hl(),Ac=!0;switch(Va){case -1077965542:Ac=this.k5e(H,k,!1);break;case 909774670:this.upb(Va);Ac=this.k5e(H,k,!0);break;case -1293291468:Ac=this.i5e(H,k,!1);break;case 324978188:Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&nc.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.upb(Va);Ac=this.i5e(H,k,!0);break;case 862890474:case 963349338:Ac=this.E2h(k);break;case -1832800737:Ac=
this.idc(Va,H,!1,k);break;case 1970784898:Ac=this.idc(Va,H,!1,k);break;case -803000997:Ac=this.idc(Va,H,!1,k);break;case -128950598:case 1688184685:this.upb(Va);Ac=this.idc(Va,H,!0,k);break;case 1597684571:Ac=this.Ewb(Va,H,!1,k);break;case 87208751:H.Color="-1";H.IntColor=!0;Ac=this.Ewb(Va,H,!1,k);break;case -446735083:this.upb(Va);H.Color="-1";H.IntColor=!0;Ac=this.Ewb(Va,H,!0,k);break;case 1650812936:Ac=this.Ewb(Va,H,!1,k);break;case 673562736:this.upb(Va);Ac=this.Ewb(Va,H,!0,k);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(k=Wb.b().ri(Va),nc.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",k));this.eTf(Va);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Ac=this.p2h(Va,k);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Ac=this.z1h(Va,k);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Ac=this.d3h(Va,k);break;case -1803452024:case -236759591:Ac=
this.fid(Va,H,k);break;case -2118943501:Ac=this.borderFormatManager.K1h(H,k);break;case 1012765228:Ac=this.borderFormatManager.v3h(H,k);break;case 1256700402:Ac=this.borderFormatManager.kid(k);break;case -1756763834:Ac=this.borderFormatManager.lid(k);break;case -1418159950:Ac=this.borderFormatManager.X4e(k);break;case -1920201820:case -1942512156:Ac=this.F2h(Va,k);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Ac=this.borderFormatManager.K4e(H,k);this.Zzh(H);
break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Ac=this.$2h(Va,H,k);break;case -693675336:case 322710748:break;case 1696566924:Ac=this.q2h(k);break;case -167499203:case -255094134:case 1097660126:case 155820588:Pb=this.handleMergeCellsCommand(this.gridView,k);break;case 1896159024:case -1554384558:H=this.gridView.ha.sa.selectedRanges;if(this.jxj(k,H))nc.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new qc(this.$,
Va,H)).hh(),Ac=!0;else if(Uh.a.any(H,function(Ld){return Y.gridView.Rb.Vwa(Ld)})){za="";Pb=1461300262;var id=-1554384558===Va&&this.gridView.Rb.Eki(H[0]);H=H[0].height>H[0].width&&!id;switch(Va){case 1896159024:za=H?"InsertColumnsTable":"InsertRowsTable";Pb=H?622604322:942362098;break;case -1554384558:za=H?"DeleteColumnsTable":"DeleteRowsTable",Pb=H?284490184:1405456548}H=Ih.a.ao(Zc.mmd,za,1);new vh.a(Pb,1,2,6,null);Pb=this.insertOrDeleteCells(H,k,!0)}else Pb=this.insertOrDeleteCells(1896159024===
Va?1:2,k,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:Pb=this.insertOrDeleteCells(Ih.a.ao(Zc.mmd,H[Re.a.ld],1),k,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:Pb=this.insertOrDeleteCells(Ih.a.ao(Zc.mmd,H[Re.a.ld],1),k,!1);break;case 504848446:Pb=za.startEdit(!1,1,H[Ea.a.event],void 0,void 0,!0);break;case 1504715724:if(Oe.g(this.$).Ez&&this.borderFormatManager.cV.vB)break;Pb=za.startEdit(!0,0,H[Ea.a.event],void 0,void 0,!0);break;
case 1872288872:this.iqb();break;case 41465729:Pb=this.fill(za.ha.sa.qd,null,0,1,k);break;case -1451655532:case 1972143101:Pb=this.fillDownAbsoluteValueAndStartEdit(za,H[Ea.a.event],-1451655532===Va);break;case -475861485:Pb=this.fill(za.ha.sa.qd,null,za.rtl?1:2,1,k);break;case -978843926:Pb=this.fill(za.ha.sa.qd,null,3,1,k);break;case 2098035706:Pb=this.fill(za.ha.sa.qd,null,za.rtl?2:1,1,k);break;case -2142700828:Pb=this.fill(za.ha.sourceRange,za.ha.sa.qd,Zc.TYe(za.ha.sa.qd,za.ha.sourceRange),2,
k);break;case 1405660955:Pb=this.fill(za.ha.sourceRange,za.ha.sa.qd,Zc.TYe(za.ha.sa.qd,za.ha.sourceRange),4,k);break;case 1983983164:Pb=this.fill(za.ha.sa.qd,null,0,0,k);break;case 478842689:(k=this.$.da.Aa(376))?(k.P2i(),Ac=!0):nc.ULS.sendTraceTag(537159509,0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Ac=za.ha.Xb(null,Va);break;case -208772570:this.W2h();Ac=
!0;break;case -987339782:this.S1h();Ac=!0;break;case -1770246794:za.ha.T1h();Ac=!0;break;case 748067091:case -381232414:this.W1h(Va);Ac=!0;break;case -1522760979:this.gridView.toggleFormulaView();Ac=!0;break;case 886009118:Pb=this.C2h();break;case 894341014:this.H2h();Ac=!0;break;case 862825906:Pb=this.z5e(1970784898,k);break;case 1532790410:Pb=this.z5e(1650812936,k);break;case 46555851:Pb=this.S2h(k);break;default:Ac=!1}Ac||(Pb=Qg.a(Va));return Pb};Zc.prototype.Zzh=function(k){k&&k.MenuItemId&&["OutsideBorders",
"AllBorders","ThickOutsideBorders"].includes(k.MenuItemId)&&Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.uOg(new jl.a(this.gridView.ha.sa.activeRange,Yf.d(this.$.xa.qa)))};Zc.prototype.uOg=function(k){Uf.TaskExtensions.Ba(rf.GetServiceTaskFactory.Va(this.$.da,426,427,1),function(H){H.result.m$f(k)},this.$.la,3)};Zc.prototype.jxj=function(k,H){var Y=this,za=Uh.a.all(H,function(Ac){return!Y.gridView.Rb.Vwa(Ac)}),Va=1<H.length&&
!!this.gridView.Rb.Zgd(H),Pb=Uh.a.all(H,function(Ac){return!Y.gridView.Rb.Gka(Ac)});H=!Uh.a.any(H,function(Ac){return Ac.isRow||Ac.ef});return 1===k.method&&6===k.Ye&&(za||Va)&&Pb&&H};Zc.prototype.fillDownAbsoluteValueAndStartEdit=function(k,H,Y){var za=this,Va=k.ha.sa.activeCell,Pb=ve.E(Va,this.gridView.Qs);return k.startEdit(!0,0,H).CWR(function(){var Ac=k.kc(Pb),id=k.kc(Va);if(!Ac||!id)return nc.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",
Va.toString(),Pb.toString()),qh.Task.Sa(!1);za.gridView.rc.text=Y?Ac.g1:Ac.text;za.gridView.rc.textBox.setCaretPositionToEnd();return qh.Task.Sa(!0)})};Zc.prototype.insertOrDeleteCells=function(k,H,Y){function za(){return new Ub(ld)}var Va=this,Pb=ji.a.create().toString(),Ac=Enum.toString(Lk,k);this.gridView.Ji.K7(17,Pb,Ac);Ac=this.gridView.ha.sa.selectedRanges;var id=this.ogf,Ld=this.jgf;if(!this.$.Cq(null,!1,void 0,H.Ye)&&!Ld&&!id&&5!==k&&9!==k)return qh.Task.Sa(!0);2===k?k=Ld?10:id?6:Ac[0].height>
Ac[0].width?18:34:1===k?k=Ld?9:id?5:Ac[0].height>Ac[0].width?17:33:18===k&&id?k=34:34===k&&Ld&&(k=18);Ac=this.THg(Ac,k);if((10===k||6===k)&&!this.$.Cq(Ac,!0,1,H.Ye))return qh.Task.Sa(!0);var ld={};ld.InsertDeleteRangeItems=Array(Ac.length);ld.SheetName=this.$.qa.sheetName;ld.IsTableCommand=Y;for(Y=0;Y<Ac.length;Y++){id=Ac[Y];var ef={},Jf=Ld=void 0;k&4?(ef.FirstRow=id.top-1,ef.LastRow=Qc.a.wy,ef.FirstColumn=0,ef.LastColumn=Qc.a.wv,Ld=id.bottom-id.top+1,Jf=0,6===k&&(id.ef||(ef.FirstRow=id.bottom),Ld=
-Ld)):k&8?(ef.FirstRow=0,ef.LastRow=Qc.a.wy,ef.FirstColumn=id.left-1,ef.LastColumn=Qc.a.wv,Ld=0,Jf=id.right-id.left+1,10===k&&(id.isRow||(ef.FirstColumn=id.right),Jf=-Jf)):k&16?(ef.FirstRow=id.top-1,ef.LastRow=id.bottom-1,ef.FirstColumn=id.left-1,ef.LastColumn=Qc.a.wv,Ld=0,Jf=id.right-id.left+1,18===k&&(ef.FirstColumn=id.right,Jf=-Jf)):(ef.FirstRow=id.top-1,ef.LastRow=Qc.a.wy,ef.FirstColumn=id.left-1,ef.LastColumn=id.right-1,Ld=id.bottom-id.top+1,Jf=0,34===k&&(ef.FirstRow=id.bottom,Ld=-Ld));ef={InsertDeleteRange:ef};
ef.DeltaRow=Ld;ef.DeltaColumn=Jf;ef.AdjustedSelectedRange=ve.j(id);ld.InsertDeleteRangeItems[Y]=ef}this.gridView.rg.dH(!1);var Kg=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");ld.IsDecoupleRecalc=Kg;var Cg=this.$.na.ua.hc();return zg.a(this.$.userOperationManager,function(Wg,wi,oj){Kg&&!Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||Va.$.Ky();var fj=Va.$.na.ua;Wg=Rg.b(Wg,Va.EMi);var Wj=fj.Na(41,void 0===Cg?null:Cg);Wj.insertDeleteMultiRangeParameters=
ld;return Jg.i(fj,"InsertDeleteCells",Wj,Wg,wi,oj,Pb,0)},function(Wg){return new Ed.a(237,0,Wg,void 0,za)},H)};Zc.prototype.THg=function(k,H){return H&32?this.XYa(k,function(Y){return Y.bottom},function(Y){return Y.top},function(Y,za){Y.bottom=za},!1,!0):H&16?this.gridView.rtl?this.XYa(k,function(Y){return Y.left},function(Y){return Y.right},function(Y,za){Y.left=za},!1,!1):this.XYa(k,function(Y){return Y.right},function(Y){return Y.left},function(Y,za){Y.right=za},!1,!1):H&4?this.XYa(k,function(Y){return Y.bottom},
function(Y){return Y.top},function(Y,za){Y.bottom=za},!0,!0):H&8?this.gridView.rtl?this.XYa(k,function(Y){return Y.left},function(Y){return Y.right},function(Y,za){Y.left=za},!0,!1):this.XYa(k,function(Y){return Y.right},function(Y){return Y.left},function(Y,za){Y.right=za},!0,!1):k};Zc.prototype.XYa=function(k,H,Y,za,Va,Pb){k=ve.d(k);k.sort(function(Ld,ld){return H(ld)-H(Ld)});if(Va){Va=[];Pb=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?Pb?Qc.a.Hh+1:Qc.a.Qh+
1:Pb?Qc.a.wy:Qc.a.wv;for(var Ac=0;Ac<k.length;Ac++){var id=k[Ac];Y(id)<Pb&&(za(id,Math.min(H(id),Pb-1)),Va.push(id),Pb=Y(id))}k=Va}return k};Zc.prototype.fill=function(k,H,Y,za,Va){function Pb(){return new Wd(Ld,ld,za,Y)}var Ac=this,id=this.$;if(!id.Cq([H],!0))return qh.Task.Sa(!0);var Ld=ve.v(k,id),ld=H?ve.v(H,id):Ld,ef=this.$.na.ua.hc();return zg.a(this.$.userOperationManager,function(Jf,Kg,Cg){Ac.$.Ky();var Wg=Ac.$.na.ua,wi=Wg.Na(9,ef);wi.sourceRange=Ld;wi.targetRange=ld;wi.fillDirection=Y;wi.fillType=
za;return Jg.i(Wg,"FillRange",wi,Jf,Kg,Cg,null,0)},function(Jf){return new Ed.a(155,0,Jf,void 0,Pb)},Va)};Zc.prototype.$2h=function(k,H,Y){var za={ValidMembers:32};switch(k){case 1890566896:k=parseInt(H[Re.a.ld].toString(),10);if(14===k)return Y=new vh.a(2105621672,Y.method,Y.mode,Y.Ye,Y.tabName),H[Re.a.ld]=null,this.$.Ka.Xb(Y,H),nc.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;za.NumberFormat=k;break;case 1886928607:za.NumberFormat=
13;break;case -992833457:za.NumberFormat=11;break;case 218524921:za.NumberFormat=12;break;case 996232352:za.NumberFormat=1006;break;default:return nc.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+Wb.b().ri(Y.command)),!1}nc.ULS.sendTraceTag(537159504,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",Wb.b().ri(Y.command),H[Re.a.ld]);this.Ug.formatCells(1890566896,za,Y);this.$.Bf();return!0};Zc.prototype.E2h=function(k){var H=
this.gridView.kc(this.gridView.ha.sa.activeCell);if(this.Fb&&this.gridView.isEditing){H=this.gridView.lk.R3a(H?ih.a(H).Font:null);if(!H)return nc.ULS.shipAssertTag(537159503,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",this.gridView.ha.sa.activeCell.toString()),!1;var Y=H.FontSize}else if(H)Y=H.fontSize;else return!1;H=k.command;var za=0;if(862890474===H)for(;za<Zc.DJa.length-1&&Zc.DJa[za]<=Y;)za++;else if(963349338===H)for(za=Zc.DJa.length-
1;0<za&&Zc.DJa[za]>=Y;)za--;nc.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",Y,Zc.DJa[za]);if(Y===Zc.DJa[za])return!0;Y=Zc.Uvc(2);Y.Font.FontSize=Zc.DJa[za];this.Fb&&this.gridView.isEditing?(this.bob(k,!1,Y),this.$.Bf()):this.Ug.formatCells(H,Y,k);return!0};Zc.prototype.k5e=function(k,H,Y){k=k[k[mk.a.IsFreeForm]?mk.a.Value:Re.a.Cg].toString();if(!Zc.jZi.test(k))return nc.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),
Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;k=parseFloat(k);if(8>k||72<k)return nc.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits ({0} - {1}).",8,72),Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var za=Math.round(2*k)/2,Va=Zc.Uvc(2);Va.Font.FontSize=za;this.Fb&&this.gridView.isEditing?(this.bob(H,Y,Va,
!0),za===k||Y||this.$.Bf()):Y?this.Ug.Tda(this.gridView,-1077965542,Va,Y):(this.Ug.formatCells(-1077965542,Va,H),this.Q_a());return!0};Zc.prototype.i5e=function(k,H,Y){var za=k[Re.a.Cg];if(this.ju){var Va=ne.e7f?ne.e7f[za]:null;Va||(nc.ULS.sendTraceTag(523903201,1,15,"GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for {0}",za),Va=$c.HelperMethods.fea[za])}else Va=$c.HelperMethods.fea[za];var Pb=0;this.Om&&(k=k.MenuItemId,"MinorThemeFont"===k?(za==this.themesManager.AL.Upf&&
(Va=za),Pb=2):"MajorThemeFont"===k&&(za==this.themesManager.AL.pof&&(Va=za),Pb=1));if(!Va)return!0;za=Zc.Uvc(1);za.Font.FontName=Va;this.Om&&(za.Font.FontScheme=Pb);this.Fb&&this.gridView.isEditing?(this.bob(H,Y,za),this.$.Bf()):Y?this.Ug.Tda(this.gridView,-1293291468,za,Y):(this.Ug.formatCells(-1293291468,za,H),this.Q_a());return!0};Zc.prototype.idc=function(k,H,Y,za){var Va=-803000997===k||1688184685===k?"black":H.Color;this.moreColorsHelper&&(-1832800737===k?Va=S.a.compare(Va,"WindowText",!0)?
this.moreColorsHelper.kHb:"black":Y||(this.moreColorsHelper.kHb=Va,this.moreColorsHelper.bda(H,Va,za)));k=Zc.Uvc(32);k.Font.FontColor=Le.a.sH(Va,Ih.a.zg(H,"IntColor"));this.Fb&&this.gridView.isEditing?this.bob(za,Y,k,17===za.Ye):Y?this.Ug.Tda(this.gridView,1970784898,k,Y):(this.ZC&&(Y=this.getThemeColor(H),H=Y.themeColor,Y.returnValue&&(k.Font.ThemeFontColor=H,k.Font.ColorTypeOption=1)),this.Ug.formatCells(1970784898,k,za),this.Q_a());return!0};Zc.prototype.W1h=function(k){var H=(new Date).format(748067091===
k?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),Y=this.gridView.Dj?Uj.a(this.gridView.$):this.gridView.rc;k=Y.textBox;if(this.gridView.isEditing)Y.insertText(H);else{var za=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6336696_ChangeEditingModeAfterInsertDateOrTime")?0:1;this.gridView.startEdit(!0,za);Y.text=H;H=H.length;k.tRa(H);k.caretPosition=H}};Zc.prototype.W2h=function(){this.gridView.p_(this.gridView.ha.sa.activeCell)||this.gridView.pvc||this.gridView.DMa()||this.gridView.nt(this.gridView.ha.sa.activeCell,
3,Ij.a.v4e)};Zc.prototype.S1h=function(){if(!(this.gridView.pvc||this.gridView.DMa()||this.gridView.isEditing&&Oj.a.isMac)){var k=this.gridView.ha.sa.x4;this.gridView.Gg(ve.v(k,this.$),k,null,null,60,Ij.a.v4e)}};Zc.prototype.q2h=function(k){var H=this;this.B$b=Yf.d(this.$.xa.qa);var Y=this.$.da.Aa(254,!0);if(this.gridView.q6a)return this.gridView.rg.dH(!1),!!Y;if(!Y)return nc.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.IY(this.Jbd);
var za=String.format(Ea.a.zta,Sg.a.current.kp(84));this.gridView.rg.Mo(za);k=new vh.a(-911352779,k.method,k.mode,k.Ye,k.tabName);za={};this.$.Ka.Xb(k,(za[Ea.a.silentClipboardAccessFailures]=!0,za[Ea.a.isFormatPainter]=!0,za)).continueWith(function(Va){(6>Va.status||6===Va.status&&!Va.result)&&H.iqb()});this.gridView.q6a=!0;Y.SFg(this.iqb);return!0};Zc.prototype.Ewb=function(k,H,Y,za){var Va=87208751===k?"-1":H.Color;this.moreColorsHelper&&(1597684571===k?Va=this.moreColorsHelper.Mab:Y||(this.moreColorsHelper.Mab=
Va===Zc.notSet?Zc.OWd:Va,this.moreColorsHelper.bda(H,Va,za)));k={ValidMembers:64};k.FillColor=Le.a.sH(Va,Ih.a.zg(H,"IntColor"));Y?this.Ug.Tda(this.gridView,1650812936,k,!0):(this.ZC&&(Y=this.getThemeColor(H),H=Y.themeColor,Y.returnValue&&(k.ThemeFillColor=H,k.ColorTypeOption=1)),this.Ug.formatCells(1650812936,k,za),this.Q_a());return!0};Zc.prototype.H2h=function(){nc.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");var k=this.$.da.Aa(221);
if(k){var H=this.gridView.lk;if(H){var Y=k.Bbi(H.text,H.textBox.caretPosition);var za=Y.drf;var Va=Y.FTe;(Y=Y.returnValue)?(k.isListVisible=!1,H.text=Y,H.textBox.selectRange(za,za+Va),nc.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):nc.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else nc.ULS.shipAssertTag(537159491,
0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else nc.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};Zc.prototype.p2h=function(k,H){var Y=0,za=this.gridView,Va=ih.a(za.kc(null));this.Fb&&za.isEditing&&(Va.Font=za.lk.R3a(Va.Font));var Pb=Va.Font;Pb||(Pb={ValidMembers:0});switch(k){case -287251124:Y|=4;Mk.e(Pb,4)?Pb.Bold=!Pb.Bold:Pb.Bold=!0;break;case -1925065947:Y|=8;Mk.e(Pb,8)?Pb.Italic=
!Pb.Italic:Pb.Italic=!0;break;case 1764140053:Y|=16;Mk.e(Pb,16)?Pb.Underline=!Pb.Underline:Pb.Underline=!0;break;case -1685033574:Y|=64;Mk.e(Pb,64)?Pb.DoubleUnderline=!Pb.DoubleUnderline:Pb.DoubleUnderline=!0;break;case -1590502662:Y|=128,Mk.e(Pb,128)?Pb.Strikethrough=!Pb.Strikethrough:Pb.Strikethrough=!0}if(!Y)return!1;Pb.ValidMembers=Y;Va.Font=Pb;Va.ValidMembers=16;this.Fb&&this.gridView.isEditing?this.bob(H,!1,Va):(Ke.EwaSettings.ma(661)||za.rg.dH(!1),this.Ug.formatCells(k,Va,H));this.$.Bf();return!0};
Zc.prototype.z1h=function(k,H){var Y=0,za=this.gridView,Va=ih.a(za.kc(null));-571165336===k||1041132226===k||-394785302===k?(Y|=1,Va.VerticalAlignment=Ih.a.ao(Zc.bZa,k.toString(),2)):Zc.lii(k)?(Y|=2,this.z2h(Va,k)):-1116189897===k&&(Y|=8,Va.Wrap=Va.ValidMembers&8?!Va.Wrap:!0);if(!Y)return!1;Va.ValidMembers=Y;Ke.EwaSettings.ma(661)||za.rg.dH(!1);this.Ug.formatCells(k,Va,H);this.$.Bf();return!0};Zc.prototype.z2h=function(k,H){!Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&
this.$.isChromeRtl&&-1142465846!==H&&(H=-1150205178===H?-286432209:-1150205178);H=Ih.a.ao(Zc.bZa,H.toString(),0);k.HorizontalAlignment=H===k.HorizontalAlignment?0:H};Zc.prototype.WIf=function(k,H,Y,za){var Va=this,Pb=!1;Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(Pb=this.nlc.zpf(H,Y))&&Oe.g(this.$).Ji.U0(this.O8a,Og.BasicTelemetryCalculator.iR);return Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?
this.iaa(k,H,!1,Pb,function(Ac){Va.QNi(Ac,Y,H,Pb,za)}):this.iaa(k,H,!1,Pb,function(Ac,id,Ld){Va.SNi(Ac,id,Ld,Y,H,Pb,za)})};Zc.prototype.handleMergeCellsCommand=function(k,H){var Y=this;this.O8a=ji.a.create().toString();var za=null;za=this.nlc.C_e();var Va=ik.a(H.command),Pb=this.nlc.bgi(H.command,za),Ac=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),id=0;Ac&&Pb?id=Ga.a.Ce():Oe.g(this.$).Ji.K7(4,this.O8a,Va+", Scenario = "+za.scenario.toString());Va=
k.ha.sa.selectedRanges;nc.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",Wb.b().ri(H.command),Va.length,ve.i(Va,",",this.$,!1));Va=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);k.rg.dH(!1,Va);if(10===Ih.a.ao(Zc.Bpf,H.command.toString(),10))return qh.Task.Sa(!1);var Ld=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Va&&
Ld)return Pb?(Ac?this.VRd(za,H,!0,!0,id):this.VRd(za,H,!0),qh.Task.Sa(!0)):this.WIf(k,H,za,!1);var ld=!1;Va&&(ld=this.nlc.zpf(H,za))&&Oe.g(this.$).Ji.U0(this.O8a,Og.BasicTelemetryCalculator.iR);return Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.iaa(k,H,!1,ld,function(ef){Y.RNi(ef,H,ld)}):this.iaa(k,H,!1,ld,function(ef,Jf,Kg){Y.TNi(ef,Jf,Kg,H,ld)})};Zc.prototype.iaa=function(k,H,Y,za,Va){function Pb(Kg,Cg,Wg){Ld.$.Ky();
Kg=Va?Rg.b(Kg,Va):Kg;Kg=Rg.b(Kg,Ac);return Jg.f(Ld.$.na.ua,ef,Jf,Y,Kg,Cg,Wg,null,ld)}function Ac(Kg){var Cg=!!Kg&&!!Kg.RequestTelemetryData;Oe.g(Ld.$).Ji.ola(Ld.O8a,Kg.StateId,Cg?Kg.RequestTelemetryData.EcsOperationDuration:0,Cg?Kg.RequestTelemetryData.EcsRequestDuration:0,Cg?Kg.RequestTelemetryData.WfeRequestDuration:0)}function id(){return new Ec(ef,Jf)}var Ld=this;Va=void 0===Va?null:Va;var ld=this.$.na.ua.hc(),ef=Ih.a.ao(Zc.Bpf,H.command.toString(),10),Jf=ve.r(k.ha.sa.selectedRanges,k.$);return za?
Ke.EwaSettings.qc()?zg.a(this.$.userOperationManager,Pb,function(Kg){return new Ed.a(156,0,Kg,64,id)},H):zg.a(this.$.userOperationManager,Pb,function(Kg){return new zf.a(156,0,Kg,void 0,id)},H):zg.a(this.$.userOperationManager,Pb,function(Kg){return new Ed.a(156,0,Kg,void 0,id)},H)};Zc.prototype.VRd=function(k,H,Y,za,Va){var Pb=this;za=void 0===za?!1:za;Va=void 0===Va?0:Va;nc.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",Y);var Ac=Oe.g(this.$).rtl,id=
Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");Ac=he.a.gd(3,2,0,Ac?637:636,0,514846606,"MergeCellsLoseData");Uf.TaskExtensions.Ba(Zi.a(this.$).si(Ac),function(Ld){Ld=Ld.result;if(za){var ld=Ga.a.Ce()-Va;nc.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : {0}, and the user action is : {1}",ld,Ld)}0===Ld?(nc.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Y?(za&&id&&(Ld=ik.a(H.command),Oe.g(Pb.$).Ji.K7(4,
Pb.O8a,Ld+", Scenario = "+k.scenario.toString())),Pb.WIf(Oe.g(Pb.$),H,k,!0)):Pb.iaa(Pb.gridView,H,!0,!1)):1===Ld&&nc.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)};Zc.prototype.plf=function(k,H,Y,za){H!==k&&nc.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",H,k,Y,za)};Zc.prototype.RNi=
function(k,H,Y){var za=this;Dh.b(k,514846606)&&(nc.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),Nk.a(this.$).ud.kE(514846606),k=Oe.g(this.$).rtl,k=he.a.gd(3,2,0,k?637:636,0,514846606,"MergeCellsLoseData"),Uf.TaskExtensions.Ba(Zi.a(this.$).si(k),function(Va){Va=Va.result;0===Va?(nc.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),za.iaa(za.gridView,H,!0,Y)):1===Va&&nc.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,
11))};Zc.prototype.TNi=function(k,H,Y,za,Va){new md(this,k,H,Y,za,Va)};Zc.prototype.QNi=function(k,H,Y,za,Va){var Pb=this,Ac=!1;Dh.b(k,514846606)&&(Ac=!0,Nk.a(this.$).ud.kE(514846606),za&&Va?window.setTimeout(function(){Pb.iaa(Pb.gridView,Y,!0,!0)},0):this.VRd(H,Y,!1));this.plf(Ac,Va,H.scenario,za)};Zc.prototype.SNi=function(k,H,Y,za,Va,Pb,Ac){new bd(this,k,H,Y,za,Va,Pb,Ac)};Zc.prototype.upb=function(k){var H=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");if(H&&
this.n_a!==k&&1461300262!==this.n_a){this.eTf(this.n_a);var Y=Wb.b().ri(k),za=Wb.b().ri(this.n_a);nc.ULS.sendTraceTag(537159450,0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",za,Y)}H&&(this.n_a=k);if(this.Fb&&this.gridView.isEditing)this.k_a||(this.k_a=this.gridView.lk.formattedText);else if(!this.YA){this.YA=[];H=this.gridView.Q$("GridCommandHandler.CacheFontStyles",this.gridView.ha.sa.selectedRanges);try{for(H.$$rst();H.$$mn();){var Va=
H.$$cu(),Pb=Va.cell.hasRichText;if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Ac=Wb.b().ri(k);nc.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",Ac,Pb,this.YA.length)}if(Pb)this.YA.push(Xc.NQg(Va,Va.cell.formattedText));else switch(k){case 673562736:case -446735083:this.YA.push(Xc.bZc(Va,Va.backgroundColor));Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!Va.backgroundColor&&nc.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",!Va.backgroundColor);break;case -128950598:case 1688184685:this.YA.push(Xc.bZc(Va,Va.color));Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Va.color&&nc.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!Va.color);break;case 909774670:this.YA.push(Xc.OQg(Va,
Va.fontSize));if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var id=pl.c(Va.fontSize)?"null or undefined":Va.fontSize.toString();nc.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",id)}break;case 324978188:this.Om?this.YA.push(Xc.MQg(Va,Va.fontName,Va.Gaa)):this.YA.push(Xc.bZc(Va,Va.fontName)),Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Va.fontName?nc.ULS.sendTraceTag(537159444,
0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",gridRenderer.CanvasRendererGlobals.getFontNameForLogging(Va.fontName),Va.fontName.length):nc.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",!Va.fontName))}}}finally{H&&H.dispose()}}};Zc.prototype.zBj=function(){return this.Fb&&this.gridView.isEditing?!this.k_a:!this.YA};Zc.prototype.Uei=function(k){return!!this.YA&&this.YA.length>k&&!!this.YA[k].formattedText};
Zc.prototype.qac=function(k){return this.YA[k].style};Zc.prototype.TJh=function(k){return this.YA[k].size};Zc.prototype.SJh=function(k){return this.YA[k].Gaa};Zc.prototype.eTf=function(k){if(this.zBj())Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&nc.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",k);else{if(this.Fb&&this.gridView.isEditing)Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(k=Wb.b().ri(k),nc.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",k)),this.k_a&&(this.gridView.rc.formattedText=this.k_a);else for(var H=this.YA.length,Y=0;Y<H;Y++){var za,Va=this.YA[Y].FJa.cell.getRange();if(za=this.gridView.kc(Va)){Va=void 0;var Pb=za.rF?this.gridView.LJb(za.range):(Va=new rb.a,Va.add(za),Va);Va=El(Pb);for(Pb=Va.next();!Pb.done;Pb=Va.next()){Pb=Pb.value;if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Ac=
Wb.b().ri(k);nc.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",Ac,Pb.cell.hasRichText,Y,za.rF,H)}if(Pb.cell.hasRichText&&1457172838!==k)this.Uei(Y)&&(Pb.cell.formattedText=this.YA[Y].formattedText,Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Pb.cell.formattedText&&nc.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));
else switch(k){case 1457172838:Pb.backgroundColor=this.qac(Y);Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Pb.backgroundColor&&nc.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",!Pb.backgroundColor);break;case 2036397036:Pb.color=this.qac(Y);Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Pb.color&&nc.ULS.sendTraceTag(537159437,0,100,
"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!Pb.color);break;case -1904244080:Pb.fontSize=this.TJh(Y);Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Pb=pl.c(Pb.fontSize)?"null or undefined":Pb.fontSize.toString(),nc.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",Pb));break;case -1428968098:Ac=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),
this.Om?(Pb.EKb(this.qac(Y),Ac,"RestoreCachedStyles"),Pb.cZf(this.SJh(Y))):Pb.EKb(this.qac(Y),Ac,"RestoreCachedStyles")}}}else nc.ULS.sendTraceTag(537159441,0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",Va.pB(!1))}Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.n_a=1461300262);this.Q_a()}};Zc.prototype.Q_a=function(){this.Fb&&this.gridView.isEditing?this.k_a=null:this.YA=null;Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
nc.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};Zc.prototype.F2h=function(k,H){var Y={IndentationIncrease:0};if(-1942512156===k)Y.IndentationIncrease=1;else if(-1920201820===k)Y.IndentationIncrease=-1;else return!0;Y.ValidMembers=256;this.Ug.formatCells(k,Y,H);return!0};Zc.prototype.d3h=function(k,H){var Y=k;!Oe.g(this.$).rtl||-1649235364!==k&&524773427!==k||(Y=-1649235364===k?524773427:-1649235364);switch(Y){case -1649235364:Y=Qc.a.rotateTextUp45;break;
case 524773427:Y=Qc.a.suc;break;case 1886217042:Y=Qc.a.rotateTextUp90;break;case 928057943:Y=Qc.a.uuc;break;case -1526602249:Y=Qc.a.verticalText;break;default:return!1}var za={ValidMembers:512};za.TextOrientation=Y;this.Ug.formatCells(k,za,H);return!0};Zc.prototype.C2h=function(){var k=this,H=Oe.g(this.$),Y=ve.r(H.ha.sa.selectedRanges,this.$),za=ve.o(H.ha.sa.activeCell,this.$);nc.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return zg.a(this.$.userOperationManager,
function(Va,Pb,Ac){return Jg.L(k.$.na.ua,za,Y,Va,Pb,Ac,null)},function(Va){return new Ed.a(201,0,Va)},null)};Zc.prototype.z5e=function(k,H){var Y=null,za=Oe.g(this.$).ha.sa.selectedRanges;za=this.gridView.Q$("MoreColors",za,1,!0);try{for(za.$$rst();za.$$mn();){var Va=za.$$cu().cell;if(Va){var Pb=Zc.black;if(1970784898===k)Pb=Va.color;else if(1650812936===k){var Ac=Va.backgroundColor;Pb=S.a.compare(Ac,Zc.OWd,!0)&&S.a.compare(Ac,Zc.empty,!0)?Va.backgroundColor:Zc.white}if(!Y)Y=Pb;else if(Y!==Pb){Y=
Zc.black;break}}}}finally{za&&za.dispose()}this.Fb&&this.gridView.isEditing&&1970784898===k&&this.gridView.lk.textBox.Gte();return this.moreColorsHelper.vxa(k,H,Y)};Zc.prototype.S2h=function(k){var H=Lg.a.l4a(this.borderFormatManager.B3);return this.moreColorsHelper.vxa(-236759591,k,H)};Zc.prototype.bob=function(k,H,Y,za){var Va=this;za=void 0===za?!1:za;H?this.gridView.lk.YHf(Y.Font):(this.Qvi(k),za?window.requestAnimationFrame(function(){yh.FocusManager.instance().fk(Kk.AFrame.oia);Va.gridView.lk.JUe(Y.Font)}):
(yh.FocusManager.instance().fk(Kk.AFrame.oia),this.gridView.lk.JUe(Y.Font)),this.Q_a())};Zc.prototype.Qvi=function(k){var H=ik.a(k.command);k=Hk.a[k.Ye]+"_"+Aj.a[k.method];var Y=this.gridView.wc.fxe.toString(),za=new Map;za.set("Command",H);za.set("Source",k);za.set("Ribbon","React");za.set("CellTextRuns",Y);dk.Health.instance.recordKpiUsage(Rk.a.wDh,0,il.a.GTf,za)};Zc.prototype.fid=function(k,H,Y){k=this.borderFormatManager.fid(k,H,Y);this.moreColorsHelper&&this.moreColorsHelper.bda(H,this.borderFormatManager.B3,
Y);return k};Zc.prototype.getThemeColor=function(k){var H={};var Y=!1;if((k.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return nc.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:H};Y=this.themesManager.getThemeColor(k.Color);k=Y.themeIndex;var za=Y.mBa;if(Y=Y.returnValue)H.ThemeColorIndex=k,H.ThemeColorRow=za}return{returnValue:Y,themeColor:H}};Zc.lii=function(k){return-1150205178===k||-1142465846===
k||-286432209===k};Zc.Uvc=function(k){var H={},Y={};H.ValidMembers=16;H.Font=Y;Y.ValidMembers=k;return H};Zc.TYe=function(k,H){var Y=k.top<H.top?3:k.bottom>H.bottom?0:-1;return Y=k.left<H.left?1:k.right>H.right?2:Y};Ek.Object.defineProperties(Zc.prototype,{ogf:{configurable:!0,enumerable:!0,get:function(){return Uh.a.all(this.gridView.ha.sa.selectedRanges,function(k){return k.isRow})}},jgf:{configurable:!0,enumerable:!0,get:function(){return Uh.a.all(this.gridView.ha.sa.selectedRanges,function(k){return k.ef})}},
themesManager:{configurable:!0,enumerable:!0,get:function(){this.zx||(this.zx=this.$.da.Aa(422));return this.zx}}});Ek.Object.defineProperties(Zc,{jZi:{configurable:!0,enumerable:!0,get:function(){return Zc.Lde||(Zc.Lde=RegExp("^[0-9]+[.]?[0-9]*$"))}},mmd:{configurable:!0,enumerable:!0,get:function(){var k={};return Zc.s8d||(Zc.s8d=(k.InsertRows=5,k.InsertColumns=9,k.InsertCellsShiftRight=17,k.InsertCellsShiftDown=33,k.DeleteRows=6,k.DeleteColumns=10,k.DeleteCellsShiftLeft=18,k.DeleteCellsShiftUp=
34,k.DeleteRowsTable=6,k.DeleteColumnsTable=10,k.InsertRowsTable=5,k.InsertColumnsTable=9,k))}},bZa:{configurable:!0,enumerable:!0,get:function(){var k={};return Zc.Igb||(Zc.Igb=(k["-394785302"]=0,k["-571165336"]=2,k["1041132226"]=1,k["-1150205178"]=1,k["-1142465846"]=2,k["-286432209"]=3,k))}},Bpf:{configurable:!0,enumerable:!0,get:function(){var k={};return Zc.ebe||(Zc.ebe=(k["-167499203"]=2,k["-255094134"]=5,k["1097660126"]=6,k["155820588"]=7,k))}}});Zc.OWd="transparent";Zc.notSet="-1";Zc.black=
"#000000";Zc.empty="";Zc.white="#FFFFFF";Zc.s8d=null;Zc.Igb=null;Zc.ebe=null;Zc.Lde=null;Zc.DJa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(Dd.a)(Zc,"GridCommandHandler",null,[429]);var Zk=oc.a;Am(Ud,Zk);Ud.prototype.Nd=function(){var k=this;if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var H=rf.GetServiceTaskFactory.create(this.$.da,111,this.la,this.ub),Y=rf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub),za=rf.GetServiceTaskFactory.create(this.$.da,
397,this.la,this.ub),Va=rf.GetServiceTaskFactory.Va(this.$.da,296,468,this.ub);Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([H,Y,za,Va],this.la),function(){k.Cd([new Zc(k.$,Oe.g(k.$),Y.result,H.result,Va.result,za.result,new ne(k.$))])},this.la,3)}else{var Pb=rf.GetServiceTaskFactory.create(this.$.da,111,this.la,this.ub),Ac=rf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub),id=rf.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub),Ld=rf.GetServiceTaskFactory.create(this.$.da,397,this.la,
this.ub);Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([Pb,Ac,id,Ld],this.la),function(){k.Cd([new Zc(k.$,Oe.g(k.$),Ac.result,Pb.result,new zj.BorderFormatManager(k.$,Ac.result,id.result),Ld.result,new ne(k.$))])},this.la,3)}};Ud.ka=function(k){oc.a.fe(80,new Ud(k))};Object(Dd.a)(Ud,"GridCommandHandlerFactory",oc.a,[]);var Hg=b(31),wj=b(215),ql=b(1258);hd.prototype.dispose=function(){var k=this;this.deactivate();this.gridView&&(this.tableManager.aQf(this.DAf),this.gridView.Jaj(this.Sxf),this.gridView.Kaj(this.Txf),
this.$.xa.Xg(this.Ge),this.$.Hb.Xg(this.Ge),this.kre(function(H){H.NJd(k.aLa)}));this.gridView=this.tableManager=this.Dga=null};hd.prototype.pAc=function(k,H,Y,za){if(!Yf.b(this.$.qa)||this.$.ea.isNamedObjectViewMode||this.gridView.rb.oTa)return!0;if(!Y.length)return!1;var Va=za.length;if(za[Va-1]<k.left)return!1;var Pb=$c.HelperMethods.Jx(new wj.a(za),0,Va,k.left,$c.HelperMethods.cD);if(0>Pb)return!1;var Ac=k.m9f,id=!!k.h_a&&0<k.h_a.length,Ld=!!k.menuModel&&0<k.menuModel.length,ld=Pb,ef=0;for(Va=
Math.min(Ac.length+Pb,Va);ld<Va;ld++,ef++)if(Pb=Y[ld],!Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||Pb){var Jf=null,Kg=Pb.getElementsByClassName(Hg.a.b$c);Kg&&(Jf=Kg[0]);if(Jf&&Jf.innerText){if(Kg=Pb.getElementsByClassName(Hg.a.Toe))for(var Cg=Kg.length-1;0<=Cg;Cg--)Pb.removeChild(Kg[Cg]);Kg=za[ld];H?(Jf.innerText=Ac[ef],Pb.classList.add(Hg.a.tQe),id&&k.h_a[ef]&&(Jf=document.createElement("div"),Jf.innerHTML=k.h_a[ef],Ld&&k.menuModel[ef]&&this.sBg(k,ef,
Kg),Pb.appendChild(Jf.firstChild))):(Pb.classList.remove(Hg.a.tQe),Jf.textContent=mj.Range.CU(Kg),this.Mhh(Kg))}}k.xSa=H;return!0};hd.prototype.sBg=function(k,H,Y){this.$.da.$a(8,function(za){za.I9b.dMi(k,H,Y)})};hd.prototype.Mhh=function(k){this.$.da.$a(8,function(H){H.I9b.eMi(k)})};hd.prototype.Q4f=function(k,H,Y,za){for(var Va=!1,Pb=this.SZh(k,H),Ac=this.Dga.length-1;0<=Ac;Ac--){var id=this.Dga[Ac];H>=id.left&&k<=id.right&&(this.pAc(id,!1,Y,za),Array.removeAt(this.Dga,Ac),Va=!0)}k=0;for(H=Pb.length;k<
H;k++)this.pAc(Pb[k],!0,Y,za)&&(this.Dga.push(Pb[k]),Va=!0);return Va};hd.prototype.activate=function(){this.me()&&!this.active&&(this.gridView.view.Vs(this.Tw),this.active=!0)};hd.prototype.deactivate=function(){this.active&&(this.gridView.view.Xq(this.Tw),this.active=!1)};hd.prototype.me=function(){return Yf.b(this.$.qa)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.rb.gP&&0<this.tableManager.rangeList.length};hd.prototype.kre=function(k){var H=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?
this.gridView.tpc:[this.gridView.n3];H=El(H);for(var Y=H.next();!Y.done;Y=H.next()){Y=El(Y.value);for(var za=Y.next();!za.done;za=Y.next()){za=El(za.value);for(var Va=za.next();!Va.done;Va=za.next())k(Va.value)}}};hd.prototype.SZh=function(k,H){var Y=[];if(!this.active)return Y;this.uNa=this.gridView.mhd();for(var za=this.tableManager.rangeList.length-1;0<=za;za--){var Va=this.tableManager.rangeList[za];Va.bottom>=this.uNa&&this.lhd(Va)<=this.uNa&&Va.left>=k&&Va.right<=H&&Va.eba&&Y.push(Va)}return Y};
hd.prototype.lhd=function(k){var H=this.gridView.Rb.Qj(k);return H&&this.tableManager.ndf(k,H.usedRange.topLeft)?k.top+1:k.top};Object(Dd.a)(hd,"HeaderSnappingFeature",null,[3]);var Ji=gg.a;Am(pc,Ji);pc.prototype.create=function(){var k=this,H=rf.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ub);Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([H],this.la),function(){k.Eb(k.$.da.Aa(68)||new hd(H.result,Oe.g(k.$)))},this.la,11)};pc.ka=function(k){k.da.Ga(67,new pc(k))};Object(Dd.a)(pc,"HeaderSnappingFactory",
gg.a,[]);var Wk=b(1309),Ok=b(1109),dl=gg.a;Am(Vb,dl);Vb.prototype.create=function(){var k=this,H=this.$.da,Y=rf.GetServiceTaskFactory.create(H,134,this.la,this.ub),za=rf.GetServiceTaskFactory.Va(H,213,214,this.ub);Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([Y,za],this.la),function(){if(Ke.EwaSettings.em())k.Eb(Object(Ok.a)(k.$.da,1,function(){var Pb=new Wk.CellAutoCompleteControl(k.$,Y.result);za.result.ka(Pb);return Pb}));else{var Va=H.Aa(1);Va||(Va=new Wk.CellAutoCompleteControl(k.$,Y.result),za.result.ka(Va));
k.Eb(Va)}},this.la,3)};Vb.ka=function(k){k.da.Ga(151,new Vb(k))};Object(Dd.a)(Vb,"CellAutoCompleteControlFactory",gg.a,[]);Na.prototype.dispose=function(){this.MXd();this.GZa=null};Na.prototype.ka=function(k){k&&(this.GZa=k,k.BZb(this.JAf),k.R2(this.KAf),k.aFg(this.LAf))};Na.prototype.MXd=function(){this.GZa&&(this.GZa.Usc(this.JAf),this.GZa.oda(this.KAf),this.GZa.Uaj(this.LAf))};Object(Dd.a)(Na,"CellAutoCompleteReadoutHandler",null,[789,3]);var kl=gg.a;Am(wa,kl);wa.prototype.create=function(){var k=
this,H=this.$.da;Uf.TaskExtensions.Ba(rf.GetServiceTaskFactory.Va(H,211,212,this.ub),function(Y){if(Ke.EwaSettings.em())k.Eb(Object(Ok.a)(H,213,function(){return new Na(Y.result,H)}));else{var za=H.Aa(213)||new Na(Y.result,H);k.Eb(za)}},this.la,3)};wa.ka=function(k){k.da.Ga(214,new wa(k))};Object(Dd.a)(wa,"CellAutoCompleteReadoutHandlerFactory",gg.a,[]);kd.Tnh="ewa-dv";kd.Unh="ewa-dv-buttonarea";kd.anh="ewa-dlb";kd.MBb="list-table";kd.listItem="list-item";kd.HBb="list-item-selected";kd.NBb="list-table-touch";
kd.Snh="ewa-dpb";kd.dih="dv-prompt-title";kd.cih="dv-prompt-message";Object(Dd.a)(kd,"CssClassNames",null,[]);var $k=b(619),aj=b(48),Sk=b(458),Ak=b(1028),tk=lg.ErrorDialog;Am(zc,tk);zc.prototype.dispose=function(){Oe.g(this.$).ha.WF(this.kd);tk.prototype.dispose.call(this)};zc.prototype.setFocus=function(){switch(this.error.Severity){case 0:var k=4;break;case 1:k=3;break;case 2:k=0;break;default:k=this.closeAction}(k=this.getButton(k))?k.get_element().focus():tk.prototype.setFocus.call(this)};zc.prototype.Cqb=
function(){var k=Oe.g(this.$);k.isEditing&&k.rc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.HTd(1);if(2===this.returnValue||0===this.returnValue){var H=k.kc(null);if(H){k.Ea.WV();var Y=Object(ag.a)(new Ph.a,{Text:H.originalText});k.setCell(Y,H.range,0,63,null)}this.$.Xd(-798660877,Re.a.Ub,8,null)}tk.prototype.Cqb.call(this)};zc.prototype.Bsa=function(){var k=Oe.g(this.$);k.isEditing&&k.rc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",
0);3===this.returnValue&&this.HTd(0);tk.prototype.Bsa.call(this)};zc.prototype.HTd=function(k){var H=Oe.g(this.$);Uf.TaskExtensions.Ba(H.startEdit(!1,k),function(){var Y=H.rc.textBox;Y.text&&Y.selectRange(0,Y.text.length)},this.la,11,Xf.a.current)};zc.WQ=function(k,H,Y){Y=H.da.Aa(14).F3a(Y);k.MessageId=-1083021405;k.MessageIdName="DataValidationError";k.MessageIdHash=Lg.a.mw(k.MessageIdName);k.Severity=Y?Y.Q8c:1;H=(null===Y||void 0===Y?0:Y.UIa)?Lg.a.Sf(Y.UIa):null;Y=(null===Y||void 0===Y?0:Y.error)?
Lg.a.Sf(Y.error):String.format("<p>{0}</p><p>{1}</p>",Ae.a.instance.fa(890),Ae.a.instance.fa(891));switch(k.Severity){case 0:k.Appearance=18;break;case 1:k.Appearance=12;Y+=String.format("<p>{0}</p>",Ae.a.instance.fa(892));break;default:k.Appearance=3}k.Caption=H;k.Description=Y;k.HelpDescription=Ae.a.instance.fa(1289);k.HelpTopicId=Ak.a.SFe;return k};Object(Dd.a)(zc,"DataValidationErrorDeprecatedDialog",lg.ErrorDialog,[]);var kj=b(197),Xk=b(177),el=jk.a;Am(vc,el);vc.prototype.dispose=function(){this===
this.zb.Zp&&(this.zb.Zp=null);kg.a.Ha(this.Fm);this.Fm=null;el.prototype.dispose.call(this)};vc.prototype.Roj=function(){this.av&&this.av.error?this.errorMessage=this.av.error:this.av&&this.av.options&1?(nc.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=Ae.a.instance.fa(1702),this.u7e=Sg.a.current.kp(96)):(this.errorMessage=Ae.a.instance.fa(1701),this.tMh(this.bMe));var k=this.av?this.av.Q8c:1,H={};this.XE=
(H[vc.Yx]=this.Cc,H.errorDescription=this.errorMessage,H.helpImageUri=this.u7e,H);switch(k){case 0:this.jc=1;this.Dc(1,"Retry");this.XE.dialogIcon=2;this.Sff=!0;break;case 1:this.jc=4;this.XE.dialogIcon=1;this.XE.additionalInformation=Ae.a.instance.fa(892);break;default:this.jc=1,this.XE.dialogIcon=3}k={};this.XE.helpLink=(k.type="AppLinkProps",k[vc.Yx]=this.error.HelpTopicId,k.text=Ae.a.instance.fa(1289),k.handler=this.G9a,k);k=he.a.TWc([this.error]);H={};this.jV=(H[Ea.a.v9b]=!0,H[Ea.a.X$c]=k,H[Ea.a.Y$c]=
Xk.a(this.$).etb(this.error.MessageIdHash),H[Ea.a.oV]=this.Cc,H.DismissHandler=this.oAd,H);k={};this.XE.giveFeedbackLink=(k.type="AppLinkProps",k[vc.Yx]=Ea.a.Mhd,k.text=Ae.a.instance.fa(1738),k.handler=this.WLi,k)};vc.prototype.tMh=function(k){var H=this.$.na.ua.hc();Jg.u(this.$.na.ua,ve.q(k,this.$),Rg.b(this.wKi),Rg.a(this.vKi),null,H)};vc.prototype.uWh=function(k){switch(k.RuleType){case 1:switch(k.ConditionType){case 0:var H=Ae.a.instance.Ab(108);return String.format(H,k.LowerBoundary,k.UpperBoundary);
case 1:return H=Ae.a.instance.Ab(109),String.format(H,k.LowerBoundary,k.UpperBoundary);case 2:return H=Ae.a.instance.Ab(110),String.format(H,k.LowerBoundary);case 3:return H=Ae.a.instance.Ab(111),String.format(H,k.LowerBoundary);case 4:return H=Ae.a.instance.Ab(112),String.format(H,k.LowerBoundary);case 5:return H=Ae.a.instance.Ab(113),String.format(H,k.UpperBoundary);case 6:return H=Ae.a.instance.Ab(114),String.format(H,k.LowerBoundary);case 7:return H=Ae.a.instance.Ab(115),String.format(H,k.UpperBoundary);
default:return"we couldn't get the details"}case 2:switch(k.ConditionType){case 0:return H=Ae.a.instance.Ab(116),String.format(H,k.LowerBoundary,k.UpperBoundary);case 1:return H=Ae.a.instance.Ab(117),String.format(H,k.LowerBoundary,k.UpperBoundary);case 2:return H=Ae.a.instance.Ab(118),String.format(H,k.LowerBoundary);case 3:return H=Ae.a.instance.Ab(119),String.format(H,k.LowerBoundary);case 4:return H=Ae.a.instance.Ab(120),String.format(H,k.LowerBoundary);case 5:return H=Ae.a.instance.Ab(121),String.format(H,
k.UpperBoundary);case 6:return H=Ae.a.instance.Ab(122),String.format(H,k.LowerBoundary);case 7:return H=Ae.a.instance.Ab(123),String.format(H,k.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(k.ConditionType){case 0:return H=Ae.a.instance.Ab(124),String.format(H,k.LowerBoundary,k.UpperBoundary);case 1:return H=Ae.a.instance.Ab(125),String.format(H,k.LowerBoundary,k.UpperBoundary);case 2:return H=Ae.a.instance.Ab(126),String.format(H,k.LowerBoundary);case 3:return H=Ae.a.instance.Ab(127),
String.format(H,k.LowerBoundary);case 4:return H=Ae.a.instance.Ab(128),String.format(H,k.LowerBoundary);case 5:return H=Ae.a.instance.Ab(129),String.format(H,k.UpperBoundary);case 6:return H=Ae.a.instance.Ab(130),String.format(H,k.LowerBoundary);case 7:return H=Ae.a.instance.Ab(131),String.format(H,k.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(k.ConditionType){case 0:return H=Ae.a.instance.Ab(132),String.format(H,k.LowerBoundary,k.UpperBoundary);case 1:return H=Ae.a.instance.Ab(133),
String.format(H,k.LowerBoundary,k.UpperBoundary);case 2:return H=Ae.a.instance.Ab(134),String.format(H,k.LowerBoundary);case 3:return H=Ae.a.instance.Ab(135),String.format(H,k.LowerBoundary);case 4:return H=Ae.a.instance.Ab(136),String.format(H,k.LowerBoundary);case 5:return H=Ae.a.instance.Ab(137),String.format(H,k.UpperBoundary);case 6:return H=Ae.a.instance.Ab(138),String.format(H,k.LowerBoundary);case 7:return H=Ae.a.instance.Ab(139),String.format(H,k.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(k.ConditionType){case 0:return H=
Ae.a.instance.Ab(140),String.format(H,k.LowerBoundary,k.UpperBoundary);case 1:return H=Ae.a.instance.Ab(141),String.format(H,k.LowerBoundary,k.UpperBoundary);case 2:return H=Ae.a.instance.Ab(142),String.format(H,k.LowerBoundary);case 3:return H=Ae.a.instance.Ab(143),String.format(H,k.LowerBoundary);case 4:return H=Ae.a.instance.Ab(144),String.format(H,k.LowerBoundary);case 5:return H=Ae.a.instance.Ab(145),String.format(H,k.UpperBoundary);case 6:return H=Ae.a.instance.Ab(146),String.format(H,k.LowerBoundary);
case 7:return H=Ae.a.instance.Ab(147),String.format(H,k.UpperBoundary);default:return"we couldn't get the details"}case 3:return H=Ae.a.instance.Ab(106),String.format(H,k.LowerBoundary);case 7:return H=Ae.a.instance.Ab(107),String.format(H,k.LowerBoundary);default:return"we couldn't get the details"}};vc.prototype.HTd=function(k){var H=Oe.g(this.$);Uf.TaskExtensions.Ba(H.startEdit(!1,k),function(){var Y=H.rc.textBox;Y.text&&Y.selectRange(0,Y.text.length)},this.la,11,Xf.a.current)};vc.WQ=function(k,
H,Y){H=H.da.Aa(14).F3a(Y);k.MessageId=-1083021405;k.MessageIdName="DataValidationError";k.MessageIdHash=Lg.a.mw(k.MessageIdName);k.Severity=H?H.Q8c:1;k.HelpDescription=Ae.a.instance.fa(1289);k.HelpTopicId=Ak.a.SFe;return k};Ek.Object.defineProperties(vc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},la:{configurable:!0,enumerable:!0,get:function(){this.Fm=this.Fm||new kj.a;return this.Fm.token}}});Object(Dd.a)(vc,"DataValidationErrorDialog",jk.a,[470,
471,3,419]);var Bk=b(1116),al=b(406),Ck=Bk.a;Am(Za,Ck);Za.prototype.dispose=function(){this.dataValidationControl=null;Ck.prototype.dispose.call(this)};Za.prototype.Wh=function(k,H){this.dataValidationControl.Ya=this.Ya;var Y=k.keyCode;return 1461300262!==H||16!==Y&&17!==Y&&18!==Y?Ck.prototype.Wh.call(this,k,H):!1};Za.prototype.tzd=function(){this.bW&&(this.dataValidationControl.Ya=this.Ya,this.dataValidationControl.show(this.dataValidationControl.sR,!0,!0,Oj.a.rp||3===Re.a.Ub))};Za.prototype.ug=
function(){};Za.prototype.gj=function(){this.dataValidationControl.show(this.dataValidationControl.sR,!0,!0,Oj.a.rp||3===Re.a.Ub)};Za.prototype.RFd=function(k,H){return this.dataValidationControl.Wh(H)};Ek.Object.defineProperties(Za.prototype,{Pyb:{configurable:!0,enumerable:!0,get:function(){return Object(hf.a)(vc,this.$.zb.lh)}},bW:{configurable:!0,enumerable:!0,get:function(){return this.dataValidationControl.isListVisible},set:function(k){this.dataValidationControl.isListVisible=k}},D5a:{configurable:!0,
enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return al.a.r5c}}});Object(Dd.a)(Za,"DataValidationListAutoCompleteBehavior",Bk.a,[]);var Pk=b(1050),bl=b(1115),Tk=Pk.a;Am(ub,Tk);ub.prototype.dispose=function(){Tk.prototype.dispose.call(this);this.LBb=this.Flb=null};ub.prototype.tea=function(k,H,Y,za){if(k&&(!k||k.length)){this.R7(!1);this.fIa=k;this.nW=[];for(var Va=0;Va<k.length;Va++)this.nW[Va]=k[Va]?k[Va].Name:null;Va=String.format("<table class='{0}' aria-live='polite'><tbody>",
this.Xba);var Pb="",Ac="";k=0;var id=Oe.g(this.$).kc(null);za=this.isEditing?za?za.text:this.editText:id?id.originalText:null;id=!za;var Ld=0;Array.clear(this.zFb);var ld=[],ef=[],Jf=[],Kg=za?za.split(" "):[""];za=za.trim();for(var Cg={},Wg=0;Wg<this.nW.length;Cg={ZDc:Cg.ZDc},Wg++){var wi=this.nW[Wg],oj=void 0;Cg.ZDc=wi.split(" ");oj=Uh.a.all(Kg,function(gk){return function(gj){return Uh.a.any(gk.ZDc,function(Dk){return S.a.uL(Dk,gj)})}}(Cg));var fj=!wi,Wj=Array.contains(Jf,wi);fj||Wj||this.isEditing&&
!oj||(oj=wi?Lg.a.Sf(Lg.a.T7b(wi)):"",oj=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.A_,oj),Jf.push(wi),this.isEditing&&S.a.uL(wi,za)?(Pb+=oj,ld.push(Wg)):(Ac+=oj,ef.push(Wg)),!id&&S.a.equals(za,wi,!0)&&(k=this.isEditing?ld.length-1:Ld,id=!0),Ld++)}this.INa=Ld;Array.addRange(this.zFb,ld);Array.addRange(this.zFb,ef);this.dg.innerHTML=Va+(Pb+Ac+"</tbody></table>");Va=this.Sn=Kc.DOMElementExtensions.Pj(this.domElement,this.Xba);this.inb(Va,H);this.R7(!0);this.Tra(H,Y);this.Vk=0<this.INa?
Va.rows[k]:null}};ub.prototype.uRa=function(k){var H=!1;this.isEditing&&k&&(H=!this.INa,k.endEdit(H,"DataValidationListBox.SetCellContent",0));if(!H&&(k=Oe.g(this.$),H=k.kc(null))){var Y=null;this.Fda&&-1!==this.Fda.SheetId&&-1!==this.Fda.Row&&-1!==this.Fda.Column&&(Y={},Y.SheetName=this.Fda.SheetId.toString(),Y.FirstRow=this.Fda.Row,Y.FirstColumn=this.Fda.Column,Y={ParameterType:6,SourceRange:Y});var za=Object(ag.a)(new Ph.a,{Text:this.xe});k.setCell(za,H.range,0,63,Y)}return!0};ub.prototype.Tra=
function(k,H){var Y=k?this.yCb:this.hI;k=k?this.Sjc:this.Tjc;0>=this.INa?this.dg.style.height=$c.HelperMethods.nc(k):(this.dg.style.height="auto",this.INa>Y?(Kc.DOMElementExtensions.XI(this.dg,this.vQj?Math.floor(k*Y):Math.floor(this.dg.offsetHeight*Y/this.INa)),this.dg.style.overflowY="auto"):(this.dg.style.height="auto",this.dg.style.overflowY="hidden"));Kc.DOMElementExtensions.Kr(this.dg,H);Kc.DOMElementExtensions.Kr(this.Sn,H-(this.INa>Y?jj.a.xu:0))};Ek.Object.defineProperties(ub.prototype,{Vk:{configurable:!0,
enumerable:!0,get:function(){return this.Flb},set:function(k){this.sBa(this.Flb);if(k){this.Flb=k;this.LBb.innerText="";this.sBa(this.Flb);var H=this.zFb[k.rowIndex];this.xe=this.nW[H];this.fIa&&(this.Fda=this.fIa[H],nc.ULS.shipAssertTag(537163286,0,!this.zFb.length||!!this.Fda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.LBb.innerText=this.xe;this.Yuc(k)}else this.Fda=this.xe=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return Oe.g(this.$).isEditing}},
editText:{configurable:!0,enumerable:!0,get:function(){return Oe.g(this.$).rc.text}}});Object(Dd.a)(ub,"DataValidationListBox",Pk.a,[]);var ll=b(249),Ik=b(109),wk=b(178),fl=fi.a;Am(Zb,fl);Zb.prototype.gVc=function(k){this.get_events().addHandler("ClickButton",k)};Zb.prototype.cJd=function(k){this.get_events().removeHandler("ClickButton",k)};Zb.prototype.rVc=function(k){this.get_events().addHandler("KeyDown",k)};Zb.prototype.oJd=function(k){this.get_events().removeHandler("KeyDown",k)};Zb.prototype.KZb=
function(k){this.get_events().addHandler("PointerOver",k)};Zb.prototype.zJd=function(k){this.get_events().removeHandler("PointerOver",k)};Zb.prototype.JZb=function(k){this.get_events().addHandler("PointerOut",k)};Zb.prototype.yJd=function(k){this.get_events().removeHandler("PointerOut",k)};Zb.prototype.nnb=function(k){this.get_events().addHandler("Blur",k)};Zb.prototype.XHb=function(k){this.get_events().removeHandler("Blur",k)};Zb.prototype.N9=function(k){this.get_events().addHandler("Focus",k)};
Zb.prototype.nda=function(k){this.get_events().removeHandler("Focus",k)};Zb.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove($k.a.kZ),this.domElement.style.cursor="",Fi.a.instance.pa(Eg.a.click,this.domElement,this.vd),Ik.KeyInputManager.instance.pa(Eg.a.Yb,this.domElement,this.onKeyDown),wk.a.instance.pa(Eg.a.pointerOver,this.domElement,this.Sw),wk.a.instance.pa(Eg.a.pointerOut,this.domElement,this.WN),this.Jc.un("blur")||this.Jc.ka("blur",this.onBlur),this.Jc.un("focus")||
this.Jc.ka("focus",this.onFocus),this.domElement.title=this.ckh,this.Bl=!0)};Zb.prototype.disable=function(){this.domElement&&(this.domElement.classList.add($k.a.kZ),this.domElement.style.cursor="",this.isEnabled&&(Fi.a.instance.za(Eg.a.click,this.domElement,this.vd),Ik.KeyInputManager.instance.za(Eg.a.Yb,this.domElement,this.onKeyDown),wk.a.instance.za(Eg.a.pointerOver,this.domElement,this.Sw),wk.a.instance.za(Eg.a.pointerOut,this.domElement,this.WN)),this.domElement.title=this.jfh,this.Bl=!1)};
Zb.prototype.dispose=function(){this.isEnabled&&(Fi.a.instance.za(Eg.a.click,this.domElement,this.vd),Ik.KeyInputManager.instance.za(Eg.a.Yb,this.domElement,this.onKeyDown),wk.a.instance.za(Eg.a.pointerOver,this.domElement,this.Sw),wk.a.instance.za(Eg.a.pointerOut,this.domElement,this.WN),this.Bl=!1);Kc.DOMElementExtensions.setVisible(this.domElement,!1);fl.prototype.dispose.call(this)};Zb.Bb=function(k,H,Y,za,Va,Pb,Ac,id){k.removeAttribute("Href");k.setAttribute(Ea.a.Td,Ea.a.Ws);k.className=H;k.tabIndex=
id;H=document.createElement("span");H.className=Ac;H.classList.add(Y);H.tabIndex=-1;k.appendChild(H);k=document.createElement("img");k.src=Sg.a.We(za);k.className=Va;k.alt=Pb;k.tabIndex=-1;H.appendChild(k);return k};Ek.Object.defineProperties(Zb.prototype,{ul:{configurable:!0,enumerable:!0,get:function(){return this.jJ}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Bl}}});Object(Dd.a)(Zb,"ListButton",fi.a,[816,3]);var rl="<p class='"+kd.dih+"'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",
sl="<p class='"+kd.cih+"'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",ml=A.a.aNe,tl=A.a.aNe,gl=A.a.FYg,ok=fi.a;Am(Jb,ok);Jb.prototype.dispose=function(){this.$&&(this.AMb(!1),this.gridView.ha.lO(this.Rh),this.gridView.cx(this.onContentReady),this.gridView.wc.raj(this.dwf),this.$.rm(this.Yc));this.fEe(!1);this.gEe(!1);kg.a.zc(this.S5b);this.S5b=this.wsa=this.dg=this.j0=this.dJ=this.gridView=this.$=null;ok.prototype.dispose.call(this)};Jb.prototype.a7c=function(k){return!!this.F3a(k)};
Jb.prototype.jrb=function(k,H){return Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new vc(this.$,k,H):new zc(this.$,k,H)};Jb.prototype.F3a=function(k){k=this.gridView.getRangeInformation(k);for(var H=0;H<k.length;H++){var Y=k[H];if(Object(hf.a)(Sk.DataValidationRange,Y))return Y}return null};Jb.prototype.yIh=function(){if(!this.T4a)return"";var k=this.Q6e?String.format("{0} {1}",this.av.lJf,this.av.prompt):"",H=this.Wwb?Ae.a.instance.fa(838):"";return String.format(Ae.a.instance.Ab(17),
k,H)};Jb.prototype.Wh=function(k){var H=!1;if(this.isListVisible||(-569786022===k||541421805===k)&&this.Wwb||1872288872===k&&this.sR)switch(k){case -569786022:case 541421805:this.show(this.sR,!this.isListVisible,!0,Oj.a.rp||3===Re.a.Ub);H=!0;break;case 1872288872:this.isListVisible?(this.show(this.sR,!1,!0,!1),H=!0):this.sR?(this.show(!1,!1,!0,!1),H=!0):this.Ya&&(this.Ya.endEdit(!1,"DataValidationControl.HandleKeyDown",0),H=!0);break;case -798660877:this.Zh.BB(1);H=!0;break;case 137938150:this.Zh.BB(-1);
H=!0;break;case 2091832999:this.Zh.BB(this.Zh.hI-1);H=!0;break;case 742457698:this.Zh.BB(-(this.Zh.hI-1));H=!0;break;case 125627505:case 267796030:H=this.uRa()}return H};Jb.prototype.show=function(k,H,Y,za){this.ky();if(this.tAb&&this.T4a){var Va=this.COa;if(Va){if(k||H||Y)this.isVisible=!0;gh.d(this.style,this.isGridRtl);Y&&this.Wwb&&(this.gEe(!0),this.Mcg(Va,!1));H&&this.Wwb&&this.hSa(za,Va);k&&this.Q6e&&this.rAj(Va);this.xni||(this.isVisible=!1)}}};Jb.prototype.qva=function(k,H){if(!H||!H.cell.mk)return null;
var Y=this.gridView.wc.textBox.domElement;var za=0<Kc.DOMElementExtensions.getHeight(Y)&&0<Kc.DOMElementExtensions.getWidth(Y)&&0<=Y.offsetTop&&0<=Y.offsetLeft;if(za)Y=Kc.DOMElementExtensions.qva(Y,k.Nj);else{Y=k.getCellBounds(H.cell);var Va=Kc.DOMElementExtensions.getBoundingClientRect(k.Nj);Y=new Sys.UI.Bounds(Y.x-Va.x,Y.y-Va.y,Y.width,Y.height)}if(Y)if(za)2<Y.height&&2<Y.height&&(Y.x+=1,Y.y+=1,Y.height-=2,Y.width-=2);else if(za=Oe.g(this.$).$J(H.cell))za=za.width+1,Va=S.a.equals(ll.a.E3a(H.cell,
k.rtl),"right",!0),k.rtl&&Va&&(Y.x=Y.x+Y.width-za),H.Lka&&k.rtl===Va&&(Y.width=za);else return null;return Y};Jb.prototype.O2f=function(k){var H=this.T4a;this.AMb(H);H?this.show(!0,k,!0,!1):this.ky()};Jb.prototype.uRa=function(){var k=!1;this.isListVisible&&(k=this.Zh.uRa(this.Ya),this.show(this.sR,!1,!0,!1));return k};Jb.prototype.ky=function(){this.ggi?(this.isListVisible&&(this.isListVisible=!1),this.WLa&&(this.WLa=!1),this.sR&&(this.sR=!1),this.isVisible&&(this.isVisible=!1)):this.isListVisible=
this.WLa=this.sR=this.isVisible=!1;this.hpd=this.nnd=this.$pd=!1};Jb.prototype.hSa=function(k,H){this.Wwb&&!this.av.fIa?this.WLa&&this.Ph.disable():(this.fEe(!0),this.Zh.tea(this.av.fIa,k,this.BRh(H),this.Ya),this.JBa(H,!1))};Jb.prototype.rAj=function(k){this.av.prompt&&(this.sR=!0,this.gSj(this.av.lJf,this.av.prompt),this.gdg(k,!1))};Jb.prototype.Mcg=function(k,H){var Y=k.y;this.wsa.style.top=$c.HelperMethods.nc(Y);k=this.isGridRtl?k.x-this.wsa.offsetWidth+1:k.x+k.width+1;this.wsa.style.left=$c.HelperMethods.nc(k);
H?this.WLa=this.gridView.Jic(new aj.a(k,Y))&&this.nnd:this.nnd=!0};Jb.prototype.JBa=function(k,H){var Y=k.y+k.height;k=this.isGridRtl?k.x+k.width-this.dg.offsetWidth:k.x;this.dg.style.top=$c.HelperMethods.nc(Y);this.dg.style.left=$c.HelperMethods.nc(k);H?this.isListVisible=this.gridView.Jic(new aj.a(k,Y))&&this.hpd:this.hpd=!0};Jb.prototype.gdg=function(k,H){var Y=k.y+k.height+5,za=this.activeCell;za=za?za.width/2:32;k=this.isGridRtl?k.x-this.j0.offsetWidth+za:k.x+k.width-za;this.j0.style.top=$c.HelperMethods.nc(Y);
this.j0.style.left=$c.HelperMethods.nc(k);H?this.sR=this.gridView.Jic(new aj.a(k,Y))&&this.$pd:this.$pd=!0};Jb.prototype.gSj=function(k,H){if(H){var Y="";k&&(Y+=String.format(rl,Lg.a.Sf(k)));Y+=String.format(sl,Lg.a.Sf(H));this.j0.innerHTML=Y;k=Kc.DOMElementExtensions.Pj(this.j0,"dv-prompt-titletext");if(H=Kc.DOMElementExtensions.Pj(this.j0,"dv-prompt-messagetext"))for(k=k?parseInt(String(Math.max(k.offsetWidth,H.offsetWidth)),10):H.offsetWidth,k+=6,Kc.DOMElementExtensions.Kr(this.j0,k),H=0,Y=this.j0.children.length;H<
Y;H++)Kc.DOMElementExtensions.Kr(this.j0.children[H],k)}};Jb.prototype.BRh=function(k){return this.hgi?k.width+17-2+1:k.width+this.wsa.clientWidth-2+1};Jb.prototype.gEe=function(k){this.$&&!this.tAb||!k?(this.Q6f(!1),kg.a.Ha(this.Ph),this.Ph=null):(this.Ph||(this.Ph=new Zb(this.wsa,ml,$k.a.eia,1,tl,Ae.a.instance.fa(889),gl,Ae.a.instance.fa(888),"",-1),this.Q6f(!0)),this.WLa=!0,this.av.fIa?this.Ph.isEnabled||this.Ph.enable():this.Ph.disable())};Jb.prototype.fEe=function(k){this.$&&!this.tAb||!k?(this.OSa(!1),
kg.a.Ha(this.Zh),this.Zh=null):(this.Zh||(this.Zh=new ub(this.$,this.dg,this.LBb),this.OSa(!0)),this.isListVisible=!0)};Jb.prototype.OSa=function(k){this.Zh&&(k&&!this.zR?(this.Zh.N9(this.Zzd),this.Zh.xZb(this.vLa),this.Zh.Gnb(this.Hya),this.zR=!0):!k&&this.zR&&(this.Zh.nda(this.Zzd),this.Zh.Rsc(this.vLa),this.Zh.pIb(this.Hya),this.zR=!1))};Jb.prototype.AMb=function(k){k&&!this.cR?(this.gridView.view.Vs(this.tt),this.cR=!0):!k&&this.cR&&(this.gridView.view.Xq(this.tt),this.cR=!1)};Jb.prototype.Q6f=
function(k){this.Ph&&(k&&!this.i1b?(this.Ph.gVc(this.ROa),this.Ph.rVc(this.ROa),this.Ph.nnb(this.vLa),this.i1b=!0):!k&&this.i1b&&(this.Ph.cJd(this.ROa),this.Ph.oJd(this.ROa),this.Ph.XHb(this.vLa),this.i1b=!1))};Jb.prototype.Wcg=function(){if(this.T4a){var k=this.COa;k&&(this.Mcg(k,!0),this.JBa(k,!0),this.gdg(k,!0))}};Ek.Object.defineProperties(Jb.prototype,{tAb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Pd&16)}},xni:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||
this.sR||this.WLa}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Kc.DOMElementExtensions.isVisible(this.dg)},set:function(k){Kc.DOMElementExtensions.setVisible(this.dg,k)}},sR:{configurable:!0,enumerable:!0,get:function(){return Kc.DOMElementExtensions.isVisible(this.j0)},set:function(k){Kc.DOMElementExtensions.setVisible(this.j0,k)}},WLa:{configurable:!0,enumerable:!0,get:function(){return Kc.DOMElementExtensions.isVisible(this.wsa)&&!!this.Ph&&Kc.DOMElementExtensions.isVisible(this.Ph.domElement)},
set:function(k){Kc.DOMElementExtensions.setVisible(this.wsa,k);this.Ph&&Kc.DOMElementExtensions.setVisible(this.Ph.domElement,k)}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.dJ},set:function(k){this.dJ=k}},T4a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&this.a7c(this.activeCell.range)}},activeCell:{configurable:!0,enumerable:!0,get:function(){return this.gridView.kc(null)}},Q6e:{configurable:!0,enumerable:!0,get:function(){return this.T4a&&!!this.av&&!!(this.av.options&
2)&&!!this.av.prompt}},Wwb:{configurable:!0,enumerable:!0,get:function(){return this.T4a&&!!this.av&&!!(this.av.options&1)}},isGridRtl:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rtl}},av:{configurable:!0,enumerable:!0,get:function(){return this.F3a(this.activeCell.range)}},COa:{configurable:!0,enumerable:!0,get:function(){var k=this.activeCell;return k?this.qva(this.gridView,k):null}}});Object(Dd.a)(Jb,"DataValidationControl",fi.a,[786,3]);var X=gg.a;Am(Mb,X);Mb.prototype.create=
function(){this.Eb(this.$.da.Aa(14)||new Jb(this.$))};Object(Dd.a)(Mb,"DataValidationControlFactory",gg.a,[]);ib.m$c="!";ib.FEf="[";ib.EEf="]";ib.openParen="(";ib.closeParen=")";ib.kgg=" /.(*\\".split("");ib.K7b="...";ib.KFb="param_help_link";ib.aDd="param_help_udf";ib.jcd="function_list_box";ib.OEh="function_param_box";ib.lcd="function_reader_description";ib.ecd="function_description_box";ib.mVe="function_param_table";ib.LVi="param_row_";ib.bDd="param_set";ib.kFf="param_row_0";ib.lFf="param_row_1";
ib.PEh="<div id='{0}' class='{1}'></div>";ib.NEh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";ib.mFf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";ib.KEh="<div id='{0}' class='{1} {2} {3}'></div>";ib.HEh="<div id='{0}' class='{1} {2} {3} {4}'></div>";ib.Pjf="[@";ib.z3g=1;ib.y3g=3;ib.ych=500;ib.gpf=50;Object(Dd.a)(ib,
"FormulaAssistanceConstants",null,[]);var Ba=b(369),db;(function(k){k.CategoryList="categoryList";k.FunctionsMap="functionsMap";k.FunctionIdsToDisplay="functionIdsToDisplay";k.RefreshListCallback="refreshListCallback";k.HelpCallback="helpCallback";k.InitialCategory="initialCategory";k.AllCategoryName="allFunctionsCategoryName"})(db||(db={}));Object(Dd.b)("PropsKeys",db);var $b=jk.a;Am(sa,$b);sa.prototype.hh=function(){this.functionInfoManager.a2a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},
!0);this.jc=1;this.functionInfoManager.l_?this.Z9e():this.functionInfoManager.HYa(this.onFunctionInfoLoaded)};sa.prototype.Z9e=function(){var k;this.s_b=this.functionInfoManager.N$b.filter(this.Kef);var H=null!==(k=sa.Gif)&&void 0!==k?k:sa.R_g;k=this.functionInfoManager.dcd;var Y=this.functionInfoManager.mbc(H).map(function(Va){return Va.FunctionIndex}),za={};this.XE=(za[sa.Yx]=this.Cc,za[db.CategoryList]=k,za[db.FunctionsMap]=this.o6g(),za[db.FunctionIdsToDisplay]=Y,za[db.RefreshListCallback]=this.yMi.bind(this),
za[db.HelpCallback]=this.Cvb,za[db.InitialCategory]=H,za[db.AllCategoryName]=sa.AllCategoryName,za);this.initializeAndShow(this.Hm,this.hVe,this.XE)};sa.prototype.o6g=function(){var k={};this.s_b.forEach(function(H){k[H.FunctionIndex]=H});return k};sa.prototype.rQj=function(k){k=k.map(function(H){return H.FunctionIndex});this.XE[db.FunctionIdsToDisplay]=k;this.bfb(this.Hm,this.hwb(this.hVe),this.XE)};sa.prototype.yMi=function(k,H){H?H=this.fAh(H):(H=this.functionInfoManager.mbc(k).filter(this.Kef),
sa.Gif=k);this.rQj(H)};sa.prototype.fAh=function(k){k=void 0===k?"":k;k=k.toLocaleLowerCase();var H=this.s_b.filter(function(Y){return Y.NameUI.toLocaleLowerCase().startsWith(k)});3<=k.length&&(H.push.apply(H,Fl(this.s_b.filter(function(Y){return Y.NameUI.toLocaleLowerCase().includes(k)&&!H.includes(Y)}))),H.push.apply(H,Fl(this.s_b.filter(function(Y){return Y.Help.toLocaleLowerCase().includes(k)&&!H.includes(Y)}))));return H};Ek.Object.defineProperties(sa.prototype,{Cc:{configurable:!0,enumerable:!0,
get:function(){return"FunctionDialog"}}});sa.AllCategoryName=Ae.a.instance.fa(1015);sa.R_g=Ae.a.instance.fa(1014);sa.Gif=void 0;Object(Dd.a)(sa,"FunctionDialog",jk.a,[]);var Cc=b(71),fd=b(231),gd=Cc.a.Fnh,Sc=Cc.a.WMe,Pc=Cc.a.XMe,Pd=Cc.a.j9c,Vd=Cc.a.Hnh,Ie=Cc.a.Lnh,sf=Cc.a.SMe,Bf=Cc.a.$Me,Bg=Cc.a.Jnh,xg=Cc.a.TMe,Nh=Ri.a;Am(ba,Nh);ba.prototype.initialize=function(){this.Qb.classList.add(Cc.a.Dnh);this.Qb.innerHTML=ba.fH();this.Ne||(this.cl(),this.K2());Nh.prototype.initialize.call(this);var k=Kc.DOMElementExtensions.Pj(this.Qb,
xg);this.rtl&&(k.align="right",this.Bub.style.marginLeft="5px");this.Ne&&(k.style.padding="1px");this.functionInfoManager.a2a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};ba.prototype.dispose=function(){this.functionInfoManager&&(this.functionInfoManager.lbb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.Dk(this.od));kg.a.zc([this.U1b,this.f6,this.nxb,this.KJa,this.Cub]);Nh.prototype.dispose.call(this)};ba.prototype.cl=function(){this.LJa=Kc.DOMElementExtensions.Pj(this.Qb,
gd);this.fja=Kc.DOMElementExtensions.Pj(this.Qb,Sc);this.LJa.setAttribute(Ea.a.Td,Ea.a.X_b);this.KJa=new Gj.a(this.LJa,!0);this.Cub=new Gj.a(this.fja,!0);this.kVe=Kc.DOMElementExtensions.Pj(this.Qb,Ie);this.Bub=Kc.DOMElementExtensions.Pj(this.Qb,Vd);this.oVe=Kc.DOMElementExtensions.Pj(this.Qb,Bf);this.Ukf=Kc.DOMElementExtensions.Pj(this.Qb,Bg);this.lVe=$get(ba.fcd,this.Qb);this.eja=Kc.DOMElementExtensions.Pj(this.Qb,sf);this.Ne&&(this.eja.style.paddingLeft="1px");this.functionInfoManager.HYa(this.onFunctionInfoLoaded);
this.functionInfoManager.$.ea.hk(this.od)};ba.prototype.fR=function(k){var H=this;this.$.da.$a(40,function(){H.KJa.fR(k)})};ba.prototype.tm=function(){this.Mbd?this.formulaAssistanceManager.F6c():this.formulaAssistanceControl.set_visible(!1);Nh.prototype.tm.call(this);this.Djd||(this.getButton(0).get_element().disabled=!0)};ba.prototype.setFocus=function(){!this.LJa.disabled&&this.Djd&&Kc.DOMElementExtensions.setFocus(this.LJa)};ba.prototype.commit=function(){return!0};ba.prototype.Cqb=function(){var k=
this,H=this.T$.NameDataStrings;if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var Y=new vh.a(-433697611,0,this.$.ed,8,null),za={};za=(za[Re.a.ld]=H,za);this.$.Ka.Xb(Y,za)}else{H+=ib.openParen;Y=Oe.g(this.$);Y.view.visibleArea.contains(Y.qg(null))||Y.nt(Y.ha.sa.activeCell,3,Ij.a.IEh);var Va=this.JIa.textBox;if(this.JIa.isEditing&&this.JIa.text){za=this.JIa.text;var Pb=this.v_c?za.substring(0,this.v_c):"=";this.JIa.text=Pb+H+za.substring(this.v_c+(Va.Gv?Va.Gv.length:
0),za.length);Va.caretPosition=Pb.length+H.length}else Uf.TaskExtensions.Ba(Y.startEdit(!0,1),function(){k.JIa.text="="+H;var Ac=H.length+1;Va.tRa(Ac);Va.caretPosition=Ac},this.la,11,Xf.a.current);Y.Dj&&(Y=Y.rc,Y.text=Va.text,Y.setCaretPosition(Va.caretPosition));(Y=this.JIa.QY.get(al.a.h3a))&&Y.BU(!1)}};ba.prototype.Bsa=function(){this.Mbd?this.formulaAssistanceManager.uda():this.formulaAssistanceControl.sob()};ba.prototype.Qua=function(k){this.Cub.clear();for(var H=ba.fcd+" "+ba.fVe,Y=0,za=k.length;Y<
za;++Y){var Va=this.Cub.kM(k[Y].NameUI,k[Y].FunctionIndex.toString(),!1);Oj.a.uv&&Va.classList.add(Pd);Va.setAttribute(Ea.a.rE,ba.gVe);Va.setAttribute(Ea.a.VG,H)}this.Cub.selectedIndex=0};ba.prototype.rYf=function(){if(this.T$){this.Bub.parentNode.className=Cc.a.TMe+(this.functionInfoManager.Fgc(this.T$)?"-udf":"");var k=this.T$.NameDataStrings;this.oVe.innerText=k;this.Bub.innerText=k;this.eja.innerText=this.T$.Help;k=this.T$.Params.split(ib.m$c);this.lVe.innerText=ib.openParen+(1<k.length?ib.K7b:
k[0])+ib.closeParen}};ba.fH=function(){return String.format("<div class='"+Cc.a.Enh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+Vh.a.vo+"'>{1}</div>\r\n<div class='"+Cc.a.RMe+"'>\r\n\t<select id='{16}' class='{17} "+A.a.fq+" "+A.a.$o+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+Cc.a.Inh+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+A.a.fq+"'>\r\n\t\t\t<span class='"+
A.a.rw+" "+Cc.a.Knh+"'>\r\n\t\t\t\t<img title='{3}' class='"+A.a.Nth+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",Ae.a.instance.fa(1018),Ae.a.instance.fa(1019),Ae.a.instance.fa(736),Ae.a.instance.Ab(3),Sg.a.We(13),Ae.a.instance.fa(1020),ba.GEh,ba.fcd,7,gd,Vd,Ie,sf,Bf,Bg,xg,ba.LEh,Sc+(Oj.a.uv?" "+Pc:""),ba.fVe,
ba.gVe)};Ek.Object.defineProperties(ba.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDeprecatedDialog"}},T$:{configurable:!0,enumerable:!0,get:function(){if(!this.fja||!this.fja.firstChild)return null;var k=Number.parseInvariant(this.fja.children[this.fja.selectedIndex].value);return this.functionInfoManager.uPh(k)}}});ba.fcd="function_dialog_param_string";ba.fVe="function_dialog_function_description";ba.gVe="function_dialog_function_name";ba.LEh="function_list";ba.GEh=
"function_category";Object(Dd.a)(ba,"FunctionDeprecatedDialog",Ri.a,[]);I.prototype.Zc=function(k,H){if(!Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;switch(H){case 753860909:case -2060563418:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return k=Oe.g(this.$).lk,k.D5a||!k.isEditing||0>=k.text.length?!1:!0;default:return!1}};
I.prototype.executeCommand=function(k,H,Y){H=H.command;k=Oe.g(this.$);var za=k.lk;switch(H){case 753860909:case -2060563418:k.inRangePicker&&za.$G(!1);this.create(za);this.formulaAssistanceManager&&this.formulaAssistanceTelemetryManager.gcd.dialogShownCounter++;break;case -433697611:this.formulaAssistanceManager&&this.formulaAssistanceTelemetryManager.gcd.dialogCommitedCounter++;var Va=Y[Re.a.ld]+ib.openParen;Y.UILocation&&this.$.Xd(-1075437823,-1,0,null);k.view.visibleArea.contains(k.qg(null))||
k.nt(k.ha.sa.activeCell,3,Ij.a.KDh);var Pb=za.textBox;Y=za.textBox.caretPosition;if(za.isEditing&&za.text){H=za.text;var Ac=Y?H.substring(0,Y):"=";za.text=Ac+Va+H.substring(Y+(Pb.Gv?Pb.Gv.length:0),H.length);Pb.caretPosition=Ac.length+Va.length}else Uf.TaskExtensions.Ba(k.startEdit(!0,1),function(){za.text="="+Va;var id=Va.length+1;Pb.tRa(id);Pb.caretPosition=id},this.$.la,11,Xf.a.current);k.Dj&&(k=k.rc,k.text=Pb.text,k.setCaretPosition(Pb.caretPosition));this.tB?this.formulaAssistanceManager.uda():
(k=za.QY.get(al.a.h3a),null===k||void 0===k?void 0:k.BU(!1))}return qh.Task.Sa(!0)};I.prototype.Lc=function(k,H){switch(H.command){case 753860909:case -2060563418:case -433697611:return!0;default:return!1}};I.prototype.GFh=function(k,H){H=this.Ra.Yp(H);var Y=this.Ra.Pc(),za=this.functionInfoManager.mbc(k);if(!za)return nc.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),H.oC();for(var Va=0;Va<za.length;++Va){var Pb=za[Va].NameUI,Ac=this.Ra.nQ(280,
"Formulas."+k+"MenuItem_"+za[Va].FunctionIndex.toString(),-433697611,null,1,"None",0,0,Pb,!1,0);Ac.label=Pb;var id=za[Va].Params.split(ib.m$c);Ac.xS(Pb+" "+(ib.openParen+(1<id.length?ib.K7b:id[0])+ib.closeParen)+"\n"+za[Va].Help);Y.buttons.push(Ac)}k=this.Ra.Pc();za=this.Ra.nQ(280,"Formulas.MoreFunctionsMenuItem",-2060563418,A.a.oQe,3,"Image16by16",1017,0,"Formulas.MoreFunctionsMenuItem",!1,0);k.buttons.push(za);H.Ec.push(Y);H.Ec.push(k);return H.oC()};I.prototype.jd=function(k,H,Y){k=this.tPh(H);
if(-1===k)return!1;this.menuId=Y.MenuId;if(!this.functionInfoManager.l_)return this.functionInfoManager.a2a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;k=this.functionInfoManager.dcd[k];this.sM[k]=this.sM[k]||this.GFh(k,Y.MenuId);Y.MenuItems=this.sM[k];return!0};I.prototype.create=function(k){ee.a.Fef(this.$)?(this.formulaAssistanceManager.F6c(),new sa(this.$)):(new ba(this.$,k)).kf()};I.prototype.tPh=function(k){switch(k){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;
case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(Dd.a)(I,"FormulaAssistanceCommandHandler",null,[429]);var Oh=oc.a;Am($a,Oh);$a.prototype.Nd=function(){var k=this,H=rf.GetServiceTaskFactory.create(this.$.da,
102,this.la,this.ub),Y=rf.GetServiceTaskFactory.create(this.$.da,153,this.la,this.ub);Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([H,Y],this.la),function(){k.Cd([new I(k.$,H.result,Y.result)])},this.la,3)};$a.ka=function(k){oc.a.fe(92,new $a(k))};Object(Dd.a)($a,"FormulaAssistanceCommandHandlerFactory",oc.a,[]);jb.prototype.dispose=function(){this.MXd();this.MJa=this.Lua=this.$ia=null};jb.prototype.xXc=function(k){k&&(this.$ia=k,this.$ia.ine(this.MAf),this.$ia.Xne(this.OAf),this.swa&&this.$ia.Wne(this.NAf))};
jb.prototype.yXc=function(k){k&&(this.Lua=k,this.swa&&(this.Lua.gne(this.Wwf),this.Lua.ene(this.Pwf)),this.Lua.fne(this.Swf))};jb.prototype.zXc=function(k){k&&(this.MJa=k,this.MJa.FVc(this.PAf),this.MJa.BZb(this.IAf))};jb.prototype.MXd=function(){var k,H,Y;this.$ia&&(this.$ia.JPf(this.MAf),this.$ia.eQf(this.OAf),this.swa&&this.$ia.dQf(this.NAf));this.MJa&&(this.MJa.CJd(this.PAf),this.MJa.Usc(this.IAf));this.swa&&(null===(k=this.Lua)||void 0===k?void 0:k.IPf(this.Wwf),null===(H=this.Lua)||void 0===
H?void 0:H.GPf(this.Pwf));null===(Y=this.Lua)||void 0===Y?void 0:Y.HPf(this.Swf)};jb.prototype.Y4i=function(k,H){if(H){var Y="";this.swa||(Y+=Ae.a.instance.Ab(57)+this.ariaLiveNotifier.Fxa);for(var za=0;za<H.length;za++)Y+=k+this.ariaLiveNotifier.Fxa+this.aZc(H[za])+jb.fEd(za,H.length);this.swa&&(Y+=Ae.a.instance.fa(877)+this.ariaLiveNotifier.Fxa);this.ariaLiveNotifier.readText(Y)}};jb.prototype.X4i=function(k,H,Y){if(k){var za="",Va=0;if(H){for(var Pb=0;Pb<H.length;Pb++)if(Y>=k[Pb].split(this.$.listSeparator).length)Va++;
else{var Ac=H[Pb].trim();if(!Ac)return;Ac=this.aZc(Ac);var id=jb.fEd(Pb-Va,H.length-Va);za+=Ac+id;id&&(za+=this.ariaLiveNotifier.Fxa)}this.ariaLiveNotifier.readText(za)}}};jb.prototype.aZc=function(k){if(!k)return"";var H=k.split(this.$.listSeparator);k="";H=El(H);for(var Y=H.next();!Y.done;Y=H.next()){var za=Y.value;jb.iod(za)?k+=za:(za=(Y=jb.Sji(za))?za.replace("[","").replace("]",""):za,k+=String.format(Y?Ae.a.instance.Ab(59):Ae.a.instance.Ab(58),za));k+=this.ariaLiveNotifier.Fxa}return k};jb.fEd=
function(k,H){return k>=H||1===H?(nc.ULS.shipAssertTag(537161997,0,k<H,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(Ae.a.instance.Ab(55),k+1,H)+"\r\n"};jb.iod=function(k){return S.a.contains(k,ib.K7b,!0)};jb.Sji=function(k){return k.trimStart().startsWith(ib.FEf)||k.trimEnd().endsWith(ib.EEf)};Object(Dd.a)(jb,"FormulaAssistanceReadoutHandler",null,[778,3]);var Eh=gg.a;Am(Uc,Eh);Uc.prototype.create=function(){var k=this,H=this.$.da;Uf.TaskExtensions.Ba(rf.GetServiceTaskFactory.Va(H,
211,212,this.ub),function(Y){Y=H.Aa(219)||new jb(Y.result,k.$);k.Eb(Y)},this.la,3)};Uc.ka=function(k){k.da.Ga(220,new Uc(k))};Object(Dd.a)(Uc,"FormulaAssistanceReadoutHandlerFactory",gg.a,[]);var Si=b(739),Ti=b(112),Ui=b(1183);hc.prototype.Ugd=function(k){return this.JQa&&k in this.JQa?this.JQa[k]:null};hc.prototype.n6f=function(k,H){this.JQa||(this.JQa={});this.JQa[k]=H};hc.prototype.d_=function(){this.JQa=null};Object(Dd.a)(hc,"FormulaAssistanceContextualPreviewCache",null,[]);Gc.prototype.dispose=
function(){this.Od||(this.$&&(this.$.ea.VF(this.iD),this.$=null),this.zha=this.YFb=null,this.Od=!0)};Gc.prototype.Fdd=function(k,H,Y,za){var Va=this;if(H&&0>=H.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!k)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.Aa(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");
var Pb="="+H.substring(Y.start,Y.end);Ke.EwaSettings.ma(601)&&(Pb=this.calcManager.oYh(Oe.g(this.$).ha.sa.activeCell,k,Y));var Ac=this.yLh(Pb,Y);if(Ke.EwaSettings.ma(601)){if(Ac&&!this.calcManager.isFormulaSubExpressionVolatile(k))return Promise.resolve(Ac)}else if(Ac)return Promise.resolve(Ac);return this.ALh(Pb,Y).then(function(id){if(Va.d0c(za))throw Error.create("OperationCanceledException");if(!id||id.Ogj||id.Yma.startsWith("##UNSUPPORTED:"))return Va.NXe(H,Pb,Y,za);Va.zha.n6f(Pb,id.Yma);return Promise.resolve(id)})};
Gc.prototype.yLh=function(k,H){return(k=this.zha.Ugd(k))?new Ui.a(k,H.start,H.end,0):null};Gc.prototype.ALh=function(k,H){if(!k||0>=k.length||!H)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.SSg(Oe.g(this.$).ha.sa.activeCell,k,this.Cyi,H)};Gc.prototype.NXe=function(k,H,Y,za){var Va=this;if(!k||0>=k.length||!H||0>=H.length||!Y)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.bPa)return this.zLh(k,H,Y,za);var Pb={};Pb.PartialFormula=H;Pb.Formula=k;Pb.SourceRange=ve.v(Oe.g(this.$).ha.sa.activeCell,this.$);return this.bPa=new Promise(function(Ac,id){Va.YFb=new Si.a;Va.eSf=Va.$.ea.rf;Va.K$a=zb(Va.$.na.ua,Pb,function(Ld){Va.BTi(H,Y,za,Ld,Ac,id)},function(Ld){Va.bPa=null;Va.K$a=null;id(Ld)},null,null,null);Va.YFb.token.R(function(){Va.vUg(id)})})};Gc.prototype.BTi=function(k,H,Y,za,Va,Pb){this.K$a=this.bPa=null;if(this.eSf!==this.$.ea.rf)Pb(Error.create("OperationCanceledException"));
else if(za.Result)if(za=Xd.a.mi(za.Result),!za||Ti.a.isEmpty(za))Va(null);else{for(var Ac in za)this.zha.n6f(Ac,za[Ac]);this.d0c(Y)?Pb(Error.create("OperationCanceledException")):(k=this.zha.Ugd(k))?(""===k&&(k=" "),Va(new Ui.a(k,H.start,H.end,0))):Pb(Error.create("SubexpressionNotFoundException"))}else Va(null)};Gc.prototype.zLh=function(k,H,Y,za){var Va=this;return new Promise(function(Pb,Ac){Va.bPa.then(function(){Va.SSf(k,H,Y,za,Pb,Ac)}).catch(function(){Va.SSf(k,H,Y,za,Pb,Ac)})})};Gc.prototype.SSf=
function(k,H,Y,za,Va,Pb){if(this.d0c(za))Pb(Error.create("OperationCanceledException"));else{var Ac=this.zha.Ugd(H);Ac?Va(new Ui.a(Ac,Y.start,Y.end,0)):this.NXe(k,H,Y,za).then(function(id){Va(id)}).catch(function(id){Pb(id)})}};Gc.prototype.vUg=function(k){this.K$a&&(ch.a.Du(this.K$a.Qt)?(this.bPa=this.K$a=null,k(Error.create("PendingWebReqeuestCancelled"))):nc.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};Gc.prototype.d_=function(){this.wUg();this.zha&&this.zha.d_()};
Gc.prototype.wUg=function(){this.YFb&&this.YFb.C()};Gc.prototype.d0c=function(k){return this.Od||k.oK};Object(Dd.a)(Gc,"FormulaAssistanceContextualPreviewCalculator",null,[3]);var bj=b(221);Xb.soh="ewa-facp-text-box";Object(Dd.a)(Xb,"CssClassNames",null,[]);Wa.prototype.dispose=function(){(this.L$||this.mQ)&&this.F7e();this.Ya=this.tqa=null};Wa.prototype.dQj=function(k,H,Y,za){k&&H&&za&&H.Yma&&!(1>H.Yma.length)&&(this.Ya=k,this.OOf(),this.j2a=H,this.QSa=za,this.Fyj(H,Y,za))};Wa.prototype.F7e=function(){this.T5h();
this.OOf();this.QSa=this.j2a=null};Wa.prototype.Fyj=function(k,H,Y){var za=this;if(k.Yma&&!(1>k.Yma.length)){var Va=this.Tc.da.Aa(266);if(Va){var Pb=Va.CRh();Pb&&Uf.TaskExtensions.Ba(this.RBb,function(){if(H)if(Ke.EwaSettings.ma(601)&&za.Ya.isEditing&&0<Y.length){za.yxb(k.IJa,Y[0].start,null);var Ac=za.E2e(Y[0],Pb),id=za.Ya.text.substring(Y[0].start,Y[0].end).trim();id=za.Ya.text.indexOf(id);id=za.Ya.text.substring(0,id).lastIndexOf("\n");za.yxb(0>id||1>=Y.length?Y[0].start:id+1,Y[0].end,Ac?String.format(Ac,
.3):null);for(var Ld=1;Ld<Y.length;Ld++)Ac=za.E2e(Y[Ld],Pb),id=za.Ya.text.substring(Y[Ld].start,Y[Ld].end).trim(),id=za.Ya.text.indexOf(id),id=za.Ya.text.substring(Y[Ld-1].end,id).lastIndexOf("\n"),za.yxb(0>id?Y[Ld-1].end:id+1+Y[Ld-1].end,Y[Ld].end,Ac?String.format(Ac,.3):null);id=za.Ya.text.substring(Y[Y.length-1].end,k.Nua).indexOf("\n");za.yxb(0>id?Y[Y.length-1].end:id+1+Y[Y.length-1].end,k.Nua,null);nc.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else za.yxb(k.IJa,
k.Nua,null),nc.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");za.L$||(za.L$=document.createElement(bj.a.div),za.Ya.textBox.domElement.appendChild(za.L$));za.mQ||(za.mQ=document.createElement(bj.a.div),za.mQ.className=Xb.soh,za.Tc.domElement.appendChild(za.mQ));Ac=k.Nua;Ke.EwaSettings.ma(601)&&za.Ya.isEditing&&Y&&0<Y.length&&Y[0].start<Ac&&Y[0].start!==k.IJa&&!za.Ya.textBox.Gv.length&&
(Ac=Y[0].start);Ld=S.a.contains(za.Ya.textBox.lf.id,"FormulaBar",!0)&&S.a.contains(za.Ya.text.substring(k.IJa,k.Nua),"\n",!0);id=za.Ya.isEditing?za.Ya.textBox.caretPosition:0;Ac=excelOnline.utils.getBoundingRectForText(za.Ya.textBox.lf,Ld?id:k.IJa,Ld?id:Ac,Ke.EwaSettings.ma(601));za.mQ.style.left=$c.HelperMethods.nc(Ac.left);za.mQ.style.top=$c.HelperMethods.nc(Ac.top);za.mQ.style.width=$c.HelperMethods.nc(Ac.width);za.mQ.style.height=$c.HelperMethods.nc(Ac.height);Ac=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",
k.Nua,k.Nua);dialogControls.renderToolTip(za.L$,Ac,k.Yma,za.mQ,0,!1,!1,1)},this.Tc.la,3)}}};Wa.prototype.E2e=function(k,H){var Y=this.Ya.text,za=Y.substring(k.start,k.end);za=za.trim();k=Y.indexOf(za,k.start);H=Y.indexOf(H,k);za=Y.substring(k,H);za=za.trim();return this.Ya.colors.getItem(k+"-"+(k+za.length))};Wa.prototype.T5h=function(){var k=this;this.Ya&&this.L$&&this.mQ&&Uf.TaskExtensions.Ba(this.RBb,function(){k.Ya.textBox.domElement.contains(k.L$)&&(dialogControls.clearToolTip(k.L$),k.Ya.textBox.domElement.removeChild(k.L$),
k.L$=null);k.Tc.domElement.contains(k.mQ)&&(k.Tc.domElement.removeChild(k.mQ),k.mQ=null)},this.Tc.la,3)};Wa.prototype.yxb=function(k,H,Y){if(this.Ya&&!(k>=H)){var za={};this.Ya.textBox.formatText(k,H-k,(za.background=Y||"#E3DDCC",za));this.njd=!0}};Wa.prototype.OOf=function(){if(this.Ya&&this.j2a&&this.njd){var k=this.j2a.Nua;Ke.EwaSettings.ma(601)&&0<this.QSa.length&&this.QSa[this.QSa.length-1].end>k&&(k=this.QSa[this.QSa.length-1].end);var H={};this.Ya.textBox.formatText(this.j2a.IJa,k-this.j2a.IJa,
(H.background=!1,H));this.njd=!1}};Ek.Object.defineProperties(Wa.prototype,{RBb:{configurable:!0,enumerable:!0,get:function(){var k=this;if(this.tqa)return this.tqa;var H=new pi.a;this.Tc.RC(function(Y){Uf.TaskExtensions.Ba(Y.Ctd(),function(){H.setResult(!0)},k.Tc.la,3)});return this.tqa=H.task}}});Object(Dd.a)(Wa,"FormulaAssistanceContextualPreviewControl",null,[3]);var Vi=b(47),pj=b(44);wb.prototype.L2f=function(k,H,Y){Y?this.v5g(k,H,Y):this.R4e(k,H,Y,!0)};wb.prototype.vfj=function(){this.X7=0};
wb.prototype.v5g=function(k,H,Y){var za=this;this.X7++;var Va=this.X7;Vi.a.instance.create(function(){za.R4e(k,H,Y,Va===za.X7)},500,pj.a.LDh,!0,!0)};wb.prototype.R4e=function(k,H,Y,za){var Va=this,Pb=this.Lbd.Fdd(k,H);Pb&&Pb.then(function(Ac){za&&Va.Lbd.Sod(H)&&Va.Lbd.cQj(k,Ac,Y)}).catch(function(Ac){Ac=Object(Pa.a)(Error,Ac);"OperationCanceledException"===Ac.message?nc.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",Ac):nc.ULS.sendTraceTag(537162058,0,
10,"GetContextualFormulaPreviewResults - caught exception: {0}",Ac)})};Object(Dd.a)(wb,"FormulaAssistanceContextualPreviewHoverManager",null,[]);ic.prototype.dispose=function(){this.c_c();kg.a.zc([this.rub,this.C$b]);this.D$b=this.C$b=this.rub=null;this.$&&Oe.g(this.$).rc.Dn(this.D9a);this.xha=this.Ya=this.$=null};ic.prototype.Gyj=function(k,H){H&&ih.e(H.text)&&!(H.Cwa||H.textBox.Gv||this.Ya&&this.Ya.textBox.Gv)&&(this.Ya=H,this.calcManager=this.$.da.Aa(266))&&(nc.ULS.sendTraceTag(537162056,0,50,
"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),k=$c.HelperMethods.avb(k),k=this.calcManager.lYh(Oe.g(this.$).ha.sa.activeCell,this.Ya.text,k.x,k.y),H=this.calcManager.getSubExpressionSpan(k),!H||H.end<=H.start||this.Sod(H)||(this.xha=H,this.D$b.L2f(k,H,!0)))};ic.prototype.TRd=function(k){if(k&&ih.e(k.text))if(k.textBox.Gv&&k.textBox.Gv.trim()){if(this.Ya=k,this.calcManager=this.$.da.Aa(266)){nc.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");k={};var H=this.Ya.textBox.Gv.trim();k.start=this.Ya.text.indexOf(H,this.Ya.textBox.caretPosition);k.end=k.start+H.length;(H=this.calcManager.getFormulaSubExpressionObject(Oe.g(this.$).ha.sa.activeCell,this.Ya.text,this.Ya.textBox.Gv))&&!this.Sod(k)&&(this.xha=k,this.D$b.L2f(H,k,!1))}}else this.j5a(!1,!0)};ic.prototype.j5a=function(k,H){!this.Ya||H&&this.Ya.textBox.Gv||
(this.xha=null,k&&(this.c_c(),this.C$b.d_(),this.D$b.vfj()),this.rub&&this.rub.F7e(),this.Ya.Cwa||(this.Ya.Cwa=!1,this.Ya=null))};ic.prototype.Fdd=function(k,H){if(!this.Ya||this.Ya.Cwa)return null;this.c_c();this.Erb=new Si.a;return this.C$b.Fdd(k,this.Ya.text,H,this.Erb.token)};ic.prototype.cQj=function(k,H,Y){this.Erb=null;!k||!H||!H.Yma||0>=H.Yma.length?this.j5a(!1,!1):(k=this.calcManager.mYh(Oe.g(this.$).ha.sa.activeCell,k,this.Ya.text),this.rub.dQj(this.Ya,H,Y,k))};ic.prototype.Sod=function(k){return this.xha?
k.start===this.xha.start&&k.end===this.xha.end&&k.pre===this.xha.pre&&k.post===this.xha.post:!1};ic.prototype.c_c=function(){this.Erb&&this.Erb.C()};Object(Dd.a)(ic,"FormulaAssistanceContextualPreviewManager",null,[783,3,784]);var sj=b(1259),eh=b(983),ui=b(254),cj=b(167);Kb.prototype.gZf=function(k){this.yT=0;this.T8d=k.IsCompatibility;this.set_name(k.NameDataStrings);this.YVa=k.Help};Kb.prototype.mpj=function(k){this.yT=1;this.set_name(k.Name)};Kb.prototype.Ooj=function(k){this.yT=2;this.set_name(k.name);
this.YVa=k.tooltip};Kb.prototype.kqj=function(k){this.yT=3;this.set_name(k.name);this.YVa=k.toolTip};Kb.prototype.H_f=function(k){this.yT=4;this.set_name(k.name)};Kb.prototype.Dsj=function(k){this.yT=5;this.set_name(k.name);this.YVa=k.toolTip};Kb.prototype.Csj=function(k){this.yT=7;this.set_name(k.name)};Kb.prototype.arj=function(){this.yT=6;this.set_name(Ae.a.instance.Ab(183));this.YVa=Ae.a.instance.Ab(184)};Kb.prototype.set_name=function(k){return this.p$d=k};Kb.P9g=function(){return Object(ag.a)(new Kb(!0),
{})};Ek.Object.defineProperties(Kb.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.yT}},Ffi:{configurable:!0,enumerable:!0,get:function(){return this.T8d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.p$d}},eja:{configurable:!0,enumerable:!0,get:function(){return this.YVa}},lAb:{configurable:!0,enumerable:!0,get:function(){return this.brg}}});Object(Dd.a)(Kb,"AutoCompleteItem",null,
[860]);Object(Dd.a)(bc,"DefinedNameInfo",null,[]);Cd.prototype.CMj=function(k){var H=this.NGe[k.toUpperCase()];if(!H)return{returnValue:!1,sheetName:"",range:null};k=H.sheetName;H=this.v2g(H.namedRange);return{returnValue:!0,sheetName:k,range:H}};Cd.prototype.K2g=function(k){if(null!=k&&void 0!=k)return{top:k.top,left:k.left,bottom:k.bottom,right:k.right,maxRows:k.maxRows,maxColumns:k.maxColumns,sheetName:void 0}};Cd.prototype.v2g=function(k){if(null!=k&&void 0!=k)return new Gk.a(k.top,k.left,k.bottom,
k.right,k.maxRows,k.maxColumns)};Cd.prototype.D2g=function(k){switch(k){case 2:return 0;case 3:return 1;default:return-1}};Ek.Object.defineProperties(Cd.prototype,{MGe:{configurable:!0,enumerable:!0,get:function(){var k=[];if(!this.$.Hb||!this.$.Hb.items)return k;for(var H=0,Y=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&ee.a.tB(this.$),za=El(this.$.Hb.items),Va=za.next();!Va.done;Va=za.next())if((Va=Va.value)&&(3===Va.type&&Va.usedRange||Y&&2===
Va.type)){var Pb=new bc;Pb.tooltip=Va.sheetName+d.a.exclamation+Va.usedRange.toString();Pb.name=Va.name;Pb.namedRange=this.K2g(Va.usedRange);Pb.sheetName=Va.sheetName;Pb.type=this.D2g(Va.type);k.push(Pb);this.NGe[Va.name.toUpperCase()]=Pb;++H;if(H===ib.gpf){nc.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: {0}",ib.gpf);break}}return k}}});Object(Dd.a)(Cd,"DefinedNameInfoManager",null,[]);var dj=b(126),Pj=Sys.EventArgs;Am(yc,Pj);Object(Dd.a)(yc,"FormulaAssistanceFunctionChangedEventArgs",
Sys.EventArgs,[]);var hi=Sys.EventArgs;Am(Qb,hi);Object(Dd.a)(Qb,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var ei=Sys.EventArgs;Am(Ja,ei);Object(Dd.a)(Ja,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Mh=b(271);Db.prototype.Wf=function(k,H){k=!1;H||(Oe.g(this.$).lk.textBox.kK=!0,k=this.formulaAssistanceUIControl.focus(this.OUe));return k};Db.prototype.ph=function(k){var H=this.uc;return!(void 0===H||null===H)&&Kc.DOMElementExtensions.Ff(H,k)};
Db.prototype.Cj=function(){this.h5e&&this.h5e()};Db.prototype.Rj=function(){};Db.prototype.dispose=function(){Mh.a(this.$).Vz(this)};Ek.Object.defineProperties(Db.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.QZc},set:function(k){this.QZc!==k&&(k?Mh.a(this.$).$h(this):Mh.a(this.$).Vz(this),this.QZc=k)}},we:{configurable:!0,enumerable:!0,get:function(){return this.Wkj}},uc:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.OUe)}}});
Object(Dd.a)(Db,"FormulaAssistanceFocusManager",null,[444,3]);var ai=b(1117),lj=sh.a;Am(rc,lj);rc.prototype.HYa=function(k){this.addHandler("FunctionInfoLoaded",k)};rc.prototype.lbb=function(k){this.removeHandler("FunctionInfoLoaded",k)};rc.prototype.EEg=function(k){this.addHandler("FunctionInfoReset",k)};rc.prototype.Faj=function(k){this.removeHandler("FunctionInfoReset",k)};rc.prototype.dispose=function(){var k=this.$.da.Aa(268);k&&k.jJd(this.$wf);this.wb=null;lj.prototype.dispose.call(this)};rc.prototype.xSf=
function(){this.raiseEvent("FunctionInfoReset")};rc.prototype.QKd=function(){this.xSf();this.kLc=!1;this.uT=null;this.iLc=!0};rc.prototype.a2a=function(k,H){var Y=this;H=void 0===H?!1:H;if(this.l_)this.jKf();else{nc.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.ya.UICultureTag);var za=null;(za=this.$.da.Aa(268))||nc.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===za||void 0===za?0:za.gja)&&
0<za.gja.length)Ke.EwaSettings.ma(122)?za.lDh(this.oxf):this.CHd(za.gja,!0,!1);else{var Va=this.$.na.ua.hc();k&&(this.$.ea.sc||H)&&!this.Ehi&&(H?zg.a(this.$.userOperationManager,function(Pb,Ac,id){return Jg.x(Y.$.na.ua,k,Rg.b(Pb,Y.qxf),Rg.a(Ac,Y.pxf),id,k,Va)},function(Pb){return new Ed.a(130,0,Pb,16)},null):Jg.x(this.$.na.ua,k,this.qxf,this.pxf,null,k,Va));!this.l_&&this.$.ea.sc&&(za?(nc.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",
this.l_,this.$.ea.sc),za.hne(this.$wf)):(nc.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),Jg.x(this.$.na.ua,{FilterType:0},this.oxf,null,null,null,Va),this.iLc=!1))}}};rc.prototype.uPh=function(k){return 0>k||k>=this.uT.length?null:this.uT[k]};rc.prototype.Ged=function(k){return Ih.a.Nc(this.ncd,k.toUpperCase())};rc.prototype.mbc=function(k){return Ih.a.Nc(this.NJa,k)};rc.prototype.Fgc=function(k){return!k.GroupUI};
rc.prototype.cxf=function(k,H,Y){var za=Dh.a(k);nc.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",za);za?(Oe.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.Fp(k.Errors)):(this.CHd(k.Result,H,Y),ee.a.XV()&&!ee.a.tB(this.$)&&this.oSj())};rc.prototype.CHd=function(k,H,Y){nc.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",
k.length,H,Y,this.l_);this.l_||(this.uT=k,this.DPg(H),this.kLc=!Y,this.jKf())};rc.prototype.jKf=function(){this.raiseEvent("FunctionInfoLoaded")};rc.prototype.oSj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.N$b)};rc.prototype.DPg=function(k){function H(Jf,Kg){return Jf.NameUI.localeCompare(Kg.NameUI)}var Y=Ae.a.instance.fa(1014),za=[];this.NJa={};this.U8=[];this.NJa[Y]=za;var Va=Ae.a.instance.fa(1015),Pb=[];this.U8.push(Y);this.U8.push(Va);Y=0;for(var Ac=this.uT.length;Y<Ac;Y++){var id=
this.uT[Y];id.IsCompatibility||Pb.push(id);var Ld=id.NameUI,ld=id.NameDataStrings;this.ncd[ld.toUpperCase()]||(this.ncd[ld.toUpperCase()]=id);this.qVe[Ld.toUpperCase()]||(this.qVe[Ld.toUpperCase()]=id);if(!this.Fgc(id)){if(k){Ld=id.GroupUI;var ef=Ih.a.Nc(this.NJa,Ld);ef||(ef=[],this.NJa[Ld]=ef,this.U8.push(Ld));ef.push(id)}id.IsCommonlyUsed&&za.push(id);id.IsCompatibility||this.Gog.push(ld)}}this.NJa[Va]=Pb;k&&(rc.bOf(za,[2,3,0,5,4,9,1,7,8,6]),za=Array(14),za[0]=0,za[1]=1,za[2]=7,za[3]=11,za[4]=5,
za[5]=2,za[6]=6,za[7]=10,za[8]=9,za[9]=3,za[10]=4,za[11]=13,za[12]=12,za[13]=8,rc.bOf(this.U8,za),za=[],Array.addRange(za,this.U8),Array.removeAt(za,13),this.U8=za);this.uT=Array.clone(this.uT);this.uT.sort(function(Jf,Kg){return Jf.NameDataStrings.localeCompare(Kg.NameDataStrings)});za=1;for(Va=this.U8.length;za<Va&&k;za++)this.NJa[this.U8[za]].sort(H);k=0;for(za=this.uT.length;k<za;k++)this.uT[k].FunctionIndex=k};rc.bOf=function(k,H){for(var Y=Array.clone(k),za=0;za<Y.length&&za<H.length;za++)k[za]=
Y[H[za]]};Ek.Object.defineProperties(rc.prototype,{l_:{configurable:!0,enumerable:!0,get:function(){return this.kLc}},Ehi:{configurable:!0,enumerable:!0,get:function(){return this.iLc}},N$b:{configurable:!0,enumerable:!0,get:function(){var k=this.uT,H=ai.a(this.$);if(!H)return k;H=H.IOh();var Y=H.length;if(0>=Y)return k;var za=[];Array.addRange(za,k);for(k=0;k<Y;k++){var Va=H[k],Pb={};Pb.FunctionIndex=za.length;Pb.HelpId=Pb.GroupUI=null;Pb.Help=Va.description;Pb.IsCommonlyUsed=Pb.IsCompatibility=
!1;Pb.NameDataStrings=Va.name;Pb.NameUI=Va.name;Pb.Params=null;Pb.ParamsHelp=null;za.push(Pb)}return za}},dcd:{configurable:!0,enumerable:!0,get:function(){return this.U8}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Object(Dd.a)(rc,"FunctionInfoManager",sh.a,[773,774,3]);var Mi=b(1179),vi=Mi.a;Am(ob,vi);ob.prototype.setVisible=function(k){Kc.DOMElementExtensions.setVisible(this.domElement,k);k||(this.domElement.style.top="auto",this.domElement.style.left="auto")};ob.prototype.isRtl=
function(){return this.lj};ob.prototype.G0e=function(){return this.domElement.parentNode};ob.prototype.JRa=function(k){var H=this.domElement.style;H.cursor="move";H.position=k?"relative":"absolute"};Object(Dd.a)(ob,"FunctionParamBoxDraggableItem",Mi.a,[]);Object(Dd.a)(cb,"FormulaArgumentAssistanceCallbacks",null,[]);Object(Dd.a)(pb,"FormulaArgumentAssistanceRenderingInfo",null,[]);Object(Dd.a)(Tb,"ArgumentAssistanceRequest",null,[]);tc.prototype.ka=function(k){(this.root=k)&&!this.un&&(this.root.addEventListener("keydown",
this.onKeyDown,!0),this.un=!0)};tc.prototype.detach=function(){this.root&&this.un&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.un=!1)};tc.prototype.i8b=function(){this.root&&(this.target=this.kH.QCf("move",!0),this.TTd=this.target.getBoundingClientRect(),this.$Z=!0,this.VQd=!1,this.Cv(),this.Elc||this.$3c(),this.target.appendChild(this.Elc))};tc.prototype.m4=function(k){this.kH.owf(void 0===k?!1:k);this.$Z=!1;this.LId();this.mId();this.TTd=this.target=void 0};tc.prototype.Cv=function(){this.xr.capture(this.gNa,
null);this.pointerInputManager.zt(Eg.a.pointerDown,this.target,this.hGb,!0);this.target.addEventListener("blur",this.onBlur)};tc.prototype.mId=function(){this.xr.releaseCapture();this.pointerInputManager.Ft(Eg.a.pointerDown,this.target,this.hGb,!0);this.target.removeEventListener("blur",this.onBlur)};tc.prototype.LId=function(){var k;this.target&&(null===(k=this.Elc)||void 0===k?void 0:k.parentNode)===this.target&&this.target.removeChild(this.Elc)};tc.prototype.d6=function(k,H){var Y=this.target.getBoundingClientRect();
k+=Y.left-this.TTd.left;H+=Y.top-this.TTd.top;this.kH.onMove(k,H)};tc.prototype.$3c=function(){this.Elc=Bi.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")};Object(Dd.a)(tc,"FormulaAssistanceMoveAdapter",null,[]);var bi=b(287);wc.prototype.uba=function(){return this.un&&!!this.Pja};wc.prototype.KOa=function(k){this.Pja.style.cursor="grabbing";this.wEj=k.clientPoint.x;this.xEj=k.clientPoint.y;this.kH.QCf("drag");return!0};wc.prototype.Tla=function(k){this.kH.onMove(k.clientPoint.x-
this.wEj,k.clientPoint.y-this.xEj);return!0};wc.prototype.Sla=function(){this.Yt()};wc.prototype.Rla=function(){this.Yt()};wc.prototype.ka=function(k){if(this.Pja=k)this.Pja.style.cursor="grab",bi.a.instance.v0(this.Pja,this),this.un=!0};wc.prototype.detach=function(){this.un&&this.Pja&&(this.Pja.style.cursor="",bi.a.instance.e8(this.Pja,this),this.un=!1)};wc.prototype.Yt=function(){this.Pja.style.cursor="grab";this.kH.owf()};Object(Dd.a)(wc,"FormulaAssistanceDragAdapter",null,[884]);Sb.prototype.ka=
function(k,H,Y,za){this.root=k;this.render=Y;this.dismiss=za;this.detach();H&&(this.nJe.ka(H),this.fqf.ka(k.firstChild),this.un=!0)};Sb.prototype.detach=function(){this.un&&(this.nJe.detach(),this.fqf.detach(),this.un=!1);Kc.DOMElementExtensions.Af(this.placeholder)};Sb.prototype.clear=function(){this.E$b.setOverrideTarget(void 0);this.detach();this.AKd()};Sb.prototype.QCf=function(k,H){H=void 0===H?!1:H;this.usageCount[k]+=1;this.Oyc=this.root.firstChild.getBoundingClientRect();this.placeholder=
this.root.cloneNode(!0);k=this.placeholder.firstChild;k.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);H&&(this.$Ed=document.activeElement,k.tabIndex=0,k.focus());this.dismiss();return k};Sb.prototype.onMove=function(k,H){k=Math.min(Math.max(k,this.lDc-this.Oyc.left),window.innerWidth-this.Oyc.right-this.lDc);H=Math.min(Math.max(H,this.lDc-this.Oyc.top),window.innerHeight-this.Oyc.bottom-this.lDc);this.placeholder.firstChild.style.transform="translate("+k+"px, "+
H+"px)"};Sb.prototype.owf=function(k){var H=this;k=void 0===k?!0:k;var Y=this.placeholder.firstChild.getBoundingClientRect(),za=this.E$b.getDirectionalHint({top:Y.top,left:Y.left});this.E$b.setOverrideTarget({top:1===za?Y.bottom:Y.top,left:Y.left});this.render();window.requestAnimationFrame(function(){Kc.DOMElementExtensions.Af(H.placeholder);H.$Ed&&(k&&H.$Ed.focus(),H.$Ed=void 0)})};Sb.prototype.AKd=function(){var k=this.formulaAssistanceTelemetryManager.d$,H=this.usageCount[Fh.Drag],Y=this.usageCount[Fh.Move];
0<H&&(k.argumentAssistanceDragCounter+=1,k.argumentAssistanceDragTotalCounter+=H,this.usageCount[Fh.Drag]=0);0<Y&&(k.argumentAssistanceMoveCounter+=1,k.argumentAssistanceMoveTotalCounter+=Y,this.usageCount[Fh.Move]=0)};Object(Dd.a)(Sb,"FormulaAssistanceDragControl",null,[]);var Fh;(function(k){k.Drag="drag";k.Move="move"})(Fh||(Fh={}));Object(Dd.b)("FormulaAssistanceDragMode",Fh);var kk=fi.a;Am(gb,kk);gb.prototype.ine=function(k){this.addHandler("FAFunctionNameUpdated",k)};gb.prototype.JPf=function(k){this.removeHandler("FAFunctionNameUpdated",
k)};gb.prototype.Xne=function(k){this.addHandler("FAParameterSelectionChangedOld",k)};gb.prototype.eQf=function(k){this.removeHandler("FAParameterSelectionChangedOld",k)};gb.prototype.Wne=function(k){this.addHandler("FAParameterSelectionChanged",k)};gb.prototype.dQf=function(k){this.removeHandler("FAParameterSelectionChanged",k)};gb.prototype.set_visible=function(k){this.Hk?k||this.nsb():Sys.UI.Control.prototype.set_visible.call(this,k);return k};gb.prototype.nsb=function(){this.formulaAssistanceUIControl&&
(this.Yq=null,this.nR&&this.kH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Yka=null,this.rr.canReceiveFocus=!1)};gb.prototype.show=function(k){this.Hk||(this.formulaAssistanceTelemetryManager.L7(["argumentAssistanceRender"]),this.K1a.setVisible(!!k),this.formulaAssistanceTelemetryManager.vZ(["argumentAssistanceRender"]),this.ZWc&&(this.ZWc=!1,this.formulaAssistanceTelemetryManager.V7b("argumentAssistanceOverall")))};gb.prototype.EKd=function(){var k=this;if(!this.sba||this.YRa){this.formulaAssistanceTelemetryManager.L7(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);var H=Oe.g(this.$).lk;this.pluginScheduler.requester().argumentAssistance(Object(ag.a)(new Tb,{content:H.text,caretPosition:H.textBox.caretPosition})).then(function(Y){0===Y.kind?Y.payload?(k.formulaAssistanceTelemetryManager.vZ(["argumentAssistanceComputation"]),k.kyj(k.xEd(Y.payload),H.textBox.domElement)):k.nsb():k.formulaAssistanceTelemetryManager.vZ(["argumentAssistanceComputation"],!1);return null})}};gb.prototype.update=function(k,H,Y,za){if(!this.Hk&&k){this.formulaAssistanceTelemetryManager.L7(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);this.ZWc=!0;var Va=this.$.listSeparator;try{var Pb=$get(ib.lcd,this.Nj),Ac=$get(ib.ecd,this.Nj);Pb.innerText="";Ac.innerText="";var id=$get(ib.mVe,this.Nj),Ld=k.Params.split(ib.m$c);Pb=[];Ac=0;for(var ld=id.rows.length;Ac<ld;Ac++){var ef=id.rows[Ac];Kc.DOMElementExtensions.setVisible(ef,Ac<Ld.length);var Jf=Ld[Ac],Kg=ib.LVi+Ac+"_",Cg=k.NameDataStrings;$get(Kg+ib.KFb,ef).innerText=Cg;$get(Kg+ib.aDd,ef).innerText=Cg;if(Jf){var Wg=Ld[Ac].split(Va),wi=gb.iod(Wg[Wg.length-
1]),oj=gb.Wji(k);wi&&(oj&&(2<Wg.length?(Wg[Wg.length-2]+="1",Wg[Wg.length-3]+="1"):nc.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Cg,Wg.length.toString(),H)),gb.KJg(Wg,oj,H,k));Jf=Wg.join(Va.toString()+" ");Ld[Ac]=Jf;Y<Wg.length?(Pb[Ac]=Wg[Y],nc.ULS.shipAssertTag(537162072,0,!!Wg[Y]&&1<=Wg[Y].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
Y,Wg.length,Cg,Ac),Wg[Y]=String.format("{0}{1}{2}","<b>",Wg[Y],"</b>"),Jf=Wg.join(Va.toString()+" ")):nc.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+Y+"currRowParamsArray.Length = "+Wg.length+", current row = "+Ac);za&&nc.ULS.sendTraceTag(558474578,0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",Cg,Wg.length,wi,oj,H)}$get(Kg+ib.bDd,ef).innerHTML="("+(Jf||"")+")"}za?
this.raiseEvent("FAFunctionNameUpdated",new yc(k.NameDataStrings,Ld)):this.raiseEvent("FAParameterSelectionChangedOld",new Ja(Ld,Pb,Y));id.className=eh.a.tph+(this.functionInfoManager.Fgc(k)?"-udf":"")}catch(fj){throw nc.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",k.NameDataStrings,H,fj),fj;}this.formulaAssistanceTelemetryManager.vZ(["argumentAssistanceComputation"])}};gb.prototype.dispose=function(){this.Hk||(this.Jc.fB(),kg.a.Ha(this.Jc),
Oe.g(this.$).view.Xq(this.tt),kg.a.Ha(this.K1a),this.K1a=null);this.Hk&&kg.a.Ha(this.rr);this.sba&&Oe.g(this.$).wc.Dn(this.ug);this.functionInfoManager=this.$=null;kk.prototype.dispose.call(this)};gb.prototype.xEd=function(k){var H=new pb;H.functionRenderingInfo=k;H.cardMode=this.W2;this.bId(H);return H};gb.prototype.bId=function(k){k.callbacks=new cb;k.callbacks.onHelpLink=this.Cvb(k.functionRenderingInfo);k.callbacks.onCardModeChange=this.onCardModeChange;k.callbacks.onFeedback=this.lRa;this.sba&&
(k.callbacks.onDismissClick=this.onDismissClick)};gb.prototype.kyj=function(k,H){var Y=this;if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.L7(["argumentAssistanceRender"]);var za={};za.zoomLevel=Oa(this.$);this.formulaAssistanceUIControl.updateContext(za);this.Yq=function(){Y.formulaAssistanceUIControl.renderArgumentAssistanceCard(Y.domElement,H,k)};this.Yq();this.BDd(k);this.nR&&this.kH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),
this.Yq,function(){return Y.formulaAssistanceUIControl.dismiss(Y.domElement)});this.rr.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.vZ(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.V7b("argumentAssistanceOverall")}};gb.prototype.Cvb=function(k){var H=this;return function(){Qa(H.$,k.helpID,k.isUDF)}};gb.prototype.ROd=function(){var k=dj.a.get(Ea.a.V_b);this.W2=k?parseInt(k,10):gb.R5c;this.formulaAssistanceTelemetryManager.JXf(this.W2)};gb.prototype.BDd=function(k){var H=
k.functionRenderingInfo.functionName;this.Yka&&S.a.equals(this.Yka,H,!0)?(H=Uh.a.map(k.functionRenderingInfo.signatures,function(Y){var za="";0<=Y.signatureParams.activeParam&&Y.signatureParams.activeParam<Y.signatureParams.params.length&&(za=Y.signatureParams.params[Y.signatureParams.activeParam]);return za}),this.raiseEvent("FAParameterSelectionChanged",new Qb(H))):(this.Yka=H,k=Uh.a.map(k.functionRenderingInfo.signatures,function(Y){return Y.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",
new yc(H,k)))};gb.prototype.bOb=function(k){this.W2=k;try{dj.a.Kv(Ea.a.V_b,k.toString(),Kk.AFrame.rea)}catch(H){nc.ULS.sendTraceTag(537162070,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",H.message)}};gb.iod=function(k){return S.a.contains(k,ib.K7b,!0)};gb.Wji=function(k){return!!k&&S.a.X1a(k.NameDataStrings,"IFS")};gb.KJg=function(k,H,Y,za){try{if(!k||2>k.length)nc.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",
za.NameDataStrings,k?k.length.toString():"currRowParamsArray == null",H,Y);else{for(var Va=k.pop().toString(),Pb=k.length-1;Pb<Y;Pb++){var Ac=k[Pb].trim();if(H){var id=k[Pb-1].trim();k.push(gb.vGh(id,Ac))}else{var Ld=gb.y9e(Ac);k.push(gb.OVe(Ld))}}k.push(Va)}}catch(ld){throw nc.ULS.shipAssertTag(537162068,0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",za.NameDataStrings,k?k.length.toString():"currRowParamsArray == null",
H,Y,ld),ld;}};gb.vGh=function(k,H){k=gb.y9e(k);var Y=gb.F0e(k);H=gb.F0e(H);return gb.OVe(k,!0,!!Y&&!!H&&Y!==H)};gb.y9e=function(k){var H=k.match(gb.Tyd);k=S.a.trimEnd(S.a.trimStart(k,ib.FEf),ib.EEf);if(H&&H.length){H=H[H.length-1];var Y=Number.parseLocale(H)+1;k=k.replace(H,Y.toString())}else k=String.format("{0}{1}",k,1);return k};gb.OVe=function(k,H,Y){var za="[{0}]";(void 0===H?0:H)&&(za=(void 0===Y?0:Y)?"[{0}":"{0}]");return String.format(za,k)};gb.F0e=function(k){return(k=k.match(gb.Tyd))&&k.length?
k[0]:null};gb.QJa=function(k){if(k)return document.createElement("div");k=String.format(ib.mFf,ib.kFf,ib.aDd,eh.a.vNe,ib.KFb,eh.a.uNe,ib.bDd);var H=String.format(ib.mFf,ib.lFf,ib.aDd,eh.a.vNe,ib.KFb,eh.a.uNe,ib.bDd);k=String.format(ib.NEh,ib.OEh,eh.a.pOe,eh.a.Zlh,A.a.fq,ib.mVe,k,H);H=document.createElement("div");H.innerHTML=k;return H.firstChild};gb.Tyd=RegExp("\\d+");gb.R5c=0;Object(Dd.a)(gb,"FormulaArgumentAssistanceControlDeprecated",fi.a,[859]);Object(Dd.a)(Ia,"ParseContext",null,[]);var ek=
b(335),nl=Bk.a;Am(ha,nl);ha.prototype.Wh=function(k,H){this.formulaAssistanceControl.Ya=this.Ya;-1470715894!==H&&-1231471547!==H||!this.IHe()||(this.bW=!1);return nl.prototype.Wh.call(this,k,H)};ha.prototype.tzd=function(){var k=this.D5a;if(k||this.sRd)if(this.formulaAssistanceControl.Ya=this.Ya,this.formulaAssistanceTelemetryManager.Job.formulaAssistanceRequestAttemptedCounter++,this.IHe())if(!k&&this.sRd)this.formulaAssistanceControl.Yre();else if(Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",
!1)&&this.h8h){if(k=this.$.Ob.Gc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.$re(),k.stop(),this.Dob.text.endsWith("[")&&"["!==this.Dob.text.charAt(this.Dob.text.length-2)){var H=""===this.bIa?this.formulaAssistanceControl.tableManager.Eg:Object(Pa.a)(ek.a,this.$.Hb.getItemByName(this.bIa));nc.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",
H.jj,k.Bc,this.old,this.bW)}}else this.formulaAssistanceControl.sob(),this.hEf&&(this.hEf=this.bW=!1);else this.formulaAssistanceTelemetryManager.Job.formulaAssistanceRequestOptimizedCounter++;else this.bW=!1};ha.prototype.gj=function(){this.P9i||(this.bSa=null,this.sRd&&this.formulaAssistanceControl.MZ())};ha.prototype.ug=function(){this.bW=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Otc();this.Hk&&this.gui()};ha.prototype.RFd=function(k,H){return this.formulaAssistanceControl.Wh(k,
H)};ha.prototype.gui=function(){this.formulaAssistanceControl.SAa&&(this.formulaAssistanceTelemetryManager.u4.smartSuggestionShownCounter++,this.formulaAssistanceControl.SAa=!1);this.formulaAssistanceControl.wSa&&(this.formulaAssistanceTelemetryManager.u4.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.wSa=!1);this.formulaAssistanceControl.fMb&&(this.formulaAssistanceTelemetryManager.u4.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.fMb=!1);this.G2&&(this.formulaAssistanceControl.YLa&&
(this.formulaAssistanceTelemetryManager.u4.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.YLa=!1),this.formulaAssistanceControl.XLa&&(this.formulaAssistanceTelemetryManager.u4.isCellContentFormulaCounter++,this.formulaAssistanceControl.XLa=!1))};ha.prototype.PUg=function(k,H){for(var Y=0,za;-1!==Y;)if(Y=k.indexOf("[",Y+1),-1!==Y&&Y<H&&(za=k.indexOf("]",Y+1),-1===za||za>=H))return Y;return-1};ha.prototype.IHe=function(){var k=this.Ya.text,H=this.Ya.textBox.caretPosition,Y=
this.formulaAssistanceControl.sNa,za=this.formulaAssistanceControl.rNa;if(this.bW&&S.a.equals(k,Y,!0)&&H===za)return!1;this.formulaAssistanceControl.sNa=k;this.formulaAssistanceControl.rNa=H;return!0};Ek.Object.defineProperties(ha.prototype,{Pyb:{configurable:!0,enumerable:!0,get:function(){return Object(hf.a)(ba,this.$.zb.lh)}},bW:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(k){this.formulaAssistanceControl.isListVisible=k}},D5a:{configurable:!0,
enumerable:!0,get:function(){return this.Ya.D5a}},h8h:{configurable:!0,enumerable:!0,get:function(){var k=this.Dob.text,H=!1;if(0>=k.length)return H;var Y=this.$.Ob.Gc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),za=Oe.g(this.$).ha.sa.activeCell.clone(),Va=k.charCodeAt(0);this.bIa="";this.vQ=this.PUg(k,this.Dob.caretPosition);Va=61===Va&&-1!==this.vQ;if(!Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Va&&(H=!0);else if(Va){if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Va=
0;for(var Pb=this.vQ-1;1<=Pb&&!(this.vQ-Pb>ha.cpf);Pb--)if(Array.contains(ha.Wte,k.charAt(Pb))){Va=Pb;break}Va=k.substring(Va+1,this.vQ);k=""!==Va?this.$.Hb.getItemByName(Va):null;Pb=this.vQ;for(var Ac=this.vQ+1;Ac<=this.Ya.textBox.caretPosition;Ac++)if("["===this.Ya.text.charAt(Ac))Pb=Ac;else break;this.vQ=Pb}else{Va=k.lastIndexOf("[");Pb=0;for(Ac=Va-1;1<=Ac&&!(Va-Ac>ha.cpf);Ac--)if(Array.contains(ha.Wte,k.charAt(Ac))){Pb=Ac;break}Va=k.substring(Pb+1,Va);k=""!==Va?this.$.Hb.getItemByName(Va):null}k&&
2===k.type?(H=!0,this.bIa=Va):Oe.g(this.$).Rb.Qj(za)&&(H=!0,this.bIa="")}Y.stop();this.old=Y.Bc;nc.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",this.old);return H}},key:{configurable:!0,enumerable:!0,get:function(){return al.a.h3a}},calcManager:{configurable:!0,enumerable:!0,get:function(){this.fGc||(this.fGc=this.$.da.Aa(266,!1));return this.fGc}},sRd:{configurable:!0,
enumerable:!0,get:function(){if(null!=this.bSa)return this.bSa;if(!Ke.EwaSettings.ma(136))return this.bSa=!1;var k=Oe.g(this.$).ha.sa.activeCell.clone();if(1!==k.Lof||!k.left||Oe.g(this.$).ha.sa.ehc())return!1;var H=this.formulaAssistanceControl.tableManager.rn(k);if(H)return this.bSa=!1;--k.left;--k.right;if(!k.isValidRange)return!1;H=this.formulaAssistanceControl.tableManager.rn(k);return this.bSa=!!H&&k.top===H.top&&this.formulaAssistanceControl.tableManager.w3g(H,Oe.g(this.$))}}});ha.Wte=" !%&'()*+,-/:;<=>@[]^{|}~".split("");
ha.cpf=255;Object(Dd.a)(ha,"FormulaAutoCompleteListAutoCompleteBehavior",Bk.a,[]);var Jk;(function(k){k[k.function=0]="function";k[k.field=1]="field";k[k.definedName=2]="definedName";k[k.letVariable=3]="letVariable";k[k.tableColHeaderName=4]="tableColHeaderName";k[k.tableSpecialStructRef=5]="tableSpecialStructRef";k[k.pendingData=6]="pendingData";k[k.tableNamedObject=7]="tableNamedObject"})(Jk||(Jk={}));Object(Dd.b)("ItemType",Jk);var xj=b(1261),Vj=b(1260);La.prototype.execute=function(k){k.push(this.index)};
Object(Dd.a)(La,"AppendIndexOperation",null,[883]);mb.prototype.execute=function(){};Object(Dd.a)(mb,"NopIndexOperation",null,[883]);Ra.prototype.execute=function(k){for(var H=0;H<k.length;H++)k[H]===this.H_i&&(k[H]=this.hrf)};Object(Dd.a)(Ra,"ReplaceIndexOperation",null,[883]);Ha.prototype.cEe=function(k,H){var Y=new La(H);if(!this.rMa)return Y;k=this.Coi(k,H);return null!=k?this.items[k].lAb?new Ra(k,H):new mb:Y};Ha.prototype.Coi=function(k,H){var Y=this,za=this.items[H];nc.ULS.shipAssertTag(537162075,
0,!!za,"Internal error: invalid item index");k=ja.where(ja.asEnumerable(k),function(Va){return Y.items[Va].name===za.name});return ja.Ct(k)?ja.first(k):null};Object(Dd.a)(Ha,"FilterItemOperationFactory",null,[]);Object(Dd.a)(Xa,"CompletionItem",null,[]);var Qj="<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='"+A.a.fq+"'>{3}</td>\r\n\t<td id='item_type_cell' class='"+A.a.fq+"'>{5}</td>\r\n</tr>",qi="<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+
A.a.fq+"'></td>\r\n\t<td id='item_type_cell' class='"+A.a.fq+"'>{2}</td>\r\n</tr>",Ej="<td>\r\n\t<div class='"+A.a.rw+"'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",lk="<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+A.a.fq+"'>{5}</td>\r\n\t<td id='item_type_cell' class='"+A.a.fq+"'>{2}</td>\r\n</tr>",nk=xj.a;Am(qa,nk);qa.prototype.FVc=function(k){this.addHandler("FLBSelectedRowChanged",k)};qa.prototype.CJd=
function(k){this.removeHandler("FLBSelectedRowChanged",k)};qa.prototype.BZb=function(k){this.addHandler("ACLBUpdated",k)};qa.prototype.Usc=function(k){this.removeHandler("ACLBUpdated",k)};qa.prototype.dispose=function(){nk.prototype.dispose.call(this);this.jra=this.nVe=this.Aub=null};qa.prototype.vzc=function(k,H,Y,za){za=void 0===za?0:za;this.Gef||this.R7(!1);var Va="";Y&&(Va+=String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>","list_column_header",eh.a.LZg,
Y));Va+=String.format("<table class='{0}' aria-live='off'><tbody>",this.Xba);for(var Pb=new rb.a,Ac=0,id=this.LW.length;Ac<id;Ac++)Va+=this.M2e(k[this.LW[Ac]],Ac+1,H,za),this.Hk&&Pb.add(this.KXe(k[this.LW[Ac]]));Ac=this.LW.length;id=0;for(var Ld=this.Fq.length;id<Ld;id++)Array.contains(this.LW,this.Fq[id])||(Ac++,Va+=this.M2e(k[this.Fq[id]],Ac,H,za),this.Hk&&Pb.add(this.KXe(k[this.Fq[id]])));this.dg.innerHTML=Va+"</tbody></table>";this.Sn=Kc.DOMElementExtensions.Pj(this.domElement,this.Xba);this.Hk&&
(this.v3b=Pb.toArray());this.Gef?(this.isListVisible=!0,this.tGa.set_visible(!0)):(this.R7(!0),this.KHg(!!Y))};qa.prototype.sJa=function(k,H,Y,za,Va,Pb){za=void 0===za?"":za;Va=void 0===Va?0:Va;Pb=void 0===Pb?!1:Pb;if(k){var Ac=[],id=[];this.eMb=0;var Ld=new Ha(this.$,k);if(H){var ld=!!H&&0<Va,ef=ld&&91===H.charCodeAt(Va+1)?Va+2:Va+1;Pb=ld?H.length===ef:!1;ld&&H.length===Va&&Ke.EwaSettings.ma(136)&&(Pb=!0);var Jf=null;!Pb&&ld&&H.length>Va+1&&(Jf=H.substring(ef,H.length));if(H)for(ld=0,ef=k.length;ld<
ef;ld++){var Kg=k[ld].name;if(!k[ld].Ffi){var Cg=Ld.cEe(Ac,ld);k[ld].lAb&&this.eMb++;if(!Jf&&!Pb||0===k[ld].itemType)id=this.HSe(H,Kg,Y,Cg,Ac,id),Ac=id.G9e,id=id.tHf;Jf&&1===k[ld].itemType&&(id=this.HSe(Jf,Kg,!0,Cg,Ac,id),Ac=id.G9e,id=id.tHf);Pb&&1===k[ld].itemType&&Cg.execute(Ac)}}}else for(Y=0;Y<k.length;++Y)if(k[Y].lAb||Pb)Jf=Ld.cEe(Ac,Y),Jf.execute(Ac),Jf.execute(id),k[Y].lAb&&this.eMb++;this.LW=id;this.Fq=Ac;this.vzc(k,H,za,Va)}};qa.prototype.sRj=function(k){if(k&&!(1<k.length)){var H=[],Y=[];
H.push(0);Y.push(0);this.LW=H;this.Fq=Y;this.vzc(k,"","",0)}};qa.prototype.Xxa=function(){this.Vk&&nk.prototype.Xxa.call(this)};qa.prototype.c3i=function(k,H){this.raiseEvent("ACLBUpdated",new Vj.a(k,void 0,void 0,H))};qa.prototype.odg=function(k){var H=this.Sn.rows[k];return(!this.Vk||this.Vk!==H)&&k<this.Sn.rows.length?(this.Vk=H,!0):!1};qa.prototype.onItemClick=function(k){ci.g(k.Ca);0===this.hx||2===this.hx||3===this.hx||4===this.hx||5===this.hx||7===this.hx?(this.raiseEvent(Pk.a.B4a),this.Xxa()):
1===this.hx?this.tGa.fz(!1):(this.tGa.fz(!1),k=Oe.g(this.$),k.Jp(!1),k.focus());return!0};qa.prototype.KHg=function(k){this.Tra();if(k){var H=this.Sn.offsetWidth+(this.Fq.length>this.hI?jj.a.xu:0);k=$get("list_column_header");k.offsetWidth>H&&Kc.DOMElementExtensions.Kr(this.dg,k.offsetWidth);H=this.dg.getElementsByClassName(this.A_);for(var Y=0;Y<H.length;Y++)H[Y].style.width=$c.HelperMethods.nc(k.offsetWidth)}};qa.prototype.M2e=function(k,H,Y,za){if(1===k.itemType){var Va=Lg.a.Sf(k.name),Pb=Lg.a.Sf(za?
Y.substring(za+1,Y.length):Y),Ac=0;Va.substring(0,Pb.length).toLowerCase()!==Pb.toLowerCase()&&(Ac=qa.cEj(Va,ib.kgg,Pb));Y="";Y=0<=Ac?Y+(Va.substring(0,Ac)+"<b>"+Va.substring(Ac,Ac+Pb.length)+"</b>"+Va.substring(Ac+Pb.length,Va.length)):Y+Va;za=za?String.format(Ej,A.a.UOe,Lg.a.WZ(Sg.a.We(0)),Ae.a.instance.fa(712)):"";return String.format(qi,za,H,Jk[k.itemType],this.A_,Y)}if(5===k.itemType)return String.format(lk,"",H,Jk[k.itemType],this.A_,Lg.a.Sf(k.name),Lg.a.Sf(k.eja));if(4===k.itemType)return String.format(lk,
"(...)",H,Jk[k.itemType],this.A_,Lg.a.Sf(k.name));if(6===k.itemType)return za=za?String.format(Ej,A.a.UOe,Lg.a.WZ(Sg.a.We(0)),Ae.a.instance.fa(712)):"",String.format(Qj,za,this.A_,Lg.a.Sf(k.name),Lg.a.Sf(k.eja),H,Jk[k.itemType]);za=String.format(Ej,2===k.itemType||3===k.itemType?A.a.Vsh:A.a.Tsh,Lg.a.WZ(Sg.a.We(0)),Ae.a.instance.fa(709));return String.format(Qj,za,this.A_,Lg.a.Sf(k.name),Lg.a.Sf(k.eja),H,Jk[k.itemType])};qa.prototype.KXe=function(k){var H=new Xa;H.label=k.label;H.textEdit=k.textEdit;
H.kind=qa.iLh(k.itemType);H.type=k.lAb?1:0;if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===H.kind){var Y=this.formulaAssistanceControl.vPh(k.label);H.detail=Y?Y:k.eja}else H.detail=k.eja;return H};qa.prototype.HSe=function(k,H,Y,za,Va,Pb){S.a.equals(H,"Pretend this is the line.",!1)&&0<Va.length||S.a.uL(H,k)?(za.execute(Va),za.execute(Pb)):Y&&k.length>=ib.z3g&&qa.cdh(H,ib.kgg,k)?za.execute(Va):!Y&&k.length>=ib.y3g&&S.a.contains(H,k,!0)&&za.execute(Va);return{G9e:Va,
tHf:Pb}};qa.iLh=function(k){switch(k){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}};qa.cdh=function(k,H,Y){H=El(H);for(var za=H.next();!za.done;za=H.next())if(za=k.split(za.value),!(2>za.length)){za=El(za);for(var Va=za.next();!Va.done;Va=za.next())if(S.a.uL(Va.value,Y))return!0}return!1};qa.cEj=function(k,H,Y){H=El(H);for(var za=H.next();!za.done;za=H.next())if(za=k.toLowerCase().indexOf((za.value+
Y).toLowerCase()),0<za)return za+1;return-1};Ek.Object.defineProperties(qa.prototype,{jic:{configurable:!0,enumerable:!0,get:function(){return 0<this.eMb&&this.eMb===this.Fq.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(ri.a)(qa.prototype,this,"isListVisible")},set:function(k){Object(ri.b)(qa.prototype,this,"isListVisible",k);k||(this.lvc=0,this.xe=null);0===this.lvc?Kc.DOMElementExtensions.setVisible(this.Aub,k&&!this.Hk):Kc.DOMElementExtensions.setVisible(this.Aub,
!1)}},Vk:{configurable:!0,enumerable:!0,get:function(){return this.jra},set:function(k){this.sBa(this.Vk);if(k){this.nVe.innerText="";this.jra=k;var H=this.sBa(this.Vk),Y=k.rowIndex+1,za=$get("description_cell"+Y,k);this.Aub.innerText=za.innerText;var Va=$get("item_type_cell",k);this.xe=H=H.innerText;this.lvc="field"===Va.innerText?1:"definedName"===Va.innerText?2:"letVariable"===Va.innerText?3:"tableColHeaderName"===Va.innerText?4:"tableSpecialStructRef"===Va.innerText?5:"pendingData"===Va.innerText?
6:"tableNamedObject"===Va.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new Vj.a(this.Fq.length,Y,H,za.innerText));this.Yuc(k)}}},kTa:{configurable:!0,enumerable:!0,get:function(){return this.Aub}},tGa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},hx:{configurable:!0,enumerable:!0,get:function(){return this.lvc}}});Object(Dd.a)(qa,"FormulaAutoCompleteListBox",xj.a,[858]);Ek.Object.defineProperties(Aa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
toolTip:{configurable:!0,enumerable:!0,get:function(){return this.B9}}});Object(Dd.a)(Aa,"LETVariableInfo",null,[]);Ek.Object.defineProperties(Nb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Dd.a)(Nb,"TableColHeaderNameInfo",null,[]);Ek.Object.defineProperties(lb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Dd.a)(lb,"TableNamedObjectInfo",null,[]);Ek.Object.defineProperties(kb.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.B9}}});Object(Dd.a)(kb,"TableSpecialStructRefInfo",null,[]);var Qk=b(188),Uk=b(187);Object(Dd.a)(Gb,"FormulaAutoCompleteCallbacks",null,[]);Object(Dd.a)(Sa,"FormulaAutoCompleteRenderingInfo",null,[]);Object(Dd.a)(Ca,"FunctionSuggestionRequest",null,[]);Object(Dd.a)(fa,"RunExperimentRequest",null,[]);var K=sj.a;Am(ta,K);ta.prototype.gne=function(k){this.addHandler(ta.Ubd,k)};ta.prototype.IPf=
function(k){this.removeHandler(ta.Ubd,k)};ta.prototype.ene=function(k){this.addHandler(ta.pbd,k)};ta.prototype.GPf=function(k){this.removeHandler(ta.pbd,k)};ta.prototype.fne=function(k){this.addHandler("FormulaAutoCompleteShown",k)};ta.prototype.HPf=function(k){this.removeHandler("FormulaAutoCompleteShown",k)};ta.prototype.get_visible=function(){return this.Xcf?void 0!==this.Ifb?this.Ifb:this.Ifb=K.prototype.get_visible.call(this):K.prototype.get_visible.call(this)};ta.prototype.set_visible=function(k){if(this.Xcf&&
this.Ifb===k)return this.Hk&&!k&&this.x1a(),k;this.Zia.set_visible(k);this.Hk&&!k&&this.x1a();Sys.UI.Control.prototype.set_visible.call(this,k);return this.Ifb=k};ta.prototype.XTg=function(k,H){this.isListVisible&&(k+=ib.openParen,H++,this.fDd(k,H));var Y=0<H&&k.charAt(H-1)===ib.openParen,za=H===k.length||k.charAt(H)===ib.closeParen;if(!Y||!za)return nc.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",
H,!k.length,!!this.uQ),!1;Y=k.substring(0,H).lastIndexOf(this.$.listSeparator);za=k.substring(0,H-1).lastIndexOf(ib.openParen);k=k.substring(-1===Y&&-1===za?1:Math.max(Y,za)+1,H-1).trim();return this.functionInfoManager.Ged(k)?!0:(nc.ULS.sendTraceTag(537162052,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.uQ),!1)};ta.prototype.Bbi=function(k,H){var Y=this.XTg(k,H);if(!Y||!this.uQ)return nc.ULS.shipAssertTag(537162051,
0,!Y||Y&&!!this.uQ,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,drf:0,FTe:0};Y=this.uQ.Params;Y=Y.replace(RegExp("[\\[\\]]","g"),"");var za=k.charAt(H-1)===ib.openParen,Va=za?"":"(",Pb=H===k.length?")":"";var Ac=this.$.listSeparator;Ac=Y.includes(Ac)?Y.indexOf(Ac):Y.length;return{returnValue:k.substring(0,H)+Va+Y+Pb+k.substring(H,k.length),drf:za?H:H+1,FTe:Ac}};ta.prototype.tt=function(k,H){this.Hk&&void 0!==this.Yq&&null!==this.Yq&&
this.Yq();this.Hk||K.prototype.tt.call(this,k,H)};ta.prototype.dispose=function(){if(this.$){this.OSa(!1);var k=this.gridView;k&&(k.ha&&(this.Hk?k.ha.WF(this.kd):k.ha.aX(this.kd),ee.a.XV()&&4!==this.NCb&&k.ha.Jza(this.ctf)),k.view.Xq(this.qnc));this.Hk&&this.$.xa&&this.$.xa.Xg(this.gi)}this.functionInfoManager&&(this.functionInfoManager.lbb(this.onFunctionInfoLoaded),this.functionInfoManager.Faj(this.bxf));this.rh&&this.rh.Lsc(this.rya);this.Hk&&this.Df&&this.Df.CJd(this.XBf);ee.a.Hfc&&this.Ya&&this.Ya.YHb(this.p6);
this.R6f(!1);kg.a.Ha(this.Df);kg.a.Ha(this.f0b);kg.a.Ha(this.Zia);kg.a.Ha(this.rr);this.Ya=this.functionInfoManager=this.rh=null;kg.a.zc(this.GJa);this.Eg=this.x8=this.Zia=this.GJa=null;K.prototype.dispose.call(this)};ta.prototype.Mwa=function(){return!this.Rt};ta.prototype.Kii=function(){return!this.uGa};ta.prototype.Wh=function(k,H){if(!this.Mwa()){if(this.Hk&&this.rK){if(125627505===H||267796030===H)return this.Hk&&this.wBc(H),this.xAe(),!1;if(1872288872===H)return this.Nma(),this.isListVisible=
!1,!0;if(this.Df.jic&&(-798660877===H||137938150===H))return!1}if(1!==this.Df.hx||125627505!==H&&267796030!==H)if(6===this.Df.hx){var Y=k.keyCode;13!==Y&&9!==Y||this.fz(!1)}else{if(4===this.Df.hx||5===this.Df.hx)return K.prototype.Wh.call(this,k,H,!0);1===this.Df.LW.length&&(Y=k.keyCode,this.owe=8===Y||127===Y||46===Y?!0:!1)}else{if(this.fz(!1)&&!this.cka)return this.gridView.ha.Wh(k,H);if(125627505===H&&this.cka)return!0}}return K.prototype.Wh.call(this,k,H)};ta.prototype.Otc=function(){this.rh.Lbb();
this.x8=null;null==this.Mia||this.Mia||this.ekc("NoFieldChosen",1,2,1);this.Mia=null;this.U3=0;this.I5=this.Qrd=this.Dpc=null};ta.prototype.sob=function(){var k=this,H=!!this.Ya&&!Yf.f(this.$.qa),Y=null;this.G2&&H&&(Y=this.Ya.text,Y.startsWith("=")&&(this.XLa=!0,1===Y.length&&(this.YLa=!0)));(this.RAa||this.wyc)&&H&&(this.G2||(Y=this.Ya.text),this.pluginScheduler.requester().functionSuggestion(Object(ag.a)(new Ca,{content:Y})).then(function(za){0===za.kind&&(nc.ULS.shipAssertTag(537162050,0,!!za&&
!!za.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),za=ja.toArray(ja.select(ja.asEnumerable(za.payload.items),function(Va){return ta.s2g(Va)})),k.wyc&&"="===Y&&0<za.length&&k.fr.O1a.nqj("="+za[0].textEdit.newText),k.RAa&&(k.vSa=za,Vg.AFrameworkApplication.Pg||k.Zre(H,!0)));return null}));this.RAa&&H||this.Zre(H,!1)};ta.prototype.K2e=function(){if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var k=
this.gridView.Dj?this.tub.vQ:this.Ppb.vQ;"@"===this.Ya.text.charAt(k+1)&&this.Ya.textBox.caretPosition>k+1?this.beb=k+2:this.beb=k+1}else{k=this.Ya.text.lastIndexOf(ib.Pjf);var H=this.Ya.text.lastIndexOf("[");this.beb=k+1>=H?k+2:H+1}return this.Ya.text.substring(this.beb,this.Ya.textBox.caretPosition)};ta.prototype.$re=function(){this.U3f()&&(this.f$g(),this.Rt&&(this.Mia=!1,this.hW=this.K2e(),this.Df.sJa(this.Rt,this.hW,!0,void 0,void 0,!0),this.show(),Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&
this.Zia.nsb()))};ta.prototype.Yre=function(){this.U3f()&&(this.f0b&&this.f0b.cancel(),this.rh.azb?(this.Mwa()&&this.SCe(!0),this.get_visible()?this.DSe():this.X1d=Qk.AsyncMethodContext.$u(this.DSe,ib.ych,pj.a.MDh,this.f0b)):this.MZ())};ta.prototype.U3f=function(){return this.Ya?0<this.$.zb.ZR||!this.Ya.text||!this.Ya.isEditing?(this.set_visible(!1),!1):Yf.f(this.$.qa)?!1:!0:!1};ta.prototype.Dqb=function(k){this.Ya&&this.isListVisible&&(this.qmd(this.Ya.text,k),this.Ya.textBox.caretPosition=k.range.start.character+
k.newText.length,this.set_visible(!1))};ta.prototype.fz=function(){var k;if(!this.Ya||!this.isListVisible)return!1;var H="",Y=0,za=this.gridView,Va=this.Ya.text,Pb=0,Ac=this.Df.xe,id=!1;if(0===this.Df.hx||2===this.Df.hx||3===this.Df.hx||7===this.Df.hx)H+=Va.substr(0,this.i3a)+this.Df.xe,0!==this.Df.hx||this.Df.xe.endsWith(")")||(H+="("),Y=H.toString().length,H+=Va.substr(this.O$b),2===this.Df.hx&&(Pb=4,Ac="DefinedName",id=!0,this.set_visible(!1));else if(1===this.Df.hx)if(this.Mia=!0,this.cka){H+=
Va.substr(0,this.U3+2);!H.toString().endsWith(d.a.bV)&&Ke.EwaSettings.ma(136)&&(H+=d.a.bV);Pb=this.Df.xe;Pb=Pb.replace("'","''");Pb=Pb.replace("[","'[");Pb=Pb.replace("]","']");if(this.b6c||this.jzh(Pb))Pb=d.a.fri+Pb+d.a.Ihj,id=!0;H+=Pb;Y=H.length;Pb=3;Uk.a("PulloutFieldAccepted")}else return this.Ya.text=this.Df.xe,this.set_visible(!1),za.Jp(!1),za.focus(),this.ekc("FieldName",1,1,1),Uk.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===this.Df.hx)nc.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),
H+=Va.substr(0,this.beb),S.a.equals(this.Df.xe,"@ - "+this.instantaneousSupportInformationManager.Oe.ThisRowStructRefString,!1)?H+="@":(H+=this.Df.xe,id=!0,this.set_visible(!1)),Y=H.length;else if(4===this.Df.hx){nc.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");H+=Va.substr(0,this.beb);id="";Y=!1;for(var Ld=[39,91,93,64,35],ld=0;ld<this.Df.xe.length;ld++){var ef=this.Df.xe.charCodeAt(ld);Array.contains(Ld,ef)&&(id+="'");id+=
this.Df.xe.charAt(ld).toString();Y||S.a.isNumeral(ef)||S.a.Ydf(ef)||(Y=!0)}Ld=this.gridView.Dj?this.tub.vQ:this.Ppb.vQ;Va=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===Va.charAt(Ld+1)&&Y:Va.lastIndexOf(ib.Pjf)+1>=Va.lastIndexOf("[")&&Y;H+=Va?"["+id+"]":id;id=!0;this.set_visible(!1);Y=H.toString().length}else if(6===this.Df.hx)H+=Va.substr(0,this.zsb);else return nc.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),
!1;this.Ya.text=H;this.Ya.textBox.caretPosition=Y;this.Ya.dxa()&&(null===(k=za.Yr)||void 0===k?0:k.Mua)&&za.Yr.XJb(this.Ya.text,this.Ya.textBox.caretPosition,this.Ya.textBox.caretPosition,this.Ya.textBox.Gv.length);za.Dj&&(k=za.rc,k.text=this.Ya.text,k.setCaretPosition(this.Ya.textBox.caretPosition));Ac=(null==this.Mia?0:this.Mia)?"FieldName":Ac;this.Df.Vk.sectionRowIndex>=this.Df.LW.length?this.ekc(Ac,4,Pb,0):this.ekc(Ac,1,Pb,0);id||(5===this.Df.hx||4===this.Df.hx?this.$re():this.sob());return!0};
ta.prototype.MZ=function(k,H){k=void 0===k?null:k;H=void 0===H?null:H;k?(this.rh.Lbb(),this.rh.MZ(k,!1,!1,H)):(k=this.gridView,k.ha.sa.Ig&&(k=ve.v(k.ha.sa.qd,this.$),this.rh.MZ(k,!0,!0,H)))};ta.prototype.Nma=function(){this.Ffa=!1;this.Ya.jIe()};ta.prototype.vPh=function(k){k=this.calcManager.getWorksheetFuncId(k);return this.rVe?this.rVe.descriptionsMap.get(k):null};ta.prototype.SCe=function(k){if(this.Kii()){if(this.rh.azb&&this.rh.Nk&&(!this.rh.Nk.length||!this.rh.Nk[0].FieldInfoDataList))return;
this.uPj(k)}k=ja.asEnumerable(this.uGa);k=ja.concat(k,this.tRh(this.Ya.text));Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Hk&&(k=ja.concat(k,this.BSh()));ja.OBc(k,function(H){return H.name},new Rf);this.RAa&&(k=ja.concat(ja.asEnumerable(this.vSa),k),Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.vSa.length&&(this.SAa=!0),this.vSa=[]));this.x8=ja.toArray(k)};ta.prototype.f$g=function(){var k=this.Ya.text;
if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var H=this.gridView.Dj?this.tub.bIa:this.Ppb.bIa,Y=!0;if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==H&&(this.Eg=Object(Pa.a)(ek.a,this.$.Hb.getItemByName(H))),this.Eg||(this.Eg=this.tableManager.Eg,Y=!1),!this.Eg){nc.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d",
this.$.Hb.count,""===H);return}}else this.Eg=Object(Pa.a)(ek.a,this.$.Hb.getItemByName(H)),this.Eg||(this.Eg=this.tableManager.Eg,Y=!1);this.Eg.QO&&this.Eg.QO.IsFullTableHeaders?this.RGf(Y):cj.d(this.Eg)?(nc.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",this.Eg.jj),Jg.I(this.$.na.ua,this.Eg.jj,this.KLi,this.JLi,null,null)):nc.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",
this.Eg.jj)}else if(this.calcManager&&this.tableManager.Eg)if(H=this.calcManager.v4a(this.tableManager.Eg))if(this.calcManager.xIg(this.tableManager.Eg,H)){k=ja.empty();if(91===this.Ya.text.charCodeAt(this.Ya.text.length-1)){var za=this.K0a("@ - "+this.instantaneousSupportInformationManager.Oe.ThisRowStructRefString);k=ja.concat(k,(Y=new rb.a,Y.add(za),Y))}k=ja.concat(k,ja.select(ja.asEnumerable(H.toArray()),function(Va){var Pb=new Kb,Ac=new Nb;Ac._name=Va.toString();Pb.H_f(Ac);return Pb}));this.x8=
ja.toArray(k)}else k.endsWith("[")&&"["!==k.charAt(k.length-2)&&nc.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",H.count,this.tableManager.Eg.jj,this.tableManager.Eg.usedRange.right-this.tableManager.Eg.usedRange.left+1);else k.endsWith("[")&&"["!==k.charAt(k.length-2)&&nc.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};
ta.prototype.jzh=function(k){if(!k)return!1;var H=k.charCodeAt(0);if(46===H||48<=H&&57>=H||63===H)return!0;for(var Y=0;Y<k.length;Y++,H=k.charCodeAt(Y))if(!((Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?S.a.isLetter(H):S.a.fpd(H))||92===H||95===H||63===H||48<=H&&57>=H))return!0;return!1};ta.prototype.fDd=function(k,H){var Y=!1,za=!1,Va=!1,Pb=0,Ac=0;this.i3a=0;this.O$b=H;this.t5b=1;for(var id=H-1;0<=id;--id)switch(k.charCodeAt(id)){case 39:za=
!za;break;case 34:Y=!Y;break;case 91:++Pb;Va=Pb>Ac;break;case 93:++Ac}Va=Object(ag.a)(new Ia,{Rsa:!Y,Ssa:!za,Oha:!Va,LFb:1});Pb=this.gWi(k,H,Va);H=this.hWi(k,H,Va.Rsa,Va.Ssa,Va.Oha);this.t5b=Pb+H;if(this.IQc=Pb-1)this.sxc=!1;this.Yzh(k,Y,za,Va.HCd,Va.ICd)};ta.prototype.cmd=function(){4!==this.NCb&&this.gridView.ha.Mra(this.ctf);var k=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveCellChangedArgs",!1)?this.fr.kc(null):void 0;this.tDb(k);ee.a.Hfc&&this.gridView.lk.GYa(this.p6);ta.nMd(this.pluginScheduler);
this.RAa&&this.wWg()};ta.prototype.nyh=function(){return this.RAa||this.XRe};ta.prototype.iWi=function(){var k=this.I5;if(!this.xwj||!k)return this.U3=0,this.uGa=this.x8=null,!1;k=k.endsWith(d.a.bV);var H;if(H=Ke.EwaSettings.ma(136)){H=this.TMj(this.I5.substring(0,this.V3));var Y=H.sheetRange;H=H.returnValue}return H&&(H=this.I5.substring(0,this.U3),k&&H!==this.Qrd)?(this.Qrd=H,this.U3=this.I5.length-(k?1:0),this.MZ(Y,this.I5),this.Mia=!1,nc.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),
!0):!1};ta.prototype.tRh=function(k){var H=new rb.a;this.calcManager&&Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&nc.ULS.shipAssertTag(537162014,0,!!this.calcManager.eta(mj.Range.hd(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.XRe&&(k=this.calcManager.extractLetVariables(k,this.Ya.textBox.caretPosition))){k=El(k);for(var Y=k.next();!Y.done;Y=k.next()){var za=Y.value;Y=new Aa;Y._name=za;Y.B9=Ae.a.instance.fa(2166);
za=new Kb;za.kqj(Y);H.add(za)}}return H};ta.prototype.BSh=function(){for(var k=new rb.a,H=this.$.Hb.items,Y=0,za=H.length;Y<za;Y++){var Va=H[Y];if(Yf.n(Va)){var Pb=new lb;Pb._name=Va.name;Va=new Kb;Va.Csj(Pb);k.add(Va)}}return k};ta.prototype.K0a=function(k){var H=new Kb,Y=new kb;Y._name=k;H.Dsj(Y);return H};ta.prototype.RGf=function(k){var H=new rb.a,Y=this.Ya.text.charCodeAt(this.Ya.text.length-1),za=this.Ya.textBox.caretPosition-1;if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
91===this.Ya.text.charCodeAt(za):91===Y){var Va=this.K0a("@ - "+this.instantaneousSupportInformationManager.Oe.ThisRowStructRefString);H.add(Va)}Va=El(this.Eg.QO.HeadersList);for(var Pb=Va.next();!Pb.done;Pb=Va.next()){Pb=Pb.value;var Ac=new Kb,id=new Nb;id._name=Pb.Name;Ac.H_f(id);H.add(Ac)}Va=this.gridView.Dj?this.tub.vQ:this.Ppb.vQ;Pb=this.Ya.text.charCodeAt(Va+1);(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!k||za!==Va&&35!==Pb:!k||91!==Y&&
35!==Y)||(k=this.K0a("#"+this.instantaneousSupportInformationManager.Oe.AllStructRefString),H.add(k),k=this.K0a("#"+this.instantaneousSupportInformationManager.Oe.DataStructRefString),H.add(k),k=this.K0a("#"+this.instantaneousSupportInformationManager.Oe.HeadersStructRefString),H.add(k),k=this.K0a("#"+this.instantaneousSupportInformationManager.Oe.TotalsStructRefString),H.add(k));H&&(this.x8=H.toArray())};ta.prototype.uPj=function(k){var H=ja.empty();!k&&this.functionInfoManager.l_&&(H=ja.concat(H,
ja.select(ja.asEnumerable(this.functionInfoManager.N$b),function(Y){var za=new Kb;za.gZf(Y);return za})),k=this.g6b.MGe,0<k.length&&(H=ja.OBc(ja.concat(H,ja.select(ja.asEnumerable(k),function(Y){var za=new Kb;za.Ooj(Y);return za})),function(Y){return Y.name},new Rf)));if(this.rh.azb&&this.rh.Nk){if(!this.rh.Nk.length||!this.rh.Nk[0].FieldInfoDataList)return;H=ja.OBc(ja.concat(H,ja.select(ja.asEnumerable(this.rh.Nk[0].FieldInfoDataList),function(Y){var za=new Kb;za.mpj(Y);return za})),function(Y){return Y.name},
new Rf);this.columnName=this.rh.Nk[0].ColumnName}this.uGa=ja.toArray(H)};ta.prototype.tDb=function(k){var H;if(1!==this.NCb){var Y=this.gridView.ha.sa.activeCell;if(Y){var za=this.calcManager.eta(Y,!this.Jnd);if(za){var Va=this.$.xa,Pb=za.sheet.index;0>=Va.count||0>Pb||Pb>=Va.count||(Pb=Va=null,this.uyd&&void 0!==this.calcManager&&null!==this.calcManager&&(k=null!==(H=null===k||void 0===k?void 0:k.cell)&&void 0!==H?H:this.gridView.Ea.gs(Y))&&(H=this.calcManager.Tbc(k.Ak),void 0!==H&&null!==H&&(Va=
H.FormatString,Pb=H.Builtin)),2!==this.NCb&&this.pluginScheduler.notifier().setActiveCell({colIndex:za.range.col,rowIndex:za.range.row,sheetIndex:this.$.xa.getItem(za.sheet.index).sheetId,docName:za.sheet.document.name,docPath:za.sheet.document.path,formatString:Va,builtIn:Pb}))}}}};ta.prototype.wWg=function(){this.gridView.Dj?this.tub.BU(!1):this.Ppb.BU(!1)};ta.prototype.Bhf=function(k){var H=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?
S.a.isLetter(k):S.a.fpd(k);return 48<=k&&57>=k||46===k||95===k||H};ta.prototype.show=function(){if(this.Rt){var k=this.Df.odg(0);this.Hk?0<this.Df.Fq.length?k||this.H3f():this.x1a():((k=0<this.Df.Fq.length)&&this.formulaAssistanceTelemetryManager.L7(["autoCompleteRender"]),!this.isListVisible&&this.columnName&&k&&this.Df.c3i(this.Df.Fq.length,this.columnName),this.isListVisible=k,this.Zia.show(this.uQ),this.JBa(!0),this.Df.Xxa(),k&&this.formulaAssistanceTelemetryManager.vZ(["autoCompleteRender"]))}};
ta.prototype.hWi=function(k,H,Y,za,Va){for(Y=Object(ag.a)(new Ia,{vEf:41,sze:40,Rsa:Y,Ssa:za,Oha:Va});H<k.length&&!this.qFf(k,H,Y);++H);return Y.LFb};ta.prototype.gWi=function(k,H,Y){for(--H;0<=H&&!this.qFf(k,H,Y);--H);return Y.LFb};ta.prototype.qFf=function(k,H,Y){var za=k.charCodeAt(H);0>=this.V3&&(this.V3=k.substring(0,H).lastIndexOf(d.a.bV));46===za&&(H<this.V3?this.V3=H:H>this.zsb&&(this.U3=this.zsb=H));if(!this.Bhf(za)&&!ta.Zni(za)&&(!this.cka||H<=this.V3||!ta.I7h(za,Y))){Y.vvf&&(Y.vvf=!1,this.i3a=
H+1);if(Y.kBd){Y.ICd=H+1;if(this.functionInfoManager.Ged(k.substring(Y.ICd,Y.HCd)))return!0;Y.kBd=!1}switch(za){case 39:Y.Ssa=!Y.Ssa;break;case 34:Y.Rsa=!Y.Rsa;break;case 91:Y.Oha=!1;break;case 93:Y.Oha=!0}za===this.$.listSeparator.toString().charCodeAt(0)&&Y.Ssa&&Y.Rsa&&!Y.W_a&&(!this.cka||Y.Oha)&&(H<Y.bNd||-1===Y.bNd)&&(Y.LFb+=1,this.t5b++);za===Y.sze&&Y.Rsa&&Y.Ssa&&(!this.cka||Y.Oha)?Y.W_a+=1:za===Y.vEf&&Y.Rsa&&Y.Ssa&&(!this.cka||Y.Oha)?0<Y.W_a?--Y.W_a:(Y.bNd=Y.ETe,Y.ETe=H,0<H&&this.Bhf(k.charCodeAt(H-
1))&&(Y.kBd=!0,Y.HCd=H)):this.cka&&46===za&&H>this.V3&&(H<this.V3?this.V3=H:H>this.zsb&&(this.U3=this.zsb=H))}return!1};ta.prototype.Yzh=function(k,H,Y,za,Va){this.O$b>this.i3a&&0<=this.i3a?H||Y||(this.hW=k.substring(this.i3a,this.O$b)):this.hW=null;za!==Va?(k=k.substring(Va,za),this.uQ&&S.a.equals(this.uQ.NameDataStrings,k,!0)||(this.sxc=!0),this.uQ=this.functionInfoManager.Ged(k)):(this.sxc=!1,this.uQ=null)};ta.prototype.R6f=function(k){var H=$get(ib.kFf+"_"+ib.KFb,this.domElement),Y=$get(ib.lFf+
"_"+ib.KFb,this.domElement);k&&!this.Pdc?(H&&Fi.a.instance.pa(Eg.a.click,H,this.vca),Y&&Fi.a.instance.pa(Eg.a.click,Y,this.vca),this.Pdc=!0):this.Pdc&&(H&&Fi.a.instance.za(Eg.a.click,H,this.vca),Y&&Fi.a.instance.za(Eg.a.click,Y,this.vca),this.Pdc=!1)};ta.prototype.TMj=function(k){var H=this;var Y=null;var za;if(function(){var id=ve.Z(k,H.$.ea.xa);Pb=id.sheetName;za=id.range;return id}().returnValue&&za){if(!Pb){var Va=Object(Pa.a)(hb.a,this.$.qa);if(!Va)return{returnValue:!1,sheetRange:Y};var Pb=
Va.name}Y=ve.v(za,this.$);Y.SheetName=Pb;this.b6c=!1;return{returnValue:!0,sheetRange:Y}}var Ac=null;return function(){var id=H.g6b.CMj(k);Pb=id.sheetName;Ac=id.range;return id}().returnValue?(Y=ve.v(Ac,this.$),Y.SheetName=Pb,this.b6c=!0,{returnValue:!0,sheetRange:Y}):{returnValue:!1,sheetRange:Y}};ta.prototype.lMd=function(k){this.pluginScheduler.requester().runAuthoringExperiment({content:k})};ta.prototype.ild=function(){if(1===this.Df.LW.length&&this.Rt.length){var k=this.Rt[this.Df.LW[0]];if(1===
k.itemType){var H=k.name;k=this.Ya.text;H=H.substring(k.length,H.length);H.length&&(this.Ya.text=k+H,this.Ya.textBox.selectRange(k.length,this.Ya.text.length))}}else nc.ULS.shipAssertTag(537162007,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.Df.LW.length)};ta.prototype.ekc=function(k,H,Y,za){var Va={};Va.a=k;Va.b=H;Va.c=Y;Va.d=za;Wb.b().Qe(38,Va,!0)};ta.prototype.Zre=function(k,H){if(!this.functionInfoManager.l_){if(k)if(this.fDd(this.Ya.text,this.Ya.textBox.caretPosition),
this.RAa||this.hW){var Y={};Y.Filter=this.hW?this.hW.charAt(0).toString():"";Y.FilterType=1;Y.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.a2a(Y)}else Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.get_visible()&&this.set_visible(!1);if(!H)return}0<this.$.zb.ZR||this.Ya&&!this.Ya.isEditing?this.set_visible(!1):k&&(this.fDd(this.Ya.text,this.Ya.textBox.caretPosition),this.Zia.update(this.uQ,this.t5b,this.IQc,this.sxc),this.I5=this.Ya.text.substring(1,
this.Ya.textBox.caretPosition),this.V3=this.I5.indexOf(d.a.bV),this.U3=this.I5.lastIndexOf(d.a.bV),this.iWi()?(k=new Kb,k.arj(),this.uGa=this.x8=k=[k],this.Df.sRj(k),this.show()):((this.nyh()||this.Mwa())&&this.SCe(!1),0<this.U3?this.Df.sJa(this.Rt,this.I5,!1,void 0,this.I5.lastIndexOf(d.a.bV),!1):this.Df.sJa(this.Rt,this.hW,!1,void 0,this.U3,!1),this.show(),this.Hk&&(this.Df.Fq.length||this.gridView.lk.YK?this.Zia.nsb():(this.Zia.EKd(),this.Hk&&this.x1a()))))};ta.prototype.H3f=function(){var k=this;
if(0<this.Df.Fq.length){this.formulaAssistanceTelemetryManager.L7(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var H={};H.zoomLevel=Oa(this.$);this.formulaAssistanceUIControl.updateContext(H);this.Yq=function(){k.formulaAssistanceUIControl.renderAutoCompleteMenu(k.w0b,k.gridView.lk.textBox.domElement,k.Ded())};this.Yq();this.Hk&&this.Df.jic&&this.raiseEvent(ta.Ubd,null);this.cnd||this.Df.jic||this.raiseEvent("FormulaAutoCompleteShown");this.cnd=this.rr.canReceiveFocus=!0;this.Icf&&
this.formulaAssistanceTelemetryManager.w9e(this.Df.v3b)}this.formulaAssistanceTelemetryManager.vZ(["autoCompleteRender"]);!Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.vSa&&null!==this.vSa&&0<this.vSa.length&&(this.SAa=!0)}};ta.prototype.Wtd=function(){this.tIa&&(this.formulaAssistanceTelemetryManager.SY.selectByArrowKeyCounter++,this.tIa=!1);this.uIa&&(this.formulaAssistanceTelemetryManager.SY.selectByMouseHoverCounter++,this.uIa=!1);this.Nta&&
(this.formulaAssistanceTelemetryManager.SY.commitByTabKeyCounter++,this.Nta=!1);this.Lta&&(this.formulaAssistanceTelemetryManager.SY.commitByEnterKeyCounter++,this.Lta=!1);this.Mta&&(this.formulaAssistanceTelemetryManager.SY.commitByMouseClickCounter++,this.Mta=!1);this.Icf&&(this.Lta||this.Mta||this.Nta)&&this.formulaAssistanceTelemetryManager.v9e(this.pNd.kind)};ta.prototype.Ded=function(){var k=new Sa;k.completionItems=this.Df.v3b;k.activeItemIndex=this.Df.Vk?this.Df.Vk.rowIndex:-1;this.$Hd(k);
return k};ta.prototype.$Hd=function(k){k.callbacks=new Gb;k.callbacks.onCompletionItemSelected=this.Uzd;k.callbacks.onCompletionItemCommitted=this.Tzd;k.callbacks.onFeedback=this.lRa;k.callbacks.onDismiss=this.onDismiss;k.callbacks.onRestoreFocus=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0};ta.prototype.OEd=function(k){this.Ffa=!0;var H=k.textEdit.newText;this.Ya.jSa(H.substring(this.Ya.text.length-k.textEdit.range.start.character,H.length))};
ta.prototype.xAe=function(){this.fz(!0);this.Ffa=this.isListVisible=!1;this.wSa=!0};ta.prototype.qmd=function(k,H){this.Ya.text=k.substring(0,H.range.start.character)+H.newText+k.substring(H.range.end.character,k.length);this.gridView.Dj&&(this.gridView.rc.text=this.Ya.text)};ta.nMd=function(k){k.requester().runExperiment(new fa)};ta.s2g=function(k){var H=Kb.P9g(),Y={IsCompatibility:!1};Y.NameDataStrings=k.label;Y.Help=k.detail;H.gZf(Y);H.textEdit=k.textEdit;return H};ta.QJa=function(){var k=String.format(ib.PEh,
ib.lcd,Hg.a.yNe),H=String.format(ib.KEh,ib.jcd,eh.a.q9c,A.a.$o,A.a.fq),Y=String.format(ib.HEh,ib.ecd,eh.a.q9c,A.a.$o,eh.a.pOe,A.a.fq);return String.format("{0}\r\n{1}\r\n{2}",k,H,Y)};ta.Zni=function(k){return 36===k||58===k||33===k||39===k||32===k};ta.I7h=function(k,H){return 32===k||91===k||!H.Oha};Ek.Object.defineProperties(ta.prototype,{St:{configurable:!0,enumerable:!0,get:function(){return this.Df}},Rt:{configurable:!0,enumerable:!0,get:function(){return this.x8}},PJb:{configurable:!0,enumerable:!0,
get:function(){return this.Df.xe}},jVe:{configurable:!0,enumerable:!0,get:function(){return this.Df}},NUe:{configurable:!0,enumerable:!0,get:function(){return this.Zia}},Df:{configurable:!0,enumerable:!0,get:function(){return this.Bog}},O0a:{configurable:!0,enumerable:!0,get:function(){return this.RAa?this.Ya?this.Ya.text:null:this.hW}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.St.isListVisible},set:function(k){this.Hk&&!k&&this.x1a();this.St.isListVisible=k}},tableManager:{configurable:!0,
enumerable:!0,get:function(){return this.Rwg}},cka:{configurable:!0,enumerable:!0,get:function(){return 0<this.U3}},rK:{configurable:!0,enumerable:!0,get:function(){return this.Ffa}},gridView:{configurable:!0,enumerable:!0,get:function(){return this.$hi?this.fr:Oe.g(this.$)}},f0b:{configurable:!0,enumerable:!0,get:function(){return this.X1d}},U3:{configurable:!0,enumerable:!0,get:function(){return this.$Ie},set:function(k){this.$Ie=k;k||(this.V3=0)}},xwj:{configurable:!0,enumerable:!0,get:function(){if(null==
this.Dpc){var k=this.$.xc;this.Dpc=!!k&&!k.inEmbedView}return this.Dpc}},pNd:{configurable:!0,enumerable:!0,get:function(){return this.Df.v3b[this.Df.Vk.rowIndex]}},rVe:{configurable:!0,enumerable:!0,get:function(){!this.mcd&&this.pluginScheduler&&(this.mcd=this.pluginScheduler.getFunctionsShortDescriptions());return this.mcd}}});ta.Ubd="FACardOpened";ta.pbd="FAFocusOnSmartSuggestionsCard";ta.Ekd=null;Object(Dd.a)(ta,"FormulaAssistanceControl",sj.a,[779,780,3,781,782]);var ea=fi.a;Am(va,ea);va.prototype.ine=
function(k){this.addHandler("FAFunctionNameUpdated",k)};va.prototype.JPf=function(k){this.removeHandler("FAFunctionNameUpdated",k)};va.prototype.Xne=function(k){this.addHandler("FAParameterSelectionChangedOld",k)};va.prototype.eQf=function(k){this.removeHandler("FAParameterSelectionChangedOld",k)};va.prototype.Wne=function(k){this.addHandler("FAParameterSelectionChanged",k)};va.prototype.dQf=function(k){this.removeHandler("FAParameterSelectionChanged",k)};va.prototype.kEg=function(k){this.addHandler("DC",
k)};va.prototype.oaj=function(k){this.removeHandler("DC",k)};va.prototype.dismiss=function(){this.hw=!1;this.formulaAssistanceUIControl&&(this.Yq=null,this.nR&&this.kH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Yka=null,this.rr.canReceiveFocus=!1)};va.prototype.show=function(k,H){var Y=this;this.hw=!0;var za=this.xEd(k);this.formulaAssistanceUIControl&&(this.formulaAssistanceTelemetryManager.L7(["argumentAssistanceRender"]),k={},k.zoomLevel=Oa(this.$),this.formulaAssistanceUIControl.updateContext(k),
Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Yq=function(){Y.formulaAssistanceUIControl.renderArgumentAssistanceCard(Y.domElement,H,za)},this.Yq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,H,za),this.BDd(za),this.nR&&this.kH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Yq,function(){return Y.formulaAssistanceUIControl.dismiss(Y.domElement)}),this.rr.canReceiveFocus=
!0,this.formulaAssistanceTelemetryManager.vZ(["argumentAssistanceRender"]),this.formulaAssistanceTelemetryManager.V7b("argumentAssistanceOverall"))};va.prototype.dispose=function(){if(this.$){var k=Oe.g(this.$);k&&(k.ha&&k.ha.WF(this.kd),k.view.Xq(this.tt),this.nR&&k.wc.Dn(this.ug))}kg.a.Ha(this.rr);this.$=null};va.prototype.xEd=function(k){var H=new pb;H.functionRenderingInfo=k;H.cardMode=this.W2;this.bId(H);return H};va.prototype.bId=function(k){k.callbacks=new cb;k.callbacks.onHelpLink=this.Cvb(k.functionRenderingInfo);
k.callbacks.onCardModeChange=this.onCardModeChange;k.callbacks.onFeedback=this.lRa;this.sba&&(k.callbacks.onDismissClick=this.onDismissClick)};va.prototype.Cvb=function(k){var H=this;return function(){Qa(H.$,k.helpID,k.isUDF)}};va.prototype.ROd=function(){var k=dj.a.get(Ea.a.V_b);this.W2=k?parseInt(k,10):va.R5c;this.formulaAssistanceTelemetryManager.JXf(this.W2)};va.prototype.BDd=function(k){var H=k.functionRenderingInfo.functionName;this.Yka&&S.a.equals(this.Yka,H,!0)?(H=Uh.a.map(k.functionRenderingInfo.signatures,
function(Y){var za="";0<=Y.signatureParams.activeParam&&Y.signatureParams.activeParam<Y.signatureParams.params.length&&(za=Y.signatureParams.params[Y.signatureParams.activeParam]);return za}),this.raiseEvent("FAParameterSelectionChanged",new Qb(H))):(this.Yka=H,k=Uh.a.map(k.functionRenderingInfo.signatures,function(Y){return Y.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new yc(H,k)))};va.prototype.bOb=function(k){this.W2=k;try{dj.a.Kv(Ea.a.V_b,k.toString(),Kk.AFrame.rea)}catch(H){nc.ULS.sendTraceTag(537162074,
0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",H.message)}};va.QJa=function(){return document.createElement("div")};Ek.Object.defineProperties(va.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.hw},set:function(k){k||this.dismiss();this.hw=k}}});va.R5c=0;Object(Dd.a)(va,"FormulaArgumentAssistanceControl",fi.a,[865]);var Ta;(function(k){k[k.Dismissed=0]="Dismissed";k[k.Smart=1]="Smart";k[k.Simple=2]="Simple";k[k.Mixed=3]="Mixed"})(Ta||
(Ta={}));Object(Dd.b)("UIState",Ta);var Lb=fi.a;Am(xa,Lb);xa.prototype.gne=function(k){this.addHandler("FACardOpened",k)};xa.prototype.IPf=function(k){this.removeHandler("FACardOpened",k)};xa.prototype.ene=function(k){this.addHandler("FAFocusOnSmartSuggestionsCard",k)};xa.prototype.GPf=function(k){this.removeHandler("FAFocusOnSmartSuggestionsCard",k)};xa.prototype.fne=function(k){this.addHandler("FormulaAutoCompleteShown",k)};xa.prototype.HPf=function(k){this.removeHandler("FormulaAutoCompleteShown",
k)};xa.prototype.FVc=function(k){this.addHandler("SelectedRowChanged",k)};xa.prototype.CJd=function(k){this.removeHandler("SelectedRowChanged",k)};xa.prototype.BZb=function(k){this.addHandler("ListBoxUpdated",k)};xa.prototype.Usc=function(k){this.removeHandler("ListBoxUpdated",k)};xa.prototype.dispose=function(){if(this.$){var k=Oe.g(this.$);k&&(k.ha&&k.ha.WF(this.kd),k.wc&&this.jzb&&k.wc.Dn(this.ug),k.view.Xq(this.tt));this.$.xa&&this.$.xa.Xg(this.gi)}kg.a.Ha(this.rr);this.$=null};xa.prototype.YDg=
function(k){this.addHandler("CVIC",k)};xa.prototype.aaj=function(k){this.removeHandler("CVIC",k)};xa.prototype.Wh=function(k,H){if(!this.visible)return!1;this.wBc(H);var Y;return(Y=this.j3h(H)).udc?Y.result:this.$vj(H)};xa.prototype.Fwb=function(k){if(!this.visible)return!1;var H=!1;switch(k){case 1872288872:this.rK&&this.Nma();this.visible=!1;H=!0;break;case -798660877:this.pfb(this.lwb(this.pX+1));H=!0;break;case 137938150:this.pfb(this.lwb(this.pX-1));H=!0;break;case 2091832999:this.pfb(this.lwb(this.pX+
8));H=!0;break;case 742457698:this.pfb(this.lwb(this.pX-8));H=!0;break;case 125627505:case 267796030:this.Dqb(this.Rt.items[this.pX]),H=!0}return H};xa.prototype.show=function(k){this.Ya=Oe.g(this.$).lk;this.hw=!0;this.pX=0;this.Rt=k;0<this.Rt.items.length&&(this.render(),this.pfb(this.lwb(this.pX)),1===this.Rt.items[0].type&&this.jzb&&(this.SAa=!0));this.formulaAssistanceTelemetryManager.w9e(k.items)};xa.prototype.Nma=function(){this.Ffa=!1;this.Ya.jIe()};xa.prototype.$vj=function(k){return[1872288872,
-798660877,137938150,2091832999,742457698,125627505,267796030].includes(k)};xa.prototype.j3h=function(k){return this.rK?125627505===k||267796030===k?(this.Dqb(this.Rt.items[this.pX]),{udc:!0,result:!1}):!this.iEf||-798660877!==k&&137938150!==k?{udc:!1}:{udc:!0,result:!1}:{udc:!1}};xa.prototype.render=function(){var k=this;this.formulaAssistanceTelemetryManager.L7(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var H={};H.zoomLevel=Oa(this.$);this.formulaAssistanceUIControl.updateContext(H);
this.Yq=function(){k.formulaAssistanceUIControl.renderAutoCompleteMenu(k.domElement,k.Ya.textBox.domElement,k.Ded())};this.Yq();this.S2i();this.rr.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.vZ(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.V7b("autoCompleteOverall")}};xa.prototype.S2i=function(){var k=this.RNb;this.RNb=this.MZh(this.Rt.items);k!==Ta.Dismissed&&k!==Ta.Smart||this.RNb!==Ta.Simple&&this.RNb!==Ta.Mixed||this.raiseEvent("FormulaAutoCompleteShown")};xa.prototype.u3i=
function(){var k;if(this.Zii&&0!==this.Rt.items.length){var H=0<=this.pX?this.pX:0,Y=this.Rt.items[H];Y={dG:Y.label,description:null!==(k=Y.detail)&&void 0!==k?k:"",selectedIndex:H+1,length:this.Rt.items.length};this.raiseEvent("SelectedRowChanged",Y)}};xa.prototype.Dqb=function(k){if(this.Ya&&this.visible){var H=k.textEdit;this.qmd(this.Ya.text,H);this.Ya.textBox.caretPosition=H.range.start.character+H.newText.length;this.rK&&(this.Ffa=!1,this.jzb&&(this.wSa=!0),this.Ya.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",
0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:k.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.v9e(k.kind)}};xa.prototype.kIg=function(){this.SAa&&(this.formulaAssistanceTelemetryManager.u4.smartSuggestionShownCounter++,this.SAa=!1);this.wSa&&(this.formulaAssistanceTelemetryManager.u4.smartSuggestionSelectedCounter++,this.wSa=!1);this.fMb&&(this.formulaAssistanceTelemetryManager.u4.smartSuggestionCommittedCounter++,this.fMb=!1)};xa.prototype.Ded=
function(){var k=new Sa;k.completionItems=this.Rt.items;k.activeItemIndex=this.pX;this.$Hd(k);return k};xa.prototype.$Hd=function(k){k.callbacks=new Gb;k.callbacks.onCompletionItemSelected=this.Uzd;k.callbacks.onCompletionItemCommitted=this.Tzd;k.callbacks.onFeedback=this.lRa;k.callbacks.onDismiss=this.FIi;k.callbacks.onRestoreFocus=Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0};xa.prototype.OEd=function(k){this.Ffa=!0;var H=k.textEdit.newText;
this.Ya.jSa(H.substring(this.Ya.text.length-k.textEdit.range.start.character,H.length))};xa.prototype.pfb=function(k){var H=this.pX;this.pX=k;var Y=this.Rt.items[k];this.rK&&this.Nma();H!==k&&this.render();1===Y.type&&Ke.EwaSettings.Fb()&&!Oe.g(this.$).lk.text.includes("\n")&&this.OEd(Y);this.u3i()};xa.prototype.lwb=function(k){return 0>k?0:Math.min(k,this.Rt.items.length-1)};xa.prototype.qmd=function(k,H){this.Ya.text=k.substring(0,H.range.start.character)+H.newText+k.substring(H.range.end.character,
k.length);Oe.g(this.$).Dj&&(Oe.g(this.$).rc.text=this.Ya.text)};xa.prototype.Wtd=function(){this.tIa&&(this.formulaAssistanceTelemetryManager.SY.selectByArrowKeyCounter++,this.tIa=!1);this.uIa&&(this.formulaAssistanceTelemetryManager.SY.selectByMouseHoverCounter++,this.uIa=!1);this.Nta&&(this.formulaAssistanceTelemetryManager.SY.commitByTabKeyCounter++,this.Nta=!1);this.Lta&&(this.formulaAssistanceTelemetryManager.SY.commitByEnterKeyCounter++,this.Lta=!1);this.Mta&&(this.formulaAssistanceTelemetryManager.SY.commitByMouseClickCounter++,
this.Mta=!1)};xa.prototype.wBc=function(k){switch(k){case -798660877:case 137938150:case 2091832999:case 742457698:this.tIa=!0;break;case 125627505:this.Nta=!0;break;case 267796030:this.Lta=!0}};xa.QJa=function(){return document.createElement("div")};xa.prototype.MZh=function(k){return k.reduce(function(H,Y){return H|=0===Y.type?Ta.Simple:Ta.Smart},Ta.Dismissed)};Ek.Object.defineProperties(xa.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.hw},set:function(k){k||this.dismiss();
this.hw=k}},rK:{configurable:!0,enumerable:!0,get:function(){return this.Ffa}},iEf:{configurable:!0,enumerable:!0,get:function(){return 1===this.Rt.items.length&&1===this.Rt.items[0].type}}});Object(Dd.a)(xa,"FormulaAutoCompleteControl",fi.a,[864,3,781]);pa.prototype.then=function(k,H){return this.promise.then(k,H)};pa.prototype.resolve=function(k){this.Eug(k);return null!=k&&"function"===typeof k.then?this.promise.then():void 0};pa.prototype.reject=function(k){this.nug(k);return null!=k&&"function"===
typeof k.then?this.promise.then():void 0};Object(Dd.a)(pa,"ResolvablePromise",null,[]);ma.prototype.getRichValueFieldListContext=function(k,H,Y,za){this.Qif&&k!==this.Qif&&this.rh.Lbb();this.Qif=k;this.rh.MZ(k,Y,za,H);this.z9b=new pa;this.rh.azb?this.z9b.resolve(this.rh.Nk):this.u7i();return this.z9b.promise};ma.prototype.u7i=function(){this.rh.sZb(this.rya);this.rh.GEg(this.jxf)};ma.prototype.Fag=function(){this.rh.Lsc(this.rya);this.rh.Haj(this.jxf)};Object(Dd.a)(ma,"ServerDataProvider",null,[866]);
ka.prototype.dispose=function(){if(this.$){var k=this.gridView;k&&(k.ha&&ee.a.XV()&&k.ha.Jza(this.Rh),this.Def&&k.Ea&&k.Ea.Dv(this.Pi))}this.G2&&this.gridView.wc.Dn(this.ug);this.sba&&(this.G2||this.gridView.wc.Dn(this.ug),this.Zpa.oaj(this.Btf));this.wfa.aaj(this.Jtf);this.functionInfoManager&&this.functionInfoManager.lbb(this.onFunctionInfoLoaded);ee.a.Hfc&&this.Ya&&this.Ya.YHb(this.p6);kg.a.Ha(this.Zpa);kg.a.Ha(this.wfa);this.wfa=this.Zpa=this.functionInfoManager=this.$=null};ka.prototype.ffj=
function(){this.rNa=-1;this.sNa=null};ka.prototype.F6c=function(){this.wfa.visible=!1;this.Zpa.visible=!1};ka.prototype.Wh=function(){this.uda();return!1};ka.prototype.uda=function(){if(!this.Ya.YK)if(this.formulaAssistanceTelemetryManager.Job.formulaAssistanceRequestAttemptedCounter++,this.Pwj()){this.functionInfoManager.l_||(this.functionInfoManager.HYa(this.onFunctionInfoLoaded),this.functionInfoManager.a2a({}));var k=this.Ya,H=k.text;k=k.textBox.caretPosition;this.G2&&H.startsWith("=")&&(this.XLa=
!0,1===H.length&&(this.YLa=!0));!this.sba||this.YRa?(this.formulaAssistanceTelemetryManager.L7(["argumentAssistanceComputation","autoCompleteComputation","argumentAssistanceOverall","autoCompleteOverall"]),this.NWf(H,k)):(this.formulaAssistanceTelemetryManager.L7(["autoCompleteComputation","autoCompleteOverall"]),this.Oej(H,k))}else this.formulaAssistanceTelemetryManager.Job.formulaAssistanceRequestOptimizedCounter++};ka.prototype.NWf=function(k,H){var Y=this;k=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:k,
caretPosition:H},argumentAssistance:{content:k,caretPosition:H}});this.Ica+=1;k.then(function(za){--Y.Ica;0===za.kind&&(Y.J4e(za.payload.argumentAssistance),Y.m5e(za.payload.functionSuggestion));return null})};ka.prototype.Oej=function(k,H){var Y=this;k=this.pluginScheduler.requester().functionSuggestion({content:k,caretPosition:H});this.Ica+=1;k.then(function(za){--Y.Ica;0===za.kind&&Y.m5e(za.payload);return null})};ka.prototype.EKd=function(k,H){var Y=this;k=this.pluginScheduler.requester().argumentAssistance({content:k,
caretPosition:H});this.Ica+=1;k.then(function(za){--Y.Ica;0===za.kind&&Y.J4e(za.payload)})};ka.prototype.Pwj=function(){var k=this.Ya,H=k.text;k=k.textBox.caretPosition;if(this.wfa.visible&&S.a.equals(H,this.sNa,!0)&&k===this.rNa)return!1;this.sNa=H;this.rNa=k;return!0};ka.prototype.nMd=function(){this.pluginScheduler.requester().runExperiment(new fa)};ka.prototype.J4e=function(k){k&&this.Ya.isEditing?(this.formulaAssistanceTelemetryManager.vZ(["argumentAssistanceComputation"]),this.Zpa.show(k,this.Ya.textBox.domElement)):
this.Zpa.dismiss()};ka.prototype.m5e=function(k){k&&0<k.items.length&&this.Ya.isEditing?(this.formulaAssistanceTelemetryManager.vZ(["autoCompleteComputation"]),this.wfa.show(k)):this.wfa.dismiss()};ka.prototype.lMd=function(k){this.pluginScheduler.requester().runAuthoringExperiment({content:k})};ka.prototype.tDb=function(k){var H,Y=this.gridView.ha.sa.activeCell;if(Y){var za=this.calcManager.eta(Y,!this.Jnd);if(za){var Va=this.$.xa,Pb=za.sheet.index;0>=Va.count||0>Pb||Pb>=Va.count||(Pb=Va=null,this.uyd&&
void 0!==this.calcManager&&null!==this.calcManager&&(k=null!==(H=null===k||void 0===k?void 0:k.cell)&&void 0!==H?H:this.gridView.Ea.gs(Y))&&(H=this.calcManager.Tbc(k.Ak),void 0!==H&&null!==H&&(Va=H.FormatString,Pb=H.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:za.range.col,rowIndex:za.range.row,sheetIndex:this.$.xa.getItem(za.sheet.index).sheetId,docName:za.sheet.document.name,docPath:za.sheet.document.path,formatString:Va,builtIn:Pb}))}else nc.ULS.sendTraceTag(537162002,0,50,
"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}};ka.prototype.pSj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.N$b)};ka.prototype.cmd=function(){this.gridView.ha.Mra(this.Rh);var k=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveCellChangedArgs",!1)?this.gridView.kc(null):void 0;this.tDb(k);ee.a.Hfc&&this.Ya.GYa(this.p6);this.nMd();this.wfa.YDg(this.Jtf);this.pluginScheduler.setServerDataProvider(new ma(this.rh,
this.$));this.uda()};Ek.Object.defineProperties(ka.prototype,{aja:{configurable:!0,enumerable:!0,get:function(){return this.wfa}},MUe:{configurable:!0,enumerable:!0,get:function(){return this.Zpa}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.gridView.lk}}});Object(Dd.a)(ka,"FormulaAssistanceManager",null,[775,3]);var xc=gg.a;Am(W,xc);W.prototype.create=function(){var k=this,H=ee.a.XV(),Y=Ke.EwaSettings.ma(375),za=Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",
!1),Va=ee.a.tB(this.$),Pb=this.$.da,Ac=rf.GetServiceTaskFactory.create(Pb,134,this.la,this.ub),id=rf.GetServiceTaskFactory.Va(this.$.da,12,477,this.ub);var Ld=ee.a.h5()?rf.GetServiceTaskFactory.create(this.$.da,449,this.$.la,1):qh.Task.Sa(null);var ld=ee.a.XV()?rf.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):qh.Task.Sa(null);if(za||H){var ef=rf.GetServiceTaskFactory.Va(Pb,266,265,this.ub),Jf=rf.GetServiceTaskFactory.Va(Pb,219,220,this.ub),Kg=rf.GetServiceTaskFactory.Va(Pb,491,492,this.ub);
Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([ef,ld,Ld,Jf,Kg],this.la),function(){var wi=Pb.Aa(19)||new rc(k.$,ld.result),oj=Jf.result;if(Va){var fj=Pb.Aa(464);fj||(fj=new ka(k.$,wi,ef.result,ld.result,Ld.result,Kg.result,id.result.z3c(k.$,Ac.result)),oj.xXc(fj.MUe),oj.yXc(fj.aja),Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&oj.zXc(fj.aja))}else fj=Pb.Aa(221),fj||(fj=new ta(k.$,wi,Ac.result,ef.result,null,id.result,Ld.result,Kg.result,ld.result),oj.xXc(fj.NUe),oj.zXc(fj.jVe),
oj.yXc(fj)),Y&&(Pb.Aa(317)||new ic(k.$));k.Eb(wi)},this.la,3)}else{var Cg=rf.GetServiceTaskFactory.Va(Pb,219,220,this.ub),Wg=rf.GetServiceTaskFactory.Va(Pb,491,492,this.ub);Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([Cg,Ld,ld],this.la),function(){var wi=Pb.Aa(19)||new rc(k.$,ld.result),oj=Cg.result,fj=Pb.Aa(221);fj||(fj=new ta(k.$,wi,Ac.result,null,null,id.result,Ld.result,Wg.result,ld.result),oj.xXc(fj.NUe),oj.zXc(fj.jVe),oj.yXc(fj));Y&&(Pb.Aa(317)||new ic(k.$));k.Eb(wi)},this.la,3)}};W.ka=function(k){k.da.Ga(153,
new W(k))};Object(Dd.a)(W,"FunctionInfoManagerFactory",gg.a,[]);var qd=b(211),Jd=b(76),De=b(117);Z.prototype.CYe=function(){return De.a(ff.a.Ta,this.startTime)};Object(Dd.a)(Z,"OngoingAction",null,[]);var Ve=Jd.a;Am(R,Ve);R.prototype.XFf=function(k){nc.ULS.sendTraceTag(537153864,0,50,"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.ila,this.NLa,this.S5a);this.Onb=this.Yyg.kWc(k,this.Onb);this.Cmd()};R.prototype.dispose=function(){this.documentVisibilityObserver&&
this.documentVisibilityObserver.bIb(this.qya);this.Awe();Ve.prototype.dispose.call(this)};R.prototype.VZf=function(k){this.jZc?(this.aPa=k?new Z:null,k?this.startTimer():this.Awe()):this.aPa=k?{}:null};R.prototype.uTe=function(k){k=void 0===k?null:k;this.jZc&&k&&k.oK?nc.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",this.ila):(nc.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",
this.ila,this.NLa,this.S5a),this.VZf(!1),this.Cmd())};R.prototype.Cmd=function(){var k=this;if(!this.zLb()){var H=this.Onb;this.Onb=null;this.VZf(!0);nc.ULS.sendTraceTag(537153857,0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",this.ila);var Y=this.jZc?this.aPa.Lx.token:qd.a.none;Uf.TaskExtensions.Ba(this.Xyg.ADd(H),function(){k.uTe(Y)},Y,0,this.UO)}};R.prototype.zLb=function(){return!this.S5a||this.NLa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Ai?
(nc.ULS.sendTraceTag(593376846,0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",this.ila),!0):!1};R.prototype.Awe=function(){this.Zoc&&this.Zoc.cancel()};R.prototype.startTimer=function(){this.kZc<=this.Xue&&(this.Zoc=Vi.a.instance.create(this.oQi,this.gSg,pj.a.Rje))};Ek.Object.defineProperties(R.prototype,{NLa:{configurable:!0,enumerable:!0,get:function(){return!!this.aPa}},S5a:{configurable:!0,enumerable:!0,get:function(){return!!this.Onb}}});Object(Dd.a)(R,
"ActionAggregator",Jd.a,[863,3]);var sg=b(128),mh=sh.a;Am(J,mh);J.prototype.fFg=function(k){this.addHandler("KBIS",k)};J.prototype.Zaj=function(k){this.removeHandler("KBIS",k)};J.prototype.dispose=function(){this.firstElement&&Pi.a.removeHandler(this.firstElement,Eg.a.focus,this.Hwf);this.Hs&&this.Hs.detach("focus");this.Ow&&(Pi.a.removeHandler(this.Ow,Eg.a.focus,this.Byf),Pi.a.removeHandler(this.Ow,Eg.a.blur,J.onBlur),Ik.KeyInputManager.instance.za(Eg.a.Yb,this.Ow,this.Cyf));Ik.KeyInputManager.instance.za(Eg.a.Yb,
this.$.domElement,this.YDf);this.Hs=this.Ow=this.firstElement=this.$=null;mh.prototype.dispose.call(this)};J.prototype.a6g=function(){this.cvj?(this.firstElement=document.documentElement,this.Hs=sg.a.instance.KE(document.parentWindow),this.Hs.ka("focus",this.ITi)):(this.firstElement=J.vDe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),Pi.a.addHandler(this.firstElement,Eg.a.focus,this.Hwf))};J.prototype.Z6g=function(){this.Ow=J.vDe();this.Ow.id=Ea.a.CKe;this.Ow.setAttribute(Ea.a.Pt,
Ae.a.instance.fa(858));document.body.appendChild(this.Ow);Pi.a.addHandler(this.Ow,Eg.a.focus,this.Byf);Pi.a.addHandler(this.Ow,Eg.a.blur,J.onBlur);Ik.KeyInputManager.instance.pa(Eg.a.Yb,this.Ow,this.Cyf)};J.prototype.yxh=function(k){this.Z9f(k);return!1};J.prototype.fJi=function(){this.oMa=!0;Oe.g(this.$).focus();Oe.g(this.$).ha.g5e();this.raiseEvent("KBIS");return!0};J.prototype.Z9f=function(k){this.oMa?this.oMa=!1:(this.oMa=!0,k&&k.focus())};J.vDe=function(){var k=document.createElement("div");
k.tabIndex=0;return k};J.V7e=function(){document.body.classList.add(A.a.bNe)};J.onBlur=function(){document.body.classList.remove(A.a.bNe)};Object(Dd.a)(J,"EmbedViewFocusControl",sh.a,[862,3]);var Zh=b(60),Ci=b(570),Bj=sh.a;Am(D,Bj);D.prototype.sZb=function(k){this.addHandler("FieldInfoListContextLoaded",k)};D.prototype.Lsc=function(k){this.removeHandler("FieldInfoListContextLoaded",k)};D.prototype.GEg=function(k){this.addHandler("GetFieldInfoListContextOperationFailed",k)};D.prototype.Haj=function(k){this.removeHandler("GetFieldInfoListContextOperationFailed",
k)};D.prototype.dispose=function(){this.wb=null;this.Lbb();Bj.prototype.dispose.call(this)};D.prototype.MZ=function(k,H,Y,za){za=void 0===za?null:za;if(k){this.$Zc();this.K1b();var Va=null,Pb=!1,Ac;if(Ac=!za)Ac=this.uMj(k,H,Y),Pb=Ac.C$a,Va=Ac.Nk,Ac=Ac.returnValue;if(Ac&&(this.KYf(Va),this.hUb=!0,(this.wP=Va)&&0<this.wP.length&&(this.ljb=!0,this.jGd()),!Pb))return;this.Jcg(k,za,H,Y,!1)}};D.prototype.Jcg=function(k,H,Y,za,Va){if(this.$.ea.sc){this.$.Ob&&(this.SIb=this.$.Ob.Gc("WebServiceCall","GetRichValueFieldInfoListContext"));
this.qvb=null;var Pb=this.$.na.ua.hc(),Ac=this.$.na.ua,id=this.DKi,Ld=this.CKi,ld=Ac.Na(1,null);ld.selectedRange=k;ld.richValueKeyPath=H;ld.singleColumn=Y;ld.searchForRange=za;ld.calculateMajorityDataType=Va;this.qvb=Jg.i(Ac,"GetRichValueFieldListContextList",ld,id,Ld,null,Pb,4)}else this.wP=null};D.prototype.Lbb=function(){this.wP=null;this.ljb=!1;this.$Zc();this.K1b();this.qvb=null;this.QSb=-1};D.prototype.$Zc=function(){D.Lpb(this.qvb)};D.prototype.K1b=function(){D.Lpb(this.jed)};D.prototype.jGd=
function(){this.raiseEvent("FieldInfoListContextLoaded")};D.prototype.rn=function(k){k=ve.D(k);--k.left;--k.right;return this.tableManager.rn(k)};D.prototype.dKa=function(k){var H=this;k.FirstColumn=k.FirstColumn;k.LastColumn=k.LastColumn;k.FirstRow=k.FirstRow;k.LastRow=k.LastRow;this.K1b();this.jed=null;return zg.a(this.$.userOperationManager,function(Y,za,Va){return Jg.w(H.$.na.ua,k,Rg.b(Y,function(Pb){H.NKi(Pb)}),Rg.a(za,za,function(Pb){H.MKi(Pb)}),Va,null)},function(Y){return new Ed.a(264,0,Y,
80)},null)};D.prototype.MKi=function(k){k=ch.a.pg(k.data);nc.ULS.sendTraceTag(525336847,0,10,"FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: {0}",he.a.Wc(k))};D.prototype.NKi=function(k){if(Dh.a(k))-315732528!==k.Errors[0].MessageId&&nc.ULS.sendTraceTag(525336846,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : {0}",he.a.Wc(k.Errors));else if(k&&k.Result){k=k.Result;var H=k.HasHeaderRow;H=new Ci.AutofilterRange(k.TableRange.FirstRow+
(H?1:0)+1,k.TableRange.FirstColumn+1,k.TableRange.LastRow+1,k.TableRange.LastColumn+1,null,null,null,0,H);this.QSb=k.TableRange.FirstColumn;(k=this.aJf(!1,!0,H))||nc.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.KYf(k)}else nc.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")};D.prototype.uMj=function(k,H,Y){var za=null;var Va=!1;if(k.SheetName!==this.$.ea.qa.sheetName)return{returnValue:!1,
C$a:Va,dKa:!1,Nk:za};this.QSb=-1;if(Y){var Pb=this.rn(k);if(!Pb||!Pb.eba)return{returnValue:!1,C$a:Va,dKa:!1,Nk:za};var Ac=Oe.g(this.$).Rb.D1e(Pb);this.s4d=Pb;if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Ac&&0<Ac.count)return--k.FirstColumn,--k.LastColumn,this.jed=this.dKa(k),{returnValue:!0,C$a:Va,dKa:!0,Nk:za};Pb.top+=1;Pb.right=ve.D(k).right-1}else Pb=new Ci.AutofilterRange(k.FirstRow+1,k.FirstColumn+1,k.LastRow+1,k.LastColumn+
1,null,null,null,0,!1);if(Pb.top>Pb.bottom||Pb.left>Pb.right)return{returnValue:!0,C$a:Va,dKa:!1,Nk:za};k=Oe.g(this.$);var id=k.rb.width,Ld=k.rb.height;Ac=k.view.visibleArea;id=new Zh.a(Ac.x-id,Ac.y-Ld,Ac.width+id,Ac.height+Ld);Ld=k.qg(Pb);if(!Ac||!Ld||!k.Ohc(Pb))return{returnValue:!1,C$a:Va,dKa:!1,Nk:za};id.contains(Ld)||(Va=!0);za=this.aJf(H,Y,Pb);return{returnValue:!0,C$a:Va,dKa:!1,Nk:za}};D.prototype.KYf=function(k){k&&nc.ULS.sendTraceTag(25264348,0,50,"Retrieved {0} rich value field contexts from block cache",
k.length);this.hUb=!0;(this.wP=k)&&0<this.wP.length&&(this.ljb=!0,this.jGd())};D.prototype.aJf=function(k,H,Y){var za=null;var Va=Y.clone();if(H){H=Y.right;for(var Pb=0;H>=Y.left;--H){Va.left=H;Va.right=H;var Ac=this.QYe(Va,!0,Y.left);if(Ac){za||(za=[]);za[Pb]=Ac;if(k)break;++Pb}}}else if(k=this.QYe(Va,!1))za=[],za[0]=k;return za};D.prototype.QYe=function(k,H,Y){Y=void 0===Y?0:Y;var za=null;if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Va=Oe.g(this.$).Rb.lWh(k);
if(Va&&0<Va.count){var Pb=Array(Va.count),Ac=0;Va=El(Va.values);for(za=Va.next();!za.done;za=Va.next()){var id={};id.Name=za.value;Pb[Ac]=id;++Ac}Ac="";Va=-1;0<k.top&&H&&(k=new mj.Range(k.top-1,k.left,k.top-1,k.left,!1,!1),null!=Oe.g(this.$).kc(k)&&null!=Oe.g(this.$).kc(k).originalText&&(Ac=Oe.g(this.$).kc(k).originalText),Va=k.left-Y);za={};za.ColumnName=Ac;za.ColumnIndex=Va;za.FieldInfoDataList=Pb}}else if((Va=Oe.g(this.$).Rb.D1e(k))&&0<Va.count){Pb=Array(Va.count);Ac=0;Va=El(Va);for(za=Va.next();!za.done;za=
Va.next())id={},id.Name=za.value,Pb[Ac]=id,++Ac;Ac="";Va=-1;0<k.top&&H&&(k=new mj.Range(k.top-1,k.left,k.top-1,k.left,!1,!1),Ac=Oe.g(this.$).kc(k).originalText,Va=k.left-Y);za={};za.ColumnName=Ac;za.ColumnIndex=Va;za.FieldInfoDataList=Pb}return za};D.Lpb=function(k){k&&Vg.AFrameworkApplication.Jd.Du(k.Qt)};Ek.Object.defineProperties(D.prototype,{azb:{configurable:!0,enumerable:!0,get:function(){return this.ljb}},Jsi:{configurable:!0,enumerable:!0,get:function(){return this.hUb}},eVe:{configurable:!0,
enumerable:!0,get:function(){return this.QSb}},U4c:{configurable:!0,enumerable:!0,get:function(){return this.s4d}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Nk:{configurable:!0,enumerable:!0,get:function(){return this.wP}},jOh:{configurable:!0,enumerable:!0,get:function(){return!!this.qvb}}});Object(Dd.a)(D,"FieldInfoManager",sh.a,[798,3]);Am(F,D);F.prototype.tOh=function(k,H){this.Q1a=H;nc.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",
k.FirstRow,k.FirstColumn,k.LastRow,k.LastColumn);this.Jcg(k,null,!0,!1,!0)};Ek.Object.defineProperties(F.prototype,{XG:{configurable:!0,enumerable:!0,get:function(){return this.Rkg}}});Object(Dd.a)(F,"FilterInfoManager",D,[861,798,3]);aa.prh="ewa-sharedUi-launchButton";aa.srh="ewa-sharedUi-launchButtonWithText";aa.qrh="ewa-sharedUi-launchButtonClick";aa.trh="ewa-sharedUi-launchButtonWithTextClick";aa.rrh="ewa-sharedUi-launchButtonText";Object(Dd.a)(aa,"CssClassNames",null,[]);var Kj=b(295),uk=fi.a;
Am(U,uk);U.prototype.O2=function(k){this.addHandler(this.iGb,k)};U.prototype.mda=function(k){this.get_events().removeHandler(this.iGb,k)};U.prototype.wFg=function(k){this.addHandler("OnObjectButtonMouseOver",k)};U.prototype.pbj=function(k){this.get_events().removeHandler("OnObjectButtonMouseOver",k)};U.prototype.vFg=function(k){this.addHandler("OnObjectButtonMouseOut",k)};U.prototype.obj=function(k){this.get_events().removeHandler("OnObjectButtonMouseOut",k)};U.prototype.Sbg=function(k){k&&(this.f_a.innerHTML=
k)};U.prototype.GPj=function(k,H,Y){this.f_a.innerHTML="";k?k.oba(H,16,16,this.f_a,16,16,void 0,Y):nc.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};U.prototype.HPj=function(k,H){k&&(this.aNb.innerText=k);this.domElement.title=H};U.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.Jc.fB(),kg.a.zc([this.rZ,this.XZa]),Fi.a.instance.za(Eg.a.click,this.domElement,this.vd),wk.a.instance.za(Eg.a.pointerDown,this.domElement,
this.ON),this.oSa&&this.oSa.dispose(),uk.prototype.dispose.call(this))};U.prototype.Jbb=function(){this.J2b&&this.domElement.classList.remove(this.J2b);this.emc&&this.domElement.classList.add(this.emc)};U.prototype.gGb=function(){this.emc&&this.domElement.classList.remove(this.emc);this.J2b&&this.domElement.classList.add(this.J2b);this.d2a()};U.prototype.d2a=function(){this.kic&&(this.oSa.cancel(),this.b6f(),this.setOpacity(1));this.set_visible(!0)};U.prototype.Ip=function(k,H,Y,za,Va){Va=void 0===
Va?!1:Va;k=Dc.a(za).Ei(k);H=Dc.a(za).Ei(H);Dc.a(za).vwc(this.domElement);this.domElement.style.top=$c.HelperMethods.nc(H);this.domElement.style.left=this.domElement.style.right="";H=k;Va&&(H=k-this.domElement.offsetWidth);gh.c(this.domElement.style,Y,$c.HelperMethods.nc(H));this.set_visible(!0);this.setOpacity(1);this.kic&&(this.GSd=!1,this.aEj(),this.oSa.Zq())};U.prototype.hide=function(){this.Jbb();this.set_visible(!1);this.kic&&(this.b6f(),this.oSa.cancel())};U.prototype.P7b=function(){this.Jc.ka("mouseover",
this.UN,!0);this.Jc.ka("mouseout",this.SN,!0)};U.prototype.aEj=function(){this.rZ.un("mousemove")||this.rZ.ka("mousemove",this.MIi)};U.prototype.b6f=function(){this.rZ.un("mousemove")&&this.rZ.detach("mousemove")};U.prototype.Eid=function(k){if(this.domElement.parentNode){var H=Sys.UI.DomElement.getBounds(this.domElement),Y=new Sys.UI.Point(Math.round(H.x+H.width),Math.round(H.y+H.height));H=Math.abs(Y.x-k.x);k=Math.abs(Y.y-k.y);k=H>k?H:k;this.GSd?this.setOpacity(U.jTg(k)):100>=k&&this.cke()}};U.prototype.cke=
function(){this.GSd=!0;this.oSa.cancel()};U.prototype.setOpacity=function(k){Oj.a.setOpacity(this.domElement,k);this.cjf=ff.a.Ta.Wb};U.jTg=function(k){return 100>=k?1:250<=k?0:.01*(100-(k-100)/150*100)};Object(Dd.a)(U,"OnObjectButton",fi.a,[828,81,3]);var Lj=b(1001),G=aa.rrh,ia=Jd.a;Am(ca,ia);ca.prototype.dispose=function(){this.Xfh();this.$=null;ia.prototype.dispose.call(this)};ca.prototype.getButton=function(k,H){return this.$ua(k,void 0===H?!0:H)};ca.prototype.$ua=function(k,H){var Y=k.toString();
Y in this.buttons||this.a7g(k,void 0===H?!0:H);return this.buttons[Y]};ca.prototype.Ip=function(k,H,Y,za,Va,Pb){Va=void 0===Va?!0:Va;Pb=void 0===Pb?!1:Pb;this.hide();if(this.$.ea.isNamedObjectViewMode&&Yf.i(this.$.qa)){var Ac=Oe.g(this.$).tS.domElement,id=k+this.buttonWidth-Ac.scrollWidth;Ac=H+this.buttonWidth-Ac.scrollHeight;k=0<id?k-id:k;H=0<Ac?H-Ac:H}this.$ua(za,Va).Ip(k,H,Y,this.$,Pb)};ca.prototype.hide=function(){var k=this.buttons,H;for(H in k)k[H].hide()};ca.prototype.P7b=function(k,H){!this.x8e&&
(H=this.buttons[H.toString()])&&(this.Blc=function(Y,za){k(za,!0)},H.wFg(this.Blc),this.Alc=function(Y,za){k(za,!1)},H.vFg(this.Alc),this.x8e=!0,H.P7b())};ca.prototype.a7g=function(k,H){function Y(Pb,Ac){za.eHi(Ac,k)}var za=this;this.hwa=String.format(this.dld===A.a.E8b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Lg.a.Sf(this.dld),Lg.a.Sf(this.cld),"{0}");var Va=String.format(this.hwa,
Lg.a.Sf(this.altText));H=new U(""===this.buttonText?aa.prh:aa.srh,""===this.buttonText?aa.qrh:aa.trh,A.a.rw,Va,H,this.iGb,this.buttonText,G);H.O2(Y);this.buttons[k.toString()]=H;this.lMe[k.toString()]=Y;Va=Oe.g(this.$).Tf(k);Va.domElement.insertBefore(H.domElement,Va.domElement.firstChild)};ca.prototype.Xfh=function(){for(var k=El(Lj.a(this.buttons)),H=k.next();!H.done;H=k.next()){H=H.value;var Y=this.buttons[H];Y.mda(this.lMe[H]);kg.a.Ha(Y);delete this.buttons[H];this.Blc&&Y.pbj(this.Blc);this.Alc&&
Y.obj(this.Alc)}};ca.prototype.domElement=function(k){return this.$ua(k).domElement};ca.prototype.d2a=function(k){this.$ua(k).d2a()};ca.prototype.zOb=function(k,H,Y){Y=void 0===Y?!0:Y;this.hwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Lg.a.Sf(this.dld),Lg.a.Sf(this.cld),"{0}");k=String.format(this.hwa,Lg.a.Sf(k));this.$ua(H,Y).Sbg(k)};ca.prototype.NTa=function(k,H,Y){this.$ua(Y,!1).HPj(k,H)};ca.prototype.Gcg=function(){var k=void 0===
k?!1:k;this.hwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Lg.a.Sf(this.cld),"{1}");var H=String.format(this.hwa,void 0,Lg.a.Sf(void 0));this.$ua(void 0,k).Sbg(H)};ca.prototype.Hcg=function(k,H,Y){this.$ua(Y,!1).GPj(this.svgIconProvider,k,H)};Ek.Object.defineProperties(ca.prototype,{Bz:{configurable:!0,enumerable:!0,get:function(){return Dc.a(this.$).ZFa(Qc.a.FOi)}},j2b:{configurable:!0,enumerable:!0,get:function(){return Qc.a.EOi}},
buttonWidth:{configurable:!0,enumerable:!0,get:function(){return Dc.a(this.$).ZFa(Qc.a.GOi)}}});Object(Dd.a)(ca,"OnObjectLaunchButton",Jd.a,[815,3]);var eb=b(88),Fb=eb.a;Am(L,Fb);L.prototype.dispose=function(){kg.a.Ha(this.TBb);this.TBb=null;Fb.prototype.dispose.call(this)};L.prototype.UAa=function(){kg.a.Ha(this.TBb);this.TBb=Vi.a.instance.create(Object(nh.a)(this,this.display,"display"),this.E8h,pj.a.Nsi)};L.prototype.KSa=function(){kg.a.Ha(this.TBb);this.hide()};Object(Dd.a)(L,"LoadingIndicatorBehavior",
eb.a,[826,3]);Am(P,L);P.prototype.dispose=function(){this.SBb=null;L.prototype.dispose.call(this)};P.prototype.display=function(){this.lng(this.SBb)};P.prototype.hide=function(){this.N5h(this.SBb)};P.prototype.kBg=function(){this.SBb=document.createElement("div");this.domElement.appendChild(this.SBb)};Object(Dd.a)(P,"ShimmerLoadingIndicatorBehavior",L,[]);Am(Q,L);Q.prototype.dispose=function(){this.LNa=null;L.prototype.dispose.call(this)};Q.prototype.display=function(){Kc.DOMElementExtensions.setVisible(this.LNa,
!0)};Q.prototype.hide=function(){Kc.DOMElementExtensions.setVisible(this.LNa,!1)};Q.prototype.jBg=function(){this.LNa=document.createElement("div");this.LNa.classList.add(Cc.a.Nph);var k=document.createElement("div");k.classList.add(Cc.a.Oph);this.X4c&&""!=this.X4c&&k.classList.add(this.X4c);var H=0===this.Skf?"":Ae.a.instance.fa(this.Skf),Y=String.format('<div class="'+Cc.a.Pph+'">{0}</div>',H);this.Hec?(H=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.Hec,H),k.innerHTML=H+Y):k.innerHTML=
Y;this.LNa.appendChild(k);this.domElement.appendChild(this.LNa)};Object(Dd.a)(Q,"SpinnerLoadingIndicatorBehavior",L,[]);M.prototype.Y3c=function(k,H,Y){return new Pk.a(k,H,Y)};M.prototype.K4b=function(k,H,Y,za,Va,Pb,Ac,id,Ld,ld){return new Zb(k,H,Y,za,Va,Pb,Ac,id,Ld,ld)};M.prototype.Crb=function(k,H,Y,za,Va){return new Q(k,H,Y,za,void 0===Va?0:Va)};M.prototype.Nfd=function(k){return k.da.Aa(238)||new J(k)};M.prototype.O4b=function(k,H,Y,za,Va,Pb,Ac,id){return new ca(k,H,Y,za,Va,Pb,Ac,void 0===id?
"":id)};M.prototype.z3c=function(k,H){return new D(k,H)};M.prototype.W5g=function(k,H,Y,za){return new F(k,H,Y,za)};M.prototype.g3c=function(k,H,Y,za){return new R(k,H,Y,za)};Object(Dd.a)(M,"SharedUIControlsFactory",null,[777]);var Oc=gg.a;Am(z,Oc);z.prototype.create=function(){Ke.EwaSettings.em()?this.Eb(this.$.da.Aa(12)||new M):this.Eb(new M)};z.ka=function(k){k.da.Ga(477,new z(k))};Object(Dd.a)(z,"SharedUIControlsFactoryServiceFactory",gg.a,[]);var Tc=b(1084),Md=gg.a;Am(B,Md);B.prototype.create=
function(){var k=this;nc.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");Tc.a.then(this.t8g(),function(H){k.Eb(H);return!0})};B.prototype.t8g=function(){var k=this;if(this.Q4b)return this.Q4b;var H=lf.a.OHa(Wb.b(),qd.a.none,"LoadResource","x10Scheduler loading");if(Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&Oj.a.uv){var Y=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();this.$.da.Ga(413,Y);H.setResult(Y);return this.Q4b=
H.task}this.$.da.$a(266,function(){k.$.da.$a(283,function(za){var Va=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();za=Yc.b(qh.Task.Sa(za.Jn));excelOnlineCalc.x10.ensureAllPluginsAttached(za).then(function(Pb){k.$.da.Ga(413,Va);H.setResult(Va);Ke.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&k.$.da.$a(491,function(Ac){Ac.pna.anyPluginInitialized=Pb})})})});return this.Q4b=H.task};B.ka=function(k){k.da.Ga(414,new B(k))};Object(Dd.a)(B,"PluginSchedulerFactory",
gg.a,[]);var Qd=b(239),Je=Jd.a;Am(E,Je);E.prototype.dispose=function(){this.Wp.dispose();this.$=null;Je.prototype.dispose.call(this)};E.prototype.domElement=function(k){return this.Wp.domElement(k)};E.prototype.getButton=function(k){return this.Wp.getButton(k,!1)};E.prototype.zOb=function(k,H){this.Wp.zOb(k,H,!1)};E.prototype.KAa=function(k,H){var Y=Oe.g(this.$),za=Y.rb.sj(k);this.Wp.zOb(H?Ae.a.instance.fa(1704):Ae.a.instance.fa(1705),za);H=this.isMac?H?Ae.a.instance.fa(1708):Ae.a.instance.fa(1709):
H?Ae.a.instance.fa(1706):Ae.a.instance.fa(1707);var Va=Y.qg(k,za);k=Y.Tf(za).zn;if(Va&&0<=Va.x&&0<=Va.y){var Pb=Va.bottomRight.x+this.Bz;Va=Va.topLeft.y-this.Bz-this.buttonWidth;if(Va<k.topLeft.y+this.Bz){if(Y.rb.oTa){this.hide();return}Va=k.topLeft.y+this.Bz}this.Ip(Pb,Va,Y.rtl,za);this.ariaLiveNotifier.VPa(H)}else this.hide()};E.prototype.Ip=function(k,H,Y,za){this.Wp.Ip(k,H,Y,za,!1)};E.prototype.hide=function(){this.Wp.hide()};Ek.Object.defineProperties(E.prototype,{Bz:{configurable:!0,enumerable:!0,
get:function(){return this.Wp.Bz}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.Wp.buttonWidth}}});Object(Dd.a)(E,"PulloutLaunchButton",Jd.a,[]);var kf=Jd.a;Am(y,kf);y.prototype.dispose=function(){this.gridView&&(this.gridView.ha.aX(this.Kg),this.gridView.view.Xq(this.tt),this.gridView.rc&&this.gridView.rc.fl(this.gj));if(this.$){var k=this.$;k.Sl(this.zd);k.rm(this.Yc);k.zD(this.fj);Oe.g(k).cx(this.PR)}this.rh&&this.rh.Lsc(this.rya);kg.a.Ha(this.Yh);this.rh=this.$=this.gridView=
this.vob=this.Yh=null;kf.prototype.dispose.call(this)};y.prototype.ky=function(){this.Yh.hide()};y.prototype.wda=function(){this.Yh?this.Yh.getButton(this.zea).Jbb():nc.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};y.prototype.Gfj=function(){this.B0=null};y.prototype.OIf=function(){this.Yh&&this.Yh.hide()};y.prototype.r_h=function(){if(!this.Whd||1!==this.selectedRange.width)return null;for(var k=this.selectedRange.clone();this.gridView.w5(k);){k.left+=
1;k.right+=1;if(!this.gridView.Tf(this.gridView.rb.sj(k)).Gh.Me(k))break;if(this.gridView.Ea.gs(k)){var H=this.gridView.vk("PulloutManager.GetValidatedRangeToFill",k,2);try{if(y.rUj(H))return k}finally{H&&H.dispose()}}}return null};y.prototype.Otc=function(){this.rh.Lbb()};y.prototype.showCallout=function(){var k=this;this.rwa&&(this.rh.azb?(this.Yh.getButton(this.zea).gGb(),Ke.EwaSettings.em()?Uf.TaskExtensions.Ba(rf.GetServiceTaskFactory.Va(this.$.da,8,9,0),function(H){k.B2f(H.result)},this.$.la,
3):this.B2f(this.contextMenuManager)):(this.gZc=!0,this.MZ()))};y.prototype.B2f=function(k){k.Ddd("tableFieldList").Q0(null,this.Yh.domElement(this.zea),this.rh,null,!0);this.Otc()};y.prototype.lTe=function(){if(!this.rwa||!this.gridView||this.gridView.ha.Oa.oc||!this.gridView.ha.sa.Ig)return null;var k=this.gridView.ha.sa.activeCell,H=Oe.g(this.$).rb.sj(k);if(!k)return null;this.tFa=k.clone();var Y=this.tableManager.rn(k);this.NLc=!!Y;if(this.oN){this.Yh.zOb(Ae.a.instance.fa(1704),H);this.cP=y.Oeg(Y);
if(!this.cP)return null;H=this.tableManager.uCe(Y,this.gridView);k=H.TY;H=H.returnValue||k;this.SEc=k;if(H)return this.cvc=new mj.Range(Y.top,Y.left,Y.bottom,Y.right,!1,!1),this.$Nc=new mj.Range(this.cP.top,this.cP.right+1,this.cP.top,this.cP.right+1,!1,!1),this.cP}else if(this.Whd){this.Yh.zOb(Ae.a.instance.fa(1705),H);this.DXa=this.gridView.ha.sa.qd.clone();Y=Oe.g(this.$).Rb.OMa(this.selectedRange);this.cP=y.Oeg(this.selectedRange);if(!Y||!this.cP||!this.selectedRange||Ke.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",
!1)&&this.tableManager.uva(this.selectedRange))return null;this.$Nc=this.r_h();if((Ke.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.w5(this.selectedRange):this.gridView.w5(this.cP))&&this.eya)return this.cvc=this.cP,Y=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",this.eya?this.eya.toString():"null",this.cP?this.cP.toString():"null",k?k.toString():"null"),nc.ULS.sendTraceTag(537154137,
0,50,Y),this.cP}return null};y.prototype.MZ=function(){this.oN?this.rh.MZ(ve.v(this.eya,this.$),!1,!0):Ke.EwaSettings.ma(136)&&this.rh.MZ(ve.v(this.selectedRange,this.$),!0,!1)};y.prototype.H6a=function(){return this.$.ea.isNamedObjectViewMode&&Yf.f(this.$.qa)};y.rUj=function(k){for(;k.$$mn();)if(k.$$cu().text||k.$$cu().rF||k.$$cu().Ai||k.to.I6e)return!1;return!0};y.Oeg=function(k){return k.right===Qc.a.Qh?null:new mj.Range(k.top,k.right,k.top,k.right,!1,!1)};Ek.Object.defineProperties(y.prototype,
{uc:{configurable:!0,enumerable:!0,get:function(){return this.Yh.domElement(1)}},eya:{configurable:!0,enumerable:!0,get:function(){return this.$Nc}},selectedRange:{configurable:!0,enumerable:!0,get:function(){return this.DXa}},oN:{configurable:!0,enumerable:!0,get:function(){return this.NLc}},sJf:{configurable:!0,enumerable:!0,get:function(){return this.hee}},xBb:{configurable:!0,enumerable:!0,get:function(){var k=this.Yh.domElement(this.zea);return k?Kc.DOMElementExtensions.isVisible(k):!1}},rwa:{configurable:!0,
enumerable:!0,get:function(){return this.$.isEditMode&&Ke.EwaSettings.ma(136)?!(new Af.a(this.$.xa)).uj:!1}},DHg:{configurable:!0,enumerable:!0,get:function(){return this.SEc}},zea:{configurable:!0,enumerable:!0,get:function(){return this.eya?this.gridView.rb.sj(this.cP):1}}});Object(Dd.a)(y,"PulloutManager",Jd.a,[772,3]);var xf=gg.a;Am(t,xf);t.prototype.create=function(){var k=this;Sf.a.Fa(function(H){var Y=rf.GetServiceTaskFactory.Va(H.da,12,477,k.ub),za=rf.GetServiceTaskFactory.Va(H.da,66,134,
k.ub),Va=rf.GetServiceTaskFactory.Va(H.da,211,212,k.ub),Pb=Qd.a.Sa(null),Ac=!Ke.EwaSettings.em();Ac&&(Pb=rf.GetServiceTaskFactory.Va(H.da,8,9,k.ub));Uf.TaskExtensions.Ba(Uf.TaskExtensions.ye([Y,za,Pb,Va],H.la),function(){Ac?k.Eb(k.$.da.Aa(261)||new y(k.$,Y.result,za.result,Pb.result,Va.result)):k.Eb(k.$.da.Aa(261)||new y(k.$,Y.result,za.result,null,Va.result))},H.la)})};t.ka=function(k){k.da.Ga(262,new t(k))};Object(Dd.a)(t,"PulloutManagerFactory",gg.a,[]);var og={average:0,max:0,median:0,P75:0,P95:0},
Ug={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0},kh={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},Yi={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,
argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0},Ah={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0},yi={dialogCommitedCounter:0,dialogShownCounter:0},Ki={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},og),excludingFirstAction:Object.assign({},og)},Rj={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,
smartFormulaBarAutoCompleteFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0},ej={customFunction:{committedCounter:0,shownCounter:0},function:{committedCounter:0,shownCounter:0},lambda:{committedCounter:0,shownCounter:0},letVariable:{committedCounter:0,shownCounter:0},namedRange:{committedCounter:0,shownCounter:0},richEntity:{committedCounter:0,shownCounter:0},table:{committedCounter:0,shownCounter:0},tableHeader:{committedCounter:0,
shownCounter:0},tableSpecialStructRef:{committedCounter:0,shownCounter:0}};u.prototype.ESa=function(){this.elc=ff.a.Ta.oe.m};u.prototype.wia=function(k){-1!==this.elc&&(k?(this.gnb(ff.a.Ta.oe.m-this.elc),this.elc=-1):this.e0.failedCount++)};u.prototype.pAh=function(){this.e0.excludingFirstAction=u.OSe(this.z7b);this.z7b.push(this.e0.firstAction);this.e0.includingFirstAction=u.OSe(this.z7b)};u.prototype.gnb=function(k){var H=this;this.e0.count?1E3>this.e0.count&&this.z7b.push(k):this.e0.firstAction=
k;this.Mpf&&this.Npf&&this.Npf.forEach(function(Y){k>Y&&H.e0.countAboveThresholds[Y]++});this.e0.count++};u.OSe=function(k){var H=Object.assign({},og);0<k.length&&(Id.i(k),H.median=k[Math.floor(.5*k.length)],H.P75=k[Math.floor(.75*k.length)],H.P95=k[Math.floor(.95*k.length)],H.max=k[k.length-1],H.average=Id.g(k,function(Y){return Y})/k.length);return H};Object(Dd.a)(u,"PerformanceMeasurement",null,[]);var tj=b(41),fk=b(98),pk;(function(k){k[k.function=3]="function";k[k.namedRange=100]="namedRange";
k[k.tableHeader=101]="tableHeader";k[k.letVariable=102]="letVariable";k[k.richEntity=103]="richEntity";k[k.lambda=104]="lambda";k[k.customFunction=105]="customFunction";k[k.table=106]="table";k[k.tableSpecialStructRef=107]="tableSpecialStructRef"})(pk||(pk={}));Object(Dd.b)("CompletionItemKind",pk);var qk={},Fj=(qk.argumentAssistanceOverall=[50,80,100,130,150,170,200],qk.autoCompleteOverall=[50,80,100,130,150,170,200],qk);v.prototype.L7=function(k){var H=this;k.forEach(function(Y){H.L$a.xb(Y)||H.L$a.ia(Y,
new u(Fj[Y]));H.L$a.oa(Y).ESa()})};v.prototype.vZ=function(k,H){var Y=this;H=void 0===H?!0:H;k.forEach(function(za){Y.L$a.xb(za)&&Y.L$a.oa(za).wia(H)})};v.prototype.JXf=function(k){var H="Undefined";switch(k){case 1:H="Collapsed";break;case 0:H="Expanded";break;case 2:H="Hidden"}this.d$.argumentAssistanceCardInitialMode=H};v.prototype.V7b=function(k){var H=this;window.requestAnimationFrame(function(){H.vZ([k])})};v.prototype.w9e=function(k){var H=this;k.forEach(function(Y){H.RXc[pk[Y.kind]].shownCounter++})};
v.prototype.v9e=function(k){this.RXc[pk[k]].committedCounter++};v.prototype.getJsonForLogging=function(){return"{"+this.IU("SessionDetails",this.pna)+","+this.IU("ArgumentAssistanceUsage",this.d$)+","+this.IU("FormulaSuggestionsUsage",this.u4)+","+this.IU("FunctionDialogUsage",this.gcd)+","+this.IU("AutocompleteCardInteraction",this.SY)+","+this.IU("AutocompleteRenderOptimization",this.Job)+","+this.IU("AutocompleteUsageByKind",this.RXc)+","+this.YWh()+"}"};v.prototype.gsj=function(){this.pna.argumentAssistanceFlight=
this.uvb("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.pna.autoCompleteUIFlight=this.uvb("Microsoft.Office.Excel.","AutoCompleteNewUI");this.pna.smartFormulaBarAutoCompleteFlight=this.uvb("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.pna.formulaAssistanceRedesignFlight=this.uvb("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.pna.NewInsertFunctionDialogFlight=this.uvb("Microsoft.Office.Excel.","NewInsertFunctionDialog")};v.prototype.YWh=
function(){for(var k=new rb.a,H=El(this.L$a),Y=H.next();!Y.done;Y=H.next())Y=Y.value,Y.value.pAh(),k.add(String.format('"{0}":{1}',Y.key,Xd.a.Kc(Y.value.e0)));return String.format('"PerfMeasurements": {{{0}}}',k.toArray().join(","))};v.prototype.uvb=function(k,H){return S.a.contains(this.$.ya.FlightHolder.FlightId,H,!0)?Ke.EwaSettings.getBooleanFeatureGate(k+H,!1)?"T":"C":"None"};v.prototype.IU=function(k,H){return String.format('"{0}":{1}',k.toString(),tj.c(H))};Object(Dd.a)(v,"FormulaAssistanceTelemetryManager",
null,[776]);var ul=gg.a;Am(n,ul);n.ka=function(k){k.da.Ga(492,new n(k))};n.prototype.create=function(){var k;this.Eb(null!==(k=this.$.da.Aa(491))&&void 0!==k?k:this.$.da.Ga(491,new v(this.$)))};Object(Dd.a)(n,"FormulaAssistanceTelemetryManagerFactory",gg.a,[]);w.prototype.Zc=function(){return!1};w.prototype.executeCommand=function(k,H){k=!1;H=H.command;switch(H){case 1910465940:k=!0}return k?qh.Task.Sa(!0):Qg.a(H)};w.prototype.Lc=function(k,H){switch(H.command){case 1910465940:return!0;default:return!1}};
w.prototype.jd=function(){return!1};Object(Dd.a)(w,"NameManagerCommandHandler",null,[429]);var vl=oc.a;Am(h,vl);h.prototype.Nd=function(){this.Cd([new w(this.$)])};h.ka=function(k){oc.a.fe(493,new h(k))};Object(Dd.a)(h,"NameManagerCommandHandlerFactory",oc.a,[]);var xl=b(408);Object(Dd.a)(r,"GestureAdapterInfo",null,[]);var wl=b(391),yl=b(232);m.prototype.esi=function(){if(!this.GHc){var k="hammer.min.js";Vg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseIsServerFlavorAppSetting",
!1)&&(k=Vg.AFrameworkApplication.ga.ra("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");k=Vg.AFrameworkApplication.tO(String.format("{0}",k),5);k=yl.a.create(k,null,null);wl.a.xia(k);this.GHc=k.i8a}return this.GHc};Ek.Object.defineProperties(m,{instance:{configurable:!0,enumerable:!0,get:function(){m.Ma||(m.Ma=new m);return m.Ma}}});m.Ma=null;Object(Dd.a)(m,"HammerJsDependencyLoader",null,[557]);var hl;(function(k){k[k.none=-1]="none";k[k.pinch=0]="pinch";k[k.pan=1]="pan";k[k.swipe=2]="swipe"})(hl||
(hl={}));Object(Dd.b)("GestureEvent",hl);var zl=b(73),Al=zl.a;Am(l,Al);l.create=function(k,H,Y,za,Va,Pb){if(Y.rawEvent)if(Pb){var Ac=Y.rawEvent;Ac=new Sys.UI.Point(Ac.clientX,Ac.clientY)}else Ac=zl.a.bvb(Y);else Ac=new Sys.UI.Point(Y.clientX,Y.clientY);return new l(k,Ac,H,Y,za,Va,Y.shiftKey,Y.ctrlKey,Pb)};Ek.Object.defineProperties(l.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.kga}},ctrlKey:{configurable:!0,enumerable:!0,get:function(){return this.aY}},clientPoint:{configurable:!0,
enumerable:!0,get:function(){return this.mhb}},Sua:{configurable:!0,enumerable:!0,get:function(){return this.Log}}});Object(Dd.a)(l,"GestureEventArgs",zl.a,[]);Object(Dd.a)(f,"GestureManagerData",null,[]);e.Xig=2;e.Yig=4;e.Zig=8;e.$ig=8;Object(Dd.a)(e,"HammerConstants",null,[]);var Bl=b(209),Cl=Pi.a;Am(c,Cl);c.prototype.BPh=function(){return this.bPc?0:this.qie?1:2};c.prototype.sn=function(k){Cl.prototype.sn.call(this,k);this.Wd.fka(this.ZVa,k,0,this.ykb)};c.prototype.im=function(k){Cl.prototype.im.call(this,
k);this.Wd.mIa(k,this.ZVa)};c.prototype.C7i=function(k,H,Y){var za=this;Y=void 0===Y?null:Y;var Va=void 0===Va?null:Va;Vg.AFrameworkApplication.hhc()?m.instance.esi().continueWith(function(Pb){za.lEj();if(Pb.ig||Pb.Oh)nc.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",Pb.status);else{nc.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Pb.status);if(za.j3d){Pb=window.Hammer;if("undefined"===typeof Pb){nc.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");
za.Zyc();return}if("undefined"===typeof Pb.inputHandler){nc.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");za.Zyc();return}}if(!k)throw za.Zyc(),Error.argumentNull("source element can not be null");Pb=Bl.a.pva(k,za.eqa);if(void 0===Pb||null===Pb)Pb=new fk.a,Bl.a.Ocb(k,za.eqa,Pb),za.D7i(k);var Ac=null;if(!Pb.xb(hl[0])){Ac=Object;var id=Ac.assign,Ld=new r,ld=hl[0],ef=Va;ef=void 0===ef?null:ef;if(void 0===za||null===za)throw nc.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),
Error.argumentNull("manager can not be null");var Jf=null;switch(ld){case Eg.a.pinch:Jf=new Hammer.Pinch(ef);break;case Eg.a.pan:Jf=new Hammer.Pan(ef)}Jf&&(Jf.manager=za);Ac=id.call(Ac,Ld,{cda:Jf,bWe:H});Pb.add(hl[0],Ac)}if(void 0!==Y&&null!==Y)for(id=0;id<Y.length;id++)Pb.xb(hl[Y[id]])&&(Ld=Pb.oa(hl[Y[id]]),Ac.cda.recognizeWith(Ld.cda))}za.Zyc()}):nc.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};c.prototype.lEj=function(){this.uJc&&(this.Dh?
this.KRc=this.Dh.Gc("Task","RegisterGestureAdapterAfterLoad"):nc.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))};c.prototype.Zyc=function(){this.uJc&&(this.KRc?this.KRc.stop():nc.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};c.prototype.D7i=function(k){this.Mog.add(k);this.Wd.fka(this.ZVa,k,0,this.ykb)};c.prototype.recognize=function(k){for(var H=Array(k.pointers.length),Y=0;Y<k.pointers.length;Y++)H[Y]=k.pointers[Y].target;Y=null;for(this.Bpa=
this.QRh(H);void 0!==this.Bpa&&null!==this.Bpa&&(Y=Bl.a.pva(this.Bpa,this.eqa),void 0===Y||null===Y);this.Bpa=this.Bpa.parentNode);if(void 0!==Y&&null!==Y){this.curRecognizer&&this.curRecognizer.state===e.$ig&&(this.curRecognizer=null);H=El(Y.keys);for(var za=H.next();!za.done;za=H.next()){za=Y.oa(za.value);void 0!==za&&null!==za&&void 0!==za.cda&&null!==za.cda&&(void 0===this.curRecognizer||null===this.curRecognizer||za.cda===this.curRecognizer||za.cda.canRecognizeWith(this.curRecognizer))&&za.cda.recognize(k);
var Va=za.cda.state;this.curRecognizer||e.Xig!==Va&&e.Yig!==Va&&e.Zig!==Va||(this.curRecognizer=za.cda)}}};c.prototype.emit=function(k,H){if("hammer.input"!==k){this.V8=!1;H=l.create(k,this.Bpa,H.srcEvent,H,3,this.bPc);var Y=Bl.a.pva(this.Bpa,this.eqa);if(this.hki(k))var za=0;else if(this.Yji(k))za=1;else if(this.Smi(k))za=2;else{nc.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}Y=Y.Nc(hl[za]).value;void 0!==Y&&null!==Y&&((Y=Y.bWe,Y.Thi())?k.endsWith("start")?
this.V8=Y.jKi(H):k.endsWith("end")?(Y.hKi(H),this.V8=!0):k.endsWith("cancel")?(Y.gKi(H),this.V8=!0):k.endsWith("move")&&(this.V8=Y.iKi(H)):nc.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",k))}};c.prototype.get=function(k){return Object(Pa.a)(Hammer.Recognizer,k)};c.prototype.QRh=function(k){if(1>k.length)return null;if(1===k.length)return k[0];for(var H=k[0],Y=!0,za=1;za<k.length;za++){if(!k[za])return null;if(H!==k[za]){Y=!1;break}}if(Y)return H;H=this.uWe(k[0]);Y=
0;k=El(k);for(za=k.next();!za.done;za=k.next()){za=this.uWe(za.value);if(H.oa(H.count-1)!==za.oa(za.count-1))return null;for(var Va=H.count-2,Pb=za.count-2;Va>=Y&&0<=Pb;Va--,Pb--)if(H.oa(Va)!==za.oa(Pb)){Y=Va+1;break}}return H.oa(Y)};c.prototype.uWe=function(k){for(var H=new rb.a;void 0!==k&&null!==k;k=k.parentNode)H.add(k);return H};c.prototype.VZe=function(k){switch(k){case Eg.a.Kf:case Eg.a.pha:return 1;case Eg.a.yg:case Eg.a.qha:return 2;case Eg.a.De:case Eg.a.EGa:return 4;case Eg.a.EAc:case Eg.a.LYc:return 8}return 0};
c.prototype.Lya=function(k,H,Y){k=this.VZe(k);H=this.BQh(Y);Hammer.inputHandler(this,k,H);this.V8&&Y.preventDefault();return this.V8};c.prototype.h6e=function(){return 1<this.BT.count};c.prototype.M1b=function(){nc.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.rmb)for(var k=El(this.BT),H=k.next();!H.done;H=k.next())this.ROf(H.value.key);else this.BT=new fk.a;this.session=null};c.prototype.BBg=function(k,H,Y){nc.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",
k);if(!this.Skb.xb(k)){try{H.setPointerCapture(k)}catch(za){nc.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",za)}this.Skb.add(k,H)}this.BT.ia(k,Y);this.bVa&&1<this.BT.count&&this.lfa&&!this.lfa.Ipb&&(this.lfa.Ipb=!0)};c.prototype.ROf=function(k){nc.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",k);if(this.Skb.xb(k)){try{this.Skb.oa(k).releasePointerCapture(k)}catch(H){nc.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",H)}this.Skb.remove(k)}else nc.ULS.sendTraceTag(594055955,
310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",k);this.BT.remove(k);this.bVa&&1>=this.BT.count&&this.lfa&&this.lfa.Ipb&&(this.lfa.Ipb=!1)};c.prototype.eoc=function(k,H,Y){var za=Y.rawEvent.pointerType.toString(),Va=Y.rawEvent.pointerId.toString();if("touch"!==za)return!1;k=this.VZe(k);if(1!==k&&!this.BT.xb(Va))return!1;this.p3d&&1===k&&Y.rawEvent.isPrimary&&this.BT.count&&(nc.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.M1b());this.rmb?this.BBg(Va,H,
Y):this.BT.ia(Va,Y);this.YMc&&2===k&&(!this.qGc||this.qGc&&"function"===typeof Y.rawEvent.getCoalescedEvents)&&(H=Y.rawEvent.getCoalescedEvents())&&this.h6e()&&(this.$jb=Math.max(this.$jb,H.length));this.Tee&&(this.V8=!1);za=this.AQh(this.BT,Y,za);Hammer.inputHandler(this,k,za);if(4===k||8===k)this.rmb?this.ROf(Va):this.BT.remove(Va),this.BT.count||(this.session=null,this.YMc&&-1!==this.$jb&&(nc.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.$jb),this.$jb=-1));this.V8&&
Y.preventDefault();return this.V8};c.prototype.Pnc=function(){return!1};c.prototype.BQh=function(k){var H=new f,Y=k.rawEvent,za=Y.touches;Y=Y.changedTouches;H.pointers=Array.clone(za);H.pointers=Array.clone(0<za.length?za:Y);H.changedPointers=Array.clone(Y);H.srcEvent=k;H.pointerType="touch";return H};c.prototype.AQh=function(k,H,Y){var za=new f;za.pointers=ja.toArray(k.values);za.changedPointers=[H];za.pointerType=Y;za.srcEvent=H;return za};c.prototype.hki=function(k){return Lg.a.startsWith(k,Eg.a.pinch)};
c.prototype.Yji=function(k){return Lg.a.startsWith(k,Eg.a.pan)};c.prototype.Smi=function(k){return Lg.a.startsWith(k,Eg.a.swipe)};Object(Dd.a)(c,"GestureInputManager",Pi.a,[530,531]);a.prototype.ei=function(k){k.register(c,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").Hc().Oc(function(){return new c(bi.a.instance,Vg.AFrameworkApplication.ta.JD)});this.tb=k};a.prototype.init=function(){this.tx||(this.tb.resolve("Common.App.GestureManager.GestureInputManager"),this.tx=
!0)};a.prototype.dispose=function(){};a.main=function(){Sh.a.instance.hj(new a)};Ek.Object.defineProperties(a.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});Object(Dd.a)(a,"GestureInputManagerPackage",null,[4,5]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");bg.a.Ki('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;-ms-touch-action:manipulation;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}');
Sf.a.Fa(ad.ka);Sf.a.Fa(bb.ka);Type.registerNamespace("Common.App.MultitabControl");Type.registerNamespace("CAUI");Ne.main();bg.a.Ki(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}");
(function(){dh.initData();Sf.a.Fa(function(k){Cf.ka(k);Od.ka(k);dh.ka(k);Td.ka(k)})})();bg.a.Ki(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}");
bg.a.Ki(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}");
Sf.a.Fa(dg.ka);Sf.a.Fa(pf.ka);Sf.a.Fa(Hd.ka);bg.a.Ki(".ewa-facp-text-box{position:absolute}");(function(){Sf.a.Fa(function(k){$d.ka(k)})})();(function(){Sf.a.Fa(function(k){pd.ka(k)})})();Sf.a.Fa(Ud.ka);Sf.a.Fa(Hc.ka);Sf.a.Fa(pc.ka);bg.a.Ki('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
Sf.a.Fa(Vb.ka);Sf.a.Fa(wa.ka);(function(){Sf.a.Fa(function(k){k.da.Ga(150,new Mb(k))})})();(function(){Sf.a.Fa(function(k){$a.ka(k);Uc.ka(k);W.ka(k)})})();Sf.a.Fa(z.ka);(function(){Sf.a.Fa(function(k){B.ka(k)})})();(function(){Sf.a.Fa(function(k){k.ma(136)&&t.ka(k)})})();(function(){Sf.a.Fa(function(k){h.ka(k)})})();Type.registerNamespace("Common.App.GestureManager");a.main();(function(){Sf.a.Fa(function(k){n.ka(k)})})()},929:function(x,C,b){function a(ka,ma,pa,xa,va,ta,fa,Ca,Sa,Gb,kb,lb){var Nb=
W.call(this)||this;Nb.glc=!1;Nb.contextMenuController=null;Nb.$Ic=null;Nb.lGc=null;Nb.Bod=!1;Nb.WZj=0;Nb.VZj=0;Nb.rsb=null;Nb.ouc=null;Nb.IC=function(){Nb.contextMenuController?Nb.contextMenuController.IC():e.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");Nb.fbg()};Nb.wb=ka;Nb.wpf=va;Nb.cQc=Gb;Nb.dZj=pa;Nb.cZj=xa;Nb.HYj=ma;Nb.IGf=ta;Nb.populateOnlyOnce=fa;Nb.J4h=kb;Nb.tNf(lb);return Nb}b.d(C,"a",
function(){return a});x=b(0);var c=b(7),e=b(14),f=b(625),l=b(90),m=b(24),r=b(623),h=b(392),w=b(653),n=b(632),v=b(112),u=b(275),t=b(85),y=b(438),E=b(1434);C=b(76);var B=b(19),z=b(5),M=b(1048),Q=b(79),P=b(46),L=b(59),ca=b(150),U=b(121),aa=b(1),F=b(10),D=b(21),J=b(15),R=b(22),Z=b(33),W=C.a;Am(a,W);a.prototype.Zc=function(ka,ma){ka=!0;switch(ma){case 1651433993:case 1675506831:case 966232027:ka=this.me(4096)||this.me(2048);break;case 2045563128:ka=this.me(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:ka=
this.me(8192)}return!ka};a.prototype.jd=function(ka,ma,pa){pa.IsShadowMenuOpen||M.h(this.$,M.d);ka=!1;ma===this.Xw&&(pa.IsShadowMenuOpen||M.h(this.$,M.a),ma=Object(c.a)(new f.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.WDd(ma,pa.IsShadowMenuOpen),pa.MenuItems=ma,pa.IsShadowMenuOpen||M.h(this.$,M.c),ka=!0);ka&&this.glc&&F.HelperMethods.Z0b&&!pa.IsShadowMenuOpen&&M.j(this.$);return ka};a.prototype.WDd=function(ka,ma){(ma=this.iZ(ma))?(this.E8e(ma),Array.addRange(ka.MenuSectionList,
ma.oC().MenuSectionList),this.UBg(ka)):e.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};a.prototype.iZ=function(){e.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.Q0=function(ka,ma,pa,xa,va){ka=Sys.UI.DomElement.getBounds(ma);pa=new Sys.UI.Point(ka.x,ka.y+ka.height);this.HTa(pa,ma);this.$.isChromeRtl&&
(pa.x+=ka.width);this.Ip(pa,va)};a.prototype.Ip=function(ka,ma,pa){pa=void 0===pa?0:pa;ma&&(ka=Z.a(this.$).Aja(ka));ma=!0;if(this.J4h){var xa;3===pa?(xa=this.gKa(3))&&0<xa.length?(ma=!1,this.showFloatie(xa,new Sys.UI.Bounds(ka.x,ka.y,0,0),pa)):e.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",this.menuId):2===pa&&this.$.isEditMode&&((xa=this.gKa(2))&&0<xa.length?xa[0]!==
a.VTe?(ma=!1,this.SRd(xa,new Sys.UI.Bounds(ka.x,ka.y,0,0),pa)):e.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",this.menuId):e.ULS.sendTraceTag(537167073,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}ma&&this.showContextMenu(new Sys.UI.Bounds(ka.x,ka.y,0,0),pa)};a.prototype.gKa=function(){return null};a.prototype.egd=
function(ka,ma){var pa="";3===ka?pa="touch":2===ka&&(pa="mouse");ka={};return ka.ContextMenuId=this.menuId,ka.IsEditMode=this.$.isEditMode,ka.IsSLR=!!L.a.Fg&&L.a.Fg.sK,ka.IsReactMLR=!!L.a.Fg&&L.a.Fg.cW,ka.IsNov=this.$.ea.isNamedObjectViewMode,ka.InputType=pa,ka.FloatieGroups=JSON.stringify(void 0===ma?null:ma),ka};a.prototype.showContextMenu=function(ka,ma){ma=void 0===ma?0:ma;var pa=this.egd(ma);e.ULS.sendTraceTag(595359709,0,50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",
JSON.stringify(pa));this.contextMenuController?this.JB!==z.a.IGd&&this.JB!==z.a.JGd||0===ma?this.contextMenuController.RRd(this.JB,ka,Q.a.Ub):this.contextMenuController.RRd(this.JB,ka,ma):e.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};a.prototype.showFloatie=function(ka,ma,pa){var xa=this.egd(pa,ka);e.ULS.sendTraceTag(595359710,0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",
JSON.stringify(xa));this.contextMenuController?(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.zNf(),this.contextMenuController.Pxc(ka,ma,pa)):e.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",JSON.stringify(ka))};a.prototype.SRd=function(ka,ma,pa){var xa=this.egd(pa,ka);e.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",
JSON.stringify(xa));this.contextMenuController?(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.zNf(),this.contextMenuController.QRd(ka,ma,pa,this.JB)):e.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};a.prototype.tNf=function(ka){this.contextMenuController=ka};a.prototype.dispose=function(){this.$&&this.$.Ka.ebb(this);this.wb=null;
aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.fbg();this.ouc&&(l.a.Ha(this.ouc),this.ouc=null);W.prototype.dispose.call(this)};a.prototype.CFh=function(ka){var ma=this.$.da.Aa(204);ma&&(ma=ma.jGh(this.wpf))&&ka.Ec.push(ma)};a.prototype.HTa=function(ka,ma){ka&&ma&&this.$.ea.xc.isDivSyndicated&&m.a.xf&&(ma=ma.ownerDocument.documentElement,ka.x-=ma.scrollLeft,ka.y-=ma.scrollTop)};a.prototype.me=function(ka){return(new ca.a(this.$.xa)).me(ka)};a.prototype.E8e=
function(ka){ka=El(ka.Ec);for(var ma=ka.next();!ma.done;ma=ka.next())if(ma=ma.value,Object(y.a)(564,ma)){ma.title&&(ma.title=a.fg(ma.title));ma=El(ma.buttons);for(var pa=ma.next();!pa.done;pa=ma.next())pa=pa.value,Object(y.a)(575,pa)?(pa.label=a.fg(pa.label),pa.xS(a.fg(pa.alt))):Object(y.a)(573,pa)&&this.E8e(pa.menu)}};a.prototype.tpf=function(ka,ma){ma=void 0===ma?!1:ma;var pa=[];ka=El(ka);for(var xa=ka.next();!xa.done;xa=ka.next())pa.push(this.NU(xa.value,ma));return pa};a.prototype.NU=function(ka){for(var ma=
[],pa=El(ka.MenuItems),xa=pa.next();!xa.done;xa=pa.next())switch(xa=xa.value,xa.Type){case 3:ma.push(this.G4g(xa));break;case 2:ma.push(this.p$g(xa));break;case 1:ma.push(this.f6g(xa))}return Object(c.a)(new r.a,{ControlList:ma,Title:ka.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})};a.prototype.xcd=function(ka,ma){ma=[this.rsb,ka.RibbonCommand.toString(),ma?this.zZe(ma):this.zZe(ka.Label),ka.Disabled?ka.Disabled.toString():
"False"];var pa=ka.CommandData;pa=D.a.hashCode(pa).toString();ma.push(pa,ka.Identifier.toString());ma=ma.join("_");ka.IsChecked&&(ma+="_Checked");return ma};a.prototype.kGh=function(ka){var ma=[this.rsb,D.a.hashCode(ka.Title).toString()];ka=El(ka.MenuItems);for(var pa=ka.next();!pa.done;pa=ka.next())ma.push(pa.value.RibbonCommand.toString());return ma.join("_")};a.prototype.HVe=function(ka){var ma=ka.Label;ma=D.a.hashCode(ma).toString();ma=[this.rsb,ma];aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&
ka.Id&&ma.push(D.a.hashCode(ka.Id).toString());ma=ma.join("_");ka.IsChecked&&(ma+="_Checked");return ma};a.prototype.G4g=function(ka){var ma=this.V$b(ka,!1);var pa=ma.label;var xa=ma.sLa;ma=ma.Er;var va=this.xcd(ka,pa);return Object(c.a)(new h.a,{Command:ka.Disabled?(-251203935).toString():ma.toString(),ExternalId:va,Id:va,Image16by16Class:xa,LabelText:pa||ka.Label,MenuItemId:ka.CommandData,CommandValueId:ka.CommandData})};a.prototype.p$g=function(ka){var ma=this.V$b(ka,ka.IsChecked);var pa=ma.label;
var xa=ma.sLa;ma=ma.Er;var va=this.xcd(ka,pa);return Object(c.a)(new w.a,{Command:ka.Disabled?(-251203935).toString():ma.toString(),ExternalId:va,Id:va,Image16by16Class:xa,LabelText:pa||ka.Label,MenuItemId:ka.CommandData,CommandValueId:ka.CommandData,IsChecked:ka.IsChecked})};a.prototype.f6g=function(ka){var ma=this.RVe(ka);var pa=ma.label;ma=ma.sLa;var xa=Object(c.a)(new f.a,{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(xa.MenuSectionList,this.tpf(ka.SubMenu.Sections,!0));var va=this.HVe(ka);
ka=pa||ka.Label;return Object(c.a)(new n.a,{ExternalId:va,Id:va,LabelText:ka,PopulateOnlyOnce:!1,Menu:xa,Image16by16Class:ma,ImageIsVisible:!!ma})};a.prototype.RVe=function(ka){ka=this.V$b(ka,!0);return{label:ka.label,sLa:ka.sLa,Er:ka.Er}};a.prototype.V$b=function(ka,ma){switch(ka.Identifier){case 26:var pa=912804500;ma=B.a.bQe;ka=J.a.instance.fa(1912);break;case 3:pa=-1902148570;ma=ma?B.a.maa:null;ka=J.a.instance.fa(1872);break;case 4:pa=-1902148570;ma=ma?B.a.maa:null;ka=J.a.instance.fa(1873);break;
case 5:pa=-1902148570;ma=ma?B.a.maa:null;ka=null;break;case 1:pa=-1677817820;ma=B.a.J8b;ka=J.a.instance.fa(234);break;case 2:pa=-1649376918;ma=ka.IsChecked?B.a.uua:null;ka=J.a.instance.fa(2075);break;case 23:pa=1701016594;ma=ka.IsChecked?B.a.uua:null;ka=J.a.instance.fa(2075);break;case 6:pa=-87741481;ma=null;ka=J.a.instance.fa(2076);break;case 7:pa=1948650742;ma=B.a.QOe;ka=J.a.instance.fa(1910);break;case 8:pa=1933713114;ma=B.a.POe;ka=J.a.instance.fa(1911);break;case 14:pa=504133448;ma=B.a.$Ia;ka=
J.a.instance.fa(144);break;case 30:pa=504133448;ma=B.a.$Ia;ka=J.a.instance.fa(148);break;case 32:pa=504133448;ma=B.a.$Ia;ka=J.a.instance.fa(150);break;case 34:pa=504133448;ma=B.a.$Ia;ka=J.a.instance.fa(152);break;case 27:pa=1701016594;ma=ma?B.a.L8b:B.a.$Ia;ka=J.a.instance.fa(144);break;case 15:pa=-798968736;ma=B.a.aJa;ka=J.a.instance.fa(146);break;case 31:pa=-798968736;ma=B.a.aJa;ka=J.a.instance.fa(149);break;case 33:pa=-798968736;ma=B.a.aJa;ka=J.a.instance.fa(151);break;case 35:pa=-798968736;ma=
B.a.aJa;ka=J.a.instance.fa(153);break;case 28:pa=1701016594;ma=ma?B.a.M8b:B.a.aJa;ka=J.a.instance.fa(146);break;case 21:pa=-2058042992;ma=B.a.s2a;ka=null;break;case 29:pa=1701016594;ma=B.a.s2a;ka=null;break;case 9:pa=1701016594;ka=ma=null;break;case 11:pa=-1494291901;ka=ma=null;break;case 25:pa=-1045020714;ma=ka.IsChecked?B.a.uua:null;ka=null;break;case 13:pa=1701016594;ma=ka.IsChecked?B.a.uua:null;ka=J.a.instance.fa(155);break;case 16:pa=1701016594;ma=B.a.ttb;ka=J.a.instance.fa(1048);break;case 17:pa=
1701016594;ma=B.a.r2a;ka=null;break;case 18:pa=1701016594;ma=B.a.q2a;ka=null;break;case 19:pa=1701016594;ma=B.a.D8b;ka=J.a.instance.fa(1053);break;case 20:pa=1701016594;ma=B.a.w9c;ka=J.a.instance.fa(1054);break;case 24:pa=1675506831;ka=ma=null;break;case 22:pa=ka.RibbonCommand;ma=ka.IsChecked?B.a.maa:null;ka=null;break;case 36:pa=1461300262;ma=null;ka=J.a.instance.fa(154);break;case 38:pa=ka.RibbonCommand;ma=B.a.N8b;ka=J.a.instance.fa(1783);break;default:e.ULS.shipAssertTag(537167069,0,!1,"Unable to map menu item: {0}",
JSON.stringify(ka)),pa=1461300262,ka=ma=null}return{label:ka,sLa:ma,Er:pa}};a.prototype.zZe=function(ka){return aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6130289_FixLoggingColumnNameInButtonId")?D.a.hashCode(ka+F.HelperMethods.Bnj).toString():ka};a.prototype.UBg=function(ka){if(!this.$.ea.amIAlone){var ma=this.$.da.Aa(25);if((void 0!==ma&&null!==ma||!aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!v.a.isEmpty(ma.SBa)&&(ma=ma.G_h(),!u.a.Fh(ma))){var pa=[];t.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").F8g(ma,
pa);Array.addRange(ka.MenuSectionList,pa)}}};a.prototype.zNf=function(){this.Bod||(this.uub&&this.uub.zZb(this.IC),this.Qpb&&this.Qpb.zZb(this.IC),this.Bod=!!this.uub||!!this.Qpb)};a.prototype.fbg=function(){this.uub&&this.uub.Tsc(this.IC);this.Qpb&&this.Qpb.Tsc(this.IC);this.Bod=!1};a.Hnd=function(ka,ma){ma=P.C(ma);ka=R.g(ka).Ea.$3a(ma);return!(null===ka||void 0===ka||!ka.mk)};a.Edd=function(ka,ma,pa){ma=P.C(ma);var xa=R.g(ka).Ea.$3a(ma);ma=R.g(ka).getCellBounds(xa);var va=xa.BMg;xa=xa.AMg;var ta=
ma.x+va.x;ma=ma.y+va.y;pa&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(R.g(ka).rtl||(ta+=xa),ma-=xa);return new Sys.UI.Point(ta,ma)};a.dxh=function(ka){try{Object(E.a)(ka.CommandValueId)}catch(ma){}};a.fg=function(ka){var ma=a.E1a.parseFromString(ka,"text/html");return ma?ma.body.innerText:(e.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),ka)};Ek.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.ouc}},
$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Ra:{configurable:!0,enumerable:!0,get:function(){return this.cQc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.Mb+this.wpf}},uub:{configurable:!0,enumerable:!0,get:function(){this.$Ic||(this.$Ic=U.a(this.$));return this.$Ic}},Qpb:{configurable:!0,enumerable:!0,get:function(){this.lGc||(this.lGc=R.g(this.$).rc);return this.lGc}}});a.E1a=new DOMParser;a.VTe="Unsupported";Object(x.a)(a,"ContextMenuBase",C.a,[429,
817,3])},983:function(x,C,b){function a(){}b.d(C,"a",function(){return a});x=b(0);a.vMe="ewa-ac";a.Zlh="ewa-ac-param";a.uNe="ewa-function-help-link";a.q9c="ewa-lb";a.iNe="ewa-fb-refactor";a.listItem="list-item";a.HBb="list-item-selected";a.NBb="list-table-touch";a.MBb="list-table";a.gsh="ewa-suggested-cell-name";a.LZg="columnName-header";a.pOe="ewa-tt";a.tph="ewa-function-link-container";a.vNe="ewa-function-udf-name";a.rtl="rtl";Object(x.a)(a,"CssClassNames",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kpae.js.map/6cf108e7ad80d4c37a75b00cee34e52f/EwaDS.kpae.js.map